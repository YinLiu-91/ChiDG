module test_element_linearA_dx_mod
    use pfunit_mod
    use mod_kinds,                  only: rk,ik
    use mod_constants,              only: ZERO, ONE, TWO, THREE, FIVE, SIX, EIGHT, NINE, TEN, &
                                          XI_MIN, XI_MAX, ETA_MIN, ETA_MAX, ZETA_MIN, ZETA_MAX
    use mod_chidg_mpi,              only: IRANK
    use type_chidg,                 only: chidg_t
    use type_element,               only: element_t
    use type_face,                  only: face_t
    use type_element_connectivity,  only: element_connectivity_t
    use mod_io,                     only: gq_rule
    use type_point,                 only: point_t
    use mod_inv,                    only: inv
    implicit none

    public  :: test_element_linearA_dx

    !>
    !!
    !!  @author Matteo Ugolotti
    !!  @date   10/4/2018
    !!
    !!  This test is build based on test_element_linearA test case.
    !!  The standard initialization is not tested here but the dx initialization 
    !!  is verified.
    !!
    !!  Symbolic pyhton solution is used to check ChiDG matrices.
    !!  The python script is available at the end of this module.
    !!  The input matrices used in the test herein are given by the
    !!  python script
    !!
    !!
    !--------------------------------------------------------------------------
    @TestCase
    type, extends(TestCase) ::  test_element_linearA_dx

        type(chidg_t)               :: chidg
        type(element_t)             :: elem
        type(face_t),   allocatable :: faces(:)
        real(rk),       allocatable :: nodes(:,:)

    contains

        procedure   ::  setUp
        procedure   ::  tearDown

    end type test_element_linearA_dx
    !***************************************************************************


contains

    !> NOTE: make sure to use 'this' instead of 'self' since these are over-writting a 
    !! derived type procedure. The argument names have to match
    !!
    !!  @author Matteo Ugolotti
    !!
    !!
    !-----------------------------------------------------------------------------------------
    subroutine setUp(this)
        class(test_element_linearA_dx),    intent(inout)   :: this
        
        integer(ik), parameter          :: npt = 8
        real(rk)                        :: nodes(npt,3)
        integer(ik)                     :: ftype, ielem, idomain,                           &
                                           ntime, nfields, nterms_s,                        &
                                           ineighbor_domain_g,  ineighbor_domain_l,         &
                                           ineighbor_element_g, ineighbor_element_l,        &
                                           ineighbor_face, ineighbor_proc,                  &
                                           ineighbor_nfields, ineighbor_nterms_s,           &
                                           ineighbor_nterms_c, ineighbor_nnodes_r,          &
                                           ineighbor_ntime,                                 &
                                           dof_start, dof_local_start,                      &
                                           ineighbor_dof_start, ineighbor_dof_local_start,  &
                                           xdof_start, xdof_local_start,                    &
                                           ineighbor_xdof_start, ineighbor_xdof_local_start
        
        

        ! Set collocation quadrature for testing coordinates at quadrature nodes
        gq_rule = 1
        
        
        call this%chidg%start_up('core')
        allocate(this%faces(6))
        
        ! (x = 0-5 :: y = 0-1 :: z = 0-1)
        !          *------*
        !         /      /|
        !    x=5 /      / |
        !       /      /  *
        !      *------*  /
        !      |      | /
        !  z=1 |      |/
        !      *------*
        !         y=1
        !
        nodes(1,:) = [0._rk, 0._rk, 0._rk]
        nodes(2,:) = [5._rk, 0._rk, 0._rk]
        nodes(3,:) = [0._rk, 1._rk, 0._rk]
        nodes(4,:) = [5._rk, 1._rk, 0._rk]
        nodes(5,:) = [0._rk, 0._rk, 1._rk]
        nodes(6,:) = [5._rk, 0._rk, 1._rk]
        nodes(7,:) = [0._rk, 1._rk, 1._rk]
        nodes(8,:) = [5._rk, 1._rk, 1._rk]
        this%nodes = nodes


        
        !
        ! Initialize Element geometry and Numerics
        !
        idomain         = 1
        ielem           = 1
        nfields         = 2
        nterms_s        = 8
        ntime           = 1
        dof_start       = 1
        dof_local_start = 1
        xdof_start       = 1
        xdof_local_start = 1
        call this%elem%init_geom(nodes        = nodes,                                &
                                 connectivity = [1, 2, 3, 4, 5, 6, 7, 8],             &
                                 etype        = 1,                                    &
                                 location     = [idomain,idomain,ielem,ielem,IRANK],  &
                                 coord_system = 'Cartesian')
        call this%elem%init_sol('Quadrature',1,nterms_s,nfields,ntime,dof_start,dof_local_start,xdof_start,xdof_local_start)
        call this%elem%update_interpolations_dx()
        
        
        !
        ! Initialize face geometries
        !
        call this%faces(XI_MIN)%init_geom(XI_MIN,this%elem)
        call this%faces(XI_MAX)%init_geom(XI_MAX,this%elem)
        call this%faces(ETA_MIN)%init_geom(ETA_MIN,this%elem)
        call this%faces(ETA_MAX)%init_geom(ETA_MAX,this%elem)
        call this%faces(ZETA_MIN)%init_geom(ZETA_MIN,this%elem)
        call this%faces(ZETA_MAX)%init_geom(ZETA_MAX,this%elem)

        
        
        !
        ! Initialize face neighbors
        !
        ftype = 0
        ineighbor_domain_g        = 0
        ineighbor_domain_l        = 0
        ineighbor_element_g       = 0
        ineighbor_element_l       = 0
        ineighbor_face            = 0
        ineighbor_nfields         = 2
        ineighbor_ntime           = 1
        ineighbor_nterms_s        = 8
        ineighbor_nterms_c        = 8
        ineighbor_proc            = 0
        ineighbor_dof_start       = 1
        ineighbor_dof_local_start = 1
        ineighbor_xdof_start       = 1
        ineighbor_xdof_local_start = 1
        call this%faces(XI_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,               &
                                                   ineighbor_element_g,ineighbor_element_l,             &
                                                   ineighbor_face,ineighbor_nfields,ineighbor_ntime,    &
                                                   ineighbor_nterms_s,ineighbor_nterms_c,               &
                                                   ineighbor_proc,                                      &
                                                   ineighbor_dof_start,ineighbor_dof_local_start,       &
                                                   ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(XI_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,               &
                                                   ineighbor_element_g,ineighbor_element_l,             &
                                                   ineighbor_face,ineighbor_nfields,ineighbor_ntime,    &
                                                   ineighbor_nterms_s,ineighbor_nterms_c,               &
                                                   ineighbor_proc,                                      &
                                                   ineighbor_dof_start,ineighbor_dof_local_start,       &
                                                   ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,              &
                                                    ineighbor_element_g,ineighbor_element_l,            &
                                                    ineighbor_face,ineighbor_nfields,ineighbor_ntime,   &
                                                    ineighbor_nterms_s,ineighbor_nterms_c,              &
                                                    ineighbor_proc,                                     &
                                                    ineighbor_dof_start,ineighbor_dof_local_start,      &
                                                    ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,              &
                                                    ineighbor_element_g,ineighbor_element_l,            &
                                                    ineighbor_face,ineighbor_nfields,ineighbor_ntime,   &
                                                    ineighbor_nterms_s,ineighbor_nterms_c,              &
                                                    ineighbor_proc,                                     &
                                                    ineighbor_dof_start,ineighbor_dof_local_start,      &
                                                    ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ZETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                                    &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,     &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ZETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                                    &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,     &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)





        call this%faces(XI_MIN)%init_sol(this%elem)
        call this%faces(XI_MAX)%init_sol(this%elem)
        call this%faces(ETA_MIN)%init_sol(this%elem)
        call this%faces(ETA_MAX)%init_sol(this%elem)
        call this%faces(ZETA_MIN)%init_sol(this%elem)
        call this%faces(ZETA_MAX)%init_sol(this%elem)

        !
        ! Update dx interpolators
        !
        call this%faces(XI_MIN)%update_interpolations_dx(this%elem)
        call this%faces(XI_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MAX)%update_interpolations_dx(this%elem)


    end subroutine setUp
    !************************************************************************************
    

    !>
    !!
    !!
    !-------------------------------------------------------------------------------------
    subroutine tearDown(this)
        class(test_element_linearA_dx),    intent(inout)   :: this


        !
        ! Close ChiDG interface
        !
        call this%chidg%shut_down('core')

    end subroutine tearDown
    !**************************************************************************************



    
    
    !> Test element djinv_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_djinv_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self

        integer(ik) :: inode, inode_diff, idir, irow
        real(rk)    :: test_djinv_dx(8,3,8), test_djinv_dx_trans(8,3)


        
        test_djinv_dx(1,:,:) = reshape((/                                                                                & 
                                        -7.775105849101819622e-02_rk, -3.887552924550909950e-01_rk, -3.887552924550909950e-01_rk, &
                                         7.775105849101819622e-02_rk, -1.041666666666665603e-01_rk, -1.041666666666665603e-01_rk, &
                                        -2.083333333333331136e-02_rk,  3.887552924550909950e-01_rk, -1.041666666666665603e-01_rk, &
                                         2.083333333333331136e-02_rk,  1.041666666666665603e-01_rk, -2.791137421157522877e-02_rk, &
                                        -2.083333333333331136e-02_rk, -1.041666666666665603e-01_rk,  3.887552924550909950e-01_rk, &
                                         2.083333333333331136e-02_rk, -2.791137421157522877e-02_rk,  1.041666666666665603e-01_rk, &
                                        -5.582274842315046622e-03_rk,  1.041666666666665603e-01_rk,  1.041666666666665603e-01_rk, &
                                         5.582274842315046622e-03_rk,  2.791137421157522877e-02_rk,  2.791137421157522877e-02_rk  &
                                        /),(/3,8/))


        test_djinv_dx(2,:,:) = reshape((/                                                                                & 
                                        -7.775105849101819622e-02_rk, -1.041666666666665603e-01_rk, -1.041666666666665603e-01_rk, &
                                         7.775105849101819622e-02_rk, -3.887552924550909950e-01_rk, -3.887552924550909950e-01_rk, &
                                        -2.083333333333331136e-02_rk,  1.041666666666665603e-01_rk, -2.791137421157522877e-02_rk, &
                                         2.083333333333331136e-02_rk,  3.887552924550909950e-01_rk, -1.041666666666665603e-01_rk, &
                                        -2.083333333333331136e-02_rk, -2.791137421157522877e-02_rk,  1.041666666666665603e-01_rk, &
                                         2.083333333333331136e-02_rk, -1.041666666666665603e-01_rk,  3.887552924550909950e-01_rk, &
                                        -5.582274842315046622e-03_rk,  2.791137421157522877e-02_rk,  2.791137421157522877e-02_rk, &
                                         5.582274842315046622e-03_rk,  1.041666666666665603e-01_rk,  1.041666666666665603e-01_rk  &
                                        /),(/3,8/))
        

        test_djinv_dx(3,:,:) = reshape((/                                                                                & 
                                        -2.083333333333331136e-02_rk, -3.887552924550909950e-01_rk, -1.041666666666665741e-01_rk, &
                                         2.083333333333331136e-02_rk, -1.041666666666665603e-01_rk, -2.791137421157523224e-02_rk, &
                                        -7.775105849101819622e-02_rk,  3.887552924550909950e-01_rk, -3.887552924550909950e-01_rk, &
                                         7.775105849101819622e-02_rk,  1.041666666666665603e-01_rk, -1.041666666666665603e-01_rk, &
                                        -5.582274842315046622e-03_rk, -1.041666666666665603e-01_rk,  1.041666666666665603e-01_rk, &
                                         5.582274842315046622e-03_rk, -2.791137421157522877e-02_rk,  2.791137421157522877e-02_rk, &
                                        -2.083333333333331136e-02_rk,  1.041666666666665603e-01_rk,  3.887552924550909950e-01_rk, &
                                         2.083333333333331136e-02_rk,  2.791137421157522877e-02_rk,  1.041666666666665603e-01_rk  &
                                        /),(/3,8/))


        test_djinv_dx(4,:,:) = reshape((/                                                                                & 
                                        -2.083333333333330789e-02_rk, -1.041666666666665464e-01_rk, -2.791137421157522877e-02_rk, &
                                         2.083333333333330789e-02_rk, -3.887552924550909395e-01_rk, -1.041666666666665603e-01_rk, &
                                        -7.775105849101819622e-02_rk,  1.041666666666665464e-01_rk, -1.041666666666665603e-01_rk, &
                                         7.775105849101819622e-02_rk,  3.887552924550909395e-01_rk, -3.887552924550909950e-01_rk, &
                                        -5.582274842315045754e-03_rk, -2.791137421157522530e-02_rk,  2.791137421157522877e-02_rk, &
                                         5.582274842315045754e-03_rk, -1.041666666666665464e-01_rk,  1.041666666666665603e-01_rk, &
                                        -2.083333333333330789e-02_rk,  2.791137421157522530e-02_rk,  1.041666666666665603e-01_rk, &
                                         2.083333333333330789e-02_rk,  1.041666666666665464e-01_rk,  3.887552924550909950e-01_rk  &
                                        /),(/3,8/))


        test_djinv_dx(5,:,:) = reshape((/                                                                                & 
                                        -2.083333333333331136e-02_rk, -1.041666666666665741e-01_rk, -3.887552924550909950e-01_rk, &
                                         2.083333333333331136e-02_rk, -2.791137421157523224e-02_rk, -1.041666666666665603e-01_rk, &
                                        -5.582274842315046622e-03_rk,  1.041666666666665603e-01_rk, -1.041666666666665603e-01_rk, &
                                         5.582274842315046622e-03_rk,  2.791137421157522877e-02_rk, -2.791137421157522877e-02_rk, &
                                        -7.775105849101819622e-02_rk, -3.887552924550909950e-01_rk,  3.887552924550909950e-01_rk, &
                                         7.775105849101819622e-02_rk, -1.041666666666665603e-01_rk,  1.041666666666665603e-01_rk, &
                                        -2.083333333333331136e-02_rk,  3.887552924550909950e-01_rk,  1.041666666666665603e-01_rk, &
                                         2.083333333333331136e-02_rk,  1.041666666666665603e-01_rk,  2.791137421157522877e-02_rk  &
                                        /),(/3,8/))


        test_djinv_dx(6,:,:) = reshape((/                                                                                & 
                                        -2.083333333333330789e-02_rk, -2.791137421157522877e-02_rk, -1.041666666666665464e-01_rk, &
                                         2.083333333333330789e-02_rk, -1.041666666666665603e-01_rk, -3.887552924550909395e-01_rk, &
                                        -5.582274842315045754e-03_rk,  2.791137421157522877e-02_rk, -2.791137421157522530e-02_rk, &
                                         5.582274842315045754e-03_rk,  1.041666666666665603e-01_rk, -1.041666666666665464e-01_rk, &
                                        -7.775105849101819622e-02_rk, -1.041666666666665603e-01_rk,  1.041666666666665464e-01_rk, &
                                         7.775105849101819622e-02_rk, -3.887552924550909950e-01_rk,  3.887552924550909395e-01_rk, &
                                        -2.083333333333330789e-02_rk,  1.041666666666665603e-01_rk,  2.791137421157522530e-02_rk, &
                                         2.083333333333330789e-02_rk,  3.887552924550909950e-01_rk,  1.041666666666665464e-01_rk  &
                                        /),(/3,8/))


        test_djinv_dx(7,:,:) = reshape((/                                                                                & 
                                        -5.582274842315046622e-03_rk, -1.041666666666665603e-01_rk, -1.041666666666665603e-01_rk, &
                                         5.582274842315046622e-03_rk, -2.791137421157522877e-02_rk, -2.791137421157522877e-02_rk, &
                                        -2.083333333333331136e-02_rk,  1.041666666666665464e-01_rk, -3.887552924550909950e-01_rk, &
                                         2.083333333333331136e-02_rk,  2.791137421157522530e-02_rk, -1.041666666666665603e-01_rk, &
                                        -2.083333333333331136e-02_rk, -3.887552924550909950e-01_rk,  1.041666666666665464e-01_rk, &
                                         2.083333333333331136e-02_rk, -1.041666666666665603e-01_rk,  2.791137421157522530e-02_rk, &
                                        -7.775105849101819622e-02_rk,  3.887552924550909950e-01_rk,  3.887552924550909950e-01_rk, &
                                         7.775105849101819622e-02_rk,  1.041666666666665603e-01_rk,  1.041666666666665603e-01_rk  &
                                        /),(/3,8/))


        test_djinv_dx(8,:,:) = reshape((/                                                                                & 
                                        -5.582274842315044887e-03_rk, -2.791137421157522530e-02_rk, -2.791137421157522530e-02_rk, &
                                         5.582274842315044887e-03_rk, -1.041666666666665464e-01_rk, -1.041666666666665464e-01_rk, &
                                        -2.083333333333330442e-02_rk,  2.791137421157522530e-02_rk, -1.041666666666665464e-01_rk, &
                                         2.083333333333330442e-02_rk,  1.041666666666665464e-01_rk, -3.887552924550909395e-01_rk, &
                                        -2.083333333333330442e-02_rk, -1.041666666666665464e-01_rk,  2.791137421157522530e-02_rk, &
                                         2.083333333333330442e-02_rk, -3.887552924550909395e-01_rk,  1.041666666666665464e-01_rk, &
                                        -7.775105849101819622e-02_rk,  1.041666666666665464e-01_rk,  1.041666666666665464e-01_rk, &
                                         7.775105849101819622e-02_rk,  3.887552924550909395e-01_rk,  3.887552924550909395e-01_rk  &
                                        /),(/3,8/))


        do inode = 1,self%elem%basis_s%nnodes_elem()
            @assertEqual(transpose(test_djinv_dx(inode,:,:)),self%elem%djinv_dx(inode,:,:), 1.e-14_rk)
        end do
        
    end subroutine testElement_djinv_dx
    !***************************************************************************************





    !> Test element dmetric_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmetric_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self

        real(rk)    :: test_metric(3,3,self%elem%basis_s%nnodes_elem())
        real(rk)    :: test_dmetric_dx(3,3,8,8,3), test_dmetric_dx_trans(3,3)
        integer(ik) :: inode, inode_diff, idir, irow
        


        test_dmetric_dx(:,:,1,1,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, 2.488033871712584666e-01_rk, 2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.244016935856292472e+00_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.244016935856292472e+00_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, 6.666666666666667962e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -2.488033871712584666e-01_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -1.244016935856292472e+00_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -1.244016935856292472e+00_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, -6.666666666666667962e-02_rk, 1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, 8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, 8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 6.666666666666667962e-02_rk, -2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, -1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 1.786327949540818943e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 8.931639747704092636e-02_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 8.931639747704092636e-02_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, -6.666666666666667962e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, -1.786327949540818943e-02_rk, -1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, -8.931639747704092636e-02_rk, -8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, -8.931639747704092636e-02_rk, -8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, 6.666666666666667962e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, 2.488033871712584666e-01_rk, 2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 1.244016935856292472e+00_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 1.244016935856292472e+00_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -6.666666666666667962e-02_rk, 1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, 8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, 8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, -2.488033871712584666e-01_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -1.244016935856292472e+00_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -1.244016935856292472e+00_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 1.786327949540818943e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 8.931639747704092636e-02_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 8.931639747704092636e-02_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 6.666666666666667962e-02_rk, -2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, -1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, -1.786327949540818943e-02_rk, -1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -8.931639747704092636e-02_rk, -8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -8.931639747704092636e-02_rk, -8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, -6.666666666666667962e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, -3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, -3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 2.488033871712584666e-01_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 1.244016935856292472e+00_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 1.244016935856292472e+00_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 6.666666666666667962e-02_rk, 1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, 8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, 8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, -2.488033871712584666e-01_rk, 2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.244016935856292472e+00_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.244016935856292472e+00_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, -6.666666666666667962e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, -3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, -3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, 6.666666666666667962e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, 1.786327949540818943e-02_rk, -1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 8.931639747704092636e-02_rk, -8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 8.931639747704092636e-02_rk, -8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -6.666666666666667962e-02_rk, -2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, -1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, -1.786327949540818943e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -8.931639747704092636e-02_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -8.931639747704092636e-02_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 6.666666666666667962e-02_rk, 1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, 8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, 8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 2.488033871712584666e-01_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 1.244016935856292472e+00_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 1.244016935856292472e+00_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, -6.666666666666667962e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, -2.488033871712584666e-01_rk, 2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, -1.244016935856292472e+00_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, -1.244016935856292472e+00_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, 1.786327949540818943e-02_rk, -1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 8.931639747704092636e-02_rk, -8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 8.931639747704092636e-02_rk, -8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, 6.666666666666667962e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -1.786327949540818943e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -8.931639747704092636e-02_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -8.931639747704092636e-02_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, -6.666666666666667962e-02_rk, -2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, -1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 6.666666666666667962e-02_rk, 2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 1.786327949540818943e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 8.931639747704092636e-02_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 8.931639747704092636e-02_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, -6.666666666666667962e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, -1.786327949540818943e-02_rk, 1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, -8.931639747704092636e-02_rk, 8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, -8.931639747704092636e-02_rk, 8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, 2.488033871712584666e-01_rk, -2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.244016935856292472e+00_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.244016935856292472e+00_rk, -1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, 6.666666666666667962e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -2.488033871712584666e-01_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -1.244016935856292472e+00_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -1.244016935856292472e+00_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, -6.666666666666667962e-02_rk, -1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, -8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, -8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 1.786327949540818943e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 8.931639747704092636e-02_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 8.931639747704092636e-02_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 6.666666666666667962e-02_rk, 2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, -1.786327949540818943e-02_rk, 1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -8.931639747704092636e-02_rk, 8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -8.931639747704092636e-02_rk, 8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, -6.666666666666667962e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, -3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, -3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, 6.666666666666667962e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, 2.488033871712584666e-01_rk, -2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 1.244016935856292472e+00_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 1.244016935856292472e+00_rk, -1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -6.666666666666667962e-02_rk, -1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, -8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, -8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, -2.488033871712584666e-01_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -1.244016935856292472e+00_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -1.244016935856292472e+00_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, 6.666666666666667962e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, 1.786327949540818943e-02_rk, 1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 8.931639747704092636e-02_rk, 8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 8.931639747704092636e-02_rk, 8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -6.666666666666667962e-02_rk, 2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, -1.786327949540818943e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -8.931639747704092636e-02_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -8.931639747704092636e-02_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 2.488033871712584666e-01_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 1.244016935856292472e+00_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 1.244016935856292472e+00_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 6.666666666666667962e-02_rk, -1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, -8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, -8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, -2.488033871712584666e-01_rk, -2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.244016935856292472e+00_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.244016935856292472e+00_rk, -1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, -6.666666666666667962e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, -3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, -3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, 1.786327949540818943e-02_rk, 1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 8.931639747704092636e-02_rk, 8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 8.931639747704092636e-02_rk, 8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, 6.666666666666667962e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 3.333333333333333703e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -1.786327949540818943e-02_rk, 6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -8.931639747704092636e-02_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -8.931639747704092636e-02_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, -6.666666666666667962e-02_rk, 2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, -3.333333333333333703e-01_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 6.666666666666667962e-02_rk, -1.786327949540818943e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, -8.931639747704092636e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 3.333333333333333703e-01_rk, -8.931639747704092636e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 2.488033871712584666e-01_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 1.244016935856292472e+00_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 1.244016935856292472e+00_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, -6.666666666666667962e-02_rk, -6.666666666666667962e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -3.333333333333333703e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, -2.488033871712584666e-01_rk, -2.488033871712584666e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, -1.244016935856292472e+00_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, -1.244016935856292472e+00_rk, -1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        

        do inode = 1,self%elem%basis_s%nnodes_elem()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx(:,:,inode,inode_diff,idir)),self%elem%dmetric_dx(:,:,inode,inode_diff,idir), 1.e-14_rk)
                end do
            end do
        end do 


    end subroutine testElement_dmetric_dx
    !***************************************************************************************





    !> Test cartesian dgrad1_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad1_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,5.954426498469393009e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,5.954426498469393009e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,8.293446239041950274e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,8.293446239041950274e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,-8.293446239041950274e-02_rk  &
                                        /),(/8,8/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%elem%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad1_dx
    !*******************************************************************************************






    !> Test cartesian dgrad2_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad2_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad2_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad2_dx
        ! 
        
        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%elem%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad2_dx
    !*******************************************************************************************







    !> Test cartesian dgrad3_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad3_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad3_dx
        ! 
        
        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,-5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,8.293446239041950274e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk,0.000000000000000000e+00_rk,5.954426498469393009e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk,0.000000000000000000e+00_rk,-2.222222222222222307e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk,0.000000000000000000e+00_rk,-8.293446239041950274e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,7.182335127930837837e-01_rk,4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,0.000000000000000000e+00_rk,-5.156684612641716792e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704092636e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641716792e-02_rk,5.156684612641716792e-02_rk,-2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930837837e-01_rk,-7.182335127930837837e-01_rk,-4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%elem%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad3_dx
    !*******************************************************************************************







    !> Test cartesian dinvmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dinvmass_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dinvmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dinvmass_dx
        ! 
        
        test_dinvmass_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.000000000000000194e-02_rk,0.000000000000000000e+00_rk, &
                                        -1.000000000000000194e-02_rk, 3.000000000000000236e-02_rk, 1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        -1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk, 3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000236e-02_rk,-3.000000000000000583e-02_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000236e-02_rk,9.000000000000002442e-02_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.999999999999999889e-02_rk,3.000000000000000583e-02_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk, &
                                        1.000000000000000194e-02_rk, -2.999999999999999889e-02_rk, -3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,-9.000000000000002442e-02_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,2.700000000000000733e-01_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,1,2) = reshape((/                                                                                 &
                                        5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, -5.000000000000000278e-02_rk,-4.999999999999999584e-02_rk,0.000000000000000000e+00_rk,5.000000000000000278e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000777e-01_rk,1.500000000000000222e-01_rk, &
                                        -5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk,5.000000000000000278e-02_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.999999999999999584e-02_rk, 0.000000000000000000e+00_rk, 5.000000000000000278e-02_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000777e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk, &
                                        5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk,-1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,1,3) = reshape((/                                                                                 &
                                        5.000000000000000278e-02_rk, -4.999999999999999584e-02_rk, -3.469446951953614189e-18_rk,-4.999999999999999584e-02_rk,4.999999999999999584e-02_rk,3.469446951953614189e-18_rk,3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        -4.999999999999999584e-02_rk, 1.500000000000000222e-01_rk, 3.469446951953614189e-18_rk,4.999999999999999584e-02_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, 1.500000000000000222e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,-1.500000000000000500e-01_rk,1.500000000000000222e-01_rk, &
                                        -4.999999999999999584e-02_rk, 4.999999999999999584e-02_rk, 3.469446951953614189e-18_rk,1.500000000000000222e-01_rk,-1.500000000000000500e-01_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.999999999999999584e-02_rk, -1.499999999999999944e-01_rk, 3.469446951953614189e-18_rk,-1.499999999999999944e-01_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, -1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk,1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.000000000000000194e-02_rk,0.000000000000000000e+00_rk, &
                                        1.000000000000000194e-02_rk, -3.000000000000000236e-02_rk, -1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk, -3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000236e-02_rk,3.000000000000000583e-02_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000236e-02_rk,-9.000000000000002442e-02_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.999999999999999889e-02_rk,-3.000000000000000583e-02_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk, &
                                        -1.000000000000000194e-02_rk, 2.999999999999999889e-02_rk, 3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,9.000000000000002442e-02_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,-2.700000000000000733e-01_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,2) = reshape((/                                                                                 &
                                        5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, -5.000000000000000278e-02_rk,4.999999999999999584e-02_rk,0.000000000000000000e+00_rk,-5.000000000000000278e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000777e-01_rk,-1.500000000000000222e-01_rk, &
                                        -5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk,-5.000000000000000278e-02_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.999999999999999584e-02_rk, 0.000000000000000000e+00_rk, -5.000000000000000278e-02_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000777e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk, &
                                        -5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk,-1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,4.500000000000001221e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,3) = reshape((/                                                                                 &
                                        5.000000000000000278e-02_rk, -4.999999999999999584e-02_rk, -3.469446951953614189e-18_rk,4.999999999999999584e-02_rk,-4.999999999999999584e-02_rk,-3.469446951953614189e-18_rk,3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        -4.999999999999999584e-02_rk, 1.500000000000000222e-01_rk, 3.469446951953614189e-18_rk,-4.999999999999999584e-02_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, 1.500000000000000222e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,-1.500000000000000500e-01_rk,-1.500000000000000222e-01_rk, &
                                        4.999999999999999584e-02_rk, -4.999999999999999584e-02_rk, -3.469446951953614189e-18_rk,1.500000000000000222e-01_rk,-1.500000000000000500e-01_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.999999999999999584e-02_rk, 1.499999999999999944e-01_rk, -3.469446951953614189e-18_rk,-1.499999999999999944e-01_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, 1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,-1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,4.500000000000001221e-01_rk,4.500000000000001221e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,4.500000000000001221e-01_rk,1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,1) = reshape((/                                                                                 &
                                        1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.000000000000000194e-02_rk,0.000000000000000000e+00_rk, &
                                        1.000000000000000194e-02_rk, 3.000000000000000236e-02_rk, -1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        -1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk, 3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000236e-02_rk,3.000000000000000583e-02_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000236e-02_rk,9.000000000000002442e-02_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.999999999999999889e-02_rk,-3.000000000000000583e-02_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk, &
                                        -1.000000000000000194e-02_rk, -2.999999999999999889e-02_rk, 3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,-9.000000000000002442e-02_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,2.700000000000000733e-01_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, 5.000000000000000278e-02_rk,4.999999999999999584e-02_rk,0.000000000000000000e+00_rk,-5.000000000000000278e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,1.500000000000000777e-01_rk,-1.500000000000000222e-01_rk, &
                                        5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk,-5.000000000000000278e-02_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.999999999999999584e-02_rk, 0.000000000000000000e+00_rk, -5.000000000000000278e-02_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,1.500000000000000777e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,4.500000000000001221e-01_rk, &
                                        -5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk,1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,4.500000000000001221e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,-1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,3) = reshape((/                                                                                 &
                                        5.000000000000000278e-02_rk, 4.999999999999999584e-02_rk, -3.469446951953614189e-18_rk,-4.999999999999999584e-02_rk,-4.999999999999999584e-02_rk,3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        4.999999999999999584e-02_rk, 1.500000000000000222e-01_rk, -3.469446951953614189e-18_rk,-4.999999999999999584e-02_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, 1.500000000000000222e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,1.500000000000000500e-01_rk,-1.500000000000000222e-01_rk, &
                                        -4.999999999999999584e-02_rk, -4.999999999999999584e-02_rk, 3.469446951953614189e-18_rk,1.500000000000000222e-01_rk,1.500000000000000500e-01_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.999999999999999584e-02_rk, -1.499999999999999944e-01_rk, -3.469446951953614189e-18_rk,1.499999999999999944e-01_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, -1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,-1.500000000000000222e-01_rk,4.500000000000001221e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk,1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.000000000000000194e-02_rk,0.000000000000000000e+00_rk, &
                                        -1.000000000000000194e-02_rk, -3.000000000000000236e-02_rk, 1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk, -3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000236e-02_rk,-3.000000000000000583e-02_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000236e-02_rk,-9.000000000000002442e-02_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.999999999999999889e-02_rk,3.000000000000000583e-02_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk, &
                                        1.000000000000000194e-02_rk, 2.999999999999999889e-02_rk, -3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,9.000000000000002442e-02_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,-2.700000000000000733e-01_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, 5.000000000000000278e-02_rk,-4.999999999999999584e-02_rk,0.000000000000000000e+00_rk,5.000000000000000278e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,1.500000000000000777e-01_rk,1.500000000000000222e-01_rk, &
                                        5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk,5.000000000000000278e-02_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.999999999999999584e-02_rk, 0.000000000000000000e+00_rk, 5.000000000000000278e-02_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,1.500000000000000777e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,4.500000000000001221e-01_rk, &
                                        5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk,1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,-1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,3) = reshape((/                                                                                 &
                                        5.000000000000000278e-02_rk, 4.999999999999999584e-02_rk, -3.469446951953614189e-18_rk,4.999999999999999584e-02_rk,4.999999999999999584e-02_rk,-3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        4.999999999999999584e-02_rk, 1.500000000000000222e-01_rk, -3.469446951953614189e-18_rk,4.999999999999999584e-02_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, 1.500000000000000222e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,1.500000000000000500e-01_rk,1.500000000000000222e-01_rk, &
                                        4.999999999999999584e-02_rk, 4.999999999999999584e-02_rk, -3.469446951953614189e-18_rk,1.500000000000000222e-01_rk,1.500000000000000500e-01_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.999999999999999584e-02_rk, 1.499999999999999944e-01_rk, 3.469446951953614189e-18_rk,1.499999999999999944e-01_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, 1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,1.500000000000000222e-01_rk,4.500000000000001221e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,4.500000000000001221e-01_rk,4.500000000000001221e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,4.500000000000001221e-01_rk,1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.000000000000000194e-02_rk,0.000000000000000000e+00_rk, &
                                        -1.000000000000000194e-02_rk, 3.000000000000000236e-02_rk, -1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk, 3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000236e-02_rk,-3.000000000000000583e-02_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,-2.999999999999999889e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000236e-02_rk,9.000000000000002442e-02_rk,-2.999999999999999889e-02_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,-2.999999999999999889e-02_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk, &
                                        -1.000000000000000194e-02_rk, 3.000000000000000583e-02_rk, -3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.999999999999999889e-02_rk,9.000000000000002442e-02_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,2.700000000000000733e-01_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, 4.999999999999998890e-02_rk,-4.999999999999999584e-02_rk,0.000000000000000000e+00_rk,-4.999999999999998890e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,-1.500000000000000222e-01_rk, &
                                        4.999999999999998890e-02_rk, 0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk,-4.999999999999998890e-02_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.999999999999999584e-02_rk, 0.000000000000000000e+00_rk, -4.999999999999998890e-02_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,4.500000000000001221e-01_rk, &
                                        -4.999999999999998890e-02_rk, 0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk,1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -5.000000000000000278e-02_rk, 4.999999999999999584e-02_rk, 3.469446951953614189e-18_rk,4.999999999999999584e-02_rk,-4.999999999999999584e-02_rk,-3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        4.999999999999999584e-02_rk, -1.500000000000000222e-01_rk, -3.469446951953614189e-18_rk,-4.999999999999999584e-02_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, -1.500000000000000222e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,1.500000000000000500e-01_rk,-1.500000000000000222e-01_rk, &
                                        4.999999999999999584e-02_rk, -4.999999999999999584e-02_rk, -3.469446951953614189e-18_rk,-1.500000000000000222e-01_rk,1.500000000000000500e-01_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.999999999999999584e-02_rk, 1.499999999999999944e-01_rk, -3.469446951953614189e-18_rk,1.499999999999999944e-01_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, 1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,-1.500000000000000222e-01_rk,4.500000000000001221e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk,4.500000000000001221e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,4.500000000000001221e-01_rk,-1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.000000000000000194e-02_rk,0.000000000000000000e+00_rk, &
                                        1.000000000000000194e-02_rk, -3.000000000000000236e-02_rk, 1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        -1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk, -3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000236e-02_rk,3.000000000000000583e-02_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,2.999999999999999889e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000236e-02_rk,-9.000000000000002442e-02_rk,2.999999999999999889e-02_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,2.999999999999999889e-02_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk, &
                                        1.000000000000000194e-02_rk, -3.000000000000000583e-02_rk, 3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.999999999999999889e-02_rk,-9.000000000000002442e-02_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,-2.700000000000000733e-01_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,2) = reshape((/                                                                                 &
                                        5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, 4.999999999999998890e-02_rk,4.999999999999999584e-02_rk,0.000000000000000000e+00_rk,4.999999999999998890e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,1.500000000000000222e-01_rk, &
                                        4.999999999999998890e-02_rk, 0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk,4.999999999999998890e-02_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.999999999999999584e-02_rk, 0.000000000000000000e+00_rk, 4.999999999999998890e-02_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,4.500000000000001221e-01_rk, &
                                        4.999999999999998890e-02_rk, 0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk,1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,4.500000000000001221e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -5.000000000000000278e-02_rk, 4.999999999999999584e-02_rk, 3.469446951953614189e-18_rk,-4.999999999999999584e-02_rk,4.999999999999999584e-02_rk,3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        4.999999999999999584e-02_rk, -1.500000000000000222e-01_rk, -3.469446951953614189e-18_rk,4.999999999999999584e-02_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, -1.500000000000000222e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,1.500000000000000500e-01_rk,1.500000000000000222e-01_rk, &
                                        -4.999999999999999584e-02_rk, 4.999999999999999584e-02_rk, 3.469446951953614189e-18_rk,-1.500000000000000222e-01_rk,1.500000000000000500e-01_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.999999999999999584e-02_rk, -1.499999999999999944e-01_rk, 3.469446951953614189e-18_rk,1.499999999999999944e-01_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, -1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,1.500000000000000222e-01_rk,4.500000000000001221e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk,-1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.000000000000000194e-02_rk,0.000000000000000000e+00_rk, &
                                        1.000000000000000194e-02_rk, 3.000000000000000236e-02_rk, 1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        1.000000000000000194e-02_rk, 1.000000000000000194e-02_rk, 3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000236e-02_rk,3.000000000000000583e-02_rk,3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,2.999999999999999889e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000236e-02_rk,9.000000000000002442e-02_rk,2.999999999999999889e-02_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.000000000000000583e-02_rk,2.999999999999999889e-02_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk, &
                                        1.000000000000000194e-02_rk, 3.000000000000000583e-02_rk, 3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.999999999999999889e-02_rk,9.000000000000002442e-02_rk,9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,2.700000000000000733e-01_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, -4.999999999999998890e-02_rk,4.999999999999999584e-02_rk,0.000000000000000000e+00_rk,4.999999999999998890e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,1.500000000000000222e-01_rk, &
                                        -4.999999999999998890e-02_rk, 0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk,4.999999999999998890e-02_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.999999999999999584e-02_rk, 0.000000000000000000e+00_rk, 4.999999999999998890e-02_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk, &
                                        4.999999999999998890e-02_rk, 0.000000000000000000e+00_rk, 1.499999999999999944e-01_rk,-1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,4.500000000000001221e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,4.500000000000001221e-01_rk,-1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -5.000000000000000278e-02_rk, -4.999999999999999584e-02_rk, 3.469446951953614189e-18_rk,4.999999999999999584e-02_rk,4.999999999999999584e-02_rk,-3.469446951953614189e-18_rk,3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        -4.999999999999999584e-02_rk, -1.500000000000000222e-01_rk, 3.469446951953614189e-18_rk,4.999999999999999584e-02_rk,1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, -1.500000000000000222e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,1.500000000000000500e-01_rk,-1.500000000000000500e-01_rk,1.500000000000000222e-01_rk, &
                                        4.999999999999999584e-02_rk, 4.999999999999999584e-02_rk, -3.469446951953614189e-18_rk,-1.500000000000000222e-01_rk,-1.500000000000000500e-01_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.999999999999999584e-02_rk, 1.499999999999999944e-01_rk, 3.469446951953614189e-18_rk,-1.499999999999999944e-01_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, 1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk,4.500000000000001221e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,4.500000000000001221e-01_rk,-1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.000000000000000194e-02_rk,0.000000000000000000e+00_rk, &
                                        -1.000000000000000194e-02_rk, -3.000000000000000236e-02_rk, -1.000000000000000194e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        -1.000000000000000194e-02_rk, -1.000000000000000194e-02_rk, -3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000236e-02_rk,-3.000000000000000583e-02_rk,-3.000000000000000583e-02_rk,0.000000000000000000e+00_rk,-2.999999999999999889e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000236e-02_rk,-9.000000000000002442e-02_rk,-2.999999999999999889e-02_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.000000000000000583e-02_rk,-2.999999999999999889e-02_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk, &
                                        -1.000000000000000194e-02_rk, -3.000000000000000583e-02_rk, -3.000000000000000236e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.999999999999999889e-02_rk,-9.000000000000002442e-02_rk,-9.000000000000002442e-02_rk,0.000000000000000000e+00_rk,-2.700000000000000733e-01_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -5.000000000000000278e-02_rk, 0.000000000000000000e+00_rk, -4.999999999999998890e-02_rk,-4.999999999999999584e-02_rk,0.000000000000000000e+00_rk,-4.999999999999998890e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,-1.500000000000000222e-01_rk, &
                                        -4.999999999999998890e-02_rk, 0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk,-4.999999999999998890e-02_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.999999999999999584e-02_rk, 0.000000000000000000e+00_rk, -4.999999999999998890e-02_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk, &
                                        -4.999999999999998890e-02_rk, 0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk,-1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,-1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -5.000000000000000278e-02_rk, -4.999999999999999584e-02_rk, 3.469446951953614189e-18_rk,-4.999999999999999584e-02_rk,-4.999999999999999584e-02_rk,3.469446951953614189e-18_rk,3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        -4.999999999999999584e-02_rk, -1.500000000000000222e-01_rk, 3.469446951953614189e-18_rk,-4.999999999999999584e-02_rk,-1.500000000000000500e-01_rk,0.000000000000000000e+00_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, -1.500000000000000222e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-1.500000000000000500e-01_rk,-1.500000000000000500e-01_rk,-1.500000000000000222e-01_rk, &
                                        -4.999999999999999584e-02_rk, -4.999999999999999584e-02_rk, 3.469446951953614189e-18_rk,-1.500000000000000222e-01_rk,-1.500000000000000500e-01_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.999999999999999584e-02_rk, -1.499999999999999944e-01_rk, -3.469446951953614189e-18_rk,-1.499999999999999944e-01_rk,-4.500000000000001221e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, -1.499999999999999944e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,-1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -1.499999999999999944e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-1.500000000000000222e-01_rk,-4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -1.500000000000000222e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.500000000000001221e-01_rk,-4.500000000000001221e-01_rk,-1.350000000000000089e+00_rk  &
                                        /),(/8,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dinvmass_dx(:,:,inode_diff,idir)),self%elem%dinvmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dinvmass_dx
    !*******************************************************************************************







    !> Test cartesian dmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmass_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dmass_dx
        ! 
        
        test_dmass_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -2.500000000000000000e-01_rk, 8.333333333333332871e-02_rk, 8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        8.333333333333332871e-02_rk, -8.333333333333332871e-02_rk, -2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        8.333333333333332871e-02_rk, -2.777777777777778317e-02_rk, -8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.333333333333332871e-02_rk,2.777777777777776930e-02_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,-2.777777777777778317e-02_rk,-9.259259259259258745e-03_rk,0.000000000000000000e+00_rk,9.259259259259262215e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,-9.259259259259258745e-03_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,9.259259259259260480e-03_rk, &
                                        -2.777777777777778317e-02_rk, 2.777777777777776930e-02_rk, 2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk,9.259259259259262215e-03_rk,9.259259259259260480e-03_rk,0.000000000000000000e+00_rk,-9.259259259259257011e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -1.250000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.166666666666666297e-01_rk,4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,-4.629629629629627985e-02_rk, &
                                        4.166666666666666297e-01_rk, 0.000000000000000000e+00_rk, -4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk,-4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk, &
                                        -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.629629629629627985e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -1.250000000000000000e+00_rk, 4.166666666666665741e-01_rk, 2.775557561562891351e-17_rk,4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk, &
                                        4.166666666666665741e-01_rk, -4.166666666666665741e-01_rk, -6.938893903907228378e-18_rk,-1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,-3.469446951953614189e-18_rk,6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        2.775557561562891351e-17_rk, -6.938893903907228378e-18_rk, -4.166666666666665741e-01_rk,-6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk,1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        4.166666666666665741e-01_rk, -1.388888888888888673e-01_rk, -6.938893903907228378e-18_rk,-4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        -1.388888888888888673e-01_rk, 1.388888888888888673e-01_rk, -3.469446951953614189e-18_rk,1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, -3.469446951953614189e-18_rk, 1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk, &
                                        -6.938893903907228378e-18_rk, 6.938893903907228378e-18_rk, 1.388888888888888673e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,-1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        -3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, -4.629629629629628679e-02_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,1) = reshape((/                                                                                 &
                                        2.500000000000000000e-01_rk, -8.333333333333332871e-02_rk, -8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        -8.333333333333332871e-02_rk, 8.333333333333332871e-02_rk, 2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        -8.333333333333332871e-02_rk, 2.777777777777778317e-02_rk, 8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.333333333333332871e-02_rk,-2.777777777777776930e-02_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,2.777777777777778317e-02_rk,9.259259259259258745e-03_rk,0.000000000000000000e+00_rk,-9.259259259259262215e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,9.259259259259258745e-03_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,-9.259259259259260480e-03_rk, &
                                        2.777777777777778317e-02_rk, -2.777777777777776930e-02_rk, -2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,9.259259259259258745e-03_rk,-9.259259259259262215e-03_rk,-9.259259259259260480e-03_rk,0.000000000000000000e+00_rk,9.259259259259257011e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.250000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.166666666666666297e-01_rk,-4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,4.629629629629627985e-02_rk, &
                                        4.166666666666666297e-01_rk, 0.000000000000000000e+00_rk, -4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk,-4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk, &
                                        1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.629629629629627985e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -1.250000000000000000e+00_rk, 4.166666666666665741e-01_rk, 2.775557561562891351e-17_rk,-4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        4.166666666666665741e-01_rk, -4.166666666666665741e-01_rk, -6.938893903907228378e-18_rk,1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,3.469446951953614189e-18_rk,6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk, &
                                        2.775557561562891351e-17_rk, -6.938893903907228378e-18_rk, -4.166666666666665741e-01_rk,6.938893903907228378e-18_rk,3.469446951953614189e-18_rk,-1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        -4.166666666666665741e-01_rk, 1.388888888888888673e-01_rk, 6.938893903907228378e-18_rk,-4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        1.388888888888888673e-01_rk, -1.388888888888888673e-01_rk, 3.469446951953614189e-18_rk,1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        6.938893903907228378e-18_rk, 3.469446951953614189e-18_rk, -1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk, &
                                        -6.938893903907228378e-18_rk, 6.938893903907228378e-18_rk, 1.388888888888888673e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, 4.629629629629628679e-02_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -2.500000000000000000e-01_rk, -8.333333333333332871e-02_rk, 8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        -8.333333333333332871e-02_rk, -8.333333333333332871e-02_rk, 2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        8.333333333333332871e-02_rk, 2.777777777777778317e-02_rk, -8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.333333333333332871e-02_rk,-2.777777777777776930e-02_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,-2.777777777777778317e-02_rk,9.259259259259258745e-03_rk,0.000000000000000000e+00_rk,9.259259259259262215e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,9.259259259259258745e-03_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,-9.259259259259260480e-03_rk, &
                                        2.777777777777778317e-02_rk, 2.777777777777776930e-02_rk, -2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,9.259259259259258745e-03_rk,9.259259259259262215e-03_rk,-9.259259259259260480e-03_rk,0.000000000000000000e+00_rk,-9.259259259259257011e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,2) = reshape((/                                                                                 &
                                        1.250000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.166666666666666297e-01_rk,-4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,4.629629629629627985e-02_rk, &
                                        -4.166666666666666297e-01_rk, 0.000000000000000000e+00_rk, 4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk,4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk, &
                                        1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.629629629629627985e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -1.250000000000000000e+00_rk, -4.166666666666665741e-01_rk, 2.775557561562891351e-17_rk,4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        -4.166666666666665741e-01_rk, -4.166666666666665741e-01_rk, 6.938893903907228378e-18_rk,1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,3.469446951953614189e-18_rk,6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        2.775557561562891351e-17_rk, 6.938893903907228378e-18_rk, -4.166666666666665741e-01_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk,1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        4.166666666666665741e-01_rk, 1.388888888888888673e-01_rk, -6.938893903907228378e-18_rk,-4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        1.388888888888888673e-01_rk, 1.388888888888888673e-01_rk, 3.469446951953614189e-18_rk,-1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 3.469446951953614189e-18_rk, 1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk, &
                                        6.938893903907228378e-18_rk, 6.938893903907228378e-18_rk, -1.388888888888888673e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, 4.629629629629628679e-02_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,1) = reshape((/                                                                                 &
                                        2.500000000000000000e-01_rk, 8.333333333333332871e-02_rk, -8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        8.333333333333332871e-02_rk, 8.333333333333332871e-02_rk, -2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        -8.333333333333332871e-02_rk, -2.777777777777778317e-02_rk, 8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.333333333333332871e-02_rk,2.777777777777776930e-02_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,2.777777777777778317e-02_rk,-9.259259259259258745e-03_rk,0.000000000000000000e+00_rk,-9.259259259259262215e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,-9.259259259259258745e-03_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,9.259259259259260480e-03_rk, &
                                        -2.777777777777778317e-02_rk, -2.777777777777776930e-02_rk, 2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk,-9.259259259259262215e-03_rk,9.259259259259260480e-03_rk,0.000000000000000000e+00_rk,9.259259259259257011e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.250000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.166666666666666297e-01_rk,4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,-4.629629629629627985e-02_rk, &
                                        -4.166666666666666297e-01_rk, 0.000000000000000000e+00_rk, 4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk,4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk, &
                                        -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.629629629629627985e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.250000000000000000e+00_rk, -4.166666666666665741e-01_rk, 2.775557561562891351e-17_rk,-4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk, &
                                        -4.166666666666665741e-01_rk, -4.166666666666665741e-01_rk, 6.938893903907228378e-18_rk,-1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,-3.469446951953614189e-18_rk,6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk, &
                                        2.775557561562891351e-17_rk, 6.938893903907228378e-18_rk, -4.166666666666665741e-01_rk,6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk,-1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        -4.166666666666665741e-01_rk, -1.388888888888888673e-01_rk, 6.938893903907228378e-18_rk,-4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        -1.388888888888888673e-01_rk, -1.388888888888888673e-01_rk, -3.469446951953614189e-18_rk,-1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        6.938893903907228378e-18_rk, -3.469446951953614189e-18_rk, -1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk, &
                                        6.938893903907228378e-18_rk, 6.938893903907228378e-18_rk, -1.388888888888888673e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,-1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        -3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, -4.629629629629628679e-02_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -2.500000000000000000e-01_rk, 8.333333333333332871e-02_rk, -8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        8.333333333333332871e-02_rk, -8.333333333333332871e-02_rk, 2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        -8.333333333333332871e-02_rk, 2.777777777777778317e-02_rk, -8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.333333333333332871e-02_rk,2.777777777777776930e-02_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,-2.777777777777778317e-02_rk,9.259259259259258745e-03_rk,0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,9.259259259259258745e-03_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,9.259259259259260480e-03_rk, &
                                        2.777777777777778317e-02_rk, -2.777777777777776930e-02_rk, 2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,9.259259259259258745e-03_rk,-9.259259259259258745e-03_rk,9.259259259259260480e-03_rk,0.000000000000000000e+00_rk,-9.259259259259257011e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -1.250000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.166666666666665186e-01_rk,4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,4.629629629629629373e-02_rk, &
                                        -4.166666666666665186e-01_rk, 0.000000000000000000e+00_rk, -4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk,-4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk, &
                                        1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.629629629629629373e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,3) = reshape((/                                                                                 &
                                        1.250000000000000000e+00_rk, -4.166666666666665741e-01_rk, -2.775557561562891351e-17_rk,-4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        -4.166666666666665741e-01_rk, 4.166666666666665741e-01_rk, 6.938893903907228378e-18_rk,1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,3.469446951953614189e-18_rk,-6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk, &
                                        -2.775557561562891351e-17_rk, 6.938893903907228378e-18_rk, 4.166666666666665741e-01_rk,6.938893903907228378e-18_rk,3.469446951953614189e-18_rk,-1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        -4.166666666666665741e-01_rk, 1.388888888888888673e-01_rk, 6.938893903907228378e-18_rk,4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        1.388888888888888673e-01_rk, -1.388888888888888673e-01_rk, 3.469446951953614189e-18_rk,-1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        6.938893903907228378e-18_rk, 3.469446951953614189e-18_rk, -1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk, &
                                        6.938893903907228378e-18_rk, -6.938893903907228378e-18_rk, -1.388888888888888673e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, 4.629629629629628679e-02_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,1) = reshape((/                                                                                 &
                                        2.500000000000000000e-01_rk, -8.333333333333332871e-02_rk, 8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        -8.333333333333332871e-02_rk, 8.333333333333332871e-02_rk, -2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        8.333333333333332871e-02_rk, -2.777777777777778317e-02_rk, 8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.333333333333332871e-02_rk,-2.777777777777776930e-02_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,2.777777777777778317e-02_rk,-9.259259259259258745e-03_rk,0.000000000000000000e+00_rk,9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,-9.259259259259258745e-03_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,-9.259259259259260480e-03_rk, &
                                        -2.777777777777778317e-02_rk, 2.777777777777776930e-02_rk, -2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk,9.259259259259258745e-03_rk,-9.259259259259260480e-03_rk,0.000000000000000000e+00_rk,9.259259259259257011e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.250000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.166666666666665186e-01_rk,-4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,-4.629629629629629373e-02_rk, &
                                        -4.166666666666665186e-01_rk, 0.000000000000000000e+00_rk, -4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk,-4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk, &
                                        -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.629629629629629373e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,3) = reshape((/                                                                                 &
                                        1.250000000000000000e+00_rk, -4.166666666666665741e-01_rk, -2.775557561562891351e-17_rk,4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk, &
                                        -4.166666666666665741e-01_rk, 4.166666666666665741e-01_rk, 6.938893903907228378e-18_rk,-1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,-3.469446951953614189e-18_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        -2.775557561562891351e-17_rk, 6.938893903907228378e-18_rk, 4.166666666666665741e-01_rk,-6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk,1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        4.166666666666665741e-01_rk, -1.388888888888888673e-01_rk, -6.938893903907228378e-18_rk,4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        -1.388888888888888673e-01_rk, 1.388888888888888673e-01_rk, -3.469446951953614189e-18_rk,-1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, -3.469446951953614189e-18_rk, 1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk, &
                                        6.938893903907228378e-18_rk, -6.938893903907228378e-18_rk, -1.388888888888888673e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        -3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, -4.629629629629628679e-02_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -2.500000000000000000e-01_rk, -8.333333333333332871e-02_rk, -8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        -8.333333333333332871e-02_rk, -8.333333333333332871e-02_rk, -2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        -8.333333333333332871e-02_rk, -2.777777777777778317e-02_rk, -8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.333333333333332871e-02_rk,-2.777777777777776930e-02_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,-2.777777777777778317e-02_rk,-9.259259259259258745e-03_rk,0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.777777777777776930e-02_rk,-9.259259259259258745e-03_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,-9.259259259259260480e-03_rk, &
                                        -2.777777777777778317e-02_rk, -2.777777777777776930e-02_rk, -2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-9.259259259259258745e-03_rk,-9.259259259259258745e-03_rk,-9.259259259259260480e-03_rk,0.000000000000000000e+00_rk,-9.259259259259257011e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.250000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.166666666666665186e-01_rk,-4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,-4.629629629629629373e-02_rk, &
                                        4.166666666666665186e-01_rk, 0.000000000000000000e+00_rk, 4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk,4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk, &
                                        -1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk, -1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.629629629629629373e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,3) = reshape((/                                                                                 &
                                        1.250000000000000000e+00_rk, 4.166666666666665741e-01_rk, -2.775557561562891351e-17_rk,-4.166666666666665741e-01_rk,-1.388888888888888673e-01_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk, &
                                        4.166666666666665741e-01_rk, 4.166666666666665741e-01_rk, -6.938893903907228378e-18_rk,-1.388888888888888673e-01_rk,-1.388888888888888673e-01_rk,-3.469446951953614189e-18_rk,-6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk, &
                                        -2.775557561562891351e-17_rk, -6.938893903907228378e-18_rk, 4.166666666666665741e-01_rk,6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk,-1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        -4.166666666666665741e-01_rk, -1.388888888888888673e-01_rk, 6.938893903907228378e-18_rk,4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,-3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        -1.388888888888888673e-01_rk, -1.388888888888888673e-01_rk, -3.469446951953614189e-18_rk,1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        6.938893903907228378e-18_rk, -3.469446951953614189e-18_rk, -1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk, &
                                        -6.938893903907228378e-18_rk, -6.938893903907228378e-18_rk, 1.388888888888888673e-01_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,1.388888888888888673e-01_rk,-4.629629629629628679e-02_rk, &
                                        -3.469446951953614189e-18_rk, -3.469446951953614189e-18_rk, -4.629629629629628679e-02_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-4.629629629629628679e-02_rk,4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,1) = reshape((/                                                                                 &
                                        2.500000000000000000e-01_rk, 8.333333333333332871e-02_rk, 8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        8.333333333333332871e-02_rk, 8.333333333333332871e-02_rk, 2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        8.333333333333332871e-02_rk, 2.777777777777778317e-02_rk, 8.333333333333332871e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.333333333333332871e-02_rk,2.777777777777776930e-02_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,2.777777777777778317e-02_rk,9.259259259259258745e-03_rk,0.000000000000000000e+00_rk,9.259259259259258745e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,2.777777777777776930e-02_rk,9.259259259259258745e-03_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk,9.259259259259260480e-03_rk, &
                                        2.777777777777778317e-02_rk, 2.777777777777776930e-02_rk, 2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.777777777777778317e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,9.259259259259258745e-03_rk,9.259259259259258745e-03_rk,9.259259259259260480e-03_rk,0.000000000000000000e+00_rk,9.259259259259257011e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,2) = reshape((/                                                                                 &
                                        1.250000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.166666666666665186e-01_rk,4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,4.629629629629629373e-02_rk, &
                                        4.166666666666665186e-01_rk, 0.000000000000000000e+00_rk, 4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        4.166666666666665741e-01_rk, 0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk,4.166666666666665741e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk, &
                                        1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.388888888888888673e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.629629629629629373e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,3) = reshape((/                                                                                 &
                                        1.250000000000000000e+00_rk, 4.166666666666665741e-01_rk, -2.775557561562891351e-17_rk,4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        4.166666666666665741e-01_rk, 4.166666666666665741e-01_rk, -6.938893903907228378e-18_rk,1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,3.469446951953614189e-18_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        -2.775557561562891351e-17_rk, -6.938893903907228378e-18_rk, 4.166666666666665741e-01_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk,1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        4.166666666666665741e-01_rk, 1.388888888888888673e-01_rk, -6.938893903907228378e-18_rk,4.166666666666665741e-01_rk,1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        1.388888888888888673e-01_rk, 1.388888888888888673e-01_rk, 3.469446951953614189e-18_rk,1.388888888888888673e-01_rk,1.388888888888888673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 3.469446951953614189e-18_rk, 1.388888888888888673e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,1.388888888888888673e-01_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk, &
                                        -6.938893903907228378e-18_rk, -6.938893903907228378e-18_rk, 1.388888888888888673e-01_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,1.388888888888888673e-01_rk,4.629629629629628679e-02_rk, &
                                        3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, 4.629629629629628679e-02_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk,4.629629629629628679e-02_rk  &
                                        /),(/8,8/))
        
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dmass_dx(:,:,inode_diff,idir)),self%elem%dmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dmass_dx
    !*******************************************************************************************







    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_vol_dcoords_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_elem()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,8/))
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','1',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,8/))
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','2',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk  &
                                        /),(/24,8/))
        
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','3',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_vol_dcoords_dx
    !*******************************************************************************************



!------------------------------------------------------------------------------
!                                Face tests
!------------------------------------------------------------------------------








    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_ximin_dcoords_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_face()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_face(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','1',inode,1)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','2',inode,1)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','3',inode,1)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_ximin_dcoords_dx
    !*******************************************************************************************






    !> Test cartesian dbr2_vol_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_vol_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)   :: test_dbr2_vol_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)   :: test_dbr2_vol_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)  :: test_dbr2_vol_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)  :: test_dbr2_vol_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dbr2_vol_face1_dx
        ! 
        test_dbr2_vol_face1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        2.718973979388435436e-01_rk, 1.982007908044051092e-18_rk, 3.444086176369425055e-18_rk,8.144918241925040699e-18_rk, &
                                        -7.285468820183672867e-02_rk, -3.280930954701892639e-18_rk, -6.036219742356413033e-19_rk,-8.352739925889253521e-18_rk, &
                                        -4.318487397312933379e-18_rk, 7.285468820183675642e-02_rk, 9.642980738677215955e-19_rk,-6.334957736182615154e-18_rk, &
                                        -1.272293598239191707e-17_rk, -1.952135486850339885e-02_rk, -2.578513243127672859e-18_rk,6.251594852252423036e-18_rk, &
                                        -1.031666402990473143e-17_rk, -2.024778461945198846e-18_rk, 7.285468820183674254e-02_rk,-8.156378577302686145e-18_rk, &
                                        -1.361098538093369949e-17_rk, 1.249177378476235695e-18_rk, -1.952135486850340579e-02_rk,5.329305172030967177e-18_rk, &
                                        -1.844255413467035103e-17_rk, -5.813778527206092695e-18_rk, -9.542128795143462478e-18_rk,1.952135486850341273e-02_rk, &
                                        1.241822110864381403e-17_rk, -3.749194529629824794e-18_rk, -4.275965375868277749e-18_rk,-5.230731272176844179e-03_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.359486989694218106e+00_rk, -1.236802934994305370e-17_rk, 4.379621479807554068e-18_rk,2.717506050280022006e-17_rk, &
                                        -9.760677434251696649e-02_rk, -5.558252269560764840e-17_rk, 1.819031118665290285e-17_rk,-2.656799483919858388e-17_rk, &
                                        -1.416638383589525700e-17_rk, 1.359486989694218106e+00_rk, 2.765692813501600426e-17_rk,3.897753847591769868e-18_rk, &
                                        -5.738087718155983784e-17_rk, -9.760677434251696649e-02_rk, -2.608612720698279660e-17_rk,1.770844355443712173e-17_rk, &
                                        -6.264424134362362087e-17_rk, -5.542548191136578057e-17_rk, 3.642734410091837960e-01_rk,-4.534027709733814128e-17_rk, &
                                        -6.224920776383669468e-17_rk, 4.791534300943047635e-17_rk, -2.615365636088419488e-02_rk,-9.350572339203865984e-18_rk, &
                                        -5.362712742541356649e-17_rk, -6.444259582957582263e-17_rk, -4.582214472955392856e-17_rk,3.642734410091837960e-01_rk, &
                                        4.971369749538267195e-17_rk, -6.404756224978889644e-17_rk, -9.832439971419642480e-18_rk,-2.615365636088419488e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.359486989694218106e+00_rk, -1.082255484653712892e-17_rk, -2.876153751327254007e-17_rk,1.924689494422934876e-17_rk, &
                                        -9.760677434251698037e-02_rk, 7.801803302231827062e-18_rk, -4.731052434701574770e-17_rk,-1.448670749437619550e-17_rk, &
                                        -4.736761923295984718e-17_rk, 3.642734410091837960e-01_rk, -4.701544872057912199e-17_rk,-3.130143683649572849e-17_rk, &
                                        -7.321676596925912103e-17_rk, -2.615365636088422263e-02_rk, 3.631592329682387525e-17_rk,1.453273283879755647e-18_rk, &
                                        -2.876153751327254623e-17_rk, 1.924689494422934876e-17_rk, 1.359486989694218106e+00_rk,-1.082255484653712584e-17_rk, &
                                        -4.731052434701575386e-17_rk, -1.448670749437620783e-17_rk, -9.760677434251695261e-02_rk,7.801803302231830143e-18_rk, &
                                        -4.701544872057912815e-17_rk, -3.130143683649573465e-17_rk, -4.736761923295985334e-17_rk,3.642734410091837960e-01_rk, &
                                        3.631592329682388142e-17_rk, 1.453273283879756417e-18_rk, -7.321676596925909637e-17_rk,-2.615365636088419488e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -2.718973979388435436e-01_rk, -1.982007908044051092e-18_rk, -3.444086176369425055e-18_rk,-8.144918241925040699e-18_rk, &
                                        7.285468820183672867e-02_rk, 3.280930954701892639e-18_rk, 6.036219742356413033e-19_rk,8.352739925889253521e-18_rk, &
                                        4.318487397312933379e-18_rk, -7.285468820183675642e-02_rk, -9.642980738677215955e-19_rk,6.334957736182615154e-18_rk, &
                                        1.272293598239191707e-17_rk, 1.952135486850339885e-02_rk, 2.578513243127672859e-18_rk,-6.251594852252423036e-18_rk, &
                                        1.031666402990473143e-17_rk, 2.024778461945198846e-18_rk, -7.285468820183674254e-02_rk,8.156378577302686145e-18_rk, &
                                        1.361098538093369949e-17_rk, -1.249177378476235695e-18_rk, 1.952135486850340579e-02_rk,-5.329305172030967177e-18_rk, &
                                        1.844255413467035103e-17_rk, 5.813778527206092695e-18_rk, 9.542128795143462478e-18_rk,-1.952135486850341273e-02_rk, &
                                        -1.241822110864381403e-17_rk, 3.749194529629824794e-18_rk, 4.275965375868277749e-18_rk,5.230731272176844179e-03_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        3.642734410091837960e-01_rk, 1.167499535814424151e-18_rk, -1.835211164665771574e-17_rk,1.824190503325266639e-17_rk, &
                                        -3.642734410091835739e-01_rk, -2.395494435764564252e-17_rk, 1.053142083564677133e-17_rk,-2.821738704879696110e-17_rk, &
                                        6.856319035986461148e-19_rk, 3.642734410091837960e-01_rk, 1.837102107616358602e-17_rk,-1.848122768956862921e-17_rk, &
                                        -2.443681198986141747e-17_rk, -3.642734410091836295e-01_rk, -2.808827100588604455e-17_rk,1.040230479273585016e-17_rk, &
                                        -1.620961695597829492e-17_rk, -4.739304870392775993e-17_rk, 9.760677434251699425e-02_rk,-4.302314372198166526e-17_rk, &
                                        -2.275333730302871958e-17_rk, 1.993978179395398925e-17_rk, -9.760677434251695261e-02_rk,1.474638736292822813e-17_rk, &
                                        -4.691118107171197881e-17_rk, -1.669148458819406063e-17_rk, -4.315225976489258797e-17_rk,9.760677434251699425e-02_rk, &
                                        2.042164942616977037e-17_rk, -2.323520493524449454e-17_rk, 1.461727132001731158e-17_rk,-9.760677434251695261e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        3.642734410091837960e-01_rk, -2.004929849975604327e-17_rk, -5.601351754403988726e-18_rk,1.135380395566985665e-17_rk, &
                                        -3.642734410091836295e-01_rk, 2.440067784413534457e-18_rk, -2.376251242883094798e-17_rk,-2.103110524268887090e-17_rk, &
                                        -2.193546172932211901e-17_rk, 9.760677434251699425e-02_rk, -4.037583158343403364e-17_rk,-2.944224448044780151e-17_rk, &
                                        -1.177774082204186847e-17_rk, -9.760677434251698037e-02_rk, 1.288261603075681868e-17_rk,1.105872832923322324e-17_rk, &
                                        -5.601351754403987185e-18_rk, 1.135380395566985665e-17_rk, 3.642734410091837960e-01_rk,-2.004929849975604327e-17_rk, &
                                        -2.376251242883095415e-17_rk, -2.103110524268888323e-17_rk, -3.642734410091836295e-01_rk,2.440067784413540620e-18_rk, &
                                        -4.037583158343402748e-17_rk, -2.944224448044779535e-17_rk, -2.193546172932211901e-17_rk,9.760677434251699425e-02_rk, &
                                        1.288261603075682485e-17_rk, 1.105872832923322169e-17_rk, -1.177774082204185923e-17_rk,-9.760677434251695261e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        7.285468820183675642e-02_rk, -4.222113870869775461e-18_rk, -6.238584209739458006e-18_rk,9.384748652855367449e-19_rk, &
                                        -1.952135486850339885e-02_rk, -1.262656245594876146e-17_rk, 6.347968378695575561e-18_rk,-2.604336451709856939e-18_rk, &
                                        1.622337010853609276e-18_rk, 2.718973979388435436e-01_rk, 8.241291768368196306e-18_rk,3.418262967787243285e-18_rk, &
                                        -3.640601851892332144e-18_rk, -7.285468820183672867e-02_rk, -8.256366399446097914e-18_rk,-6.294451828178248058e-19_rk, &
                                        -5.454107630015650494e-18_rk, -1.853892766111350664e-17_rk, 1.952135486850341273e-02_rk,-9.516305586561277628e-18_rk, &
                                        -3.389523632439384134e-18_rk, 1.232184758220065843e-17_rk, -5.230731272176844179e-03_rk,-4.250142167286094439e-18_rk, &
                                        -1.665107564754758956e-18_rk, -1.041303755634788858e-17_rk, -8.252752103745843294e-18_rk,7.285468820183674254e-02_rk, &
                                        1.608848275666674814e-18_rk, -1.370735890737685664e-17_rk, 5.232931645587811570e-18_rk,-1.952135486850340579e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.359486989694218106e+00_rk, 1.236802934994305370e-17_rk, -4.379621479807554068e-18_rk,-2.717506050280022006e-17_rk, &
                                        9.760677434251696649e-02_rk, 5.558252269560764840e-17_rk, -1.819031118665290285e-17_rk,2.656799483919858388e-17_rk, &
                                        1.416638383589525700e-17_rk, -1.359486989694218106e+00_rk, -2.765692813501600426e-17_rk,-3.897753847591769868e-18_rk, &
                                        5.738087718155983784e-17_rk, 9.760677434251696649e-02_rk, 2.608612720698279660e-17_rk,-1.770844355443712173e-17_rk, &
                                        6.264424134362362087e-17_rk, 5.542548191136578057e-17_rk, -3.642734410091837960e-01_rk,4.534027709733814128e-17_rk, &
                                        6.224920776383669468e-17_rk, -4.791534300943047635e-17_rk, 2.615365636088419488e-02_rk,9.350572339203865984e-18_rk, &
                                        5.362712742541356649e-17_rk, 6.444259582957582263e-17_rk, 4.582214472955392856e-17_rk,-3.642734410091837960e-01_rk, &
                                        -4.971369749538267195e-17_rk, 6.404756224978889644e-17_rk, 9.832439971419642480e-18_rk,2.615365636088419488e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        3.642734410091837960e-01_rk, -4.688575160074407222e-17_rk, -2.950308235054352057e-17_rk,-4.749731635279490927e-17_rk, &
                                        -2.615365636088423651e-02_rk, -7.273489833704332758e-17_rk, 3.251627769831955866e-18_rk,3.583405566460809414e-17_rk, &
                                        -1.262090933248933376e-17_rk, 1.359486989694218106e+00_rk, 2.104524943018155361e-17_rk,-2.924340514548832735e-17_rk, &
                                        6.003448816279628384e-18_rk, -9.760677434251698037e-02_rk, -1.268835300842399837e-17_rk,-4.779239197923152882e-17_rk, &
                                        -2.950308235054352057e-17_rk, -4.749731635279490927e-17_rk, 3.642734410091837960e-01_rk,-4.688575160074407222e-17_rk, &
                                        3.251627769831956636e-18_rk, 3.583405566460809414e-17_rk, -2.615365636088419488e-02_rk,-7.273489833704333991e-17_rk, &
                                        2.104524943018155361e-17_rk, -2.924340514548832119e-17_rk, -1.262090933248933838e-17_rk,1.359486989694218106e+00_rk, &
                                        -1.268835300842401223e-17_rk, -4.779239197923152882e-17_rk, 6.003448816279625302e-18_rk,-9.760677434251695261e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -7.285468820183675642e-02_rk, 4.222113870869775461e-18_rk, 6.238584209739458006e-18_rk,-9.384748652855367449e-19_rk, &
                                        1.952135486850339885e-02_rk, 1.262656245594876146e-17_rk, -6.347968378695575561e-18_rk,2.604336451709856939e-18_rk, &
                                        -1.622337010853609276e-18_rk, -2.718973979388435436e-01_rk, -8.241291768368196306e-18_rk,-3.418262967787243285e-18_rk, &
                                        3.640601851892332144e-18_rk, 7.285468820183672867e-02_rk, 8.256366399446097914e-18_rk,6.294451828178248058e-19_rk, &
                                        5.454107630015650494e-18_rk, 1.853892766111350664e-17_rk, -1.952135486850341273e-02_rk,9.516305586561277628e-18_rk, &
                                        3.389523632439384134e-18_rk, -1.232184758220065843e-17_rk, 5.230731272176844179e-03_rk,4.250142167286094439e-18_rk, &
                                        1.665107564754758956e-18_rk, 1.041303755634788858e-17_rk, 8.252752103745843294e-18_rk,-7.285468820183674254e-02_rk, &
                                        -1.608848275666674814e-18_rk, 1.370735890737685664e-17_rk, -5.232931645587811570e-18_rk,1.952135486850340579e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -3.642734410091837960e-01_rk, -1.167499535814424151e-18_rk, 1.835211164665771574e-17_rk,-1.824190503325266639e-17_rk, &
                                        3.642734410091835739e-01_rk, 2.395494435764564252e-17_rk, -1.053142083564677133e-17_rk,2.821738704879696110e-17_rk, &
                                        -6.856319035986461148e-19_rk, -3.642734410091837960e-01_rk, -1.837102107616358602e-17_rk,1.848122768956862921e-17_rk, &
                                        2.443681198986141747e-17_rk, 3.642734410091836295e-01_rk, 2.808827100588604455e-17_rk,-1.040230479273585016e-17_rk, &
                                        1.620961695597829492e-17_rk, 4.739304870392775993e-17_rk, -9.760677434251699425e-02_rk,4.302314372198166526e-17_rk, &
                                        2.275333730302871958e-17_rk, -1.993978179395398925e-17_rk, 9.760677434251695261e-02_rk,-1.474638736292822813e-17_rk, &
                                        4.691118107171197881e-17_rk, 1.669148458819406063e-17_rk, 4.315225976489258797e-17_rk,-9.760677434251699425e-02_rk, &
                                        -2.042164942616977037e-17_rk, 2.323520493524449454e-17_rk, -1.461727132001731158e-17_rk,9.760677434251695261e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        9.760677434251699425e-02_rk, -2.180634568641120246e-17_rk, -2.896037684823202655e-17_rk,-4.050494762634495019e-17_rk, &
                                        -9.760677434251695261e-02_rk, -1.164862477913095192e-17_rk, 1.154059596144900589e-17_rk,1.275349998784590676e-17_rk, &
                                        -2.053116613197182439e-17_rk, 3.642734410091837960e-01_rk, 1.183567158788563468e-17_rk,-5.730467797314902194e-18_rk, &
                                        1.958200152197762583e-18_rk, -3.642734410091836295e-01_rk, -2.054923761047309903e-17_rk,-2.389162847174187070e-17_rk, &
                                        -2.896037684823201423e-17_rk, -4.050494762634495019e-17_rk, 9.760677434251699425e-02_rk,-2.180634568641120246e-17_rk, &
                                        1.154059596144900589e-17_rk, 1.275349998784590984e-17_rk, -9.760677434251695261e-02_rk,-1.164862477913095192e-17_rk, &
                                        1.183567158788563468e-17_rk, -5.730467797314897572e-18_rk, -2.053116613197182439e-17_rk,3.642734410091837960e-01_rk, &
                                        -2.054923761047310519e-17_rk, -2.389162847174186761e-17_rk, 1.958200152197762583e-18_rk,-3.642734410091836295e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        7.285468820183674254e-02_rk, -8.156378577302686145e-18_rk, -1.031666402990473143e-17_rk,-2.024778461945198846e-18_rk, &
                                        -1.952135486850339191e-02_rk, 5.329305172030966407e-18_rk, -1.361098538093369641e-17_rk,1.249177378476235695e-18_rk, &
                                        -9.542128795143462478e-18_rk, 1.952135486850341273e-02_rk, -1.844255413467035103e-17_rk,-5.813778527206092695e-18_rk, &
                                        -4.275965375868276208e-18_rk, -5.230731272176847649e-03_rk, 1.241822110864381403e-17_rk,-3.749194529629824024e-18_rk, &
                                        3.444086176369426595e-18_rk, 8.144918241925040699e-18_rk, 2.718973979388435436e-01_rk,1.982007908044050322e-18_rk, &
                                        -6.036219742356420737e-19_rk, -8.352739925889253521e-18_rk, -7.285468820183674254e-02_rk,-3.280930954701892639e-18_rk, &
                                        9.642980738677215955e-19_rk, -6.334957736182613613e-18_rk, -4.318487397312931068e-18_rk,7.285468820183675642e-02_rk, &
                                        -2.578513243127673629e-18_rk, 6.251594852252421495e-18_rk, -1.272293598239191707e-17_rk,-1.952135486850339885e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        3.642734410091837960e-01_rk, -4.534027709733814128e-17_rk, -6.264424134362360854e-17_rk,-5.542548191136578057e-17_rk, &
                                        -2.615365636088425733e-02_rk, -9.350572339203862903e-18_rk, -6.224920776383669468e-17_rk,4.791534300943048251e-17_rk, &
                                        -4.582214472955392856e-17_rk, 3.642734410091837960e-01_rk, -5.362712742541357265e-17_rk,-6.444259582957582263e-17_rk, &
                                        -9.832439971419645561e-18_rk, -2.615365636088424345e-02_rk, 4.971369749538267195e-17_rk,-6.404756224978889644e-17_rk, &
                                        4.379621479807547905e-18_rk, 2.717506050280022006e-17_rk, 1.359486989694218106e+00_rk,-1.236802934994305370e-17_rk, &
                                        1.819031118665289977e-17_rk, -2.656799483919858388e-17_rk, -9.760677434251695261e-02_rk,-5.558252269560763608e-17_rk, &
                                        2.765692813501599502e-17_rk, 3.897753847591769868e-18_rk, -1.416638383589526316e-17_rk,1.359486989694218106e+00_rk, &
                                        -2.608612720698280893e-17_rk, 1.770844355443712173e-17_rk, -5.738087718155983784e-17_rk,-9.760677434251695261e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.359486989694218106e+00_rk, 1.082255484653712892e-17_rk, 2.876153751327254007e-17_rk,-1.924689494422934876e-17_rk, &
                                        9.760677434251698037e-02_rk, -7.801803302231827062e-18_rk, 4.731052434701574770e-17_rk,1.448670749437619550e-17_rk, &
                                        4.736761923295984718e-17_rk, -3.642734410091837960e-01_rk, 4.701544872057912199e-17_rk,3.130143683649572849e-17_rk, &
                                        7.321676596925912103e-17_rk, 2.615365636088422263e-02_rk, -3.631592329682387525e-17_rk,-1.453273283879755647e-18_rk, &
                                        2.876153751327254623e-17_rk, -1.924689494422934876e-17_rk, -1.359486989694218106e+00_rk,1.082255484653712584e-17_rk, &
                                        4.731052434701575386e-17_rk, 1.448670749437620783e-17_rk, 9.760677434251695261e-02_rk,-7.801803302231830143e-18_rk, &
                                        4.701544872057912815e-17_rk, 3.130143683649573465e-17_rk, 4.736761923295985334e-17_rk,-3.642734410091837960e-01_rk, &
                                        -3.631592329682388142e-17_rk, -1.453273283879756417e-18_rk, 7.321676596925909637e-17_rk,2.615365636088419488e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -7.285468820183674254e-02_rk, 8.156378577302686145e-18_rk, 1.031666402990473143e-17_rk,2.024778461945198846e-18_rk, &
                                        1.952135486850339191e-02_rk, -5.329305172030966407e-18_rk, 1.361098538093369641e-17_rk,-1.249177378476235695e-18_rk, &
                                        9.542128795143462478e-18_rk, -1.952135486850341273e-02_rk, 1.844255413467035103e-17_rk,5.813778527206092695e-18_rk, &
                                        4.275965375868276208e-18_rk, 5.230731272176847649e-03_rk, -1.241822110864381403e-17_rk,3.749194529629824024e-18_rk, &
                                        -3.444086176369426595e-18_rk, -8.144918241925040699e-18_rk, -2.718973979388435436e-01_rk,-1.982007908044050322e-18_rk, &
                                        6.036219742356420737e-19_rk, 8.352739925889253521e-18_rk, 7.285468820183674254e-02_rk,3.280930954701892639e-18_rk, &
                                        -9.642980738677215955e-19_rk, 6.334957736182613613e-18_rk, 4.318487397312931068e-18_rk,-7.285468820183675642e-02_rk, &
                                        2.578513243127673629e-18_rk, -6.251594852252421495e-18_rk, 1.272293598239191707e-17_rk,1.952135486850339885e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        9.760677434251699425e-02_rk, -4.302314372198166526e-17_rk, -1.620961695597829492e-17_rk,-4.739304870392775993e-17_rk, &
                                        -9.760677434251696649e-02_rk, 1.474638736292822813e-17_rk, -2.275333730302871342e-17_rk,1.993978179395399541e-17_rk, &
                                        -4.315225976489258797e-17_rk, 9.760677434251699425e-02_rk, -4.691118107171198498e-17_rk,-1.669148458819406987e-17_rk, &
                                        1.461727132001731158e-17_rk, -9.760677434251696649e-02_rk, 2.042164942616975804e-17_rk,-2.323520493524449454e-17_rk, &
                                        -1.835211164665771266e-17_rk, 1.824190503325266639e-17_rk, 3.642734410091837960e-01_rk,1.167499535814424151e-18_rk, &
                                        1.053142083564676825e-17_rk, -2.821738704879696726e-17_rk, -3.642734410091836295e-01_rk,-2.395494435764563635e-17_rk, &
                                        1.837102107616358293e-17_rk, -1.848122768956862921e-17_rk, 6.856319035986461148e-19_rk,3.642734410091837960e-01_rk, &
                                        -2.808827100588604455e-17_rk, 1.040230479273584862e-17_rk, -2.443681198986141131e-17_rk,-3.642734410091836295e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -3.642734410091837960e-01_rk, 2.004929849975604327e-17_rk, 5.601351754403988726e-18_rk,-1.135380395566985665e-17_rk, &
                                        3.642734410091836295e-01_rk, -2.440067784413534457e-18_rk, 2.376251242883094798e-17_rk,2.103110524268887090e-17_rk, &
                                        2.193546172932211901e-17_rk, -9.760677434251699425e-02_rk, 4.037583158343403364e-17_rk,2.944224448044780151e-17_rk, &
                                        1.177774082204186847e-17_rk, 9.760677434251698037e-02_rk, -1.288261603075681868e-17_rk,-1.105872832923322324e-17_rk, &
                                        5.601351754403987185e-18_rk, -1.135380395566985665e-17_rk, -3.642734410091837960e-01_rk,2.004929849975604327e-17_rk, &
                                        2.376251242883095415e-17_rk, 2.103110524268888323e-17_rk, 3.642734410091836295e-01_rk,-2.440067784413540620e-18_rk, &
                                        4.037583158343402748e-17_rk, 2.944224448044779535e-17_rk, 2.193546172932211901e-17_rk,-9.760677434251699425e-02_rk, &
                                        -1.288261603075682485e-17_rk, -1.105872832923322169e-17_rk, 1.177774082204185923e-17_rk,9.760677434251695261e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.952135486850341273e-02_rk, -9.516305586561279168e-18_rk, -5.454107630015654346e-18_rk,-1.853892766111350664e-17_rk, &
                                        -5.230731272176847649e-03_rk, -4.250142167286093669e-18_rk, -3.389523632439384134e-18_rk,1.232184758220065843e-17_rk, &
                                        -8.252752103745841753e-18_rk, 7.285468820183674254e-02_rk, -1.665107564754758956e-18_rk,-1.041303755634788704e-17_rk, &
                                        5.232931645587811570e-18_rk, -1.952135486850339191e-02_rk, 1.608848275666675584e-18_rk,-1.370735890737685664e-17_rk, &
                                        -6.238584209739456465e-18_rk, 9.384748652855367449e-19_rk, 7.285468820183675642e-02_rk,-4.222113870869776231e-18_rk, &
                                        6.347968378695577102e-18_rk, -2.604336451709856939e-18_rk, -1.952135486850339885e-02_rk,-1.262656245594876146e-17_rk, &
                                        8.241291768368196306e-18_rk, 3.418262967787242900e-18_rk, 1.622337010853609276e-18_rk,2.718973979388435436e-01_rk, &
                                        -8.256366399446097914e-18_rk, -6.294451828178248058e-19_rk, -3.640601851892332144e-18_rk,-7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -3.642734410091837960e-01_rk, 4.534027709733814128e-17_rk, 6.264424134362360854e-17_rk,5.542548191136578057e-17_rk, &
                                        2.615365636088425733e-02_rk, 9.350572339203862903e-18_rk, 6.224920776383669468e-17_rk,-4.791534300943048251e-17_rk, &
                                        4.582214472955392856e-17_rk, -3.642734410091837960e-01_rk, 5.362712742541357265e-17_rk,6.444259582957582263e-17_rk, &
                                        9.832439971419645561e-18_rk, 2.615365636088424345e-02_rk, -4.971369749538267195e-17_rk,6.404756224978889644e-17_rk, &
                                        -4.379621479807547905e-18_rk, -2.717506050280022006e-17_rk, -1.359486989694218106e+00_rk,1.236802934994305370e-17_rk, &
                                        -1.819031118665289977e-17_rk, 2.656799483919858388e-17_rk, 9.760677434251695261e-02_rk,5.558252269560763608e-17_rk, &
                                        -2.765692813501599502e-17_rk, -3.897753847591769868e-18_rk, 1.416638383589526316e-17_rk,-1.359486989694218106e+00_rk, &
                                        2.608612720698280893e-17_rk, -1.770844355443712173e-17_rk, 5.738087718155983784e-17_rk,9.760677434251695261e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -3.642734410091837960e-01_rk, 4.688575160074407222e-17_rk, 2.950308235054352057e-17_rk,4.749731635279490927e-17_rk, &
                                        2.615365636088423651e-02_rk, 7.273489833704332758e-17_rk, -3.251627769831955866e-18_rk,-3.583405566460809414e-17_rk, &
                                        1.262090933248933376e-17_rk, -1.359486989694218106e+00_rk, -2.104524943018155361e-17_rk,2.924340514548832735e-17_rk, &
                                        -6.003448816279628384e-18_rk, 9.760677434251698037e-02_rk, 1.268835300842399837e-17_rk,4.779239197923152882e-17_rk, &
                                        2.950308235054352057e-17_rk, 4.749731635279490927e-17_rk, -3.642734410091837960e-01_rk,4.688575160074407222e-17_rk, &
                                        -3.251627769831956636e-18_rk, -3.583405566460809414e-17_rk, 2.615365636088419488e-02_rk,7.273489833704333991e-17_rk, &
                                        -2.104524943018155361e-17_rk, 2.924340514548832119e-17_rk, 1.262090933248933838e-17_rk,-1.359486989694218106e+00_rk, &
                                        1.268835300842401223e-17_rk, 4.779239197923152882e-17_rk, -6.003448816279625302e-18_rk,9.760677434251695261e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.952135486850341273e-02_rk, 9.516305586561279168e-18_rk, 5.454107630015654346e-18_rk,1.853892766111350664e-17_rk, &
                                        5.230731272176847649e-03_rk, 4.250142167286093669e-18_rk, 3.389523632439384134e-18_rk,-1.232184758220065843e-17_rk, &
                                        8.252752103745841753e-18_rk, -7.285468820183674254e-02_rk, 1.665107564754758956e-18_rk,1.041303755634788704e-17_rk, &
                                        -5.232931645587811570e-18_rk, 1.952135486850339191e-02_rk, -1.608848275666675584e-18_rk,1.370735890737685664e-17_rk, &
                                        6.238584209739456465e-18_rk, -9.384748652855367449e-19_rk, -7.285468820183675642e-02_rk,4.222113870869776231e-18_rk, &
                                        -6.347968378695577102e-18_rk, 2.604336451709856939e-18_rk, 1.952135486850339885e-02_rk,1.262656245594876146e-17_rk, &
                                        -8.241291768368196306e-18_rk, -3.418262967787242900e-18_rk, -1.622337010853609276e-18_rk,-2.718973979388435436e-01_rk, &
                                        8.256366399446097914e-18_rk, 6.294451828178248058e-19_rk, 3.640601851892332144e-18_rk,7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -9.760677434251699425e-02_rk, 4.302314372198166526e-17_rk, 1.620961695597829492e-17_rk,4.739304870392775993e-17_rk, &
                                        9.760677434251696649e-02_rk, -1.474638736292822813e-17_rk, 2.275333730302871342e-17_rk,-1.993978179395399541e-17_rk, &
                                        4.315225976489258797e-17_rk, -9.760677434251699425e-02_rk, 4.691118107171198498e-17_rk,1.669148458819406987e-17_rk, &
                                        -1.461727132001731158e-17_rk, 9.760677434251696649e-02_rk, -2.042164942616975804e-17_rk,2.323520493524449454e-17_rk, &
                                        1.835211164665771266e-17_rk, -1.824190503325266639e-17_rk, -3.642734410091837960e-01_rk,-1.167499535814424151e-18_rk, &
                                        -1.053142083564676825e-17_rk, 2.821738704879696726e-17_rk, 3.642734410091836295e-01_rk,2.395494435764563635e-17_rk, &
                                        -1.837102107616358293e-17_rk, 1.848122768956862921e-17_rk, -6.856319035986461148e-19_rk,-3.642734410091837960e-01_rk, &
                                        2.808827100588604455e-17_rk, -1.040230479273584862e-17_rk, 2.443681198986141131e-17_rk,3.642734410091836295e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -9.760677434251699425e-02_rk, 2.180634568641120246e-17_rk, 2.896037684823202655e-17_rk,4.050494762634495019e-17_rk, &
                                        9.760677434251695261e-02_rk, 1.164862477913095192e-17_rk, -1.154059596144900589e-17_rk,-1.275349998784590676e-17_rk, &
                                        2.053116613197182439e-17_rk, -3.642734410091837960e-01_rk, -1.183567158788563468e-17_rk,5.730467797314902194e-18_rk, &
                                        -1.958200152197762583e-18_rk, 3.642734410091836295e-01_rk, 2.054923761047309903e-17_rk,2.389162847174187070e-17_rk, &
                                        2.896037684823201423e-17_rk, 4.050494762634495019e-17_rk, -9.760677434251699425e-02_rk,2.180634568641120246e-17_rk, &
                                        -1.154059596144900589e-17_rk, -1.275349998784590984e-17_rk, 9.760677434251695261e-02_rk,1.164862477913095192e-17_rk, &
                                        -1.183567158788563468e-17_rk, 5.730467797314897572e-18_rk, 2.053116613197182439e-17_rk,-3.642734410091837960e-01_rk, &
                                        2.054923761047310519e-17_rk, 2.389162847174186761e-17_rk, -1.958200152197762583e-18_rk,3.642734410091836295e-01_rk  &
                                        /),(/4,8/))
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        !
        ! dbr2_vol_face2_dx
        ! 
        test_dbr2_vol_face2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -7.285468820183672867e-02_rk, -3.280930954701892639e-18_rk, -6.036219742356420737e-19_rk,-8.352739925889251980e-18_rk, &
                                        2.718973979388435436e-01_rk, 1.982007908044050322e-18_rk, 3.444086176369425440e-18_rk,8.144918241925040699e-18_rk, &
                                        -1.272293598239191707e-17_rk, -1.952135486850339885e-02_rk, -2.578513243127672859e-18_rk,6.251594852252422265e-18_rk, &
                                        -4.318487397312932609e-18_rk, 7.285468820183675642e-02_rk, 9.642980738677227511e-19_rk,-6.334957736182612843e-18_rk, &
                                        -1.361098538093369949e-17_rk, 1.249177378476234539e-18_rk, -1.952135486850340579e-02_rk,5.329305172030967177e-18_rk, &
                                        -1.031666402990473143e-17_rk, -2.024778461945198846e-18_rk, 7.285468820183674254e-02_rk,-8.156378577302686145e-18_rk, &
                                        1.241822110864381403e-17_rk, -3.749194529629824024e-18_rk, -4.275965375868277749e-18_rk,-5.230731272176844179e-03_rk, &
                                        -1.844255413467035103e-17_rk, -5.813778527206091924e-18_rk, -9.542128795143462478e-18_rk,1.952135486850341273e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -3.642734410091836295e-01_rk, -2.395494435764563635e-17_rk, 1.053142083564677133e-17_rk,-2.821738704879696726e-17_rk, &
                                        3.642734410091837960e-01_rk, 1.167499535814427233e-18_rk, -1.835211164665770958e-17_rk,1.824190503325266639e-17_rk, &
                                        -2.443681198986141747e-17_rk, -3.642734410091836295e-01_rk, -2.808827100588603839e-17_rk,1.040230479273584554e-17_rk, &
                                        6.856319035986430333e-19_rk, 3.642734410091837960e-01_rk, 1.837102107616358293e-17_rk,-1.848122768956862921e-17_rk, &
                                        -2.275333730302871958e-17_rk, 1.993978179395398925e-17_rk, -9.760677434251695261e-02_rk,1.474638736292821889e-17_rk, &
                                        -1.620961695597828875e-17_rk, -4.739304870392775993e-17_rk, 9.760677434251699425e-02_rk,-4.302314372198166526e-17_rk, &
                                        2.042164942616976729e-17_rk, -2.323520493524449454e-17_rk, 1.461727132001730850e-17_rk,-9.760677434251695261e-02_rk, &
                                        -4.691118107171198498e-17_rk, -1.669148458819406987e-17_rk, -4.315225976489258797e-17_rk,9.760677434251699425e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -3.642734410091836295e-01_rk, 2.440067784413543701e-18_rk, -2.376251242883094798e-17_rk,-2.103110524268888323e-17_rk, &
                                        3.642734410091837960e-01_rk, -2.004929849975604327e-17_rk, -5.601351754403981022e-18_rk,1.135380395566985511e-17_rk, &
                                        -1.177774082204186231e-17_rk, -9.760677434251696649e-02_rk, 1.288261603075682485e-17_rk,1.105872832923322015e-17_rk, &
                                        -2.193546172932211901e-17_rk, 9.760677434251699425e-02_rk, -4.037583158343402748e-17_rk,-2.944224448044780151e-17_rk, &
                                        -2.376251242883095107e-17_rk, -2.103110524268888015e-17_rk, -3.642734410091836295e-01_rk,2.440067784413531375e-18_rk, &
                                        -5.601351754403984104e-18_rk, 1.135380395566985665e-17_rk, 3.642734410091837960e-01_rk,-2.004929849975604327e-17_rk, &
                                        1.288261603075682177e-17_rk, 1.105872832923322169e-17_rk, -1.177774082204186539e-17_rk,-9.760677434251695261e-02_rk, &
                                        -4.037583158343403364e-17_rk, -2.944224448044780151e-17_rk, -2.193546172932211901e-17_rk,9.760677434251699425e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        7.285468820183672867e-02_rk, 3.280930954701892639e-18_rk, 6.036219742356420737e-19_rk,8.352739925889251980e-18_rk, &
                                        -2.718973979388435436e-01_rk, -1.982007908044050322e-18_rk, -3.444086176369425440e-18_rk,-8.144918241925040699e-18_rk, &
                                        1.272293598239191707e-17_rk, 1.952135486850339885e-02_rk, 2.578513243127672859e-18_rk,-6.251594852252422265e-18_rk, &
                                        4.318487397312932609e-18_rk, -7.285468820183675642e-02_rk, -9.642980738677227511e-19_rk,6.334957736182612843e-18_rk, &
                                        1.361098538093369949e-17_rk, -1.249177378476234539e-18_rk, 1.952135486850340579e-02_rk,-5.329305172030967177e-18_rk, &
                                        1.031666402990473143e-17_rk, 2.024778461945198846e-18_rk, -7.285468820183674254e-02_rk,8.156378577302686145e-18_rk, &
                                        -1.241822110864381403e-17_rk, 3.749194529629824024e-18_rk, 4.275965375868277749e-18_rk,5.230731272176844179e-03_rk, &
                                        1.844255413467035103e-17_rk, 5.813778527206091924e-18_rk, 9.542128795143462478e-18_rk,-1.952135486850341273e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -9.760677434251696649e-02_rk, -5.558252269560763608e-17_rk, 1.819031118665289669e-17_rk,-2.656799483919858388e-17_rk, &
                                        1.359486989694218106e+00_rk, -1.236802934994305678e-17_rk, 4.379621479807554068e-18_rk,2.717506050280022006e-17_rk, &
                                        -5.738087718155983784e-17_rk, -9.760677434251696649e-02_rk, -2.608612720698280276e-17_rk,1.770844355443711865e-17_rk, &
                                        -1.416638383589525700e-17_rk, 1.359486989694218106e+00_rk, 2.765692813501600118e-17_rk,3.897753847591763705e-18_rk, &
                                        -6.224920776383669468e-17_rk, 4.791534300943047635e-17_rk, -2.615365636088419488e-02_rk,-9.350572339203865984e-18_rk, &
                                        -6.264424134362360854e-17_rk, -5.542548191136578057e-17_rk, 3.642734410091837960e-01_rk,-4.534027709733814744e-17_rk, &
                                        4.971369749538267811e-17_rk, -6.404756224978889644e-17_rk, -9.832439971419642480e-18_rk,-2.615365636088419488e-02_rk, &
                                        -5.362712742541356649e-17_rk, -6.444259582957582263e-17_rk, -4.582214472955392856e-17_rk,3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -9.760677434251696649e-02_rk, 7.801803302231827062e-18_rk, -4.731052434701575386e-17_rk,-1.448670749437620475e-17_rk, &
                                        1.359486989694218106e+00_rk, -1.082255484653713508e-17_rk, -2.876153751327254007e-17_rk,1.924689494422934876e-17_rk, &
                                        -7.321676596925910870e-17_rk, -2.615365636088424345e-02_rk, 3.631592329682387525e-17_rk,1.453273283879752566e-18_rk, &
                                        -4.736761923295984718e-17_rk, 3.642734410091837960e-01_rk, -4.701544872057912199e-17_rk,-3.130143683649572849e-17_rk, &
                                        -4.731052434701574770e-17_rk, -1.448670749437620783e-17_rk, -9.760677434251693874e-02_rk,7.801803302231830143e-18_rk, &
                                        -2.876153751327254007e-17_rk, 1.924689494422934876e-17_rk, 1.359486989694218106e+00_rk,-1.082255484653712892e-17_rk, &
                                        3.631592329682387525e-17_rk, 1.453273283879756417e-18_rk, -7.321676596925910870e-17_rk,-2.615365636088419488e-02_rk, &
                                        -4.701544872057911583e-17_rk, -3.130143683649572849e-17_rk, -4.736761923295984718e-17_rk,3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -1.952135486850339885e-02_rk, -1.262656245594876146e-17_rk, 6.347968378695577102e-18_rk,-2.604336451709856169e-18_rk, &
                                        7.285468820183675642e-02_rk, -4.222113870869776231e-18_rk, -6.238584209739457235e-18_rk,9.384748652855363597e-19_rk, &
                                        -3.640601851892332144e-18_rk, -7.285468820183672867e-02_rk, -8.256366399446094832e-18_rk,-6.294451828178259614e-19_rk, &
                                        1.622337010853608699e-18_rk, 2.718973979388435436e-01_rk, 8.241291768368199388e-18_rk,3.418262967787244056e-18_rk, &
                                        -3.389523632439384134e-18_rk, 1.232184758220065689e-17_rk, -5.230731272176844179e-03_rk,-4.250142167286092898e-18_rk, &
                                        -5.454107630015651264e-18_rk, -1.853892766111350664e-17_rk, 1.952135486850341273e-02_rk,-9.516305586561277628e-18_rk, &
                                        1.608848275666674621e-18_rk, -1.370735890737685664e-17_rk, 5.232931645587810800e-18_rk,-1.952135486850340579e-02_rk, &
                                        -1.665107564754758956e-18_rk, -1.041303755634788550e-17_rk, -8.252752103745843294e-18_rk,7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        3.642734410091836295e-01_rk, 2.395494435764563635e-17_rk, -1.053142083564677133e-17_rk,2.821738704879696726e-17_rk, &
                                        -3.642734410091837960e-01_rk, -1.167499535814427233e-18_rk, 1.835211164665770958e-17_rk,-1.824190503325266639e-17_rk, &
                                        2.443681198986141747e-17_rk, 3.642734410091836295e-01_rk, 2.808827100588603839e-17_rk,-1.040230479273584554e-17_rk, &
                                        -6.856319035986430333e-19_rk, -3.642734410091837960e-01_rk, -1.837102107616358293e-17_rk,1.848122768956862921e-17_rk, &
                                        2.275333730302871958e-17_rk, -1.993978179395398925e-17_rk, 9.760677434251695261e-02_rk,-1.474638736292821889e-17_rk, &
                                        1.620961695597828875e-17_rk, 4.739304870392775993e-17_rk, -9.760677434251699425e-02_rk,4.302314372198166526e-17_rk, &
                                        -2.042164942616976729e-17_rk, 2.323520493524449454e-17_rk, -1.461727132001730850e-17_rk,9.760677434251695261e-02_rk, &
                                        4.691118107171198498e-17_rk, 1.669148458819406987e-17_rk, 4.315225976489258797e-17_rk,-9.760677434251699425e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -9.760677434251696649e-02_rk, -1.164862477913095500e-17_rk, 1.154059596144900589e-17_rk,1.275349998784590368e-17_rk, &
                                        9.760677434251699425e-02_rk, -2.180634568641120246e-17_rk, -2.896037684823201423e-17_rk,-4.050494762634495019e-17_rk, &
                                        1.958200152197756420e-18_rk, -3.642734410091836295e-01_rk, -2.054923761047309903e-17_rk,-2.389162847174187070e-17_rk, &
                                        -2.053116613197182439e-17_rk, 3.642734410091837960e-01_rk, 1.183567158788563468e-17_rk,-5.730467797314900653e-18_rk, &
                                        1.154059596144900281e-17_rk, 1.275349998784590830e-17_rk, -9.760677434251693874e-02_rk,-1.164862477913095808e-17_rk, &
                                        -2.896037684823201423e-17_rk, -4.050494762634495019e-17_rk, 9.760677434251699425e-02_rk,-2.180634568641119630e-17_rk, &
                                        -2.054923761047310211e-17_rk, -2.389162847174186761e-17_rk, 1.958200152197759502e-18_rk,-3.642734410091836295e-01_rk, &
                                        1.183567158788563468e-17_rk, -5.730467797314899883e-18_rk, -2.053116613197182439e-17_rk,3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        1.952135486850339885e-02_rk, 1.262656245594876146e-17_rk, -6.347968378695577102e-18_rk,2.604336451709856169e-18_rk, &
                                        -7.285468820183675642e-02_rk, 4.222113870869776231e-18_rk, 6.238584209739457235e-18_rk,-9.384748652855363597e-19_rk, &
                                        3.640601851892332144e-18_rk, 7.285468820183672867e-02_rk, 8.256366399446094832e-18_rk,6.294451828178259614e-19_rk, &
                                        -1.622337010853608699e-18_rk, -2.718973979388435436e-01_rk, -8.241291768368199388e-18_rk,-3.418262967787244056e-18_rk, &
                                        3.389523632439384134e-18_rk, -1.232184758220065689e-17_rk, 5.230731272176844179e-03_rk,4.250142167286092898e-18_rk, &
                                        5.454107630015651264e-18_rk, 1.853892766111350664e-17_rk, -1.952135486850341273e-02_rk,9.516305586561277628e-18_rk, &
                                        -1.608848275666674621e-18_rk, 1.370735890737685664e-17_rk, -5.232931645587810800e-18_rk,1.952135486850340579e-02_rk, &
                                        1.665107564754758956e-18_rk, 1.041303755634788550e-17_rk, 8.252752103745843294e-18_rk,-7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        9.760677434251696649e-02_rk, 5.558252269560763608e-17_rk, -1.819031118665289669e-17_rk,2.656799483919858388e-17_rk, &
                                        -1.359486989694218106e+00_rk, 1.236802934994305678e-17_rk, -4.379621479807554068e-18_rk,-2.717506050280022006e-17_rk, &
                                        5.738087718155983784e-17_rk, 9.760677434251696649e-02_rk, 2.608612720698280276e-17_rk,-1.770844355443711865e-17_rk, &
                                        1.416638383589525700e-17_rk, -1.359486989694218106e+00_rk, -2.765692813501600118e-17_rk,-3.897753847591763705e-18_rk, &
                                        6.224920776383669468e-17_rk, -4.791534300943047635e-17_rk, 2.615365636088419488e-02_rk,9.350572339203865984e-18_rk, &
                                        6.264424134362360854e-17_rk, 5.542548191136578057e-17_rk, -3.642734410091837960e-01_rk,4.534027709733814744e-17_rk, &
                                        -4.971369749538267811e-17_rk, 6.404756224978889644e-17_rk, 9.832439971419642480e-18_rk,2.615365636088419488e-02_rk, &
                                        5.362712742541356649e-17_rk, 6.444259582957582263e-17_rk, 4.582214472955392856e-17_rk,-3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -2.615365636088424345e-02_rk, -7.273489833704333991e-17_rk, 3.251627769831949703e-18_rk,3.583405566460809414e-17_rk, &
                                        3.642734410091837960e-01_rk, -4.688575160074407222e-17_rk, -2.950308235054352057e-17_rk,-4.749731635279490927e-17_rk, &
                                        6.003448816279622221e-18_rk, -9.760677434251696649e-02_rk, -1.268835300842400607e-17_rk,-4.779239197923153498e-17_rk, &
                                        -1.262090933248933068e-17_rk, 1.359486989694218106e+00_rk, 2.104524943018155669e-17_rk,-2.924340514548832735e-17_rk, &
                                        3.251627769831953555e-18_rk, 3.583405566460809414e-17_rk, -2.615365636088420181e-02_rk,-7.273489833704333991e-17_rk, &
                                        -2.950308235054352057e-17_rk, -4.749731635279490927e-17_rk, 3.642734410091837960e-01_rk,-4.688575160074407222e-17_rk, &
                                        -1.268835300842400607e-17_rk, -4.779239197923152882e-17_rk, 6.003448816279637628e-18_rk,-9.760677434251695261e-02_rk, &
                                        2.104524943018155977e-17_rk, -2.924340514548832119e-17_rk, -1.262090933248933376e-17_rk,1.359486989694218106e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.952135486850339191e-02_rk, 5.329305172030966407e-18_rk, -1.361098538093369949e-17_rk,1.249177378476234924e-18_rk, &
                                        7.285468820183674254e-02_rk, -8.156378577302686145e-18_rk, -1.031666402990472989e-17_rk,-2.024778461945200002e-18_rk, &
                                        -4.275965375868276208e-18_rk, -5.230731272176847649e-03_rk, 1.241822110864381403e-17_rk,-3.749194529629824024e-18_rk, &
                                        -9.542128795143460938e-18_rk, 1.952135486850341273e-02_rk, -1.844255413467035411e-17_rk,-5.813778527206091924e-18_rk, &
                                        -6.036219742356421700e-19_rk, -8.352739925889255062e-18_rk, -7.285468820183674254e-02_rk,-3.280930954701891869e-18_rk, &
                                        3.444086176369425055e-18_rk, 8.144918241925040699e-18_rk, 2.718973979388435436e-01_rk,1.982007908044050322e-18_rk, &
                                        -2.578513243127674014e-18_rk, 6.251594852252423036e-18_rk, -1.272293598239191707e-17_rk,-1.952135486850339885e-02_rk, &
                                        9.642980738677215955e-19_rk, -6.334957736182612072e-18_rk, -4.318487397312931838e-18_rk,7.285468820183675642e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -9.760677434251696649e-02_rk, 1.474638736292822813e-17_rk, -2.275333730302871342e-17_rk,1.993978179395398925e-17_rk, &
                                        9.760677434251699425e-02_rk, -4.302314372198167142e-17_rk, -1.620961695597828875e-17_rk,-4.739304870392775993e-17_rk, &
                                        1.461727132001731158e-17_rk, -9.760677434251696649e-02_rk, 2.042164942616976421e-17_rk,-2.323520493524449454e-17_rk, &
                                        -4.315225976489258181e-17_rk, 9.760677434251699425e-02_rk, -4.691118107171197881e-17_rk,-1.669148458819407295e-17_rk, &
                                        1.053142083564676825e-17_rk, -2.821738704879696726e-17_rk, -3.642734410091836295e-01_rk,-2.395494435764564560e-17_rk, &
                                        -1.835211164665770958e-17_rk, 1.824190503325266639e-17_rk, 3.642734410091837960e-01_rk,1.167499535814430314e-18_rk, &
                                        -2.808827100588604455e-17_rk, 1.040230479273585016e-17_rk, -2.443681198986141439e-17_rk,-3.642734410091836295e-01_rk, &
                                        1.837102107616358602e-17_rk, -1.848122768956863229e-17_rk, 6.856319035986465000e-19_rk,3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        3.642734410091836295e-01_rk, -2.440067784413543701e-18_rk, 2.376251242883094798e-17_rk,2.103110524268888323e-17_rk, &
                                        -3.642734410091837960e-01_rk, 2.004929849975604327e-17_rk, 5.601351754403981022e-18_rk,-1.135380395566985511e-17_rk, &
                                        1.177774082204186231e-17_rk, 9.760677434251696649e-02_rk, -1.288261603075682485e-17_rk,-1.105872832923322015e-17_rk, &
                                        2.193546172932211901e-17_rk, -9.760677434251699425e-02_rk, 4.037583158343402748e-17_rk,2.944224448044780151e-17_rk, &
                                        2.376251242883095107e-17_rk, 2.103110524268888015e-17_rk, 3.642734410091836295e-01_rk,-2.440067784413531375e-18_rk, &
                                        5.601351754403984104e-18_rk, -1.135380395566985665e-17_rk, -3.642734410091837960e-01_rk,2.004929849975604327e-17_rk, &
                                        -1.288261603075682177e-17_rk, -1.105872832923322169e-17_rk, 1.177774082204186539e-17_rk,9.760677434251695261e-02_rk, &
                                        4.037583158343403364e-17_rk, 2.944224448044780151e-17_rk, 2.193546172932211901e-17_rk,-9.760677434251699425e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        1.952135486850339191e-02_rk, -5.329305172030966407e-18_rk, 1.361098538093369949e-17_rk,-1.249177378476234924e-18_rk, &
                                        -7.285468820183674254e-02_rk, 8.156378577302686145e-18_rk, 1.031666402990472989e-17_rk,2.024778461945200002e-18_rk, &
                                        4.275965375868276208e-18_rk, 5.230731272176847649e-03_rk, -1.241822110864381403e-17_rk,3.749194529629824024e-18_rk, &
                                        9.542128795143460938e-18_rk, -1.952135486850341273e-02_rk, 1.844255413467035411e-17_rk,5.813778527206091924e-18_rk, &
                                        6.036219742356421700e-19_rk, 8.352739925889255062e-18_rk, 7.285468820183674254e-02_rk,3.280930954701891869e-18_rk, &
                                        -3.444086176369425055e-18_rk, -8.144918241925040699e-18_rk, -2.718973979388435436e-01_rk,-1.982007908044050322e-18_rk, &
                                        2.578513243127674014e-18_rk, -6.251594852252423036e-18_rk, 1.272293598239191707e-17_rk,1.952135486850339885e-02_rk, &
                                        -9.642980738677215955e-19_rk, 6.334957736182612072e-18_rk, 4.318487397312931838e-18_rk,-7.285468820183675642e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -2.615365636088424345e-02_rk, -9.350572339203867525e-18_rk, -6.224920776383669468e-17_rk,4.791534300943047635e-17_rk, &
                                        3.642734410091837960e-01_rk, -4.534027709733815360e-17_rk, -6.264424134362360854e-17_rk,-5.542548191136578057e-17_rk, &
                                        -9.832439971419645561e-18_rk, -2.615365636088425039e-02_rk, 4.971369749538266578e-17_rk,-6.404756224978889644e-17_rk, &
                                        -4.582214472955392240e-17_rk, 3.642734410091837960e-01_rk, -5.362712742541356032e-17_rk,-6.444259582957582263e-17_rk, &
                                        1.819031118665289977e-17_rk, -2.656799483919858388e-17_rk, -9.760677434251695261e-02_rk,-5.558252269560763608e-17_rk, &
                                        4.379621479807554068e-18_rk, 2.717506050280022006e-17_rk, 1.359486989694218106e+00_rk,-1.236802934994305062e-17_rk, &
                                        -2.608612720698280584e-17_rk, 1.770844355443712173e-17_rk, -5.738087718155983784e-17_rk,-9.760677434251695261e-02_rk, &
                                        2.765692813501601043e-17_rk, 3.897753847591766787e-18_rk, -1.416638383589525700e-17_rk,1.359486989694218106e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        9.760677434251696649e-02_rk, -7.801803302231827062e-18_rk, 4.731052434701575386e-17_rk,1.448670749437620475e-17_rk, &
                                        -1.359486989694218106e+00_rk, 1.082255484653713508e-17_rk, 2.876153751327254007e-17_rk,-1.924689494422934876e-17_rk, &
                                        7.321676596925910870e-17_rk, 2.615365636088424345e-02_rk, -3.631592329682387525e-17_rk,-1.453273283879752566e-18_rk, &
                                        4.736761923295984718e-17_rk, -3.642734410091837960e-01_rk, 4.701544872057912199e-17_rk,3.130143683649572849e-17_rk, &
                                        4.731052434701574770e-17_rk, 1.448670749437620783e-17_rk, 9.760677434251693874e-02_rk,-7.801803302231830143e-18_rk, &
                                        2.876153751327254007e-17_rk, -1.924689494422934876e-17_rk, -1.359486989694218106e+00_rk,1.082255484653712892e-17_rk, &
                                        -3.631592329682387525e-17_rk, -1.453273283879756417e-18_rk, 7.321676596925910870e-17_rk,2.615365636088419488e-02_rk, &
                                        4.701544872057911583e-17_rk, 3.130143683649572849e-17_rk, 4.736761923295984718e-17_rk,-3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -5.230731272176847649e-03_rk, -4.250142167286093669e-18_rk, -3.389523632439384134e-18_rk,1.232184758220065689e-17_rk, &
                                        1.952135486850341273e-02_rk, -9.516305586561277628e-18_rk, -5.454107630015652805e-18_rk,-1.853892766111350664e-17_rk, &
                                        5.232931645587811570e-18_rk, -1.952135486850339191e-02_rk, 1.608848275666675584e-18_rk,-1.370735890737685356e-17_rk, &
                                        -8.252752103745841753e-18_rk, 7.285468820183674254e-02_rk, -1.665107564754760112e-18_rk,-1.041303755634788550e-17_rk, &
                                        6.347968378695577102e-18_rk, -2.604336451709858094e-18_rk, -1.952135486850339885e-02_rk,-1.262656245594875992e-17_rk, &
                                        -6.238584209739456465e-18_rk, 9.384748652855367449e-19_rk, 7.285468820183675642e-02_rk,-4.222113870869776231e-18_rk, &
                                        -8.256366399446097914e-18_rk, -6.294451828178246132e-19_rk, -3.640601851892332914e-18_rk,-7.285468820183674254e-02_rk, &
                                        8.241291768368196306e-18_rk, 3.418262967787242900e-18_rk, 1.622337010853609854e-18_rk,2.718973979388435436e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        9.760677434251696649e-02_rk, -1.474638736292822813e-17_rk, 2.275333730302871342e-17_rk,-1.993978179395398925e-17_rk, &
                                        -9.760677434251699425e-02_rk, 4.302314372198167142e-17_rk, 1.620961695597828875e-17_rk,4.739304870392775993e-17_rk, &
                                        -1.461727132001731158e-17_rk, 9.760677434251696649e-02_rk, -2.042164942616976421e-17_rk,2.323520493524449454e-17_rk, &
                                        4.315225976489258181e-17_rk, -9.760677434251699425e-02_rk, 4.691118107171197881e-17_rk,1.669148458819407295e-17_rk, &
                                        -1.053142083564676825e-17_rk, 2.821738704879696726e-17_rk, 3.642734410091836295e-01_rk,2.395494435764564560e-17_rk, &
                                        1.835211164665770958e-17_rk, -1.824190503325266639e-17_rk, -3.642734410091837960e-01_rk,-1.167499535814430314e-18_rk, &
                                        2.808827100588604455e-17_rk, -1.040230479273585016e-17_rk, 2.443681198986141439e-17_rk,3.642734410091836295e-01_rk, &
                                        -1.837102107616358602e-17_rk, 1.848122768956863229e-17_rk, -6.856319035986465000e-19_rk,-3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        9.760677434251696649e-02_rk, 1.164862477913095500e-17_rk, -1.154059596144900589e-17_rk,-1.275349998784590368e-17_rk, &
                                        -9.760677434251699425e-02_rk, 2.180634568641120246e-17_rk, 2.896037684823201423e-17_rk,4.050494762634495019e-17_rk, &
                                        -1.958200152197756420e-18_rk, 3.642734410091836295e-01_rk, 2.054923761047309903e-17_rk,2.389162847174187070e-17_rk, &
                                        2.053116613197182439e-17_rk, -3.642734410091837960e-01_rk, -1.183567158788563468e-17_rk,5.730467797314900653e-18_rk, &
                                        -1.154059596144900281e-17_rk, -1.275349998784590830e-17_rk, 9.760677434251693874e-02_rk,1.164862477913095808e-17_rk, &
                                        2.896037684823201423e-17_rk, 4.050494762634495019e-17_rk, -9.760677434251699425e-02_rk,2.180634568641119630e-17_rk, &
                                        2.054923761047310211e-17_rk, 2.389162847174186761e-17_rk, -1.958200152197759502e-18_rk,3.642734410091836295e-01_rk, &
                                        -1.183567158788563468e-17_rk, 5.730467797314899883e-18_rk, 2.053116613197182439e-17_rk,-3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        5.230731272176847649e-03_rk, 4.250142167286093669e-18_rk, 3.389523632439384134e-18_rk,-1.232184758220065689e-17_rk, &
                                        -1.952135486850341273e-02_rk, 9.516305586561277628e-18_rk, 5.454107630015652805e-18_rk,1.853892766111350664e-17_rk, &
                                        -5.232931645587811570e-18_rk, 1.952135486850339191e-02_rk, -1.608848275666675584e-18_rk,1.370735890737685356e-17_rk, &
                                        8.252752103745841753e-18_rk, -7.285468820183674254e-02_rk, 1.665107564754760112e-18_rk,1.041303755634788550e-17_rk, &
                                        -6.347968378695577102e-18_rk, 2.604336451709858094e-18_rk, 1.952135486850339885e-02_rk,1.262656245594875992e-17_rk, &
                                        6.238584209739456465e-18_rk, -9.384748652855367449e-19_rk, -7.285468820183675642e-02_rk,4.222113870869776231e-18_rk, &
                                        8.256366399446097914e-18_rk, 6.294451828178246132e-19_rk, 3.640601851892332914e-18_rk,7.285468820183674254e-02_rk, &
                                        -8.241291768368196306e-18_rk, -3.418262967787242900e-18_rk, -1.622337010853609854e-18_rk,-2.718973979388435436e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        2.615365636088424345e-02_rk, 9.350572339203867525e-18_rk, 6.224920776383669468e-17_rk,-4.791534300943047635e-17_rk, &
                                        -3.642734410091837960e-01_rk, 4.534027709733815360e-17_rk, 6.264424134362360854e-17_rk,5.542548191136578057e-17_rk, &
                                        9.832439971419645561e-18_rk, 2.615365636088425039e-02_rk, -4.971369749538266578e-17_rk,6.404756224978889644e-17_rk, &
                                        4.582214472955392240e-17_rk, -3.642734410091837960e-01_rk, 5.362712742541356032e-17_rk,6.444259582957582263e-17_rk, &
                                        -1.819031118665289977e-17_rk, 2.656799483919858388e-17_rk, 9.760677434251695261e-02_rk,5.558252269560763608e-17_rk, &
                                        -4.379621479807554068e-18_rk, -2.717506050280022006e-17_rk, -1.359486989694218106e+00_rk,1.236802934994305062e-17_rk, &
                                        2.608612720698280584e-17_rk, -1.770844355443712173e-17_rk, 5.738087718155983784e-17_rk,9.760677434251695261e-02_rk, &
                                        -2.765692813501601043e-17_rk, -3.897753847591766787e-18_rk, 1.416638383589525700e-17_rk,-1.359486989694218106e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        2.615365636088424345e-02_rk, 7.273489833704333991e-17_rk, -3.251627769831949703e-18_rk,-3.583405566460809414e-17_rk, &
                                        -3.642734410091837960e-01_rk, 4.688575160074407222e-17_rk, 2.950308235054352057e-17_rk,4.749731635279490927e-17_rk, &
                                        -6.003448816279622221e-18_rk, 9.760677434251696649e-02_rk, 1.268835300842400607e-17_rk,4.779239197923153498e-17_rk, &
                                        1.262090933248933068e-17_rk, -1.359486989694218106e+00_rk, -2.104524943018155669e-17_rk,2.924340514548832735e-17_rk, &
                                        -3.251627769831953555e-18_rk, -3.583405566460809414e-17_rk, 2.615365636088420181e-02_rk,7.273489833704333991e-17_rk, &
                                        2.950308235054352057e-17_rk, 4.749731635279490927e-17_rk, -3.642734410091837960e-01_rk,4.688575160074407222e-17_rk, &
                                        1.268835300842400607e-17_rk, 4.779239197923152882e-17_rk, -6.003448816279637628e-18_rk,9.760677434251695261e-02_rk, &
                                        -2.104524943018155977e-17_rk, 2.924340514548832119e-17_rk, 1.262090933248933376e-17_rk,-1.359486989694218106e+00_rk  &
                                        /),(/4,8/))
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face3_dx
        ! 
        test_dbr2_vol_face3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        2.718973979388435436e-01_rk, -1.056590366759051256e-17_rk, -4.889565949770075538e-18_rk,4.897163877158253469e-18_rk, &
                                        -1.056590366759051564e-17_rk, 2.718973979388435436e-01_rk, 4.897163877158253469e-18_rk,-4.889565949770072457e-18_rk, &
                                        -1.952135486850341273e-02_rk, -5.219275364932936840e-18_rk, 8.693539209834549687e-18_rk,-9.904200586779516505e-18_rk, &
                                        -5.219275364932936840e-18_rk, -1.952135486850340926e-02_rk, -9.904200586779514964e-18_rk,8.693539209834549687e-18_rk, &
                                        -1.671626269826109408e-17_rk, -1.035610673696771518e-17_rk, 7.285468820183674254e-02_rk,-1.464034199826530885e-17_rk, &
                                        -1.035610673696771518e-17_rk, -1.671626269826109408e-17_rk, -1.464034199826530885e-17_rk,7.285468820183674254e-02_rk, &
                                        -5.439699649361555502e-18_rk, -1.870940662320999414e-19_rk, -5.230731272176845914e-03_rk,1.089950296422131507e-17_rk, &
                                        -1.870940662321000377e-19_rk, -5.439699649361555502e-18_rk, 1.089950296422131507e-17_rk,-5.230731272176845914e-03_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.359486989694218106e+00_rk, 3.355775155796512960e-18_rk, 1.096186765296534945e-17_rk,3.465275400293338732e-17_rk, &
                                        -6.934722352246952921e-17_rk, 3.642734410091837960e-01_rk, 2.171739802925068725e-17_rk,-6.327446723040501063e-17_rk, &
                                        -3.642734410091836295e-01_rk, -1.350032185695516388e-17_rk, 8.561799606687050677e-18_rk,-5.017630785212198287e-17_rk, &
                                        -4.437105376067992115e-17_rk, -9.760677434251696649e-02_rk, -1.658056665721590583e-17_rk,4.516859252299810258e-17_rk, &
                                        -4.795600869800915254e-17_rk, -1.068757925731685415e-17_rk, 3.642734410091837960e-01_rk,-6.463482073836995860e-17_rk, &
                                        -6.460701039396810579e-17_rk, -6.811259295990248165e-17_rk, -7.131516760804812174e-17_rk,9.760677434251699425e-02_rk, &
                                        -3.358092684496670443e-17_rk, -5.875689130185110675e-18_rk, -9.760677434251696649e-02_rk,5.440932692378035769e-17_rk, &
                                        2.547442648598087011e-17_rk, -1.770122830896021894e-17_rk, 3.595657764435616806e-17_rk,-2.615365636088421569e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.359486989694218106e+00_rk, -3.368249500048180317e-17_rk, -3.936183401466275634e-17_rk,7.217764865554816846e-18_rk, &
                                        -9.234873332879729003e-17_rk, 3.642734410091837960e-01_rk, -3.451247916460213389e-17_rk,-6.866730922549306557e-17_rk, &
                                        -9.760677434251704976e-02_rk, 3.252384371179657652e-17_rk, 6.453177575485477441e-19_rk,-4.503046882229260959e-17_rk, &
                                        -4.122705715354705376e-18_rk, -2.615365636088424345e-02_rk, -5.426004442765451550e-18_rk,1.562388004481640161e-17_rk, &
                                        -3.936183401466275634e-17_rk, 7.217764865554815305e-18_rk, 1.359486989694218106e+00_rk,-3.368249500048180317e-17_rk, &
                                        -3.451247916460214005e-17_rk, -6.866730922549306557e-17_rk, -9.234873332879731468e-17_rk,3.642734410091837960e-01_rk, &
                                        6.453177575485500552e-19_rk, -4.503046882229260959e-17_rk, -9.760677434251704976e-02_rk,3.252384371179658268e-17_rk, &
                                        -5.426004442765448468e-18_rk, 1.562388004481640470e-17_rk, -4.122705715354702294e-18_rk,-2.615365636088421569e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -2.718973979388435436e-01_rk, 1.056590366759051256e-17_rk, 4.889565949770075538e-18_rk,-4.897163877158253469e-18_rk, &
                                        1.056590366759051564e-17_rk, -2.718973979388435436e-01_rk, -4.897163877158253469e-18_rk,4.889565949770072457e-18_rk, &
                                        1.952135486850341273e-02_rk, 5.219275364932936840e-18_rk, -8.693539209834549687e-18_rk,9.904200586779516505e-18_rk, &
                                        5.219275364932936840e-18_rk, 1.952135486850340926e-02_rk, 9.904200586779514964e-18_rk,-8.693539209834549687e-18_rk, &
                                        1.671626269826109408e-17_rk, 1.035610673696771518e-17_rk, -7.285468820183674254e-02_rk,1.464034199826530885e-17_rk, &
                                        1.035610673696771518e-17_rk, 1.671626269826109408e-17_rk, 1.464034199826530885e-17_rk,-7.285468820183674254e-02_rk, &
                                        5.439699649361555502e-18_rk, 1.870940662320999414e-19_rk, 5.230731272176845914e-03_rk,-1.089950296422131507e-17_rk, &
                                        1.870940662321000377e-19_rk, 5.439699649361555502e-18_rk, -1.089950296422131507e-17_rk,5.230731272176845914e-03_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        3.642734410091837960e-01_rk, -6.934722352246952921e-17_rk, -6.327446723040501063e-17_rk,2.171739802925069342e-17_rk, &
                                        3.355775155796525286e-18_rk, 1.359486989694218106e+00_rk, 3.465275400293337499e-17_rk,1.096186765296535561e-17_rk, &
                                        -9.760677434251696649e-02_rk, -4.437105376067992115e-17_rk, 4.516859252299810875e-17_rk,-1.658056665721590891e-17_rk, &
                                        -1.350032185695516388e-17_rk, -3.642734410091836295e-01_rk, -5.017630785212198287e-17_rk,8.561799606687049136e-18_rk, &
                                        -6.811259295990248165e-17_rk, -6.460701039396809346e-17_rk, 9.760677434251699425e-02_rk,-7.131516760804812174e-17_rk, &
                                        -1.068757925731685723e-17_rk, -4.795600869800915254e-17_rk, -6.463482073836994628e-17_rk,3.642734410091837960e-01_rk, &
                                        -1.770122830896021894e-17_rk, 2.547442648598087011e-17_rk, -2.615365636088421569e-02_rk,3.595657764435617422e-17_rk, &
                                        -5.875689130185110675e-18_rk, -3.358092684496671059e-17_rk, 5.440932692378035769e-17_rk,-9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        3.642734410091837960e-01_rk, -9.234873332879731468e-17_rk, -6.866730922549306557e-17_rk,-3.451247916460213389e-17_rk, &
                                        -3.368249500048179084e-17_rk, 1.359486989694218106e+00_rk, 7.217764865554807601e-18_rk,-3.936183401466274401e-17_rk, &
                                        -2.615365636088424345e-02_rk, -4.122705715354705376e-18_rk, 1.562388004481640778e-17_rk,-5.426004442765451550e-18_rk, &
                                        3.252384371179657652e-17_rk, -9.760677434251704976e-02_rk, -4.503046882229260959e-17_rk,6.453177575485500552e-19_rk, &
                                        -6.866730922549306557e-17_rk, -3.451247916460213389e-17_rk, 3.642734410091837960e-01_rk,-9.234873332879729003e-17_rk, &
                                        7.217764865554819927e-18_rk, -3.936183401466276250e-17_rk, -3.368249500048180317e-17_rk,1.359486989694218106e+00_rk, &
                                        1.562388004481640470e-17_rk, -5.426004442765448468e-18_rk, -2.615365636088421569e-02_rk,-4.122705715354705376e-18_rk, &
                                        -4.503046882229260959e-17_rk, 6.453177575485500552e-19_rk, 3.252384371179658268e-17_rk,-9.760677434251704976e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        7.285468820183675642e-02_rk, -2.632386005744088609e-18_rk, -5.572953965717863477e-18_rk,6.376866529278559904e-18_rk, &
                                        -2.632386005744088609e-18_rk, 7.285468820183675642e-02_rk, 6.376866529278559904e-18_rk,-5.572953965717863477e-18_rk, &
                                        -7.285468820183671479e-02_rk, -6.354999758594079705e-18_rk, 2.052539216102487590e-18_rk,-3.447174315088066934e-18_rk, &
                                        -6.354999758594081246e-18_rk, -7.285468820183674254e-02_rk, -3.447174315088065393e-18_rk,2.052539216102487205e-18_rk, &
                                        -6.497457633321233372e-18_rk, -4.702811193289274494e-18_rk, 1.952135486850341273e-02_rk,-1.254965567101830783e-17_rk, &
                                        -4.702811193289274494e-18_rk, -6.497457633321234913e-18_rk, -1.254965567101830629e-17_rk,1.952135486850341273e-02_rk, &
                                        -4.816731381423829789e-18_rk, 4.106841537391251307e-18_rk, -1.952135486850340232e-02_rk,7.173677949405990383e-18_rk, &
                                        4.106841537391251307e-18_rk, -4.816731381423829789e-18_rk, 7.173677949405990383e-18_rk,-1.952135486850340232e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.359486989694218106e+00_rk, -3.355775155796512960e-18_rk, -1.096186765296534945e-17_rk,-3.465275400293338732e-17_rk, &
                                        6.934722352246952921e-17_rk, -3.642734410091837960e-01_rk, -2.171739802925068725e-17_rk,6.327446723040501063e-17_rk, &
                                        3.642734410091836295e-01_rk, 1.350032185695516388e-17_rk, -8.561799606687050677e-18_rk,5.017630785212198287e-17_rk, &
                                        4.437105376067992115e-17_rk, 9.760677434251696649e-02_rk, 1.658056665721590583e-17_rk,-4.516859252299810258e-17_rk, &
                                        4.795600869800915254e-17_rk, 1.068757925731685415e-17_rk, -3.642734410091837960e-01_rk,6.463482073836995860e-17_rk, &
                                        6.460701039396810579e-17_rk, 6.811259295990248165e-17_rk, 7.131516760804812174e-17_rk,-9.760677434251699425e-02_rk, &
                                        3.358092684496670443e-17_rk, 5.875689130185110675e-18_rk, 9.760677434251696649e-02_rk,-5.440932692378035769e-17_rk, &
                                        -2.547442648598087011e-17_rk, 1.770122830896021894e-17_rk, -3.595657764435616806e-17_rk,2.615365636088421569e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        3.642734410091837960e-01_rk, -2.759655058209163323e-17_rk, 2.367692969618957866e-18_rk,1.674740988006169783e-17_rk, &
                                        -4.831365780172034859e-17_rk, 9.760677434251699425e-02_rk, -8.377133200115278485e-18_rk,-6.271975096481443903e-17_rk, &
                                        -3.642734410091836295e-01_rk, 8.385161355028608042e-18_rk, -2.566444499582820304e-17_rk,-1.102152816001448241e-17_rk, &
                                        -4.291770400969050798e-18_rk, -9.760677434251699425e-02_rk, 1.431986427153040966e-17_rk,1.184348416922148511e-17_rk, &
                                        2.367692969618950162e-18_rk, 1.674740988006169783e-17_rk, 3.642734410091837960e-01_rk,-2.759655058209163323e-17_rk, &
                                        -8.377133200115281567e-18_rk, -6.271975096481443903e-17_rk, -4.831365780172034859e-17_rk,9.760677434251699425e-02_rk, &
                                        -2.566444499582820612e-17_rk, -1.102152816001448549e-17_rk, -3.642734410091836295e-01_rk,8.385161355028604961e-18_rk, &
                                        1.431986427153041583e-17_rk, 1.184348416922148819e-17_rk, -4.291770400969050798e-18_rk,-9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -7.285468820183675642e-02_rk, 2.632386005744088609e-18_rk, 5.572953965717863477e-18_rk,-6.376866529278559904e-18_rk, &
                                        2.632386005744088609e-18_rk, -7.285468820183675642e-02_rk, -6.376866529278559904e-18_rk,5.572953965717863477e-18_rk, &
                                        7.285468820183671479e-02_rk, 6.354999758594079705e-18_rk, -2.052539216102487590e-18_rk,3.447174315088066934e-18_rk, &
                                        6.354999758594081246e-18_rk, 7.285468820183674254e-02_rk, 3.447174315088065393e-18_rk,-2.052539216102487205e-18_rk, &
                                        6.497457633321233372e-18_rk, 4.702811193289274494e-18_rk, -1.952135486850341273e-02_rk,1.254965567101830783e-17_rk, &
                                        4.702811193289274494e-18_rk, 6.497457633321234913e-18_rk, 1.254965567101830629e-17_rk,-1.952135486850341273e-02_rk, &
                                        4.816731381423829789e-18_rk, -4.106841537391251307e-18_rk, 1.952135486850340232e-02_rk,-7.173677949405990383e-18_rk, &
                                        -4.106841537391251307e-18_rk, 4.816731381423829789e-18_rk, -7.173677949405990383e-18_rk,1.952135486850340232e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -3.642734410091837960e-01_rk, 6.934722352246952921e-17_rk, 6.327446723040501063e-17_rk,-2.171739802925069342e-17_rk, &
                                        -3.355775155796525286e-18_rk, -1.359486989694218106e+00_rk, -3.465275400293337499e-17_rk,-1.096186765296535561e-17_rk, &
                                        9.760677434251696649e-02_rk, 4.437105376067992115e-17_rk, -4.516859252299810875e-17_rk,1.658056665721590891e-17_rk, &
                                        1.350032185695516388e-17_rk, 3.642734410091836295e-01_rk, 5.017630785212198287e-17_rk,-8.561799606687049136e-18_rk, &
                                        6.811259295990248165e-17_rk, 6.460701039396809346e-17_rk, -9.760677434251699425e-02_rk,7.131516760804812174e-17_rk, &
                                        1.068757925731685723e-17_rk, 4.795600869800915254e-17_rk, 6.463482073836994628e-17_rk,-3.642734410091837960e-01_rk, &
                                        1.770122830896021894e-17_rk, -2.547442648598087011e-17_rk, 2.615365636088421569e-02_rk,-3.595657764435617422e-17_rk, &
                                        5.875689130185110675e-18_rk, 3.358092684496671059e-17_rk, -5.440932692378035769e-17_rk,9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        9.760677434251699425e-02_rk, -4.831365780172034859e-17_rk, -6.271975096481442670e-17_rk,-8.377133200115278485e-18_rk, &
                                        -2.759655058209162091e-17_rk, 3.642734410091837960e-01_rk, 1.674740988006169167e-17_rk,2.367692969618962488e-18_rk, &
                                        -9.760677434251699425e-02_rk, -4.291770400969050798e-18_rk, 1.184348416922148511e-17_rk,1.431986427153040966e-17_rk, &
                                        8.385161355028608042e-18_rk, -3.642734410091836295e-01_rk, -1.102152816001448241e-17_rk,-2.566444499582820612e-17_rk, &
                                        -6.271975096481443903e-17_rk, -8.377133200115280026e-18_rk, 9.760677434251699425e-02_rk,-4.831365780172034859e-17_rk, &
                                        1.674740988006170091e-17_rk, 2.367692969618947081e-18_rk, -2.759655058209162707e-17_rk,3.642734410091837960e-01_rk, &
                                        1.184348416922148819e-17_rk, 1.431986427153041583e-17_rk, -9.760677434251696649e-02_rk,-4.291770400969053880e-18_rk, &
                                        -1.102152816001448549e-17_rk, -2.566444499582820612e-17_rk, 8.385161355028608042e-18_rk,-3.642734410091836295e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        7.285468820183674254e-02_rk, -1.464034199826530885e-17_rk, -1.671626269826110024e-17_rk,-1.035610673696771518e-17_rk, &
                                        -1.464034199826530885e-17_rk, 7.285468820183674254e-02_rk, -1.035610673696771518e-17_rk,-1.671626269826109408e-17_rk, &
                                        -5.230731272176852853e-03_rk, 1.089950296422131507e-17_rk, -5.439699649361554731e-18_rk,-1.870940662321008080e-19_rk, &
                                        1.089950296422131507e-17_rk, -5.230731272176849384e-03_rk, -1.870940662321007117e-19_rk,-5.439699649361555502e-18_rk, &
                                        -4.889565949770073997e-18_rk, 4.897163877158251928e-18_rk, 2.718973979388435436e-01_rk,-1.056590366759051410e-17_rk, &
                                        4.897163877158253469e-18_rk, -4.889565949770072457e-18_rk, -1.056590366759051256e-17_rk,2.718973979388435436e-01_rk, &
                                        8.693539209834548146e-18_rk, -9.904200586779516505e-18_rk, -1.952135486850341273e-02_rk,-5.219275364932936840e-18_rk, &
                                        -9.904200586779516505e-18_rk, 8.693539209834548146e-18_rk, -5.219275364932936069e-18_rk,-1.952135486850341273e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        3.642734410091837960e-01_rk, -6.463482073836995860e-17_rk, -4.795600869800914638e-17_rk,-1.068757925731686648e-17_rk, &
                                        -7.131516760804812174e-17_rk, 9.760677434251699425e-02_rk, -6.460701039396809346e-17_rk,-6.811259295990248165e-17_rk, &
                                        -9.760677434251699425e-02_rk, 5.440932692378035769e-17_rk, -3.358092684496671059e-17_rk,-5.875689130185104512e-18_rk, &
                                        3.595657764435616806e-17_rk, -2.615365636088425039e-02_rk, 2.547442648598086702e-17_rk,-1.770122830896021894e-17_rk, &
                                        1.096186765296534328e-17_rk, 3.465275400293337499e-17_rk, 1.359486989694218106e+00_rk,3.355775155796516042e-18_rk, &
                                        2.171739802925068417e-17_rk, -6.327446723040502295e-17_rk, -6.934722352246954153e-17_rk,3.642734410091837960e-01_rk, &
                                        8.561799606687046055e-18_rk, -5.017630785212198903e-17_rk, -3.642734410091836850e-01_rk,-1.350032185695517005e-17_rk, &
                                        -1.658056665721590275e-17_rk, 4.516859252299811491e-17_rk, -4.437105376067992115e-17_rk,-9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.359486989694218106e+00_rk, 3.368249500048180317e-17_rk, 3.936183401466275634e-17_rk,-7.217764865554816846e-18_rk, &
                                        9.234873332879729003e-17_rk, -3.642734410091837960e-01_rk, 3.451247916460213389e-17_rk,6.866730922549306557e-17_rk, &
                                        9.760677434251704976e-02_rk, -3.252384371179657652e-17_rk, -6.453177575485477441e-19_rk,4.503046882229260959e-17_rk, &
                                        4.122705715354705376e-18_rk, 2.615365636088424345e-02_rk, 5.426004442765451550e-18_rk,-1.562388004481640161e-17_rk, &
                                        3.936183401466275634e-17_rk, -7.217764865554815305e-18_rk, -1.359486989694218106e+00_rk,3.368249500048180317e-17_rk, &
                                        3.451247916460214005e-17_rk, 6.866730922549306557e-17_rk, 9.234873332879731468e-17_rk,-3.642734410091837960e-01_rk, &
                                        -6.453177575485500552e-19_rk, 4.503046882229260959e-17_rk, 9.760677434251704976e-02_rk,-3.252384371179658268e-17_rk, &
                                        5.426004442765448468e-18_rk, -1.562388004481640470e-17_rk, 4.122705715354702294e-18_rk,2.615365636088421569e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -7.285468820183674254e-02_rk, 1.464034199826530885e-17_rk, 1.671626269826110024e-17_rk,1.035610673696771518e-17_rk, &
                                        1.464034199826530885e-17_rk, -7.285468820183674254e-02_rk, 1.035610673696771518e-17_rk,1.671626269826109408e-17_rk, &
                                        5.230731272176852853e-03_rk, -1.089950296422131507e-17_rk, 5.439699649361554731e-18_rk,1.870940662321008080e-19_rk, &
                                        -1.089950296422131507e-17_rk, 5.230731272176849384e-03_rk, 1.870940662321007117e-19_rk,5.439699649361555502e-18_rk, &
                                        4.889565949770073997e-18_rk, -4.897163877158251928e-18_rk, -2.718973979388435436e-01_rk,1.056590366759051410e-17_rk, &
                                        -4.897163877158253469e-18_rk, 4.889565949770072457e-18_rk, 1.056590366759051256e-17_rk,-2.718973979388435436e-01_rk, &
                                        -8.693539209834548146e-18_rk, 9.904200586779516505e-18_rk, 1.952135486850341273e-02_rk,5.219275364932936840e-18_rk, &
                                        9.904200586779516505e-18_rk, -8.693539209834548146e-18_rk, 5.219275364932936069e-18_rk,1.952135486850341273e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        9.760677434251699425e-02_rk, -7.131516760804812174e-17_rk, -6.811259295990248165e-17_rk,-6.460701039396810579e-17_rk, &
                                        -6.463482073836993395e-17_rk, 3.642734410091837960e-01_rk, -1.068757925731686648e-17_rk,-4.795600869800914022e-17_rk, &
                                        -2.615365636088425733e-02_rk, 3.595657764435616806e-17_rk, -1.770122830896022202e-17_rk,2.547442648598087011e-17_rk, &
                                        5.440932692378035769e-17_rk, -9.760677434251699425e-02_rk, -5.875689130185104512e-18_rk,-3.358092684496670443e-17_rk, &
                                        -6.327446723040501063e-17_rk, 2.171739802925068109e-17_rk, 3.642734410091837960e-01_rk,-6.934722352246952921e-17_rk, &
                                        3.465275400293337499e-17_rk, 1.096186765296533712e-17_rk, 3.355775155796522205e-18_rk,1.359486989694218106e+00_rk, &
                                        4.516859252299810875e-17_rk, -1.658056665721590275e-17_rk, -9.760677434251696649e-02_rk,-4.437105376067992732e-17_rk, &
                                        -5.017630785212198903e-17_rk, 8.561799606687052218e-18_rk, -1.350032185695516080e-17_rk,-3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -3.642734410091837960e-01_rk, 9.234873332879731468e-17_rk, 6.866730922549306557e-17_rk,3.451247916460213389e-17_rk, &
                                        3.368249500048179084e-17_rk, -1.359486989694218106e+00_rk, -7.217764865554807601e-18_rk,3.936183401466274401e-17_rk, &
                                        2.615365636088424345e-02_rk, 4.122705715354705376e-18_rk, -1.562388004481640778e-17_rk,5.426004442765451550e-18_rk, &
                                        -3.252384371179657652e-17_rk, 9.760677434251704976e-02_rk, 4.503046882229260959e-17_rk,-6.453177575485500552e-19_rk, &
                                        6.866730922549306557e-17_rk, 3.451247916460213389e-17_rk, -3.642734410091837960e-01_rk,9.234873332879729003e-17_rk, &
                                        -7.217764865554819927e-18_rk, 3.936183401466276250e-17_rk, 3.368249500048180317e-17_rk,-1.359486989694218106e+00_rk, &
                                        -1.562388004481640470e-17_rk, 5.426004442765448468e-18_rk, 2.615365636088421569e-02_rk,4.122705715354705376e-18_rk, &
                                        4.503046882229260959e-17_rk, -6.453177575485500552e-19_rk, -3.252384371179658268e-17_rk,9.760677434251704976e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.952135486850341273e-02_rk, -1.254965567101830629e-17_rk, -6.497457633321236454e-18_rk,-4.702811193289274494e-18_rk, &
                                        -1.254965567101830629e-17_rk, 1.952135486850341273e-02_rk, -4.702811193289274494e-18_rk,-6.497457633321234913e-18_rk, &
                                        -1.952135486850339885e-02_rk, 7.173677949405990383e-18_rk, -4.816731381423830559e-18_rk,4.106841537391250537e-18_rk, &
                                        7.173677949405988843e-18_rk, -1.952135486850340579e-02_rk, 4.106841537391250537e-18_rk,-4.816731381423829789e-18_rk, &
                                        -5.572953965717863477e-18_rk, 6.376866529278558363e-18_rk, 7.285468820183675642e-02_rk,-2.632386005744090149e-18_rk, &
                                        6.376866529278559904e-18_rk, -5.572953965717863477e-18_rk, -2.632386005744088609e-18_rk,7.285468820183675642e-02_rk, &
                                        2.052539216102485664e-18_rk, -3.447174315088066164e-18_rk, -7.285468820183674254e-02_rk,-6.354999758594079705e-18_rk, &
                                        -3.447174315088066164e-18_rk, 2.052539216102485664e-18_rk, -6.354999758594079705e-18_rk,-7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -3.642734410091837960e-01_rk, 6.463482073836995860e-17_rk, 4.795600869800914638e-17_rk,1.068757925731686648e-17_rk, &
                                        7.131516760804812174e-17_rk, -9.760677434251699425e-02_rk, 6.460701039396809346e-17_rk,6.811259295990248165e-17_rk, &
                                        9.760677434251699425e-02_rk, -5.440932692378035769e-17_rk, 3.358092684496671059e-17_rk,5.875689130185104512e-18_rk, &
                                        -3.595657764435616806e-17_rk, 2.615365636088425039e-02_rk, -2.547442648598086702e-17_rk,1.770122830896021894e-17_rk, &
                                        -1.096186765296534328e-17_rk, -3.465275400293337499e-17_rk, -1.359486989694218106e+00_rk,-3.355775155796516042e-18_rk, &
                                        -2.171739802925068417e-17_rk, 6.327446723040502295e-17_rk, 6.934722352246954153e-17_rk,-3.642734410091837960e-01_rk, &
                                        -8.561799606687046055e-18_rk, 5.017630785212198903e-17_rk, 3.642734410091836850e-01_rk,1.350032185695517005e-17_rk, &
                                        1.658056665721590275e-17_rk, -4.516859252299811491e-17_rk, 4.437105376067992115e-17_rk,9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -3.642734410091837960e-01_rk, 2.759655058209163323e-17_rk, -2.367692969618957866e-18_rk,-1.674740988006169783e-17_rk, &
                                        4.831365780172034859e-17_rk, -9.760677434251699425e-02_rk, 8.377133200115278485e-18_rk,6.271975096481443903e-17_rk, &
                                        3.642734410091836295e-01_rk, -8.385161355028608042e-18_rk, 2.566444499582820304e-17_rk,1.102152816001448241e-17_rk, &
                                        4.291770400969050798e-18_rk, 9.760677434251699425e-02_rk, -1.431986427153040966e-17_rk,-1.184348416922148511e-17_rk, &
                                        -2.367692969618950162e-18_rk, -1.674740988006169783e-17_rk, -3.642734410091837960e-01_rk,2.759655058209163323e-17_rk, &
                                        8.377133200115281567e-18_rk, 6.271975096481443903e-17_rk, 4.831365780172034859e-17_rk,-9.760677434251699425e-02_rk, &
                                        2.566444499582820612e-17_rk, 1.102152816001448549e-17_rk, 3.642734410091836295e-01_rk,-8.385161355028604961e-18_rk, &
                                        -1.431986427153041583e-17_rk, -1.184348416922148819e-17_rk, 4.291770400969050798e-18_rk,9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.952135486850341273e-02_rk, 1.254965567101830629e-17_rk, 6.497457633321236454e-18_rk,4.702811193289274494e-18_rk, &
                                        1.254965567101830629e-17_rk, -1.952135486850341273e-02_rk, 4.702811193289274494e-18_rk,6.497457633321234913e-18_rk, &
                                        1.952135486850339885e-02_rk, -7.173677949405990383e-18_rk, 4.816731381423830559e-18_rk,-4.106841537391250537e-18_rk, &
                                        -7.173677949405988843e-18_rk, 1.952135486850340579e-02_rk, -4.106841537391250537e-18_rk,4.816731381423829789e-18_rk, &
                                        5.572953965717863477e-18_rk, -6.376866529278558363e-18_rk, -7.285468820183675642e-02_rk,2.632386005744090149e-18_rk, &
                                        -6.376866529278559904e-18_rk, 5.572953965717863477e-18_rk, 2.632386005744088609e-18_rk,-7.285468820183675642e-02_rk, &
                                        -2.052539216102485664e-18_rk, 3.447174315088066164e-18_rk, 7.285468820183674254e-02_rk,6.354999758594079705e-18_rk, &
                                        3.447174315088066164e-18_rk, -2.052539216102485664e-18_rk, 6.354999758594079705e-18_rk,7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -9.760677434251699425e-02_rk, 7.131516760804812174e-17_rk, 6.811259295990248165e-17_rk,6.460701039396810579e-17_rk, &
                                        6.463482073836993395e-17_rk, -3.642734410091837960e-01_rk, 1.068757925731686648e-17_rk,4.795600869800914022e-17_rk, &
                                        2.615365636088425733e-02_rk, -3.595657764435616806e-17_rk, 1.770122830896022202e-17_rk,-2.547442648598087011e-17_rk, &
                                        -5.440932692378035769e-17_rk, 9.760677434251699425e-02_rk, 5.875689130185104512e-18_rk,3.358092684496670443e-17_rk, &
                                        6.327446723040501063e-17_rk, -2.171739802925068109e-17_rk, -3.642734410091837960e-01_rk,6.934722352246952921e-17_rk, &
                                        -3.465275400293337499e-17_rk, -1.096186765296533712e-17_rk, -3.355775155796522205e-18_rk,-1.359486989694218106e+00_rk, &
                                        -4.516859252299810875e-17_rk, 1.658056665721590275e-17_rk, 9.760677434251696649e-02_rk,4.437105376067992732e-17_rk, &
                                        5.017630785212198903e-17_rk, -8.561799606687052218e-18_rk, 1.350032185695516080e-17_rk,3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -9.760677434251699425e-02_rk, 4.831365780172034859e-17_rk, 6.271975096481442670e-17_rk,8.377133200115278485e-18_rk, &
                                        2.759655058209162091e-17_rk, -3.642734410091837960e-01_rk, -1.674740988006169167e-17_rk,-2.367692969618962488e-18_rk, &
                                        9.760677434251699425e-02_rk, 4.291770400969050798e-18_rk, -1.184348416922148511e-17_rk,-1.431986427153040966e-17_rk, &
                                        -8.385161355028608042e-18_rk, 3.642734410091836295e-01_rk, 1.102152816001448241e-17_rk,2.566444499582820612e-17_rk, &
                                        6.271975096481443903e-17_rk, 8.377133200115280026e-18_rk, -9.760677434251699425e-02_rk,4.831365780172034859e-17_rk, &
                                        -1.674740988006170091e-17_rk, -2.367692969618947081e-18_rk, 2.759655058209162707e-17_rk,-3.642734410091837960e-01_rk, &
                                        -1.184348416922148819e-17_rk, -1.431986427153041583e-17_rk, 9.760677434251696649e-02_rk,4.291770400969053880e-18_rk, &
                                        1.102152816001448549e-17_rk, 2.566444499582820612e-17_rk, -8.385161355028608042e-18_rk,3.642734410091836295e-01_rk  &
                                        /),(/4,8/))
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face4_dx
        ! 
        test_dbr2_vol_face4_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -7.285468820183671479e-02_rk, -2.135322518751947391e-18_rk, 2.078362424684670129e-18_rk,-3.999592265164818039e-18_rk, &
                                        -2.135322518751948932e-18_rk, -7.285468820183674254e-02_rk, -3.999592265164819579e-18_rk,2.078362424684670129e-18_rk, &
                                        7.285468820183675642e-02_rk, -5.707341490445979444e-19_rk, -6.125371915794615352e-18_rk,5.824448579201806489e-18_rk, &
                                        -5.707341490445975592e-19_rk, 7.285468820183675642e-02_rk, 5.824448579201805718e-18_rk,-6.125371915794615352e-18_rk, &
                                        -4.720357854980673411e-18_rk, 2.045189680691764110e-18_rk, -1.952135486850340232e-02_rk,8.304337058141678983e-18_rk, &
                                        2.045189680691763339e-18_rk, -4.720357854980672641e-18_rk, 8.304337058141678983e-18_rk,-1.952135486850340232e-02_rk, &
                                        -8.559109490020721725e-18_rk, -6.764463049988764388e-18_rk, 1.952135486850341273e-02_rk,-1.199723772094155134e-17_rk, &
                                        -6.764463049988764388e-18_rk, -8.559109490020721725e-18_rk, -1.199723772094155134e-17_rk,1.952135486850341273e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -3.642734410091836295e-01_rk, -9.516264756318007634e-18_rk, 8.690915649597971849e-18_rk,-5.046913647737169488e-17_rk, &
                                        -2.327266756146926266e-17_rk, -9.760677434251699425e-02_rk, -1.934265640759966366e-17_rk,4.565046015521388986e-17_rk, &
                                        1.359486989694218106e+00_rk, 4.448626463138997909e-18_rk, 8.199777902581588533e-18_rk,3.435992537768366914e-17_rk, &
                                        -5.903896423897207511e-17_rk, 3.642734410091837960e-01_rk, 1.895530827886692634e-17_rk,-6.356729585565472880e-17_rk, &
                                        -3.309905921275091715e-17_rk, -6.968540437527578675e-18_rk, -9.760677434251696649e-02_rk,5.547685180649555667e-17_rk, &
                                        1.516616720248342218e-17_rk, -1.590287382300800793e-17_rk, 4.160987318803461260e-17_rk,-2.615365636088421569e-02_rk, &
                                        -5.826426798150658814e-17_rk, -1.178043056465933910e-17_rk, 3.642734410091837960e-01_rk,-6.434199211312022810e-17_rk, &
                                        -7.491526967746554756e-17_rk, -6.920544426724497892e-17_rk, -6.855307785766434542e-17_rk,9.760677434251699425e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -3.642734410091836295e-01_rk, 1.368570530940218647e-17_rk, -2.553532895291728649e-17_rk,-1.343086632109337875e-17_rk, &
                                        1.715936738754648304e-17_rk, -9.760677434251699425e-02_rk, 3.658853398728107181e-18_rk,1.232535180143726161e-17_rk, &
                                        3.642734410091837960e-01_rk, -2.518721242101273072e-17_rk, -8.293317903183346928e-18_rk,1.433807171898280148e-17_rk, &
                                        -3.765264692891802993e-17_rk, 9.760677434251699425e-02_rk, -1.903814407291758174e-17_rk,-6.512908912589333229e-17_rk, &
                                        -2.553532895291728033e-17_rk, -1.343086632109337875e-17_rk, -3.642734410091836295e-01_rk,1.368570530940218647e-17_rk, &
                                        3.658853398728104100e-18_rk, 1.232535180143726315e-17_rk, 1.715936738754647380e-17_rk,-9.760677434251696649e-02_rk, &
                                        -8.293317903183350010e-18_rk, 1.433807171898279840e-17_rk, 3.642734410091837960e-01_rk,-2.518721242101272456e-17_rk, &
                                        -1.903814407291759098e-17_rk, -6.512908912589333229e-17_rk, -3.765264692891803609e-17_rk,9.760677434251699425e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,1) = reshape((/                                                                                 &
                                        7.285468820183671479e-02_rk, 2.135322518751947391e-18_rk, -2.078362424684670129e-18_rk,3.999592265164818039e-18_rk, &
                                        2.135322518751948932e-18_rk, 7.285468820183674254e-02_rk, 3.999592265164819579e-18_rk,-2.078362424684670129e-18_rk, &
                                        -7.285468820183675642e-02_rk, 5.707341490445979444e-19_rk, 6.125371915794615352e-18_rk,-5.824448579201806489e-18_rk, &
                                        5.707341490445975592e-19_rk, -7.285468820183675642e-02_rk, -5.824448579201805718e-18_rk,6.125371915794615352e-18_rk, &
                                        4.720357854980673411e-18_rk, -2.045189680691764110e-18_rk, 1.952135486850340232e-02_rk,-8.304337058141678983e-18_rk, &
                                        -2.045189680691763339e-18_rk, 4.720357854980672641e-18_rk, -8.304337058141678983e-18_rk,1.952135486850340232e-02_rk, &
                                        8.559109490020721725e-18_rk, 6.764463049988764388e-18_rk, -1.952135486850341273e-02_rk,1.199723772094155134e-17_rk, &
                                        6.764463049988764388e-18_rk, 8.559109490020721725e-18_rk, 1.199723772094155134e-17_rk,-1.952135486850341273e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -9.760677434251696649e-02_rk, -2.327266756146926266e-17_rk, 4.565046015521388986e-17_rk,-1.934265640759966982e-17_rk, &
                                        -9.516264756318007634e-18_rk, -3.642734410091836295e-01_rk, -5.046913647737169488e-17_rk,8.690915649597971849e-18_rk, &
                                        3.642734410091837960e-01_rk, -5.903896423897208744e-17_rk, -6.356729585565472880e-17_rk,1.895530827886692018e-17_rk, &
                                        4.448626463138994827e-18_rk, 1.359486989694218106e+00_rk, 3.435992537768366914e-17_rk,8.199777902581588533e-18_rk, &
                                        -1.590287382300800793e-17_rk, 1.516616720248342526e-17_rk, -2.615365636088421569e-02_rk,4.160987318803461260e-17_rk, &
                                        -6.968540437527581757e-18_rk, -3.309905921275091715e-17_rk, 5.547685180649555667e-17_rk,-9.760677434251696649e-02_rk, &
                                        -6.920544426724497892e-17_rk, -7.491526967746554756e-17_rk, 9.760677434251699425e-02_rk,-6.855307785766434542e-17_rk, &
                                        -1.178043056465933602e-17_rk, -5.826426798150658814e-17_rk, -6.434199211312022810e-17_rk,3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -9.760677434251699425e-02_rk, 1.715936738754647688e-17_rk, 1.232535180143726469e-17_rk,3.658853398728107181e-18_rk, &
                                        1.368570530940219264e-17_rk, -3.642734410091836295e-01_rk, -1.343086632109337875e-17_rk,-2.553532895291728649e-17_rk, &
                                        9.760677434251699425e-02_rk, -3.765264692891803609e-17_rk, -6.512908912589333229e-17_rk,-1.903814407291758790e-17_rk, &
                                        -2.518721242101272764e-17_rk, 3.642734410091837960e-01_rk, 1.433807171898280148e-17_rk,-8.293317903183346928e-18_rk, &
                                        1.232535180143726931e-17_rk, 3.658853398728104100e-18_rk, -9.760677434251693874e-02_rk,1.715936738754647688e-17_rk, &
                                        -1.343086632109337875e-17_rk, -2.553532895291728341e-17_rk, 1.368570530940218801e-17_rk,-3.642734410091836295e-01_rk, &
                                        -6.512908912589333229e-17_rk, -1.903814407291759098e-17_rk, 9.760677434251699425e-02_rk,-3.765264692891803609e-17_rk, &
                                        1.433807171898280457e-17_rk, -8.293317903183353091e-18_rk, -2.518721242101272456e-17_rk,3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -1.952135486850340926e-02_rk, -4.422463944805505590e-18_rk, 8.789912736277705295e-18_rk,-9.962766311829456135e-18_rk, &
                                        -4.422463944805507131e-18_rk, -1.952135486850340926e-02_rk, -9.962766311829456135e-18_rk,8.789912736277705295e-18_rk, &
                                        2.718973979388435436e-01_rk, -1.034733340612201495e-17_rk, -4.948131674820018249e-18_rk,4.838598152108309217e-18_rk, &
                                        -1.034733340612201650e-17_rk, 2.718973979388435436e-01_rk, 4.838598152108309988e-18_rk,-4.948131674820018249e-18_rk, &
                                        -5.080028752171113301e-18_rk, -4.056643277005941769e-19_rk, -5.230731272176845914e-03_rk,1.111300794076435610e-17_rk, &
                                        -4.056643277005949473e-19_rk, -5.080028752171113301e-18_rk, 1.111300794076435456e-17_rk,-5.230731272176845914e-03_rk, &
                                        -1.693483295972959169e-17_rk, -1.057467699843621125e-17_rk, 7.285468820183674254e-02_rk,-1.458177627321536460e-17_rk, &
                                        -1.057467699843621125e-17_rk, -1.693483295972959169e-17_rk, -1.458177627321536460e-17_rk,7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,2) = reshape((/                                                                                 &
                                        3.642734410091836295e-01_rk, 9.516264756318007634e-18_rk, -8.690915649597971849e-18_rk,5.046913647737169488e-17_rk, &
                                        2.327266756146926266e-17_rk, 9.760677434251699425e-02_rk, 1.934265640759966366e-17_rk,-4.565046015521388986e-17_rk, &
                                        -1.359486989694218106e+00_rk, -4.448626463138997909e-18_rk, -8.199777902581588533e-18_rk,-3.435992537768366914e-17_rk, &
                                        5.903896423897207511e-17_rk, -3.642734410091837960e-01_rk, -1.895530827886692634e-17_rk,6.356729585565472880e-17_rk, &
                                        3.309905921275091715e-17_rk, 6.968540437527578675e-18_rk, 9.760677434251696649e-02_rk,-5.547685180649555667e-17_rk, &
                                        -1.516616720248342218e-17_rk, 1.590287382300800793e-17_rk, -4.160987318803461260e-17_rk,2.615365636088421569e-02_rk, &
                                        5.826426798150658814e-17_rk, 1.178043056465933910e-17_rk, -3.642734410091837960e-01_rk,6.434199211312022810e-17_rk, &
                                        7.491526967746554756e-17_rk, 6.920544426724497892e-17_rk, 6.855307785766434542e-17_rk,-9.760677434251699425e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -9.760677434251704976e-02_rk, 3.227488174077536719e-17_rk, 1.127185389764333484e-18_rk,-4.400681059380590097e-17_rk, &
                                        1.177838239018879218e-18_rk, -2.615365636088427120e-02_rk, -7.835342603844347895e-18_rk,1.742223453076861570e-17_rk, &
                                        1.359486989694218106e+00_rk, -3.470615322896850563e-17_rk, -4.177117217574164344e-17_rk,8.241423094041525472e-18_rk, &
                                        -8.993939516771840909e-17_rk, 3.642734410091837960e-01_rk, -3.692181732568102715e-17_rk,-6.764365099700637543e-17_rk, &
                                        1.127185389764335025e-18_rk, -4.400681059380590097e-17_rk, -9.760677434251704976e-02_rk,3.227488174077536719e-17_rk, &
                                        -7.835342603844354058e-18_rk, 1.742223453076861878e-17_rk, 1.177838239018876137e-18_rk,-2.615365636088421569e-02_rk, &
                                        -4.177117217574165576e-17_rk, 8.241423094041525472e-18_rk, 1.359486989694218106e+00_rk,-3.470615322896849947e-17_rk, &
                                        -3.692181732568103332e-17_rk, -6.764365099700637543e-17_rk, -8.993939516771840909e-17_rk,3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,1) = reshape((/                                                                                 &
                                        1.952135486850340926e-02_rk, 4.422463944805505590e-18_rk, -8.789912736277705295e-18_rk,9.962766311829456135e-18_rk, &
                                        4.422463944805507131e-18_rk, 1.952135486850340926e-02_rk, 9.962766311829456135e-18_rk,-8.789912736277705295e-18_rk, &
                                        -2.718973979388435436e-01_rk, 1.034733340612201495e-17_rk, 4.948131674820018249e-18_rk,-4.838598152108309217e-18_rk, &
                                        1.034733340612201650e-17_rk, -2.718973979388435436e-01_rk, -4.838598152108309988e-18_rk,4.948131674820018249e-18_rk, &
                                        5.080028752171113301e-18_rk, 4.056643277005941769e-19_rk, 5.230731272176845914e-03_rk,-1.111300794076435610e-17_rk, &
                                        4.056643277005949473e-19_rk, 5.080028752171113301e-18_rk, -1.111300794076435456e-17_rk,5.230731272176845914e-03_rk, &
                                        1.693483295972959169e-17_rk, 1.057467699843621125e-17_rk, -7.285468820183674254e-02_rk,1.458177627321536460e-17_rk, &
                                        1.057467699843621125e-17_rk, 1.693483295972959169e-17_rk, 1.458177627321536460e-17_rk,-7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,2) = reshape((/                                                                                 &
                                        9.760677434251696649e-02_rk, 2.327266756146926266e-17_rk, -4.565046015521388986e-17_rk,1.934265640759966982e-17_rk, &
                                        9.516264756318007634e-18_rk, 3.642734410091836295e-01_rk, 5.046913647737169488e-17_rk,-8.690915649597971849e-18_rk, &
                                        -3.642734410091837960e-01_rk, 5.903896423897208744e-17_rk, 6.356729585565472880e-17_rk,-1.895530827886692018e-17_rk, &
                                        -4.448626463138994827e-18_rk, -1.359486989694218106e+00_rk, -3.435992537768366914e-17_rk,-8.199777902581588533e-18_rk, &
                                        1.590287382300800793e-17_rk, -1.516616720248342526e-17_rk, 2.615365636088421569e-02_rk,-4.160987318803461260e-17_rk, &
                                        6.968540437527581757e-18_rk, 3.309905921275091715e-17_rk, -5.547685180649555667e-17_rk,9.760677434251696649e-02_rk, &
                                        6.920544426724497892e-17_rk, 7.491526967746554756e-17_rk, -9.760677434251699425e-02_rk,6.855307785766434542e-17_rk, &
                                        1.178043056465933602e-17_rk, 5.826426798150658814e-17_rk, 6.434199211312022810e-17_rk,-3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -2.615365636088425733e-02_rk, 1.177838239018873055e-18_rk, 1.742223453076860954e-17_rk,-7.835342603844347895e-18_rk, &
                                        3.227488174077536719e-17_rk, -9.760677434251704976e-02_rk, -4.400681059380590097e-17_rk,1.127185389764336566e-18_rk, &
                                        3.642734410091837960e-01_rk, -8.993939516771840909e-17_rk, -6.764365099700637543e-17_rk,-3.692181732568103332e-17_rk, &
                                        -3.470615322896851179e-17_rk, 1.359486989694218106e+00_rk, 8.241423094041525472e-18_rk,-4.177117217574164344e-17_rk, &
                                        1.742223453076861878e-17_rk, -7.835342603844354058e-18_rk, -2.615365636088422957e-02_rk,1.177838239018873055e-18_rk, &
                                        -4.400681059380590097e-17_rk, 1.127185389764338877e-18_rk, 3.227488174077536103e-17_rk,-9.760677434251704976e-02_rk, &
                                        -6.764365099700637543e-17_rk, -3.692181732568103332e-17_rk, 3.642734410091837960e-01_rk,-8.993939516771839677e-17_rk, &
                                        8.241423094041525472e-18_rk, -4.177117217574165576e-17_rk, -3.470615322896849947e-17_rk,1.359486989694218106e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.952135486850339191e-02_rk, 8.304337058141678983e-18_rk, -4.720357854980674181e-18_rk,2.045189680691762569e-18_rk, &
                                        8.304337058141678983e-18_rk, -1.952135486850340579e-02_rk, 2.045189680691762569e-18_rk,-4.720357854980674181e-18_rk, &
                                        1.952135486850341273e-02_rk, -1.199723772094154979e-17_rk, -8.559109490020721725e-18_rk,-6.764463049988764388e-18_rk, &
                                        -1.199723772094155134e-17_rk, 1.952135486850341273e-02_rk, -6.764463049988763618e-18_rk,-8.559109490020721725e-18_rk, &
                                        2.078362424684669359e-18_rk, -3.999592265164819579e-18_rk, -7.285468820183674254e-02_rk,-2.135322518751948162e-18_rk, &
                                        -3.999592265164818039e-18_rk, 2.078362424684668589e-18_rk, -2.135322518751947006e-18_rk,-7.285468820183674254e-02_rk, &
                                        -6.125371915794615352e-18_rk, 5.824448579201807259e-18_rk, 7.285468820183675642e-02_rk,-5.707341490445994851e-19_rk, &
                                        5.824448579201807259e-18_rk, -6.125371915794615352e-18_rk, -5.707341490445991000e-19_rk,7.285468820183675642e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -9.760677434251699425e-02_rk, 5.547685180649555667e-17_rk, -3.309905921275092331e-17_rk,-6.968540437527581757e-18_rk, &
                                        4.160987318803462493e-17_rk, -2.615365636088426426e-02_rk, 1.516616720248342526e-17_rk,-1.590287382300801410e-17_rk, &
                                        3.642734410091837960e-01_rk, -6.434199211312024043e-17_rk, -5.826426798150658814e-17_rk,-1.178043056465933602e-17_rk, &
                                        -6.855307785766434542e-17_rk, 9.760677434251699425e-02_rk, -7.491526967746553523e-17_rk,-6.920544426724497892e-17_rk, &
                                        8.690915649597970308e-18_rk, -5.046913647737169488e-17_rk, -3.642734410091836850e-01_rk,-9.516264756318007634e-18_rk, &
                                        -1.934265640759967290e-17_rk, 4.565046015521388986e-17_rk, -2.327266756146925958e-17_rk,-9.760677434251696649e-02_rk, &
                                        8.199777902581582370e-18_rk, 3.435992537768366914e-17_rk, 1.359486989694218106e+00_rk,4.448626463139004072e-18_rk, &
                                        1.895530827886692018e-17_rk, -6.356729585565472880e-17_rk, -5.903896423897208744e-17_rk,3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,3) = reshape((/                                                                                 &
                                        3.642734410091836295e-01_rk, -1.368570530940218647e-17_rk, 2.553532895291728649e-17_rk,1.343086632109337875e-17_rk, &
                                        -1.715936738754648304e-17_rk, 9.760677434251699425e-02_rk, -3.658853398728107181e-18_rk,-1.232535180143726161e-17_rk, &
                                        -3.642734410091837960e-01_rk, 2.518721242101273072e-17_rk, 8.293317903183346928e-18_rk,-1.433807171898280148e-17_rk, &
                                        3.765264692891802993e-17_rk, -9.760677434251699425e-02_rk, 1.903814407291758174e-17_rk,6.512908912589333229e-17_rk, &
                                        2.553532895291728033e-17_rk, 1.343086632109337875e-17_rk, 3.642734410091836295e-01_rk,-1.368570530940218647e-17_rk, &
                                        -3.658853398728104100e-18_rk, -1.232535180143726315e-17_rk, -1.715936738754647380e-17_rk,9.760677434251696649e-02_rk, &
                                        8.293317903183350010e-18_rk, -1.433807171898279840e-17_rk, -3.642734410091837960e-01_rk,2.518721242101272456e-17_rk, &
                                        1.903814407291759098e-17_rk, 6.512908912589333229e-17_rk, 3.765264692891803609e-17_rk,-9.760677434251699425e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,1) = reshape((/                                                                                 &
                                        1.952135486850339191e-02_rk, -8.304337058141678983e-18_rk, 4.720357854980674181e-18_rk,-2.045189680691762569e-18_rk, &
                                        -8.304337058141678983e-18_rk, 1.952135486850340579e-02_rk, -2.045189680691762569e-18_rk,4.720357854980674181e-18_rk, &
                                        -1.952135486850341273e-02_rk, 1.199723772094154979e-17_rk, 8.559109490020721725e-18_rk,6.764463049988764388e-18_rk, &
                                        1.199723772094155134e-17_rk, -1.952135486850341273e-02_rk, 6.764463049988763618e-18_rk,8.559109490020721725e-18_rk, &
                                        -2.078362424684669359e-18_rk, 3.999592265164819579e-18_rk, 7.285468820183674254e-02_rk,2.135322518751948162e-18_rk, &
                                        3.999592265164818039e-18_rk, -2.078362424684668589e-18_rk, 2.135322518751947006e-18_rk,7.285468820183674254e-02_rk, &
                                        6.125371915794615352e-18_rk, -5.824448579201807259e-18_rk, -7.285468820183675642e-02_rk,5.707341490445994851e-19_rk, &
                                        -5.824448579201807259e-18_rk, 6.125371915794615352e-18_rk, 5.707341490445991000e-19_rk,-7.285468820183675642e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -2.615365636088425733e-02_rk, 4.160987318803461260e-17_rk, -1.590287382300801410e-17_rk,1.516616720248342526e-17_rk, &
                                        5.547685180649556900e-17_rk, -9.760677434251699425e-02_rk, -6.968540437527584838e-18_rk,-3.309905921275092331e-17_rk, &
                                        9.760677434251699425e-02_rk, -6.855307785766434542e-17_rk, -6.920544426724497892e-17_rk,-7.491526967746554756e-17_rk, &
                                        -6.434199211312022810e-17_rk, 3.642734410091837960e-01_rk, -1.178043056465933602e-17_rk,-5.826426798150658814e-17_rk, &
                                        4.565046015521388986e-17_rk, -1.934265640759967599e-17_rk, -9.760677434251696649e-02_rk,-2.327266756146925958e-17_rk, &
                                        -5.046913647737169488e-17_rk, 8.690915649597971849e-18_rk, -9.516264756318007634e-18_rk,-3.642734410091836850e-01_rk, &
                                        -6.356729585565472880e-17_rk, 1.895530827886692018e-17_rk, 3.642734410091837960e-01_rk,-5.903896423897208744e-17_rk, &
                                        3.435992537768366914e-17_rk, 8.199777902581582370e-18_rk, 4.448626463139004072e-18_rk,1.359486989694218106e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,3) = reshape((/                                                                                 &
                                        9.760677434251699425e-02_rk, -1.715936738754647688e-17_rk, -1.232535180143726469e-17_rk,-3.658853398728107181e-18_rk, &
                                        -1.368570530940219264e-17_rk, 3.642734410091836295e-01_rk, 1.343086632109337875e-17_rk,2.553532895291728649e-17_rk, &
                                        -9.760677434251699425e-02_rk, 3.765264692891803609e-17_rk, 6.512908912589333229e-17_rk,1.903814407291758790e-17_rk, &
                                        2.518721242101272764e-17_rk, -3.642734410091837960e-01_rk, -1.433807171898280148e-17_rk,8.293317903183346928e-18_rk, &
                                        -1.232535180143726931e-17_rk, -3.658853398728104100e-18_rk, 9.760677434251693874e-02_rk,-1.715936738754647688e-17_rk, &
                                        1.343086632109337875e-17_rk, 2.553532895291728341e-17_rk, -1.368570530940218801e-17_rk,3.642734410091836295e-01_rk, &
                                        6.512908912589333229e-17_rk, 1.903814407291759098e-17_rk, -9.760677434251699425e-02_rk,3.765264692891803609e-17_rk, &
                                        -1.433807171898280457e-17_rk, 8.293317903183353091e-18_rk, 2.518721242101272456e-17_rk,-3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -5.230731272176849384e-03_rk, 1.111300794076435610e-17_rk, -5.080028752171114071e-18_rk,-4.056643277005957177e-19_rk, &
                                        1.111300794076435456e-17_rk, -5.230731272176849384e-03_rk, -4.056643277005949473e-19_rk,-5.080028752171114071e-18_rk, &
                                        7.285468820183674254e-02_rk, -1.458177627321536152e-17_rk, -1.693483295972959169e-17_rk,-1.057467699843621279e-17_rk, &
                                        -1.458177627321536152e-17_rk, 7.285468820183674254e-02_rk, -1.057467699843621279e-17_rk,-1.693483295972959169e-17_rk, &
                                        8.789912736277702213e-18_rk, -9.962766311829457675e-18_rk, -1.952135486850341273e-02_rk,-4.422463944805506360e-18_rk, &
                                        -9.962766311829456135e-18_rk, 8.789912736277702213e-18_rk, -4.422463944805505590e-18_rk,-1.952135486850341273e-02_rk, &
                                        -4.948131674820018249e-18_rk, 4.838598152108309988e-18_rk, 2.718973979388435436e-01_rk,-1.034733340612201804e-17_rk, &
                                        4.838598152108309988e-18_rk, -4.948131674820017479e-18_rk, -1.034733340612201958e-17_rk,2.718973979388435436e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,2) = reshape((/                                                                                 &
                                        9.760677434251699425e-02_rk, -5.547685180649555667e-17_rk, 3.309905921275092331e-17_rk,6.968540437527581757e-18_rk, &
                                        -4.160987318803462493e-17_rk, 2.615365636088426426e-02_rk, -1.516616720248342526e-17_rk,1.590287382300801410e-17_rk, &
                                        -3.642734410091837960e-01_rk, 6.434199211312024043e-17_rk, 5.826426798150658814e-17_rk,1.178043056465933602e-17_rk, &
                                        6.855307785766434542e-17_rk, -9.760677434251699425e-02_rk, 7.491526967746553523e-17_rk,6.920544426724497892e-17_rk, &
                                        -8.690915649597970308e-18_rk, 5.046913647737169488e-17_rk, 3.642734410091836850e-01_rk,9.516264756318007634e-18_rk, &
                                        1.934265640759967290e-17_rk, -4.565046015521388986e-17_rk, 2.327266756146925958e-17_rk,9.760677434251696649e-02_rk, &
                                        -8.199777902581582370e-18_rk, -3.435992537768366914e-17_rk, -1.359486989694218106e+00_rk,-4.448626463139004072e-18_rk, &
                                        -1.895530827886692018e-17_rk, 6.356729585565472880e-17_rk, 5.903896423897208744e-17_rk,-3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,3) = reshape((/                                                                                 &
                                        9.760677434251704976e-02_rk, -3.227488174077536719e-17_rk, -1.127185389764333484e-18_rk,4.400681059380590097e-17_rk, &
                                        -1.177838239018879218e-18_rk, 2.615365636088427120e-02_rk, 7.835342603844347895e-18_rk,-1.742223453076861570e-17_rk, &
                                        -1.359486989694218106e+00_rk, 3.470615322896850563e-17_rk, 4.177117217574164344e-17_rk,-8.241423094041525472e-18_rk, &
                                        8.993939516771840909e-17_rk, -3.642734410091837960e-01_rk, 3.692181732568102715e-17_rk,6.764365099700637543e-17_rk, &
                                        -1.127185389764335025e-18_rk, 4.400681059380590097e-17_rk, 9.760677434251704976e-02_rk,-3.227488174077536719e-17_rk, &
                                        7.835342603844354058e-18_rk, -1.742223453076861878e-17_rk, -1.177838239018876137e-18_rk,2.615365636088421569e-02_rk, &
                                        4.177117217574165576e-17_rk, -8.241423094041525472e-18_rk, -1.359486989694218106e+00_rk,3.470615322896849947e-17_rk, &
                                        3.692181732568103332e-17_rk, 6.764365099700637543e-17_rk, 8.993939516771840909e-17_rk,-3.642734410091837960e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,1) = reshape((/                                                                                 &
                                        5.230731272176849384e-03_rk, -1.111300794076435610e-17_rk, 5.080028752171114071e-18_rk,4.056643277005957177e-19_rk, &
                                        -1.111300794076435456e-17_rk, 5.230731272176849384e-03_rk, 4.056643277005949473e-19_rk,5.080028752171114071e-18_rk, &
                                        -7.285468820183674254e-02_rk, 1.458177627321536152e-17_rk, 1.693483295972959169e-17_rk,1.057467699843621279e-17_rk, &
                                        1.458177627321536152e-17_rk, -7.285468820183674254e-02_rk, 1.057467699843621279e-17_rk,1.693483295972959169e-17_rk, &
                                        -8.789912736277702213e-18_rk, 9.962766311829457675e-18_rk, 1.952135486850341273e-02_rk,4.422463944805506360e-18_rk, &
                                        9.962766311829456135e-18_rk, -8.789912736277702213e-18_rk, 4.422463944805505590e-18_rk,1.952135486850341273e-02_rk, &
                                        4.948131674820018249e-18_rk, -4.838598152108309988e-18_rk, -2.718973979388435436e-01_rk,1.034733340612201804e-17_rk, &
                                        -4.838598152108309988e-18_rk, 4.948131674820017479e-18_rk, 1.034733340612201958e-17_rk,-2.718973979388435436e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,2) = reshape((/                                                                                 &
                                        2.615365636088425733e-02_rk, -4.160987318803461260e-17_rk, 1.590287382300801410e-17_rk,-1.516616720248342526e-17_rk, &
                                        -5.547685180649556900e-17_rk, 9.760677434251699425e-02_rk, 6.968540437527584838e-18_rk,3.309905921275092331e-17_rk, &
                                        -9.760677434251699425e-02_rk, 6.855307785766434542e-17_rk, 6.920544426724497892e-17_rk,7.491526967746554756e-17_rk, &
                                        6.434199211312022810e-17_rk, -3.642734410091837960e-01_rk, 1.178043056465933602e-17_rk,5.826426798150658814e-17_rk, &
                                        -4.565046015521388986e-17_rk, 1.934265640759967599e-17_rk, 9.760677434251696649e-02_rk,2.327266756146925958e-17_rk, &
                                        5.046913647737169488e-17_rk, -8.690915649597971849e-18_rk, 9.516264756318007634e-18_rk,3.642734410091836850e-01_rk, &
                                        6.356729585565472880e-17_rk, -1.895530827886692018e-17_rk, -3.642734410091837960e-01_rk,5.903896423897208744e-17_rk, &
                                        -3.435992537768366914e-17_rk, -8.199777902581582370e-18_rk, -4.448626463139004072e-18_rk,-1.359486989694218106e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,3) = reshape((/                                                                                 &
                                        2.615365636088425733e-02_rk, -1.177838239018873055e-18_rk, -1.742223453076860954e-17_rk,7.835342603844347895e-18_rk, &
                                        -3.227488174077536719e-17_rk, 9.760677434251704976e-02_rk, 4.400681059380590097e-17_rk,-1.127185389764336566e-18_rk, &
                                        -3.642734410091837960e-01_rk, 8.993939516771840909e-17_rk, 6.764365099700637543e-17_rk,3.692181732568103332e-17_rk, &
                                        3.470615322896851179e-17_rk, -1.359486989694218106e+00_rk, -8.241423094041525472e-18_rk,4.177117217574164344e-17_rk, &
                                        -1.742223453076861878e-17_rk, 7.835342603844354058e-18_rk, 2.615365636088422957e-02_rk,-1.177838239018873055e-18_rk, &
                                        4.400681059380590097e-17_rk, -1.127185389764338877e-18_rk, -3.227488174077536103e-17_rk,9.760677434251704976e-02_rk, &
                                        6.764365099700637543e-17_rk, 3.692181732568103332e-17_rk, -3.642734410091837960e-01_rk,8.993939516771839677e-17_rk, &
                                        -8.241423094041525472e-18_rk, 4.177117217574165576e-17_rk, 3.470615322896849947e-17_rk,-1.359486989694218106e+00_rk  &
                                        /),(/4,8/))
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face5_dx
        ! 
        test_dbr2_vol_face5_dx(:,:,1,1) = reshape((/                                                                                 &
                                        2.718973979388435436e-01_rk, 2.749517455843973646e-18_rk, -1.190763908338528506e-19_rk,6.656104930734578424e-18_rk, &
                                        2.749517455843973646e-18_rk, 2.718973979388435436e-01_rk, 6.656104930734577654e-18_rk,-1.190763908338536210e-19_rk, &
                                        1.629485700914107101e-18_rk, 3.224465780174177902e-18_rk, 7.285468820183674254e-02_rk,-5.149403666574568693e-18_rk, &
                                        3.224465780174177132e-18_rk, 1.629485700914107101e-18_rk, -5.149403666574570234e-18_rk,7.285468820183674254e-02_rk, &
                                        -1.952135486850337803e-02_rk, 5.965573576267826987e-19_rk, 3.351727800124969544e-18_rk,-1.057720964089893800e-17_rk, &
                                        5.965573576267834691e-19_rk, -1.952135486850337803e-02_rk, -1.057720964089893954e-17_rk,3.351727800124969544e-18_rk, &
                                        -4.471577719507145462e-18_rk, -1.678798841957958791e-17_rk, -5.230731272176847649e-03_rk,5.580303501128585802e-18_rk, &
                                        -1.678798841957958791e-17_rk, -4.471577719507145462e-18_rk, 5.580303501128585802e-18_rk,-5.230731272176847649e-03_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.359486989694217662e+00_rk, -1.755553104221061949e-17_rk, 3.070773636726120758e-17_rk,3.524624727648294048e-17_rk, &
                                        4.239613134821202814e-18_rk, 3.642734410091836850e-01_rk, 1.284011942432442282e-17_rk,-2.447217667059636439e-17_rk, &
                                        2.939124951352478694e-17_rk, 3.656273413021935496e-17_rk, 1.359486989694217662e+00_rk,-1.887201789594704013e-17_rk, &
                                        1.152363257058799756e-17_rk, -2.315568981685994374e-17_rk, 5.556099988557635011e-18_rk,3.642734410091836850e-01_rk, &
                                        -9.760677434251691098e-02_rk, 3.959911227625159576e-17_rk, -1.985768648749284139e-17_rk,-5.254961538202251490e-17_rk, &
                                        -7.398321128738333292e-18_rk, -2.615365636088423651e-02_rk, -8.295988806663370167e-17_rk,1.557492374431837473e-17_rk, &
                                        -1.854119963375641766e-17_rk, -5.386610223575892322e-17_rk, -9.760677434251691098e-02_rk,4.091559912998802257e-17_rk, &
                                        -8.164340121289728103e-17_rk, 1.425843689058195101e-17_rk, -8.714807982474752393e-18_rk,-2.615365636088423651e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.359486989694217662e+00_rk, -1.535886176396854241e-17_rk, 1.218142140858698015e-17_rk,4.373787430143296796e-17_rk, &
                                        7.770067536513642303e-18_rk, 3.642734410091836850e-01_rk, 3.889994070379869274e-17_rk,-4.133192923786707850e-17_rk, &
                                        1.265793693752721132e-17_rk, 3.591885046442128336e-17_rk, 3.642734410091836850e-01_rk,-4.621979863888065367e-17_rk, &
                                        3.040465812432962646e-17_rk, -2.638868053590235702e-17_rk, -1.839987496740109202e-17_rk,9.760677434251696649e-02_rk, &
                                        -3.642734410091835739e-01_rk, 2.468145245592016444e-17_rk, -2.873202658377531279e-17_rk,-5.793227808457150296e-17_rk, &
                                        -1.507993831091974140e-17_rk, -9.760677434251693874e-02_rk, -3.975649325243359593e-17_rk,2.984896235585776021e-17_rk, &
                                        -3.332171525626360750e-17_rk, -5.096392977890711392e-17_rk, -9.760677434251693874e-02_rk,4.809073930120163556e-17_rk, &
                                        -7.547997310373200256e-17_rk, -2.561367033985326527e-18_rk, 1.699226170769465604e-17_rk,-2.615365636088426426e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -2.718973979388435436e-01_rk, -2.749517455843973646e-18_rk, 1.190763908338528506e-19_rk,-6.656104930734578424e-18_rk, &
                                        -2.749517455843973646e-18_rk, -2.718973979388435436e-01_rk, -6.656104930734577654e-18_rk,1.190763908338536210e-19_rk, &
                                        -1.629485700914107101e-18_rk, -3.224465780174177902e-18_rk, -7.285468820183674254e-02_rk,5.149403666574568693e-18_rk, &
                                        -3.224465780174177132e-18_rk, -1.629485700914107101e-18_rk, 5.149403666574570234e-18_rk,-7.285468820183674254e-02_rk, &
                                        1.952135486850337803e-02_rk, -5.965573576267826987e-19_rk, -3.351727800124969544e-18_rk,1.057720964089893800e-17_rk, &
                                        -5.965573576267834691e-19_rk, 1.952135486850337803e-02_rk, 1.057720964089893954e-17_rk,-3.351727800124969544e-18_rk, &
                                        4.471577719507145462e-18_rk, 1.678798841957958791e-17_rk, 5.230731272176847649e-03_rk,-5.580303501128585802e-18_rk, &
                                        1.678798841957958791e-17_rk, 4.471577719507145462e-18_rk, -5.580303501128585802e-18_rk,5.230731272176847649e-03_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,2) = reshape((/                                                                                 &
                                        3.642734410091836850e-01_rk, 4.239613134821200503e-18_rk, -2.447217667059636747e-17_rk,1.284011942432442590e-17_rk, &
                                        -1.755553104221060717e-17_rk, 1.359486989694217662e+00_rk, 3.524624727648294048e-17_rk,3.070773636726120758e-17_rk, &
                                        -2.315568981685994066e-17_rk, 1.152363257058800218e-17_rk, 3.642734410091836850e-01_rk,5.556099988557625766e-18_rk, &
                                        3.656273413021935496e-17_rk, 2.939124951352479310e-17_rk, -1.887201789594703397e-17_rk,1.359486989694217662e+00_rk, &
                                        -2.615365636088426426e-02_rk, -7.398321128738327129e-18_rk, 1.557492374431838089e-17_rk,-8.295988806663370167e-17_rk, &
                                        3.959911227625159576e-17_rk, -9.760677434251691098e-02_rk, -5.254961538202250874e-17_rk,-1.985768648749284755e-17_rk, &
                                        1.425843689058195717e-17_rk, -8.164340121289726870e-17_rk, -2.615365636088423651e-02_rk,-8.714807982474753934e-18_rk, &
                                        -5.386610223575893555e-17_rk, -1.854119963375641766e-17_rk, 4.091559912998802873e-17_rk,-9.760677434251691098e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,3) = reshape((/                                                                                 &
                                        3.642734410091836850e-01_rk, 7.770067536513640763e-18_rk, -4.133192923786708466e-17_rk,3.889994070379869274e-17_rk, &
                                        -1.535886176396853009e-17_rk, 1.359486989694217662e+00_rk, 4.373787430143296796e-17_rk,1.218142140858697707e-17_rk, &
                                        -2.638868053590235702e-17_rk, 3.040465812432962646e-17_rk, 9.760677434251696649e-02_rk,-1.839987496740109510e-17_rk, &
                                        3.591885046442128336e-17_rk, 1.265793693752721286e-17_rk, -4.621979863888064751e-17_rk,3.642734410091836850e-01_rk, &
                                        -9.760677434251696649e-02_rk, -1.507993831091973524e-17_rk, 2.984896235585776638e-17_rk,-3.975649325243359593e-17_rk, &
                                        2.468145245592016444e-17_rk, -3.642734410091835184e-01_rk, -5.793227808457150296e-17_rk,-2.873202658377531279e-17_rk, &
                                        -2.561367033985324216e-18_rk, -7.547997310373199024e-17_rk, -2.615365636088426426e-02_rk,1.699226170769465296e-17_rk, &
                                        -5.096392977890712625e-17_rk, -3.332171525626360134e-17_rk, 4.809073930120163556e-17_rk,-9.760677434251693874e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,1) = reshape((/                                                                                 &
                                        7.285468820183674254e-02_rk, -5.412701037321852976e-18_rk, 1.366188330166822818e-18_rk,2.961168409426893620e-18_rk, &
                                        -5.412701037321853746e-18_rk, 7.285468820183674254e-02_rk, 2.961168409426893620e-18_rk,1.366188330166822048e-18_rk, &
                                        -3.823737615811373256e-19_rk, 6.392807559987294142e-18_rk, 2.718973979388435436e-01_rk,2.486220085096688978e-18_rk, &
                                        6.392807559987293372e-18_rk, -3.823737615811380960e-19_rk, 2.486220085096688208e-18_rk,2.718973979388435436e-01_rk, &
                                        -5.230731272176840710e-03_rk, 5.843600871875870084e-18_rk, -4.208280348759860410e-18_rk,-1.652469104883230439e-17_rk, &
                                        5.843600871875871625e-18_rk, -5.230731272176844179e-03_rk, -1.652469104883230439e-17_rk,-4.208280348759860410e-18_rk, &
                                        3.615025170872254597e-18_rk, -1.031391227015165448e-17_rk, -1.952135486850338497e-02_rk,8.598547283740680404e-19_rk, &
                                        -1.031391227015165448e-17_rk, 3.615025170872253826e-18_rk, 8.598547283740676552e-19_rk,-1.952135486850338497e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.359486989694217662e+00_rk, 1.755553104221061949e-17_rk, -3.070773636726120758e-17_rk,-3.524624727648294048e-17_rk, &
                                        -4.239613134821202814e-18_rk, -3.642734410091836850e-01_rk, -1.284011942432442282e-17_rk,2.447217667059636439e-17_rk, &
                                        -2.939124951352478694e-17_rk, -3.656273413021935496e-17_rk, -1.359486989694217662e+00_rk,1.887201789594704013e-17_rk, &
                                        -1.152363257058799756e-17_rk, 2.315568981685994374e-17_rk, -5.556099988557635011e-18_rk,-3.642734410091836850e-01_rk, &
                                        9.760677434251691098e-02_rk, -3.959911227625159576e-17_rk, 1.985768648749284139e-17_rk,5.254961538202251490e-17_rk, &
                                        7.398321128738333292e-18_rk, 2.615365636088423651e-02_rk, 8.295988806663370167e-17_rk,-1.557492374431837473e-17_rk, &
                                        1.854119963375641766e-17_rk, 5.386610223575892322e-17_rk, 9.760677434251691098e-02_rk,-4.091559912998802257e-17_rk, &
                                        8.164340121289728103e-17_rk, -1.425843689058195101e-17_rk, 8.714807982474752393e-18_rk,2.615365636088423651e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,3) = reshape((/                                                                                 &
                                        3.642734410091836850e-01_rk, -4.621979863888065984e-17_rk, 1.265793693752721132e-17_rk,3.424961202138001048e-17_rk, &
                                        -2.006911341044238339e-17_rk, 9.760677434251696649e-02_rk, 3.040465812432963262e-17_rk,-2.805791897894364223e-17_rk, &
                                        1.051218296554569186e-17_rk, 4.373787430143296179e-17_rk, 1.359486989694217662e+00_rk,-1.702810020700982762e-17_rk, &
                                        3.723070226075740753e-17_rk, -4.133192923786708466e-17_rk, 7.770067536513650007e-18_rk,3.642734410091836850e-01_rk, &
                                        -9.760677434251696649e-02_rk, 4.809073930120162940e-17_rk, -3.332171525626360134e-17_rk,-4.929469133586583488e-17_rk, &
                                        1.866150015073593817e-17_rk, -2.615365636088426426e-02_rk, -7.547997310373199024e-17_rk,-8.921285909440451683e-19_rk, &
                                        -2.706278814073402758e-17_rk, -5.793227808457149063e-17_rk, -3.642734410091835184e-01_rk,2.635069089896145273e-17_rk, &
                                        -3.808725480939230456e-17_rk, 2.984896235585776021e-17_rk, -1.507993831091973832e-17_rk,-9.760677434251693874e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -7.285468820183674254e-02_rk, 5.412701037321852976e-18_rk, -1.366188330166822818e-18_rk,-2.961168409426893620e-18_rk, &
                                        5.412701037321853746e-18_rk, -7.285468820183674254e-02_rk, -2.961168409426893620e-18_rk,-1.366188330166822048e-18_rk, &
                                        3.823737615811373256e-19_rk, -6.392807559987294142e-18_rk, -2.718973979388435436e-01_rk,-2.486220085096688978e-18_rk, &
                                        -6.392807559987293372e-18_rk, 3.823737615811380960e-19_rk, -2.486220085096688208e-18_rk,-2.718973979388435436e-01_rk, &
                                        5.230731272176840710e-03_rk, -5.843600871875870084e-18_rk, 4.208280348759860410e-18_rk,1.652469104883230439e-17_rk, &
                                        -5.843600871875871625e-18_rk, 5.230731272176844179e-03_rk, 1.652469104883230439e-17_rk,4.208280348759860410e-18_rk, &
                                        -3.615025170872254597e-18_rk, 1.031391227015165448e-17_rk, 1.952135486850338497e-02_rk,-8.598547283740680404e-19_rk, &
                                        1.031391227015165448e-17_rk, -3.615025170872253826e-18_rk, -8.598547283740676552e-19_rk,1.952135486850338497e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -3.642734410091836850e-01_rk, -4.239613134821200503e-18_rk, 2.447217667059636747e-17_rk,-1.284011942432442590e-17_rk, &
                                        1.755553104221060717e-17_rk, -1.359486989694217662e+00_rk, -3.524624727648294048e-17_rk,-3.070773636726120758e-17_rk, &
                                        2.315568981685994066e-17_rk, -1.152363257058800218e-17_rk, -3.642734410091836850e-01_rk,-5.556099988557625766e-18_rk, &
                                        -3.656273413021935496e-17_rk, -2.939124951352479310e-17_rk, 1.887201789594703397e-17_rk,-1.359486989694217662e+00_rk, &
                                        2.615365636088426426e-02_rk, 7.398321128738327129e-18_rk, -1.557492374431838089e-17_rk,8.295988806663370167e-17_rk, &
                                        -3.959911227625159576e-17_rk, 9.760677434251691098e-02_rk, 5.254961538202250874e-17_rk,1.985768648749284755e-17_rk, &
                                        -1.425843689058195717e-17_rk, 8.164340121289726870e-17_rk, 2.615365636088423651e-02_rk,8.714807982474753934e-18_rk, &
                                        5.386610223575893555e-17_rk, 1.854119963375641766e-17_rk, -4.091559912998802873e-17_rk,9.760677434251691098e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,3) = reshape((/                                                                                 &
                                        9.760677434251696649e-02_rk, -2.006911341044238647e-17_rk, -2.805791897894364840e-17_rk,3.040465812432963262e-17_rk, &
                                        -4.621979863888064751e-17_rk, 3.642734410091836850e-01_rk, 3.424961202138001048e-17_rk,1.265793693752720823e-17_rk, &
                                        -4.133192923786708466e-17_rk, 3.723070226075740753e-17_rk, 3.642734410091836850e-01_rk,7.770067536513640763e-18_rk, &
                                        4.373787430143296179e-17_rk, 1.051218296554569648e-17_rk, -1.702810020700982146e-17_rk,1.359486989694217662e+00_rk, &
                                        -2.615365636088429896e-02_rk, 1.866150015073594433e-17_rk, -8.921285909440336128e-19_rk,-7.547997310373199024e-17_rk, &
                                        4.809073930120162940e-17_rk, -9.760677434251693874e-02_rk, -4.929469133586584104e-17_rk,-3.332171525626360750e-17_rk, &
                                        2.984896235585776638e-17_rk, -3.808725480939229223e-17_rk, -9.760677434251693874e-02_rk,-1.507993831091974140e-17_rk, &
                                        -5.793227808457150296e-17_rk, -2.706278814073402141e-17_rk, 2.635069089896146198e-17_rk,-3.642734410091835184e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,1) = reshape((/                                                                                 &
                                        7.285468820183674254e-02_rk, -4.267276301334950124e-18_rk, -5.711025175022167030e-18_rk,9.871458070311752481e-18_rk, &
                                        -4.267276301334950124e-18_rk, 7.285468820183674254e-02_rk, 9.871458070311752481e-18_rk,-5.711025175022167800e-18_rk, &
                                        -4.375634420589136859e-18_rk, 1.004023593757600452e-17_rk, 1.952135486850339885e-02_rk,-7.774531054681779520e-18_rk, &
                                        1.004023593757600298e-17_rk, -4.375634420589136859e-18_rk, -7.774531054681779520e-18_rk,1.952135486850339885e-02_rk, &
                                        -7.285468820183672867e-02_rk, 1.323745471373301505e-18_rk, -3.128340645708477131e-18_rk,-8.960544626502076852e-18_rk, &
                                        1.323745471373302275e-18_rk, -7.285468820183672867e-02_rk, -8.960544626502078392e-18_rk,-3.128340645708477131e-18_rk, &
                                        -2.705038738542641035e-18_rk, -8.500792156948236932e-18_rk, -1.952135486850339885e-02_rk,7.436296700650672826e-18_rk, &
                                        -8.500792156948236932e-18_rk, -2.705038738542641035e-18_rk, 7.436296700650671285e-18_rk,-1.952135486850339885e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,2) = reshape((/                                                                                 &
                                        3.642734410091836850e-01_rk, -4.402312936063857968e-17_rk, -5.868378021147017650e-18_rk,4.274123904633003795e-17_rk, &
                                        -1.653865900874994313e-17_rk, 9.760677434251696649e-02_rk, 5.646447940380390408e-17_rk,-4.491767154621435943e-17_rk, &
                                        -6.221129610451886841e-18_rk, 4.309399063563489019e-17_rk, 3.642734410091836850e-01_rk,-4.437588094994343808e-17_rk, &
                                        5.611172781449903334e-17_rk, -4.456491995690950102e-17_rk, -1.618590741944507548e-17_rk,9.760677434251696649e-02_rk, &
                                        -3.642734410091836295e-01_rk, 3.317307948087019807e-17_rk, -4.219605535254607582e-17_rk,-5.467735403841483526e-17_rk, &
                                        1.097988296855453006e-17_rk, -9.760677434251696649e-02_rk, -3.227657828953187834e-17_rk,1.338191002059534262e-17_rk, &
                                        -4.184330376324121741e-17_rk, -5.503010562771969366e-17_rk, -3.642734410091835739e-01_rk,3.352583107017506264e-17_rk, &
                                        -3.192382670022702609e-17_rk, 1.302915843129048268e-17_rk, 1.062713137924967165e-17_rk,-9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.359486989694217662e+00_rk, 1.535886176396854241e-17_rk, -1.218142140858698015e-17_rk,-4.373787430143296796e-17_rk, &
                                        -7.770067536513642303e-18_rk, -3.642734410091836850e-01_rk, -3.889994070379869274e-17_rk,4.133192923786707850e-17_rk, &
                                        -1.265793693752721132e-17_rk, -3.591885046442128336e-17_rk, -3.642734410091836850e-01_rk,4.621979863888065367e-17_rk, &
                                        -3.040465812432962646e-17_rk, 2.638868053590235702e-17_rk, 1.839987496740109202e-17_rk,-9.760677434251696649e-02_rk, &
                                        3.642734410091835739e-01_rk, -2.468145245592016444e-17_rk, 2.873202658377531279e-17_rk,5.793227808457150296e-17_rk, &
                                        1.507993831091974140e-17_rk, 9.760677434251693874e-02_rk, 3.975649325243359593e-17_rk,-2.984896235585776021e-17_rk, &
                                        3.332171525626360750e-17_rk, 5.096392977890711392e-17_rk, 9.760677434251693874e-02_rk,-4.809073930120163556e-17_rk, &
                                        7.547997310373200256e-17_rk, 2.561367033985326527e-18_rk, -1.699226170769465604e-17_rk,2.615365636088426426e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -7.285468820183674254e-02_rk, 4.267276301334950124e-18_rk, 5.711025175022167030e-18_rk,-9.871458070311752481e-18_rk, &
                                        4.267276301334950124e-18_rk, -7.285468820183674254e-02_rk, -9.871458070311752481e-18_rk,5.711025175022167800e-18_rk, &
                                        4.375634420589136859e-18_rk, -1.004023593757600452e-17_rk, -1.952135486850339885e-02_rk,7.774531054681779520e-18_rk, &
                                        -1.004023593757600298e-17_rk, 4.375634420589136859e-18_rk, 7.774531054681779520e-18_rk,-1.952135486850339885e-02_rk, &
                                        7.285468820183672867e-02_rk, -1.323745471373301505e-18_rk, 3.128340645708477131e-18_rk,8.960544626502076852e-18_rk, &
                                        -1.323745471373302275e-18_rk, 7.285468820183672867e-02_rk, 8.960544626502078392e-18_rk,3.128340645708477131e-18_rk, &
                                        2.705038738542641035e-18_rk, 8.500792156948236932e-18_rk, 1.952135486850339885e-02_rk,-7.436296700650672826e-18_rk, &
                                        8.500792156948236932e-18_rk, 2.705038738542641035e-18_rk, -7.436296700650671285e-18_rk,1.952135486850339885e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,2) = reshape((/                                                                                 &
                                        9.760677434251696649e-02_rk, -1.653865900874994621e-17_rk, -4.491767154621436559e-17_rk,5.646447940380390408e-17_rk, &
                                        -4.402312936063856735e-17_rk, 3.642734410091836850e-01_rk, 4.274123904633004411e-17_rk,-5.868378021147021502e-18_rk, &
                                        -4.456491995690950102e-17_rk, 5.611172781449903334e-17_rk, 9.760677434251696649e-02_rk,-1.618590741944508164e-17_rk, &
                                        4.309399063563489019e-17_rk, -6.221129610451879137e-18_rk, -4.437588094994343808e-17_rk,3.642734410091836850e-01_rk, &
                                        -9.760677434251702200e-02_rk, 1.097988296855453622e-17_rk, 1.338191002059535033e-17_rk,-3.227657828953188450e-17_rk, &
                                        3.317307948087019807e-17_rk, -3.642734410091835739e-01_rk, -5.467735403841484142e-17_rk,-4.219605535254608198e-17_rk, &
                                        1.302915843129048422e-17_rk, -3.192382670022701377e-17_rk, -9.760677434251696649e-02_rk,1.062713137924966549e-17_rk, &
                                        -5.503010562771969366e-17_rk, -4.184330376324120509e-17_rk, 3.352583107017506881e-17_rk,-3.642734410091835739e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -3.642734410091836850e-01_rk, -7.770067536513640763e-18_rk, 4.133192923786708466e-17_rk,-3.889994070379869274e-17_rk, &
                                        1.535886176396853009e-17_rk, -1.359486989694217662e+00_rk, -4.373787430143296796e-17_rk,-1.218142140858697707e-17_rk, &
                                        2.638868053590235702e-17_rk, -3.040465812432962646e-17_rk, -9.760677434251696649e-02_rk,1.839987496740109510e-17_rk, &
                                        -3.591885046442128336e-17_rk, -1.265793693752721286e-17_rk, 4.621979863888064751e-17_rk,-3.642734410091836850e-01_rk, &
                                        9.760677434251696649e-02_rk, 1.507993831091973524e-17_rk, -2.984896235585776638e-17_rk,3.975649325243359593e-17_rk, &
                                        -2.468145245592016444e-17_rk, 3.642734410091835184e-01_rk, 5.793227808457150296e-17_rk,2.873202658377531279e-17_rk, &
                                        2.561367033985324216e-18_rk, 7.547997310373199024e-17_rk, 2.615365636088426426e-02_rk,-1.699226170769465296e-17_rk, &
                                        5.096392977890712625e-17_rk, 3.332171525626360134e-17_rk, -4.809073930120163556e-17_rk,9.760677434251693874e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.952135486850339885e-02_rk, -7.845081372542751818e-18_rk, -4.446184738450109926e-18_rk,9.969685619715032226e-18_rk, &
                                        -7.845081372542750277e-18_rk, 1.952135486850339885e-02_rk, 9.969685619715032226e-18_rk,-4.446184738450110697e-18_rk, &
                                        -5.781575492883140098e-18_rk, 9.800907752450780184e-18_rk, 7.285468820183674254e-02_rk,-4.337826619195923192e-18_rk, &
                                        9.800907752450778643e-18_rk, -5.781575492883140868e-18_rk, -4.337826619195923192e-18_rk,7.285468820183674254e-02_rk, &
                                        -1.952135486850339885e-02_rk, 7.506847018511643583e-18_rk, -2.634488420681667967e-18_rk,-8.430241839087264634e-18_rk, &
                                        7.506847018511643583e-18_rk, -1.952135486850339191e-02_rk, -8.430241839087263094e-18_rk,-2.634488420681667967e-18_rk, &
                                        -3.057790327847504834e-18_rk, -8.889994308641104554e-18_rk, -7.285468820183672867e-02_rk,1.394295789234275150e-18_rk, &
                                        -8.889994308641104554e-18_rk, -3.057790327847505604e-18_rk, 1.394295789234274765e-18_rk,-7.285468820183672867e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -3.642734410091836850e-01_rk, 4.402312936063857968e-17_rk, 5.868378021147017650e-18_rk,-4.274123904633003795e-17_rk, &
                                        1.653865900874994313e-17_rk, -9.760677434251696649e-02_rk, -5.646447940380390408e-17_rk,4.491767154621435943e-17_rk, &
                                        6.221129610451886841e-18_rk, -4.309399063563489019e-17_rk, -3.642734410091836850e-01_rk,4.437588094994343808e-17_rk, &
                                        -5.611172781449903334e-17_rk, 4.456491995690950102e-17_rk, 1.618590741944507548e-17_rk,-9.760677434251696649e-02_rk, &
                                        3.642734410091836295e-01_rk, -3.317307948087019807e-17_rk, 4.219605535254607582e-17_rk,5.467735403841483526e-17_rk, &
                                        -1.097988296855453006e-17_rk, 9.760677434251696649e-02_rk, 3.227657828953187834e-17_rk,-1.338191002059534262e-17_rk, &
                                        4.184330376324121741e-17_rk, 5.503010562771969366e-17_rk, 3.642734410091835739e-01_rk,-3.352583107017506264e-17_rk, &
                                        3.192382670022702609e-17_rk, -1.302915843129048268e-17_rk, -1.062713137924967165e-17_rk,9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -3.642734410091836850e-01_rk, 4.621979863888065984e-17_rk, -1.265793693752721132e-17_rk,-3.424961202138001048e-17_rk, &
                                        2.006911341044238339e-17_rk, -9.760677434251696649e-02_rk, -3.040465812432963262e-17_rk,2.805791897894364223e-17_rk, &
                                        -1.051218296554569186e-17_rk, -4.373787430143296179e-17_rk, -1.359486989694217662e+00_rk,1.702810020700982762e-17_rk, &
                                        -3.723070226075740753e-17_rk, 4.133192923786708466e-17_rk, -7.770067536513650007e-18_rk,-3.642734410091836850e-01_rk, &
                                        9.760677434251696649e-02_rk, -4.809073930120162940e-17_rk, 3.332171525626360134e-17_rk,4.929469133586583488e-17_rk, &
                                        -1.866150015073593817e-17_rk, 2.615365636088426426e-02_rk, 7.547997310373199024e-17_rk,8.921285909440451683e-19_rk, &
                                        2.706278814073402758e-17_rk, 5.793227808457149063e-17_rk, 3.642734410091835184e-01_rk,-2.635069089896145273e-17_rk, &
                                        3.808725480939230456e-17_rk, -2.984896235585776021e-17_rk, 1.507993831091973832e-17_rk,9.760677434251693874e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.952135486850339885e-02_rk, 7.845081372542751818e-18_rk, 4.446184738450109926e-18_rk,-9.969685619715032226e-18_rk, &
                                        7.845081372542750277e-18_rk, -1.952135486850339885e-02_rk, -9.969685619715032226e-18_rk,4.446184738450110697e-18_rk, &
                                        5.781575492883140098e-18_rk, -9.800907752450780184e-18_rk, -7.285468820183674254e-02_rk,4.337826619195923192e-18_rk, &
                                        -9.800907752450778643e-18_rk, 5.781575492883140868e-18_rk, 4.337826619195923192e-18_rk,-7.285468820183674254e-02_rk, &
                                        1.952135486850339885e-02_rk, -7.506847018511643583e-18_rk, 2.634488420681667967e-18_rk,8.430241839087264634e-18_rk, &
                                        -7.506847018511643583e-18_rk, 1.952135486850339191e-02_rk, 8.430241839087263094e-18_rk,2.634488420681667967e-18_rk, &
                                        3.057790327847504834e-18_rk, 8.889994308641104554e-18_rk, 7.285468820183672867e-02_rk,-1.394295789234275150e-18_rk, &
                                        8.889994308641104554e-18_rk, 3.057790327847505604e-18_rk, -1.394295789234274765e-18_rk,7.285468820183672867e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -9.760677434251696649e-02_rk, 1.653865900874994621e-17_rk, 4.491767154621436559e-17_rk,-5.646447940380390408e-17_rk, &
                                        4.402312936063856735e-17_rk, -3.642734410091836850e-01_rk, -4.274123904633004411e-17_rk,5.868378021147021502e-18_rk, &
                                        4.456491995690950102e-17_rk, -5.611172781449903334e-17_rk, -9.760677434251696649e-02_rk,1.618590741944508164e-17_rk, &
                                        -4.309399063563489019e-17_rk, 6.221129610451879137e-18_rk, 4.437588094994343808e-17_rk,-3.642734410091836850e-01_rk, &
                                        9.760677434251702200e-02_rk, -1.097988296855453622e-17_rk, -1.338191002059535033e-17_rk,3.227657828953188450e-17_rk, &
                                        -3.317307948087019807e-17_rk, 3.642734410091835739e-01_rk, 5.467735403841484142e-17_rk,4.219605535254608198e-17_rk, &
                                        -1.302915843129048422e-17_rk, 3.192382670022701377e-17_rk, 9.760677434251696649e-02_rk,-1.062713137924966549e-17_rk, &
                                        5.503010562771969366e-17_rk, 4.184330376324120509e-17_rk, -3.352583107017506881e-17_rk,3.642734410091835739e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -9.760677434251696649e-02_rk, 2.006911341044238647e-17_rk, 2.805791897894364840e-17_rk,-3.040465812432963262e-17_rk, &
                                        4.621979863888064751e-17_rk, -3.642734410091836850e-01_rk, -3.424961202138001048e-17_rk,-1.265793693752720823e-17_rk, &
                                        4.133192923786708466e-17_rk, -3.723070226075740753e-17_rk, -3.642734410091836850e-01_rk,-7.770067536513640763e-18_rk, &
                                        -4.373787430143296179e-17_rk, -1.051218296554569648e-17_rk, 1.702810020700982146e-17_rk,-1.359486989694217662e+00_rk, &
                                        2.615365636088429896e-02_rk, -1.866150015073594433e-17_rk, 8.921285909440336128e-19_rk,7.547997310373199024e-17_rk, &
                                        -4.809073930120162940e-17_rk, 9.760677434251693874e-02_rk, 4.929469133586584104e-17_rk,3.332171525626360750e-17_rk, &
                                        -2.984896235585776638e-17_rk, 3.808725480939229223e-17_rk, 9.760677434251693874e-02_rk,1.507993831091974140e-17_rk, &
                                        5.793227808457150296e-17_rk, 2.706278814073402141e-17_rk, -2.635069089896146198e-17_rk,3.642734410091835184e-01_rk  &
                                        /),(/4,8/))
        


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face6_dx
        ! 
        test_dbr2_vol_face6_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -7.285468820183672867e-02_rk, 1.323745471373302468e-18_rk, -3.128340645708477516e-18_rk,-8.960544626502076852e-18_rk, &
                                        1.323745471373302468e-18_rk, -7.285468820183672867e-02_rk, -8.960544626502078392e-18_rk,-3.128340645708477901e-18_rk, &
                                        -2.705038738542641420e-18_rk, -8.500792156948235391e-18_rk, -1.952135486850339885e-02_rk,7.436296700650672826e-18_rk, &
                                        -8.500792156948235391e-18_rk, -2.705038738542641420e-18_rk, 7.436296700650671285e-18_rk,-1.952135486850339885e-02_rk, &
                                        7.285468820183674254e-02_rk, -4.267276301334950895e-18_rk, -5.711025175022167800e-18_rk,9.871458070311755563e-18_rk, &
                                        -4.267276301334951665e-18_rk, 7.285468820183674254e-02_rk, 9.871458070311754022e-18_rk,-5.711025175022167800e-18_rk, &
                                        -4.375634420589136859e-18_rk, 1.004023593757600452e-17_rk, 1.952135486850339885e-02_rk,-7.774531054681777980e-18_rk, &
                                        1.004023593757600452e-17_rk, -4.375634420589136859e-18_rk, -7.774531054681779520e-18_rk,1.952135486850339885e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -3.642734410091836295e-01_rk, 3.317307948087019807e-17_rk, -4.219605535254608198e-17_rk,-5.467735403841483526e-17_rk, &
                                        1.097988296855453314e-17_rk, -9.760677434251696649e-02_rk, -3.227657828953188450e-17_rk,1.338191002059535187e-17_rk, &
                                        -4.184330376324120509e-17_rk, -5.503010562771970599e-17_rk, -3.642734410091835739e-01_rk,3.352583107017505648e-17_rk, &
                                        -3.192382670022702609e-17_rk, 1.302915843129048268e-17_rk, 1.062713137924966395e-17_rk,-9.760677434251696649e-02_rk, &
                                        3.642734410091836850e-01_rk, -4.402312936063856735e-17_rk, -5.868378021147024583e-18_rk,4.274123904633003179e-17_rk, &
                                        -1.653865900874994005e-17_rk, 9.760677434251696649e-02_rk, 5.646447940380389175e-17_rk,-4.491767154621435326e-17_rk, &
                                        -6.221129610451887611e-18_rk, 4.309399063563489019e-17_rk, 3.642734410091836850e-01_rk,-4.437588094994343808e-17_rk, &
                                        5.611172781449903334e-17_rk, -4.456491995690950102e-17_rk, -1.618590741944507856e-17_rk,9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -3.642734410091835739e-01_rk, 2.468145245592016444e-17_rk, -2.873202658377531895e-17_rk,-5.793227808457151529e-17_rk, &
                                        -1.507993831091973524e-17_rk, -9.760677434251693874e-02_rk, -3.975649325243359593e-17_rk,2.984896235585776638e-17_rk, &
                                        -3.332171525626360134e-17_rk, -5.096392977890712625e-17_rk, -9.760677434251691098e-02_rk,4.809073930120162323e-17_rk, &
                                        -7.547997310373200256e-17_rk, -2.561367033985326527e-18_rk, 1.699226170769464987e-17_rk,-2.615365636088425733e-02_rk, &
                                        1.359486989694217662e+00_rk, -1.535886176396853009e-17_rk, 1.218142140858697707e-17_rk,4.373787430143296179e-17_rk, &
                                        7.770067536513650007e-18_rk, 3.642734410091836850e-01_rk, 3.889994070379868657e-17_rk,-4.133192923786707850e-17_rk, &
                                        1.265793693752720669e-17_rk, 3.591885046442128336e-17_rk, 3.642734410091836850e-01_rk,-4.621979863888064751e-17_rk, &
                                        3.040465812432962646e-17_rk, -2.638868053590235702e-17_rk, -1.839987496740109510e-17_rk,9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,1) = reshape((/                                                                                 &
                                        7.285468820183672867e-02_rk, -1.323745471373302468e-18_rk, 3.128340645708477516e-18_rk,8.960544626502076852e-18_rk, &
                                        -1.323745471373302468e-18_rk, 7.285468820183672867e-02_rk, 8.960544626502078392e-18_rk,3.128340645708477901e-18_rk, &
                                        2.705038738542641420e-18_rk, 8.500792156948235391e-18_rk, 1.952135486850339885e-02_rk,-7.436296700650672826e-18_rk, &
                                        8.500792156948235391e-18_rk, 2.705038738542641420e-18_rk, -7.436296700650671285e-18_rk,1.952135486850339885e-02_rk, &
                                        -7.285468820183674254e-02_rk, 4.267276301334950895e-18_rk, 5.711025175022167800e-18_rk,-9.871458070311755563e-18_rk, &
                                        4.267276301334951665e-18_rk, -7.285468820183674254e-02_rk, -9.871458070311754022e-18_rk,5.711025175022167800e-18_rk, &
                                        4.375634420589136859e-18_rk, -1.004023593757600452e-17_rk, -1.952135486850339885e-02_rk,7.774531054681777980e-18_rk, &
                                        -1.004023593757600452e-17_rk, 4.375634420589136859e-18_rk, 7.774531054681779520e-18_rk,-1.952135486850339885e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -9.760677434251702200e-02_rk, 1.097988296855453314e-17_rk, 1.338191002059534879e-17_rk,-3.227657828953188450e-17_rk, &
                                        3.317307948087021040e-17_rk, -3.642734410091835739e-01_rk, -5.467735403841483526e-17_rk,-4.219605535254607582e-17_rk, &
                                        1.302915843129048114e-17_rk, -3.192382670022702609e-17_rk, -9.760677434251696649e-02_rk,1.062713137924966857e-17_rk, &
                                        -5.503010562771970599e-17_rk, -4.184330376324120509e-17_rk, 3.352583107017506881e-17_rk,-3.642734410091835739e-01_rk, &
                                        9.760677434251696649e-02_rk, -1.653865900874994313e-17_rk, -4.491767154621436559e-17_rk,5.646447940380389175e-17_rk, &
                                        -4.402312936063856735e-17_rk, 3.642734410091836850e-01_rk, 4.274123904633003179e-17_rk,-5.868378021147023813e-18_rk, &
                                        -4.456491995690949486e-17_rk, 5.611172781449903334e-17_rk, 9.760677434251696649e-02_rk,-1.618590741944507856e-17_rk, &
                                        4.309399063563489019e-17_rk, -6.221129610451886841e-18_rk, -4.437588094994343808e-17_rk,3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -9.760677434251698037e-02_rk, -1.507993831091973832e-17_rk, 2.984896235585776638e-17_rk,-3.975649325243359593e-17_rk, &
                                        2.468145245592017676e-17_rk, -3.642734410091835184e-01_rk, -5.793227808457150296e-17_rk,-2.873202658377531279e-17_rk, &
                                        -2.561367033985325756e-18_rk, -7.547997310373200256e-17_rk, -2.615365636088424345e-02_rk,1.699226170769465604e-17_rk, &
                                        -5.096392977890712625e-17_rk, -3.332171525626360134e-17_rk, 4.809073930120163556e-17_rk,-9.760677434251693874e-02_rk, &
                                        3.642734410091836850e-01_rk, 7.770067536513645385e-18_rk, -4.133192923786707850e-17_rk,3.889994070379868657e-17_rk, &
                                        -1.535886176396852701e-17_rk, 1.359486989694217662e+00_rk, 4.373787430143296179e-17_rk,1.218142140858697707e-17_rk, &
                                        -2.638868053590235086e-17_rk, 3.040465812432962646e-17_rk, 9.760677434251696649e-02_rk,-1.839987496740109202e-17_rk, &
                                        3.591885046442128336e-17_rk, 1.265793693752721132e-17_rk, -4.621979863888064751e-17_rk,3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -1.952135486850340232e-02_rk, 7.506847018511643583e-18_rk, -2.634488420681667967e-18_rk,-8.430241839087261553e-18_rk, &
                                        7.506847018511643583e-18_rk, -1.952135486850339885e-02_rk, -8.430241839087263094e-18_rk,-2.634488420681667582e-18_rk, &
                                        -3.057790327847504834e-18_rk, -8.889994308641103013e-18_rk, -7.285468820183672867e-02_rk,1.394295789234275343e-18_rk, &
                                        -8.889994308641106095e-18_rk, -3.057790327847505219e-18_rk, 1.394295789234275728e-18_rk,-7.285468820183672867e-02_rk, &
                                        1.952135486850339885e-02_rk, -7.845081372542751818e-18_rk, -4.446184738450110697e-18_rk,9.969685619715032226e-18_rk, &
                                        -7.845081372542750277e-18_rk, 1.952135486850339885e-02_rk, 9.969685619715032226e-18_rk,-4.446184738450110697e-18_rk, &
                                        -5.781575492883140098e-18_rk, 9.800907752450780184e-18_rk, 7.285468820183674254e-02_rk,-4.337826619195924733e-18_rk, &
                                        9.800907752450780184e-18_rk, -5.781575492883140098e-18_rk, -4.337826619195923962e-18_rk,7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,2) = reshape((/                                                                                 &
                                        3.642734410091836295e-01_rk, -3.317307948087019807e-17_rk, 4.219605535254608198e-17_rk,5.467735403841483526e-17_rk, &
                                        -1.097988296855453314e-17_rk, 9.760677434251696649e-02_rk, 3.227657828953188450e-17_rk,-1.338191002059535187e-17_rk, &
                                        4.184330376324120509e-17_rk, 5.503010562771970599e-17_rk, 3.642734410091835739e-01_rk,-3.352583107017505648e-17_rk, &
                                        3.192382670022702609e-17_rk, -1.302915843129048268e-17_rk, -1.062713137924966395e-17_rk,9.760677434251696649e-02_rk, &
                                        -3.642734410091836850e-01_rk, 4.402312936063856735e-17_rk, 5.868378021147024583e-18_rk,-4.274123904633003179e-17_rk, &
                                        1.653865900874994005e-17_rk, -9.760677434251696649e-02_rk, -5.646447940380389175e-17_rk,4.491767154621435326e-17_rk, &
                                        6.221129610451887611e-18_rk, -4.309399063563489019e-17_rk, -3.642734410091836850e-01_rk,4.437588094994343808e-17_rk, &
                                        -5.611172781449903334e-17_rk, 4.456491995690950102e-17_rk, 1.618590741944507856e-17_rk,-9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -9.760677434251698037e-02_rk, 4.809073930120162940e-17_rk, -3.332171525626360750e-17_rk,-4.929469133586583488e-17_rk, &
                                        1.866150015073594433e-17_rk, -2.615365636088425733e-02_rk, -7.547997310373199024e-17_rk,-8.921285909440366942e-19_rk, &
                                        -2.706278814073402141e-17_rk, -5.793227808457151529e-17_rk, -3.642734410091835739e-01_rk,2.635069089896144965e-17_rk, &
                                        -3.808725480939230456e-17_rk, 2.984896235585776021e-17_rk, -1.507993831091974448e-17_rk,-9.760677434251693874e-02_rk, &
                                        3.642734410091836850e-01_rk, -4.621979863888064751e-17_rk, 1.265793693752720823e-17_rk,3.424961202138000431e-17_rk, &
                                        -2.006911341044238339e-17_rk, 9.760677434251696649e-02_rk, 3.040465812432962646e-17_rk,-2.805791897894364223e-17_rk, &
                                        1.051218296554569032e-17_rk, 4.373787430143296179e-17_rk, 1.359486989694217662e+00_rk,-1.702810020700982146e-17_rk, &
                                        3.723070226075740753e-17_rk, -4.133192923786708466e-17_rk, 7.770067536513646926e-18_rk,3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,1) = reshape((/                                                                                 &
                                        1.952135486850340232e-02_rk, -7.506847018511643583e-18_rk, 2.634488420681667967e-18_rk,8.430241839087261553e-18_rk, &
                                        -7.506847018511643583e-18_rk, 1.952135486850339885e-02_rk, 8.430241839087263094e-18_rk,2.634488420681667582e-18_rk, &
                                        3.057790327847504834e-18_rk, 8.889994308641103013e-18_rk, 7.285468820183672867e-02_rk,-1.394295789234275343e-18_rk, &
                                        8.889994308641106095e-18_rk, 3.057790327847505219e-18_rk, -1.394295789234275728e-18_rk,7.285468820183672867e-02_rk, &
                                        -1.952135486850339885e-02_rk, 7.845081372542751818e-18_rk, 4.446184738450110697e-18_rk,-9.969685619715032226e-18_rk, &
                                        7.845081372542750277e-18_rk, -1.952135486850339885e-02_rk, -9.969685619715032226e-18_rk,4.446184738450110697e-18_rk, &
                                        5.781575492883140098e-18_rk, -9.800907752450780184e-18_rk, -7.285468820183674254e-02_rk,4.337826619195924733e-18_rk, &
                                        -9.800907752450780184e-18_rk, 5.781575492883140098e-18_rk, 4.337826619195923962e-18_rk,-7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,2) = reshape((/                                                                                 &
                                        9.760677434251702200e-02_rk, -1.097988296855453314e-17_rk, -1.338191002059534879e-17_rk,3.227657828953188450e-17_rk, &
                                        -3.317307948087021040e-17_rk, 3.642734410091835739e-01_rk, 5.467735403841483526e-17_rk,4.219605535254607582e-17_rk, &
                                        -1.302915843129048114e-17_rk, 3.192382670022702609e-17_rk, 9.760677434251696649e-02_rk,-1.062713137924966857e-17_rk, &
                                        5.503010562771970599e-17_rk, 4.184330376324120509e-17_rk, -3.352583107017506881e-17_rk,3.642734410091835739e-01_rk, &
                                        -9.760677434251696649e-02_rk, 1.653865900874994313e-17_rk, 4.491767154621436559e-17_rk,-5.646447940380389175e-17_rk, &
                                        4.402312936063856735e-17_rk, -3.642734410091836850e-01_rk, -4.274123904633003179e-17_rk,5.868378021147023813e-18_rk, &
                                        4.456491995690949486e-17_rk, -5.611172781449903334e-17_rk, -9.760677434251696649e-02_rk,1.618590741944507856e-17_rk, &
                                        -4.309399063563489019e-17_rk, 6.221129610451886841e-18_rk, 4.437588094994343808e-17_rk,-3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -2.615365636088427814e-02_rk, 1.866150015073594125e-17_rk, -8.921285909440374646e-19_rk,-7.547997310373199024e-17_rk, &
                                        4.809073930120164172e-17_rk, -9.760677434251693874e-02_rk, -4.929469133586584104e-17_rk,-3.332171525626360750e-17_rk, &
                                        2.984896235585776021e-17_rk, -3.808725480939231688e-17_rk, -9.760677434251696649e-02_rk,-1.507993831091973832e-17_rk, &
                                        -5.793227808457151529e-17_rk, -2.706278814073402141e-17_rk, 2.635069089896146198e-17_rk,-3.642734410091835184e-01_rk, &
                                        9.760677434251696649e-02_rk, -2.006911341044238339e-17_rk, -2.805791897894364223e-17_rk,3.040465812432962646e-17_rk, &
                                        -4.621979863888064751e-17_rk, 3.642734410091836850e-01_rk, 3.424961202138000431e-17_rk,1.265793693752720823e-17_rk, &
                                        -4.133192923786707850e-17_rk, 3.723070226075740753e-17_rk, 3.642734410091836850e-01_rk,7.770067536513645385e-18_rk, &
                                        4.373787430143296179e-17_rk, 1.051218296554569186e-17_rk, -1.702810020700981838e-17_rk,1.359486989694217662e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.952135486850338497e-02_rk, 5.965573576267833728e-19_rk, 3.351727800124969159e-18_rk,-1.057720964089893800e-17_rk, &
                                        5.965573576267833728e-19_rk, -1.952135486850338844e-02_rk, -1.057720964089893954e-17_rk,3.351727800124969159e-18_rk, &
                                        -4.471577719507145462e-18_rk, -1.678798841957958482e-17_rk, -5.230731272176847649e-03_rk,5.580303501128586572e-18_rk, &
                                        -1.678798841957958791e-17_rk, -4.471577719507145462e-18_rk, 5.580303501128585802e-18_rk,-5.230731272176847649e-03_rk, &
                                        2.718973979388435436e-01_rk, 2.749517455843972875e-18_rk, -1.190763908338535728e-19_rk,6.656104930734579195e-18_rk, &
                                        2.749517455843974416e-18_rk, 2.718973979388435436e-01_rk, 6.656104930734579965e-18_rk,-1.190763908338532358e-19_rk, &
                                        1.629485700914106908e-18_rk, 3.224465780174177902e-18_rk, 7.285468820183674254e-02_rk,-5.149403666574568693e-18_rk, &
                                        3.224465780174177902e-18_rk, 1.629485700914107486e-18_rk, -5.149403666574569464e-18_rk,7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -9.760677434251691098e-02_rk, 3.959911227625159576e-17_rk, -1.985768648749284447e-17_rk,-5.254961538202251490e-17_rk, &
                                        -7.398321128738324047e-18_rk, -2.615365636088422263e-02_rk, -8.295988806663370167e-17_rk,1.557492374431837781e-17_rk, &
                                        -1.854119963375641766e-17_rk, -5.386610223575894787e-17_rk, -9.760677434251691098e-02_rk,4.091559912998801640e-17_rk, &
                                        -8.164340121289728103e-17_rk, 1.425843689058195101e-17_rk, -8.714807982474758556e-18_rk,-2.615365636088423651e-02_rk, &
                                        1.359486989694217662e+00_rk, -1.755553104221060717e-17_rk, 3.070773636726120758e-17_rk,3.524624727648293432e-17_rk, &
                                        4.239613134821206666e-18_rk, 3.642734410091836850e-01_rk, 1.284011942432441974e-17_rk,-2.447217667059636747e-17_rk, &
                                        2.939124951352478077e-17_rk, 3.656273413021935496e-17_rk, 1.359486989694217662e+00_rk,-1.887201789594703397e-17_rk, &
                                        1.152363257058800218e-17_rk, -2.315568981685994066e-17_rk, 5.556099988557630389e-18_rk,3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,3) = reshape((/                                                                                 &
                                        3.642734410091835739e-01_rk, -2.468145245592016444e-17_rk, 2.873202658377531895e-17_rk,5.793227808457151529e-17_rk, &
                                        1.507993831091973524e-17_rk, 9.760677434251693874e-02_rk, 3.975649325243359593e-17_rk,-2.984896235585776638e-17_rk, &
                                        3.332171525626360134e-17_rk, 5.096392977890712625e-17_rk, 9.760677434251691098e-02_rk,-4.809073930120162323e-17_rk, &
                                        7.547997310373200256e-17_rk, 2.561367033985326527e-18_rk, -1.699226170769464987e-17_rk,2.615365636088425733e-02_rk, &
                                        -1.359486989694217662e+00_rk, 1.535886176396853009e-17_rk, -1.218142140858697707e-17_rk,-4.373787430143296179e-17_rk, &
                                        -7.770067536513650007e-18_rk, -3.642734410091836850e-01_rk, -3.889994070379868657e-17_rk,4.133192923786707850e-17_rk, &
                                        -1.265793693752720669e-17_rk, -3.591885046442128336e-17_rk, -3.642734410091836850e-01_rk,4.621979863888064751e-17_rk, &
                                        -3.040465812432962646e-17_rk, 2.638868053590235702e-17_rk, 1.839987496740109510e-17_rk,-9.760677434251696649e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,1) = reshape((/                                                                                 &
                                        1.952135486850338497e-02_rk, -5.965573576267833728e-19_rk, -3.351727800124969159e-18_rk,1.057720964089893800e-17_rk, &
                                        -5.965573576267833728e-19_rk, 1.952135486850338844e-02_rk, 1.057720964089893954e-17_rk,-3.351727800124969159e-18_rk, &
                                        4.471577719507145462e-18_rk, 1.678798841957958482e-17_rk, 5.230731272176847649e-03_rk,-5.580303501128586572e-18_rk, &
                                        1.678798841957958791e-17_rk, 4.471577719507145462e-18_rk, -5.580303501128585802e-18_rk,5.230731272176847649e-03_rk, &
                                        -2.718973979388435436e-01_rk, -2.749517455843972875e-18_rk, 1.190763908338535728e-19_rk,-6.656104930734579195e-18_rk, &
                                        -2.749517455843974416e-18_rk, -2.718973979388435436e-01_rk, -6.656104930734579965e-18_rk,1.190763908338532358e-19_rk, &
                                        -1.629485700914106908e-18_rk, -3.224465780174177902e-18_rk, -7.285468820183674254e-02_rk,5.149403666574568693e-18_rk, &
                                        -3.224465780174177902e-18_rk, -1.629485700914107486e-18_rk, 5.149403666574569464e-18_rk,-7.285468820183674254e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -2.615365636088425039e-02_rk, -7.398321128738330210e-18_rk, 1.557492374431837781e-17_rk,-8.295988806663370167e-17_rk, &
                                        3.959911227625160809e-17_rk, -9.760677434251691098e-02_rk, -5.254961538202251490e-17_rk,-1.985768648749283830e-17_rk, &
                                        1.425843689058195717e-17_rk, -8.164340121289728103e-17_rk, -2.615365636088423651e-02_rk,-8.714807982474750852e-18_rk, &
                                        -5.386610223575894787e-17_rk, -1.854119963375641766e-17_rk, 4.091559912998802873e-17_rk,-9.760677434251691098e-02_rk, &
                                        3.642734410091836850e-01_rk, 4.239613134821205125e-18_rk, -2.447217667059636130e-17_rk,1.284011942432441974e-17_rk, &
                                        -1.755553104221060717e-17_rk, 1.359486989694217662e+00_rk, 3.524624727648293432e-17_rk,3.070773636726120758e-17_rk, &
                                        -2.315568981685993450e-17_rk, 1.152363257058800064e-17_rk, 3.642734410091836850e-01_rk,5.556099988557630389e-18_rk, &
                                        3.656273413021935496e-17_rk, 2.939124951352479310e-17_rk, -1.887201789594703397e-17_rk,1.359486989694217662e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,3) = reshape((/                                                                                 &
                                        9.760677434251698037e-02_rk, 1.507993831091973832e-17_rk, -2.984896235585776638e-17_rk,3.975649325243359593e-17_rk, &
                                        -2.468145245592017676e-17_rk, 3.642734410091835184e-01_rk, 5.793227808457150296e-17_rk,2.873202658377531279e-17_rk, &
                                        2.561367033985325756e-18_rk, 7.547997310373200256e-17_rk, 2.615365636088424345e-02_rk,-1.699226170769465604e-17_rk, &
                                        5.096392977890712625e-17_rk, 3.332171525626360134e-17_rk, -4.809073930120163556e-17_rk,9.760677434251693874e-02_rk, &
                                        -3.642734410091836850e-01_rk, -7.770067536513645385e-18_rk, 4.133192923786707850e-17_rk,-3.889994070379868657e-17_rk, &
                                        1.535886176396852701e-17_rk, -1.359486989694217662e+00_rk, -4.373787430143296179e-17_rk,-1.218142140858697707e-17_rk, &
                                        2.638868053590235086e-17_rk, -3.040465812432962646e-17_rk, -9.760677434251696649e-02_rk,1.839987496740109202e-17_rk, &
                                        -3.591885046442128336e-17_rk, -1.265793693752721132e-17_rk, 4.621979863888064751e-17_rk,-3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -5.230731272176842445e-03_rk, 5.843600871875871625e-18_rk, -4.208280348759860410e-18_rk,-1.652469104883230131e-17_rk, &
                                        5.843600871875871625e-18_rk, -5.230731272176845914e-03_rk, -1.652469104883230439e-17_rk,-4.208280348759861950e-18_rk, &
                                        3.615025170872253826e-18_rk, -1.031391227015165294e-17_rk, -1.952135486850338497e-02_rk,8.598547283740678478e-19_rk, &
                                        -1.031391227015165294e-17_rk, 3.615025170872253056e-18_rk, 8.598547283740682330e-19_rk,-1.952135486850338497e-02_rk, &
                                        7.285468820183674254e-02_rk, -5.412701037321851435e-18_rk, 1.366188330166821855e-18_rk,2.961168409426893620e-18_rk, &
                                        -5.412701037321852976e-18_rk, 7.285468820183674254e-02_rk, 2.961168409426893620e-18_rk,1.366188330166822433e-18_rk, &
                                        -3.823737615811373256e-19_rk, 6.392807559987294142e-18_rk, 2.718973979388435436e-01_rk,2.486220085096688208e-18_rk, &
                                        6.392807559987294142e-18_rk, -3.823737615811369404e-19_rk, 2.486220085096687823e-18_rk,2.718973979388435436e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,2) = reshape((/                                                                                 &
                                        9.760677434251691098e-02_rk, -3.959911227625159576e-17_rk, 1.985768648749284447e-17_rk,5.254961538202251490e-17_rk, &
                                        7.398321128738324047e-18_rk, 2.615365636088422263e-02_rk, 8.295988806663370167e-17_rk,-1.557492374431837781e-17_rk, &
                                        1.854119963375641766e-17_rk, 5.386610223575894787e-17_rk, 9.760677434251691098e-02_rk,-4.091559912998801640e-17_rk, &
                                        8.164340121289728103e-17_rk, -1.425843689058195101e-17_rk, 8.714807982474758556e-18_rk,2.615365636088423651e-02_rk, &
                                        -1.359486989694217662e+00_rk, 1.755553104221060717e-17_rk, -3.070773636726120758e-17_rk,-3.524624727648293432e-17_rk, &
                                        -4.239613134821206666e-18_rk, -3.642734410091836850e-01_rk, -1.284011942432441974e-17_rk,2.447217667059636747e-17_rk, &
                                        -2.939124951352478077e-17_rk, -3.656273413021935496e-17_rk, -1.359486989694217662e+00_rk,1.887201789594703397e-17_rk, &
                                        -1.152363257058800218e-17_rk, 2.315568981685994066e-17_rk, -5.556099988557630389e-18_rk,-3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,3) = reshape((/                                                                                 &
                                        9.760677434251698037e-02_rk, -4.809073930120162940e-17_rk, 3.332171525626360750e-17_rk,4.929469133586583488e-17_rk, &
                                        -1.866150015073594433e-17_rk, 2.615365636088425733e-02_rk, 7.547997310373199024e-17_rk,8.921285909440366942e-19_rk, &
                                        2.706278814073402141e-17_rk, 5.793227808457151529e-17_rk, 3.642734410091835739e-01_rk,-2.635069089896144965e-17_rk, &
                                        3.808725480939230456e-17_rk, -2.984896235585776021e-17_rk, 1.507993831091974448e-17_rk,9.760677434251693874e-02_rk, &
                                        -3.642734410091836850e-01_rk, 4.621979863888064751e-17_rk, -1.265793693752720823e-17_rk,-3.424961202138000431e-17_rk, &
                                        2.006911341044238339e-17_rk, -9.760677434251696649e-02_rk, -3.040465812432962646e-17_rk,2.805791897894364223e-17_rk, &
                                        -1.051218296554569032e-17_rk, -4.373787430143296179e-17_rk, -1.359486989694217662e+00_rk,1.702810020700982146e-17_rk, &
                                        -3.723070226075740753e-17_rk, 4.133192923786708466e-17_rk, -7.770067536513646926e-18_rk,-3.642734410091836850e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,1) = reshape((/                                                                                 &
                                        5.230731272176842445e-03_rk, -5.843600871875871625e-18_rk, 4.208280348759860410e-18_rk,1.652469104883230131e-17_rk, &
                                        -5.843600871875871625e-18_rk, 5.230731272176845914e-03_rk, 1.652469104883230439e-17_rk,4.208280348759861950e-18_rk, &
                                        -3.615025170872253826e-18_rk, 1.031391227015165294e-17_rk, 1.952135486850338497e-02_rk,-8.598547283740678478e-19_rk, &
                                        1.031391227015165294e-17_rk, -3.615025170872253056e-18_rk, -8.598547283740682330e-19_rk,1.952135486850338497e-02_rk, &
                                        -7.285468820183674254e-02_rk, 5.412701037321851435e-18_rk, -1.366188330166821855e-18_rk,-2.961168409426893620e-18_rk, &
                                        5.412701037321852976e-18_rk, -7.285468820183674254e-02_rk, -2.961168409426893620e-18_rk,-1.366188330166822433e-18_rk, &
                                        3.823737615811373256e-19_rk, -6.392807559987294142e-18_rk, -2.718973979388435436e-01_rk,-2.486220085096688208e-18_rk, &
                                        -6.392807559987294142e-18_rk, 3.823737615811369404e-19_rk, -2.486220085096687823e-18_rk,-2.718973979388435436e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,2) = reshape((/                                                                                 &
                                        2.615365636088425039e-02_rk, 7.398321128738330210e-18_rk, -1.557492374431837781e-17_rk,8.295988806663370167e-17_rk, &
                                        -3.959911227625160809e-17_rk, 9.760677434251691098e-02_rk, 5.254961538202251490e-17_rk,1.985768648749283830e-17_rk, &
                                        -1.425843689058195717e-17_rk, 8.164340121289728103e-17_rk, 2.615365636088423651e-02_rk,8.714807982474750852e-18_rk, &
                                        5.386610223575894787e-17_rk, 1.854119963375641766e-17_rk, -4.091559912998802873e-17_rk,9.760677434251691098e-02_rk, &
                                        -3.642734410091836850e-01_rk, -4.239613134821205125e-18_rk, 2.447217667059636130e-17_rk,-1.284011942432441974e-17_rk, &
                                        1.755553104221060717e-17_rk, -1.359486989694217662e+00_rk, -3.524624727648293432e-17_rk,-3.070773636726120758e-17_rk, &
                                        2.315568981685993450e-17_rk, -1.152363257058800064e-17_rk, -3.642734410091836850e-01_rk,-5.556099988557630389e-18_rk, &
                                        -3.656273413021935496e-17_rk, -2.939124951352479310e-17_rk, 1.887201789594703397e-17_rk,-1.359486989694217662e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,3) = reshape((/                                                                                 &
                                        2.615365636088427814e-02_rk, -1.866150015073594125e-17_rk, 8.921285909440374646e-19_rk,7.547997310373199024e-17_rk, &
                                        -4.809073930120164172e-17_rk, 9.760677434251693874e-02_rk, 4.929469133586584104e-17_rk,3.332171525626360750e-17_rk, &
                                        -2.984896235585776021e-17_rk, 3.808725480939231688e-17_rk, 9.760677434251696649e-02_rk,1.507993831091973832e-17_rk, &
                                        5.793227808457151529e-17_rk, 2.706278814073402141e-17_rk, -2.635069089896146198e-17_rk,3.642734410091835184e-01_rk, &
                                        -9.760677434251696649e-02_rk, 2.006911341044238339e-17_rk, 2.805791897894364223e-17_rk,-3.040465812432962646e-17_rk, &
                                        4.621979863888064751e-17_rk, -3.642734410091836850e-01_rk, -3.424961202138000431e-17_rk,-1.265793693752720823e-17_rk, &
                                        4.133192923786707850e-17_rk, -3.723070226075740753e-17_rk, -3.642734410091836850e-01_rk,-7.770067536513645385e-18_rk, &
                                        -4.373787430143296179e-17_rk, -1.051218296554569186e-17_rk, 1.702810020700981838e-17_rk,-1.359486989694217662e+00_rk  &
                                        /),(/4,8/))
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do


    end subroutine testElement_dbr2_vol_dx
    !*******************************************************************************************





    !> Test cartesian dbr2_face_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_face_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       

        !
        ! dbr2_face_face1_dx
        ! 
        test_dbr2_face_face1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        3.980854194740136576e-01_rk, 8.867219781614265683e-18_rk, 1.417803682429011577e-17_rk,1.178017820962818671e-17_rk, &
                                        1.396425995443868205e-17_rk, 1.066666666666666874e-01_rk, 3.616738491473337161e-18_rk,7.939095776251757644e-18_rk, &
                                        1.242342762584638331e-17_rk, 4.452071326764054839e-18_rk, 1.066666666666666874e-01_rk,5.666502894431274001e-18_rk, &
                                        -5.101742011705674980e-18_rk, 2.755230325212594903e-18_rk, -2.519953866905091937e-21_rk,2.858124719265311281e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.892820323027550877e+00_rk, 7.205014965094136791e-17_rk, 7.357527964901867860e-17_rk,3.225066290693816075e-17_rk, &
                                        7.025179516498916615e-17_rk, 1.892820323027550877e+00_rk, 3.273253053915394186e-17_rk,7.309341201680288515e-17_rk, &
                                        3.809843187111105542e-17_rk, 6.677431802748654974e-18_rk, 5.071796769724490339e-01_rk,9.705507228398139209e-18_rk, &
                                        8.475786288700858274e-18_rk, 3.630007738515886599e-17_rk, 9.223639596182359631e-18_rk,5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.892820323027550877e+00_rk, 4.865548502373607667e-17_rk, 8.117210203138687899e-17_rk,3.425446265235778454e-17_rk, &
                                        3.261830422338765549e-17_rk, 5.071796769724491449e-01_rk, 5.155499689544815376e-18_rk,2.870325500279063478e-17_rk, &
                                        8.117210203138687899e-17_rk, 3.425446265235779071e-17_rk, 1.892820323027550877e+00_rk,4.865548502373607667e-17_rk, &
                                        5.155499689544813835e-18_rk, 2.870325500279064711e-17_rk, 3.261830422338766165e-17_rk,5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -3.980854194740136576e-01_rk, -8.867219781614265683e-18_rk, -1.417803682429011577e-17_rk,-1.178017820962818671e-17_rk, &
                                        -1.396425995443868205e-17_rk, -1.066666666666666874e-01_rk, -3.616738491473337161e-18_rk,-7.939095776251757644e-18_rk, &
                                        -1.242342762584638331e-17_rk, -4.452071326764054839e-18_rk, -1.066666666666666874e-01_rk,-5.666502894431274001e-18_rk, &
                                        5.101742011705674980e-18_rk, -2.755230325212594903e-18_rk, 2.519953866905091937e-21_rk,-2.858124719265311281e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        6.309401076758504034e-01_rk, 4.258911666153913031e-17_rk, 3.749225098590647883e-17_rk,4.460480455565853746e-17_rk, &
                                        4.210724902932335535e-17_rk, 6.309401076758504034e-01_rk, 4.473392059856946017e-17_rk,3.736313494299556228e-17_rk, &
                                        3.959321237013603588e-17_rk, -1.040765285967252447e-17_rk, 1.690598923241498075e-01_rk,1.874352351733463190e-17_rk, &
                                        -9.925785227456738727e-18_rk, 3.911134473792025476e-17_rk, 1.861440747442372152e-17_rk,1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        6.309401076758504034e-01_rk, 2.401312835649163176e-17_rk, 5.183522021929560255e-17_rk,4.690678502960342939e-17_rk, &
                                        3.719039577947122006e-17_rk, 1.690598923241497797e-01_rk, -1.258051729070649677e-17_rk,2.476837550453112488e-17_rk, &
                                        5.183522021929560255e-17_rk, 4.690678502960342323e-17_rk, 6.309401076758502924e-01_rk,2.401312835649163176e-17_rk, &
                                        -1.258051729070648906e-17_rk, 2.476837550453112488e-17_rk, 3.719039577947122622e-17_rk,1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        1.066666666666666874e-01_rk, 1.406063348088183458e-17_rk, 8.035469302694916333e-18_rk,3.590915282891153080e-18_rk, &
                                        8.507548884423823482e-18_rk, 3.980854194740136576e-01_rk, 1.187655173607134386e-17_rk,1.415221361570793246e-17_rk, &
                                        3.114901222403035564e-18_rk, -5.198115538148830587e-18_rk, 2.858124719265311281e-02_rk,2.330325471527898830e-20_rk, &
                                        4.811742223954495500e-18_rk, 1.232705409940322616e-17_rk, 5.570129367988117624e-18_rk,1.066666666666666874e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.892820323027550877e+00_rk, -7.205014965094136791e-17_rk, -7.357527964901867860e-17_rk,-3.225066290693816075e-17_rk, &
                                        -7.025179516498916615e-17_rk, -1.892820323027550877e+00_rk, -3.273253053915394186e-17_rk,-7.309341201680288515e-17_rk, &
                                        -3.809843187111105542e-17_rk, -6.677431802748654974e-18_rk, -5.071796769724490339e-01_rk,-9.705507228398139209e-18_rk, &
                                        -8.475786288700858274e-18_rk, -3.630007738515886599e-17_rk, -9.223639596182359631e-18_rk,-5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        5.071796769724491449e-01_rk, 3.310017185560343661e-17_rk, 3.050160948874284886e-17_rk,4.673632057329031177e-18_rk, &
                                        4.685713053778386259e-17_rk, 1.892820323027550877e+00_rk, 3.605281713830998630e-17_rk,8.069023439917109787e-17_rk, &
                                        3.050160948874284886e-17_rk, 4.673632057329034258e-18_rk, 5.071796769724490339e-01_rk,3.310017185560343661e-17_rk, &
                                        3.605281713830998630e-17_rk, 8.069023439917112252e-17_rk, 4.685713053778386875e-17_rk,1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.066666666666666874e-01_rk, -1.406063348088183458e-17_rk, -8.035469302694916333e-18_rk,-3.590915282891153080e-18_rk, &
                                        -8.507548884423823482e-18_rk, -3.980854194740136576e-01_rk, -1.187655173607134386e-17_rk,-1.415221361570793246e-17_rk, &
                                        -3.114901222403035564e-18_rk, 5.198115538148830587e-18_rk, -2.858124719265311281e-02_rk,-2.330325471527898830e-20_rk, &
                                        -4.811742223954495500e-18_rk, -1.232705409940322616e-17_rk, -5.570129367988117624e-18_rk,-1.066666666666666874e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -6.309401076758504034e-01_rk, -4.258911666153913031e-17_rk, -3.749225098590647883e-17_rk,-4.460480455565853746e-17_rk, &
                                        -4.210724902932335535e-17_rk, -6.309401076758504034e-01_rk, -4.473392059856946017e-17_rk,-3.736313494299556228e-17_rk, &
                                        -3.959321237013603588e-17_rk, 1.040765285967252447e-17_rk, -1.690598923241498075e-01_rk,-1.874352351733463190e-17_rk, &
                                        9.925785227456738727e-18_rk, -3.911134473792025476e-17_rk, -1.861440747442372152e-17_rk,-1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        1.690598923241497797e-01_rk, 3.731951182238213045e-17_rk, 2.525024313674689983e-17_rk,-1.270963333361741640e-17_rk, &
                                        2.353126072427585065e-17_rk, 6.309401076758504034e-01_rk, 4.738865266181920434e-17_rk,5.170610417638469833e-17_rk, &
                                        2.525024313674690291e-17_rk, -1.270963333361740715e-17_rk, 1.690598923241498075e-01_rk,3.731951182238213045e-17_rk, &
                                        4.738865266181921051e-17_rk, 5.170610417638469833e-17_rk, 2.353126072427585681e-17_rk,6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.066666666666666874e-01_rk, 5.666502894431274772e-18_rk, 1.242342762584638485e-17_rk,4.452071326764054069e-18_rk, &
                                        -2.519953866902010449e-21_rk, 2.858124719265311281e-02_rk, -5.101742011705674980e-18_rk,2.755230325212594133e-18_rk, &
                                        1.417803682429011577e-17_rk, 1.178017820962818671e-17_rk, 3.980854194740136576e-01_rk,8.867219781614265683e-18_rk, &
                                        3.616738491473337161e-18_rk, 7.939095776251757644e-18_rk, 1.396425995443867897e-17_rk,1.066666666666666874e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.071796769724491449e-01_rk, 9.705507228398137668e-18_rk, 3.809843187111106158e-17_rk,6.677431802748651892e-18_rk, &
                                        9.223639596182353468e-18_rk, 5.071796769724491449e-01_rk, 8.475786288700855193e-18_rk,3.630007738515885366e-17_rk, &
                                        7.357527964901867860e-17_rk, 3.225066290693816691e-17_rk, 1.892820323027550877e+00_rk,7.205014965094138023e-17_rk, &
                                        3.273253053915394186e-17_rk, 7.309341201680289748e-17_rk, 7.025179516498917847e-17_rk,1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.892820323027550877e+00_rk, -4.865548502373607667e-17_rk, -8.117210203138687899e-17_rk,-3.425446265235778454e-17_rk, &
                                        -3.261830422338765549e-17_rk, -5.071796769724491449e-01_rk, -5.155499689544815376e-18_rk,-2.870325500279063478e-17_rk, &
                                        -8.117210203138687899e-17_rk, -3.425446265235779071e-17_rk, -1.892820323027550877e+00_rk,-4.865548502373607667e-17_rk, &
                                        -5.155499689544813835e-18_rk, -2.870325500279064711e-17_rk, -3.261830422338766165e-17_rk,-5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.066666666666666874e-01_rk, -5.666502894431274772e-18_rk, -1.242342762584638485e-17_rk,-4.452071326764054069e-18_rk, &
                                        2.519953866902010449e-21_rk, -2.858124719265311281e-02_rk, 5.101742011705674980e-18_rk,-2.755230325212594133e-18_rk, &
                                        -1.417803682429011577e-17_rk, -1.178017820962818671e-17_rk, -3.980854194740136576e-01_rk,-8.867219781614265683e-18_rk, &
                                        -3.616738491473337161e-18_rk, -7.939095776251757644e-18_rk, -1.396425995443867897e-17_rk,-1.066666666666666874e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        1.690598923241497797e-01_rk, 1.874352351733462574e-17_rk, 3.959321237013602972e-17_rk,-1.040765285967252755e-17_rk, &
                                        1.861440747442371535e-17_rk, 1.690598923241497797e-01_rk, -9.925785227456747972e-18_rk,3.911134473792025476e-17_rk, &
                                        3.749225098590647267e-17_rk, 4.460480455565854362e-17_rk, 6.309401076758502924e-01_rk,4.258911666153913031e-17_rk, &
                                        4.473392059856946017e-17_rk, 3.736313494299556228e-17_rk, 4.210724902932336151e-17_rk,6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -6.309401076758504034e-01_rk, -2.401312835649163176e-17_rk, -5.183522021929560255e-17_rk,-4.690678502960342939e-17_rk, &
                                        -3.719039577947122006e-17_rk, -1.690598923241497797e-01_rk, 1.258051729070649677e-17_rk,-2.476837550453112488e-17_rk, &
                                        -5.183522021929560255e-17_rk, -4.690678502960342323e-17_rk, -6.309401076758502924e-01_rk,-2.401312835649163176e-17_rk, &
                                        1.258051729070648906e-17_rk, -2.476837550453112488e-17_rk, -3.719039577947122622e-17_rk,-1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.858124719265311281e-02_rk, 2.330325471528014386e-20_rk, 3.114901222403035178e-18_rk,-5.198115538148831357e-18_rk, &
                                        5.570129367988117624e-18_rk, 1.066666666666666874e-01_rk, 4.811742223954495500e-18_rk,1.232705409940322925e-17_rk, &
                                        8.035469302694914792e-18_rk, 3.590915282891152310e-18_rk, 1.066666666666666874e-01_rk,1.406063348088183766e-17_rk, &
                                        1.187655173607134386e-17_rk, 1.415221361570793246e-17_rk, 8.507548884423823482e-18_rk,3.980854194740136576e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.071796769724491449e-01_rk, -9.705507228398137668e-18_rk, -3.809843187111106158e-17_rk,-6.677431802748651892e-18_rk, &
                                        -9.223639596182353468e-18_rk, -5.071796769724491449e-01_rk, -8.475786288700855193e-18_rk,-3.630007738515885366e-17_rk, &
                                        -7.357527964901867860e-17_rk, -3.225066290693816691e-17_rk, -1.892820323027550877e+00_rk,-7.205014965094138023e-17_rk, &
                                        -3.273253053915394186e-17_rk, -7.309341201680289748e-17_rk, -7.025179516498917847e-17_rk,-1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -5.071796769724491449e-01_rk, -3.310017185560343661e-17_rk, -3.050160948874284886e-17_rk,-4.673632057329031177e-18_rk, &
                                        -4.685713053778386259e-17_rk, -1.892820323027550877e+00_rk, -3.605281713830998630e-17_rk,-8.069023439917109787e-17_rk, &
                                        -3.050160948874284886e-17_rk, -4.673632057329034258e-18_rk, -5.071796769724490339e-01_rk,-3.310017185560343661e-17_rk, &
                                        -3.605281713830998630e-17_rk, -8.069023439917112252e-17_rk, -4.685713053778386875e-17_rk,-1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -2.858124719265311281e-02_rk, -2.330325471528014386e-20_rk, -3.114901222403035178e-18_rk,5.198115538148831357e-18_rk, &
                                        -5.570129367988117624e-18_rk, -1.066666666666666874e-01_rk, -4.811742223954495500e-18_rk,-1.232705409940322925e-17_rk, &
                                        -8.035469302694914792e-18_rk, -3.590915282891152310e-18_rk, -1.066666666666666874e-01_rk,-1.406063348088183766e-17_rk, &
                                        -1.187655173607134386e-17_rk, -1.415221361570793246e-17_rk, -8.507548884423823482e-18_rk,-3.980854194740136576e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.690598923241497797e-01_rk, -1.874352351733462574e-17_rk, -3.959321237013602972e-17_rk,1.040765285967252755e-17_rk, &
                                        -1.861440747442371535e-17_rk, -1.690598923241497797e-01_rk, 9.925785227456747972e-18_rk,-3.911134473792025476e-17_rk, &
                                        -3.749225098590647267e-17_rk, -4.460480455565854362e-17_rk, -6.309401076758502924e-01_rk,-4.258911666153913031e-17_rk, &
                                        -4.473392059856946017e-17_rk, -3.736313494299556228e-17_rk, -4.210724902932336151e-17_rk,-6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -1.690598923241497797e-01_rk, -3.731951182238213045e-17_rk, -2.525024313674689983e-17_rk,1.270963333361741640e-17_rk, &
                                        -2.353126072427585065e-17_rk, -6.309401076758504034e-01_rk, -4.738865266181920434e-17_rk,-5.170610417638469833e-17_rk, &
                                        -2.525024313674690291e-17_rk, 1.270963333361740715e-17_rk, -1.690598923241498075e-01_rk,-3.731951182238213045e-17_rk, &
                                        -4.738865266181921051e-17_rk, -5.170610417638469833e-17_rk, -2.353126072427585681e-17_rk,-6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face2_dx
        ! 
        test_dbr2_face_face2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        3.980854194740136576e-01_rk, 8.867219781614267223e-18_rk, 1.417803682429011577e-17_rk,1.178017820962818671e-17_rk, &
                                        1.396425995443868205e-17_rk, 1.066666666666666874e-01_rk, 3.616738491473336390e-18_rk,7.939095776251757644e-18_rk, &
                                        1.242342762584638485e-17_rk, 4.452071326764054839e-18_rk, 1.066666666666666874e-01_rk,5.666502894431274772e-18_rk, &
                                        -5.101742011705674980e-18_rk, 2.755230325212595674e-18_rk, -2.519953866905477123e-21_rk,2.858124719265311281e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        6.309401076758502924e-01_rk, 4.258911666153913647e-17_rk, 3.749225098590647883e-17_rk,4.460480455565854362e-17_rk, &
                                        4.210724902932335535e-17_rk, 6.309401076758502924e-01_rk, 4.473392059856946017e-17_rk,3.736313494299556228e-17_rk, &
                                        3.959321237013603588e-17_rk, -1.040765285967252447e-17_rk, 1.690598923241498075e-01_rk,1.874352351733463190e-17_rk, &
                                        -9.925785227456744890e-18_rk, 3.911134473792025476e-17_rk, 1.861440747442371227e-17_rk,1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        6.309401076758502924e-01_rk, 2.401312835649163176e-17_rk, 5.183522021929561488e-17_rk,4.690678502960342939e-17_rk, &
                                        3.719039577947122006e-17_rk, 1.690598923241498075e-01_rk, -1.258051729070649677e-17_rk,2.476837550453112180e-17_rk, &
                                        5.183522021929560255e-17_rk, 4.690678502960342939e-17_rk, 6.309401076758502924e-01_rk,2.401312835649163176e-17_rk, &
                                        -1.258051729070649523e-17_rk, 2.476837550453112180e-17_rk, 3.719039577947122006e-17_rk,1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -3.980854194740136576e-01_rk, -8.867219781614267223e-18_rk, -1.417803682429011577e-17_rk,-1.178017820962818671e-17_rk, &
                                        -1.396425995443868205e-17_rk, -1.066666666666666874e-01_rk, -3.616738491473336390e-18_rk,-7.939095776251757644e-18_rk, &
                                        -1.242342762584638485e-17_rk, -4.452071326764054839e-18_rk, -1.066666666666666874e-01_rk,-5.666502894431274772e-18_rk, &
                                        5.101742011705674980e-18_rk, -2.755230325212595674e-18_rk, 2.519953866905477123e-21_rk,-2.858124719265311281e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        1.892820323027550877e+00_rk, 7.205014965094136791e-17_rk, 7.357527964901869092e-17_rk,3.225066290693816691e-17_rk, &
                                        7.025179516498916615e-17_rk, 1.892820323027550877e+00_rk, 3.273253053915394186e-17_rk,7.309341201680289748e-17_rk, &
                                        3.809843187111106775e-17_rk, 6.677431802748654974e-18_rk, 5.071796769724490339e-01_rk,9.705507228398139209e-18_rk, &
                                        8.475786288700852111e-18_rk, 3.630007738515886599e-17_rk, 9.223639596182355009e-18_rk,5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.892820323027550877e+00_rk, 4.865548502373607667e-17_rk, 8.117210203138689132e-17_rk,3.425446265235778454e-17_rk, &
                                        3.261830422338765549e-17_rk, 5.071796769724490339e-01_rk, 5.155499689544815376e-18_rk,2.870325500279064711e-17_rk, &
                                        8.117210203138687899e-17_rk, 3.425446265235778454e-17_rk, 1.892820323027550877e+00_rk,4.865548502373607667e-17_rk, &
                                        5.155499689544807672e-18_rk, 2.870325500279064711e-17_rk, 3.261830422338765549e-17_rk,5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        1.066666666666666874e-01_rk, 1.406063348088183766e-17_rk, 8.035469302694914792e-18_rk,3.590915282891153851e-18_rk, &
                                        8.507548884423826563e-18_rk, 3.980854194740136576e-01_rk, 1.187655173607134386e-17_rk,1.415221361570793246e-17_rk, &
                                        3.114901222403036334e-18_rk, -5.198115538148829817e-18_rk, 2.858124719265311281e-02_rk,2.330325471527860311e-20_rk, &
                                        4.811742223954496270e-18_rk, 1.232705409940322616e-17_rk, 5.570129367988117624e-18_rk,1.066666666666666874e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -6.309401076758502924e-01_rk, -4.258911666153913647e-17_rk, -3.749225098590647883e-17_rk,-4.460480455565854362e-17_rk, &
                                        -4.210724902932335535e-17_rk, -6.309401076758502924e-01_rk, -4.473392059856946017e-17_rk,-3.736313494299556228e-17_rk, &
                                        -3.959321237013603588e-17_rk, 1.040765285967252447e-17_rk, -1.690598923241498075e-01_rk,-1.874352351733463190e-17_rk, &
                                        9.925785227456744890e-18_rk, -3.911134473792025476e-17_rk, -1.861440747442371227e-17_rk,-1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.690598923241498075e-01_rk, 3.731951182238213045e-17_rk, 2.525024313674690600e-17_rk,-1.270963333361741178e-17_rk, &
                                        2.353126072427585065e-17_rk, 6.309401076758502924e-01_rk, 4.738865266181920434e-17_rk,5.170610417638469833e-17_rk, &
                                        2.525024313674689983e-17_rk, -1.270963333361740870e-17_rk, 1.690598923241498075e-01_rk,3.731951182238213045e-17_rk, &
                                        4.738865266181919818e-17_rk, 5.170610417638469833e-17_rk, 2.353126072427585065e-17_rk,6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.066666666666666874e-01_rk, -1.406063348088183766e-17_rk, -8.035469302694914792e-18_rk,-3.590915282891153851e-18_rk, &
                                        -8.507548884423826563e-18_rk, -3.980854194740136576e-01_rk, -1.187655173607134386e-17_rk,-1.415221361570793246e-17_rk, &
                                        -3.114901222403036334e-18_rk, 5.198115538148829817e-18_rk, -2.858124719265311281e-02_rk,-2.330325471527860311e-20_rk, &
                                        -4.811742223954496270e-18_rk, -1.232705409940322616e-17_rk, -5.570129367988117624e-18_rk,-1.066666666666666874e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -1.892820323027550877e+00_rk, -7.205014965094136791e-17_rk, -7.357527964901869092e-17_rk,-3.225066290693816691e-17_rk, &
                                        -7.025179516498916615e-17_rk, -1.892820323027550877e+00_rk, -3.273253053915394186e-17_rk,-7.309341201680289748e-17_rk, &
                                        -3.809843187111106775e-17_rk, -6.677431802748654974e-18_rk, -5.071796769724490339e-01_rk,-9.705507228398139209e-18_rk, &
                                        -8.475786288700852111e-18_rk, -3.630007738515886599e-17_rk, -9.223639596182355009e-18_rk,-5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        5.071796769724490339e-01_rk, 3.310017185560343661e-17_rk, 3.050160948874286119e-17_rk,4.673632057329032717e-18_rk, &
                                        4.685713053778386259e-17_rk, 1.892820323027550877e+00_rk, 3.605281713830998630e-17_rk,8.069023439917112252e-17_rk, &
                                        3.050160948874284886e-17_rk, 4.673632057329035799e-18_rk, 5.071796769724490339e-01_rk,3.310017185560343661e-17_rk, &
                                        3.605281713830998630e-17_rk, 8.069023439917112252e-17_rk, 4.685713053778386259e-17_rk,1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.066666666666666874e-01_rk, 5.666502894431273231e-18_rk, 1.242342762584638331e-17_rk,4.452071326764054839e-18_rk, &
                                        -2.519953866903551193e-21_rk, 2.858124719265311281e-02_rk, -5.101742011705674209e-18_rk,2.755230325212594133e-18_rk, &
                                        1.417803682429011577e-17_rk, 1.178017820962818671e-17_rk, 3.980854194740136576e-01_rk,8.867219781614265683e-18_rk, &
                                        3.616738491473337161e-18_rk, 7.939095776251757644e-18_rk, 1.396425995443867897e-17_rk,1.066666666666666874e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        1.690598923241498075e-01_rk, 1.874352351733462574e-17_rk, 3.959321237013604204e-17_rk,-1.040765285967252447e-17_rk, &
                                        1.861440747442370919e-17_rk, 1.690598923241498075e-01_rk, -9.925785227456747972e-18_rk,3.911134473792025476e-17_rk, &
                                        3.749225098590647267e-17_rk, 4.460480455565854362e-17_rk, 6.309401076758502924e-01_rk,4.258911666153913031e-17_rk, &
                                        4.473392059856944784e-17_rk, 3.736313494299556228e-17_rk, 4.210724902932335535e-17_rk,6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -6.309401076758502924e-01_rk, -2.401312835649163176e-17_rk, -5.183522021929561488e-17_rk,-4.690678502960342939e-17_rk, &
                                        -3.719039577947122006e-17_rk, -1.690598923241498075e-01_rk, 1.258051729070649677e-17_rk,-2.476837550453112180e-17_rk, &
                                        -5.183522021929560255e-17_rk, -4.690678502960342939e-17_rk, -6.309401076758502924e-01_rk,-2.401312835649163176e-17_rk, &
                                        1.258051729070649523e-17_rk, -2.476837550453112180e-17_rk, -3.719039577947122006e-17_rk,-1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.066666666666666874e-01_rk, -5.666502894431273231e-18_rk, -1.242342762584638331e-17_rk,-4.452071326764054839e-18_rk, &
                                        2.519953866903551193e-21_rk, -2.858124719265311281e-02_rk, 5.101742011705674209e-18_rk,-2.755230325212594133e-18_rk, &
                                        -1.417803682429011577e-17_rk, -1.178017820962818671e-17_rk, -3.980854194740136576e-01_rk,-8.867219781614265683e-18_rk, &
                                        -3.616738491473337161e-18_rk, -7.939095776251757644e-18_rk, -1.396425995443867897e-17_rk,-1.066666666666666874e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        5.071796769724490339e-01_rk, 9.705507228398139209e-18_rk, 3.809843187111108007e-17_rk,6.677431802748654974e-18_rk, &
                                        9.223639596182350387e-18_rk, 5.071796769724490339e-01_rk, 8.475786288700855193e-18_rk,3.630007738515886599e-17_rk, &
                                        7.357527964901866627e-17_rk, 3.225066290693816691e-17_rk, 1.892820323027550877e+00_rk,7.205014965094138023e-17_rk, &
                                        3.273253053915394186e-17_rk, 7.309341201680289748e-17_rk, 7.025179516498916615e-17_rk,1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.892820323027550877e+00_rk, -4.865548502373607667e-17_rk, -8.117210203138689132e-17_rk,-3.425446265235778454e-17_rk, &
                                        -3.261830422338765549e-17_rk, -5.071796769724490339e-01_rk, -5.155499689544815376e-18_rk,-2.870325500279064711e-17_rk, &
                                        -8.117210203138687899e-17_rk, -3.425446265235778454e-17_rk, -1.892820323027550877e+00_rk,-4.865548502373607667e-17_rk, &
                                        -5.155499689544807672e-18_rk, -2.870325500279064711e-17_rk, -3.261830422338765549e-17_rk,-5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.858124719265311281e-02_rk, 2.330325471527937349e-20_rk, 3.114901222403035564e-18_rk,-5.198115538148829046e-18_rk, &
                                        5.570129367988119165e-18_rk, 1.066666666666666874e-01_rk, 4.811742223954495500e-18_rk,1.232705409940322925e-17_rk, &
                                        8.035469302694913252e-18_rk, 3.590915282891153080e-18_rk, 1.066666666666666874e-01_rk,1.406063348088183766e-17_rk, &
                                        1.187655173607134386e-17_rk, 1.415221361570792938e-17_rk, 8.507548884423823482e-18_rk,3.980854194740136576e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -1.690598923241498075e-01_rk, -1.874352351733462574e-17_rk, -3.959321237013604204e-17_rk,1.040765285967252447e-17_rk, &
                                        -1.861440747442370919e-17_rk, -1.690598923241498075e-01_rk, 9.925785227456747972e-18_rk,-3.911134473792025476e-17_rk, &
                                        -3.749225098590647267e-17_rk, -4.460480455565854362e-17_rk, -6.309401076758502924e-01_rk,-4.258911666153913031e-17_rk, &
                                        -4.473392059856944784e-17_rk, -3.736313494299556228e-17_rk, -4.210724902932335535e-17_rk,-6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.690598923241498075e-01_rk, -3.731951182238213045e-17_rk, -2.525024313674690600e-17_rk,1.270963333361741178e-17_rk, &
                                        -2.353126072427585065e-17_rk, -6.309401076758502924e-01_rk, -4.738865266181920434e-17_rk,-5.170610417638469833e-17_rk, &
                                        -2.525024313674689983e-17_rk, 1.270963333361740870e-17_rk, -1.690598923241498075e-01_rk,-3.731951182238213045e-17_rk, &
                                        -4.738865266181919818e-17_rk, -5.170610417638469833e-17_rk, -2.353126072427585065e-17_rk,-6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -2.858124719265311281e-02_rk, -2.330325471527937349e-20_rk, -3.114901222403035564e-18_rk,5.198115538148829046e-18_rk, &
                                        -5.570129367988119165e-18_rk, -1.066666666666666874e-01_rk, -4.811742223954495500e-18_rk,-1.232705409940322925e-17_rk, &
                                        -8.035469302694913252e-18_rk, -3.590915282891153080e-18_rk, -1.066666666666666874e-01_rk,-1.406063348088183766e-17_rk, &
                                        -1.187655173607134386e-17_rk, -1.415221361570792938e-17_rk, -8.507548884423823482e-18_rk,-3.980854194740136576e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -5.071796769724490339e-01_rk, -9.705507228398139209e-18_rk, -3.809843187111108007e-17_rk,-6.677431802748654974e-18_rk, &
                                        -9.223639596182350387e-18_rk, -5.071796769724490339e-01_rk, -8.475786288700855193e-18_rk,-3.630007738515886599e-17_rk, &
                                        -7.357527964901866627e-17_rk, -3.225066290693816691e-17_rk, -1.892820323027550877e+00_rk,-7.205014965094138023e-17_rk, &
                                        -3.273253053915394186e-17_rk, -7.309341201680289748e-17_rk, -7.025179516498916615e-17_rk,-1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -5.071796769724490339e-01_rk, -3.310017185560343661e-17_rk, -3.050160948874286119e-17_rk,-4.673632057329032717e-18_rk, &
                                        -4.685713053778386259e-17_rk, -1.892820323027550877e+00_rk, -3.605281713830998630e-17_rk,-8.069023439917112252e-17_rk, &
                                        -3.050160948874284886e-17_rk, -4.673632057329035799e-18_rk, -5.071796769724490339e-01_rk,-3.310017185560343661e-17_rk, &
                                        -3.605281713830998630e-17_rk, -8.069023439917112252e-17_rk, -4.685713053778386259e-17_rk,-1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face3_dx
        ! 
        test_dbr2_face_face3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        3.785640646055102310e-01_rk, 1.589270105807142208e-17_rk, 2.016612713001549998e-17_rk,5.608659352173497400e-18_rk, &
                                        1.589270105807141899e-17_rk, 3.785640646055102310e-01_rk, 5.608659352173497400e-18_rk,2.016612713001549690e-17_rk, &
                                        1.107452151986853598e-17_rk, 8.895738213069162200e-18_rk, 1.014359353944898345e-01_rk,3.285564147686848516e-18_rk, &
                                        8.895738213069162200e-18_rk, 1.107452151986853598e-17_rk, 3.285564147686845050e-18_rk,1.014359353944898345e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.990427097370067733e+00_rk, 5.022624365550127050e-17_rk, 1.224025988695845857e-16_rk,4.067662431964267199e-17_rk, &
                                        6.001268666407950844e-17_rk, 5.333333333333334370e-01_rk, 4.672797219860496610e-17_rk,4.052609986362953713e-17_rk, &
                                        7.659449528118269769e-17_rk, 3.478507101149411187e-17_rk, 5.333333333333334370e-01_rk,1.893657591740248608e-17_rk, &
                                        2.821725896088816390e-17_rk, 8.385372330457100610e-19_rk, -1.200139005941548903e-17_rk,1.429062359632655155e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.892820323027550877e+00_rk, 5.336667387682318921e-17_rk, 1.258692122956968150e-16_rk,1.634132938986453258e-17_rk, &
                                        4.252465215196814487e-17_rk, 5.071796769724491449e-01_rk, 5.618065843634876850e-17_rk,3.033403095372336166e-17_rk, &
                                        1.258692122956968150e-16_rk, 1.634132938986453566e-17_rk, 1.892820323027550877e+00_rk,5.336667387682318921e-17_rk, &
                                        5.618065843634878083e-17_rk, 3.033403095372336783e-17_rk, 4.252465215196815104e-17_rk,5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -3.785640646055102310e-01_rk, -1.589270105807142208e-17_rk, -2.016612713001549998e-17_rk,-5.608659352173497400e-18_rk, &
                                        -1.589270105807141899e-17_rk, -3.785640646055102310e-01_rk, -5.608659352173497400e-18_rk,-2.016612713001549690e-17_rk, &
                                        -1.107452151986853598e-17_rk, -8.895738213069162200e-18_rk, -1.014359353944898345e-01_rk,-3.285564147686848516e-18_rk, &
                                        -8.895738213069162200e-18_rk, -1.107452151986853598e-17_rk, -3.285564147686845050e-18_rk,-1.014359353944898345e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        5.333333333333334370e-01_rk, 6.001268666407950844e-17_rk, 4.052609986362953713e-17_rk,4.672797219860496610e-17_rk, &
                                        5.022624365550127666e-17_rk, 1.990427097370067733e+00_rk, 4.067662431964267199e-17_rk,1.224025988695845857e-16_rk, &
                                        8.385372330457056314e-19_rk, 2.821725896088816390e-17_rk, 1.429062359632655155e-01_rk,-1.200139005941550136e-17_rk, &
                                        3.478507101149411187e-17_rk, 7.659449528118268536e-17_rk, 1.893657591740249841e-17_rk,5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        5.071796769724491449e-01_rk, 4.252465215196814487e-17_rk, 3.033403095372336166e-17_rk,5.618065843634878083e-17_rk, &
                                        5.336667387682318921e-17_rk, 1.892820323027550877e+00_rk, 1.634132938986452950e-17_rk,1.258692122956968150e-16_rk, &
                                        3.033403095372336166e-17_rk, 5.618065843634878083e-17_rk, 5.071796769724490339e-01_rk,4.252465215196814487e-17_rk, &
                                        1.634132938986453566e-17_rk, 1.258692122956967904e-16_rk, 5.336667387682319538e-17_rk,1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        1.261880215351701140e-01_rk, 6.155085005844733711e-18_rk, 1.241961261662732767e-17_rk,1.187225995147602775e-17_rk, &
                                        6.155085005844733711e-18_rk, 1.261880215351700862e-01_rk, 1.187225995147602775e-17_rk,1.241961261662732767e-17_rk, &
                                        4.412084982977142994e-18_rk, 3.704727781407289719e-18_rk, 3.381197846482996566e-02_rk,-1.898526976089448644e-18_rk, &
                                        3.704727781407289719e-18_rk, 4.412084982977142223e-18_rk, -1.898526976089449029e-18_rk,3.381197846482996566e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.990427097370067733e+00_rk, -5.022624365550127050e-17_rk, -1.224025988695845857e-16_rk,-4.067662431964267199e-17_rk, &
                                        -6.001268666407950844e-17_rk, -5.333333333333334370e-01_rk, -4.672797219860496610e-17_rk,-4.052609986362953713e-17_rk, &
                                        -7.659449528118269769e-17_rk, -3.478507101149411187e-17_rk, -5.333333333333334370e-01_rk,-1.893657591740248608e-17_rk, &
                                        -2.821725896088816390e-17_rk, -8.385372330457100610e-19_rk, 1.200139005941548903e-17_rk,-1.429062359632655155e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        6.309401076758502924e-01_rk, 1.579614569608057661e-17_rk, 7.312788185507045606e-17_rk,5.912036594127225437e-17_rk, &
                                        5.486644452695855272e-18_rk, 1.690598923241497242e-01_rk, 1.876457272314434917e-17_rk,1.103060614295187802e-17_rk, &
                                        7.312788185507045606e-17_rk, 5.912036594127225437e-17_rk, 6.309401076758502924e-01_rk,1.579614569608057661e-17_rk, &
                                        1.876457272314434301e-17_rk, 1.103060614295189342e-17_rk, 5.486644452695862205e-18_rk,1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.261880215351701140e-01_rk, -6.155085005844733711e-18_rk, -1.241961261662732767e-17_rk,-1.187225995147602775e-17_rk, &
                                        -6.155085005844733711e-18_rk, -1.261880215351700862e-01_rk, -1.187225995147602775e-17_rk,-1.241961261662732767e-17_rk, &
                                        -4.412084982977142994e-18_rk, -3.704727781407289719e-18_rk, -3.381197846482996566e-02_rk,1.898526976089448644e-18_rk, &
                                        -3.704727781407289719e-18_rk, -4.412084982977142223e-18_rk, 1.898526976089449029e-18_rk,-3.381197846482996566e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -5.333333333333334370e-01_rk, -6.001268666407950844e-17_rk, -4.052609986362953713e-17_rk,-4.672797219860496610e-17_rk, &
                                        -5.022624365550127666e-17_rk, -1.990427097370067733e+00_rk, -4.067662431964267199e-17_rk,-1.224025988695845857e-16_rk, &
                                        -8.385372330457056314e-19_rk, -2.821725896088816390e-17_rk, -1.429062359632655155e-01_rk,1.200139005941550136e-17_rk, &
                                        -3.478507101149411187e-17_rk, -7.659449528118268536e-17_rk, -1.893657591740249841e-17_rk,-5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        1.690598923241497242e-01_rk, 5.486644452695855272e-18_rk, 1.103060614295187802e-17_rk,1.876457272314433992e-17_rk, &
                                        1.579614569608057661e-17_rk, 6.309401076758502924e-01_rk, 5.912036594127225437e-17_rk,7.312788185507045606e-17_rk, &
                                        1.103060614295188572e-17_rk, 1.876457272314434301e-17_rk, 1.690598923241498075e-01_rk,5.486644452695856042e-18_rk, &
                                        5.912036594127225437e-17_rk, 7.312788185507045606e-17_rk, 1.579614569608058278e-17_rk,6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.014359353944898484e-01_rk, 3.285564147686847361e-18_rk, 1.107452151986853906e-17_rk,8.895738213069162200e-18_rk, &
                                        3.285564147686845820e-18_rk, 1.014359353944898345e-01_rk, 8.895738213069162200e-18_rk,1.107452151986853598e-17_rk, &
                                        2.016612713001549690e-17_rk, 5.608659352173496629e-18_rk, 3.785640646055102310e-01_rk,1.589270105807142208e-17_rk, &
                                        5.608659352173496629e-18_rk, 2.016612713001549690e-17_rk, 1.589270105807142208e-17_rk,3.785640646055102310e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.333333333333334370e-01_rk, 1.893657591740248916e-17_rk, 7.659449528118269769e-17_rk,3.478507101149411804e-17_rk, &
                                        -1.200139005941550136e-17_rk, 1.429062359632655155e-01_rk, 2.821725896088815774e-17_rk,8.385372330456990832e-19_rk, &
                                        1.224025988695845857e-16_rk, 4.067662431964267816e-17_rk, 1.990427097370067733e+00_rk,5.022624365550127666e-17_rk, &
                                        4.672797219860495993e-17_rk, 4.052609986362954946e-17_rk, 6.001268666407950844e-17_rk,5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.892820323027550877e+00_rk, -5.336667387682318921e-17_rk, -1.258692122956968150e-16_rk,-1.634132938986453258e-17_rk, &
                                        -4.252465215196814487e-17_rk, -5.071796769724491449e-01_rk, -5.618065843634876850e-17_rk,-3.033403095372336166e-17_rk, &
                                        -1.258692122956968150e-16_rk, -1.634132938986453566e-17_rk, -1.892820323027550877e+00_rk,-5.336667387682318921e-17_rk, &
                                        -5.618065843634878083e-17_rk, -3.033403095372336783e-17_rk, -4.252465215196815104e-17_rk,-5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.014359353944898484e-01_rk, -3.285564147686847361e-18_rk, -1.107452151986853906e-17_rk,-8.895738213069162200e-18_rk, &
                                        -3.285564147686845820e-18_rk, -1.014359353944898345e-01_rk, -8.895738213069162200e-18_rk,-1.107452151986853598e-17_rk, &
                                        -2.016612713001549690e-17_rk, -5.608659352173496629e-18_rk, -3.785640646055102310e-01_rk,-1.589270105807142208e-17_rk, &
                                        -5.608659352173496629e-18_rk, -2.016612713001549690e-17_rk, -1.589270105807142208e-17_rk,-3.785640646055102310e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        1.429062359632655155e-01_rk, -1.200139005941550290e-17_rk, 8.385372330456994684e-19_rk,2.821725896088815774e-17_rk, &
                                        1.893657591740248608e-17_rk, 5.333333333333334370e-01_rk, 3.478507101149411804e-17_rk,7.659449528118269769e-17_rk, &
                                        4.052609986362954329e-17_rk, 4.672797219860495993e-17_rk, 5.333333333333334370e-01_rk,6.001268666407950844e-17_rk, &
                                        4.067662431964267816e-17_rk, 1.224025988695845857e-16_rk, 5.022624365550127666e-17_rk,1.990427097370067733e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -5.071796769724491449e-01_rk, -4.252465215196814487e-17_rk, -3.033403095372336166e-17_rk,-5.618065843634878083e-17_rk, &
                                        -5.336667387682318921e-17_rk, -1.892820323027550877e+00_rk, -1.634132938986452950e-17_rk,-1.258692122956968150e-16_rk, &
                                        -3.033403095372336166e-17_rk, -5.618065843634878083e-17_rk, -5.071796769724490339e-01_rk,-4.252465215196814487e-17_rk, &
                                        -1.634132938986453566e-17_rk, -1.258692122956967904e-16_rk, -5.336667387682319538e-17_rk,-1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        3.381197846482995872e-02_rk, -1.898526976089448259e-18_rk, 4.412084982977142223e-18_rk,3.704727781407290489e-18_rk, &
                                        -1.898526976089449029e-18_rk, 3.381197846482996566e-02_rk, 3.704727781407290489e-18_rk,4.412084982977141453e-18_rk, &
                                        1.241961261662732767e-17_rk, 1.187225995147602775e-17_rk, 1.261880215351700862e-01_rk,6.155085005844736792e-18_rk, &
                                        1.187225995147602775e-17_rk, 1.241961261662732767e-17_rk, 6.155085005844735252e-18_rk,1.261880215351700862e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.333333333333334370e-01_rk, -1.893657591740248916e-17_rk, -7.659449528118269769e-17_rk,-3.478507101149411804e-17_rk, &
                                        1.200139005941550136e-17_rk, -1.429062359632655155e-01_rk, -2.821725896088815774e-17_rk,-8.385372330456990832e-19_rk, &
                                        -1.224025988695845857e-16_rk, -4.067662431964267816e-17_rk, -1.990427097370067733e+00_rk,-5.022624365550127666e-17_rk, &
                                        -4.672797219860495993e-17_rk, -4.052609986362954946e-17_rk, -6.001268666407950844e-17_rk,-5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -6.309401076758502924e-01_rk, -1.579614569608057661e-17_rk, -7.312788185507045606e-17_rk,-5.912036594127225437e-17_rk, &
                                        -5.486644452695855272e-18_rk, -1.690598923241497242e-01_rk, -1.876457272314434917e-17_rk,-1.103060614295187802e-17_rk, &
                                        -7.312788185507045606e-17_rk, -5.912036594127225437e-17_rk, -6.309401076758502924e-01_rk,-1.579614569608057661e-17_rk, &
                                        -1.876457272314434301e-17_rk, -1.103060614295189342e-17_rk, -5.486644452695862205e-18_rk,-1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -3.381197846482995872e-02_rk, 1.898526976089448259e-18_rk, -4.412084982977142223e-18_rk,-3.704727781407290489e-18_rk, &
                                        1.898526976089449029e-18_rk, -3.381197846482996566e-02_rk, -3.704727781407290489e-18_rk,-4.412084982977141453e-18_rk, &
                                        -1.241961261662732767e-17_rk, -1.187225995147602775e-17_rk, -1.261880215351700862e-01_rk,-6.155085005844736792e-18_rk, &
                                        -1.187225995147602775e-17_rk, -1.241961261662732767e-17_rk, -6.155085005844735252e-18_rk,-1.261880215351700862e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.429062359632655155e-01_rk, 1.200139005941550290e-17_rk, -8.385372330456994684e-19_rk,-2.821725896088815774e-17_rk, &
                                        -1.893657591740248608e-17_rk, -5.333333333333334370e-01_rk, -3.478507101149411804e-17_rk,-7.659449528118269769e-17_rk, &
                                        -4.052609986362954329e-17_rk, -4.672797219860495993e-17_rk, -5.333333333333334370e-01_rk,-6.001268666407950844e-17_rk, &
                                        -4.067662431964267816e-17_rk, -1.224025988695845857e-16_rk, -5.022624365550127666e-17_rk,-1.990427097370067733e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -1.690598923241497242e-01_rk, -5.486644452695855272e-18_rk, -1.103060614295187802e-17_rk,-1.876457272314433992e-17_rk, &
                                        -1.579614569608057661e-17_rk, -6.309401076758502924e-01_rk, -5.912036594127225437e-17_rk,-7.312788185507045606e-17_rk, &
                                        -1.103060614295188572e-17_rk, -1.876457272314434301e-17_rk, -1.690598923241498075e-01_rk,-5.486644452695856042e-18_rk, &
                                        -5.912036594127225437e-17_rk, -7.312788185507045606e-17_rk, -1.579614569608058278e-17_rk,-6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face4_dx
        ! 
        test_dbr2_face_face4_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.261880215351700862e-01_rk, 6.155085005844733711e-18_rk, 1.241961261662732767e-17_rk,1.187225995147602775e-17_rk, &
                                        6.155085005844733711e-18_rk, 1.261880215351700862e-01_rk, 1.187225995147602775e-17_rk,1.241961261662732767e-17_rk, &
                                        4.412084982977139912e-18_rk, 3.704727781407289719e-18_rk, 3.381197846482996566e-02_rk,-1.898526976089449414e-18_rk, &
                                        3.704727781407291260e-18_rk, 4.412084982977140683e-18_rk, -1.898526976089450570e-18_rk,3.381197846482996566e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.990427097370067733e+00_rk, 5.022624365550127050e-17_rk, 1.224025988695845611e-16_rk,4.067662431964267816e-17_rk, &
                                        6.001268666407950844e-17_rk, 5.333333333333334370e-01_rk, 4.672797219860495993e-17_rk,4.052609986362954329e-17_rk, &
                                        7.659449528118268536e-17_rk, 3.478507101149411187e-17_rk, 5.333333333333334370e-01_rk,1.893657591740249225e-17_rk, &
                                        2.821725896088816390e-17_rk, 8.385372330457060166e-19_rk, -1.200139005941550444e-17_rk,1.429062359632655155e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,1,3) = reshape((/                                                                                 &
                                        6.309401076758504034e-01_rk, 1.579614569608057661e-17_rk, 7.312788185507046839e-17_rk,5.912036594127226670e-17_rk, &
                                        5.486644452695849109e-18_rk, 1.690598923241497797e-01_rk, 1.876457272314434917e-17_rk,1.103060614295188418e-17_rk, &
                                        7.312788185507045606e-17_rk, 5.912036594127225437e-17_rk, 6.309401076758502924e-01_rk,1.579614569608057353e-17_rk, &
                                        1.876457272314434301e-17_rk, 1.103060614295188572e-17_rk, 5.486644452695846798e-18_rk,1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.261880215351700862e-01_rk, -6.155085005844733711e-18_rk, -1.241961261662732767e-17_rk,-1.187225995147602775e-17_rk, &
                                        -6.155085005844733711e-18_rk, -1.261880215351700862e-01_rk, -1.187225995147602775e-17_rk,-1.241961261662732767e-17_rk, &
                                        -4.412084982977139912e-18_rk, -3.704727781407289719e-18_rk, -3.381197846482996566e-02_rk,1.898526976089449414e-18_rk, &
                                        -3.704727781407291260e-18_rk, -4.412084982977140683e-18_rk, 1.898526976089450570e-18_rk,-3.381197846482996566e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,2) = reshape((/                                                                                 &
                                        5.333333333333334370e-01_rk, 6.001268666407949611e-17_rk, 4.052609986362954946e-17_rk,4.672797219860495993e-17_rk, &
                                        5.022624365550127050e-17_rk, 1.990427097370067733e+00_rk, 4.067662431964267816e-17_rk,1.224025988695845857e-16_rk, &
                                        8.385372330457106388e-19_rk, 2.821725896088816390e-17_rk, 1.429062359632655155e-01_rk,-1.200139005941549828e-17_rk, &
                                        3.478507101149411187e-17_rk, 7.659449528118269769e-17_rk, 1.893657591740248608e-17_rk,5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.690598923241497797e-01_rk, 5.486644452695852191e-18_rk, 1.103060614295189188e-17_rk,1.876457272314434609e-17_rk, &
                                        1.579614569608057045e-17_rk, 6.309401076758504034e-01_rk, 5.912036594127225437e-17_rk,7.312788185507045606e-17_rk, &
                                        1.103060614295188418e-17_rk, 1.876457272314434301e-17_rk, 1.690598923241498075e-01_rk,5.486644452695852191e-18_rk, &
                                        5.912036594127225437e-17_rk, 7.312788185507045606e-17_rk, 1.579614569608056737e-17_rk,6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,1) = reshape((/                                                                                 &
                                        3.785640646055102310e-01_rk, 1.589270105807142208e-17_rk, 2.016612713001549998e-17_rk,5.608659352173496629e-18_rk, &
                                        1.589270105807142208e-17_rk, 3.785640646055102310e-01_rk, 5.608659352173496629e-18_rk,2.016612713001549690e-17_rk, &
                                        1.107452151986853443e-17_rk, 8.895738213069162200e-18_rk, 1.014359353944898345e-01_rk,3.285564147686846975e-18_rk, &
                                        8.895738213069165281e-18_rk, 1.107452151986853443e-17_rk, 3.285564147686845820e-18_rk,1.014359353944898345e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.990427097370067733e+00_rk, -5.022624365550127050e-17_rk, -1.224025988695845611e-16_rk,-4.067662431964267816e-17_rk, &
                                        -6.001268666407950844e-17_rk, -5.333333333333334370e-01_rk, -4.672797219860495993e-17_rk,-4.052609986362954329e-17_rk, &
                                        -7.659449528118268536e-17_rk, -3.478507101149411187e-17_rk, -5.333333333333334370e-01_rk,-1.893657591740249225e-17_rk, &
                                        -2.821725896088816390e-17_rk, -8.385372330457060166e-19_rk, 1.200139005941550444e-17_rk,-1.429062359632655155e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.892820323027550877e+00_rk, 5.336667387682318921e-17_rk, 1.258692122956967904e-16_rk,1.634132938986452642e-17_rk, &
                                        4.252465215196815104e-17_rk, 5.071796769724491449e-01_rk, 5.618065843634876850e-17_rk,3.033403095372336783e-17_rk, &
                                        1.258692122956968150e-16_rk, 1.634132938986453566e-17_rk, 1.892820323027550877e+00_rk,5.336667387682319538e-17_rk, &
                                        5.618065843634878083e-17_rk, 3.033403095372336166e-17_rk, 4.252465215196813871e-17_rk,5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -3.785640646055102310e-01_rk, -1.589270105807142208e-17_rk, -2.016612713001549998e-17_rk,-5.608659352173496629e-18_rk, &
                                        -1.589270105807142208e-17_rk, -3.785640646055102310e-01_rk, -5.608659352173496629e-18_rk,-2.016612713001549690e-17_rk, &
                                        -1.107452151986853443e-17_rk, -8.895738213069162200e-18_rk, -1.014359353944898345e-01_rk,-3.285564147686846975e-18_rk, &
                                        -8.895738213069165281e-18_rk, -1.107452151986853443e-17_rk, -3.285564147686845820e-18_rk,-1.014359353944898345e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -5.333333333333334370e-01_rk, -6.001268666407949611e-17_rk, -4.052609986362954946e-17_rk,-4.672797219860495993e-17_rk, &
                                        -5.022624365550127050e-17_rk, -1.990427097370067733e+00_rk, -4.067662431964267816e-17_rk,-1.224025988695845857e-16_rk, &
                                        -8.385372330457106388e-19_rk, -2.821725896088816390e-17_rk, -1.429062359632655155e-01_rk,1.200139005941549828e-17_rk, &
                                        -3.478507101149411187e-17_rk, -7.659449528118269769e-17_rk, -1.893657591740248608e-17_rk,-5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,3) = reshape((/                                                                                 &
                                        5.071796769724491449e-01_rk, 4.252465215196813871e-17_rk, 3.033403095372336783e-17_rk,5.618065843634878083e-17_rk, &
                                        5.336667387682319538e-17_rk, 1.892820323027550877e+00_rk, 1.634132938986452950e-17_rk,1.258692122956968150e-16_rk, &
                                        3.033403095372336783e-17_rk, 5.618065843634878083e-17_rk, 5.071796769724490339e-01_rk,4.252465215196815104e-17_rk, &
                                        1.634132938986453566e-17_rk, 1.258692122956968150e-16_rk, 5.336667387682318305e-17_rk,1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,1) = reshape((/                                                                                 &
                                        3.381197846482996566e-02_rk, -1.898526976089449799e-18_rk, 4.412084982977142223e-18_rk,3.704727781407289719e-18_rk, &
                                        -1.898526976089449799e-18_rk, 3.381197846482996566e-02_rk, 3.704727781407289719e-18_rk,4.412084982977142994e-18_rk, &
                                        1.241961261662732767e-17_rk, 1.187225995147602775e-17_rk, 1.261880215351700862e-01_rk,6.155085005844735252e-18_rk, &
                                        1.187225995147603083e-17_rk, 1.241961261662732767e-17_rk, 6.155085005844734481e-18_rk,1.261880215351700862e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.333333333333334370e-01_rk, 1.893657591740249533e-17_rk, 7.659449528118267304e-17_rk,3.478507101149411187e-17_rk, &
                                        -1.200139005941550290e-17_rk, 1.429062359632655155e-01_rk, 2.821725896088816390e-17_rk,8.385372330457056314e-19_rk, &
                                        1.224025988695845857e-16_rk, 4.067662431964267816e-17_rk, 1.990427097370067733e+00_rk,5.022624365550127666e-17_rk, &
                                        4.672797219860495993e-17_rk, 4.052609986362954329e-17_rk, 6.001268666407949611e-17_rk,5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -6.309401076758504034e-01_rk, -1.579614569608057661e-17_rk, -7.312788185507046839e-17_rk,-5.912036594127226670e-17_rk, &
                                        -5.486644452695849109e-18_rk, -1.690598923241497797e-01_rk, -1.876457272314434917e-17_rk,-1.103060614295188418e-17_rk, &
                                        -7.312788185507045606e-17_rk, -5.912036594127225437e-17_rk, -6.309401076758502924e-01_rk,-1.579614569608057353e-17_rk, &
                                        -1.876457272314434301e-17_rk, -1.103060614295188572e-17_rk, -5.486644452695846798e-18_rk,-1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -3.381197846482996566e-02_rk, 1.898526976089449799e-18_rk, -4.412084982977142223e-18_rk,-3.704727781407289719e-18_rk, &
                                        1.898526976089449799e-18_rk, -3.381197846482996566e-02_rk, -3.704727781407289719e-18_rk,-4.412084982977142994e-18_rk, &
                                        -1.241961261662732767e-17_rk, -1.187225995147602775e-17_rk, -1.261880215351700862e-01_rk,-6.155085005844735252e-18_rk, &
                                        -1.187225995147603083e-17_rk, -1.241961261662732767e-17_rk, -6.155085005844734481e-18_rk,-1.261880215351700862e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,2) = reshape((/                                                                                 &
                                        1.429062359632655155e-01_rk, -1.200139005941549982e-17_rk, 8.385372330457137203e-19_rk,2.821725896088816390e-17_rk, &
                                        1.893657591740248916e-17_rk, 5.333333333333334370e-01_rk, 3.478507101149411187e-17_rk,7.659449528118269769e-17_rk, &
                                        4.052609986362953713e-17_rk, 4.672797219860495993e-17_rk, 5.333333333333334370e-01_rk,6.001268666407950844e-17_rk, &
                                        4.067662431964267816e-17_rk, 1.224025988695845857e-16_rk, 5.022624365550126433e-17_rk,1.990427097370067733e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.690598923241497797e-01_rk, -5.486644452695852191e-18_rk, -1.103060614295189188e-17_rk,-1.876457272314434609e-17_rk, &
                                        -1.579614569608057045e-17_rk, -6.309401076758504034e-01_rk, -5.912036594127225437e-17_rk,-7.312788185507045606e-17_rk, &
                                        -1.103060614295188418e-17_rk, -1.876457272314434301e-17_rk, -1.690598923241498075e-01_rk,-5.486644452695852191e-18_rk, &
                                        -5.912036594127225437e-17_rk, -7.312788185507045606e-17_rk, -1.579614569608056737e-17_rk,-6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.014359353944898345e-01_rk, 3.285564147686845050e-18_rk, 1.107452151986853906e-17_rk,8.895738213069162200e-18_rk, &
                                        3.285564147686845050e-18_rk, 1.014359353944898345e-01_rk, 8.895738213069162200e-18_rk,1.107452151986853598e-17_rk, &
                                        2.016612713001549998e-17_rk, 5.608659352173496629e-18_rk, 3.785640646055102310e-01_rk,1.589270105807142208e-17_rk, &
                                        5.608659352173498170e-18_rk, 2.016612713001549998e-17_rk, 1.589270105807142208e-17_rk,3.785640646055102310e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.333333333333334370e-01_rk, -1.893657591740249533e-17_rk, -7.659449528118267304e-17_rk,-3.478507101149411187e-17_rk, &
                                        1.200139005941550290e-17_rk, -1.429062359632655155e-01_rk, -2.821725896088816390e-17_rk,-8.385372330457056314e-19_rk, &
                                        -1.224025988695845857e-16_rk, -4.067662431964267816e-17_rk, -1.990427097370067733e+00_rk,-5.022624365550127666e-17_rk, &
                                        -4.672797219860495993e-17_rk, -4.052609986362954329e-17_rk, -6.001268666407949611e-17_rk,-5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.892820323027550877e+00_rk, -5.336667387682318921e-17_rk, -1.258692122956967904e-16_rk,-1.634132938986452642e-17_rk, &
                                        -4.252465215196815104e-17_rk, -5.071796769724491449e-01_rk, -5.618065843634876850e-17_rk,-3.033403095372336783e-17_rk, &
                                        -1.258692122956968150e-16_rk, -1.634132938986453566e-17_rk, -1.892820323027550877e+00_rk,-5.336667387682319538e-17_rk, &
                                        -5.618065843634878083e-17_rk, -3.033403095372336166e-17_rk, -4.252465215196813871e-17_rk,-5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.014359353944898345e-01_rk, -3.285564147686845050e-18_rk, -1.107452151986853906e-17_rk,-8.895738213069162200e-18_rk, &
                                        -3.285564147686845050e-18_rk, -1.014359353944898345e-01_rk, -8.895738213069162200e-18_rk,-1.107452151986853598e-17_rk, &
                                        -2.016612713001549998e-17_rk, -5.608659352173496629e-18_rk, -3.785640646055102310e-01_rk,-1.589270105807142208e-17_rk, &
                                        -5.608659352173498170e-18_rk, -2.016612713001549998e-17_rk, -1.589270105807142208e-17_rk,-3.785640646055102310e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.429062359632655155e-01_rk, 1.200139005941549982e-17_rk, -8.385372330457137203e-19_rk,-2.821725896088816390e-17_rk, &
                                        -1.893657591740248916e-17_rk, -5.333333333333334370e-01_rk, -3.478507101149411187e-17_rk,-7.659449528118269769e-17_rk, &
                                        -4.052609986362953713e-17_rk, -4.672797219860495993e-17_rk, -5.333333333333334370e-01_rk,-6.001268666407950844e-17_rk, &
                                        -4.067662431964267816e-17_rk, -1.224025988695845857e-16_rk, -5.022624365550126433e-17_rk,-1.990427097370067733e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -5.071796769724491449e-01_rk, -4.252465215196813871e-17_rk, -3.033403095372336783e-17_rk,-5.618065843634878083e-17_rk, &
                                        -5.336667387682319538e-17_rk, -1.892820323027550877e+00_rk, -1.634132938986452950e-17_rk,-1.258692122956968150e-16_rk, &
                                        -3.033403095372336783e-17_rk, -5.618065843634878083e-17_rk, -5.071796769724490339e-01_rk,-4.252465215196815104e-17_rk, &
                                        -1.634132938986453566e-17_rk, -1.258692122956968150e-16_rk, -5.336667387682318305e-17_rk,-1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face5_dx
        ! 
        test_dbr2_face_face5_dx(:,:,1,1) = reshape((/                                                                                 &
                                        3.785640646055102310e-01_rk, 4.017960955533867796e-18_rk, 4.199793836264259724e-18_rk,2.475984532443372687e-18_rk, &
                                        4.017960955533869337e-18_rk, 3.785640646055102310e-01_rk, 2.475984532443373072e-18_rk,4.199793836264258954e-18_rk, &
                                        -1.389087095133772269e-18_rk, -1.211451258021648807e-17_rk, 1.014359353944898068e-01_rk,7.478935460020444518e-19_rk, &
                                        -1.211451258021648807e-17_rk, -1.389087095133772077e-18_rk, 7.478935460020448369e-19_rk,1.014359353944898068e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.892820323027550877e+00_rk, 3.946803722757815771e-17_rk, 3.321642122108664924e-17_rk,4.460291329006126130e-19_rk, &
                                        -1.563876471989858877e-17_rk, 5.071796769724490339e-01_rk, -4.863866937176618106e-17_rk,-1.916288751543420908e-17_rk, &
                                        3.321642122108665541e-17_rk, 4.460291329006110722e-19_rk, 1.892820323027550877e+00_rk,3.946803722757815155e-17_rk, &
                                        -4.863866937176618106e-17_rk, -1.916288751543421524e-17_rk, -1.563876471989859185e-17_rk,5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.990427097370067733e+00_rk, 5.669516360222990704e-17_rk, 1.870144879343937628e-17_rk,2.083864969649552545e-17_rk, &
                                        -7.917198895013742546e-18_rk, 5.333333333333334370e-01_rk, 1.417024899325573641e-17_rk,-3.663943044997621365e-19_rk, &
                                        5.436708649316560707e-18_rk, -1.798113126489027762e-17_rk, 5.333333333333334370e-01_rk,2.634142078416083821e-17_rk, &
                                        -7.223993373265750045e-17_rk, -5.055125522554710913e-17_rk, 7.551784093395255026e-18_rk,1.429062359632655155e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -3.785640646055102310e-01_rk, -4.017960955533867796e-18_rk, -4.199793836264259724e-18_rk,-2.475984532443372687e-18_rk, &
                                        -4.017960955533869337e-18_rk, -3.785640646055102310e-01_rk, -2.475984532443373072e-18_rk,-4.199793836264258954e-18_rk, &
                                        1.389087095133772269e-18_rk, 1.211451258021648807e-17_rk, -1.014359353944898068e-01_rk,-7.478935460020444518e-19_rk, &
                                        1.211451258021648807e-17_rk, 1.389087095133772077e-18_rk, -7.478935460020448369e-19_rk,-1.014359353944898068e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,2) = reshape((/                                                                                 &
                                        5.071796769724491449e-01_rk, -1.563876471989859185e-17_rk, -1.916288751543420908e-17_rk,-4.863866937176618722e-17_rk, &
                                        3.946803722757815771e-17_rk, 1.892820323027550877e+00_rk, 4.460291329006172352e-19_rk,3.321642122108664924e-17_rk, &
                                        -1.916288751543421524e-17_rk, -4.863866937176618106e-17_rk, 5.071796769724490339e-01_rk,-1.563876471989859185e-17_rk, &
                                        4.460291329006126130e-19_rk, 3.321642122108666157e-17_rk, 3.946803722757815771e-17_rk,1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,3) = reshape((/                                                                                 &
                                        5.333333333333334370e-01_rk, -7.917198895013745628e-18_rk, -3.663943044997621365e-19_rk,1.417024899325573024e-17_rk, &
                                        5.669516360222990704e-17_rk, 1.990427097370067733e+00_rk, 2.083864969649552545e-17_rk,1.870144879343937628e-17_rk, &
                                        -5.055125522554710913e-17_rk, -7.223993373265750045e-17_rk, 1.429062359632655155e-01_rk,7.551784093395253485e-18_rk, &
                                        -1.798113126489027454e-17_rk, 5.436708649316559166e-18_rk, 2.634142078416083821e-17_rk,5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,1) = reshape((/                                                                                 &
                                        1.014359353944898345e-01_rk, 7.478935460020446443e-19_rk, -1.389087095133771499e-18_rk,-1.211451258021648499e-17_rk, &
                                        7.478935460020456073e-19_rk, 1.014359353944898345e-01_rk, -1.211451258021648807e-17_rk,-1.389087095133771691e-18_rk, &
                                        4.199793836264260494e-18_rk, 2.475984532443372687e-18_rk, 3.785640646055101755e-01_rk,4.017960955533867796e-18_rk, &
                                        2.475984532443373072e-18_rk, 4.199793836264260494e-18_rk, 4.017960955533867796e-18_rk,3.785640646055101755e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.892820323027550877e+00_rk, -3.946803722757815771e-17_rk, -3.321642122108664924e-17_rk,-4.460291329006126130e-19_rk, &
                                        1.563876471989858877e-17_rk, -5.071796769724490339e-01_rk, 4.863866937176618106e-17_rk,1.916288751543420908e-17_rk, &
                                        -3.321642122108665541e-17_rk, -4.460291329006110722e-19_rk, -1.892820323027550877e+00_rk,-3.946803722757815155e-17_rk, &
                                        4.863866937176618106e-17_rk, 1.916288751543421524e-17_rk, 1.563876471989859185e-17_rk,-5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,3) = reshape((/                                                                                 &
                                        5.333333333333334370e-01_rk, 2.634142078416084129e-17_rk, 5.436708649316556085e-18_rk,-1.798113126489027454e-17_rk, &
                                        7.551784093395256566e-18_rk, 1.429062359632655155e-01_rk, -7.223993373265750045e-17_rk,-5.055125522554710296e-17_rk, &
                                        1.870144879343938245e-17_rk, 2.083864969649551620e-17_rk, 1.990427097370067733e+00_rk,5.669516360222990704e-17_rk, &
                                        1.417024899325573641e-17_rk, -3.663943044997682995e-19_rk, -7.917198895013747169e-18_rk,5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.014359353944898345e-01_rk, -7.478935460020446443e-19_rk, 1.389087095133771499e-18_rk,1.211451258021648499e-17_rk, &
                                        -7.478935460020456073e-19_rk, -1.014359353944898345e-01_rk, 1.211451258021648807e-17_rk,1.389087095133771691e-18_rk, &
                                        -4.199793836264260494e-18_rk, -2.475984532443372687e-18_rk, -3.785640646055101755e-01_rk,-4.017960955533867796e-18_rk, &
                                        -2.475984532443373072e-18_rk, -4.199793836264260494e-18_rk, -4.017960955533867796e-18_rk,-3.785640646055101755e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -5.071796769724491449e-01_rk, 1.563876471989859185e-17_rk, 1.916288751543420908e-17_rk,4.863866937176618722e-17_rk, &
                                        -3.946803722757815771e-17_rk, -1.892820323027550877e+00_rk, -4.460291329006172352e-19_rk,-3.321642122108664924e-17_rk, &
                                        1.916288751543421524e-17_rk, 4.863866937176618106e-17_rk, -5.071796769724490339e-01_rk,1.563876471989859185e-17_rk, &
                                        -4.460291329006126130e-19_rk, -3.321642122108666157e-17_rk, -3.946803722757815771e-17_rk,-1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,3) = reshape((/                                                                                 &
                                        1.429062359632655155e-01_rk, 7.551784093395253485e-18_rk, -5.055125522554710296e-17_rk,-7.223993373265751277e-17_rk, &
                                        2.634142078416085361e-17_rk, 5.333333333333334370e-01_rk, -1.798113126489027454e-17_rk,5.436708649316556085e-18_rk, &
                                        -3.663943044997652180e-19_rk, 1.417024899325573949e-17_rk, 5.333333333333334370e-01_rk,-7.917198895013745628e-18_rk, &
                                        2.083864969649552545e-17_rk, 1.870144879343937628e-17_rk, 5.669516360222990704e-17_rk,1.990427097370067733e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.261880215351700862e-01_rk, 5.737631985909361866e-18_rk, -5.327829384763381656e-19_rk,4.525795205506879684e-18_rk, &
                                        5.737631985909364177e-18_rk, 1.261880215351700862e-01_rk, 4.525795205506880455e-18_rk,-5.327829384763375878e-19_rk, &
                                        -7.633822220112339533e-18_rk, -5.929700419293071241e-18_rk, 3.381197846482993791e-02_rk,6.030747429509174195e-18_rk, &
                                        -5.929700419293071241e-18_rk, -7.633822220112339533e-18_rk, 6.030747429509174195e-18_rk,3.381197846482993791e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,2) = reshape((/                                                                                 &
                                        6.309401076758504034e-01_rk, 4.356854715881258753e-17_rk, -9.078263778330721497e-18_rk,2.411489298704632134e-18_rk, &
                                        1.527334991828010279e-17_rk, 1.690598923241498075e-01_rk, -9.431015367635586065e-18_rk,-3.175476201461265602e-17_rk, &
                                        -9.078263778330715334e-18_rk, 2.411489298704630593e-18_rk, 6.309401076758502924e-01_rk,4.356854715881259369e-17_rk, &
                                        -9.431015367635587606e-18_rk, -3.175476201461265602e-17_rk, 1.527334991828009971e-17_rk,1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.990427097370067733e+00_rk, -5.669516360222990704e-17_rk, -1.870144879343937628e-17_rk,-2.083864969649552545e-17_rk, &
                                        7.917198895013742546e-18_rk, -5.333333333333334370e-01_rk, -1.417024899325573641e-17_rk,3.663943044997621365e-19_rk, &
                                        -5.436708649316560707e-18_rk, 1.798113126489027762e-17_rk, -5.333333333333334370e-01_rk,-2.634142078416083821e-17_rk, &
                                        7.223993373265750045e-17_rk, 5.055125522554710913e-17_rk, -7.551784093395255026e-18_rk,-1.429062359632655155e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.261880215351700862e-01_rk, -5.737631985909361866e-18_rk, 5.327829384763381656e-19_rk,-4.525795205506879684e-18_rk, &
                                        -5.737631985909364177e-18_rk, -1.261880215351700862e-01_rk, -4.525795205506880455e-18_rk,5.327829384763375878e-19_rk, &
                                        7.633822220112339533e-18_rk, 5.929700419293071241e-18_rk, -3.381197846482993791e-02_rk,-6.030747429509174195e-18_rk, &
                                        5.929700419293071241e-18_rk, 7.633822220112339533e-18_rk, -6.030747429509174195e-18_rk,-3.381197846482993791e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,2) = reshape((/                                                                                 &
                                        1.690598923241497797e-01_rk, 1.527334991828009971e-17_rk, -3.175476201461265602e-17_rk,-9.431015367635593769e-18_rk, &
                                        4.356854715881259986e-17_rk, 6.309401076758502924e-01_rk, 2.411489298704633674e-18_rk,-9.078263778330721497e-18_rk, &
                                        -3.175476201461265602e-17_rk, -9.431015367635587606e-18_rk, 1.690598923241498075e-01_rk,1.527334991828009971e-17_rk, &
                                        2.411489298704635215e-18_rk, -9.078263778330719956e-18_rk, 4.356854715881258753e-17_rk,6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -5.333333333333334370e-01_rk, 7.917198895013745628e-18_rk, 3.663943044997621365e-19_rk,-1.417024899325573024e-17_rk, &
                                        -5.669516360222990704e-17_rk, -1.990427097370067733e+00_rk, -2.083864969649552545e-17_rk,-1.870144879343937628e-17_rk, &
                                        5.055125522554710913e-17_rk, 7.223993373265750045e-17_rk, -1.429062359632655155e-01_rk,-7.551784093395253485e-18_rk, &
                                        1.798113126489027454e-17_rk, -5.436708649316559166e-18_rk, -2.634142078416083821e-17_rk,-5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,1) = reshape((/                                                                                 &
                                        3.381197846482996566e-02_rk, 6.030747429509174965e-18_rk, -7.633822220112337992e-18_rk,-5.929700419293071241e-18_rk, &
                                        6.030747429509175736e-18_rk, 3.381197846482996566e-02_rk, -5.929700419293071241e-18_rk,-7.633822220112337992e-18_rk, &
                                        -5.327829384763377804e-19_rk, 4.525795205506880455e-18_rk, 1.261880215351700307e-01_rk,5.737631985909362637e-18_rk, &
                                        4.525795205506880455e-18_rk, -5.327829384763376841e-19_rk, 5.737631985909362637e-18_rk,1.261880215351700307e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -6.309401076758504034e-01_rk, -4.356854715881258753e-17_rk, 9.078263778330721497e-18_rk,-2.411489298704632134e-18_rk, &
                                        -1.527334991828010279e-17_rk, -1.690598923241498075e-01_rk, 9.431015367635586065e-18_rk,3.175476201461265602e-17_rk, &
                                        9.078263778330715334e-18_rk, -2.411489298704630593e-18_rk, -6.309401076758502924e-01_rk,-4.356854715881259369e-17_rk, &
                                        9.431015367635587606e-18_rk, 3.175476201461265602e-17_rk, -1.527334991828009971e-17_rk,-1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -5.333333333333334370e-01_rk, -2.634142078416084129e-17_rk, -5.436708649316556085e-18_rk,1.798113126489027454e-17_rk, &
                                        -7.551784093395256566e-18_rk, -1.429062359632655155e-01_rk, 7.223993373265750045e-17_rk,5.055125522554710296e-17_rk, &
                                        -1.870144879343938245e-17_rk, -2.083864969649551620e-17_rk, -1.990427097370067733e+00_rk,-5.669516360222990704e-17_rk, &
                                        -1.417024899325573641e-17_rk, 3.663943044997682995e-19_rk, 7.917198895013747169e-18_rk,-5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -3.381197846482996566e-02_rk, -6.030747429509174965e-18_rk, 7.633822220112337992e-18_rk,5.929700419293071241e-18_rk, &
                                        -6.030747429509175736e-18_rk, -3.381197846482996566e-02_rk, 5.929700419293071241e-18_rk,7.633822220112337992e-18_rk, &
                                        5.327829384763377804e-19_rk, -4.525795205506880455e-18_rk, -1.261880215351700307e-01_rk,-5.737631985909362637e-18_rk, &
                                        -4.525795205506880455e-18_rk, 5.327829384763376841e-19_rk, -5.737631985909362637e-18_rk,-1.261880215351700307e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.690598923241497797e-01_rk, -1.527334991828009971e-17_rk, 3.175476201461265602e-17_rk,9.431015367635593769e-18_rk, &
                                        -4.356854715881259986e-17_rk, -6.309401076758502924e-01_rk, -2.411489298704633674e-18_rk,9.078263778330721497e-18_rk, &
                                        3.175476201461265602e-17_rk, 9.431015367635587606e-18_rk, -1.690598923241498075e-01_rk,-1.527334991828009971e-17_rk, &
                                        -2.411489298704635215e-18_rk, 9.078263778330719956e-18_rk, -4.356854715881258753e-17_rk,-6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -1.429062359632655155e-01_rk, -7.551784093395253485e-18_rk, 5.055125522554710296e-17_rk,7.223993373265751277e-17_rk, &
                                        -2.634142078416085361e-17_rk, -5.333333333333334370e-01_rk, 1.798113126489027454e-17_rk,-5.436708649316556085e-18_rk, &
                                        3.663943044997652180e-19_rk, -1.417024899325573949e-17_rk, -5.333333333333334370e-01_rk,7.917198895013745628e-18_rk, &
                                        -2.083864969649552545e-17_rk, -1.870144879343937628e-17_rk, -5.669516360222990704e-17_rk,-1.990427097370067733e+00_rk  &
                                        /),(/4,4/))
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face6_dx
        ! 
        test_dbr2_face_face6_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.261880215351700307e-01_rk, 5.737631985909361866e-18_rk, -5.327829384763377804e-19_rk,4.525795205506880455e-18_rk, &
                                        5.737631985909362637e-18_rk, 1.261880215351700307e-01_rk, 4.525795205506878914e-18_rk,-5.327829384763377804e-19_rk, &
                                        -7.633822220112339533e-18_rk, -5.929700419293071241e-18_rk, 3.381197846482993791e-02_rk,6.030747429509175736e-18_rk, &
                                        -5.929700419293069700e-18_rk, -7.633822220112339533e-18_rk, 6.030747429509174195e-18_rk,3.381197846482993791e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,1,2) = reshape((/                                                                                 &
                                        6.309401076758502924e-01_rk, 4.356854715881258753e-17_rk, -9.078263778330716874e-18_rk,2.411489298704633674e-18_rk, &
                                        1.527334991828009663e-17_rk, 1.690598923241498075e-01_rk, -9.431015367635592228e-18_rk,-3.175476201461265602e-17_rk, &
                                        -9.078263778330721497e-18_rk, 2.411489298704629052e-18_rk, 6.309401076758502924e-01_rk,4.356854715881258753e-17_rk, &
                                        -9.431015367635587606e-18_rk, -3.175476201461265602e-17_rk, 1.527334991828009663e-17_rk,1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.990427097370067733e+00_rk, 5.669516360222990704e-17_rk, 1.870144879343937628e-17_rk,2.083864969649553161e-17_rk, &
                                        -7.917198895013748709e-18_rk, 5.333333333333334370e-01_rk, 1.417024899325573024e-17_rk,-3.663943044997575143e-19_rk, &
                                        5.436708649316554544e-18_rk, -1.798113126489028070e-17_rk, 5.333333333333334370e-01_rk,2.634142078416084437e-17_rk, &
                                        -7.223993373265750045e-17_rk, -5.055125522554710913e-17_rk, 7.551784093395253485e-18_rk,1.429062359632655155e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.261880215351700307e-01_rk, -5.737631985909361866e-18_rk, 5.327829384763377804e-19_rk,-4.525795205506880455e-18_rk, &
                                        -5.737631985909362637e-18_rk, -1.261880215351700307e-01_rk, -4.525795205506878914e-18_rk,5.327829384763377804e-19_rk, &
                                        7.633822220112339533e-18_rk, 5.929700419293071241e-18_rk, -3.381197846482993791e-02_rk,-6.030747429509175736e-18_rk, &
                                        5.929700419293069700e-18_rk, 7.633822220112339533e-18_rk, -6.030747429509174195e-18_rk,-3.381197846482993791e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,2) = reshape((/                                                                                 &
                                        1.690598923241498075e-01_rk, 1.527334991828009971e-17_rk, -3.175476201461265602e-17_rk,-9.431015367635586065e-18_rk, &
                                        4.356854715881258753e-17_rk, 6.309401076758502924e-01_rk, 2.411489298704632134e-18_rk,-9.078263778330727660e-18_rk, &
                                        -3.175476201461264986e-17_rk, -9.431015367635586065e-18_rk, 1.690598923241498075e-01_rk,1.527334991828009663e-17_rk, &
                                        2.411489298704630593e-18_rk, -9.078263778330724578e-18_rk, 4.356854715881258753e-17_rk,6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,3) = reshape((/                                                                                 &
                                        5.333333333333334370e-01_rk, -7.917198895013747169e-18_rk, -3.663943044997682995e-19_rk,1.417024899325574257e-17_rk, &
                                        5.669516360222989471e-17_rk, 1.990427097370067733e+00_rk, 2.083864969649552545e-17_rk,1.870144879343937628e-17_rk, &
                                        -5.055125522554710296e-17_rk, -7.223993373265750045e-17_rk, 1.429062359632655155e-01_rk,7.551784093395256566e-18_rk, &
                                        -1.798113126489027762e-17_rk, 5.436708649316554544e-18_rk, 2.634142078416084129e-17_rk,5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,1) = reshape((/                                                                                 &
                                        3.381197846482993791e-02_rk, 6.030747429509174965e-18_rk, -7.633822220112339533e-18_rk,-5.929700419293069700e-18_rk, &
                                        6.030747429509174195e-18_rk, 3.381197846482993791e-02_rk, -5.929700419293071241e-18_rk,-7.633822220112337992e-18_rk, &
                                        -5.327829384763376841e-19_rk, 4.525795205506879684e-18_rk, 1.261880215351700307e-01_rk,5.737631985909363407e-18_rk, &
                                        4.525795205506880455e-18_rk, -5.327829384763377804e-19_rk, 5.737631985909362637e-18_rk,1.261880215351700307e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -6.309401076758502924e-01_rk, -4.356854715881258753e-17_rk, 9.078263778330716874e-18_rk,-2.411489298704633674e-18_rk, &
                                        -1.527334991828009663e-17_rk, -1.690598923241498075e-01_rk, 9.431015367635592228e-18_rk,3.175476201461265602e-17_rk, &
                                        9.078263778330721497e-18_rk, -2.411489298704629052e-18_rk, -6.309401076758502924e-01_rk,-4.356854715881258753e-17_rk, &
                                        9.431015367635587606e-18_rk, 3.175476201461265602e-17_rk, -1.527334991828009663e-17_rk,-1.690598923241498075e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,3) = reshape((/                                                                                 &
                                        5.333333333333334370e-01_rk, 2.634142078416083821e-17_rk, 5.436708649316559166e-18_rk,-1.798113126489028070e-17_rk, &
                                        7.551784093395256566e-18_rk, 1.429062359632655155e-01_rk, -7.223993373265751277e-17_rk,-5.055125522554710913e-17_rk, &
                                        1.870144879343937628e-17_rk, 2.083864969649551929e-17_rk, 1.990427097370067733e+00_rk,5.669516360222989471e-17_rk, &
                                        1.417024899325573949e-17_rk, -3.663943044997652180e-19_rk, -7.917198895013745628e-18_rk,5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -3.381197846482993791e-02_rk, -6.030747429509174965e-18_rk, 7.633822220112339533e-18_rk,5.929700419293069700e-18_rk, &
                                        -6.030747429509174195e-18_rk, -3.381197846482993791e-02_rk, 5.929700419293071241e-18_rk,7.633822220112337992e-18_rk, &
                                        5.327829384763376841e-19_rk, -4.525795205506879684e-18_rk, -1.261880215351700307e-01_rk,-5.737631985909363407e-18_rk, &
                                        -4.525795205506880455e-18_rk, 5.327829384763377804e-19_rk, -5.737631985909362637e-18_rk,-1.261880215351700307e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -1.690598923241498075e-01_rk, -1.527334991828009971e-17_rk, 3.175476201461265602e-17_rk,9.431015367635586065e-18_rk, &
                                        -4.356854715881258753e-17_rk, -6.309401076758502924e-01_rk, -2.411489298704632134e-18_rk,9.078263778330727660e-18_rk, &
                                        3.175476201461264986e-17_rk, 9.431015367635586065e-18_rk, -1.690598923241498075e-01_rk,-1.527334991828009663e-17_rk, &
                                        -2.411489298704630593e-18_rk, 9.078263778330724578e-18_rk, -4.356854715881258753e-17_rk,-6.309401076758502924e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,3) = reshape((/                                                                                 &
                                        1.429062359632655155e-01_rk, 7.551784093395255026e-18_rk, -5.055125522554710913e-17_rk,-7.223993373265751277e-17_rk, &
                                        2.634142078416084437e-17_rk, 5.333333333333334370e-01_rk, -1.798113126489027454e-17_rk,5.436708649316551462e-18_rk, &
                                        -3.663943044997636772e-19_rk, 1.417024899325573641e-17_rk, 5.333333333333334370e-01_rk,-7.917198895013748709e-18_rk, &
                                        2.083864969649551620e-17_rk, 1.870144879343937012e-17_rk, 5.669516360222990704e-17_rk,1.990427097370067733e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,1) = reshape((/                                                                                 &
                                        3.785640646055101755e-01_rk, 4.017960955533867796e-18_rk, 4.199793836264260494e-18_rk,2.475984532443372687e-18_rk, &
                                        4.017960955533867796e-18_rk, 3.785640646055101755e-01_rk, 2.475984532443371916e-18_rk,4.199793836264259724e-18_rk, &
                                        -1.389087095133772077e-18_rk, -1.211451258021648499e-17_rk, 1.014359353944898068e-01_rk,7.478935460020454147e-19_rk, &
                                        -1.211451258021648653e-17_rk, -1.389087095133772269e-18_rk, 7.478935460020448369e-19_rk,1.014359353944898068e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,2) = reshape((/                                                                                 &
                                        1.892820323027550877e+00_rk, 3.946803722757815771e-17_rk, 3.321642122108664924e-17_rk,4.460291329006141537e-19_rk, &
                                        -1.563876471989858877e-17_rk, 5.071796769724490339e-01_rk, -4.863866937176618722e-17_rk,-1.916288751543420908e-17_rk, &
                                        3.321642122108665541e-17_rk, 4.460291329006126130e-19_rk, 1.892820323027550877e+00_rk,3.946803722757815771e-17_rk, &
                                        -4.863866937176618106e-17_rk, -1.916288751543421524e-17_rk, -1.563876471989858877e-17_rk,5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.990427097370067733e+00_rk, -5.669516360222990704e-17_rk, -1.870144879343937628e-17_rk,-2.083864969649553161e-17_rk, &
                                        7.917198895013748709e-18_rk, -5.333333333333334370e-01_rk, -1.417024899325573024e-17_rk,3.663943044997575143e-19_rk, &
                                        -5.436708649316554544e-18_rk, 1.798113126489028070e-17_rk, -5.333333333333334370e-01_rk,-2.634142078416084437e-17_rk, &
                                        7.223993373265750045e-17_rk, 5.055125522554710913e-17_rk, -7.551784093395253485e-18_rk,-1.429062359632655155e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -3.785640646055101755e-01_rk, -4.017960955533867796e-18_rk, -4.199793836264260494e-18_rk,-2.475984532443372687e-18_rk, &
                                        -4.017960955533867796e-18_rk, -3.785640646055101755e-01_rk, -2.475984532443371916e-18_rk,-4.199793836264259724e-18_rk, &
                                        1.389087095133772077e-18_rk, 1.211451258021648499e-17_rk, -1.014359353944898068e-01_rk,-7.478935460020454147e-19_rk, &
                                        1.211451258021648653e-17_rk, 1.389087095133772269e-18_rk, -7.478935460020448369e-19_rk,-1.014359353944898068e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,2) = reshape((/                                                                                 &
                                        5.071796769724490339e-01_rk, -1.563876471989859185e-17_rk, -1.916288751543421832e-17_rk,-4.863866937176618106e-17_rk, &
                                        3.946803722757815771e-17_rk, 1.892820323027550877e+00_rk, 4.460291329006126130e-19_rk,3.321642122108665541e-17_rk, &
                                        -1.916288751543421524e-17_rk, -4.863866937176618106e-17_rk, 5.071796769724490339e-01_rk,-1.563876471989858877e-17_rk, &
                                        4.460291329006110722e-19_rk, 3.321642122108665541e-17_rk, 3.946803722757815771e-17_rk,1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -5.333333333333334370e-01_rk, 7.917198895013747169e-18_rk, 3.663943044997682995e-19_rk,-1.417024899325574257e-17_rk, &
                                        -5.669516360222989471e-17_rk, -1.990427097370067733e+00_rk, -2.083864969649552545e-17_rk,-1.870144879343937628e-17_rk, &
                                        5.055125522554710296e-17_rk, 7.223993373265750045e-17_rk, -1.429062359632655155e-01_rk,-7.551784093395256566e-18_rk, &
                                        1.798113126489027762e-17_rk, -5.436708649316554544e-18_rk, -2.634142078416084129e-17_rk,-5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.014359353944898068e-01_rk, 7.478935460020444518e-19_rk, -1.389087095133772269e-18_rk,-1.211451258021648653e-17_rk, &
                                        7.478935460020456073e-19_rk, 1.014359353944898068e-01_rk, -1.211451258021648807e-17_rk,-1.389087095133771884e-18_rk, &
                                        4.199793836264260494e-18_rk, 2.475984532443372687e-18_rk, 3.785640646055101755e-01_rk,4.017960955533869337e-18_rk, &
                                        2.475984532443371916e-18_rk, 4.199793836264260494e-18_rk, 4.017960955533867796e-18_rk,3.785640646055101755e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -1.892820323027550877e+00_rk, -3.946803722757815771e-17_rk, -3.321642122108664924e-17_rk,-4.460291329006141537e-19_rk, &
                                        1.563876471989858877e-17_rk, -5.071796769724490339e-01_rk, 4.863866937176618722e-17_rk,1.916288751543420908e-17_rk, &
                                        -3.321642122108665541e-17_rk, -4.460291329006126130e-19_rk, -1.892820323027550877e+00_rk,-3.946803722757815771e-17_rk, &
                                        4.863866937176618106e-17_rk, 1.916288751543421524e-17_rk, 1.563876471989858877e-17_rk,-5.071796769724490339e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -5.333333333333334370e-01_rk, -2.634142078416083821e-17_rk, -5.436708649316559166e-18_rk,1.798113126489028070e-17_rk, &
                                        -7.551784093395256566e-18_rk, -1.429062359632655155e-01_rk, 7.223993373265751277e-17_rk,5.055125522554710913e-17_rk, &
                                        -1.870144879343937628e-17_rk, -2.083864969649551929e-17_rk, -1.990427097370067733e+00_rk,-5.669516360222989471e-17_rk, &
                                        -1.417024899325573949e-17_rk, 3.663943044997652180e-19_rk, 7.917198895013745628e-18_rk,-5.333333333333334370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.014359353944898068e-01_rk, -7.478935460020444518e-19_rk, 1.389087095133772269e-18_rk,1.211451258021648653e-17_rk, &
                                        -7.478935460020456073e-19_rk, -1.014359353944898068e-01_rk, 1.211451258021648807e-17_rk,1.389087095133771884e-18_rk, &
                                        -4.199793836264260494e-18_rk, -2.475984532443372687e-18_rk, -3.785640646055101755e-01_rk,-4.017960955533869337e-18_rk, &
                                        -2.475984532443371916e-18_rk, -4.199793836264260494e-18_rk, -4.017960955533867796e-18_rk,-3.785640646055101755e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -5.071796769724490339e-01_rk, 1.563876471989859185e-17_rk, 1.916288751543421832e-17_rk,4.863866937176618106e-17_rk, &
                                        -3.946803722757815771e-17_rk, -1.892820323027550877e+00_rk, -4.460291329006126130e-19_rk,-3.321642122108665541e-17_rk, &
                                        1.916288751543421524e-17_rk, 4.863866937176618106e-17_rk, -5.071796769724490339e-01_rk,1.563876471989858877e-17_rk, &
                                        -4.460291329006110722e-19_rk, -3.321642122108665541e-17_rk, -3.946803722757815771e-17_rk,-1.892820323027550877e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -1.429062359632655155e-01_rk, -7.551784093395255026e-18_rk, 5.055125522554710913e-17_rk,7.223993373265751277e-17_rk, &
                                        -2.634142078416084437e-17_rk, -5.333333333333334370e-01_rk, 1.798113126489027454e-17_rk,-5.436708649316551462e-18_rk, &
                                        3.663943044997636772e-19_rk, -1.417024899325573641e-17_rk, -5.333333333333334370e-01_rk,7.917198895013748709e-18_rk, &
                                        -2.083864969649551620e-17_rk, -1.870144879343937012e-17_rk, -5.669516360222990704e-17_rk,-1.990427097370067733e+00_rk  &
                                        /),(/4,4/))
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do
    
    
    
    
    
    
    
    
    
    end subroutine testElement_dbr2_face_dx
    !*******************************************************************************************






    !> Test face dmetrics_dx
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dmetrics_dx_ximin(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        real(rk)    :: test_dmetric_dx_ximin(3,3,self%faces(XI_MIN)%basis_s%nnodes_face(),self%elem%nterms_c,3)
        real(rk)    :: tol
        
        integer(ik)     :: inode_diff, idir, inode, irow
        
        tol = 1.e-14_rk
        
        test_dmetric_dx_ximin(:,:,1,1,1) = reshape((/                                                                                 &
                                        4.976067743425191536e-02_rk, 3.154700538379249242e-01_rk, 3.154700538379248687e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-15_rk, 1.082467449009528095e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.082467449009528095e-16_rk, 9.992007221626408864e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.577350269189625953e+00_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584943e-01_rk, 1.577350269189625731e+00_rk, 1.577350269189625731e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,2,1) = reshape((/                                                                                 &
                                        -4.976067743425169332e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,3,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -3.154700538379249242e-01_rk, 8.452994616207523682e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -1.595945597898663020e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.082467449009528095e-16_rk, 8.326672684688674053e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666665186e-02_rk, -1.577350269189625953e+00_rk, 4.226497308103740469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,3,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666666574e-02_rk, -1.577350269189625731e+00_rk, 4.226497308103741024e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,4,1) = reshape((/                                                                                 &
                                        -1.333333333333334286e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666666574e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,5,1) = reshape((/                                                                                 &
                                        1.333333333333335674e-02_rk, 8.452994616207525069e-02_rk, -3.154700538379248687e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, -1.082467449009528095e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.595945597898663020e-17_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666665186e-02_rk, 4.226497308103740469e-01_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666666574e-02_rk, 4.226497308103740469e-01_rk, -1.577350269189625731e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,6,1) = reshape((/                                                                                 &
                                        -1.333333333333334286e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666666574e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,7,1) = reshape((/                                                                                 &
                                        3.572655899081634764e-03_rk, -8.452994616207525069e-02_rk, -8.452994616207523682e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 1.595945597898663020e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.595945597898663020e-17_rk, 2.081668171172168513e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540816515e-02_rk, -4.226497308103740469e-01_rk, -4.226497308103740469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,7,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540816515e-02_rk, -4.226497308103740469e-01_rk, -4.226497308103741024e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,8,1) = reshape((/                                                                                 &
                                        -3.572655899081634764e-03_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,1,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,1,1) = reshape((/                                                                                 &
                                        1.333333333333352327e-02_rk, 3.154700538379249242e-01_rk, 8.452994616207523682e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.881784197001252323e-16_rk, 1.082467449009528095e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625157033e-16_rk, 8.326672684688674053e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666665186e-02_rk, 1.577350269189625953e+00_rk, 4.226497308103740469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,1,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666666574e-02_rk, 1.577350269189625731e+00_rk, 4.226497308103741024e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,2,1) = reshape((/                                                                                 &
                                        -1.333333333333334286e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666666574e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,3,1) = reshape((/                                                                                 &
                                        4.976067743425169332e-02_rk, -3.154700538379249242e-01_rk, 3.154700538379248687e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 8.104628079763645506e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625157033e-16_rk, 8.326672684688674053e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.577350269189625953e+00_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584943e-01_rk, -1.577350269189625731e+00_rk, 1.577350269189625731e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,4,1) = reshape((/                                                                                 &
                                        -4.976067743425169332e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,5,1) = reshape((/                                                                                 &
                                        3.572655899081652112e-03_rk, 8.452994616207525069e-02_rk, -8.452994616207523682e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -1.082467449009528095e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.665334536937735365e-17_rk, 2.081668171172168513e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540816515e-02_rk, 4.226497308103740469e-01_rk, -4.226497308103740469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,5,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540816515e-02_rk, 4.226497308103740469e-01_rk, -4.226497308103741024e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,6,1) = reshape((/                                                                                 &
                                        -3.572655899081634764e-03_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,7,1) = reshape((/                                                                                 &
                                        1.333333333333334286e-02_rk, -8.452994616207525069e-02_rk, -3.154700538379248687e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -8.104628079763645506e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.665334536937735365e-17_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666665186e-02_rk, -4.226497308103740469e-01_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666666574e-02_rk, -4.226497308103740469e-01_rk, -1.577350269189625731e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,8,1) = reshape((/                                                                                 &
                                        -1.333333333333334286e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,2,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666666574e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,1,1) = reshape((/                                                                                 &
                                        1.333333333333335674e-02_rk, 8.452994616207525069e-02_rk, 3.154700538379248687e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 1.110223024625157033e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.082467449009528095e-16_rk, 8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666665186e-02_rk, 4.226497308103740469e-01_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666666574e-02_rk, 4.226497308103740469e-01_rk, 1.577350269189625731e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,2,1) = reshape((/                                                                                 &
                                        -1.333333333333334286e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666666574e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,3,1) = reshape((/                                                                                 &
                                        3.572655899081634764e-03_rk, -8.452994616207525069e-02_rk, 8.452994616207523682e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, -1.665334536937735365e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.082467449009528095e-16_rk, 1.040834085586084257e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540816515e-02_rk, -4.226497308103740469e-01_rk, 4.226497308103740469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,3,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540816515e-02_rk, -4.226497308103740469e-01_rk, 4.226497308103741024e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,4,1) = reshape((/                                                                                 &
                                        -3.572655899081634764e-03_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,5,1) = reshape((/                                                                                 &
                                        4.976067743425188761e-02_rk, 3.154700538379249242e-01_rk, -3.154700538379248687e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.992007221626408864e-16_rk, -1.110223024625157033e-16_rk, &
                                        0.000000000000000000e+00_rk, 8.104628079763645506e-16_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.577350269189625953e+00_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584943e-01_rk, 1.577350269189625731e+00_rk, -1.577350269189625731e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,6,1) = reshape((/                                                                                 &
                                        -4.976067743425169332e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,7,1) = reshape((/                                                                                 &
                                        1.333333333333334286e-02_rk, -3.154700538379249242e-01_rk, -8.452994616207523682e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 1.665334536937735365e-17_rk, &
                                        0.000000000000000000e+00_rk, -8.104628079763645506e-16_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666665186e-02_rk, -1.577350269189625953e+00_rk, -4.226497308103740469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,7,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666666574e-02_rk, -1.577350269189625731e+00_rk, -4.226497308103741024e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,8,1) = reshape((/                                                                                 &
                                        -1.333333333333334286e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,3,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666666574e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,1,1) = reshape((/                                                                                 &
                                        3.572655899081652112e-03_rk, 8.452994616207525069e-02_rk, 8.452994616207523682e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.040834085586084257e-16_rk, 1.110223024625157033e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625157033e-16_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540816515e-02_rk, 4.226497308103740469e-01_rk, 4.226497308103740469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,1,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540816515e-02_rk, 4.226497308103740469e-01_rk, 4.226497308103741024e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,2,1) = reshape((/                                                                                 &
                                        -3.572655899081634764e-03_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,3,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -8.452994616207525069e-02_rk, 3.154700538379248687e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.993605777301130246e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625157033e-16_rk, 8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666665186e-02_rk, -4.226497308103740469e-01_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666666574e-02_rk, -4.226497308103740469e-01_rk, 1.577350269189625731e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,4,1) = reshape((/                                                                                 &
                                        -1.333333333333334286e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666666574e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,5,1) = reshape((/                                                                                 &
                                        1.333333333333352327e-02_rk, 3.154700538379249242e-01_rk, -8.452994616207523682e-02_rk, &
                                        0.000000000000000000e+00_rk, 9.159339953157541458e-16_rk, -1.110223024625157033e-16_rk, &
                                        0.000000000000000000e+00_rk, 7.993605777301130246e-16_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666665186e-02_rk, 1.577350269189625953e+00_rk, -4.226497308103740469e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,5,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666666574e-02_rk, 1.577350269189625731e+00_rk, -4.226497308103741024e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,6,1) = reshape((/                                                                                 &
                                        -1.333333333333334286e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666666574e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,7,1) = reshape((/                                                                                 &
                                        4.976067743425169332e-02_rk, -3.154700538379249242e-01_rk, -3.154700538379248687e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -7.993605777301130246e-16_rk, &
                                        0.000000000000000000e+00_rk, -7.993605777301130246e-16_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.577350269189625953e+00_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584943e-01_rk, -1.577350269189625731e+00_rk, -1.577350269189625731e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,8,1) = reshape((/                                                                                 &
                                        -4.976067743425169332e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_ximin(:,:,4,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        
        do inode = 1,self%elem%basis_s%nnodes_face()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx_ximin(:,:,inode,inode_diff,idir)),self%faces(XI_MIN)%dmetric_dx(:,:,inode,inode_diff,idir),tol)
                end do
            end do
        end do

    end subroutine testElement_face_dmetrics_dx_ximin
    !*******************************************************************************************








    !> Test cartesian face dgrad_dx  
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dgrad_dx_ximin(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode, irow
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425191536e-02_rk,-2.872934051172350289e-02_rk,-2.872934051172350289e-02_rk,0.000000000000000000e+00_rk,1.658689247808391165e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333352327e-02_rk,7.698003589195118179e-03_rk,-7.698003589195118179e-03_rk,0.000000000000000000e+00_rk,-4.444444444444514697e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333335674e-02_rk,-7.698003589195021035e-03_rk,7.698003589195021035e-03_rk,0.000000000000000000e+00_rk,-4.444444444444459186e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081652112e-03_rk,2.062673845056700074e-03_rk,2.062673845056700074e-03_rk,0.000000000000000000e+00_rk,1.190885299693885627e-03_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,-1.436467025586168067e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,-3.849001794597505660e-02_rk,3.849001794597508436e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666663799e-02_rk,-1.387778780781445676e-17_rk,3.849001794597505660e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540817903e-02_rk,-1.387778780781445676e-17_rk,1.031336922528342838e-02_rk,-1.031336922528343532e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584943e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584943e-01_rk,-1.436467025586168067e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666666574e-02_rk,-1.387778780781445676e-17_rk,-6.938893903907228378e-18_rk,-6.666666666666665186e-02_rk,3.849001794597505660e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666666574e-02_rk,-3.849001794597505660e-02_rk,3.849001794597507048e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540816515e-02_rk,-1.387778780781445676e-17_rk,-6.938893903907228378e-18_rk,-1.786327949540817209e-02_rk,1.031336922528343011e-02_rk,-1.031336922528343358e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425169332e-02_rk,2.872934051172336412e-02_rk,2.872934051172336412e-02_rk,0.000000000000000000e+00_rk,-1.658689247808384226e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333334286e-02_rk,-7.698003589195014096e-03_rk,7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,4.444444444444450512e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333334286e-02_rk,7.698003589195014096e-03_rk,-7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,4.444444444444450512e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081634764e-03_rk,-2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878255e-03_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,1.436467025586168067e-01_rk,-1.436467025586168067e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,3.849001794597505660e-02_rk,-3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,-3.849001794597505660e-02_rk,3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540816515e-02_rk,0.000000000000000000e+00_rk,-1.031336922528342838e-02_rk,1.031336922528342838e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584943e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584943e-01_rk,1.436467025586168067e-01_rk,-1.436467025586168067e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666666574e-02_rk,-3.849001794597505660e-02_rk,3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666666574e-02_rk,3.849001794597505660e-02_rk,-3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540816515e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540816515e-02_rk,-1.031336922528343011e-02_rk,1.031336922528343011e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195014096e-03_rk,-7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,4.444444444444452247e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425169332e-02_rk,2.872934051172337799e-02_rk,-2.872934051172337799e-02_rk,0.000000000000000000e+00_rk,-1.658689247808385614e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081634764e-03_rk,-2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693879556e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444450512e-03_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,-3.849001794597505660e-02_rk,3.849001794597508436e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,-1.436467025586168067e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540817903e-02_rk,1.387778780781445676e-17_rk,1.031336922528342838e-02_rk,-1.031336922528343532e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666663799e-02_rk,1.387778780781445676e-17_rk,3.849001794597505660e-02_rk,-3.849001794597504966e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666666574e-02_rk,-1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,-6.666666666666665186e-02_rk,-3.849001794597505660e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584943e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584943e-01_rk,1.436467025586168067e-01_rk,-1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540816515e-02_rk,-1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,-1.786327949540817209e-02_rk,-1.031336922528343011e-02_rk,1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666666574e-02_rk,3.849001794597505660e-02_rk,-3.849001794597507048e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333334286e-02_rk,7.698003589195014096e-03_rk,7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,-4.444444444444450512e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425169332e-02_rk,-2.872934051172336412e-02_rk,2.872934051172336412e-02_rk,0.000000000000000000e+00_rk,1.658689247808384226e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081634764e-03_rk,2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878255e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333334286e-02_rk,-7.698003589195014096e-03_rk,-7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,-4.444444444444450512e-03_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,3.849001794597505660e-02_rk,-3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,1.436467025586168067e-01_rk,-1.436467025586168067e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540816515e-02_rk,0.000000000000000000e+00_rk,-1.031336922528342838e-02_rk,1.031336922528342838e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,-3.849001794597505660e-02_rk,3.849001794597505660e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666666574e-02_rk,3.849001794597505660e-02_rk,-3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584943e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584943e-01_rk,-1.436467025586168067e-01_rk,1.436467025586168067e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540816515e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540816515e-02_rk,1.031336922528343011e-02_rk,-1.031336922528343011e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666666574e-02_rk,-3.849001794597505660e-02_rk,3.849001794597505660e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333335674e-02_rk,-7.698003589195024504e-03_rk,-7.698003589195024504e-03_rk,0.000000000000000000e+00_rk,4.444444444444459186e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081652112e-03_rk,2.062673845056699207e-03_rk,-2.062673845056699207e-03_rk,0.000000000000000000e+00_rk,-1.190885299693884760e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425188761e-02_rk,-2.872934051172348902e-02_rk,2.872934051172348902e-02_rk,0.000000000000000000e+00_rk,-1.658689247808391165e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333352327e-02_rk,7.698003589195121649e-03_rk,7.698003589195121649e-03_rk,0.000000000000000000e+00_rk,4.444444444444512962e-03_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666663799e-02_rk,1.387778780781445676e-17_rk,-3.849001794597505660e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540817903e-02_rk,1.387778780781445676e-17_rk,-1.031336922528342838e-02_rk,1.031336922528343532e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,1.436467025586168067e-01_rk,-1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,3.849001794597505660e-02_rk,-3.849001794597508436e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666666574e-02_rk,-3.849001794597505660e-02_rk,3.849001794597507048e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540816515e-02_rk,1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,-1.786327949540817209e-02_rk,1.031336922528343011e-02_rk,-1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584943e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584943e-01_rk,-1.436467025586168067e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666666574e-02_rk,1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,-6.666666666666665186e-02_rk,3.849001794597505660e-02_rk,-3.849001794597504966e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333334286e-02_rk,7.698003589195014096e-03_rk,7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,-4.444444444444450512e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081634764e-03_rk,-2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878255e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425169332e-02_rk,2.872934051172336412e-02_rk,-2.872934051172336412e-02_rk,0.000000000000000000e+00_rk,1.658689247808384226e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333334286e-02_rk,-7.698003589195014096e-03_rk,-7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,-4.444444444444450512e-03_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,3.849001794597505660e-02_rk,-3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540816515e-02_rk,0.000000000000000000e+00_rk,1.031336922528342838e-02_rk,-1.031336922528342838e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,-1.436467025586168067e-01_rk,1.436467025586168067e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,-3.849001794597505660e-02_rk,3.849001794597505660e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666666574e-02_rk,3.849001794597505660e-02_rk,-3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540816515e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540816515e-02_rk,-1.031336922528343011e-02_rk,1.031336922528343011e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584943e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584943e-01_rk,1.436467025586168067e-01_rk,-1.436467025586168067e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666666574e-02_rk,-3.849001794597505660e-02_rk,3.849001794597505660e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081634764e-03_rk,-2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878255e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333334286e-02_rk,7.698003589195014096e-03_rk,-7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,-4.444444444444450512e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333334286e-02_rk,-7.698003589195014096e-03_rk,7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,-4.444444444444450512e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425169332e-02_rk,2.872934051172336412e-02_rk,2.872934051172336412e-02_rk,0.000000000000000000e+00_rk,1.658689247808384226e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540817903e-02_rk,-1.387778780781445676e-17_rk,-1.031336922528342838e-02_rk,1.031336922528343532e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666663799e-02_rk,-1.387778780781445676e-17_rk,-3.849001794597505660e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,3.849001794597505660e-02_rk,-3.849001794597508436e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,1.436467025586168067e-01_rk,-1.436467025586167789e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540816515e-02_rk,1.387778780781445676e-17_rk,-6.938893903907228378e-18_rk,-1.786327949540817209e-02_rk,-1.031336922528343011e-02_rk,1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666666574e-02_rk,3.849001794597505660e-02_rk,-3.849001794597507048e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666666574e-02_rk,1.387778780781445676e-17_rk,-6.938893903907228378e-18_rk,-6.666666666666665186e-02_rk,-3.849001794597505660e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584943e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584943e-01_rk,1.436467025586168067e-01_rk,-1.436467025586167789e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081634764e-03_rk,2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878255e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333334286e-02_rk,-7.698003589195014096e-03_rk,7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,4.444444444444450512e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333334286e-02_rk,7.698003589195014096e-03_rk,-7.698003589195014096e-03_rk,0.000000000000000000e+00_rk,4.444444444444450512e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425169332e-02_rk,-2.872934051172336412e-02_rk,-2.872934051172336412e-02_rk,0.000000000000000000e+00_rk,-1.658689247808384226e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.786327949540816515e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540816515e-02_rk,0.000000000000000000e+00_rk,1.031336922528342838e-02_rk,-1.031336922528342838e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,3.849001794597505660e-02_rk,-3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666665186e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666665186e-02_rk,0.000000000000000000e+00_rk,-3.849001794597505660e-02_rk,3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,-1.436467025586168067e-01_rk,1.436467025586168067e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540816515e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540816515e-02_rk,1.031336922528343011e-02_rk,-1.031336922528343011e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666666574e-02_rk,-3.849001794597505660e-02_rk,3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666666574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666666574e-02_rk,3.849001794597505660e-02_rk,-3.849001794597505660e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584943e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584943e-01_rk,-1.436467025586168067e-01_rk,1.436467025586168067e-01_rk  &
                                        /),(/8,4/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad2
        !

        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-15_rk, 1.082467449009528095e-16_rk,3.154700538379249242e-01_rk,-1.821367205045928694e-01_rk,-1.821367205045918702e-01_rk,-6.661338147750939243e-16_rk,1.051566846126422011e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.881784197001252323e-16_rk, 1.110223024625157033e-16_rk,3.154700538379249242e-01_rk,1.821367205045908710e-01_rk,-1.821367205045918702e-01_rk,-4.579669976578770729e-16_rk,-1.051566846126410770e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 1.082467449009528095e-16_rk,8.452994616207525069e-02_rk,-4.880338717125878856e-02_rk,4.880338717125862202e-02_rk,-1.387778780781445676e-17_rk,-2.817664872069170628e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.040834085586084257e-16_rk, 1.110223024625157033e-16_rk,8.452994616207525069e-02_rk,4.880338717125862896e-02_rk,4.880338717125862202e-02_rk,1.249000902703301108e-16_rk,2.817664872069159526e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.577350269189625953e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625953e+00_rk,0.000000000000000000e+00_rk,-9.106836025229595455e-01_rk,9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625953e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625953e+00_rk,0.000000000000000000e+00_rk,-9.106836025229595455e-01_rk,9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,-1.577350269189625731e+00_rk,-9.106836025229595455e-01_rk,9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,-4.226497308103740469e-01_rk,-2.440169358562923052e-01_rk,2.440169358562923052e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -1.082467449009528095e-16_rk,-3.154700538379249242e-01_rk,1.821367205045917870e-01_rk,1.821367205045918702e-01_rk,8.326672684688674053e-17_rk,-1.051566846126416183e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -1.110223024625157033e-16_rk,-3.154700538379249242e-01_rk,-1.821367205045918702e-01_rk,1.821367205045918702e-01_rk,-1.110223024625156540e-16_rk,1.051566846126416460e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, -1.082467449009528095e-16_rk,-8.452994616207525069e-02_rk,4.880338717125870529e-02_rk,-4.880338717125862202e-02_rk,7.285838599102589797e-17_rk,2.817664872069164730e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625157033e-16_rk,-8.452994616207525069e-02_rk,-4.880338717125873305e-02_rk,-4.880338717125862202e-02_rk,-6.938893903907228378e-17_rk,-2.817664872069165077e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.577350269189625953e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625953e+00_rk,0.000000000000000000e+00_rk,9.106836025229595455e-01_rk,-9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625953e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625953e+00_rk,0.000000000000000000e+00_rk,9.106836025229595455e-01_rk,-9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,1.577350269189625731e+00_rk,-9.106836025229595455e-01_rk,9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, -4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,4.226497308103740469e-01_rk,-2.440169358562923052e-01_rk,2.440169358562923052e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, -1.595945597898663020e-17_rk,8.452994616207525069e-02_rk,-4.880338717125878856e-02_rk,-4.880338717125871917e-02_rk,-2.775557561562891351e-17_rk,2.817664872069174792e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -1.665334536937735365e-17_rk,8.452994616207525069e-02_rk,4.880338717125862202e-02_rk,-4.880338717125871917e-02_rk,-7.285838599102589797e-17_rk,-2.817664872069164730e-02_rk, &
                                        0.000000000000000000e+00_rk, 9.992007221626408864e-16_rk, 8.104628079763645506e-16_rk,3.154700538379249242e-01_rk,-1.821367205045927584e-01_rk,1.821367205045909543e-01_rk,1.110223024625156540e-16_rk,-1.051566846126416460e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.159339953157541458e-16_rk, 7.993605777301130246e-16_rk,3.154700538379249242e-01_rk,1.821367205045908433e-01_rk,1.821367205045909543e-01_rk,1.013078509970455343e-15_rk,1.051566846126405219e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625953e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625953e+00_rk,0.000000000000000000e+00_rk,9.106836025229595455e-01_rk,-9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625953e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625953e+00_rk,0.000000000000000000e+00_rk,9.106836025229595455e-01_rk,-9.106836025229595455e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,2.220446049250313081e-16_rk,-4.226497308103740469e-01_rk,-2.440169358562923052e-01_rk,2.440169358562923052e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,2.220446049250313081e-16_rk,-1.577350269189625731e+00_rk,-9.106836025229595455e-01_rk,9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 1.595945597898663020e-17_rk,-8.452994616207525069e-02_rk,4.880338717125870529e-02_rk,4.880338717125871917e-02_rk,-1.734723475976807094e-17_rk,-2.817664872069170282e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 1.665334536937735365e-17_rk,-8.452994616207525069e-02_rk,-4.880338717125870529e-02_rk,4.880338717125871917e-02_rk,1.387778780781445676e-17_rk,2.817664872069170628e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -8.104628079763645506e-16_rk,-3.154700538379249242e-01_rk,1.821367205045917870e-01_rk,-1.821367205045909543e-01_rk,4.718447854656915297e-16_rk,1.051566846126410631e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -7.993605777301130246e-16_rk,-3.154700538379249242e-01_rk,-1.821367205045918702e-01_rk,-1.821367205045909543e-01_rk,-3.885780586188047891e-16_rk,-1.051566846126411464e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625953e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625953e+00_rk,0.000000000000000000e+00_rk,-9.106836025229595455e-01_rk,9.106836025229595455e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625953e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625953e+00_rk,0.000000000000000000e+00_rk,-9.106836025229595455e-01_rk,9.106836025229595455e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, -4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,2.220446049250313081e-16_rk,4.226497308103740469e-01_rk,-2.440169358562923052e-01_rk,2.440169358562923052e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,2.220446049250313081e-16_rk,1.577350269189625731e+00_rk,-9.106836025229595455e-01_rk,9.106836025229595455e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad3
        !

        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.082467449009528095e-16_rk, 9.992007221626408864e-16_rk,3.154700538379248687e-01_rk,-1.821367205045918425e-01_rk,-1.821367205045927307e-01_rk,-6.106226635438360972e-16_rk,1.051566846126421317e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.082467449009528095e-16_rk, 8.326672684688674053e-17_rk,8.452994616207523682e-02_rk,4.880338717125861508e-02_rk,-4.880338717125881631e-02_rk,-1.387778780781445676e-17_rk,-2.817664872069169935e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625157033e-16_rk, 8.881784197001252323e-16_rk,3.154700538379248687e-01_rk,-1.821367205045918425e-01_rk,1.821367205045908433e-01_rk,-4.579669976578770729e-16_rk,-1.051566846126410493e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625157033e-16_rk, 1.110223024625156540e-16_rk,8.452994616207523682e-02_rk,4.880338717125861508e-02_rk,4.880338717125861508e-02_rk,1.144917494144692682e-16_rk,2.817664872069159873e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229594345e-01_rk,9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924717e-01_rk,2.440169358562924717e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,-5.551115123125782702e-17_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk, 5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,-5.551115123125782702e-17_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,-9.106836025229594345e-01_rk,9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103741024e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103741024e-01_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,-9.106836025229594345e-01_rk,9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103741024e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103741024e-01_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk,1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.081668171172168513e-17_rk,3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.595945597898663020e-17_rk, 8.326672684688674053e-17_rk,8.452994616207523682e-02_rk,-4.880338717125871223e-02_rk,-4.880338717125881631e-02_rk,-2.775557561562891351e-17_rk,2.817664872069174098e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.104628079763645506e-16_rk, 8.326672684688674053e-16_rk,3.154700538379248687e-01_rk,1.821367205045909266e-01_rk,-1.821367205045925641e-01_rk,0.000000000000000000e+00_rk,-1.051566846126415211e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.665334536937735365e-17_rk, 1.040834085586084257e-16_rk,8.452994616207523682e-02_rk,-4.880338717125871223e-02_rk,4.880338717125861508e-02_rk,-5.898059818321144121e-17_rk,-2.817664872069165424e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.993605777301130246e-16_rk, 8.881784197001252323e-16_rk,3.154700538379248687e-01_rk,1.821367205045909266e-01_rk,1.821367205045908433e-01_rk,9.853229343548264296e-16_rk,1.051566846126405497e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924717e-01_rk,2.440169358562924717e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229594345e-01_rk,9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103740469e-01_rk, -5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,-4.226497308103740469e-01_rk,5.551115123125782702e-17_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, -5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,5.551115123125782702e-17_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103741024e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103741024e-01_rk,-2.440169358562924162e-01_rk,2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103741024e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103741024e-01_rk,-2.440169358562924162e-01_rk,2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk,1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.081668171172168513e-17_rk,-3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.082467449009528095e-16_rk, -2.775557561562891351e-17_rk,-3.154700538379248687e-01_rk,1.821367205045918425e-01_rk,1.821367205045917592e-01_rk,6.938893903907228378e-17_rk,-1.051566846126415905e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.082467449009528095e-16_rk, 2.081668171172168513e-17_rk,-8.452994616207523682e-02_rk,-4.880338717125861508e-02_rk,4.880338717125869835e-02_rk,5.898059818321144121e-17_rk,2.817664872069165424e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625157033e-16_rk, -5.551115123125782702e-17_rk,-3.154700538379248687e-01_rk,1.821367205045918425e-01_rk,-1.821367205045916760e-01_rk,0.000000000000000000e+00_rk,1.051566846126415211e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625157033e-16_rk, -2.775557561562891351e-17_rk,-8.452994616207523682e-02_rk,-4.880338717125861508e-02_rk,-4.880338717125870529e-02_rk,-8.326672684688674053e-17_rk,-2.817664872069162996e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,-5.551115123125782702e-17_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk, 5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,-5.551115123125782702e-17_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229594345e-01_rk,9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924717e-01_rk,2.440169358562924717e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103741024e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103741024e-01_rk,-2.440169358562924162e-01_rk,2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103741024e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103741024e-01_rk,-2.440169358562924162e-01_rk,2.440169358562924162e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk,1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.081668171172168513e-17_rk,3.469446951953614189e-18_rk,-3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.595945597898663020e-17_rk, 2.081668171172168513e-17_rk,-8.452994616207523682e-02_rk,4.880338717125871223e-02_rk,4.880338717125869835e-02_rk,-6.938893903907228378e-18_rk,-2.817664872069170628e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.104628079763645506e-16_rk, -2.775557561562891351e-17_rk,-3.154700538379248687e-01_rk,-1.821367205045909266e-01_rk,1.821367205045917592e-01_rk,4.579669976578770729e-16_rk,1.051566846126410631e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.665334536937735365e-17_rk, -2.775557561562891351e-17_rk,-8.452994616207523682e-02_rk,4.880338717125871223e-02_rk,-4.880338717125870529e-02_rk,2.775557561562891351e-17_rk,2.817664872069168547e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.993605777301130246e-16_rk, -5.551115123125782702e-17_rk,-3.154700538379248687e-01_rk,-1.821367205045909266e-01_rk,-1.821367205045916760e-01_rk,-5.551115123125782702e-16_rk,-1.051566846126409660e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk, -5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,5.551115123125782702e-17_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, -5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,5.551115123125782702e-17_rk,9.106836025229594345e-01_rk,-9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103740469e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103740469e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924717e-01_rk,2.440169358562924717e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229594345e-01_rk,9.106836025229594345e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103741024e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103741024e-01_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,-9.106836025229594345e-01_rk,9.106836025229594345e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103741024e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103741024e-01_rk,2.440169358562924162e-01_rk,-2.440169358562924162e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,-9.106836025229594345e-01_rk,9.106836025229594345e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.081668171172168513e-17_rk,-3.469446951953614189e-18_rk,3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk,1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_face_dgrad_dx_ximin
    !*******************************************************************************************








    !>  Test that the derivatives of the scaled normal vectors have been computed correctly. These are really
    !!  unit vectors scaled by the inverse jacobian of the face metric terms. Essentially,
    !!  an area scaling.
    !!
    !!  @author Matteo Ugolotti
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testelement_face_dnormals_dx(self)
        class(test_element_lineara_dx),    intent(inout)   :: self

        real(rk), dimension(3,self%faces(XI_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dnorm_dx
        integer(ik) :: inode_diff, idir, irow
        real(rk)    :: tol,mat(4,3)
        
        tol = 1.e-14_rk
        
        ! xi_min
         
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -1.249000902703301108e-16_rk, -1.971687836487029943e-01_rk, -1.971687836487029943e-01_rk, &
                                        -1.179611963664228824e-16_rk, -1.971687836487029943e-01_rk, -5.283121635129700566e-02_rk, &
                                        -1.734723475976807094e-17_rk, -5.283121635129700566e-02_rk, -1.971687836487029943e-01_rk, &
                                        -1.040834085586084257e-17_rk, -5.283121635129700566e-02_rk, -5.283121635129700566e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.673617379884035472e-19_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -3.469446951953614189e-18_rk, 1.971687836487029943e-01_rk, -5.283121635129700566e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, -1.971687836487029943e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129700566e-02_rk, -5.283121635129700566e-02_rk, &
                                        6.938893903907228378e-18_rk, 5.283121635129700566e-02_rk, -1.971687836487029943e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.673617379884035472e-19_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, -5.283121635129700566e-02_rk, 1.971687836487029943e-01_rk, &
                                        -1.040834085586084257e-17_rk, -5.283121635129700566e-02_rk, 5.283121635129700566e-02_rk, &
                                        -1.110223024625156540e-16_rk, -1.971687836487029943e-01_rk, 1.971687836487029943e-01_rk, &
                                        -1.110223024625156540e-16_rk, -1.971687836487029943e-01_rk, 5.283121635129700566e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.673617379884035472e-19_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -8.673617379884035472e-19_rk, 5.283121635129700566e-02_rk, 5.283121635129700566e-02_rk, &
                                        -3.469446951953614189e-18_rk, 5.283121635129700566e-02_rk, 1.971687836487029943e-01_rk, &
                                        -3.469446951953614189e-18_rk, 1.971687836487029943e-01_rk, 5.283121635129700566e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 1.971687836487029943e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        8.673617379884035472e-19_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
       
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        ! xi_max
       
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.673617379884035472e-19_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -7.703719777548943412e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        7.703719777548943412e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -9.714451465470119729e-17_rk, 1.971687836487029943e-01_rk, 1.971687836487029943e-01_rk, &
                                        -1.179611963664228824e-16_rk, 1.971687836487029943e-01_rk, 5.283121635129700566e-02_rk, &
                                        -1.387778780781445676e-17_rk, 5.283121635129700566e-02_rk, 1.971687836487029943e-01_rk, &
                                        -1.040834085586084257e-17_rk, 5.283121635129700566e-02_rk, 5.283121635129700566e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.971687836487024115e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487024115e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129696403e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129696403e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.673617379884035472e-19_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        4.814824860968089633e-35_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        7.703719777548943412e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -3.469446951953614189e-18_rk, -1.971687836487029943e-01_rk, 5.283121635129700566e-02_rk, &
                                        1.387778780781445676e-17_rk, -1.971687836487029943e-01_rk, 1.971687836487029943e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129700566e-02_rk, 5.283121635129700566e-02_rk, &
                                        6.938893903907228378e-18_rk, -5.283121635129700566e-02_rk, 1.971687836487029943e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.971687836487024115e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487024115e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129696403e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129696403e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.673617379884035472e-19_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -7.703719777548943412e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        7.703719777548943412e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 5.283121635129700566e-02_rk, -1.971687836487029943e-01_rk, &
                                        -1.127570259384924611e-17_rk, 5.283121635129700566e-02_rk, -5.283121635129700566e-02_rk, &
                                        -1.110223024625156540e-16_rk, 1.971687836487029943e-01_rk, -1.971687836487029943e-01_rk, &
                                        -1.110223024625156540e-16_rk, 1.971687836487029943e-01_rk, -5.283121635129700566e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -5.283121635129696403e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129696403e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487024115e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487024115e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        8.673617379884035472e-19_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        4.814824860968089633e-35_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        7.703719777548943412e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -8.673617379884035472e-19_rk, -5.283121635129700566e-02_rk, -5.283121635129700566e-02_rk, &
                                        -3.469446951953614189e-18_rk, -5.283121635129700566e-02_rk, -1.971687836487029943e-01_rk, &
                                        -3.469446951953614189e-18_rk, -1.971687836487029943e-01_rk, -5.283121635129700566e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, -1.971687836487029943e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        5.283121635129696403e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129696403e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487024115e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487024115e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        


        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        ! eta_min

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487027723e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487027723e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129722771e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129724158e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -1.971687836487029943e-01_rk, -2.664535259100375697e-15_rk, -9.858439182435150272e-01_rk, &
                                        -1.971687836487029943e-01_rk, -2.692290834716004611e-15_rk, -2.641560817564850283e-01_rk, &
                                        -5.283121635129699178e-02_rk, -1.110223024625156540e-16_rk, -9.858439182435138060e-01_rk, &
                                        -5.283121635129699178e-02_rk, -3.122502256758252770e-16_rk, -2.641560817564839736e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 9.858439182435152492e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435151382e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487027723e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487027723e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129724158e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129722771e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        1.971687836487029943e-01_rk, 1.387778780781445676e-16_rk, -2.641560817564839736e-01_rk, &
                                        1.971687836487029943e-01_rk, 1.110223024625156540e-16_rk, -9.858439182435150272e-01_rk, &
                                        5.283121635129699178e-02_rk, -4.857225732735059864e-17_rk, -2.641560817564839736e-01_rk, &
                                        5.283121635129699178e-02_rk, 1.387778780781445676e-16_rk, -9.858439182435150272e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435152492e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435151382e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.857225732735059864e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.857225732735059864e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129725546e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129725546e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487027723e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487027168e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -5.283121635129699178e-02_rk, -1.110223024625156540e-16_rk, 9.858439182435138060e-01_rk, &
                                        -5.283121635129699178e-02_rk, -2.914335439641035919e-16_rk, 2.641560817564839736e-01_rk, &
                                        -1.971687836487029943e-01_rk, -2.553512956637860043e-15_rk, 9.858439182435150272e-01_rk, &
                                        -1.971687836487029943e-01_rk, -2.692290834716004611e-15_rk, 2.641560817564850283e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.858439182435151382e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435152492e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129725546e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129725546e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487027723e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487027168e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        5.283121635129699178e-02_rk, -4.857225732735059864e-17_rk, 2.641560817564839736e-01_rk, &
                                        5.283121635129699178e-02_rk, 1.387778780781445676e-16_rk, 9.858439182435150272e-01_rk, &
                                        1.971687836487029943e-01_rk, 1.387778780781445676e-16_rk, 2.641560817564839736e-01_rk, &
                                        1.971687836487029943e-01_rk, 1.110223024625156540e-16_rk, 9.858439182435150272e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435152492e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435151382e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.857225732735059864e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.857225732735059864e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        ! eta_max

        
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, 4.857225732735059864e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.081487911019577365e-33_rk, -8.552847072295026068e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.069105884036878258e-49_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.857225732735059864e-17_rk, 1.155557966632341512e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.069105884036878258e-49_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.348150961071065097e-33_rk, 3.207317652110634775e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487022727e-01_rk, 2.002967142162725287e-32_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487023282e-01_rk, -2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129717220e-02_rk, 2.220446049250312834e-16_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129718607e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        1.971687836487029943e-01_rk, -2.664535259100375697e-15_rk, 9.858439182435150272e-01_rk, &
                                        1.971687836487029943e-01_rk, -2.692290834716004611e-15_rk, 2.641560817564850283e-01_rk, &
                                        5.283121635129699178e-02_rk, -1.387778780781445676e-16_rk, 9.858439182435138060e-01_rk, &
                                        5.283121635129699178e-02_rk, -3.122502256758252770e-16_rk, 2.641560817564839736e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        5.472533083603153668e-18_rk, -9.858439182435152492e-01_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.466360820304074325e-18_rk, -9.858439182435151382e-01_rk, -3.081487911019577365e-32_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487023282e-01_rk, 2.081668171172168267e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487022727e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129718607e-02_rk, 1.001483571081362644e-32_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129717220e-02_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -1.971687836487029943e-01_rk, 1.387778780781445676e-16_rk, 2.641560817564839736e-01_rk, &
                                        -1.971687836487029943e-01_rk, 1.110223024625156540e-16_rk, 9.858439182435150272e-01_rk, &
                                        -5.283121635129699178e-02_rk, -4.163336342344337027e-17_rk, 2.641560817564839736e-01_rk, &
                                        -5.283121635129699178e-02_rk, 1.387778780781445676e-16_rk, 9.858439182435150272e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -5.472533083603153668e-18_rk, -2.641560817564849728e-01_rk, -2.619264724366640760e-32_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435152492e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.466360820304074325e-18_rk, -2.641560817564849728e-01_rk, -2.619264724366640760e-32_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435151382e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, 4.857225732735059864e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.069105884036878258e-49_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.081487911019577365e-33_rk, -8.552847072295026068e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.857225732735059864e-17_rk, 1.155557966632341512e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.348150961071065097e-33_rk, 3.207317652110634775e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.069105884036878258e-49_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129718607e-02_rk, -2.081668171172168760e-16_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129718607e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487022727e-01_rk, 2.002967142162725287e-32_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487022727e-01_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        5.283121635129699178e-02_rk, -1.110223024625156540e-16_rk, -9.858439182435138060e-01_rk, &
                                        5.283121635129699178e-02_rk, -2.983724378680108202e-16_rk, -2.641560817564839736e-01_rk, &
                                        1.971687836487029943e-01_rk, -2.664535259100375697e-15_rk, -9.858439182435150272e-01_rk, &
                                        1.971687836487029943e-01_rk, -2.692290834716004611e-15_rk, -2.641560817564850283e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        1.466360820304074325e-18_rk, 9.858439182435151382e-01_rk, 3.081487911019577365e-32_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.472533083603153668e-18_rk, 9.858439182435152492e-01_rk, 3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564849728e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129718607e-02_rk, 1.001483571081362644e-32_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129718607e-02_rk, 2.081668171172168513e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487022727e-01_rk, -2.220446049250313574e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487022727e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -5.283121635129699178e-02_rk, -4.857225732735059864e-17_rk, -2.641560817564839736e-01_rk, &
                                        -5.283121635129699178e-02_rk, 1.387778780781445676e-16_rk, -9.858439182435150272e-01_rk, &
                                        -1.971687836487029943e-01_rk, 1.387778780781445676e-16_rk, -2.641560817564839736e-01_rk, &
                                        -1.971687836487029943e-01_rk, 1.110223024625156540e-16_rk, -9.858439182435150272e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -1.466360820304074325e-18_rk, 2.641560817564849728e-01_rk, 2.619264724366640760e-32_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435152492e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.472533083603153668e-18_rk, 2.641560817564849728e-01_rk, 2.619264724366640760e-32_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435151382e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        


        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! zeta_min
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487028278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487028278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129725546e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129724158e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435151382e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564849173e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435148052e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564849173e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -1.971687836487029943e-01_rk, -9.858439182435150272e-01_rk, -2.664535259100375697e-15_rk, &
                                        -1.971687836487029943e-01_rk, -2.641560817564850283e-01_rk, -2.692290834716004611e-15_rk, &
                                        -5.283121635129699178e-02_rk, -9.858439182435138060e-01_rk, -1.665334536937734811e-16_rk, &
                                        -5.283121635129699178e-02_rk, -2.641560817564839736e-01_rk, -2.983724378680108202e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487028278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487028278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129724158e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129725546e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564848618e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435151382e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564849173e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435149162e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.971687836487029943e-01_rk, -2.641560817564839736e-01_rk, 1.387778780781445676e-16_rk, &
                                        1.971687836487029943e-01_rk, -9.858439182435150272e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129699178e-02_rk, -2.641560817564839736e-01_rk, -4.857225732735059864e-17_rk, &
                                        5.283121635129699178e-02_rk, -9.858439182435150272e-01_rk, 1.387778780781445676e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129721383e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129724158e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487028278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487028278e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435148052e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564849173e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435151382e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564849173e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -5.283121635129699178e-02_rk, 9.858439182435138060e-01_rk, -1.110223024625156540e-16_rk, &
                                        -5.283121635129699178e-02_rk, 2.641560817564839736e-01_rk, -3.053113317719180486e-16_rk, &
                                        -1.971687836487029943e-01_rk, 9.858439182435150272e-01_rk, -2.664535259100375697e-15_rk, &
                                        -1.971687836487029943e-01_rk, 2.641560817564850283e-01_rk, -2.636779683484746784e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129724158e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129721383e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487028278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487028278e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564849173e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435151382e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564848618e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435149162e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        5.283121635129699178e-02_rk, 2.641560817564839736e-01_rk, -4.857225732735059864e-17_rk, &
                                        5.283121635129699178e-02_rk, 9.858439182435150272e-01_rk, 1.387778780781445676e-16_rk, &
                                        1.971687836487029943e-01_rk, 2.641560817564839736e-01_rk, 1.387778780781445676e-16_rk, &
                                        1.971687836487029943e-01_rk, 9.858439182435150272e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.163336342344337027e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.163336342344337027e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.163336342344337027e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.163336342344337027e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,4/))
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! zeta_max
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.552847072295026068e-50_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.069105884036878258e-49_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.081487911019577365e-33_rk, -1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.163336342344337027e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.069105884036878258e-49_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.207317652110634775e-50_rk, 1.155557966632341512e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.155557966632341512e-33_rk, 4.163336342344337027e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.069105884036878258e-49_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.552847072295026068e-50_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.163336342344337027e-17_rk, &
                                        0.000000000000000000e+00_rk, -3.081487911019577365e-33_rk, -1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.207317652110634775e-50_rk, 1.155557966632341512e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.069105884036878258e-49_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.155557966632341512e-33_rk, 4.163336342344337027e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.002967142162725287e-32_rk, -1.971687836487022172e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, -1.971687836487022172e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250312834e-16_rk, -5.283121635129721383e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129717220e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.472533083603153668e-18_rk, -3.081487911019577365e-33_rk, -9.858439182435151382e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564849173e-01_rk, &
                                        1.466360820304074325e-18_rk, -3.081487911019577365e-32_rk, -9.858439182435148052e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564849173e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        1.971687836487029943e-01_rk, 9.858439182435150272e-01_rk, -2.664535259100375697e-15_rk, &
                                        1.971687836487029943e-01_rk, 2.641560817564850283e-01_rk, -2.636779683484746784e-15_rk, &
                                        5.283121635129699178e-02_rk, 9.858439182435138060e-01_rk, -1.387778780781445676e-16_rk, &
                                        5.283121635129699178e-02_rk, 2.641560817564839736e-01_rk, -3.330669073875469621e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.081668171172168267e-16_rk, 1.971687836487022172e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487022172e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.001483571081362644e-32_rk, 5.283121635129717220e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 5.283121635129721383e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -5.472533083603153668e-18_rk, -2.619264724366640760e-32_rk, -2.641560817564848618e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435151382e-01_rk, &
                                        -1.466360820304074325e-18_rk, -2.619264724366640760e-32_rk, -2.641560817564849173e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435149162e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.971687836487029943e-01_rk, 2.641560817564839736e-01_rk, 1.387778780781445676e-16_rk, &
                                        -1.971687836487029943e-01_rk, 9.858439182435150272e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129699178e-02_rk, 2.641560817564839736e-01_rk, -2.081668171172168513e-17_rk, &
                                        -5.283121635129699178e-02_rk, 9.858439182435150272e-01_rk, 1.387778780781445676e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.081668171172168760e-16_rk, -5.283121635129714444e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129717220e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.002967142162725287e-32_rk, -1.971687836487022172e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, -1.971687836487022172e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.466360820304074325e-18_rk, 3.081487911019577365e-32_rk, 9.858439182435148052e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564849173e-01_rk, &
                                        5.472533083603153668e-18_rk, 3.081487911019577365e-33_rk, 9.858439182435151382e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564849173e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        5.283121635129699178e-02_rk, -9.858439182435138060e-01_rk, -1.387778780781445676e-16_rk, &
                                        5.283121635129699178e-02_rk, -2.641560817564839736e-01_rk, -3.330669073875469621e-16_rk, &
                                        1.971687836487029943e-01_rk, -9.858439182435150272e-01_rk, -2.664535259100375697e-15_rk, &
                                        1.971687836487029943e-01_rk, -2.641560817564850283e-01_rk, -2.636779683484746784e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.001483571081362644e-32_rk, 5.283121635129717220e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.081668171172168513e-16_rk, 5.283121635129714444e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313574e-16_rk, 1.971687836487022172e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487022172e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.466360820304074325e-18_rk, 2.619264724366640760e-32_rk, 2.641560817564849173e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435151382e-01_rk, &
                                        -5.472533083603153668e-18_rk, 2.619264724366640760e-32_rk, 2.641560817564848618e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435149162e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -5.283121635129699178e-02_rk, -2.641560817564839736e-01_rk, -4.857225732735059864e-17_rk, &
                                        -5.283121635129699178e-02_rk, -9.858439182435150272e-01_rk, 1.387778780781445676e-16_rk, &
                                        -1.971687836487029943e-01_rk, -2.641560817564839736e-01_rk, 1.387778780781445676e-16_rk, &
                                        -1.971687836487029943e-01_rk, -9.858439182435150272e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do



    end subroutine testelement_face_dnormals_dx
    !*******************************************************************************************





!    !>  Test dmetric_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The dmetric_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_dmetric_dx_point(self)
!        class(test_element_lineara_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_dmetric_dx(:,:,:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [-1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_dmetric_dx = self%elem%dmetric_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_dmetric_dx,self%elem%dmetric_dx(:,:,1,:,:),tol)
!
!
!    end subroutine testelement_dmetric_dx_point
!    !*******************************************************************************************







!    !>  Test djinv_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The djinv_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_djinv_dx_point(self)
!        class(test_element_lineara_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_djinv_dx(:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_djinv_dx = self%elem%djinv_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_djinv_dx,self%elem%djinv_dx(2,:,:),tol)
!
!
!    end subroutine testelement_djinv_dx_point
!    !*******************************************************************************************







!    !>  Test h_index
!    !!
!    !!  Fortran search the minimum x, y and z coordinate among all the support nodes.
!    !!  If multiple minimum are found, fortran returns the location of the first minimum starting 
!    !!  from the first minimum found (ie. first location in connectivity vector).
!    !!
!    !!  In this case, for instance for x direction, there exists 4 minima. However, the one stored
!    !!  for dX differentiation (needed for artificial viscosity) will be node 1, since it comes first
!    !!
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_h_index(self)
!        class(test_element_lineara_dx),    intent(inout)   :: self
!
!        integer(ik) :: x_min, x_max, y_min, y_max, z_min, z_max
!        
!        x_min = 1
!        x_max = 2
!        y_min = 1
!        y_max = 3
!        z_min = 1
!        z_max = 5
!
!
!        ! Test
!        @assertequal(x_min,self%elem%h_index(1,1))
!        @assertequal(x_max,self%elem%h_index(1,2))
!        @assertequal(y_min,self%elem%h_index(2,1))
!        @assertequal(y_max,self%elem%h_index(2,2))
!        @assertequal(z_min,self%elem%h_index(3,1))
!        @assertequal(z_max,self%elem%h_index(3,2))
!
!
!    end subroutine testelement_h_index
!    !*******************************************************************************************









!####################################################
!
!   PYTHON SCRIPT FOR TESTING ELEMENT DX INITIALIZATION
!
!       This requires PyTORCH. For installation refer to
!       https://pytorch.org/get-started/locally/
!
!####################################################


!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!
!
!
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data  = [[ 1.0,   0.0,       0.0],
!                [ 2.0,   0.0,       0.0],
!                [ 1.0,   np.pi/2.0, 0.0],
!                [ 2.0,   np.pi/2.0, 0.0],
!                [ 1.0,   0.0,       1.0],
!                [ 2.0,   0.0,       1.0],
!                [ 1.0,   np.pi/2.0, 1.0],
!                [ 2.0,   np.pi/2.0, 1.0],
!                ]
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_elem  = 8 
!nnodes_face  = 4 
!nterms_s   = 8
!ndirs      = 3
!coord_sys  = 'CYLINDRICAL'
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              ] 
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              ]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                ]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_elem-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_elem):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_elem-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_elem, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_elem))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_elem*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_elem*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_elem))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            for irow in range(0,3):
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_elem*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    i += 1
!            np.savetxt(f,array)
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("xcoord interpolation, coord 1,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("ycoord interpolation, coord 2,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("zcoord interpolation, coord 3,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    array = np.zeros([nnodes_r,ndirs])
!    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_elem*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file           ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dinvmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file        ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_vol_dx
!#
!# 
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face1_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face2_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face3_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_face_dx
!#
!# 
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()












!####################################################
!
!   PYTHON SCRIPT FOR TESTING FACE DX INITIALIZATION
!
!       This requires PyTORCH. For installation refer to
!       https://pytorch.org/get-started/locally/
!
!####################################################




!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!
!
!
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data  = [[ 1.0,   0.0,       0.0],
!                [ 2.0,   0.0,       0.0],
!                [ 1.0,   np.pi/2.0, 0.0],
!                [ 2.0,   np.pi/2.0, 0.0],
!                [ 1.0,   0.0,       1.0],
!                [ 2.0,   0.0,       1.0],
!                [ 1.0,   np.pi/2.0, 1.0],
!                [ 2.0,   np.pi/2.0, 1.0],
!                ]
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_elem  = 8 
!nnodes_face  = 4 
!nterms_s   = 8
!ndirs      = 3
!coord_sys  = 'CYLINDRICAL'
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              ] 
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              ]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                ]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_elem-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_elem):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_elem-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_elem, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_elem))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_elem*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_elem*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_elem))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            for irow in range(0,3):
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_elem*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    i += 1
!            np.savetxt(f,array)
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("xcoord interpolation, coord 1,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("ycoord interpolation, coord 2,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("zcoord interpolation, coord 3,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    array = np.zeros([nnodes_r,ndirs])
!    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_elem*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file           ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dinvmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file        ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_vol_dx
!#
!# 
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face1_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face2_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face3_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_face_dx
!#
!# 
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()






end module test_element_linearA_dx_mod

module test_element_linearA_dx_mod
    use pfunit_mod
    use mod_kinds,                  only: rk,ik
    use mod_constants,              only: ZERO, ONE, TWO, THREE, FIVE, SIX, EIGHT, NINE, TEN, &
                                          XI_MIN, XI_MAX, ETA_MIN, ETA_MAX, ZETA_MIN, ZETA_MAX
    use mod_chidg_mpi,              only: IRANK
    use type_chidg,                 only: chidg_t
    use type_element,               only: element_t
    use type_face,                  only: face_t
    use type_element_connectivity,  only: element_connectivity_t
    use mod_io,                     only: gq_rule
    use type_point,                 only: point_t
    use mod_inv,                    only: inv
    implicit none

    public  :: test_element_linearA_dx

    !>
    !!
    !!  @author Matteo Ugolotti
    !!  @date   10/4/2018
    !!
    !!  This test is build based on test_element_linearA test case.
    !!  The standard initialization is not tested here but the dx initialization 
    !!  is verified.
    !!
    !!  Symbolic pyhton solution is used to check ChiDG matrices.
    !!  The python script is available at the end of this module.
    !!  The input matrices used in the test herein are given by the
    !!  python script
    !!
    !!
    !--------------------------------------------------------------------------
    @TestCase
    type, extends(TestCase) ::  test_element_linearA_dx

        type(chidg_t)               :: chidg
        type(element_t)             :: elem
        type(face_t),   allocatable :: faces(:)
        real(rk),       allocatable :: nodes(:,:)

    contains

        procedure   ::  setUp
        procedure   ::  tearDown

    end type test_element_linearA_dx
    !***************************************************************************


contains

    !> NOTE: make sure to use 'this' instead of 'self' since these are over-writting a 
    !! derived type procedure. The argument names have to match
    !!
    !!  @author Matteo Ugolotti
    !!
    !!
    !-----------------------------------------------------------------------------------------
    subroutine setUp(this)
        class(test_element_linearA_dx),    intent(inout)   :: this
        
        integer(ik), parameter          :: npt = 8
        real(rk)                        :: nodes(npt,3)
        integer(ik)                     :: ftype, ielem, idomain,                           &
                                           ntime, nfields, nterms_s,                        &
                                           ineighbor_domain_g,  ineighbor_domain_l,         &
                                           ineighbor_element_g, ineighbor_element_l,        &
                                           ineighbor_face, ineighbor_proc,                  &
                                           ineighbor_nfields, ineighbor_nterms_s,           &
                                           ineighbor_nterms_c, ineighbor_nnodes_r,          &
                                           ineighbor_ntime,                                 &
                                           dof_start, dof_local_start,                      &
                                           ineighbor_dof_start, ineighbor_dof_local_start,  &
                                           xdof_start, xdof_local_start,                    &
                                           ineighbor_xdof_start, ineighbor_xdof_local_start
        
        

        ! Set collocation quadrature for testing coordinates at quadrature nodes
        gq_rule = 1
        
        
        call this%chidg%start_up('core')
        allocate(this%faces(6))
        
        ! (x = 0-5 :: y = 0-1 :: z = 0-1)
        !          *------*
        !         /      /|
        !    x=5 /      / |
        !       /      /  *
        !      *------*  /
        !      |      | /
        !  z=1 |      |/
        !      *------*
        !         y=1
        !
        nodes(1,:) = [0._rk, 0._rk, 0._rk]
        nodes(2,:) = [5._rk, 0._rk, 0._rk]
        nodes(3,:) = [5._rk, 1._rk, 0._rk]
        nodes(4,:) = [0._rk, 1._rk, 0._rk]
        nodes(5,:) = [0._rk, 0._rk, 1._rk]
        nodes(6,:) = [5._rk, 0._rk, 1._rk]
        nodes(7,:) = [5._rk, 1._rk, 1._rk]
        nodes(8,:) = [0._rk, 1._rk, 1._rk]
        this%nodes = nodes


        
        !
        ! Initialize Element geometry and Numerics
        !
        idomain         = 1
        ielem           = 1
        nfields         = 2
        nterms_s        = 8
        ntime           = 1
        dof_start       = 1
        dof_local_start = 1
        xdof_start       = 1
        xdof_local_start = 1
        call this%elem%init_geom(nodes        = nodes,                                &
                                 connectivity = [1, 2, 3, 4, 5, 6, 7, 8],             &
                                 etype        = 1,                                    &
                                 location     = [idomain,idomain,ielem,ielem,IRANK],  &
                                 coord_system = 'Cartesian')
        call this%elem%init_sol('Quadrature',1,nterms_s,nfields,ntime,dof_start,dof_local_start,xdof_start,xdof_local_start)
        call this%elem%update_interpolations_dx()
        
        
        !
        ! Initialize face geometries
        !
        call this%faces(XI_MIN)%init_geom(XI_MIN,this%elem)
        call this%faces(XI_MAX)%init_geom(XI_MAX,this%elem)
        call this%faces(ETA_MIN)%init_geom(ETA_MIN,this%elem)
        call this%faces(ETA_MAX)%init_geom(ETA_MAX,this%elem)
        call this%faces(ZETA_MIN)%init_geom(ZETA_MIN,this%elem)
        call this%faces(ZETA_MAX)%init_geom(ZETA_MAX,this%elem)

        
        
        !
        ! Initialize face neighbors
        !
        ftype = 0
        ineighbor_domain_g        = 0
        ineighbor_domain_l        = 0
        ineighbor_element_g       = 0
        ineighbor_element_l       = 0
        ineighbor_face            = 0
        ineighbor_nfields         = 2
        ineighbor_ntime           = 1
        ineighbor_nterms_s        = 8
        ineighbor_nterms_c        = 8
        ineighbor_proc            = 0
        ineighbor_dof_start       = 1
        ineighbor_dof_local_start = 1
        ineighbor_xdof_start       = 1
        ineighbor_xdof_local_start = 1
        call this%faces(XI_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,               &
                                                   ineighbor_element_g,ineighbor_element_l,             &
                                                   ineighbor_face,ineighbor_nfields,ineighbor_ntime,    &
                                                   ineighbor_nterms_s,ineighbor_nterms_c,               &
                                                   ineighbor_proc,                                      &
                                                   ineighbor_dof_start,ineighbor_dof_local_start,       &
                                                   ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(XI_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,               &
                                                   ineighbor_element_g,ineighbor_element_l,             &
                                                   ineighbor_face,ineighbor_nfields,ineighbor_ntime,    &
                                                   ineighbor_nterms_s,ineighbor_nterms_c,               &
                                                   ineighbor_proc,                                      &
                                                   ineighbor_dof_start,ineighbor_dof_local_start,       &
                                                   ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,              &
                                                    ineighbor_element_g,ineighbor_element_l,            &
                                                    ineighbor_face,ineighbor_nfields,ineighbor_ntime,   &
                                                    ineighbor_nterms_s,ineighbor_nterms_c,              &
                                                    ineighbor_proc,                                     &
                                                    ineighbor_dof_start,ineighbor_dof_local_start,      &
                                                    ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,              &
                                                    ineighbor_element_g,ineighbor_element_l,            &
                                                    ineighbor_face,ineighbor_nfields,ineighbor_ntime,   &
                                                    ineighbor_nterms_s,ineighbor_nterms_c,              &
                                                    ineighbor_proc,                                     &
                                                    ineighbor_dof_start,ineighbor_dof_local_start,      &
                                                    ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ZETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                                    &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,     &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ZETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                                    &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,     &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)





        call this%faces(XI_MIN)%init_sol(this%elem)
        call this%faces(XI_MAX)%init_sol(this%elem)
        call this%faces(ETA_MIN)%init_sol(this%elem)
        call this%faces(ETA_MAX)%init_sol(this%elem)
        call this%faces(ZETA_MIN)%init_sol(this%elem)
        call this%faces(ZETA_MAX)%init_sol(this%elem)

        !
        ! Update dx interpolators
        !
        call this%faces(XI_MIN)%update_interpolations_dx(this%elem)
        call this%faces(XI_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MAX)%update_interpolations_dx(this%elem)


    end subroutine setUp
    !************************************************************************************
    

    !>
    !!
    !!
    !-------------------------------------------------------------------------------------
    subroutine tearDown(this)
        class(test_element_linearA_dx),    intent(inout)   :: this


        !
        ! Close ChiDG interface
        !
        call this%chidg%shut_down('core')

    end subroutine tearDown
    !**************************************************************************************



    
    
    !> Test element djinv_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_djinv_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self

        integer(ik) :: inode, inode_diff, idir, irow
        real(rk)    :: test_djinv_dx(8,3,8), test_djinv_dx_trans(8,3)



        test_djinv_dx(1,:,:) = reshape((/                                                                                           & 
                                        -7.775105849101827948e-02_rk, -3.887552924550913835e-01_rk, -3.887552924550913835e-01_rk,   &
                                         7.775105849101827948e-02_rk, -1.041666666666666713e-01_rk, -1.041666666666666713e-01_rk,   &
                                         2.083333333333333565e-02_rk,  1.041666666666666713e-01_rk, -2.791137421157528775e-02_rk,   &
                                        -2.083333333333333565e-02_rk,  3.887552924550913835e-01_rk, -1.041666666666666713e-01_rk,   &
                                        -2.083333333333333565e-02_rk, -1.041666666666666713e-01_rk,  3.887552924550913835e-01_rk,   &
                                         2.083333333333333565e-02_rk, -2.791137421157528775e-02_rk,  1.041666666666666713e-01_rk,   &
                                         5.582274842315057897e-03_rk,  2.791137421157528775e-02_rk,  2.791137421157528775e-02_rk,   &
                                        -5.582274842315057897e-03_rk,  1.041666666666666713e-01_rk,  1.041666666666666713e-01_rk    &
                                        /),(/3,8/))


        test_djinv_dx(2,:,:) = reshape((/                                                                                           & 
                                       -7.775105849101827948e-02_rk, -1.041666666666666713e-01_rk, -1.041666666666666713e-01_rk,    &
                                        7.775105849101827948e-02_rk, -3.887552924550913835e-01_rk, -3.887552924550913835e-01_rk,    &
                                        2.083333333333333565e-02_rk,  3.887552924550913835e-01_rk, -1.041666666666666713e-01_rk,    &
                                       -2.083333333333333565e-02_rk,  1.041666666666666713e-01_rk, -2.791137421157528775e-02_rk,    &
                                       -2.083333333333333565e-02_rk, -2.791137421157528775e-02_rk,  1.041666666666666713e-01_rk,    &
                                        2.083333333333333565e-02_rk, -1.041666666666666713e-01_rk,  3.887552924550913835e-01_rk,    &
                                        5.582274842315057897e-03_rk,  1.041666666666666713e-01_rk,  1.041666666666666713e-01_rk,    &
                                       -5.582274842315057897e-03_rk,  2.791137421157528775e-02_rk,  2.791137421157528775e-02_rk     &
                                        /),(/3,8/))
        

        test_djinv_dx(3,:,:) = reshape((/                                                                                           & 
                                       -2.083333333333333565e-02_rk, -3.887552924550913835e-01_rk, -1.041666666666666713e-01_rk,    &
                                        2.083333333333333565e-02_rk, -1.041666666666666713e-01_rk, -2.791137421157528775e-02_rk,    &
                                        7.775105849101827948e-02_rk,  1.041666666666666713e-01_rk, -1.041666666666666713e-01_rk,    &
                                       -7.775105849101827948e-02_rk,  3.887552924550913835e-01_rk, -3.887552924550913835e-01_rk,    &
                                       -5.582274842315057897e-03_rk, -1.041666666666666713e-01_rk,  1.041666666666666713e-01_rk,    &
                                        5.582274842315057897e-03_rk, -2.791137421157528775e-02_rk,  2.791137421157528775e-02_rk,    &
                                        2.083333333333333565e-02_rk,  2.791137421157528775e-02_rk,  1.041666666666666713e-01_rk,    &
                                       -2.083333333333333565e-02_rk,  1.041666666666666713e-01_rk,  3.887552924550913835e-01_rk     &
                                        /),(/3,8/))


        test_djinv_dx(4,:,:) = reshape((/                                                                                           & 
                                        -2.083333333333333565e-02_rk, -1.041666666666666713e-01_rk, -2.791137421157528775e-02_rk,   &
                                         2.083333333333333565e-02_rk, -3.887552924550913835e-01_rk, -1.041666666666666713e-01_rk,   &
                                         7.775105849101827948e-02_rk,  3.887552924550913835e-01_rk, -3.887552924550913835e-01_rk,   &
                                        -7.775105849101827948e-02_rk,  1.041666666666666713e-01_rk, -1.041666666666666713e-01_rk,   &
                                        -5.582274842315057897e-03_rk, -2.791137421157528775e-02_rk,  2.791137421157528775e-02_rk,   &
                                         5.582274842315057897e-03_rk, -1.041666666666666713e-01_rk,  1.041666666666666713e-01_rk,   &
                                         2.083333333333333565e-02_rk,  1.041666666666666713e-01_rk,  3.887552924550913835e-01_rk,   &
                                        -2.083333333333333565e-02_rk,  2.791137421157528775e-02_rk,  1.041666666666666713e-01_rk    &
                                        /),(/3,8/))


        test_djinv_dx(5,:,:) = reshape((/                                                                                           & 
                                        -2.083333333333333565e-02_rk, -1.041666666666666713e-01_rk, -3.887552924550913835e-01_rk,   &
                                         2.083333333333333565e-02_rk, -2.791137421157528775e-02_rk, -1.041666666666666713e-01_rk,   &
                                         5.582274842315057897e-03_rk,  2.791137421157528775e-02_rk, -2.791137421157528775e-02_rk,   &
                                        -5.582274842315057897e-03_rk,  1.041666666666666713e-01_rk, -1.041666666666666713e-01_rk,   &
                                        -7.775105849101827948e-02_rk, -3.887552924550913835e-01_rk,  3.887552924550913835e-01_rk,   &
                                         7.775105849101827948e-02_rk, -1.041666666666666713e-01_rk,  1.041666666666666713e-01_rk,   &
                                         2.083333333333333565e-02_rk,  1.041666666666666713e-01_rk,  2.791137421157528775e-02_rk,   &
                                        -2.083333333333333565e-02_rk,  3.887552924550913835e-01_rk,  1.041666666666666713e-01_rk    &
                                        /),(/3,8/))


        test_djinv_dx(6,:,:) = reshape((/                                                                                           & 
                                        -2.083333333333333565e-02_rk, -2.791137421157528775e-02_rk, -1.041666666666666713e-01_rk,   &
                                         2.083333333333333565e-02_rk, -1.041666666666666713e-01_rk, -3.887552924550913835e-01_rk,   &
                                         5.582274842315057897e-03_rk,  1.041666666666666713e-01_rk, -1.041666666666666713e-01_rk,   &
                                        -5.582274842315057897e-03_rk,  2.791137421157528775e-02_rk, -2.791137421157528775e-02_rk,   &
                                        -7.775105849101827948e-02_rk, -1.041666666666666713e-01_rk,  1.041666666666666713e-01_rk,   &
                                         7.775105849101827948e-02_rk, -3.887552924550913835e-01_rk,  3.887552924550913835e-01_rk,   &
                                         2.083333333333333565e-02_rk,  3.887552924550913835e-01_rk,  1.041666666666666713e-01_rk,   &
                                        -2.083333333333333565e-02_rk,  1.041666666666666713e-01_rk,  2.791137421157528775e-02_rk    &
                                        /),(/3,8/))


        test_djinv_dx(7,:,:) = reshape((/                                                                                           &
                                        -5.582274842315057897e-03_rk, -1.041666666666666713e-01_rk, -1.041666666666666713e-01_rk,   &
                                         5.582274842315057897e-03_rk, -2.791137421157528775e-02_rk, -2.791137421157528775e-02_rk,   &
                                         2.083333333333333565e-02_rk,  2.791137421157528775e-02_rk, -1.041666666666666713e-01_rk,   &
                                        -2.083333333333333565e-02_rk,  1.041666666666666713e-01_rk, -3.887552924550913835e-01_rk,   &
                                        -2.083333333333333565e-02_rk, -3.887552924550913835e-01_rk,  1.041666666666666713e-01_rk,   &
                                         2.083333333333333565e-02_rk, -1.041666666666666713e-01_rk,  2.791137421157528775e-02_rk,   &
                                         7.775105849101827948e-02_rk,  1.041666666666666713e-01_rk,  1.041666666666666713e-01_rk,   &
                                        -7.775105849101827948e-02_rk,  3.887552924550913835e-01_rk,  3.887552924550913835e-01_rk    &
                                        /),(/3,8/))


        test_djinv_dx(8,:,:) = reshape((/                                                                                           &
                                        -5.582274842315057897e-03_rk, -2.791137421157528775e-02_rk, -2.791137421157528775e-02_rk,   &
                                         5.582274842315057897e-03_rk, -1.041666666666666713e-01_rk, -1.041666666666666713e-01_rk,   &
                                         2.083333333333333565e-02_rk,  1.041666666666666713e-01_rk, -3.887552924550913835e-01_rk,   &
                                        -2.083333333333333565e-02_rk,  2.791137421157528775e-02_rk, -1.041666666666666713e-01_rk,   &
                                        -2.083333333333333565e-02_rk, -1.041666666666666713e-01_rk,  2.791137421157528775e-02_rk,   &
                                         2.083333333333333565e-02_rk, -3.887552924550913835e-01_rk,  1.041666666666666713e-01_rk,   &
                                         7.775105849101827948e-02_rk,  3.887552924550913835e-01_rk,  3.887552924550913835e-01_rk,   &
                                        -7.775105849101827948e-02_rk,  1.041666666666666713e-01_rk,  1.041666666666666713e-01_rk    &
                                        /),(/3,8/))


        do inode = 1,self%elem%basis_s%nnodes_elem()
            @assertEqual(transpose(test_djinv_dx(inode,:,:)),self%elem%djinv_dx(inode,:,:), 1.e-14_rk)
        end do
        
    end subroutine testElement_djinv_dx
    !***************************************************************************************





    !> Test element dmetric_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmetric_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self

        real(rk)    :: test_metric(3,3,self%elem%basis_s%nnodes_elem())
        real(rk)    :: test_dmetric_dx(3,3,8,8,3), test_dmetric_dx_trans(3,3)
        integer(ik) :: inode, inode_diff, idir, irow
        

        test_dmetric_dx(:,:,1,1,1) = reshape((/ &
        0.04976067743425171_rk, 0.24880338717125847_rk, 0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, 1.2440169358562925_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, 1.2440169358562925_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,1) = reshape((/ &
        -0.04976067743425171_rk, 0.06666666666666668_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, 0.33333333333333337_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, 0.33333333333333337_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,1) = reshape((/ &
        -0.013333333333333336_rk, -0.06666666666666668_rk, 0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.33333333333333337_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.33333333333333337_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,1) = reshape((/ &
        0.013333333333333336_rk, -0.24880338717125847_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -1.2440169358562925_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -1.2440169358562925_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,1) = reshape((/ &
        0.013333333333333336_rk, 0.06666666666666668_rk, -0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.33333333333333337_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.33333333333333337_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,1) = reshape((/ &
        -0.013333333333333336_rk, 0.01786327949540819_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.08931639747704093_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.08931639747704093_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,1) = reshape((/ &
        -0.0035726558990816365_rk, -0.01786327949540819_rk, -0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, -0.08931639747704093_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, -0.08931639747704093_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,1) = reshape((/ &
        0.0035726558990816365_rk, -0.06666666666666668_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, -0.33333333333333337_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, -0.33333333333333337_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,1) = reshape((/ &
        0.04976067743425171_rk, 0.06666666666666668_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, 0.33333333333333337_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, 0.33333333333333337_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,1) = reshape((/ &
        -0.04976067743425171_rk, 0.24880338717125847_rk, 0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, 1.2440169358562925_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, 1.2440169358562925_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,1) = reshape((/ &
        -0.013333333333333336_rk, -0.24880338717125847_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -1.2440169358562925_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -1.2440169358562925_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,1) = reshape((/ &
        0.013333333333333336_rk, -0.06666666666666668_rk, 0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.33333333333333337_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.33333333333333337_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,1) = reshape((/ &
        0.013333333333333336_rk, 0.01786327949540819_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.08931639747704093_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.08931639747704093_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,1) = reshape((/ &
        -0.013333333333333336_rk, 0.06666666666666668_rk, -0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.33333333333333337_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.33333333333333337_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,1) = reshape((/ &
        -0.0035726558990816365_rk, -0.06666666666666668_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, -0.33333333333333337_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, -0.33333333333333337_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,1) = reshape((/ &
        0.0035726558990816365_rk, -0.01786327949540819_rk, -0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, -0.08931639747704093_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, -0.08931639747704093_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,1) = reshape((/ &
        0.013333333333333336_rk, 0.24880338717125847_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 1.2440169358562925_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 1.2440169358562925_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,1) = reshape((/ &
        -0.013333333333333336_rk, 0.06666666666666668_rk, 0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.33333333333333337_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.33333333333333337_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,1) = reshape((/ &
        -0.04976067743425171_rk, -0.06666666666666668_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, -0.33333333333333337_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, -0.33333333333333337_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,1) = reshape((/ &
        0.04976067743425171_rk, -0.24880338717125847_rk, 0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, -1.2440169358562925_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, -1.2440169358562925_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,1) = reshape((/ &
        0.0035726558990816365_rk, 0.06666666666666668_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, 0.33333333333333337_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, 0.33333333333333337_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,1) = reshape((/ &
        -0.0035726558990816365_rk, 0.01786327949540819_rk, -0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, 0.08931639747704093_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, 0.08931639747704093_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,1) = reshape((/ &
        -0.013333333333333336_rk, -0.01786327949540819_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.08931639747704093_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.08931639747704093_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,1) = reshape((/ &
        0.013333333333333336_rk, -0.06666666666666668_rk, -0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.33333333333333337_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.33333333333333337_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,1) = reshape((/ &
        0.013333333333333336_rk, 0.06666666666666668_rk, 0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.33333333333333337_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.33333333333333337_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,1) = reshape((/ &
        -0.013333333333333336_rk, 0.24880338717125847_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 1.2440169358562925_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 1.2440169358562925_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,1) = reshape((/ &
        -0.04976067743425171_rk, -0.24880338717125847_rk, 0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, -1.2440169358562925_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, -1.2440169358562925_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,1) = reshape((/ &
        0.04976067743425171_rk, -0.06666666666666668_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, -0.33333333333333337_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, -0.33333333333333337_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,1) = reshape((/ &
        0.0035726558990816365_rk, 0.01786327949540819_rk, -0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, 0.08931639747704093_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, 0.08931639747704093_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,1) = reshape((/ &
        -0.0035726558990816365_rk, 0.06666666666666668_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, 0.33333333333333337_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, 0.33333333333333337_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,1) = reshape((/ &
        -0.013333333333333336_rk, -0.06666666666666668_rk, -0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.33333333333333337_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.33333333333333337_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,1) = reshape((/ &
        0.013333333333333336_rk, -0.01786327949540819_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.08931639747704093_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.08931639747704093_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,1) = reshape((/ &
        0.013333333333333336_rk, 0.06666666666666668_rk, 0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.33333333333333337_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.33333333333333337_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,1) = reshape((/ &
        -0.013333333333333336_rk, 0.01786327949540819_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.08931639747704093_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.08931639747704093_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,1) = reshape((/ &
        -0.0035726558990816365_rk, -0.01786327949540819_rk, 0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, -0.08931639747704093_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, -0.08931639747704093_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,1) = reshape((/ &
        0.0035726558990816365_rk, -0.06666666666666668_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, -0.33333333333333337_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, -0.33333333333333337_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,1) = reshape((/ &
        0.04976067743425171_rk, 0.24880338717125847_rk, -0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, 1.2440169358562925_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, 1.2440169358562925_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,1) = reshape((/ &
        -0.04976067743425171_rk, 0.06666666666666668_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, 0.33333333333333337_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, 0.33333333333333337_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,1) = reshape((/ &
        -0.013333333333333336_rk, -0.06666666666666668_rk, -0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.33333333333333337_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.33333333333333337_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,1) = reshape((/ &
        0.013333333333333336_rk, -0.24880338717125847_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -1.2440169358562925_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -1.2440169358562925_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,1) = reshape((/ &
        0.013333333333333336_rk, 0.01786327949540819_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.08931639747704093_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.08931639747704093_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,1) = reshape((/ &
        -0.013333333333333336_rk, 0.06666666666666668_rk, 0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.33333333333333337_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.33333333333333337_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,1) = reshape((/ &
        -0.0035726558990816365_rk, -0.06666666666666668_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, -0.33333333333333337_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, -0.33333333333333337_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,1) = reshape((/ &
        0.0035726558990816365_rk, -0.01786327949540819_rk, 0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, -0.08931639747704093_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, -0.08931639747704093_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,1) = reshape((/ &
        0.04976067743425171_rk, 0.06666666666666668_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, 0.33333333333333337_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, 0.33333333333333337_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,1) = reshape((/ &
        -0.04976067743425171_rk, 0.24880338717125847_rk, -0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, 1.2440169358562925_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, 1.2440169358562925_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,1) = reshape((/ &
        -0.013333333333333336_rk, -0.24880338717125847_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -1.2440169358562925_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -1.2440169358562925_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,1) = reshape((/ &
        0.013333333333333336_rk, -0.06666666666666668_rk, -0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.33333333333333337_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.33333333333333337_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,1) = reshape((/ &
        0.0035726558990816365_rk, 0.06666666666666668_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, 0.33333333333333337_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, 0.33333333333333337_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,1) = reshape((/ &
        -0.0035726558990816365_rk, 0.01786327949540819_rk, 0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, 0.08931639747704093_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, 0.08931639747704093_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,1) = reshape((/ &
        -0.013333333333333336_rk, -0.01786327949540819_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.08931639747704093_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.08931639747704093_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,1) = reshape((/ &
        0.013333333333333336_rk, -0.06666666666666668_rk, 0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.33333333333333337_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.33333333333333337_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,1) = reshape((/ &
        0.013333333333333336_rk, 0.24880338717125847_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 1.2440169358562925_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 1.2440169358562925_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,1) = reshape((/ &
        -0.013333333333333336_rk, 0.06666666666666668_rk, -0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.33333333333333337_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 0.33333333333333337_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,1) = reshape((/ &
        -0.04976067743425171_rk, -0.06666666666666668_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, -0.33333333333333337_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, -0.33333333333333337_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,1) = reshape((/ &
        0.04976067743425171_rk, -0.24880338717125847_rk, -0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, -1.2440169358562925_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, -1.2440169358562925_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,1) = reshape((/ &
        0.0035726558990816365_rk, 0.01786327949540819_rk, 0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, 0.08931639747704093_rk, 0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.01786327949540819_rk, 0.08931639747704093_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,1) = reshape((/ &
        -0.0035726558990816365_rk, 0.06666666666666668_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, 0.33333333333333337_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.01786327949540819_rk, 0.33333333333333337_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,1) = reshape((/ &
        -0.013333333333333336_rk, -0.06666666666666668_rk, 0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.33333333333333337_rk, 1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, -0.33333333333333337_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,1) = reshape((/ &
        0.013333333333333336_rk, -0.01786327949540819_rk, 0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.08931639747704093_rk, 0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, -0.08931639747704093_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,1) = reshape((/ &
        0.013333333333333336_rk, 0.06666666666666668_rk, -0.01786327949540819_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.33333333333333337_rk, -0.08931639747704093_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.06666666666666668_rk, 0.33333333333333337_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,1) = reshape((/ &
        -0.013333333333333336_rk, 0.24880338717125847_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 1.2440169358562925_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.06666666666666668_rk, 1.2440169358562925_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,1) = reshape((/ &
        -0.04976067743425171_rk, -0.24880338717125847_rk, -0.24880338717125847_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, -1.2440169358562925_rk, -1.2440169358562925_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.24880338717125847_rk, -1.2440169358562925_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,1) = reshape((/ &
        0.04976067743425171_rk, -0.06666666666666668_rk, -0.06666666666666668_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, -0.33333333333333337_rk, -0.33333333333333337_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.24880338717125847_rk, -0.33333333333333337_rk, -0.33333333333333337_rk   &
        /),(/3,3/))



        do inode = 1,self%elem%basis_s%nnodes_elem()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx(:,:,inode,inode_diff,idir)),self%elem%dmetric_dx(:,:,inode,inode_diff,idir), 1.e-14_rk)
                end do
            end do
        end do 


    end subroutine testElement_dmetric_dx
    !***************************************************************************************





    !> Test cartesian dgrad1_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad1_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 

        test_dgrad1_dx(:,:,1,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.04976067743425171_rk, -0.02872934051172335_rk, -0.02872934051172335_rk, 0.0_rk, 0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.04976067743425171_rk, -0.02872934051172335_rk, -0.02872934051172335_rk, 0.0_rk, 0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, 0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, -0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, 0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, -0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, -0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, -0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, -0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, -0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0035726558990816365_rk, 0.002062673845056689_rk, 0.002062673845056689_rk, 0.0_rk, 0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0035726558990816365_rk, 0.002062673845056689_rk, 0.002062673845056689_rk, 0.0_rk, 0.0011908852996938787_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,1,2) = reshape((/ &
        0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.0_rk, -0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.0_rk, -0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.0_rk, 0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.0_rk, 0.010313369225283434_rk, 0.005954426498469393_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.005954426498469393_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.04976067743425171_rk, 0.02872934051172335_rk, 0.02872934051172335_rk, 0.0_rk, -0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.04976067743425171_rk, 0.02872934051172335_rk, 0.02872934051172335_rk, 0.0_rk, -0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, -0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, 0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, -0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, 0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, 0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, 0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, 0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, 0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.0035726558990816365_rk, -0.002062673845056689_rk, -0.002062673845056689_rk, 0.0_rk, -0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.0035726558990816365_rk, -0.002062673845056689_rk, -0.002062673845056689_rk, 0.0_rk, -0.0011908852996938787_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,2) = reshape((/ &
        0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.0_rk, 0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.0_rk, 0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.0_rk, -0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.0_rk, -0.010313369225283434_rk, -0.005954426498469393_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, -0.005954426498469393_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, 0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, -0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, 0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, -0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.04976067743425171_rk, -0.02872934051172335_rk, 0.02872934051172335_rk, 0.0_rk, 0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.04976067743425171_rk, -0.02872934051172335_rk, 0.02872934051172335_rk, 0.0_rk, 0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.0035726558990816365_rk, 0.002062673845056689_rk, -0.002062673845056689_rk, 0.0_rk, 0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.0035726558990816365_rk, 0.002062673845056689_rk, -0.002062673845056689_rk, 0.0_rk, 0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, -0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, -0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, -0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, -0.004444444444444444_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,2) = reshape((/ &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.0_rk, 0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.0_rk, 0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.0_rk, -0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.0_rk, -0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, -0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, -0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, -0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, 0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, -0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, 0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.04976067743425171_rk, 0.02872934051172335_rk, -0.02872934051172335_rk, 0.0_rk, -0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.04976067743425171_rk, 0.02872934051172335_rk, -0.02872934051172335_rk, 0.0_rk, -0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0035726558990816365_rk, -0.002062673845056689_rk, 0.002062673845056689_rk, 0.0_rk, -0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0035726558990816365_rk, -0.002062673845056689_rk, 0.002062673845056689_rk, 0.0_rk, -0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, 0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, 0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, 0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, 0.004444444444444444_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,2) = reshape((/ &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.0_rk, -0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.0_rk, -0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.0_rk, 0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.0_rk, 0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, 0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, -0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, 0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, -0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, 0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0035726558990816365_rk, 0.002062673845056689_rk, -0.002062673845056689_rk, 0.0_rk, -0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0035726558990816365_rk, 0.002062673845056689_rk, -0.002062673845056689_rk, 0.0_rk, -0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.04976067743425171_rk, -0.02872934051172335_rk, 0.02872934051172335_rk, 0.0_rk, -0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.04976067743425171_rk, -0.02872934051172335_rk, 0.02872934051172335_rk, 0.0_rk, -0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, 0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, 0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, 0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, 0.004444444444444445_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,2) = reshape((/ &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.0_rk, -0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.0_rk, -0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.0_rk, 0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.0_rk, 0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, 0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, 0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, -0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, 0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, -0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.0035726558990816365_rk, -0.002062673845056689_rk, 0.002062673845056689_rk, 0.0_rk, 0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.0035726558990816365_rk, -0.002062673845056689_rk, 0.002062673845056689_rk, 0.0_rk, 0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.04976067743425171_rk, 0.02872934051172335_rk, -0.02872934051172335_rk, 0.0_rk, 0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.04976067743425171_rk, 0.02872934051172335_rk, -0.02872934051172335_rk, 0.0_rk, 0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, -0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, -0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, -0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, -0.004444444444444445_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,2) = reshape((/ &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.0_rk, 0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.0_rk, 0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.0_rk, -0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.0_rk, -0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, -0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, -0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.0035726558990816365_rk, 0.002062673845056689_rk, 0.002062673845056689_rk, 0.0_rk, -0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.0035726558990816365_rk, 0.002062673845056689_rk, 0.002062673845056689_rk, 0.0_rk, -0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, -0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, 0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, -0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, 0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, 0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, 0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.013333333333333336_rk, 0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, 0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.04976067743425171_rk, -0.02872934051172335_rk, -0.02872934051172335_rk, 0.0_rk, -0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.04976067743425171_rk, -0.02872934051172335_rk, -0.02872934051172335_rk, 0.0_rk, -0.016586892478083898_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,2) = reshape((/ &
        0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.0_rk, 0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.0_rk, 0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.0_rk, -0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.0_rk, -0.14364670255861678_rk, -0.0829344623904195_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, -0.0829344623904195_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0035726558990816365_rk, -0.002062673845056689_rk, -0.002062673845056689_rk, 0.0_rk, 0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0035726558990816365_rk, -0.002062673845056689_rk, -0.002062673845056689_rk, 0.0_rk, 0.0011908852996938787_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, 0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, -0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, 0.007698003589195011_rk, -0.007698003589195011_rk, 0.0_rk, -0.004444444444444444_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, -0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, -0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.013333333333333336_rk, -0.007698003589195011_rk, 0.007698003589195011_rk, 0.0_rk, -0.004444444444444445_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.04976067743425171_rk, 0.02872934051172335_rk, 0.02872934051172335_rk, 0.0_rk, 0.016586892478083898_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.04976067743425171_rk, 0.02872934051172335_rk, 0.02872934051172335_rk, 0.0_rk, 0.016586892478083898_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,2) = reshape((/ &
        0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, 0.0_rk, -0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, 0.0_rk, -0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.0_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.0_rk, 0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.0_rk, 0.14364670255861678_rk, 0.0829344623904195_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.0_rk, 0.0_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.0_rk, 0.0_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.0_rk, 0.0_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0829344623904195_rk   &
        /),(/8,8/))



        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%elem%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad1_dx
    !*******************************************************************************************






    !> Test cartesian dgrad2_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad2_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad2_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad2_dx
        ! 

        test_dgrad2_dx(:,:,1,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,1,2) = reshape((/ &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, 0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,2) = reshape((/ &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,2) = reshape((/ &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,2) = reshape((/ &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, -0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,2) = reshape((/ &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,2) = reshape((/ &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, 0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,2) = reshape((/ &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, -0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,2) = reshape((/ &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk   &
        /),(/8,8/))

        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%elem%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad2_dx
    !*******************************************************************************************







    !> Test cartesian dgrad3_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad3_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad3_dx
        ! 

        test_dgrad3_dx(:,:,1,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,1,2) = reshape((/ &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, 0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,2) = reshape((/ &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,2) = reshape((/ &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, 0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.01786327949540819_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.24880338717125847_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,2) = reshape((/ &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,2) = reshape((/ &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, -0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, -0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, 0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, -0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,2) = reshape((/ &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,2) = reshape((/ &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, -0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.010313369225283434_rk, 0.010313369225283434_rk, 0.0_rk, -0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, -0.14364670255861678_rk, 0.14364670255861678_rk, 0.0_rk, 0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, 0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, 0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, 0.022222222222222223_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.01786327949540819_rk, 0.010313369225283434_rk, -0.010313369225283434_rk, 0.0_rk, 0.005954426498469393_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.24880338717125847_rk, -0.14364670255861678_rk, -0.14364670255861678_rk, 0.0_rk, -0.0829344623904195_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.06666666666666668_rk, -0.03849001794597505_rk, -0.03849001794597505_rk, 0.0_rk, -0.022222222222222223_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,2) = reshape((/ &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.0_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.0_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.0_rk, -0.19245008972987526_rk, -0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk   &
        /),(/8,8/))

        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%elem%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad3_dx
    !*******************************************************************************************







    !> Test cartesian dinvmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dinvmass_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dinvmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dinvmass_dx
        ! 

        test_dinvmass_dx(:,:,1,1) = reshape((/ &
        0.010000000000000002_rk, -0.010000000000000002_rk, -0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.010000000000000002_rk, 0.0_rk,   &
        -0.010000000000000002_rk, 0.030000000000000002_rk, 0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.0_rk,   &
        -0.010000000000000002_rk, 0.010000000000000002_rk, 0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000002_rk, -0.030000000000000006_rk, -0.030000000000000006_rk, 0.0_rk, 0.030000000000000006_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000002_rk, 0.09000000000000002_rk, 0.030000000000000006_rk, 0.0_rk, -0.09000000000000002_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.03_rk, 0.030000000000000006_rk, 0.09000000000000002_rk, 0.0_rk, -0.09000000000000002_rk,   &
        0.010000000000000002_rk, -0.03_rk, -0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.09000000000000002_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, -0.09000000000000002_rk, -0.09000000000000002_rk, 0.0_rk, 0.2700000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,1,2) = reshape((/ &
        0.05_rk, 0.0_rk, -0.05_rk, -0.049999999999999996_rk, 0.0_rk, 0.05_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.15000000000000005_rk, 0.0_rk, -0.15000000000000008_rk, 0.15000000000000002_rk,   &
        -0.05_rk, 0.0_rk, 0.15000000000000002_rk, 0.05_rk, 0.0_rk, -0.15000000000000005_rk, 0.0_rk, 0.0_rk,   &
        -0.049999999999999996_rk, 0.0_rk, 0.05_rk, 0.15000000000000002_rk, 0.0_rk, -0.15000000000000008_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, 0.15000000000000002_rk, -0.4500000000000001_rk,   &
        0.05_rk, 0.0_rk, -0.15_rk, -0.15_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15_rk, 0.0_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.4500000000000001_rk, -0.4500000000000001_rk,   &
        0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, -0.4500000000000001_rk, 1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,1,3) = reshape((/ &
        0.05_rk, -0.049999999999999996_rk, -3.469446951953614e-18_rk, -0.049999999999999996_rk, 0.049999999999999996_rk, 3.469446951953614e-18_rk, 3.469446951953614e-18_rk, 3.469446951953614e-18_rk,   &
        -0.049999999999999996_rk, 0.15000000000000002_rk, 3.469446951953614e-18_rk, 0.049999999999999996_rk, -0.15000000000000005_rk, 0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, 3.469446951953614e-18_rk, 0.15000000000000002_rk, 3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000005_rk, -0.15000000000000005_rk, 0.15000000000000002_rk,   &
        -0.049999999999999996_rk, 0.049999999999999996_rk, 3.469446951953614e-18_rk, 0.15000000000000002_rk, -0.15000000000000005_rk, -1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.049999999999999996_rk, -0.15_rk, 3.469446951953614e-18_rk, -0.15_rk, 0.4500000000000001_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, 3.469446951953614e-18_rk, -0.15_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.15000000000000002_rk, -0.4500000000000001_rk,   &
        3.469446951953614e-18_rk, 0.0_rk, -0.15_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000002_rk, 0.4500000000000001_rk, -0.4500000000000001_rk,   &
        3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, -0.4500000000000001_rk, 1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,1) = reshape((/ &
        -0.010000000000000002_rk, 0.010000000000000002_rk, 0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.010000000000000002_rk, 0.0_rk,   &
        0.010000000000000002_rk, -0.030000000000000002_rk, -0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.0_rk,   &
        0.010000000000000002_rk, -0.010000000000000002_rk, -0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000002_rk, 0.030000000000000006_rk, 0.030000000000000006_rk, 0.0_rk, -0.030000000000000006_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000002_rk, -0.09000000000000002_rk, -0.030000000000000006_rk, 0.0_rk, 0.09000000000000002_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.03_rk, -0.030000000000000006_rk, -0.09000000000000002_rk, 0.0_rk, 0.09000000000000002_rk,   &
        -0.010000000000000002_rk, 0.03_rk, 0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.09000000000000002_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.09000000000000002_rk, 0.09000000000000002_rk, 0.0_rk, -0.2700000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,2) = reshape((/ &
        0.05_rk, 0.0_rk, -0.05_rk, 0.049999999999999996_rk, 0.0_rk, -0.05_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.15000000000000005_rk, 0.0_rk, -0.15000000000000008_rk, -0.15000000000000002_rk,   &
        -0.05_rk, 0.0_rk, 0.15000000000000002_rk, -0.05_rk, 0.0_rk, 0.15000000000000005_rk, 0.0_rk, 0.0_rk,   &
        0.049999999999999996_rk, 0.0_rk, -0.05_rk, 0.15000000000000002_rk, 0.0_rk, -0.15000000000000008_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, -0.15000000000000002_rk, -0.4500000000000001_rk,   &
        -0.05_rk, 0.0_rk, 0.15_rk, -0.15_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15_rk, 0.0_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.4500000000000001_rk, 0.4500000000000001_rk,   &
        0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, 0.4500000000000001_rk, 1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,3) = reshape((/ &
        0.05_rk, -0.049999999999999996_rk, -3.469446951953614e-18_rk, 0.049999999999999996_rk, -0.049999999999999996_rk, -3.469446951953614e-18_rk, 3.469446951953614e-18_rk, -3.469446951953614e-18_rk,   &
        -0.049999999999999996_rk, 0.15000000000000002_rk, 3.469446951953614e-18_rk, -0.049999999999999996_rk, 0.15000000000000005_rk, 0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, 3.469446951953614e-18_rk, 0.15000000000000002_rk, -3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000005_rk, -0.15000000000000005_rk, -0.15000000000000002_rk,   &
        0.049999999999999996_rk, -0.049999999999999996_rk, -3.469446951953614e-18_rk, 0.15000000000000002_rk, -0.15000000000000005_rk, -1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        -0.049999999999999996_rk, 0.15_rk, -3.469446951953614e-18_rk, -0.15_rk, 0.4500000000000001_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, -3.469446951953614e-18_rk, 0.15_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, -0.15000000000000002_rk, -0.4500000000000001_rk,   &
        3.469446951953614e-18_rk, 0.0_rk, -0.15_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000002_rk, 0.4500000000000001_rk, 0.4500000000000001_rk,   &
        -3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.4500000000000001_rk, 1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,1) = reshape((/ &
        -0.010000000000000002_rk, -0.010000000000000002_rk, 0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.010000000000000002_rk, 0.0_rk,   &
        -0.010000000000000002_rk, -0.030000000000000002_rk, 0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.0_rk,   &
        0.010000000000000002_rk, 0.010000000000000002_rk, -0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000002_rk, -0.030000000000000006_rk, 0.030000000000000006_rk, 0.0_rk, 0.030000000000000006_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000002_rk, -0.09000000000000002_rk, 0.030000000000000006_rk, 0.0_rk, 0.09000000000000002_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.03_rk, 0.030000000000000006_rk, -0.09000000000000002_rk, 0.0_rk, -0.09000000000000002_rk,   &
        0.010000000000000002_rk, 0.03_rk, -0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.09000000000000002_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.09000000000000002_rk, -0.09000000000000002_rk, 0.0_rk, -0.2700000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,2) = reshape((/ &
        -0.05_rk, 0.0_rk, 0.05_rk, -0.049999999999999996_rk, 0.0_rk, 0.05_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.15000000000000005_rk, 0.0_rk, 0.15000000000000008_rk, 0.15000000000000002_rk,   &
        0.05_rk, 0.0_rk, -0.15000000000000002_rk, 0.05_rk, 0.0_rk, -0.15000000000000005_rk, 0.0_rk, 0.0_rk,   &
        -0.049999999999999996_rk, 0.0_rk, 0.05_rk, -0.15000000000000002_rk, 0.0_rk, 0.15000000000000008_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, 0.15000000000000002_rk, 0.4500000000000001_rk,   &
        0.05_rk, 0.0_rk, -0.15_rk, 0.15_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15_rk, 0.0_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, -0.4500000000000001_rk, -0.4500000000000001_rk,   &
        0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, -0.4500000000000001_rk, -1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,3) = reshape((/ &
        0.05_rk, 0.049999999999999996_rk, -3.469446951953614e-18_rk, 0.049999999999999996_rk, 0.049999999999999996_rk, -3.469446951953614e-18_rk, -3.469446951953614e-18_rk, 3.469446951953614e-18_rk,   &
        0.049999999999999996_rk, 0.15000000000000002_rk, -3.469446951953614e-18_rk, 0.049999999999999996_rk, 0.15000000000000005_rk, 0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, -3.469446951953614e-18_rk, 0.15000000000000002_rk, -3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000005_rk, 0.15000000000000005_rk, 0.15000000000000002_rk,   &
        0.049999999999999996_rk, 0.049999999999999996_rk, -3.469446951953614e-18_rk, 0.15000000000000002_rk, 0.15000000000000005_rk, -1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.049999999999999996_rk, 0.15_rk, 3.469446951953614e-18_rk, 0.15_rk, 0.4500000000000001_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, 3.469446951953614e-18_rk, 0.15_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.15000000000000002_rk, 0.4500000000000001_rk,   &
        -3.469446951953614e-18_rk, 0.0_rk, 0.15_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000002_rk, 0.4500000000000001_rk, 0.4500000000000001_rk,   &
        3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.4500000000000001_rk, 1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,1) = reshape((/ &
        0.010000000000000002_rk, 0.010000000000000002_rk, -0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.010000000000000002_rk, 0.0_rk,   &
        0.010000000000000002_rk, 0.030000000000000002_rk, -0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.0_rk,   &
        -0.010000000000000002_rk, -0.010000000000000002_rk, 0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000002_rk, 0.030000000000000006_rk, -0.030000000000000006_rk, 0.0_rk, -0.030000000000000006_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000002_rk, 0.09000000000000002_rk, -0.030000000000000006_rk, 0.0_rk, -0.09000000000000002_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.03_rk, -0.030000000000000006_rk, 0.09000000000000002_rk, 0.0_rk, 0.09000000000000002_rk,   &
        -0.010000000000000002_rk, -0.03_rk, 0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.09000000000000002_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, -0.09000000000000002_rk, 0.09000000000000002_rk, 0.0_rk, 0.2700000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,2) = reshape((/ &
        -0.05_rk, 0.0_rk, 0.05_rk, 0.049999999999999996_rk, 0.0_rk, -0.05_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.15000000000000005_rk, 0.0_rk, 0.15000000000000008_rk, -0.15000000000000002_rk,   &
        0.05_rk, 0.0_rk, -0.15000000000000002_rk, -0.05_rk, 0.0_rk, 0.15000000000000005_rk, 0.0_rk, 0.0_rk,   &
        0.049999999999999996_rk, 0.0_rk, -0.05_rk, -0.15000000000000002_rk, 0.0_rk, 0.15000000000000008_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, -0.15000000000000002_rk, 0.4500000000000001_rk,   &
        -0.05_rk, 0.0_rk, 0.15_rk, 0.15_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15_rk, 0.0_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, -0.4500000000000001_rk, 0.4500000000000001_rk,   &
        0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, 0.4500000000000001_rk, -1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,3) = reshape((/ &
        0.05_rk, 0.049999999999999996_rk, -3.469446951953614e-18_rk, -0.049999999999999996_rk, -0.049999999999999996_rk, 3.469446951953614e-18_rk, -3.469446951953614e-18_rk, -3.469446951953614e-18_rk,   &
        0.049999999999999996_rk, 0.15000000000000002_rk, -3.469446951953614e-18_rk, -0.049999999999999996_rk, -0.15000000000000005_rk, 0.0_rk, -1.3877787807814457e-17_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, -3.469446951953614e-18_rk, 0.15000000000000002_rk, 3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000005_rk, 0.15000000000000005_rk, -0.15000000000000002_rk,   &
        -0.049999999999999996_rk, -0.049999999999999996_rk, 3.469446951953614e-18_rk, 0.15000000000000002_rk, 0.15000000000000005_rk, -1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        -0.049999999999999996_rk, -0.15_rk, -3.469446951953614e-18_rk, 0.15_rk, 0.4500000000000001_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, -3.469446951953614e-18_rk, -0.15_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, -0.15000000000000002_rk, 0.4500000000000001_rk,   &
        -3.469446951953614e-18_rk, 0.0_rk, 0.15_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000002_rk, 0.4500000000000001_rk, -0.4500000000000001_rk,   &
        -3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, -0.4500000000000001_rk, 1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,1) = reshape((/ &
        0.010000000000000002_rk, -0.010000000000000002_rk, 0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.010000000000000002_rk, 0.0_rk,   &
        -0.010000000000000002_rk, 0.030000000000000002_rk, -0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.0_rk,   &
        0.010000000000000002_rk, -0.010000000000000002_rk, 0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000002_rk, -0.030000000000000006_rk, 0.030000000000000006_rk, 0.0_rk, -0.03_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000002_rk, 0.09000000000000002_rk, -0.03_rk, 0.0_rk, 0.09000000000000002_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, -0.03_rk, 0.09000000000000002_rk, 0.0_rk, -0.09000000000000002_rk,   &
        -0.010000000000000002_rk, 0.030000000000000006_rk, -0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.09000000000000002_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.03_rk, 0.09000000000000002_rk, -0.09000000000000002_rk, 0.0_rk, 0.2700000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,2) = reshape((/ &
        0.05_rk, 0.0_rk, 0.04999999999999999_rk, -0.049999999999999996_rk, 0.0_rk, -0.04999999999999999_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.15000000000000005_rk, 0.0_rk, 0.15000000000000002_rk, -0.15000000000000002_rk,   &
        0.04999999999999999_rk, 0.0_rk, 0.15000000000000002_rk, -0.04999999999999999_rk, 0.0_rk, -0.15000000000000005_rk, 0.0_rk, 0.0_rk,   &
        -0.049999999999999996_rk, 0.0_rk, -0.04999999999999999_rk, 0.15000000000000002_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, -0.15000000000000002_rk, 0.4500000000000001_rk,   &
        -0.04999999999999999_rk, 0.0_rk, -0.15_rk, 0.15_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15_rk, 0.0_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.4500000000000001_rk, -0.4500000000000001_rk,   &
        0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, -0.4500000000000001_rk, 1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,3) = reshape((/ &
        -0.05_rk, 0.049999999999999996_rk, 3.469446951953614e-18_rk, 0.049999999999999996_rk, -0.049999999999999996_rk, -3.469446951953614e-18_rk, -3.469446951953614e-18_rk, -3.469446951953614e-18_rk,   &
        0.049999999999999996_rk, -0.15000000000000002_rk, -3.469446951953614e-18_rk, -0.049999999999999996_rk, 0.15000000000000005_rk, 0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, -3.469446951953614e-18_rk, -0.15000000000000002_rk, -3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000005_rk, 0.15000000000000005_rk, -0.15000000000000002_rk,   &
        0.049999999999999996_rk, -0.049999999999999996_rk, -3.469446951953614e-18_rk, -0.15000000000000002_rk, 0.15000000000000005_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        -0.049999999999999996_rk, 0.15_rk, -3.469446951953614e-18_rk, 0.15_rk, -0.4500000000000001_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, -3.469446951953614e-18_rk, 0.15_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, -0.15000000000000002_rk, 0.4500000000000001_rk,   &
        -3.469446951953614e-18_rk, 0.0_rk, 0.15_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000002_rk, -0.4500000000000001_rk, 0.4500000000000001_rk,   &
        -3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.4500000000000001_rk, -1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,1) = reshape((/ &
        -0.010000000000000002_rk, 0.010000000000000002_rk, -0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.010000000000000002_rk, 0.0_rk,   &
        0.010000000000000002_rk, -0.030000000000000002_rk, 0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.0_rk,   &
        -0.010000000000000002_rk, 0.010000000000000002_rk, -0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000002_rk, 0.030000000000000006_rk, -0.030000000000000006_rk, 0.0_rk, 0.03_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000002_rk, -0.09000000000000002_rk, 0.03_rk, 0.0_rk, -0.09000000000000002_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.03_rk, -0.09000000000000002_rk, 0.0_rk, 0.09000000000000002_rk,   &
        0.010000000000000002_rk, -0.030000000000000006_rk, 0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.09000000000000002_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.03_rk, -0.09000000000000002_rk, 0.09000000000000002_rk, 0.0_rk, -0.2700000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,2) = reshape((/ &
        0.05_rk, 0.0_rk, 0.04999999999999999_rk, 0.049999999999999996_rk, 0.0_rk, 0.04999999999999999_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.15000000000000005_rk, 0.0_rk, 0.15000000000000002_rk, 0.15000000000000002_rk,   &
        0.04999999999999999_rk, 0.0_rk, 0.15000000000000002_rk, 0.04999999999999999_rk, 0.0_rk, 0.15000000000000005_rk, 0.0_rk, 0.0_rk,   &
        0.049999999999999996_rk, 0.0_rk, 0.04999999999999999_rk, 0.15000000000000002_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, 0.15000000000000002_rk, 0.4500000000000001_rk,   &
        0.04999999999999999_rk, 0.0_rk, 0.15_rk, 0.15_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15_rk, 0.0_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.4500000000000001_rk, 0.4500000000000001_rk,   &
        0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, 0.0_rk, 0.4500000000000001_rk, 1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,3) = reshape((/ &
        -0.05_rk, 0.049999999999999996_rk, 3.469446951953614e-18_rk, -0.049999999999999996_rk, 0.049999999999999996_rk, 3.469446951953614e-18_rk, -3.469446951953614e-18_rk, 3.469446951953614e-18_rk,   &
        0.049999999999999996_rk, -0.15000000000000002_rk, -3.469446951953614e-18_rk, 0.049999999999999996_rk, -0.15000000000000005_rk, 0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, -3.469446951953614e-18_rk, -0.15000000000000002_rk, 3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000005_rk, 0.15000000000000005_rk, 0.15000000000000002_rk,   &
        -0.049999999999999996_rk, 0.049999999999999996_rk, 3.469446951953614e-18_rk, -0.15000000000000002_rk, 0.15000000000000005_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.049999999999999996_rk, -0.15_rk, 3.469446951953614e-18_rk, 0.15_rk, -0.4500000000000001_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, 3.469446951953614e-18_rk, -0.15_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.15000000000000002_rk, 0.4500000000000001_rk,   &
        -3.469446951953614e-18_rk, 0.0_rk, 0.15_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000002_rk, -0.4500000000000001_rk, -0.4500000000000001_rk,   &
        3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.4500000000000001_rk, -0.4500000000000001_rk, -1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,1) = reshape((/ &
        -0.010000000000000002_rk, -0.010000000000000002_rk, -0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.010000000000000002_rk, 0.0_rk,   &
        -0.010000000000000002_rk, -0.030000000000000002_rk, -0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.0_rk,   &
        -0.010000000000000002_rk, -0.010000000000000002_rk, -0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000002_rk, -0.030000000000000006_rk, -0.030000000000000006_rk, 0.0_rk, -0.03_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000002_rk, -0.09000000000000002_rk, -0.03_rk, 0.0_rk, -0.09000000000000002_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.030000000000000006_rk, -0.03_rk, -0.09000000000000002_rk, 0.0_rk, -0.09000000000000002_rk,   &
        -0.010000000000000002_rk, -0.030000000000000006_rk, -0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.09000000000000002_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.03_rk, -0.09000000000000002_rk, -0.09000000000000002_rk, 0.0_rk, -0.2700000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,2) = reshape((/ &
        -0.05_rk, 0.0_rk, -0.04999999999999999_rk, -0.049999999999999996_rk, 0.0_rk, -0.04999999999999999_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.15000000000000005_rk, 0.0_rk, -0.15000000000000002_rk, -0.15000000000000002_rk,   &
        -0.04999999999999999_rk, 0.0_rk, -0.15000000000000002_rk, -0.04999999999999999_rk, 0.0_rk, -0.15000000000000005_rk, 0.0_rk, 0.0_rk,   &
        -0.049999999999999996_rk, 0.0_rk, -0.04999999999999999_rk, -0.15000000000000002_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, -0.15000000000000002_rk, -0.4500000000000001_rk,   &
        -0.04999999999999999_rk, 0.0_rk, -0.15_rk, -0.15_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15_rk, 0.0_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, -0.4500000000000001_rk, -0.4500000000000001_rk,   &
        0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, -0.4500000000000001_rk, -1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,3) = reshape((/ &
        -0.05_rk, -0.049999999999999996_rk, 3.469446951953614e-18_rk, -0.049999999999999996_rk, -0.049999999999999996_rk, 3.469446951953614e-18_rk, 3.469446951953614e-18_rk, -3.469446951953614e-18_rk,   &
        -0.049999999999999996_rk, -0.15000000000000002_rk, 3.469446951953614e-18_rk, -0.049999999999999996_rk, -0.15000000000000005_rk, 0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, 3.469446951953614e-18_rk, -0.15000000000000002_rk, 3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000005_rk, -0.15000000000000005_rk, -0.15000000000000002_rk,   &
        -0.049999999999999996_rk, -0.049999999999999996_rk, 3.469446951953614e-18_rk, -0.15000000000000002_rk, -0.15000000000000005_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        -0.049999999999999996_rk, -0.15_rk, -3.469446951953614e-18_rk, -0.15_rk, -0.4500000000000001_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, -3.469446951953614e-18_rk, -0.15_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, -0.15000000000000002_rk, -0.4500000000000001_rk,   &
        3.469446951953614e-18_rk, 0.0_rk, -0.15_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000002_rk, -0.4500000000000001_rk, -0.4500000000000001_rk,   &
        -3.469446951953614e-18_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, -0.4500000000000001_rk, -1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,1) = reshape((/ &
        0.010000000000000002_rk, 0.010000000000000002_rk, 0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.010000000000000002_rk, 0.0_rk,   &
        0.010000000000000002_rk, 0.030000000000000002_rk, 0.010000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.0_rk,   &
        0.010000000000000002_rk, 0.010000000000000002_rk, 0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000002_rk, 0.030000000000000006_rk, 0.030000000000000006_rk, 0.0_rk, 0.03_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000002_rk, 0.09000000000000002_rk, 0.03_rk, 0.0_rk, 0.09000000000000002_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.030000000000000006_rk, 0.03_rk, 0.09000000000000002_rk, 0.0_rk, 0.09000000000000002_rk,   &
        0.010000000000000002_rk, 0.030000000000000006_rk, 0.030000000000000002_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.09000000000000002_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.03_rk, 0.09000000000000002_rk, 0.09000000000000002_rk, 0.0_rk, 0.2700000000000001_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,2) = reshape((/ &
        -0.05_rk, 0.0_rk, -0.04999999999999999_rk, 0.049999999999999996_rk, 0.0_rk, 0.04999999999999999_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk, 0.15000000000000005_rk, 0.0_rk, -0.15000000000000002_rk, 0.15000000000000002_rk,   &
        -0.04999999999999999_rk, 0.0_rk, -0.15000000000000002_rk, 0.04999999999999999_rk, 0.0_rk, 0.15000000000000005_rk, 0.0_rk, 0.0_rk,   &
        0.049999999999999996_rk, 0.0_rk, 0.04999999999999999_rk, -0.15000000000000002_rk, 0.0_rk, -0.15000000000000002_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.15_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, 0.15000000000000002_rk, -0.4500000000000001_rk,   &
        0.04999999999999999_rk, 0.0_rk, 0.15_rk, -0.15_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.15_rk, 0.0_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, -0.4500000000000001_rk, 0.4500000000000001_rk,   &
        0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.0_rk, 0.4500000000000001_rk, -1.35_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,3) = reshape((/ &
        -0.05_rk, -0.049999999999999996_rk, 3.469446951953614e-18_rk, 0.049999999999999996_rk, 0.049999999999999996_rk, -3.469446951953614e-18_rk, 3.469446951953614e-18_rk, 3.469446951953614e-18_rk,   &
        -0.049999999999999996_rk, -0.15000000000000002_rk, 3.469446951953614e-18_rk, 0.049999999999999996_rk, 0.15000000000000005_rk, 0.0_rk, 1.3877787807814457e-17_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, 3.469446951953614e-18_rk, -0.15000000000000002_rk, -3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000005_rk, -0.15000000000000005_rk, 0.15000000000000002_rk,   &
        0.049999999999999996_rk, 0.049999999999999996_rk, -3.469446951953614e-18_rk, -0.15000000000000002_rk, -0.15000000000000005_rk, 1.3877787807814457e-17_rk, 0.0_rk, 0.0_rk,   &
        0.049999999999999996_rk, 0.15_rk, 3.469446951953614e-18_rk, -0.15_rk, -0.4500000000000001_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, 3.469446951953614e-18_rk, 0.15_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.15000000000000002_rk, -0.4500000000000001_rk,   &
        3.469446951953614e-18_rk, 0.0_rk, -0.15_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000002_rk, -0.4500000000000001_rk, 0.4500000000000001_rk,   &
        3.469446951953614e-18_rk, 0.0_rk, 0.15000000000000002_rk, 0.0_rk, 0.0_rk, -0.4500000000000001_rk, 0.4500000000000001_rk, -1.35_rk   &
        /),(/8,8/))


        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dinvmass_dx(:,:,inode_diff,idir)),self%elem%dinvmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dinvmass_dx
    !*******************************************************************************************







    !> Test cartesian dmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmass_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dmass_dx
        ! 

        test_dmass_dx(:,:,1,1) = reshape((/ &
        -0.25_rk, 0.08333333333333333_rk, 0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.027777777777777783_rk, 0.0_rk,   &
        0.08333333333333333_rk, -0.08333333333333333_rk, -0.027777777777777783_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.0_rk,   &
        0.08333333333333333_rk, -0.027777777777777783_rk, -0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08333333333333333_rk, 0.02777777777777777_rk, 0.02777777777777777_rk, 0.0_rk, -0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, -0.027777777777777783_rk, -0.009259259259259259_rk, 0.0_rk, 0.009259259259259262_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, -0.009259259259259259_rk, -0.027777777777777783_rk, 0.0_rk, 0.00925925925925926_rk,   &
        -0.027777777777777783_rk, 0.02777777777777777_rk, 0.02777777777777777_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.027777777777777783_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.009259259259259259_rk, 0.009259259259259262_rk, 0.00925925925925926_rk, 0.0_rk, -0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,1,2) = reshape((/ &
        -1.25_rk, 0.0_rk, 0.41666666666666663_rk, 0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4166666666666666_rk, 0.0_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, -0.04629629629629628_rk,   &
        0.41666666666666663_rk, 0.0_rk, -0.4166666666666666_rk, -0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, -0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, -0.04629629629629629_rk, 0.04629629629629629_rk,   &
        -0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, -0.04629629629629629_rk, 0.0_rk, -0.13888888888888887_rk, 0.04629629629629629_rk,   &
        0.0_rk, -0.04629629629629628_rk, 0.0_rk, 0.0_rk, 0.04629629629629629_rk, 0.0_rk, 0.04629629629629629_rk, -0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,1,3) = reshape((/ &
        -1.25_rk, 0.4166666666666666_rk, 2.7755575615628914e-17_rk, 0.4166666666666666_rk, -0.13888888888888887_rk, -6.938893903907228e-18_rk, -6.938893903907228e-18_rk, -3.469446951953614e-18_rk,   &
        0.4166666666666666_rk, -0.4166666666666666_rk, -6.938893903907228e-18_rk, -0.13888888888888887_rk, 0.13888888888888887_rk, -3.469446951953614e-18_rk, 6.938893903907228e-18_rk, 3.469446951953614e-18_rk,   &
        2.7755575615628914e-17_rk, -6.938893903907228e-18_rk, -0.4166666666666666_rk, -6.938893903907228e-18_rk, -3.469446951953614e-18_rk, 0.13888888888888887_rk, 0.13888888888888887_rk, -0.04629629629629629_rk,   &
        0.4166666666666666_rk, -0.13888888888888887_rk, -6.938893903907228e-18_rk, -0.4166666666666666_rk, 0.13888888888888887_rk, 6.938893903907228e-18_rk, -3.469446951953614e-18_rk, 3.469446951953614e-18_rk,   &
        -0.13888888888888887_rk, 0.13888888888888887_rk, -3.469446951953614e-18_rk, 0.13888888888888887_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        -6.938893903907228e-18_rk, -3.469446951953614e-18_rk, 0.13888888888888887_rk, 6.938893903907228e-18_rk, 0.0_rk, -0.13888888888888887_rk, -0.04629629629629629_rk, 0.04629629629629629_rk,   &
        -6.938893903907228e-18_rk, 6.938893903907228e-18_rk, 0.13888888888888887_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.04629629629629629_rk, -0.13888888888888887_rk, 0.04629629629629629_rk,   &
        -3.469446951953614e-18_rk, 3.469446951953614e-18_rk, -0.04629629629629629_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.04629629629629629_rk, 0.04629629629629629_rk, -0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,1) = reshape((/ &
        0.25_rk, -0.08333333333333333_rk, -0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.027777777777777783_rk, 0.0_rk,   &
        -0.08333333333333333_rk, 0.08333333333333333_rk, 0.027777777777777783_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.0_rk,   &
        -0.08333333333333333_rk, 0.027777777777777783_rk, 0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08333333333333333_rk, -0.02777777777777777_rk, -0.02777777777777777_rk, 0.0_rk, 0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.027777777777777783_rk, 0.009259259259259259_rk, 0.0_rk, -0.009259259259259262_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.009259259259259259_rk, 0.027777777777777783_rk, 0.0_rk, -0.00925925925925926_rk,   &
        0.027777777777777783_rk, -0.02777777777777777_rk, -0.02777777777777777_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.027777777777777783_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.009259259259259259_rk, -0.009259259259259262_rk, -0.00925925925925926_rk, 0.0_rk, 0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,2) = reshape((/ &
        -1.25_rk, 0.0_rk, 0.41666666666666663_rk, -0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4166666666666666_rk, 0.0_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.04629629629629628_rk,   &
        0.41666666666666663_rk, 0.0_rk, -0.4166666666666666_rk, 0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        -0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, -0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.04629629629629629_rk, 0.04629629629629629_rk,   &
        0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.04629629629629629_rk, 0.0_rk, -0.13888888888888887_rk, -0.04629629629629629_rk,   &
        0.0_rk, 0.04629629629629628_rk, 0.0_rk, 0.0_rk, 0.04629629629629629_rk, 0.0_rk, -0.04629629629629629_rk, -0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,3) = reshape((/ &
        -1.25_rk, 0.4166666666666666_rk, 2.7755575615628914e-17_rk, -0.4166666666666666_rk, 0.13888888888888887_rk, 6.938893903907228e-18_rk, -6.938893903907228e-18_rk, 3.469446951953614e-18_rk,   &
        0.4166666666666666_rk, -0.4166666666666666_rk, -6.938893903907228e-18_rk, 0.13888888888888887_rk, -0.13888888888888887_rk, 3.469446951953614e-18_rk, 6.938893903907228e-18_rk, -3.469446951953614e-18_rk,   &
        2.7755575615628914e-17_rk, -6.938893903907228e-18_rk, -0.4166666666666666_rk, 6.938893903907228e-18_rk, 3.469446951953614e-18_rk, -0.13888888888888887_rk, 0.13888888888888887_rk, 0.04629629629629629_rk,   &
        -0.4166666666666666_rk, 0.13888888888888887_rk, 6.938893903907228e-18_rk, -0.4166666666666666_rk, 0.13888888888888887_rk, 6.938893903907228e-18_rk, 3.469446951953614e-18_rk, 3.469446951953614e-18_rk,   &
        0.13888888888888887_rk, -0.13888888888888887_rk, 3.469446951953614e-18_rk, 0.13888888888888887_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        6.938893903907228e-18_rk, 3.469446951953614e-18_rk, -0.13888888888888887_rk, 6.938893903907228e-18_rk, 0.0_rk, -0.13888888888888887_rk, 0.04629629629629629_rk, 0.04629629629629629_rk,   &
        -6.938893903907228e-18_rk, 6.938893903907228e-18_rk, 0.13888888888888887_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.04629629629629629_rk, -0.13888888888888887_rk, -0.04629629629629629_rk,   &
        3.469446951953614e-18_rk, -3.469446951953614e-18_rk, 0.04629629629629629_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.04629629629629629_rk, -0.04629629629629629_rk, -0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,1) = reshape((/ &
        0.25_rk, 0.08333333333333333_rk, -0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.027777777777777783_rk, 0.0_rk,   &
        0.08333333333333333_rk, 0.08333333333333333_rk, -0.027777777777777783_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.0_rk,   &
        -0.08333333333333333_rk, -0.027777777777777783_rk, 0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08333333333333333_rk, 0.02777777777777777_rk, -0.02777777777777777_rk, 0.0_rk, -0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.027777777777777783_rk, -0.009259259259259259_rk, 0.0_rk, -0.009259259259259262_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, -0.009259259259259259_rk, 0.027777777777777783_rk, 0.0_rk, 0.00925925925925926_rk,   &
        -0.027777777777777783_rk, -0.02777777777777777_rk, 0.02777777777777777_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.027777777777777783_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.009259259259259259_rk, -0.009259259259259262_rk, 0.00925925925925926_rk, 0.0_rk, 0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,2) = reshape((/ &
        1.25_rk, 0.0_rk, -0.41666666666666663_rk, 0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.4166666666666666_rk, 0.0_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, -0.04629629629629628_rk,   &
        -0.41666666666666663_rk, 0.0_rk, 0.4166666666666666_rk, -0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, -0.04629629629629629_rk, -0.04629629629629629_rk,   &
        -0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, -0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, -0.04629629629629629_rk, 0.0_rk, 0.13888888888888887_rk, 0.04629629629629629_rk,   &
        0.0_rk, -0.04629629629629628_rk, 0.0_rk, 0.0_rk, -0.04629629629629629_rk, 0.0_rk, 0.04629629629629629_rk, 0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,3) = reshape((/ &
        -1.25_rk, -0.4166666666666666_rk, 2.7755575615628914e-17_rk, -0.4166666666666666_rk, -0.13888888888888887_rk, 6.938893903907228e-18_rk, 6.938893903907228e-18_rk, -3.469446951953614e-18_rk,   &
        -0.4166666666666666_rk, -0.4166666666666666_rk, 6.938893903907228e-18_rk, -0.13888888888888887_rk, -0.13888888888888887_rk, -3.469446951953614e-18_rk, 6.938893903907228e-18_rk, -3.469446951953614e-18_rk,   &
        2.7755575615628914e-17_rk, 6.938893903907228e-18_rk, -0.4166666666666666_rk, 6.938893903907228e-18_rk, -3.469446951953614e-18_rk, -0.13888888888888887_rk, -0.13888888888888887_rk, -0.04629629629629629_rk,   &
        -0.4166666666666666_rk, -0.13888888888888887_rk, 6.938893903907228e-18_rk, -0.4166666666666666_rk, -0.13888888888888887_rk, 6.938893903907228e-18_rk, -3.469446951953614e-18_rk, -3.469446951953614e-18_rk,   &
        -0.13888888888888887_rk, -0.13888888888888887_rk, -3.469446951953614e-18_rk, -0.13888888888888887_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        6.938893903907228e-18_rk, -3.469446951953614e-18_rk, -0.13888888888888887_rk, 6.938893903907228e-18_rk, 0.0_rk, -0.13888888888888887_rk, -0.04629629629629629_rk, -0.04629629629629629_rk,   &
        6.938893903907228e-18_rk, 6.938893903907228e-18_rk, -0.13888888888888887_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.04629629629629629_rk, -0.13888888888888887_rk, -0.04629629629629629_rk,   &
        -3.469446951953614e-18_rk, -3.469446951953614e-18_rk, -0.04629629629629629_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.04629629629629629_rk, -0.04629629629629629_rk, -0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,1) = reshape((/ &
        -0.25_rk, -0.08333333333333333_rk, 0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.027777777777777783_rk, 0.0_rk,   &
        -0.08333333333333333_rk, -0.08333333333333333_rk, 0.027777777777777783_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.0_rk,   &
        0.08333333333333333_rk, 0.027777777777777783_rk, -0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08333333333333333_rk, -0.02777777777777777_rk, 0.02777777777777777_rk, 0.0_rk, 0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, -0.027777777777777783_rk, 0.009259259259259259_rk, 0.0_rk, 0.009259259259259262_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.009259259259259259_rk, -0.027777777777777783_rk, 0.0_rk, -0.00925925925925926_rk,   &
        0.027777777777777783_rk, 0.02777777777777777_rk, -0.02777777777777777_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.027777777777777783_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.009259259259259259_rk, 0.009259259259259262_rk, -0.00925925925925926_rk, 0.0_rk, -0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,2) = reshape((/ &
        1.25_rk, 0.0_rk, -0.41666666666666663_rk, -0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.4166666666666666_rk, 0.0_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.04629629629629628_rk,   &
        -0.41666666666666663_rk, 0.0_rk, 0.4166666666666666_rk, 0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        -0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.04629629629629629_rk, -0.04629629629629629_rk,   &
        0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, -0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.04629629629629629_rk, 0.0_rk, 0.13888888888888887_rk, -0.04629629629629629_rk,   &
        0.0_rk, 0.04629629629629628_rk, 0.0_rk, 0.0_rk, -0.04629629629629629_rk, 0.0_rk, -0.04629629629629629_rk, 0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,3) = reshape((/ &
        -1.25_rk, -0.4166666666666666_rk, 2.7755575615628914e-17_rk, 0.4166666666666666_rk, 0.13888888888888887_rk, -6.938893903907228e-18_rk, 6.938893903907228e-18_rk, 3.469446951953614e-18_rk,   &
        -0.4166666666666666_rk, -0.4166666666666666_rk, 6.938893903907228e-18_rk, 0.13888888888888887_rk, 0.13888888888888887_rk, 3.469446951953614e-18_rk, 6.938893903907228e-18_rk, 3.469446951953614e-18_rk,   &
        2.7755575615628914e-17_rk, 6.938893903907228e-18_rk, -0.4166666666666666_rk, -6.938893903907228e-18_rk, 3.469446951953614e-18_rk, 0.13888888888888887_rk, -0.13888888888888887_rk, 0.04629629629629629_rk,   &
        0.4166666666666666_rk, 0.13888888888888887_rk, -6.938893903907228e-18_rk, -0.4166666666666666_rk, -0.13888888888888887_rk, 6.938893903907228e-18_rk, 3.469446951953614e-18_rk, -3.469446951953614e-18_rk,   &
        0.13888888888888887_rk, 0.13888888888888887_rk, 3.469446951953614e-18_rk, -0.13888888888888887_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        -6.938893903907228e-18_rk, 3.469446951953614e-18_rk, 0.13888888888888887_rk, 6.938893903907228e-18_rk, 0.0_rk, -0.13888888888888887_rk, 0.04629629629629629_rk, -0.04629629629629629_rk,   &
        6.938893903907228e-18_rk, 6.938893903907228e-18_rk, -0.13888888888888887_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.04629629629629629_rk, -0.13888888888888887_rk, 0.04629629629629629_rk,   &
        3.469446951953614e-18_rk, 3.469446951953614e-18_rk, 0.04629629629629629_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.04629629629629629_rk, 0.04629629629629629_rk, -0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,1) = reshape((/ &
        -0.25_rk, 0.08333333333333333_rk, -0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.027777777777777783_rk, 0.0_rk,   &
        0.08333333333333333_rk, -0.08333333333333333_rk, 0.027777777777777783_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.0_rk,   &
        -0.08333333333333333_rk, 0.027777777777777783_rk, -0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08333333333333333_rk, 0.02777777777777777_rk, -0.02777777777777777_rk, 0.0_rk, 0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, -0.027777777777777783_rk, 0.009259259259259259_rk, 0.0_rk, -0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.009259259259259259_rk, -0.027777777777777783_rk, 0.0_rk, 0.00925925925925926_rk,   &
        0.027777777777777783_rk, -0.02777777777777777_rk, 0.02777777777777777_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.027777777777777783_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.009259259259259259_rk, -0.009259259259259259_rk, 0.00925925925925926_rk, 0.0_rk, -0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,2) = reshape((/ &
        -1.25_rk, 0.0_rk, -0.4166666666666665_rk, 0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4166666666666666_rk, 0.0_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.046296296296296294_rk,   &
        -0.4166666666666665_rk, 0.0_rk, -0.4166666666666666_rk, 0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, -0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.04629629629629629_rk, -0.04629629629629629_rk,   &
        0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, -0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.04629629629629629_rk, 0.0_rk, -0.13888888888888887_rk, 0.04629629629629629_rk,   &
        0.0_rk, 0.046296296296296294_rk, 0.0_rk, 0.0_rk, -0.04629629629629629_rk, 0.0_rk, 0.04629629629629629_rk, -0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,3) = reshape((/ &
        1.25_rk, -0.4166666666666666_rk, -2.7755575615628914e-17_rk, -0.4166666666666666_rk, 0.13888888888888887_rk, 6.938893903907228e-18_rk, 6.938893903907228e-18_rk, 3.469446951953614e-18_rk,   &
        -0.4166666666666666_rk, 0.4166666666666666_rk, 6.938893903907228e-18_rk, 0.13888888888888887_rk, -0.13888888888888887_rk, 3.469446951953614e-18_rk, -6.938893903907228e-18_rk, -3.469446951953614e-18_rk,   &
        -2.7755575615628914e-17_rk, 6.938893903907228e-18_rk, 0.4166666666666666_rk, 6.938893903907228e-18_rk, 3.469446951953614e-18_rk, -0.13888888888888887_rk, -0.13888888888888887_rk, 0.04629629629629629_rk,   &
        -0.4166666666666666_rk, 0.13888888888888887_rk, 6.938893903907228e-18_rk, 0.4166666666666666_rk, -0.13888888888888887_rk, -6.938893903907228e-18_rk, 3.469446951953614e-18_rk, -3.469446951953614e-18_rk,   &
        0.13888888888888887_rk, -0.13888888888888887_rk, 3.469446951953614e-18_rk, -0.13888888888888887_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        6.938893903907228e-18_rk, 3.469446951953614e-18_rk, -0.13888888888888887_rk, -6.938893903907228e-18_rk, 0.0_rk, 0.13888888888888887_rk, 0.04629629629629629_rk, -0.04629629629629629_rk,   &
        6.938893903907228e-18_rk, -6.938893903907228e-18_rk, -0.13888888888888887_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.04629629629629629_rk, 0.13888888888888887_rk, -0.04629629629629629_rk,   &
        3.469446951953614e-18_rk, -3.469446951953614e-18_rk, 0.04629629629629629_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.04629629629629629_rk, -0.04629629629629629_rk, 0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,1) = reshape((/ &
        0.25_rk, -0.08333333333333333_rk, 0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.027777777777777783_rk, 0.0_rk,   &
        -0.08333333333333333_rk, 0.08333333333333333_rk, -0.027777777777777783_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.0_rk,   &
        0.08333333333333333_rk, -0.027777777777777783_rk, 0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08333333333333333_rk, -0.02777777777777777_rk, 0.02777777777777777_rk, 0.0_rk, -0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.027777777777777783_rk, -0.009259259259259259_rk, 0.0_rk, 0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, -0.009259259259259259_rk, 0.027777777777777783_rk, 0.0_rk, -0.00925925925925926_rk,   &
        -0.027777777777777783_rk, 0.02777777777777777_rk, -0.02777777777777777_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.027777777777777783_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.009259259259259259_rk, 0.009259259259259259_rk, -0.00925925925925926_rk, 0.0_rk, 0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,2) = reshape((/ &
        -1.25_rk, 0.0_rk, -0.4166666666666665_rk, -0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.4166666666666666_rk, 0.0_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, -0.046296296296296294_rk,   &
        -0.4166666666666665_rk, 0.0_rk, -0.4166666666666666_rk, -0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        -0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, -0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, -0.04629629629629629_rk, -0.04629629629629629_rk,   &
        -0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, -0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, -0.04629629629629629_rk, 0.0_rk, -0.13888888888888887_rk, -0.04629629629629629_rk,   &
        0.0_rk, -0.046296296296296294_rk, 0.0_rk, 0.0_rk, -0.04629629629629629_rk, 0.0_rk, -0.04629629629629629_rk, -0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,3) = reshape((/ &
        1.25_rk, -0.4166666666666666_rk, -2.7755575615628914e-17_rk, 0.4166666666666666_rk, -0.13888888888888887_rk, -6.938893903907228e-18_rk, 6.938893903907228e-18_rk, -3.469446951953614e-18_rk,   &
        -0.4166666666666666_rk, 0.4166666666666666_rk, 6.938893903907228e-18_rk, -0.13888888888888887_rk, 0.13888888888888887_rk, -3.469446951953614e-18_rk, -6.938893903907228e-18_rk, 3.469446951953614e-18_rk,   &
        -2.7755575615628914e-17_rk, 6.938893903907228e-18_rk, 0.4166666666666666_rk, -6.938893903907228e-18_rk, -3.469446951953614e-18_rk, 0.13888888888888887_rk, -0.13888888888888887_rk, -0.04629629629629629_rk,   &
        0.4166666666666666_rk, -0.13888888888888887_rk, -6.938893903907228e-18_rk, 0.4166666666666666_rk, -0.13888888888888887_rk, -6.938893903907228e-18_rk, -3.469446951953614e-18_rk, -3.469446951953614e-18_rk,   &
        -0.13888888888888887_rk, 0.13888888888888887_rk, -3.469446951953614e-18_rk, -0.13888888888888887_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        -6.938893903907228e-18_rk, -3.469446951953614e-18_rk, 0.13888888888888887_rk, -6.938893903907228e-18_rk, 0.0_rk, 0.13888888888888887_rk, -0.04629629629629629_rk, -0.04629629629629629_rk,   &
        6.938893903907228e-18_rk, -6.938893903907228e-18_rk, -0.13888888888888887_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.04629629629629629_rk, 0.13888888888888887_rk, 0.04629629629629629_rk,   &
        -3.469446951953614e-18_rk, 3.469446951953614e-18_rk, -0.04629629629629629_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.04629629629629629_rk, 0.04629629629629629_rk, 0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,1) = reshape((/ &
        0.25_rk, 0.08333333333333333_rk, 0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.027777777777777783_rk, 0.0_rk,   &
        0.08333333333333333_rk, 0.08333333333333333_rk, 0.027777777777777783_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.0_rk,   &
        0.08333333333333333_rk, 0.027777777777777783_rk, 0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08333333333333333_rk, 0.02777777777777777_rk, 0.02777777777777777_rk, 0.0_rk, 0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.027777777777777783_rk, 0.009259259259259259_rk, 0.0_rk, 0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.02777777777777777_rk, 0.009259259259259259_rk, 0.027777777777777783_rk, 0.0_rk, 0.00925925925925926_rk,   &
        0.027777777777777783_rk, 0.02777777777777777_rk, 0.02777777777777777_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.027777777777777783_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.009259259259259259_rk, 0.009259259259259259_rk, 0.00925925925925926_rk, 0.0_rk, 0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,2) = reshape((/ &
        1.25_rk, 0.0_rk, 0.4166666666666665_rk, 0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.4166666666666666_rk, 0.0_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.046296296296296294_rk,   &
        0.4166666666666665_rk, 0.0_rk, 0.4166666666666666_rk, 0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.04629629629629629_rk, 0.04629629629629629_rk,   &
        0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.04629629629629629_rk, 0.0_rk, 0.13888888888888887_rk, 0.04629629629629629_rk,   &
        0.0_rk, 0.046296296296296294_rk, 0.0_rk, 0.0_rk, 0.04629629629629629_rk, 0.0_rk, 0.04629629629629629_rk, 0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,3) = reshape((/ &
        1.25_rk, 0.4166666666666666_rk, -2.7755575615628914e-17_rk, 0.4166666666666666_rk, 0.13888888888888887_rk, -6.938893903907228e-18_rk, -6.938893903907228e-18_rk, 3.469446951953614e-18_rk,   &
        0.4166666666666666_rk, 0.4166666666666666_rk, -6.938893903907228e-18_rk, 0.13888888888888887_rk, 0.13888888888888887_rk, 3.469446951953614e-18_rk, -6.938893903907228e-18_rk, 3.469446951953614e-18_rk,   &
        -2.7755575615628914e-17_rk, -6.938893903907228e-18_rk, 0.4166666666666666_rk, -6.938893903907228e-18_rk, 3.469446951953614e-18_rk, 0.13888888888888887_rk, 0.13888888888888887_rk, 0.04629629629629629_rk,   &
        0.4166666666666666_rk, 0.13888888888888887_rk, -6.938893903907228e-18_rk, 0.4166666666666666_rk, 0.13888888888888887_rk, -6.938893903907228e-18_rk, 3.469446951953614e-18_rk, 3.469446951953614e-18_rk,   &
        0.13888888888888887_rk, 0.13888888888888887_rk, 3.469446951953614e-18_rk, 0.13888888888888887_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        -6.938893903907228e-18_rk, 3.469446951953614e-18_rk, 0.13888888888888887_rk, -6.938893903907228e-18_rk, 0.0_rk, 0.13888888888888887_rk, 0.04629629629629629_rk, 0.04629629629629629_rk,   &
        -6.938893903907228e-18_rk, -6.938893903907228e-18_rk, 0.13888888888888887_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.04629629629629629_rk, 0.13888888888888887_rk, 0.04629629629629629_rk,   &
        3.469446951953614e-18_rk, 3.469446951953614e-18_rk, 0.04629629629629629_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.04629629629629629_rk, 0.04629629629629629_rk, 0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,1) = reshape((/ &
        -0.25_rk, -0.08333333333333333_rk, -0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.027777777777777783_rk, 0.0_rk,   &
        -0.08333333333333333_rk, -0.08333333333333333_rk, -0.027777777777777783_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.0_rk,   &
        -0.08333333333333333_rk, -0.027777777777777783_rk, -0.08333333333333333_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08333333333333333_rk, -0.02777777777777777_rk, -0.02777777777777777_rk, 0.0_rk, -0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, -0.027777777777777783_rk, -0.009259259259259259_rk, 0.0_rk, -0.009259259259259259_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.02777777777777777_rk, -0.009259259259259259_rk, -0.027777777777777783_rk, 0.0_rk, -0.00925925925925926_rk,   &
        -0.027777777777777783_rk, -0.02777777777777777_rk, -0.02777777777777777_rk, 0.0_rk, 0.0_rk, 0.0_rk, -0.027777777777777783_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.009259259259259259_rk, -0.009259259259259259_rk, -0.00925925925925926_rk, 0.0_rk, -0.009259259259259257_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,2) = reshape((/ &
        1.25_rk, 0.0_rk, 0.4166666666666665_rk, -0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.4166666666666666_rk, 0.0_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, -0.046296296296296294_rk,   &
        0.4166666666666665_rk, 0.0_rk, 0.4166666666666666_rk, -0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        -0.4166666666666666_rk, 0.0_rk, -0.13888888888888887_rk, 0.4166666666666666_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, -0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, -0.04629629629629629_rk, 0.04629629629629629_rk,   &
        -0.13888888888888887_rk, 0.0_rk, -0.13888888888888887_rk, 0.13888888888888887_rk, 0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, -0.04629629629629629_rk, 0.0_rk, 0.13888888888888887_rk, -0.04629629629629629_rk,   &
        0.0_rk, -0.046296296296296294_rk, 0.0_rk, 0.0_rk, 0.04629629629629629_rk, 0.0_rk, -0.04629629629629629_rk, 0.04629629629629629_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,3) = reshape((/ &
        1.25_rk, 0.4166666666666666_rk, -2.7755575615628914e-17_rk, -0.4166666666666666_rk, -0.13888888888888887_rk, 6.938893903907228e-18_rk, -6.938893903907228e-18_rk, -3.469446951953614e-18_rk,   &
        0.4166666666666666_rk, 0.4166666666666666_rk, -6.938893903907228e-18_rk, -0.13888888888888887_rk, -0.13888888888888887_rk, -3.469446951953614e-18_rk, -6.938893903907228e-18_rk, -3.469446951953614e-18_rk,   &
        -2.7755575615628914e-17_rk, -6.938893903907228e-18_rk, 0.4166666666666666_rk, 6.938893903907228e-18_rk, -3.469446951953614e-18_rk, -0.13888888888888887_rk, 0.13888888888888887_rk, -0.04629629629629629_rk,   &
        -0.4166666666666666_rk, -0.13888888888888887_rk, 6.938893903907228e-18_rk, 0.4166666666666666_rk, 0.13888888888888887_rk, -6.938893903907228e-18_rk, -3.469446951953614e-18_rk, 3.469446951953614e-18_rk,   &
        -0.13888888888888887_rk, -0.13888888888888887_rk, -3.469446951953614e-18_rk, 0.13888888888888887_rk, 0.13888888888888887_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        6.938893903907228e-18_rk, -3.469446951953614e-18_rk, -0.13888888888888887_rk, -6.938893903907228e-18_rk, 0.0_rk, 0.13888888888888887_rk, -0.04629629629629629_rk, 0.04629629629629629_rk,   &
        -6.938893903907228e-18_rk, -6.938893903907228e-18_rk, 0.13888888888888887_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.04629629629629629_rk, 0.13888888888888887_rk, -0.04629629629629629_rk,   &
        -3.469446951953614e-18_rk, -3.469446951953614e-18_rk, -0.04629629629629629_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.04629629629629629_rk, -0.04629629629629629_rk, 0.04629629629629629_rk   &
        /),(/8,8/))

        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dmass_dx(:,:,inode_diff,idir)),self%elem%dmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dmass_dx
    !*******************************************************************************************







    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_vol_dcoords_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_elem()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol = 1.e-14_rk
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !

        test_dcoords_dx = reshape((/ &
        0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/24,8/))


        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','1',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !

        test_dcoords_dx = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/24,8/))


        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','2',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !

        test_dcoords_dx = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk   &
        /),(/24,8/))


        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','3',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_vol_dcoords_dx
    !*******************************************************************************************



!------------------------------------------------------------------------------
!                                Face tests
!------------------------------------------------------------------------------








    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_ximin_dcoords_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_face()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_face(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol = 1.e-14_rk
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))

        
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','1',inode,1)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))

        
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','2',inode,1)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk  &
                                        /),(/24,4/))

        
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','3',inode,1)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_ximin_dcoords_dx
    !*******************************************************************************************






    !> Test cartesian dbr2_vol_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_vol_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dbr2_vol_face1_dx
        ! 
        test_dbr2_vol_face1_dx(:,:,1,1) = reshape((/ &
        0.27189739793884354_rk, 3.0559887962885848e-18_rk, 9.860204588404529e-18_rk, 1.1634093104779757e-17_rk,   &
        -0.07285468820183674_rk, -3.692298896042553e-18_rk, 3.882905107618642e-18_rk, -1.1131467548907251e-17_rk,   &
        -1.6614024199911667e-19_rk, 0.07285468820183676_rk, -1.4107195388693595e-18_rk, -4.565222702911321e-18_rk,   &
        -1.698093137304215e-17_rk, -0.0195213548685034_rk, 2.618848273351596e-18_rk, 6.8292553983931135e-18_rk,   &
        -4.4065754054979785e-18_rk, 1.2360927843746413e-18_rk, 0.07285468820183674_rk, -8.337132066010643e-18_rk,   &
        -1.3360253215515685e-17_rk, 6.397313273241146e-19_rk, -0.0195213548685034_rk, 3.2085772408666466e-18_rk,   &
        -1.3896978526861162e-17_rk, -6.712333913898044e-18_rk, -1.2848854328797475e-17_rk, 0.019521354868503413_rk,   &
        1.840577634603276e-17_rk, -3.3418981136527245e-18_rk, -1.02494067400974e-17_rk, -0.005230731272176849_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,1,2) = reshape((/ &
        1.359486989694218_rk, -3.1508719708670114e-18_rk, 1.3606787526876574e-17_rk, 4.476590513031395e-17_rk,   &
        -0.097606774342517_rk, -6.490982617989368e-17_rk, 2.074171659838074e-17_rk, -2.2599994048388087e-17_rk,   &
        -3.150871970867013e-18_rk, 1.359486989694218_rk, 4.476590513031395e-17_rk, 1.3606787526876571e-17_rk,   &
        -6.490982617989368e-17_rk, -0.097606774342517_rk, -2.2599994048388093e-17_rk, 2.0741716598380732e-17_rk,   &
        -6.045852366511691e-17_rk, -4.3846036520110903e-17_rk, 0.3642734410091838_rk, -4.662418258032131e-17_rk,   &
        -6.673599101024771e-17_rk, 5.36032350925368e-17_rk, -0.02615365636088427_rk, -2.049132053560904e-17_rk,   &
        -4.3846036520110903e-17_rk, -6.045852366511691e-17_rk, -4.662418258032131e-17_rk, 0.3642734410091838_rk,   &
        5.360323509253679e-17_rk, -6.673599101024771e-17_rk, -2.0491320535609032e-17_rk, -0.02615365636088427_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,1,3) = reshape((/ &
        1.359486989694218_rk, -7.194852035559311e-18_rk, -1.3944916898105293e-17_rk, 4.407502416978039e-17_rk,   &
        -0.097606774342517_rk, 1.9474448502148297e-18_rk, -4.6115554431727774e-17_rk, -1.9276139380381672e-17_rk,   &
        -4.258020251562902e-17_rk, 0.3642734410091838_rk, -4.315515555957733e-17_rk, -3.2906819240135034e-17_rk,   &
        -8.734859156571755e-17_rk, -0.026153656360884257_rk, 5.027938042453038e-17_rk, 1.212800198607905e-19_rk,   &
        -1.39449168981053e-17_rk, 4.407502416978039e-17_rk, 1.359486989694218_rk, -7.194852035559311e-18_rk,   &
        -4.6115554431727774e-17_rk, -1.927613938038167e-17_rk, -0.097606774342517_rk, 1.9474448502148235e-18_rk,   &
        -4.3155155559577335e-17_rk, -3.2906819240135034e-17_rk, -4.2580202515629005e-17_rk, 0.3642734410091838_rk,   &
        5.027938042453038e-17_rk, 1.2128001986078896e-19_rk, -8.734859156571755e-17_rk, -0.02615365636088427_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,1) = reshape((/ &
        -0.27189739793884354_rk, -3.0559887962885848e-18_rk, -9.860204588404529e-18_rk, -1.1634093104779757e-17_rk,   &
        0.07285468820183674_rk, 3.692298896042553e-18_rk, -3.882905107618642e-18_rk, 1.1131467548907251e-17_rk,   &
        1.6614024199911667e-19_rk, -0.07285468820183676_rk, 1.4107195388693595e-18_rk, 4.565222702911321e-18_rk,   &
        1.698093137304215e-17_rk, 0.0195213548685034_rk, -2.618848273351596e-18_rk, -6.8292553983931135e-18_rk,   &
        4.4065754054979785e-18_rk, -1.2360927843746413e-18_rk, -0.07285468820183674_rk, 8.337132066010643e-18_rk,   &
        1.3360253215515685e-17_rk, -6.397313273241146e-19_rk, 0.0195213548685034_rk, -3.2085772408666466e-18_rk,   &
        1.3896978526861162e-17_rk, 6.712333913898044e-18_rk, 1.2848854328797475e-17_rk, -0.019521354868503413_rk,   &
        -1.840577634603276e-17_rk, 3.3418981136527245e-18_rk, 1.02494067400974e-17_rk, 0.005230731272176849_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,2) = reshape((/ &
        0.3642734410091838_rk, 1.7600114742314345e-17_rk, 1.286812190058947e-17_rk, 6.3509626992380445e-18_rk,   &
        -0.36427344100918363_rk, -3.8456325165529836e-17_rk, 3.281908593167805e-17_rk, -1.9963102329390178e-17_rk,   &
        1.7600114742314348e-17_rk, 0.3642734410091838_rk, 6.3509626992380415e-18_rk, 1.2868121900589454e-17_rk,   &
        -3.8456325165529836e-17_rk, -0.36427344100918363_rk, -1.9963102329390184e-17_rk, 3.281908593167804e-17_rk,   &
        4.863977068136784e-18_rk, -1.94583921923217e-17_rk, 0.097606774342517_rk, -5.930574939371927e-17_rk,   &
        -1.6774765635594317e-17_rk, 4.1624303274247584e-17_rk, -0.097606774342517_rk, -1.471282696054474e-17_rk,   &
        -1.94583921923217e-17_rk, 4.863977068136778e-18_rk, -5.930574939371927e-17_rk, 0.097606774342517_rk,   &
        4.162430327424757e-17_rk, -1.6774765635594314e-17_rk, -1.4712826960544732e-17_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,3) = reshape((/ &
        0.3642734410091838_rk, -1.9210864313050972e-17_rk, 4.121306281263805e-17_rk, 2.027590527599161e-17_rk,   &
        -0.36427344100918363_rk, -4.366053126094353e-18_rk, -1.2711861077574403e-18_rk, -3.318254172753401e-17_rk,   &
        -2.2494770338353952e-17_rk, 0.097606774342517_rk, -3.338333476907527e-17_rk, -2.3480963843911802e-17_rk,   &
        -4.8803098999980224e-17_rk, -0.097606774342517_rk, 5.48437426723914e-17_rk, 1.731550640384116e-17_rk,   &
        4.121306281263804e-17_rk, 2.027590527599161e-17_rk, 0.3642734410091838_rk, -1.9210864313050975e-17_rk,   &
        -1.2711861077574364e-18_rk, -3.318254172753401e-17_rk, -0.36427344100918363_rk, -4.366053126094359e-18_rk,   &
        -3.3383334769075265e-17_rk, -2.3480963843911796e-17_rk, -2.2494770338353946e-17_rk, 0.097606774342517_rk,   &
        5.484374267239141e-17_rk, 1.731550640384117e-17_rk, -4.8803098999980224e-17_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,1) = reshape((/ &
        -0.07285468820183676_rk, 1.6614024199911734e-19_rk, 4.565222702911321e-18_rk, 1.4107195388693583e-18_rk,   &
        0.0195213548685034_rk, 1.6980931373042154e-17_rk, -6.829255398393114e-18_rk, -2.6188482733515957e-18_rk,   &
        -3.055988796288586e-18_rk, -0.27189739793884354_rk, -1.163409310477976e-17_rk, -9.860204588404532e-18_rk,   &
        3.6922988960425515e-18_rk, 0.07285468820183674_rk, 1.1131467548907251e-17_rk, -3.882905107618642e-18_rk,   &
        6.712333913898045e-18_rk, 1.3896978526861162e-17_rk, -0.019521354868503413_rk, 1.2848854328797474e-17_rk,   &
        3.3418981136527245e-18_rk, -1.840577634603276e-17_rk, 0.005230731272176849_rk, 1.0249406740097403e-17_rk,   &
        -1.2360927843746413e-18_rk, 4.406575405497979e-18_rk, 8.337132066010643e-18_rk, -0.07285468820183674_rk,   &
        -6.397313273241119e-19_rk, 1.3360253215515685e-17_rk, -3.2085772408666462e-18_rk, 0.0195213548685034_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,2) = reshape((/ &
        -0.3642734410091838_rk, -1.7600114742314345e-17_rk, -1.286812190058947e-17_rk, -6.3509626992380445e-18_rk,   &
        0.36427344100918363_rk, 3.8456325165529836e-17_rk, -3.281908593167805e-17_rk, 1.9963102329390178e-17_rk,   &
        -1.7600114742314348e-17_rk, -0.3642734410091838_rk, -6.3509626992380415e-18_rk, -1.2868121900589454e-17_rk,   &
        3.8456325165529836e-17_rk, 0.36427344100918363_rk, 1.9963102329390184e-17_rk, -3.281908593167804e-17_rk,   &
        -4.863977068136784e-18_rk, 1.94583921923217e-17_rk, -0.097606774342517_rk, 5.930574939371927e-17_rk,   &
        1.6774765635594317e-17_rk, -4.1624303274247584e-17_rk, 0.097606774342517_rk, 1.471282696054474e-17_rk,   &
        1.94583921923217e-17_rk, -4.863977068136778e-18_rk, 5.930574939371927e-17_rk, -0.097606774342517_rk,   &
        -4.162430327424757e-17_rk, 1.6774765635594314e-17_rk, 1.4712826960544732e-17_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,3) = reshape((/ &
        0.097606774342517_rk, -2.2494770338353946e-17_rk, -2.348096384391179e-17_rk, -3.338333476907526e-17_rk,   &
        -0.097606774342517_rk, -4.8803098999980224e-17_rk, 1.7315506403841166e-17_rk, 5.4843742672391406e-17_rk,   &
        -1.9210864313050978e-17_rk, 0.3642734410091838_rk, 2.0275905275991607e-17_rk, 4.1213062812638043e-17_rk,   &
        -4.366053126094353e-18_rk, -0.36427344100918363_rk, -3.3182541727534005e-17_rk, -1.2711861077574449e-18_rk,   &
        -2.3480963843911796e-17_rk, -3.338333476907526e-17_rk, 0.097606774342517_rk, -2.2494770338353946e-17_rk,   &
        1.731550640384117e-17_rk, 5.4843742672391406e-17_rk, -0.097606774342517_rk, -4.8803098999980224e-17_rk,   &
        2.0275905275991614e-17_rk, 4.1213062812638043e-17_rk, -1.9210864313050972e-17_rk, 0.3642734410091838_rk,   &
        -3.318254172753402e-17_rk, -1.2711861077574418e-18_rk, -4.366053126094353e-18_rk, -0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,1) = reshape((/ &
        0.07285468820183676_rk, -1.6614024199911734e-19_rk, -4.565222702911321e-18_rk, -1.4107195388693583e-18_rk,   &
        -0.0195213548685034_rk, -1.6980931373042154e-17_rk, 6.829255398393114e-18_rk, 2.6188482733515957e-18_rk,   &
        3.055988796288586e-18_rk, 0.27189739793884354_rk, 1.163409310477976e-17_rk, 9.860204588404532e-18_rk,   &
        -3.6922988960425515e-18_rk, -0.07285468820183674_rk, -1.1131467548907251e-17_rk, 3.882905107618642e-18_rk,   &
        -6.712333913898045e-18_rk, -1.3896978526861162e-17_rk, 0.019521354868503413_rk, -1.2848854328797474e-17_rk,   &
        -3.3418981136527245e-18_rk, 1.840577634603276e-17_rk, -0.005230731272176849_rk, -1.0249406740097403e-17_rk,   &
        1.2360927843746413e-18_rk, -4.406575405497979e-18_rk, -8.337132066010643e-18_rk, 0.07285468820183674_rk,   &
        6.397313273241119e-19_rk, -1.3360253215515685e-17_rk, 3.2085772408666462e-18_rk, -0.0195213548685034_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,2) = reshape((/ &
        -1.359486989694218_rk, 3.1508719708670114e-18_rk, -1.3606787526876574e-17_rk, -4.476590513031395e-17_rk,   &
        0.097606774342517_rk, 6.490982617989368e-17_rk, -2.074171659838074e-17_rk, 2.2599994048388087e-17_rk,   &
        3.150871970867013e-18_rk, -1.359486989694218_rk, -4.476590513031395e-17_rk, -1.3606787526876571e-17_rk,   &
        6.490982617989368e-17_rk, 0.097606774342517_rk, 2.2599994048388093e-17_rk, -2.0741716598380732e-17_rk,   &
        6.045852366511691e-17_rk, 4.3846036520110903e-17_rk, -0.3642734410091838_rk, 4.662418258032131e-17_rk,   &
        6.673599101024771e-17_rk, -5.36032350925368e-17_rk, 0.02615365636088427_rk, 2.049132053560904e-17_rk,   &
        4.3846036520110903e-17_rk, 6.045852366511691e-17_rk, 4.662418258032131e-17_rk, -0.3642734410091838_rk,   &
        -5.360323509253679e-17_rk, 6.673599101024771e-17_rk, 2.0491320535609032e-17_rk, 0.02615365636088427_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,3) = reshape((/ &
        0.3642734410091838_rk, -4.2580202515629005e-17_rk, -3.2906819240135034e-17_rk, -4.315515555957734e-17_rk,   &
        -0.026153656360884264_rk, -8.734859156571755e-17_rk, 1.2128001986079666e-19_rk, 5.027938042453037e-17_rk,   &
        -7.194852035559317e-18_rk, 1.359486989694218_rk, 4.407502416978039e-17_rk, -1.39449168981053e-17_rk,   &
        1.9474448502148297e-18_rk, -0.097606774342517_rk, -1.9276139380381665e-17_rk, -4.6115554431727774e-17_rk,   &
        -3.2906819240135034e-17_rk, -4.315515555957734e-17_rk, 0.3642734410091838_rk, -4.2580202515629005e-17_rk,   &
        1.212800198607928e-19_rk, 5.027938042453037e-17_rk, -0.02615365636088427_rk, -8.734859156571755e-17_rk,   &
        4.407502416978038e-17_rk, -1.3944916898105293e-17_rk, -7.194852035559311e-18_rk, 1.359486989694218_rk,   &
        -1.927613938038168e-17_rk, -4.6115554431727774e-17_rk, 1.9474448502148297e-18_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,1) = reshape((/ &
        0.07285468820183674_rk, -8.33713206601064e-18_rk, -4.406575405497979e-18_rk, 1.2360927843746413e-18_rk,   &
        -0.0195213548685034_rk, 3.2085772408666462e-18_rk, -1.3360253215515685e-17_rk, 6.397313273241129e-19_rk,   &
        -1.2848854328797472e-17_rk, 0.019521354868503413_rk, -1.3896978526861162e-17_rk, -6.712333913898046e-18_rk,   &
        -1.0249406740097403e-17_rk, -0.005230731272176853_rk, 1.840577634603276e-17_rk, -3.3418981136527222e-18_rk,   &
        9.860204588404527e-18_rk, 1.163409310477976e-17_rk, 0.27189739793884354_rk, 3.0559887962885844e-18_rk,   &
        3.8829051076186405e-18_rk, -1.1131467548907251e-17_rk, -0.07285468820183674_rk, -3.6922988960425515e-18_rk,   &
        -1.4107195388693583e-18_rk, -4.565222702911321e-18_rk, -1.6614024199911744e-19_rk, 0.07285468820183676_rk,   &
        2.618848273351596e-18_rk, 6.829255398393114e-18_rk, -1.698093137304215e-17_rk, -0.019521354868503395_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,2) = reshape((/ &
        0.3642734410091838_rk, -4.6624182580321305e-17_rk, -6.04585236651169e-17_rk, -4.3846036520110903e-17_rk,   &
        -0.02615365636088427_rk, -2.0491320535609035e-17_rk, -6.673599101024771e-17_rk, 5.360323509253679e-17_rk,   &
        -4.662418258032132e-17_rk, 0.3642734410091838_rk, -4.384603652011089e-17_rk, -6.04585236651169e-17_rk,   &
        -2.0491320535609035e-17_rk, -0.02615365636088427_rk, 5.36032350925368e-17_rk, -6.673599101024772e-17_rk,   &
        1.3606787526876571e-17_rk, 4.476590513031395e-17_rk, 1.359486989694218_rk, -3.1508719708670067e-18_rk,   &
        2.0741716598380736e-17_rk, -2.2599994048388093e-17_rk, -0.097606774342517_rk, -6.490982617989368e-17_rk,   &
        4.476590513031395e-17_rk, 1.3606787526876571e-17_rk, -3.1508719708670067e-18_rk, 1.359486989694218_rk,   &
        -2.2599994048388087e-17_rk, 2.0741716598380726e-17_rk, -6.490982617989368e-17_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,3) = reshape((/ &
        -1.359486989694218_rk, 7.194852035559311e-18_rk, 1.3944916898105293e-17_rk, -4.407502416978039e-17_rk,   &
        0.097606774342517_rk, -1.9474448502148297e-18_rk, 4.6115554431727774e-17_rk, 1.9276139380381672e-17_rk,   &
        4.258020251562902e-17_rk, -0.3642734410091838_rk, 4.315515555957733e-17_rk, 3.2906819240135034e-17_rk,   &
        8.734859156571755e-17_rk, 0.026153656360884257_rk, -5.027938042453038e-17_rk, -1.212800198607905e-19_rk,   &
        1.39449168981053e-17_rk, -4.407502416978039e-17_rk, -1.359486989694218_rk, 7.194852035559311e-18_rk,   &
        4.6115554431727774e-17_rk, 1.927613938038167e-17_rk, 0.097606774342517_rk, -1.9474448502148235e-18_rk,   &
        4.3155155559577335e-17_rk, 3.2906819240135034e-17_rk, 4.2580202515629005e-17_rk, -0.3642734410091838_rk,   &
        -5.027938042453038e-17_rk, -1.2128001986078896e-19_rk, 8.734859156571755e-17_rk, 0.02615365636088427_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,1) = reshape((/ &
        -0.07285468820183674_rk, 8.33713206601064e-18_rk, 4.406575405497979e-18_rk, -1.2360927843746413e-18_rk,   &
        0.0195213548685034_rk, -3.2085772408666462e-18_rk, 1.3360253215515685e-17_rk, -6.397313273241129e-19_rk,   &
        1.2848854328797472e-17_rk, -0.019521354868503413_rk, 1.3896978526861162e-17_rk, 6.712333913898046e-18_rk,   &
        1.0249406740097403e-17_rk, 0.005230731272176853_rk, -1.840577634603276e-17_rk, 3.3418981136527222e-18_rk,   &
        -9.860204588404527e-18_rk, -1.163409310477976e-17_rk, -0.27189739793884354_rk, -3.0559887962885844e-18_rk,   &
        -3.8829051076186405e-18_rk, 1.1131467548907251e-17_rk, 0.07285468820183674_rk, 3.6922988960425515e-18_rk,   &
        1.4107195388693583e-18_rk, 4.565222702911321e-18_rk, 1.6614024199911744e-19_rk, -0.07285468820183676_rk,   &
        -2.618848273351596e-18_rk, -6.829255398393114e-18_rk, 1.698093137304215e-17_rk, 0.019521354868503395_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,2) = reshape((/ &
        0.097606774342517_rk, -5.930574939371926e-17_rk, 4.863977068136793e-18_rk, -1.94583921923217e-17_rk,   &
        -0.097606774342517_rk, -1.4712826960544735e-17_rk, -1.677476563559432e-17_rk, 4.162430327424757e-17_rk,   &
        -5.930574939371927e-17_rk, 0.097606774342517_rk, -1.9458392192321705e-17_rk, 4.86397706813679e-18_rk,   &
        -1.4712826960544735e-17_rk, -0.097606774342517_rk, 4.162430327424758e-17_rk, -1.6774765635594326e-17_rk,   &
        1.2868121900589458e-17_rk, 6.350962699238048e-18_rk, 0.3642734410091838_rk, 1.7600114742314354e-17_rk,   &
        3.281908593167805e-17_rk, -1.9963102329390178e-17_rk, -0.36427344100918363_rk, -3.8456325165529836e-17_rk,   &
        6.3509626992380445e-18_rk, 1.286812190058946e-17_rk, 1.7600114742314354e-17_rk, 0.3642734410091838_rk,   &
        -1.9963102329390178e-17_rk, 3.281908593167804e-17_rk, -3.8456325165529836e-17_rk, -0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,3) = reshape((/ &
        -0.3642734410091838_rk, 1.9210864313050972e-17_rk, -4.121306281263805e-17_rk, -2.027590527599161e-17_rk,   &
        0.36427344100918363_rk, 4.366053126094353e-18_rk, 1.2711861077574403e-18_rk, 3.318254172753401e-17_rk,   &
        2.2494770338353952e-17_rk, -0.097606774342517_rk, 3.338333476907527e-17_rk, 2.3480963843911802e-17_rk,   &
        4.8803098999980224e-17_rk, 0.097606774342517_rk, -5.48437426723914e-17_rk, -1.731550640384116e-17_rk,   &
        -4.121306281263804e-17_rk, -2.027590527599161e-17_rk, -0.3642734410091838_rk, 1.9210864313050975e-17_rk,   &
        1.2711861077574364e-18_rk, 3.318254172753401e-17_rk, 0.36427344100918363_rk, 4.366053126094359e-18_rk,   &
        3.3383334769075265e-17_rk, 2.3480963843911796e-17_rk, 2.2494770338353946e-17_rk, -0.097606774342517_rk,   &
        -5.484374267239141e-17_rk, -1.731550640384117e-17_rk, 4.8803098999980224e-17_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,1) = reshape((/ &
        -0.019521354868503413_rk, 1.2848854328797472e-17_rk, 6.712333913898045e-18_rk, 1.389697852686116e-17_rk,   &
        0.005230731272176853_rk, 1.02494067400974e-17_rk, 3.3418981136527245e-18_rk, -1.840577634603276e-17_rk,   &
        8.33713206601064e-18_rk, -0.07285468820183674_rk, -1.2360927843746417e-18_rk, 4.406575405497979e-18_rk,   &
        -3.208577240866647e-18_rk, 0.0195213548685034_rk, -6.397313273241104e-19_rk, 1.3360253215515683e-17_rk,   &
        4.565222702911322e-18_rk, 1.4107195388693583e-18_rk, -0.07285468820183676_rk, 1.6614024199911672e-19_rk,   &
        -6.829255398393114e-18_rk, -2.618848273351594e-18_rk, 0.019521354868503395_rk, 1.698093137304215e-17_rk,   &
        -1.163409310477976e-17_rk, -9.860204588404527e-18_rk, -3.055988796288585e-18_rk, -0.27189739793884354_rk,   &
        1.113146754890725e-17_rk, -3.8829051076186405e-18_rk, 3.692298896042553e-18_rk, 0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,2) = reshape((/ &
        -0.097606774342517_rk, 5.930574939371926e-17_rk, -4.863977068136793e-18_rk, 1.94583921923217e-17_rk,   &
        0.097606774342517_rk, 1.4712826960544735e-17_rk, 1.677476563559432e-17_rk, -4.162430327424757e-17_rk,   &
        5.930574939371927e-17_rk, -0.097606774342517_rk, 1.9458392192321705e-17_rk, -4.86397706813679e-18_rk,   &
        1.4712826960544735e-17_rk, 0.097606774342517_rk, -4.162430327424758e-17_rk, 1.6774765635594326e-17_rk,   &
        -1.2868121900589458e-17_rk, -6.350962699238048e-18_rk, -0.3642734410091838_rk, -1.7600114742314354e-17_rk,   &
        -3.281908593167805e-17_rk, 1.9963102329390178e-17_rk, 0.36427344100918363_rk, 3.8456325165529836e-17_rk,   &
        -6.3509626992380445e-18_rk, -1.286812190058946e-17_rk, -1.7600114742314354e-17_rk, -0.3642734410091838_rk,   &
        1.9963102329390178e-17_rk, -3.281908593167804e-17_rk, 3.8456325165529836e-17_rk, 0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,3) = reshape((/ &
        -0.097606774342517_rk, 2.2494770338353946e-17_rk, 2.348096384391179e-17_rk, 3.338333476907526e-17_rk,   &
        0.097606774342517_rk, 4.8803098999980224e-17_rk, -1.7315506403841166e-17_rk, -5.4843742672391406e-17_rk,   &
        1.9210864313050978e-17_rk, -0.3642734410091838_rk, -2.0275905275991607e-17_rk, -4.1213062812638043e-17_rk,   &
        4.366053126094353e-18_rk, 0.36427344100918363_rk, 3.3182541727534005e-17_rk, 1.2711861077574449e-18_rk,   &
        2.3480963843911796e-17_rk, 3.338333476907526e-17_rk, -0.097606774342517_rk, 2.2494770338353946e-17_rk,   &
        -1.731550640384117e-17_rk, -5.4843742672391406e-17_rk, 0.097606774342517_rk, 4.8803098999980224e-17_rk,   &
        -2.0275905275991614e-17_rk, -4.1213062812638043e-17_rk, 1.9210864313050972e-17_rk, -0.3642734410091838_rk,   &
        3.318254172753402e-17_rk, 1.2711861077574418e-18_rk, 4.366053126094353e-18_rk, 0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,1) = reshape((/ &
        0.019521354868503413_rk, -1.2848854328797472e-17_rk, -6.712333913898045e-18_rk, -1.389697852686116e-17_rk,   &
        -0.005230731272176853_rk, -1.02494067400974e-17_rk, -3.3418981136527245e-18_rk, 1.840577634603276e-17_rk,   &
        -8.33713206601064e-18_rk, 0.07285468820183674_rk, 1.2360927843746417e-18_rk, -4.406575405497979e-18_rk,   &
        3.208577240866647e-18_rk, -0.0195213548685034_rk, 6.397313273241104e-19_rk, -1.3360253215515683e-17_rk,   &
        -4.565222702911322e-18_rk, -1.4107195388693583e-18_rk, 0.07285468820183676_rk, -1.6614024199911672e-19_rk,   &
        6.829255398393114e-18_rk, 2.618848273351594e-18_rk, -0.019521354868503395_rk, -1.698093137304215e-17_rk,   &
        1.163409310477976e-17_rk, 9.860204588404527e-18_rk, 3.055988796288585e-18_rk, 0.27189739793884354_rk,   &
        -1.113146754890725e-17_rk, 3.8829051076186405e-18_rk, -3.692298896042553e-18_rk, -0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,2) = reshape((/ &
        -0.3642734410091838_rk, 4.6624182580321305e-17_rk, 6.04585236651169e-17_rk, 4.3846036520110903e-17_rk,   &
        0.02615365636088427_rk, 2.0491320535609035e-17_rk, 6.673599101024771e-17_rk, -5.360323509253679e-17_rk,   &
        4.662418258032132e-17_rk, -0.3642734410091838_rk, 4.384603652011089e-17_rk, 6.04585236651169e-17_rk,   &
        2.0491320535609035e-17_rk, 0.02615365636088427_rk, -5.36032350925368e-17_rk, 6.673599101024772e-17_rk,   &
        -1.3606787526876571e-17_rk, -4.476590513031395e-17_rk, -1.359486989694218_rk, 3.1508719708670067e-18_rk,   &
        -2.0741716598380736e-17_rk, 2.2599994048388093e-17_rk, 0.097606774342517_rk, 6.490982617989368e-17_rk,   &
        -4.476590513031395e-17_rk, -1.3606787526876571e-17_rk, 3.1508719708670067e-18_rk, -1.359486989694218_rk,   &
        2.2599994048388087e-17_rk, -2.0741716598380726e-17_rk, 6.490982617989368e-17_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,3) = reshape((/ &
        -0.3642734410091838_rk, 4.2580202515629005e-17_rk, 3.2906819240135034e-17_rk, 4.315515555957734e-17_rk,   &
        0.026153656360884264_rk, 8.734859156571755e-17_rk, -1.2128001986079666e-19_rk, -5.027938042453037e-17_rk,   &
        7.194852035559317e-18_rk, -1.359486989694218_rk, -4.407502416978039e-17_rk, 1.39449168981053e-17_rk,   &
        -1.9474448502148297e-18_rk, 0.097606774342517_rk, 1.9276139380381665e-17_rk, 4.6115554431727774e-17_rk,   &
        3.2906819240135034e-17_rk, 4.315515555957734e-17_rk, -0.3642734410091838_rk, 4.2580202515629005e-17_rk,   &
        -1.212800198607928e-19_rk, -5.027938042453037e-17_rk, 0.02615365636088427_rk, 8.734859156571755e-17_rk,   &
        -4.407502416978038e-17_rk, 1.3944916898105293e-17_rk, 7.194852035559311e-18_rk, -1.359486989694218_rk,   &
        1.927613938038168e-17_rk, 4.6115554431727774e-17_rk, -1.9474448502148297e-18_rk, 0.097606774342517_rk   &
        /),(/4,8/))


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        !
        ! dbr2_vol_face2_dx
        ! 
        test_dbr2_vol_face2_dx(:,:,1,1) = reshape((/ &
        -0.07285468820183674_rk, -3.692298896042552e-18_rk, 3.882905107618641e-18_rk, -1.1131467548907251e-17_rk,   &
        0.27189739793884354_rk, 3.0559887962885855e-18_rk, 9.86020458840453e-18_rk, 1.1634093104779757e-17_rk,   &
        -1.698093137304215e-17_rk, -0.0195213548685034_rk, 2.6188482733515973e-18_rk, 6.8292553983931135e-18_rk,   &
        -1.6614024199911676e-19_rk, 0.07285468820183676_rk, -1.4107195388693593e-18_rk, -4.565222702911321e-18_rk,   &
        -1.3360253215515685e-17_rk, 6.397313273241127e-19_rk, -0.0195213548685034_rk, 3.2085772408666447e-18_rk,   &
        -4.406575405497979e-18_rk, 1.2360927843746409e-18_rk, 0.07285468820183674_rk, -8.337132066010642e-18_rk,   &
        1.840577634603276e-17_rk, -3.3418981136527245e-18_rk, -1.02494067400974e-17_rk, -0.005230731272176849_rk,   &
        -1.3896978526861162e-17_rk, -6.7123339138980475e-18_rk, -1.2848854328797474e-17_rk, 0.019521354868503413_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,1,2) = reshape((/ &
        -0.36427344100918363_rk, -3.8456325165529836e-17_rk, 3.281908593167805e-17_rk, -1.9963102329390184e-17_rk,   &
        0.3642734410091838_rk, 1.7600114742314348e-17_rk, 1.2868121900589454e-17_rk, 6.3509626992380415e-18_rk,   &
        -3.8456325165529836e-17_rk, -0.36427344100918363_rk, -1.996310232939018e-17_rk, 3.2819085931678035e-17_rk,   &
        1.760011474231436e-17_rk, 0.3642734410091838_rk, 6.350962699238038e-18_rk, 1.2868121900589458e-17_rk,   &
        -1.6774765635594317e-17_rk, 4.162430327424757e-17_rk, -0.097606774342517_rk, -1.4712826960544735e-17_rk,   &
        4.863977068136784e-18_rk, -1.94583921923217e-17_rk, 0.097606774342517_rk, -5.930574939371926e-17_rk,   &
        4.1624303274247584e-17_rk, -1.6774765635594314e-17_rk, -1.4712826960544738e-17_rk, -0.097606774342517_rk,   &
        -1.9458392192321705e-17_rk, 4.863977068136784e-18_rk, -5.930574939371927e-17_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,1,3) = reshape((/ &
        -0.36427344100918363_rk, -4.366053126094353e-18_rk, -1.2711861077574372e-18_rk, -3.3182541727534024e-17_rk,   &
        0.3642734410091838_rk, -1.9210864313050978e-17_rk, 4.121306281263803e-17_rk, 2.0275905275991598e-17_rk,   &
        -4.8803098999980224e-17_rk, -0.09760677434251702_rk, 5.4843742672391406e-17_rk, 1.731550640384116e-17_rk,   &
        -2.249477033835394e-17_rk, 0.097606774342517_rk, -3.338333476907526e-17_rk, -2.3480963843911796e-17_rk,   &
        -1.2711861077574356e-18_rk, -3.318254172753401e-17_rk, -0.36427344100918363_rk, -4.366053126094353e-18_rk,   &
        4.1213062812638043e-17_rk, 2.027590527599161e-17_rk, 0.3642734410091838_rk, -1.9210864313050972e-17_rk,   &
        5.484374267239141e-17_rk, 1.7315506403841166e-17_rk, -4.8803098999980224e-17_rk, -0.097606774342517_rk,   &
        -3.338333476907527e-17_rk, -2.3480963843911796e-17_rk, -2.2494770338353946e-17_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,1) = reshape((/ &
        0.07285468820183674_rk, 3.692298896042552e-18_rk, -3.882905107618641e-18_rk, 1.1131467548907251e-17_rk,   &
        -0.27189739793884354_rk, -3.0559887962885855e-18_rk, -9.86020458840453e-18_rk, -1.1634093104779757e-17_rk,   &
        1.698093137304215e-17_rk, 0.0195213548685034_rk, -2.6188482733515973e-18_rk, -6.8292553983931135e-18_rk,   &
        1.6614024199911676e-19_rk, -0.07285468820183676_rk, 1.4107195388693593e-18_rk, 4.565222702911321e-18_rk,   &
        1.3360253215515685e-17_rk, -6.397313273241127e-19_rk, 0.0195213548685034_rk, -3.2085772408666447e-18_rk,   &
        4.406575405497979e-18_rk, -1.2360927843746409e-18_rk, -0.07285468820183674_rk, 8.337132066010642e-18_rk,   &
        -1.840577634603276e-17_rk, 3.3418981136527245e-18_rk, 1.02494067400974e-17_rk, 0.005230731272176849_rk,   &
        1.3896978526861162e-17_rk, 6.7123339138980475e-18_rk, 1.2848854328797474e-17_rk, -0.019521354868503413_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,2) = reshape((/ &
        -0.097606774342517_rk, -6.490982617989368e-17_rk, 2.0741716598380732e-17_rk, -2.2599994048388087e-17_rk,   &
        1.359486989694218_rk, -3.15087197086701e-18_rk, 1.3606787526876571e-17_rk, 4.476590513031395e-17_rk,   &
        -6.490982617989368e-17_rk, -0.09760677434251698_rk, -2.2599994048388087e-17_rk, 2.074171659838073e-17_rk,   &
        -3.1508719708669975e-18_rk, 1.359486989694218_rk, 4.476590513031395e-17_rk, 1.3606787526876568e-17_rk,   &
        -6.673599101024772e-17_rk, 5.3603235092536794e-17_rk, -0.02615365636088427_rk, -2.0491320535609035e-17_rk,   &
        -6.045852366511691e-17_rk, -4.384603652011089e-17_rk, 0.3642734410091838_rk, -4.6624182580321305e-17_rk,   &
        5.36032350925368e-17_rk, -6.673599101024771e-17_rk, -2.0491320535609038e-17_rk, -0.02615365636088427_rk,   &
        -4.3846036520110903e-17_rk, -6.045852366511691e-17_rk, -4.662418258032131e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,3) = reshape((/ &
        -0.09760677434251697_rk, 1.9474448502148297e-18_rk, -4.6115554431727774e-17_rk, -1.9276139380381678e-17_rk,   &
        1.359486989694218_rk, -7.194852035559316e-18_rk, -1.3944916898105305e-17_rk, 4.407502416978039e-17_rk,   &
        -8.734859156571755e-17_rk, -0.026153656360884278_rk, 5.027938042453038e-17_rk, 1.212800198607905e-19_rk,   &
        -4.258020251562899e-17_rk, 0.3642734410091838_rk, -4.315515555957733e-17_rk, -3.2906819240135046e-17_rk,   &
        -4.6115554431727774e-17_rk, -1.927613938038167e-17_rk, -0.09760677434251698_rk, 1.9474448502148297e-18_rk,   &
        -1.39449168981053e-17_rk, 4.407502416978039e-17_rk, 1.359486989694218_rk, -7.194852035559312e-18_rk,   &
        5.027938042453039e-17_rk, 1.2128001986078742e-19_rk, -8.734859156571755e-17_rk, -0.02615365636088427_rk,   &
        -4.3155155559577335e-17_rk, -3.2906819240135046e-17_rk, -4.2580202515629005e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,1) = reshape((/ &
        0.0195213548685034_rk, 1.698093137304215e-17_rk, -6.829255398393114e-18_rk, -2.6188482733515953e-18_rk,   &
        -0.07285468820183676_rk, 1.6614024199911652e-19_rk, 4.565222702911322e-18_rk, 1.4107195388693585e-18_rk,   &
        3.692298896042552e-18_rk, 0.07285468820183674_rk, 1.1131467548907248e-17_rk, -3.882905107618642e-18_rk,   &
        -3.0559887962885855e-18_rk, -0.27189739793884354_rk, -1.163409310477976e-17_rk, -9.860204588404532e-18_rk,   &
        3.3418981136527245e-18_rk, -1.840577634603276e-17_rk, 0.005230731272176849_rk, 1.0249406740097401e-17_rk,   &
        6.712333913898048e-18_rk, 1.3896978526861162e-17_rk, -0.019521354868503413_rk, 1.2848854328797474e-17_rk,   &
        -6.397313273241112e-19_rk, 1.3360253215515685e-17_rk, -3.2085772408666462e-18_rk, 0.0195213548685034_rk,   &
        -1.2360927843746413e-18_rk, 4.406575405497979e-18_rk, 8.337132066010642e-18_rk, -0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,2) = reshape((/ &
        0.097606774342517_rk, 6.490982617989368e-17_rk, -2.0741716598380732e-17_rk, 2.2599994048388087e-17_rk,   &
        -1.359486989694218_rk, 3.15087197086701e-18_rk, -1.3606787526876571e-17_rk, -4.476590513031395e-17_rk,   &
        6.490982617989368e-17_rk, 0.09760677434251698_rk, 2.2599994048388087e-17_rk, -2.074171659838073e-17_rk,   &
        3.1508719708669975e-18_rk, -1.359486989694218_rk, -4.476590513031395e-17_rk, -1.3606787526876568e-17_rk,   &
        6.673599101024772e-17_rk, -5.3603235092536794e-17_rk, 0.02615365636088427_rk, 2.0491320535609035e-17_rk,   &
        6.045852366511691e-17_rk, 4.384603652011089e-17_rk, -0.3642734410091838_rk, 4.6624182580321305e-17_rk,   &
        -5.36032350925368e-17_rk, 6.673599101024771e-17_rk, 2.0491320535609038e-17_rk, 0.02615365636088427_rk,   &
        4.3846036520110903e-17_rk, 6.045852366511691e-17_rk, 4.662418258032131e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,3) = reshape((/ &
        -0.026153656360884278_rk, -8.734859156571755e-17_rk, 1.2128001986078742e-19_rk, 5.027938042453038e-17_rk,   &
        0.3642734410091838_rk, -4.258020251562901e-17_rk, -3.2906819240135046e-17_rk, -4.315515555957733e-17_rk,   &
        1.9474448502148297e-18_rk, -0.09760677434251697_rk, -1.927613938038167e-17_rk, -4.6115554431727774e-17_rk,   &
        -7.194852035559302e-18_rk, 1.359486989694218_rk, 4.407502416978039e-17_rk, -1.3944916898105293e-17_rk,   &
        1.2128001986078742e-19_rk, 5.0279380424530366e-17_rk, -0.026153656360884278_rk, -8.734859156571755e-17_rk,   &
        -3.290681924013504e-17_rk, -4.315515555957733e-17_rk, 0.3642734410091838_rk, -4.2580202515629005e-17_rk,   &
        -1.9276139380381678e-17_rk, -4.6115554431727774e-17_rk, 1.9474448502148297e-18_rk, -0.097606774342517_rk,   &
        4.407502416978038e-17_rk, -1.3944916898105293e-17_rk, -7.194852035559311e-18_rk, 1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,1) = reshape((/ &
        -0.0195213548685034_rk, -1.698093137304215e-17_rk, 6.829255398393114e-18_rk, 2.6188482733515953e-18_rk,   &
        0.07285468820183676_rk, -1.6614024199911652e-19_rk, -4.565222702911322e-18_rk, -1.4107195388693585e-18_rk,   &
        -3.692298896042552e-18_rk, -0.07285468820183674_rk, -1.1131467548907248e-17_rk, 3.882905107618642e-18_rk,   &
        3.0559887962885855e-18_rk, 0.27189739793884354_rk, 1.163409310477976e-17_rk, 9.860204588404532e-18_rk,   &
        -3.3418981136527245e-18_rk, 1.840577634603276e-17_rk, -0.005230731272176849_rk, -1.0249406740097401e-17_rk,   &
        -6.712333913898048e-18_rk, -1.3896978526861162e-17_rk, 0.019521354868503413_rk, -1.2848854328797474e-17_rk,   &
        6.397313273241112e-19_rk, -1.3360253215515685e-17_rk, 3.2085772408666462e-18_rk, -0.0195213548685034_rk,   &
        1.2360927843746413e-18_rk, -4.406575405497979e-18_rk, -8.337132066010642e-18_rk, 0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,2) = reshape((/ &
        0.36427344100918363_rk, 3.8456325165529836e-17_rk, -3.281908593167805e-17_rk, 1.9963102329390184e-17_rk,   &
        -0.3642734410091838_rk, -1.7600114742314348e-17_rk, -1.2868121900589454e-17_rk, -6.3509626992380415e-18_rk,   &
        3.8456325165529836e-17_rk, 0.36427344100918363_rk, 1.996310232939018e-17_rk, -3.2819085931678035e-17_rk,   &
        -1.760011474231436e-17_rk, -0.3642734410091838_rk, -6.350962699238038e-18_rk, -1.2868121900589458e-17_rk,   &
        1.6774765635594317e-17_rk, -4.162430327424757e-17_rk, 0.097606774342517_rk, 1.4712826960544735e-17_rk,   &
        -4.863977068136784e-18_rk, 1.94583921923217e-17_rk, -0.097606774342517_rk, 5.930574939371926e-17_rk,   &
        -4.1624303274247584e-17_rk, 1.6774765635594314e-17_rk, 1.4712826960544738e-17_rk, 0.097606774342517_rk,   &
        1.9458392192321705e-17_rk, -4.863977068136784e-18_rk, 5.930574939371927e-17_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,3) = reshape((/ &
        -0.09760677434251702_rk, -4.8803098999980224e-17_rk, 1.731550640384116e-17_rk, 5.4843742672391406e-17_rk,   &
        0.097606774342517_rk, -2.2494770338353943e-17_rk, -2.3480963843911808e-17_rk, -3.338333476907526e-17_rk,   &
        -4.366053126094353e-18_rk, -0.36427344100918363_rk, -3.318254172753401e-17_rk, -1.2711861077574387e-18_rk,   &
        -1.9210864313050963e-17_rk, 0.3642734410091838_rk, 2.027590527599161e-17_rk, 4.1213062812638043e-17_rk,   &
        1.731550640384117e-17_rk, 5.4843742672391393e-17_rk, -0.09760677434251698_rk, -4.8803098999980224e-17_rk,   &
        -2.3480963843911796e-17_rk, -3.338333476907526e-17_rk, 0.097606774342517_rk, -2.249477033835395e-17_rk,   &
        -3.3182541727534005e-17_rk, -1.2711861077574341e-18_rk, -4.366053126094353e-18_rk, -0.36427344100918363_rk,   &
        2.0275905275991607e-17_rk, 4.1213062812638043e-17_rk, -1.9210864313050975e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,1) = reshape((/ &
        -0.0195213548685034_rk, 3.2085772408666474e-18_rk, -1.3360253215515685e-17_rk, 6.397313273241112e-19_rk,   &
        0.07285468820183674_rk, -8.337132066010642e-18_rk, -4.4065754054979785e-18_rk, 1.236092784374641e-18_rk,   &
        -1.0249406740097403e-17_rk, -0.005230731272176853_rk, 1.840577634603276e-17_rk, -3.3418981136527226e-18_rk,   &
        -1.2848854328797474e-17_rk, 0.019521354868503413_rk, -1.3896978526861162e-17_rk, -6.712333913898046e-18_rk,   &
        3.88290510761864e-18_rk, -1.1131467548907248e-17_rk, -0.07285468820183674_rk, -3.692298896042553e-18_rk,   &
        9.86020458840453e-18_rk, 1.163409310477976e-17_rk, 0.27189739793884354_rk, 3.0559887962885855e-18_rk,   &
        2.6188482733515953e-18_rk, 6.829255398393114e-18_rk, -1.6980931373042154e-17_rk, -0.019521354868503395_rk,   &
        -1.4107195388693583e-18_rk, -4.565222702911321e-18_rk, -1.6614024199911686e-19_rk, 0.07285468820183676_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,2) = reshape((/ &
        -0.097606774342517_rk, -1.4712826960544735e-17_rk, -1.677476563559432e-17_rk, 4.1624303274247566e-17_rk,   &
        0.097606774342517_rk, -5.930574939371927e-17_rk, 4.863977068136778e-18_rk, -1.9458392192321705e-17_rk,   &
        -1.4712826960544735e-17_rk, -0.09760677434251698_rk, 4.1624303274247584e-17_rk, -1.6774765635594317e-17_rk,   &
        -5.930574939371926e-17_rk, 0.097606774342517_rk, -1.9458392192321693e-17_rk, 4.863977068136787e-18_rk,   &
        3.281908593167805e-17_rk, -1.9963102329390184e-17_rk, -0.36427344100918363_rk, -3.8456325165529836e-17_rk,   &
        1.2868121900589464e-17_rk, 6.3509626992380445e-18_rk, 0.3642734410091838_rk, 1.7600114742314345e-17_rk,   &
        -1.9963102329390178e-17_rk, 3.281908593167804e-17_rk, -3.8456325165529836e-17_rk, -0.36427344100918363_rk,   &
        6.3509626992380415e-18_rk, 1.286812190058946e-17_rk, 1.7600114742314354e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,3) = reshape((/ &
        0.36427344100918363_rk, 4.366053126094353e-18_rk, 1.2711861077574372e-18_rk, 3.3182541727534024e-17_rk,   &
        -0.3642734410091838_rk, 1.9210864313050978e-17_rk, -4.121306281263803e-17_rk, -2.0275905275991598e-17_rk,   &
        4.8803098999980224e-17_rk, 0.09760677434251702_rk, -5.4843742672391406e-17_rk, -1.731550640384116e-17_rk,   &
        2.249477033835394e-17_rk, -0.097606774342517_rk, 3.338333476907526e-17_rk, 2.3480963843911796e-17_rk,   &
        1.2711861077574356e-18_rk, 3.318254172753401e-17_rk, 0.36427344100918363_rk, 4.366053126094353e-18_rk,   &
        -4.1213062812638043e-17_rk, -2.027590527599161e-17_rk, -0.3642734410091838_rk, 1.9210864313050972e-17_rk,   &
        -5.484374267239141e-17_rk, -1.7315506403841166e-17_rk, 4.8803098999980224e-17_rk, 0.097606774342517_rk,   &
        3.338333476907527e-17_rk, 2.3480963843911796e-17_rk, 2.2494770338353946e-17_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,1) = reshape((/ &
        0.0195213548685034_rk, -3.2085772408666474e-18_rk, 1.3360253215515685e-17_rk, -6.397313273241112e-19_rk,   &
        -0.07285468820183674_rk, 8.337132066010642e-18_rk, 4.4065754054979785e-18_rk, -1.236092784374641e-18_rk,   &
        1.0249406740097403e-17_rk, 0.005230731272176853_rk, -1.840577634603276e-17_rk, 3.3418981136527226e-18_rk,   &
        1.2848854328797474e-17_rk, -0.019521354868503413_rk, 1.3896978526861162e-17_rk, 6.712333913898046e-18_rk,   &
        -3.88290510761864e-18_rk, 1.1131467548907248e-17_rk, 0.07285468820183674_rk, 3.692298896042553e-18_rk,   &
        -9.86020458840453e-18_rk, -1.163409310477976e-17_rk, -0.27189739793884354_rk, -3.0559887962885855e-18_rk,   &
        -2.6188482733515953e-18_rk, -6.829255398393114e-18_rk, 1.6980931373042154e-17_rk, 0.019521354868503395_rk,   &
        1.4107195388693583e-18_rk, 4.565222702911321e-18_rk, 1.6614024199911686e-19_rk, -0.07285468820183676_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,2) = reshape((/ &
        -0.02615365636088427_rk, -2.0491320535609035e-17_rk, -6.673599101024772e-17_rk, 5.360323509253679e-17_rk,   &
        0.3642734410091838_rk, -4.662418258032132e-17_rk, -6.045852366511691e-17_rk, -4.384603652011089e-17_rk,   &
        -2.0491320535609035e-17_rk, -0.026153656360884278_rk, 5.36032350925368e-17_rk, -6.673599101024771e-17_rk,   &
        -4.6624182580321305e-17_rk, 0.3642734410091838_rk, -4.384603652011089e-17_rk, -6.045852366511691e-17_rk,   &
        2.074171659838073e-17_rk, -2.2599994048388096e-17_rk, -0.097606774342517_rk, -6.490982617989368e-17_rk,   &
        1.3606787526876571e-17_rk, 4.476590513031395e-17_rk, 1.359486989694218_rk, -3.1508719708670114e-18_rk,   &
        -2.2599994048388093e-17_rk, 2.0741716598380726e-17_rk, -6.490982617989368e-17_rk, -0.097606774342517_rk,   &
        4.476590513031395e-17_rk, 1.3606787526876565e-17_rk, -3.1508719708670067e-18_rk, 1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,3) = reshape((/ &
        0.09760677434251697_rk, -1.9474448502148297e-18_rk, 4.6115554431727774e-17_rk, 1.9276139380381678e-17_rk,   &
        -1.359486989694218_rk, 7.194852035559316e-18_rk, 1.3944916898105305e-17_rk, -4.407502416978039e-17_rk,   &
        8.734859156571755e-17_rk, 0.026153656360884278_rk, -5.027938042453038e-17_rk, -1.212800198607905e-19_rk,   &
        4.258020251562899e-17_rk, -0.3642734410091838_rk, 4.315515555957733e-17_rk, 3.2906819240135046e-17_rk,   &
        4.6115554431727774e-17_rk, 1.927613938038167e-17_rk, 0.09760677434251698_rk, -1.9474448502148297e-18_rk,   &
        1.39449168981053e-17_rk, -4.407502416978039e-17_rk, -1.359486989694218_rk, 7.194852035559312e-18_rk,   &
        -5.027938042453039e-17_rk, -1.2128001986078742e-19_rk, 8.734859156571755e-17_rk, 0.02615365636088427_rk,   &
        4.3155155559577335e-17_rk, 3.2906819240135046e-17_rk, 4.2580202515629005e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,1) = reshape((/ &
        0.005230731272176853_rk, 1.0249406740097403e-17_rk, 3.3418981136527238e-18_rk, -1.840577634603276e-17_rk,   &
        -0.019521354868503413_rk, 1.2848854328797474e-17_rk, 6.712333913898047e-18_rk, 1.389697852686116e-17_rk,   &
        -3.208577240866647e-18_rk, 0.0195213548685034_rk, -6.397313273241116e-19_rk, 1.3360253215515683e-17_rk,   &
        8.337132066010642e-18_rk, -0.07285468820183674_rk, -1.2360927843746419e-18_rk, 4.406575405497979e-18_rk,   &
        -6.829255398393113e-18_rk, -2.618848273351596e-18_rk, 0.019521354868503395_rk, 1.6980931373042148e-17_rk,   &
        4.565222702911321e-18_rk, 1.4107195388693587e-18_rk, -0.07285468820183676_rk, 1.6614024199911667e-19_rk,   &
        1.1131467548907251e-17_rk, -3.882905107618641e-18_rk, 3.692298896042553e-18_rk, 0.07285468820183674_rk,   &
        -1.163409310477976e-17_rk, -9.86020458840453e-18_rk, -3.055988796288586e-18_rk, -0.27189739793884354_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,2) = reshape((/ &
        0.02615365636088427_rk, 2.0491320535609035e-17_rk, 6.673599101024772e-17_rk, -5.360323509253679e-17_rk,   &
        -0.3642734410091838_rk, 4.662418258032132e-17_rk, 6.045852366511691e-17_rk, 4.384603652011089e-17_rk,   &
        2.0491320535609035e-17_rk, 0.026153656360884278_rk, -5.36032350925368e-17_rk, 6.673599101024771e-17_rk,   &
        4.6624182580321305e-17_rk, -0.3642734410091838_rk, 4.384603652011089e-17_rk, 6.045852366511691e-17_rk,   &
        -2.074171659838073e-17_rk, 2.2599994048388096e-17_rk, 0.097606774342517_rk, 6.490982617989368e-17_rk,   &
        -1.3606787526876571e-17_rk, -4.476590513031395e-17_rk, -1.359486989694218_rk, 3.1508719708670114e-18_rk,   &
        2.2599994048388093e-17_rk, -2.0741716598380726e-17_rk, 6.490982617989368e-17_rk, 0.097606774342517_rk,   &
        -4.476590513031395e-17_rk, -1.3606787526876565e-17_rk, 3.1508719708670067e-18_rk, -1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,3) = reshape((/ &
        0.026153656360884278_rk, 8.734859156571755e-17_rk, -1.2128001986078742e-19_rk, -5.027938042453038e-17_rk,   &
        -0.3642734410091838_rk, 4.258020251562901e-17_rk, 3.2906819240135046e-17_rk, 4.315515555957733e-17_rk,   &
        -1.9474448502148297e-18_rk, 0.09760677434251697_rk, 1.927613938038167e-17_rk, 4.6115554431727774e-17_rk,   &
        7.194852035559302e-18_rk, -1.359486989694218_rk, -4.407502416978039e-17_rk, 1.3944916898105293e-17_rk,   &
        -1.2128001986078742e-19_rk, -5.0279380424530366e-17_rk, 0.026153656360884278_rk, 8.734859156571755e-17_rk,   &
        3.290681924013504e-17_rk, 4.315515555957733e-17_rk, -0.3642734410091838_rk, 4.2580202515629005e-17_rk,   &
        1.9276139380381678e-17_rk, 4.6115554431727774e-17_rk, -1.9474448502148297e-18_rk, 0.097606774342517_rk,   &
        -4.407502416978038e-17_rk, 1.3944916898105293e-17_rk, 7.194852035559311e-18_rk, -1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,1) = reshape((/ &
        -0.005230731272176853_rk, -1.0249406740097403e-17_rk, -3.3418981136527238e-18_rk, 1.840577634603276e-17_rk,   &
        0.019521354868503413_rk, -1.2848854328797474e-17_rk, -6.712333913898047e-18_rk, -1.389697852686116e-17_rk,   &
        3.208577240866647e-18_rk, -0.0195213548685034_rk, 6.397313273241116e-19_rk, -1.3360253215515683e-17_rk,   &
        -8.337132066010642e-18_rk, 0.07285468820183674_rk, 1.2360927843746419e-18_rk, -4.406575405497979e-18_rk,   &
        6.829255398393113e-18_rk, 2.618848273351596e-18_rk, -0.019521354868503395_rk, -1.6980931373042148e-17_rk,   &
        -4.565222702911321e-18_rk, -1.4107195388693587e-18_rk, 0.07285468820183676_rk, -1.6614024199911667e-19_rk,   &
        -1.1131467548907251e-17_rk, 3.882905107618641e-18_rk, -3.692298896042553e-18_rk, -0.07285468820183674_rk,   &
        1.163409310477976e-17_rk, 9.86020458840453e-18_rk, 3.055988796288586e-18_rk, 0.27189739793884354_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,2) = reshape((/ &
        0.097606774342517_rk, 1.4712826960544735e-17_rk, 1.677476563559432e-17_rk, -4.1624303274247566e-17_rk,   &
        -0.097606774342517_rk, 5.930574939371927e-17_rk, -4.863977068136778e-18_rk, 1.9458392192321705e-17_rk,   &
        1.4712826960544735e-17_rk, 0.09760677434251698_rk, -4.1624303274247584e-17_rk, 1.6774765635594317e-17_rk,   &
        5.930574939371926e-17_rk, -0.097606774342517_rk, 1.9458392192321693e-17_rk, -4.863977068136787e-18_rk,   &
        -3.281908593167805e-17_rk, 1.9963102329390184e-17_rk, 0.36427344100918363_rk, 3.8456325165529836e-17_rk,   &
        -1.2868121900589464e-17_rk, -6.3509626992380445e-18_rk, -0.3642734410091838_rk, -1.7600114742314345e-17_rk,   &
        1.9963102329390178e-17_rk, -3.281908593167804e-17_rk, 3.8456325165529836e-17_rk, 0.36427344100918363_rk,   &
        -6.3509626992380415e-18_rk, -1.286812190058946e-17_rk, -1.7600114742314354e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,3) = reshape((/ &
        0.09760677434251702_rk, 4.8803098999980224e-17_rk, -1.731550640384116e-17_rk, -5.4843742672391406e-17_rk,   &
        -0.097606774342517_rk, 2.2494770338353943e-17_rk, 2.3480963843911808e-17_rk, 3.338333476907526e-17_rk,   &
        4.366053126094353e-18_rk, 0.36427344100918363_rk, 3.318254172753401e-17_rk, 1.2711861077574387e-18_rk,   &
        1.9210864313050963e-17_rk, -0.3642734410091838_rk, -2.027590527599161e-17_rk, -4.1213062812638043e-17_rk,   &
        -1.731550640384117e-17_rk, -5.4843742672391393e-17_rk, 0.09760677434251698_rk, 4.8803098999980224e-17_rk,   &
        2.3480963843911796e-17_rk, 3.338333476907526e-17_rk, -0.097606774342517_rk, 2.249477033835395e-17_rk,   &
        3.3182541727534005e-17_rk, 1.2711861077574341e-18_rk, 4.366053126094353e-18_rk, 0.36427344100918363_rk,   &
        -2.0275905275991607e-17_rk, -4.1213062812638043e-17_rk, 1.9210864313050975e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face3_dx
        ! 
        test_dbr2_vol_face3_dx(:,:,1,1) = reshape((/ &
        0.27189739793884354_rk, 8.200809896864053e-18_rk, -4.101475369087135e-18_rk, 1.671379284351507e-18_rk,   &
        8.200809896864054e-18_rk, 0.27189739793884354_rk, 1.6713792843515075e-18_rk, -4.101475369087139e-18_rk,   &
        -0.019521354868503392_rk, -8.17684071124199e-18_rk, 3.034447270326844e-18_rk, -6.744579646410893e-18_rk,   &
        -8.17684071124199e-18_rk, -0.019521354868503392_rk, -6.744579646410891e-18_rk, 3.034447270326845e-18_rk,   &
        -1.6896829257760123e-17_rk, -9.794432737118914e-18_rk, 0.07285468820183674_rk, -8.775343009602743e-18_rk,   &
        -9.794432737118914e-18_rk, -1.6896829257760126e-17_rk, -8.775343009602741e-18_rk, 0.07285468820183674_rk,   &
        -1.3959252297831348e-17_rk, 8.483011168307946e-18_rk, -0.005230731272176839_rk, 6.730741030639739e-18_rk,   &
        8.483011168307945e-18_rk, -1.3959252297831348e-17_rk, 6.7307410306397404e-18_rk, -0.005230731272176839_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,1,2) = reshape((/ &
        1.359486989694218_rk, 3.3945099686697916e-17_rk, 1.596155482717587e-17_rk, 3.846846346383143e-17_rk,   &
        4.545927001062209e-17_rk, 0.3642734410091838_rk, -6.7208204263936466e-18_rk, -6.979234347763168e-17_rk,   &
        -0.36427344100918363_rk, -4.396731653997162e-18_rk, -2.6235217571245446e-17_rk, -5.3302570444236946e-17_rk,   &
        -6.377024003482173e-17_rk, -0.09760677434251697_rk, 2.7460334405571033e-18_rk, 4.5283803393708124e-17_rk,   &
        -4.1756287500659466e-17_rk, 2.1436543159332117e-19_rk, 0.3642734410091838_rk, -6.270023123233194e-17_rk,   &
        -8.352432903589412e-17_rk, -6.906830006942073e-17_rk, -3.721438349392472e-17_rk, 0.097606774342517_rk,   &
        -7.622960539357622e-17_rk, 5.826278240817856e-18_rk, -0.09760677434251697_rk, 5.774316875246263e-17_rk,   &
        8.514291462968087e-17_rk, -2.0609732371968836e-17_rk, 7.38924314580092e-18_rk, -0.026153656360884264_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,1,3) = reshape((/ &
        1.359486989694218_rk, -9.295305261561827e-18_rk, -3.3399391078901933e-17_rk, 1.9947046019563522e-17_rk,   &
        6.422639697868382e-18_rk, 0.3642734410091838_rk, -6.056231328340057e-17_rk, -7.159213205533436e-17_rk,   &
        -0.09760677434251698_rk, 3.922175130819472e-17_rk, -6.493371851277046e-17_rk, -3.741412670744188e-17_rk,   &
        -4.645224971120599e-17_rk, -0.026153656360884237_rk, 4.610628431692716e-17_rk, 1.0309693375247947e-17_rk,   &
        -3.339939107890192e-17_rk, 1.9947046019563516e-17_rk, 1.359486989694218_rk, -9.295305261561827e-18_rk,   &
        -6.056231328340055e-17_rk, -7.159213205533437e-17_rk, 6.4226396978683854e-18_rk, 0.3642734410091838_rk,   &
        -6.493371851277044e-17_rk, -3.741412670744189e-17_rk, -0.09760677434251692_rk, 3.922175130819471e-17_rk,   &
        4.610628431692716e-17_rk, 1.0309693375247932e-17_rk, -4.6452249711205976e-17_rk, -0.026153656360884223_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,1) = reshape((/ &
        -0.27189739793884354_rk, -8.200809896864053e-18_rk, 4.101475369087135e-18_rk, -1.671379284351507e-18_rk,   &
        -8.200809896864054e-18_rk, -0.27189739793884354_rk, -1.6713792843515075e-18_rk, 4.101475369087139e-18_rk,   &
        0.019521354868503392_rk, 8.17684071124199e-18_rk, -3.034447270326844e-18_rk, 6.744579646410893e-18_rk,   &
        8.17684071124199e-18_rk, 0.019521354868503392_rk, 6.744579646410891e-18_rk, -3.034447270326845e-18_rk,   &
        1.6896829257760123e-17_rk, 9.794432737118914e-18_rk, -0.07285468820183674_rk, 8.775343009602743e-18_rk,   &
        9.794432737118914e-18_rk, 1.6896829257760126e-17_rk, 8.775343009602741e-18_rk, -0.07285468820183674_rk,   &
        1.3959252297831348e-17_rk, -8.483011168307946e-18_rk, 0.005230731272176839_rk, -6.730741030639739e-18_rk,   &
        -8.483011168307945e-18_rk, 1.3959252297831348e-17_rk, -6.7307410306397404e-18_rk, 0.005230731272176839_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,2) = reshape((/ &
        0.3642734410091838_rk, 4.545927001062209e-17_rk, -6.979234347763169e-17_rk, -6.7208204263936404e-18_rk,   &
        3.394509968669792e-17_rk, 1.359486989694218_rk, 3.846846346383143e-17_rk, 1.5961554827175883e-17_rk,   &
        -0.09760677434251697_rk, -6.37702400348217e-17_rk, 4.52838033937081e-17_rk, 2.7460334405571157e-18_rk,   &
        -4.3967316539971726e-18_rk, -0.3642734410091836_rk, -5.3302570444236946e-17_rk, -2.6235217571245437e-17_rk,   &
        -6.906830006942073e-17_rk, -8.352432903589412e-17_rk, 0.097606774342517_rk, -3.721438349392472e-17_rk,   &
        2.1436543159332117e-19_rk, -4.175628750065947e-17_rk, -6.270023123233194e-17_rk, 0.3642734410091838_rk,   &
        -2.060973237196884e-17_rk, 8.514291462968085e-17_rk, -0.026153656360884264_rk, 7.389243145800925e-18_rk,   &
        5.826278240817862e-18_rk, -7.622960539357622e-17_rk, 5.774316875246261e-17_rk, -0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,3) = reshape((/ &
        0.3642734410091838_rk, 6.422639697868391e-18_rk, -7.159213205533439e-17_rk, -6.056231328340055e-17_rk,   &
        -9.29530526156183e-18_rk, 1.359486989694218_rk, 1.9947046019563522e-17_rk, -3.339939107890192e-17_rk,   &
        -0.026153656360884223_rk, -4.645224971120597e-17_rk, 1.0309693375247921e-17_rk, 4.6106284316927175e-17_rk,   &
        3.922175130819471e-17_rk, -0.09760677434251695_rk, -3.741412670744188e-17_rk, -6.493371851277043e-17_rk,   &
        -7.159213205533436e-17_rk, -6.056231328340055e-17_rk, 0.3642734410091838_rk, 6.422639697868385e-18_rk,   &
        1.9947046019563516e-17_rk, -3.339939107890192e-17_rk, -9.295305261561827e-18_rk, 1.359486989694218_rk,   &
        1.0309693375247926e-17_rk, 4.610628431692716e-17_rk, -0.026153656360884223_rk, -4.645224971120598e-17_rk,   &
        -3.741412670744189e-17_rk, -6.493371851277044e-17_rk, 3.922175130819472e-17_rk, -0.09760677434251692_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,1) = reshape((/ &
        -0.07285468820183676_rk, -7.68006404259995e-18_rk, 6.6646823610040225e-18_rk, -4.678149323136047e-18_rk,   &
        -7.680064042599951e-18_rk, -0.07285468820183676_rk, -4.678149323136049e-18_rk, 6.6646823610040256e-18_rk,   &
        0.07285468820183673_rk, 5.4565536265217855e-18_rk, -7.752698941656895e-19_rk, 3.3667277543250808e-18_rk,   &
        5.4565536265217855e-18_rk, 0.07285468820183673_rk, 3.3667277543250785e-18_rk, -7.752698941656907e-19_rk,   &
        5.268088256255915e-18_rk, 6.867559983741242e-18_rk, -0.019521354868503413_rk, 1.1207579935648591e-17_rk,   &
        6.867559983741242e-18_rk, 5.268088256255916e-18_rk, 1.120757993564859e-17_rk, -0.019521354868503413_rk,   &
        5.408615255277664e-18_rk, -9.7108274057918e-18_rk, 0.01952135486850341_rk, -6.2957413490129704e-18_rk,   &
        -9.7108274057918e-18_rk, 5.408615255277664e-18_rk, -6.295741349012971e-18_rk, 0.01952135486850341_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,2) = reshape((/ &
        -0.3642734410091838_rk, -4.545927001062209e-17_rk, 6.979234347763169e-17_rk, 6.7208204263936404e-18_rk,   &
        -3.394509968669792e-17_rk, -1.359486989694218_rk, -3.846846346383143e-17_rk, -1.5961554827175883e-17_rk,   &
        0.09760677434251697_rk, 6.37702400348217e-17_rk, -4.52838033937081e-17_rk, -2.7460334405571157e-18_rk,   &
        4.3967316539971726e-18_rk, 0.3642734410091836_rk, 5.3302570444236946e-17_rk, 2.6235217571245437e-17_rk,   &
        6.906830006942073e-17_rk, 8.352432903589412e-17_rk, -0.097606774342517_rk, 3.721438349392472e-17_rk,   &
        -2.1436543159332117e-19_rk, 4.175628750065947e-17_rk, 6.270023123233194e-17_rk, -0.3642734410091838_rk,   &
        2.060973237196884e-17_rk, -8.514291462968085e-17_rk, 0.026153656360884264_rk, -7.389243145800925e-18_rk,   &
        -5.826278240817862e-18_rk, 7.622960539357622e-17_rk, -5.774316875246261e-17_rk, 0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,3) = reshape((/ &
        0.097606774342517_rk, 1.8222468188289873e-18_rk, -6.726851149171804e-17_rk, -2.96828361788872e-17_rk,   &
        -1.9459826284072194e-17_rk, 0.3642734410091838_rk, 1.8735782875861245e-17_rk, 7.604658405418336e-18_rk,   &
        -0.09760677434251698_rk, -9.928747177814809e-18_rk, 1.436437764649133e-17_rk, 4.178266375331082e-17_rk,   &
        1.4124685790270738e-17_rk, -0.36427344100918363_rk, -1.0062165495977196e-17_rk, -3.7531104452051214e-17_rk,   &
        -6.726851149171804e-17_rk, -2.968283617888721e-17_rk, 0.097606774342517_rk, 1.8222468188289846e-18_rk,   &
        1.8735782875861233e-17_rk, 7.604658405418339e-18_rk, -1.945982628407219e-17_rk, 0.3642734410091838_rk,   &
        1.4364377646491342e-17_rk, 4.1782663753310805e-17_rk, -0.09760677434251701_rk, -9.928747177814821e-18_rk,   &
        -1.0062165495977208e-17_rk, -3.753110445205121e-17_rk, 1.4124685790270738e-17_rk, -0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,1) = reshape((/ &
        0.07285468820183676_rk, 7.68006404259995e-18_rk, -6.6646823610040225e-18_rk, 4.678149323136047e-18_rk,   &
        7.680064042599951e-18_rk, 0.07285468820183676_rk, 4.678149323136049e-18_rk, -6.6646823610040256e-18_rk,   &
        -0.07285468820183673_rk, -5.4565536265217855e-18_rk, 7.752698941656895e-19_rk, -3.3667277543250808e-18_rk,   &
        -5.4565536265217855e-18_rk, -0.07285468820183673_rk, -3.3667277543250785e-18_rk, 7.752698941656907e-19_rk,   &
        -5.268088256255915e-18_rk, -6.867559983741242e-18_rk, 0.019521354868503413_rk, -1.1207579935648591e-17_rk,   &
        -6.867559983741242e-18_rk, -5.268088256255916e-18_rk, -1.120757993564859e-17_rk, 0.019521354868503413_rk,   &
        -5.408615255277664e-18_rk, 9.7108274057918e-18_rk, -0.01952135486850341_rk, 6.2957413490129704e-18_rk,   &
        9.7108274057918e-18_rk, -5.408615255277664e-18_rk, 6.295741349012971e-18_rk, -0.01952135486850341_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,2) = reshape((/ &
        -1.359486989694218_rk, -3.3945099686697916e-17_rk, -1.596155482717587e-17_rk, -3.846846346383143e-17_rk,   &
        -4.545927001062209e-17_rk, -0.3642734410091838_rk, 6.7208204263936466e-18_rk, 6.979234347763168e-17_rk,   &
        0.36427344100918363_rk, 4.396731653997162e-18_rk, 2.6235217571245446e-17_rk, 5.3302570444236946e-17_rk,   &
        6.377024003482173e-17_rk, 0.09760677434251697_rk, -2.7460334405571033e-18_rk, -4.5283803393708124e-17_rk,   &
        4.1756287500659466e-17_rk, -2.1436543159332117e-19_rk, -0.3642734410091838_rk, 6.270023123233194e-17_rk,   &
        8.352432903589412e-17_rk, 6.906830006942073e-17_rk, 3.721438349392472e-17_rk, -0.097606774342517_rk,   &
        7.622960539357622e-17_rk, -5.826278240817856e-18_rk, 0.09760677434251697_rk, -5.774316875246263e-17_rk,   &
        -8.514291462968087e-17_rk, 2.0609732371968836e-17_rk, -7.38924314580092e-18_rk, 0.026153656360884264_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,3) = reshape((/ &
        0.3642734410091838_rk, -1.945982628407219e-17_rk, 7.604658405418326e-18_rk, 1.873578287586124e-17_rk,   &
        1.82224681882898e-18_rk, 0.097606774342517_rk, -2.968283617888722e-17_rk, -6.726851149171804e-17_rk,   &
        -0.36427344100918363_rk, 1.4124685790270744e-17_rk, -3.753110445205122e-17_rk, -1.0062165495977196e-17_rk,   &
        -9.928747177814818e-18_rk, -0.09760677434251698_rk, 4.1782663753310805e-17_rk, 1.4364377646491348e-17_rk,   &
        7.604658405418336e-18_rk, 1.8735782875861233e-17_rk, 0.3642734410091838_rk, -1.945982628407219e-17_rk,   &
        -2.968283617888722e-17_rk, -6.726851149171803e-17_rk, 1.822246818828983e-18_rk, 0.097606774342517_rk,   &
        -3.753110445205121e-17_rk, -1.0062165495977208e-17_rk, -0.36427344100918363_rk, 1.4124685790270732e-17_rk,   &
        4.1782663753310805e-17_rk, 1.4364377646491342e-17_rk, -9.928747177814812e-18_rk, -0.09760677434251701_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,1) = reshape((/ &
        0.07285468820183674_rk, -8.775343009602744e-18_rk, -1.6896829257760123e-17_rk, -9.794432737118915e-18_rk,   &
        -8.775343009602743e-18_rk, 0.07285468820183674_rk, -9.794432737118914e-18_rk, -1.6896829257760126e-17_rk,   &
        -0.005230731272176844_rk, 6.7307410306397404e-18_rk, -1.3959252297831348e-17_rk, 8.483011168307945e-18_rk,   &
        6.7307410306397404e-18_rk, -0.005230731272176844_rk, 8.483011168307946e-18_rk, -1.3959252297831345e-17_rk,   &
        -4.101475369087137e-18_rk, 1.6713792843515077e-18_rk, 0.27189739793884354_rk, 8.200809896864054e-18_rk,   &
        1.6713792843515077e-18_rk, -4.101475369087136e-18_rk, 8.200809896864053e-18_rk, 0.27189739793884354_rk,   &
        3.0344472703268446e-18_rk, -6.744579646410892e-18_rk, -0.019521354868503392_rk, -8.17684071124199e-18_rk,   &
        -6.74457964641089e-18_rk, 3.0344472703268446e-18_rk, -8.17684071124199e-18_rk, -0.019521354868503392_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,2) = reshape((/ &
        0.3642734410091838_rk, -6.270023123233193e-17_rk, -4.175628750065948e-17_rk, 2.143654315933335e-19_rk,   &
        -3.721438349392473e-17_rk, 0.097606774342517_rk, -8.352432903589413e-17_rk, -6.906830006942073e-17_rk,   &
        -0.09760677434251697_rk, 5.774316875246263e-17_rk, -7.622960539357623e-17_rk, 5.826278240817865e-18_rk,   &
        7.389243145800927e-18_rk, -0.026153656360884264_rk, 8.514291462968085e-17_rk, -2.0609732371968827e-17_rk,   &
        1.5961554827175883e-17_rk, 3.846846346383143e-17_rk, 1.359486989694218_rk, 3.394509968669792e-17_rk,   &
        -6.7208204263936404e-18_rk, -6.979234347763168e-17_rk, 4.54592700106221e-17_rk, 0.3642734410091838_rk,   &
        -2.6235217571245434e-17_rk, -5.3302570444236946e-17_rk, -0.3642734410091836_rk, -4.396731653997178e-18_rk,   &
        2.746033440557097e-18_rk, 4.528380339370811e-17_rk, -6.37702400348217e-17_rk, -0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,3) = reshape((/ &
        -1.359486989694218_rk, 9.295305261561827e-18_rk, 3.3399391078901933e-17_rk, -1.9947046019563522e-17_rk,   &
        -6.422639697868382e-18_rk, -0.3642734410091838_rk, 6.056231328340057e-17_rk, 7.159213205533436e-17_rk,   &
        0.09760677434251698_rk, -3.922175130819472e-17_rk, 6.493371851277046e-17_rk, 3.741412670744188e-17_rk,   &
        4.645224971120599e-17_rk, 0.026153656360884237_rk, -4.610628431692716e-17_rk, -1.0309693375247947e-17_rk,   &
        3.339939107890192e-17_rk, -1.9947046019563516e-17_rk, -1.359486989694218_rk, 9.295305261561827e-18_rk,   &
        6.056231328340055e-17_rk, 7.159213205533437e-17_rk, -6.4226396978683854e-18_rk, -0.3642734410091838_rk,   &
        6.493371851277044e-17_rk, 3.741412670744189e-17_rk, 0.09760677434251692_rk, -3.922175130819471e-17_rk,   &
        -4.610628431692716e-17_rk, -1.0309693375247932e-17_rk, 4.6452249711205976e-17_rk, 0.026153656360884223_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,1) = reshape((/ &
        -0.07285468820183674_rk, 8.775343009602744e-18_rk, 1.6896829257760123e-17_rk, 9.794432737118915e-18_rk,   &
        8.775343009602743e-18_rk, -0.07285468820183674_rk, 9.794432737118914e-18_rk, 1.6896829257760126e-17_rk,   &
        0.005230731272176844_rk, -6.7307410306397404e-18_rk, 1.3959252297831348e-17_rk, -8.483011168307945e-18_rk,   &
        -6.7307410306397404e-18_rk, 0.005230731272176844_rk, -8.483011168307946e-18_rk, 1.3959252297831345e-17_rk,   &
        4.101475369087137e-18_rk, -1.6713792843515077e-18_rk, -0.27189739793884354_rk, -8.200809896864054e-18_rk,   &
        -1.6713792843515077e-18_rk, 4.101475369087136e-18_rk, -8.200809896864053e-18_rk, -0.27189739793884354_rk,   &
        -3.0344472703268446e-18_rk, 6.744579646410892e-18_rk, 0.019521354868503392_rk, 8.17684071124199e-18_rk,   &
        6.74457964641089e-18_rk, -3.0344472703268446e-18_rk, 8.17684071124199e-18_rk, 0.019521354868503392_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,2) = reshape((/ &
        0.097606774342517_rk, -3.7214383493924716e-17_rk, -6.906830006942074e-17_rk, -8.352432903589412e-17_rk,   &
        -6.270023123233194e-17_rk, 0.3642734410091838_rk, 2.1436543159333041e-19_rk, -4.1756287500659466e-17_rk,   &
        -0.02615365636088425_rk, 7.389243145800933e-18_rk, -2.0609732371968845e-17_rk, 8.514291462968088e-17_rk,   &
        5.774316875246263e-17_rk, -0.09760677434251697_rk, 5.826278240817865e-18_rk, -7.622960539357622e-17_rk,   &
        -6.979234347763168e-17_rk, -6.7208204263936404e-18_rk, 0.3642734410091838_rk, 4.54592700106221e-17_rk,   &
        3.846846346383143e-17_rk, 1.5961554827175886e-17_rk, 3.394509968669792e-17_rk, 1.359486989694218_rk,   &
        4.528380339370811e-17_rk, 2.7460334405571033e-18_rk, -0.09760677434251697_rk, -6.377024003482173e-17_rk,   &
        -5.330257044423696e-17_rk, -2.6235217571245434e-17_rk, -4.396731653997159e-18_rk, -0.3642734410091836_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,3) = reshape((/ &
        -0.3642734410091838_rk, -6.422639697868391e-18_rk, 7.159213205533439e-17_rk, 6.056231328340055e-17_rk,   &
        9.29530526156183e-18_rk, -1.359486989694218_rk, -1.9947046019563522e-17_rk, 3.339939107890192e-17_rk,   &
        0.026153656360884223_rk, 4.645224971120597e-17_rk, -1.0309693375247921e-17_rk, -4.6106284316927175e-17_rk,   &
        -3.922175130819471e-17_rk, 0.09760677434251695_rk, 3.741412670744188e-17_rk, 6.493371851277043e-17_rk,   &
        7.159213205533436e-17_rk, 6.056231328340055e-17_rk, -0.3642734410091838_rk, -6.422639697868385e-18_rk,   &
        -1.9947046019563516e-17_rk, 3.339939107890192e-17_rk, 9.295305261561827e-18_rk, -1.359486989694218_rk,   &
        -1.0309693375247926e-17_rk, -4.610628431692716e-17_rk, 0.026153656360884223_rk, 4.645224971120598e-17_rk,   &
        3.741412670744189e-17_rk, 6.493371851277044e-17_rk, -3.922175130819472e-17_rk, 0.09760677434251692_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,1) = reshape((/ &
        -0.019521354868503413_rk, 1.1207579935648592e-17_rk, 5.268088256255917e-18_rk, 6.867559983741242e-18_rk,   &
        1.1207579935648591e-17_rk, -0.019521354868503413_rk, 6.867559983741242e-18_rk, 5.268088256255918e-18_rk,   &
        0.0195213548685034_rk, -6.295741349012972e-18_rk, 5.4086152552776625e-18_rk, -9.7108274057918e-18_rk,   &
        -6.295741349012972e-18_rk, 0.0195213548685034_rk, -9.710827405791801e-18_rk, 5.408615255277664e-18_rk,   &
        6.6646823610040225e-18_rk, -4.678149323136049e-18_rk, -0.07285468820183676_rk, -7.680064042599951e-18_rk,   &
        -4.678149323136049e-18_rk, 6.664682361004022e-18_rk, -7.68006404259995e-18_rk, -0.07285468820183676_rk,   &
        -7.752698941656903e-19_rk, 3.3667277543250793e-18_rk, 0.07285468820183674_rk, 5.4565536265217855e-18_rk,   &
        3.3667277543250777e-18_rk, -7.752698941656903e-19_rk, 5.456553626521784e-18_rk, 0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,2) = reshape((/ &
        -0.097606774342517_rk, 3.7214383493924716e-17_rk, 6.906830006942074e-17_rk, 8.352432903589412e-17_rk,   &
        6.270023123233194e-17_rk, -0.3642734410091838_rk, -2.1436543159333041e-19_rk, 4.1756287500659466e-17_rk,   &
        0.02615365636088425_rk, -7.389243145800933e-18_rk, 2.0609732371968845e-17_rk, -8.514291462968088e-17_rk,   &
        -5.774316875246263e-17_rk, 0.09760677434251697_rk, -5.826278240817865e-18_rk, 7.622960539357622e-17_rk,   &
        6.979234347763168e-17_rk, 6.7208204263936404e-18_rk, -0.3642734410091838_rk, -4.54592700106221e-17_rk,   &
        -3.846846346383143e-17_rk, -1.5961554827175886e-17_rk, -3.394509968669792e-17_rk, -1.359486989694218_rk,   &
        -4.528380339370811e-17_rk, -2.7460334405571033e-18_rk, 0.09760677434251697_rk, 6.377024003482173e-17_rk,   &
        5.330257044423696e-17_rk, 2.6235217571245434e-17_rk, 4.396731653997159e-18_rk, 0.3642734410091836_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,3) = reshape((/ &
        -0.097606774342517_rk, -1.8222468188289873e-18_rk, 6.726851149171804e-17_rk, 2.96828361788872e-17_rk,   &
        1.9459826284072194e-17_rk, -0.3642734410091838_rk, -1.8735782875861245e-17_rk, -7.604658405418336e-18_rk,   &
        0.09760677434251698_rk, 9.928747177814809e-18_rk, -1.436437764649133e-17_rk, -4.178266375331082e-17_rk,   &
        -1.4124685790270738e-17_rk, 0.36427344100918363_rk, 1.0062165495977196e-17_rk, 3.7531104452051214e-17_rk,   &
        6.726851149171804e-17_rk, 2.968283617888721e-17_rk, -0.097606774342517_rk, -1.8222468188289846e-18_rk,   &
        -1.8735782875861233e-17_rk, -7.604658405418339e-18_rk, 1.945982628407219e-17_rk, -0.3642734410091838_rk,   &
        -1.4364377646491342e-17_rk, -4.1782663753310805e-17_rk, 0.09760677434251701_rk, 9.928747177814821e-18_rk,   &
        1.0062165495977208e-17_rk, 3.753110445205121e-17_rk, -1.4124685790270738e-17_rk, 0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,1) = reshape((/ &
        0.019521354868503413_rk, -1.1207579935648592e-17_rk, -5.268088256255917e-18_rk, -6.867559983741242e-18_rk,   &
        -1.1207579935648591e-17_rk, 0.019521354868503413_rk, -6.867559983741242e-18_rk, -5.268088256255918e-18_rk,   &
        -0.0195213548685034_rk, 6.295741349012972e-18_rk, -5.4086152552776625e-18_rk, 9.7108274057918e-18_rk,   &
        6.295741349012972e-18_rk, -0.0195213548685034_rk, 9.710827405791801e-18_rk, -5.408615255277664e-18_rk,   &
        -6.6646823610040225e-18_rk, 4.678149323136049e-18_rk, 0.07285468820183676_rk, 7.680064042599951e-18_rk,   &
        4.678149323136049e-18_rk, -6.664682361004022e-18_rk, 7.68006404259995e-18_rk, 0.07285468820183676_rk,   &
        7.752698941656903e-19_rk, -3.3667277543250793e-18_rk, -0.07285468820183674_rk, -5.4565536265217855e-18_rk,   &
        -3.3667277543250777e-18_rk, 7.752698941656903e-19_rk, -5.456553626521784e-18_rk, -0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,2) = reshape((/ &
        -0.3642734410091838_rk, 6.270023123233193e-17_rk, 4.175628750065948e-17_rk, -2.143654315933335e-19_rk,   &
        3.721438349392473e-17_rk, -0.097606774342517_rk, 8.352432903589413e-17_rk, 6.906830006942073e-17_rk,   &
        0.09760677434251697_rk, -5.774316875246263e-17_rk, 7.622960539357623e-17_rk, -5.826278240817865e-18_rk,   &
        -7.389243145800927e-18_rk, 0.026153656360884264_rk, -8.514291462968085e-17_rk, 2.0609732371968827e-17_rk,   &
        -1.5961554827175883e-17_rk, -3.846846346383143e-17_rk, -1.359486989694218_rk, -3.394509968669792e-17_rk,   &
        6.7208204263936404e-18_rk, 6.979234347763168e-17_rk, -4.54592700106221e-17_rk, -0.3642734410091838_rk,   &
        2.6235217571245434e-17_rk, 5.3302570444236946e-17_rk, 0.3642734410091836_rk, 4.396731653997178e-18_rk,   &
        -2.746033440557097e-18_rk, -4.528380339370811e-17_rk, 6.37702400348217e-17_rk, 0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,3) = reshape((/ &
        -0.3642734410091838_rk, 1.945982628407219e-17_rk, -7.604658405418326e-18_rk, -1.873578287586124e-17_rk,   &
        -1.82224681882898e-18_rk, -0.097606774342517_rk, 2.968283617888722e-17_rk, 6.726851149171804e-17_rk,   &
        0.36427344100918363_rk, -1.4124685790270744e-17_rk, 3.753110445205122e-17_rk, 1.0062165495977196e-17_rk,   &
        9.928747177814818e-18_rk, 0.09760677434251698_rk, -4.1782663753310805e-17_rk, -1.4364377646491348e-17_rk,   &
        -7.604658405418336e-18_rk, -1.8735782875861233e-17_rk, -0.3642734410091838_rk, 1.945982628407219e-17_rk,   &
        2.968283617888722e-17_rk, 6.726851149171803e-17_rk, -1.822246818828983e-18_rk, -0.097606774342517_rk,   &
        3.753110445205121e-17_rk, 1.0062165495977208e-17_rk, 0.36427344100918363_rk, -1.4124685790270732e-17_rk,   &
        -4.1782663753310805e-17_rk, -1.4364377646491342e-17_rk, 9.928747177814812e-18_rk, 0.09760677434251701_rk   &
        /),(/4,8/))


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face4_dx
        ! 
        test_dbr2_vol_face4_dx(:,:,1,1) = reshape((/ &
        -0.07285468820183671_rk, -5.456553626521785e-18_rk, 7.752698941656884e-19_rk, -3.3667277543250785e-18_rk,   &
        -5.4565536265217855e-18_rk, -0.07285468820183671_rk, -3.3667277543250785e-18_rk, 7.752698941656899e-19_rk,   &
        0.07285468820183676_rk, 7.680064042599947e-18_rk, -6.6646823610040225e-18_rk, 4.678149323136049e-18_rk,   &
        7.680064042599948e-18_rk, 0.07285468820183676_rk, 4.678149323136047e-18_rk, -6.6646823610040194e-18_rk,   &
        -5.408615255277666e-18_rk, 9.7108274057918e-18_rk, -0.019521354868503413_rk, 6.295741349012972e-18_rk,   &
        9.7108274057918e-18_rk, -5.408615255277665e-18_rk, 6.295741349012971e-18_rk, -0.019521354868503406_rk,   &
        -5.268088256255915e-18_rk, -6.867559983741243e-18_rk, 0.019521354868503413_rk, -1.1207579935648591e-17_rk,   &
        -6.867559983741243e-18_rk, -5.2680882562559155e-18_rk, -1.1207579935648591e-17_rk, 0.019521354868503413_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,1,2) = reshape((/ &
        -0.36427344100918363_rk, -4.3967316539971626e-18_rk, -2.623521757124543e-17_rk, -5.330257044423696e-17_rk,   &
        -6.377024003482172e-17_rk, -0.09760677434251702_rk, 2.746033440557097e-18_rk, 4.5283803393708124e-17_rk,   &
        1.359486989694218_rk, 3.394509968669791e-17_rk, 1.5961554827175865e-17_rk, 3.8468463463831436e-17_rk,   &
        4.54592700106221e-17_rk, 0.3642734410091838_rk, -6.720820426393659e-18_rk, -6.979234347763168e-17_rk,   &
        -7.622960539357623e-17_rk, 5.826278240817847e-18_rk, -0.09760677434251697_rk, 5.774316875246261e-17_rk,   &
        8.514291462968087e-17_rk, -2.0609732371968833e-17_rk, 7.389243145800927e-18_rk, -0.026153656360884278_rk,   &
        -4.1756287500659466e-17_rk, 2.1436543159333812e-19_rk, 0.3642734410091838_rk, -6.270023123233194e-17_rk,   &
        -8.352432903589412e-17_rk, -6.906830006942073e-17_rk, -3.721438349392473e-17_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,1,3) = reshape((/ &
        -0.36427344100918363_rk, 1.4124685790270744e-17_rk, -3.7531104452051214e-17_rk, -1.0062165495977208e-17_rk,   &
        -9.928747177814812e-18_rk, -0.09760677434251701_rk, 4.1782663753310805e-17_rk, 1.4364377646491348e-17_rk,   &
        0.3642734410091838_rk, -1.9459826284072197e-17_rk, 7.60465840541833e-18_rk, 1.8735782875861248e-17_rk,   &
        1.822246818828985e-18_rk, 0.097606774342517_rk, -2.968283617888722e-17_rk, -6.726851149171804e-17_rk,   &
        -3.753110445205122e-17_rk, -1.0062165495977214e-17_rk, -0.36427344100918363_rk, 1.4124685790270732e-17_rk,   &
        4.1782663753310805e-17_rk, 1.4364377646491342e-17_rk, -9.928747177814815e-18_rk, -0.09760677434251704_rk,   &
        7.604658405418337e-18_rk, 1.8735782875861245e-17_rk, 0.3642734410091838_rk, -1.9459826284072194e-17_rk,   &
        -2.9682836178887206e-17_rk, -6.726851149171804e-17_rk, 1.8222468188289792e-18_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,1) = reshape((/ &
        0.07285468820183671_rk, 5.456553626521785e-18_rk, -7.752698941656884e-19_rk, 3.3667277543250785e-18_rk,   &
        5.4565536265217855e-18_rk, 0.07285468820183671_rk, 3.3667277543250785e-18_rk, -7.752698941656899e-19_rk,   &
        -0.07285468820183676_rk, -7.680064042599947e-18_rk, 6.6646823610040225e-18_rk, -4.678149323136049e-18_rk,   &
        -7.680064042599948e-18_rk, -0.07285468820183676_rk, -4.678149323136047e-18_rk, 6.6646823610040194e-18_rk,   &
        5.408615255277666e-18_rk, -9.7108274057918e-18_rk, 0.019521354868503413_rk, -6.295741349012972e-18_rk,   &
        -9.7108274057918e-18_rk, 5.408615255277665e-18_rk, -6.295741349012971e-18_rk, 0.019521354868503406_rk,   &
        5.268088256255915e-18_rk, 6.867559983741243e-18_rk, -0.019521354868503413_rk, 1.1207579935648591e-17_rk,   &
        6.867559983741243e-18_rk, 5.2680882562559155e-18_rk, 1.1207579935648591e-17_rk, -0.019521354868503413_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,2) = reshape((/ &
        -0.09760677434251697_rk, -6.37702400348217e-17_rk, 4.528380339370812e-17_rk, 2.746033440557097e-18_rk,   &
        -4.396731653997164e-18_rk, -0.36427344100918363_rk, -5.330257044423696e-17_rk, -2.6235217571245428e-17_rk,   &
        0.3642734410091838_rk, 4.545927001062209e-17_rk, -6.979234347763168e-17_rk, -6.72082042639365e-18_rk,   &
        3.394509968669792e-17_rk, 1.359486989694218_rk, 3.846846346383142e-17_rk, 1.5961554827175874e-17_rk,   &
        -2.0609732371968833e-17_rk, 8.514291462968087e-17_rk, -0.026153656360884264_rk, 7.389243145800927e-18_rk,   &
        5.826278240817859e-18_rk, -7.622960539357623e-17_rk, 5.774316875246263e-17_rk, -0.097606774342517_rk,   &
        -6.906830006942073e-17_rk, -8.352432903589412e-17_rk, 0.097606774342517_rk, -3.721438349392472e-17_rk,   &
        2.1436543159332425e-19_rk, -4.1756287500659466e-17_rk, -6.270023123233194e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,3) = reshape((/ &
        -0.09760677434251698_rk, -9.928747177814809e-18_rk, 1.4364377646491342e-17_rk, 4.178266375331081e-17_rk,   &
        1.4124685790270735e-17_rk, -0.36427344100918363_rk, -1.0062165495977211e-17_rk, -3.753110445205121e-17_rk,   &
        0.097606774342517_rk, 1.8222468188289854e-18_rk, -6.726851149171803e-17_rk, -2.968283617888722e-17_rk,   &
        -1.945982628407219e-17_rk, 0.3642734410091838_rk, 1.873578287586124e-17_rk, 7.60465840541833e-18_rk,   &
        1.4364377646491342e-17_rk, 4.178266375331081e-17_rk, -0.09760677434251698_rk, -9.928747177814812e-18_rk,   &
        -1.0062165495977211e-17_rk, -3.753110445205122e-17_rk, 1.4124685790270738e-17_rk, -0.36427344100918363_rk,   &
        -6.726851149171804e-17_rk, -2.968283617888722e-17_rk, 0.097606774342517_rk, 1.822246818828983e-18_rk,   &
        1.873578287586124e-17_rk, 7.604658405418337e-18_rk, -1.945982628407219e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,1) = reshape((/ &
        0.0195213548685034_rk, 8.17684071124199e-18_rk, -3.0344472703268442e-18_rk, 6.744579646410891e-18_rk,   &
        8.176840711241992e-18_rk, 0.019521354868503406_rk, 6.744579646410892e-18_rk, -3.034447270326845e-18_rk,   &
        -0.27189739793884354_rk, -8.20080989686405e-18_rk, 4.101475369087137e-18_rk, -1.6713792843515077e-18_rk,   &
        -8.200809896864051e-18_rk, -0.27189739793884354_rk, -1.671379284351507e-18_rk, 4.101475369087135e-18_rk,   &
        1.3959252297831348e-17_rk, -8.483011168307945e-18_rk, 0.005230731272176844_rk, -6.7307410306397404e-18_rk,   &
        -8.483011168307945e-18_rk, 1.3959252297831348e-17_rk, -6.7307410306397404e-18_rk, 0.005230731272176841_rk,   &
        1.6896829257760123e-17_rk, 9.794432737118915e-18_rk, -0.07285468820183674_rk, 8.775343009602743e-18_rk,   &
        9.794432737118915e-18_rk, 1.6896829257760123e-17_rk, 8.775343009602743e-18_rk, -0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,2) = reshape((/ &
        0.09760677434251697_rk, 6.37702400348217e-17_rk, -4.528380339370812e-17_rk, -2.746033440557097e-18_rk,   &
        4.396731653997164e-18_rk, 0.36427344100918363_rk, 5.330257044423696e-17_rk, 2.6235217571245428e-17_rk,   &
        -0.3642734410091838_rk, -4.545927001062209e-17_rk, 6.979234347763168e-17_rk, 6.72082042639365e-18_rk,   &
        -3.394509968669792e-17_rk, -1.359486989694218_rk, -3.846846346383142e-17_rk, -1.5961554827175874e-17_rk,   &
        2.0609732371968833e-17_rk, -8.514291462968087e-17_rk, 0.026153656360884264_rk, -7.389243145800927e-18_rk,   &
        -5.826278240817859e-18_rk, 7.622960539357623e-17_rk, -5.774316875246263e-17_rk, 0.097606774342517_rk,   &
        6.906830006942073e-17_rk, 8.352432903589412e-17_rk, -0.097606774342517_rk, 3.721438349392472e-17_rk,   &
        -2.1436543159332425e-19_rk, 4.1756287500659466e-17_rk, 6.270023123233194e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,3) = reshape((/ &
        -0.026153656360884237_rk, -4.645224971120597e-17_rk, 1.030969337524793e-17_rk, 4.6106284316927156e-17_rk,   &
        3.922175130819472e-17_rk, -0.09760677434251704_rk, -3.741412670744189e-17_rk, -6.493371851277044e-17_rk,   &
        0.3642734410091838_rk, 6.422639697868389e-18_rk, -7.159213205533437e-17_rk, -6.056231328340055e-17_rk,   &
        -9.295305261561825e-18_rk, 1.359486989694218_rk, 1.9947046019563516e-17_rk, -3.339939107890193e-17_rk,   &
        1.0309693375247935e-17_rk, 4.610628431692717e-17_rk, -0.026153656360884237_rk, -4.6452249711205976e-17_rk,   &
        -3.741412670744189e-17_rk, -6.493371851277046e-17_rk, 3.922175130819472e-17_rk, -0.09760677434251701_rk,   &
        -7.159213205533436e-17_rk, -6.056231328340057e-17_rk, 0.3642734410091838_rk, 6.422639697868385e-18_rk,   &
        1.9947046019563516e-17_rk, -3.339939107890192e-17_rk, -9.295305261561827e-18_rk, 1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,1) = reshape((/ &
        -0.0195213548685034_rk, -8.17684071124199e-18_rk, 3.0344472703268442e-18_rk, -6.744579646410891e-18_rk,   &
        -8.176840711241992e-18_rk, -0.019521354868503406_rk, -6.744579646410892e-18_rk, 3.034447270326845e-18_rk,   &
        0.27189739793884354_rk, 8.20080989686405e-18_rk, -4.101475369087137e-18_rk, 1.6713792843515077e-18_rk,   &
        8.200809896864051e-18_rk, 0.27189739793884354_rk, 1.671379284351507e-18_rk, -4.101475369087135e-18_rk,   &
        -1.3959252297831348e-17_rk, 8.483011168307945e-18_rk, -0.005230731272176844_rk, 6.7307410306397404e-18_rk,   &
        8.483011168307945e-18_rk, -1.3959252297831348e-17_rk, 6.7307410306397404e-18_rk, -0.005230731272176841_rk,   &
        -1.6896829257760123e-17_rk, -9.794432737118915e-18_rk, 0.07285468820183674_rk, -8.775343009602743e-18_rk,   &
        -9.794432737118915e-18_rk, -1.6896829257760123e-17_rk, -8.775343009602743e-18_rk, 0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,2) = reshape((/ &
        0.36427344100918363_rk, 4.3967316539971626e-18_rk, 2.623521757124543e-17_rk, 5.330257044423696e-17_rk,   &
        6.377024003482172e-17_rk, 0.09760677434251702_rk, -2.746033440557097e-18_rk, -4.5283803393708124e-17_rk,   &
        -1.359486989694218_rk, -3.394509968669791e-17_rk, -1.5961554827175865e-17_rk, -3.8468463463831436e-17_rk,   &
        -4.54592700106221e-17_rk, -0.3642734410091838_rk, 6.720820426393659e-18_rk, 6.979234347763168e-17_rk,   &
        7.622960539357623e-17_rk, -5.826278240817847e-18_rk, 0.09760677434251697_rk, -5.774316875246261e-17_rk,   &
        -8.514291462968087e-17_rk, 2.0609732371968833e-17_rk, -7.389243145800927e-18_rk, 0.026153656360884278_rk,   &
        4.1756287500659466e-17_rk, -2.1436543159333812e-19_rk, -0.3642734410091838_rk, 6.270023123233194e-17_rk,   &
        8.352432903589412e-17_rk, 6.906830006942073e-17_rk, 3.721438349392473e-17_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,3) = reshape((/ &
        -0.09760677434251698_rk, 3.922175130819472e-17_rk, -6.493371851277044e-17_rk, -3.74141267074419e-17_rk,   &
        -4.645224971120598e-17_rk, -0.026153656360884278_rk, 4.610628431692716e-17_rk, 1.0309693375247943e-17_rk,   &
        1.359486989694218_rk, -9.295305261561828e-18_rk, -3.339939107890194e-17_rk, 1.9947046019563525e-17_rk,   &
        6.422639697868389e-18_rk, 0.3642734410091838_rk, -6.056231328340055e-17_rk, -7.159213205533436e-17_rk,   &
        -6.493371851277047e-17_rk, -3.74141267074419e-17_rk, -0.09760677434251695_rk, 3.9221751308194705e-17_rk,   &
        4.610628431692716e-17_rk, 1.0309693375247933e-17_rk, -4.6452249711205976e-17_rk, -0.026153656360884264_rk,   &
        -3.339939107890192e-17_rk, 1.9947046019563522e-17_rk, 1.359486989694218_rk, -9.29530526156183e-18_rk,   &
        -6.056231328340055e-17_rk, -7.159213205533436e-17_rk, 6.422639697868382e-18_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,1) = reshape((/ &
        -0.019521354868503395_rk, 6.295741349012971e-18_rk, -5.408615255277665e-18_rk, 9.710827405791801e-18_rk,   &
        6.295741349012971e-18_rk, -0.0195213548685034_rk, 9.710827405791801e-18_rk, -5.408615255277665e-18_rk,   &
        0.019521354868503413_rk, -1.120757993564859e-17_rk, -5.268088256255918e-18_rk, -6.867559983741242e-18_rk,   &
        -1.1207579935648591e-17_rk, 0.019521354868503413_rk, -6.867559983741242e-18_rk, -5.2680882562559155e-18_rk,   &
        7.752698941656888e-19_rk, -3.366727754325077e-18_rk, -0.07285468820183673_rk, -5.4565536265217855e-18_rk,   &
        -3.3667277543250777e-18_rk, 7.752698941656899e-19_rk, -5.456553626521785e-18_rk, -0.07285468820183673_rk,   &
        -6.6646823610040225e-18_rk, 4.6781493231360495e-18_rk, 0.07285468820183676_rk, 7.680064042599951e-18_rk,   &
        4.6781493231360495e-18_rk, -6.664682361004022e-18_rk, 7.680064042599951e-18_rk, 0.07285468820183676_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,2) = reshape((/ &
        -0.09760677434251697_rk, 5.774316875246263e-17_rk, -7.622960539357623e-17_rk, 5.826278240817859e-18_rk,   &
        7.389243145800927e-18_rk, -0.026153656360884278_rk, 8.514291462968087e-17_rk, -2.0609732371968833e-17_rk,   &
        0.3642734410091838_rk, -6.270023123233194e-17_rk, -4.175628750065948e-17_rk, 2.1436543159333658e-19_rk,   &
        -3.721438349392472e-17_rk, 0.097606774342517_rk, -8.352432903589412e-17_rk, -6.906830006942073e-17_rk,   &
        -2.623521757124545e-17_rk, -5.330257044423696e-17_rk, -0.3642734410091836_rk, -4.396731653997171e-18_rk,   &
        2.746033440557097e-18_rk, 4.528380339370811e-17_rk, -6.377024003482172e-17_rk, -0.09760677434251702_rk,   &
        1.5961554827175883e-17_rk, 3.846846346383143e-17_rk, 1.359486989694218_rk, 3.394509968669791e-17_rk,   &
        -6.720820426393634e-18_rk, -6.979234347763168e-17_rk, 4.545927001062209e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,3) = reshape((/ &
        0.36427344100918363_rk, -1.4124685790270744e-17_rk, 3.7531104452051214e-17_rk, 1.0062165495977208e-17_rk,   &
        9.928747177814812e-18_rk, 0.09760677434251701_rk, -4.1782663753310805e-17_rk, -1.4364377646491348e-17_rk,   &
        -0.3642734410091838_rk, 1.9459826284072197e-17_rk, -7.60465840541833e-18_rk, -1.8735782875861248e-17_rk,   &
        -1.822246818828985e-18_rk, -0.097606774342517_rk, 2.968283617888722e-17_rk, 6.726851149171804e-17_rk,   &
        3.753110445205122e-17_rk, 1.0062165495977214e-17_rk, 0.36427344100918363_rk, -1.4124685790270732e-17_rk,   &
        -4.1782663753310805e-17_rk, -1.4364377646491342e-17_rk, 9.928747177814815e-18_rk, 0.09760677434251704_rk,   &
        -7.604658405418337e-18_rk, -1.8735782875861245e-17_rk, -0.3642734410091838_rk, 1.9459826284072194e-17_rk,   &
        2.9682836178887206e-17_rk, 6.726851149171804e-17_rk, -1.8222468188289792e-18_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,1) = reshape((/ &
        0.019521354868503395_rk, -6.295741349012971e-18_rk, 5.408615255277665e-18_rk, -9.710827405791801e-18_rk,   &
        -6.295741349012971e-18_rk, 0.0195213548685034_rk, -9.710827405791801e-18_rk, 5.408615255277665e-18_rk,   &
        -0.019521354868503413_rk, 1.120757993564859e-17_rk, 5.268088256255918e-18_rk, 6.867559983741242e-18_rk,   &
        1.1207579935648591e-17_rk, -0.019521354868503413_rk, 6.867559983741242e-18_rk, 5.2680882562559155e-18_rk,   &
        -7.752698941656888e-19_rk, 3.366727754325077e-18_rk, 0.07285468820183673_rk, 5.4565536265217855e-18_rk,   &
        3.3667277543250777e-18_rk, -7.752698941656899e-19_rk, 5.456553626521785e-18_rk, 0.07285468820183673_rk,   &
        6.6646823610040225e-18_rk, -4.6781493231360495e-18_rk, -0.07285468820183676_rk, -7.680064042599951e-18_rk,   &
        -4.6781493231360495e-18_rk, 6.664682361004022e-18_rk, -7.680064042599951e-18_rk, -0.07285468820183676_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,2) = reshape((/ &
        -0.02615365636088425_rk, 7.389243145800932e-18_rk, -2.0609732371968845e-17_rk, 8.514291462968087e-17_rk,   &
        5.774316875246263e-17_rk, -0.097606774342517_rk, 5.826278240817859e-18_rk, -7.622960539357623e-17_rk,   &
        0.097606774342517_rk, -3.7214383493924716e-17_rk, -6.906830006942073e-17_rk, -8.352432903589412e-17_rk,   &
        -6.270023123233194e-17_rk, 0.3642734410091838_rk, 2.1436543159333658e-19_rk, -4.175628750065947e-17_rk,   &
        4.528380339370811e-17_rk, 2.7460334405571095e-18_rk, -0.09760677434251697_rk, -6.377024003482172e-17_rk,   &
        -5.330257044423696e-17_rk, -2.623521757124545e-17_rk, -4.396731653997165e-18_rk, -0.36427344100918363_rk,   &
        -6.979234347763168e-17_rk, -6.720820426393651e-18_rk, 0.3642734410091838_rk, 4.5459270010622085e-17_rk,   &
        3.846846346383143e-17_rk, 1.5961554827175877e-17_rk, 3.394509968669792e-17_rk, 1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,3) = reshape((/ &
        0.09760677434251698_rk, 9.928747177814809e-18_rk, -1.4364377646491342e-17_rk, -4.178266375331081e-17_rk,   &
        -1.4124685790270735e-17_rk, 0.36427344100918363_rk, 1.0062165495977211e-17_rk, 3.753110445205121e-17_rk,   &
        -0.097606774342517_rk, -1.8222468188289854e-18_rk, 6.726851149171803e-17_rk, 2.968283617888722e-17_rk,   &
        1.945982628407219e-17_rk, -0.3642734410091838_rk, -1.873578287586124e-17_rk, -7.60465840541833e-18_rk,   &
        -1.4364377646491342e-17_rk, -4.178266375331081e-17_rk, 0.09760677434251698_rk, 9.928747177814812e-18_rk,   &
        1.0062165495977211e-17_rk, 3.753110445205122e-17_rk, -1.4124685790270738e-17_rk, 0.36427344100918363_rk,   &
        6.726851149171804e-17_rk, 2.968283617888722e-17_rk, -0.097606774342517_rk, -1.822246818828983e-18_rk,   &
        -1.873578287586124e-17_rk, -7.604658405418337e-18_rk, 1.945982628407219e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,1) = reshape((/ &
        0.005230731272176846_rk, -6.7307410306397404e-18_rk, 1.395925229783135e-17_rk, -8.483011168307946e-18_rk,   &
        -6.73074103063974e-18_rk, 0.005230731272176846_rk, -8.483011168307946e-18_rk, 1.395925229783135e-17_rk,   &
        -0.07285468820183674_rk, 8.775343009602741e-18_rk, 1.6896829257760126e-17_rk, 9.794432737118914e-18_rk,   &
        8.775343009602743e-18_rk, -0.07285468820183674_rk, 9.794432737118915e-18_rk, 1.6896829257760123e-17_rk,   &
        -3.0344472703268446e-18_rk, 6.74457964641089e-18_rk, 0.0195213548685034_rk, 8.17684071124199e-18_rk,   &
        6.74457964641089e-18_rk, -3.0344472703268465e-18_rk, 8.17684071124199e-18_rk, 0.019521354868503406_rk,   &
        4.101475369087137e-18_rk, -1.6713792843515083e-18_rk, -0.27189739793884354_rk, -8.200809896864054e-18_rk,   &
        -1.6713792843515083e-18_rk, 4.101475369087138e-18_rk, -8.200809896864054e-18_rk, -0.27189739793884354_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,2) = reshape((/ &
        0.02615365636088425_rk, -7.389243145800932e-18_rk, 2.0609732371968845e-17_rk, -8.514291462968087e-17_rk,   &
        -5.774316875246263e-17_rk, 0.097606774342517_rk, -5.826278240817859e-18_rk, 7.622960539357623e-17_rk,   &
        -0.097606774342517_rk, 3.7214383493924716e-17_rk, 6.906830006942073e-17_rk, 8.352432903589412e-17_rk,   &
        6.270023123233194e-17_rk, -0.3642734410091838_rk, -2.1436543159333658e-19_rk, 4.175628750065947e-17_rk,   &
        -4.528380339370811e-17_rk, -2.7460334405571095e-18_rk, 0.09760677434251697_rk, 6.377024003482172e-17_rk,   &
        5.330257044423696e-17_rk, 2.623521757124545e-17_rk, 4.396731653997165e-18_rk, 0.36427344100918363_rk,   &
        6.979234347763168e-17_rk, 6.720820426393651e-18_rk, -0.3642734410091838_rk, -4.5459270010622085e-17_rk,   &
        -3.846846346383143e-17_rk, -1.5961554827175877e-17_rk, -3.394509968669792e-17_rk, -1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,3) = reshape((/ &
        0.026153656360884237_rk, 4.645224971120597e-17_rk, -1.030969337524793e-17_rk, -4.6106284316927156e-17_rk,   &
        -3.922175130819472e-17_rk, 0.09760677434251704_rk, 3.741412670744189e-17_rk, 6.493371851277044e-17_rk,   &
        -0.3642734410091838_rk, -6.422639697868389e-18_rk, 7.159213205533437e-17_rk, 6.056231328340055e-17_rk,   &
        9.295305261561825e-18_rk, -1.359486989694218_rk, -1.9947046019563516e-17_rk, 3.339939107890193e-17_rk,   &
        -1.0309693375247935e-17_rk, -4.610628431692717e-17_rk, 0.026153656360884237_rk, 4.6452249711205976e-17_rk,   &
        3.741412670744189e-17_rk, 6.493371851277046e-17_rk, -3.922175130819472e-17_rk, 0.09760677434251701_rk,   &
        7.159213205533436e-17_rk, 6.056231328340057e-17_rk, -0.3642734410091838_rk, -6.422639697868385e-18_rk,   &
        -1.9947046019563516e-17_rk, 3.339939107890192e-17_rk, 9.295305261561827e-18_rk, -1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,1) = reshape((/ &
        -0.005230731272176846_rk, 6.7307410306397404e-18_rk, -1.395925229783135e-17_rk, 8.483011168307946e-18_rk,   &
        6.73074103063974e-18_rk, -0.005230731272176846_rk, 8.483011168307946e-18_rk, -1.395925229783135e-17_rk,   &
        0.07285468820183674_rk, -8.775343009602741e-18_rk, -1.6896829257760126e-17_rk, -9.794432737118914e-18_rk,   &
        -8.775343009602743e-18_rk, 0.07285468820183674_rk, -9.794432737118915e-18_rk, -1.6896829257760123e-17_rk,   &
        3.0344472703268446e-18_rk, -6.74457964641089e-18_rk, -0.0195213548685034_rk, -8.17684071124199e-18_rk,   &
        -6.74457964641089e-18_rk, 3.0344472703268465e-18_rk, -8.17684071124199e-18_rk, -0.019521354868503406_rk,   &
        -4.101475369087137e-18_rk, 1.6713792843515083e-18_rk, 0.27189739793884354_rk, 8.200809896864054e-18_rk,   &
        1.6713792843515083e-18_rk, -4.101475369087138e-18_rk, 8.200809896864054e-18_rk, 0.27189739793884354_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,2) = reshape((/ &
        0.09760677434251697_rk, -5.774316875246263e-17_rk, 7.622960539357623e-17_rk, -5.826278240817859e-18_rk,   &
        -7.389243145800927e-18_rk, 0.026153656360884278_rk, -8.514291462968087e-17_rk, 2.0609732371968833e-17_rk,   &
        -0.3642734410091838_rk, 6.270023123233194e-17_rk, 4.175628750065948e-17_rk, -2.1436543159333658e-19_rk,   &
        3.721438349392472e-17_rk, -0.097606774342517_rk, 8.352432903589412e-17_rk, 6.906830006942073e-17_rk,   &
        2.623521757124545e-17_rk, 5.330257044423696e-17_rk, 0.3642734410091836_rk, 4.396731653997171e-18_rk,   &
        -2.746033440557097e-18_rk, -4.528380339370811e-17_rk, 6.377024003482172e-17_rk, 0.09760677434251702_rk,   &
        -1.5961554827175883e-17_rk, -3.846846346383143e-17_rk, -1.359486989694218_rk, -3.394509968669791e-17_rk,   &
        6.720820426393634e-18_rk, 6.979234347763168e-17_rk, -4.545927001062209e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,3) = reshape((/ &
        0.09760677434251698_rk, -3.922175130819472e-17_rk, 6.493371851277044e-17_rk, 3.74141267074419e-17_rk,   &
        4.645224971120598e-17_rk, 0.026153656360884278_rk, -4.610628431692716e-17_rk, -1.0309693375247943e-17_rk,   &
        -1.359486989694218_rk, 9.295305261561828e-18_rk, 3.339939107890194e-17_rk, -1.9947046019563525e-17_rk,   &
        -6.422639697868389e-18_rk, -0.3642734410091838_rk, 6.056231328340055e-17_rk, 7.159213205533436e-17_rk,   &
        6.493371851277047e-17_rk, 3.74141267074419e-17_rk, 0.09760677434251695_rk, -3.9221751308194705e-17_rk,   &
        -4.610628431692716e-17_rk, -1.0309693375247933e-17_rk, 4.6452249711205976e-17_rk, 0.026153656360884264_rk,   &
        3.339939107890192e-17_rk, -1.9947046019563522e-17_rk, -1.359486989694218_rk, 9.29530526156183e-18_rk,   &
        6.056231328340055e-17_rk, 7.159213205533436e-17_rk, -6.422639697868382e-18_rk, -0.3642734410091838_rk   &
        /),(/4,8/))


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face5_dx
        ! 
        test_dbr2_vol_face5_dx(:,:,1,1) = reshape((/ &
        0.27189739793884354_rk, 1.0118436674226362e-17_rk, 9.62664843776449e-19_rk, -5.216938623046463e-18_rk,   &
        1.0118436674226362e-17_rk, 0.27189739793884354_rk, -5.216938623046463e-18_rk, 9.626648437764492e-19_rk,   &
        -2.8681835009819495e-22_rk, -2.2553832847358812e-17_rk, 0.07285468820183674_rk, -3.814495631067889e-18_rk,   &
        -2.2553832847358812e-17_rk, -2.8681835009800236e-22_rk, -3.814495631067889e-18_rk, 0.07285468820183674_rk,   &
        -0.019521354868503392_rk, -1.9676465669835287e-17_rk, 2.699529161063475e-18_rk, -6.201221845529932e-18_rk,   &
        -1.967646566983528e-17_rk, -0.0195213548685034_rk, -6.201221845529936e-18_rk, 2.699529161063475e-18_rk,   &
        -1.7570086703857007e-17_rk, 1.580447473437256e-17_rk, -0.005230731272176846_rk, 2.8507603666363312e-18_rk,   &
        1.5804474734372563e-17_rk, -1.7570086703857007e-17_rk, 2.8507603666363312e-18_rk, -0.005230731272176849_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,1,2) = reshape((/ &
        1.3594869896942177_rk, 1.5276025969917875e-17_rk, 4.012948162009618e-17_rk, -3.141983360903379e-17_rk,   &
        1.6243679245874492e-17_rk, 0.3642734410091837_rk, -1.0743402374299259e-16_rk, -3.531759149296442e-17_rk,   &
        4.012948162009618e-17_rk, -3.141983360903378e-17_rk, 1.3594869896942177_rk, 1.5276025969917875e-17_rk,   &
        -1.0743402374299259e-16_rk, -3.531759149296442e-17_rk, 1.6243679245874492e-17_rk, 0.3642734410091837_rk,   &
        -0.09760677434251697_rk, 1.0984518025954827e-17_rk, -9.586920056981388e-17_rk, -3.671932773538326e-17_rk,   &
        -9.511304454194962e-17_rk, -0.02615365636088423_rk, 8.47355921795964e-17_rk, 2.1516412855846226e-17_rk,   &
        -9.586920056981388e-17_rk, -3.671932773538327e-17_rk, -0.09760677434251697_rk, 1.098451802595483e-17_rk,   &
        8.47355921795964e-17_rk, 2.1516412855846222e-17_rk, -9.51130445419496e-17_rk, -0.02615365636088423_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,1,3) = reshape((/ &
        1.3594869896942177_rk, 4.2976820759162366e-17_rk, 2.0502024742160128e-17_rk, 1.1936499255811214e-17_rk,   &
        4.134074476379848e-17_rk, 0.3642734410091837_rk, -7.733774448329249e-18_rk, -3.522307198948139e-17_rk,   &
        3.080884993390708e-17_rk, -2.0709603978727433e-17_rk, 0.3642734410091837_rk, -2.4691177159590007e-17_rk,   &
        -1.2468282098775258e-16_rk, -3.639046847895518e-17_rk, -1.6737685176391862e-17_rk, 0.09760677434251697_rk,   &
        -0.36427344100918363_rk, -2.532070106431794e-17_rk, -3.6230673908141455e-17_rk, -1.1392624078344315e-16_rk,   &
        -8.84760394124879e-17_rk, -0.09760677434251697_rk, -1.4259153936457195e-17_rk, 5.151883817636091e-17_rk,   &
        -9.129805212692682e-17_rk, -7.96027817822419e-18_rk, -0.09760677434251697_rk, 5.434085089079982e-17_rk,   &
        1.1378211825872966e-16_rk, 4.209126738781587e-18_rk, 4.587204752713729e-18_rk, -0.02615365636088423_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,1) = reshape((/ &
        -0.27189739793884354_rk, -1.0118436674226362e-17_rk, -9.62664843776449e-19_rk, 5.216938623046463e-18_rk,   &
        -1.0118436674226362e-17_rk, -0.27189739793884354_rk, 5.216938623046463e-18_rk, -9.626648437764492e-19_rk,   &
        2.8681835009819495e-22_rk, 2.2553832847358812e-17_rk, -0.07285468820183674_rk, 3.814495631067889e-18_rk,   &
        2.2553832847358812e-17_rk, 2.8681835009800236e-22_rk, 3.814495631067889e-18_rk, -0.07285468820183674_rk,   &
        0.019521354868503392_rk, 1.9676465669835287e-17_rk, -2.699529161063475e-18_rk, 6.201221845529932e-18_rk,   &
        1.967646566983528e-17_rk, 0.0195213548685034_rk, 6.201221845529936e-18_rk, -2.699529161063475e-18_rk,   &
        1.7570086703857007e-17_rk, -1.580447473437256e-17_rk, 0.005230731272176846_rk, -2.8507603666363312e-18_rk,   &
        -1.5804474734372563e-17_rk, 1.7570086703857007e-17_rk, -2.8507603666363312e-18_rk, 0.005230731272176849_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,2) = reshape((/ &
        0.3642734410091837_rk, 1.6243679245874492e-17_rk, -3.531759149296442e-17_rk, -1.0743402374299259e-16_rk,   &
        1.5276025969917875e-17_rk, 1.3594869896942177_rk, -3.141983360903378e-17_rk, 4.012948162009618e-17_rk,   &
        -3.531759149296443e-17_rk, -1.0743402374299259e-16_rk, 0.3642734410091837_rk, 1.6243679245874492e-17_rk,   &
        -3.1419833609033773e-17_rk, 4.012948162009618e-17_rk, 1.5276025969917875e-17_rk, 1.3594869896942177_rk,   &
        -0.02615365636088423_rk, -9.51130445419496e-17_rk, 2.151641285584622e-17_rk, 8.47355921795964e-17_rk,   &
        1.0984518025954833e-17_rk, -0.09760677434251697_rk, -3.671932773538326e-17_rk, -9.586920056981388e-17_rk,   &
        2.151641285584622e-17_rk, 8.473559217959642e-17_rk, -0.02615365636088423_rk, -9.511304454194962e-17_rk,   &
        -3.671932773538327e-17_rk, -9.586920056981388e-17_rk, 1.0984518025954839e-17_rk, -0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,3) = reshape((/ &
        0.3642734410091837_rk, 4.134074476379848e-17_rk, -3.522307198948139e-17_rk, -7.73377444832924e-18_rk,   &
        4.2976820759162366e-17_rk, 1.3594869896942177_rk, 1.1936499255811217e-17_rk, 2.050202474216013e-17_rk,   &
        -3.639046847895519e-17_rk, -1.2468282098775258e-16_rk, 0.09760677434251697_rk, -1.6737685176391862e-17_rk,   &
        -2.0709603978727427e-17_rk, 3.080884993390708e-17_rk, -2.4691177159590007e-17_rk, 0.3642734410091837_rk,   &
        -0.09760677434251697_rk, -8.84760394124879e-17_rk, 5.1518838176360906e-17_rk, -1.4259153936457214e-17_rk,   &
        -2.5320701064317936e-17_rk, -0.36427344100918363_rk, -1.1392624078344315e-16_rk, -3.623067390814146e-17_rk,   &
        4.209126738781588e-18_rk, 1.1378211825872966e-16_rk, -0.02615365636088423_rk, 4.587204752713725e-18_rk,   &
        -7.960278178224193e-18_rk, -9.129805212692682e-17_rk, 5.434085089079983e-17_rk, -0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,1) = reshape((/ &
        -0.07285468820183674_rk, 3.814495631067888e-18_rk, 2.868183500989653e-22_rk, 2.2553832847358812e-17_rk,   &
        3.814495631067888e-18_rk, -0.07285468820183674_rk, 2.2553832847358812e-17_rk, 2.8681835009838754e-22_rk,   &
        -9.626648437764494e-19_rk, 5.216938623046465e-18_rk, -0.27189739793884354_rk, -1.011843667422636e-17_rk,   &
        5.2169386230464624e-18_rk, -9.626648437764492e-19_rk, -1.011843667422636e-17_rk, -0.27189739793884354_rk,   &
        0.005230731272176848_rk, -2.8507603666363297e-18_rk, 1.7570086703857007e-17_rk, -1.5804474734372563e-17_rk,   &
        -2.850760366636329e-18_rk, 0.005230731272176853_rk, -1.5804474734372566e-17_rk, 1.7570086703857007e-17_rk,   &
        -2.6995291610634758e-18_rk, 6.2012218455299335e-18_rk, 0.019521354868503392_rk, 1.9676465669835287e-17_rk,   &
        6.201221845529935e-18_rk, -2.6995291610634758e-18_rk, 1.9676465669835287e-17_rk, 0.019521354868503392_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,2) = reshape((/ &
        -0.3642734410091837_rk, -1.6243679245874492e-17_rk, 3.531759149296442e-17_rk, 1.0743402374299259e-16_rk,   &
        -1.5276025969917875e-17_rk, -1.3594869896942177_rk, 3.141983360903378e-17_rk, -4.012948162009618e-17_rk,   &
        3.531759149296443e-17_rk, 1.0743402374299259e-16_rk, -0.3642734410091837_rk, -1.6243679245874492e-17_rk,   &
        3.1419833609033773e-17_rk, -4.012948162009618e-17_rk, -1.5276025969917875e-17_rk, -1.3594869896942177_rk,   &
        0.02615365636088423_rk, 9.51130445419496e-17_rk, -2.151641285584622e-17_rk, -8.47355921795964e-17_rk,   &
        -1.0984518025954833e-17_rk, 0.09760677434251697_rk, 3.671932773538326e-17_rk, 9.586920056981388e-17_rk,   &
        -2.151641285584622e-17_rk, -8.473559217959642e-17_rk, 0.02615365636088423_rk, 9.511304454194962e-17_rk,   &
        3.671932773538327e-17_rk, 9.586920056981388e-17_rk, -1.0984518025954839e-17_rk, 0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,3) = reshape((/ &
        0.09760677434251697_rk, -1.6737685176391862e-17_rk, -3.639046847895518e-17_rk, -1.2468282098775258e-16_rk,   &
        -2.4691177159590007e-17_rk, 0.3642734410091837_rk, -2.0709603978727436e-17_rk, 3.080884993390708e-17_rk,   &
        -3.5223071989481396e-17_rk, -7.733774448329258e-18_rk, 0.3642734410091837_rk, 4.134074476379848e-17_rk,   &
        1.193649925581122e-17_rk, 2.050202474216013e-17_rk, 4.2976820759162366e-17_rk, 1.3594869896942177_rk,   &
        -0.026153656360884243_rk, 4.587204752713741e-18_rk, 4.209126738781585e-18_rk, 1.1378211825872966e-16_rk,   &
        5.434085089079982e-17_rk, -0.09760677434251697_rk, -7.96027817822418e-18_rk, -9.129805212692682e-17_rk,   &
        5.1518838176360906e-17_rk, -1.4259153936457186e-17_rk, -0.09760677434251697_rk, -8.84760394124879e-17_rk,   &
        -1.1392624078344315e-16_rk, -3.6230673908141455e-17_rk, -2.5320701064317933e-17_rk, -0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,1) = reshape((/ &
        0.07285468820183674_rk, -3.814495631067888e-18_rk, -2.868183500989653e-22_rk, -2.2553832847358812e-17_rk,   &
        -3.814495631067888e-18_rk, 0.07285468820183674_rk, -2.2553832847358812e-17_rk, -2.8681835009838754e-22_rk,   &
        9.626648437764494e-19_rk, -5.216938623046465e-18_rk, 0.27189739793884354_rk, 1.011843667422636e-17_rk,   &
        -5.2169386230464624e-18_rk, 9.626648437764492e-19_rk, 1.011843667422636e-17_rk, 0.27189739793884354_rk,   &
        -0.005230731272176848_rk, 2.8507603666363297e-18_rk, -1.7570086703857007e-17_rk, 1.5804474734372563e-17_rk,   &
        2.850760366636329e-18_rk, -0.005230731272176853_rk, 1.5804474734372566e-17_rk, -1.7570086703857007e-17_rk,   &
        2.6995291610634758e-18_rk, -6.2012218455299335e-18_rk, -0.019521354868503392_rk, -1.9676465669835287e-17_rk,   &
        -6.201221845529935e-18_rk, 2.6995291610634758e-18_rk, -1.9676465669835287e-17_rk, -0.019521354868503392_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,2) = reshape((/ &
        -1.3594869896942177_rk, -1.5276025969917875e-17_rk, -4.012948162009618e-17_rk, 3.141983360903379e-17_rk,   &
        -1.6243679245874492e-17_rk, -0.3642734410091837_rk, 1.0743402374299259e-16_rk, 3.531759149296442e-17_rk,   &
        -4.012948162009618e-17_rk, 3.141983360903378e-17_rk, -1.3594869896942177_rk, -1.5276025969917875e-17_rk,   &
        1.0743402374299259e-16_rk, 3.531759149296442e-17_rk, -1.6243679245874492e-17_rk, -0.3642734410091837_rk,   &
        0.09760677434251697_rk, -1.0984518025954827e-17_rk, 9.586920056981388e-17_rk, 3.671932773538326e-17_rk,   &
        9.511304454194962e-17_rk, 0.02615365636088423_rk, -8.47355921795964e-17_rk, -2.1516412855846226e-17_rk,   &
        9.586920056981388e-17_rk, 3.671932773538327e-17_rk, 0.09760677434251697_rk, -1.098451802595483e-17_rk,   &
        -8.47355921795964e-17_rk, -2.1516412855846222e-17_rk, 9.51130445419496e-17_rk, 0.02615365636088423_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,3) = reshape((/ &
        0.3642734410091837_rk, -2.4691177159590007e-17_rk, 3.080884993390708e-17_rk, -2.0709603978727445e-17_rk,   &
        -1.6737685176391862e-17_rk, 0.09760677434251697_rk, -1.2468282098775258e-16_rk, -3.639046847895518e-17_rk,   &
        2.0502024742160128e-17_rk, 1.1936499255811214e-17_rk, 1.3594869896942177_rk, 4.2976820759162366e-17_rk,   &
        -7.733774448329258e-18_rk, -3.522307198948139e-17_rk, 4.134074476379848e-17_rk, 0.3642734410091837_rk,   &
        -0.09760677434251697_rk, 5.434085089079983e-17_rk, -9.129805212692682e-17_rk, -7.960278178224168e-18_rk,   &
        4.587204752713731e-18_rk, -0.02615365636088423_rk, 1.1378211825872966e-16_rk, 4.209126738781585e-18_rk,   &
        -3.6230673908141455e-17_rk, -1.1392624078344315e-16_rk, -0.36427344100918363_rk, -2.532070106431793e-17_rk,   &
        -1.425915393645719e-17_rk, 5.1518838176360906e-17_rk, -8.84760394124879e-17_rk, -0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,1) = reshape((/ &
        0.07285468820183674_rk, 6.745076430365807e-18_rk, -3.906874293240703e-18_rk, 6.057483584542858e-18_rk,   &
        6.745076430365807e-18_rk, 0.07285468820183674_rk, 6.057483584542858e-18_rk, -3.906874293240703e-18_rk,   &
        -1.1160368906595233e-18_rk, -6.524652145937188e-18_rk, 0.0195213548685034_rk, -4.471276836128484e-18_rk,   &
        -6.524652145937188e-18_rk, -1.116036890659523e-18_rk, -4.471276836128484e-18_rk, 0.0195213548685034_rk,   &
        -0.07285468820183673_rk, -3.0828824255258822e-18_rk, 3.5810369258041453e-19_rk, -1.9435857098450135e-17_rk,   &
        -3.08288242552588e-18_rk, -0.07285468820183673_rk, -1.943585709845013e-17_rk, 3.5810369258041453e-19_rk,   &
        1.5230162622796188e-19_rk, 5.359893281728531e-18_rk, -0.019521354868503392_rk, 8.934850762066383e-18_rk,   &
        5.359893281728533e-18_rk, 1.5230162622796188e-19_rk, 8.934850762066383e-18_rk, -0.019521354868503395_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,2) = reshape((/ &
        0.3642734410091837_rk, 3.009617629654487e-18_rk, 1.1181393055971025e-17_rk, 2.264672888611756e-17_rk,   &
        8.359380341532116e-18_rk, 0.09760677434251697_rk, -2.4982571693089233e-17_rk, -3.629594897547215e-17_rk,   &
        1.1181393055971022e-17_rk, 2.264672888611756e-17_rk, 0.3642734410091837_rk, 3.0096176296544864e-18_rk,   &
        -2.498257169308923e-17_rk, -3.629594897547215e-17_rk, 8.359380341532116e-18_rk, 0.09760677434251697_rk,   &
        -0.36427344100918363_rk, 1.803563180052707e-17_rk, -3.165952546525439e-17_rk, -8.516719122628405e-17_rk,   &
        1.1224209882175443e-17_rk, -0.09760677434251697_rk, 1.4787372142676052e-17_rk, 3.421155205929627e-17_rk,   &
        -3.165952546525439e-17_rk, -8.516719122628408e-17_rk, -0.36427344100918363_rk, 1.8035631800527066e-17_rk,   &
        1.4787372142676058e-17_rk, 3.421155205929627e-17_rk, 1.1224209882175452e-17_rk, -0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,3) = reshape((/ &
        -1.3594869896942177_rk, -4.2976820759162366e-17_rk, -2.0502024742160128e-17_rk, -1.1936499255811214e-17_rk,   &
        -4.134074476379848e-17_rk, -0.3642734410091837_rk, 7.733774448329249e-18_rk, 3.522307198948139e-17_rk,   &
        -3.080884993390708e-17_rk, 2.0709603978727433e-17_rk, -0.3642734410091837_rk, 2.4691177159590007e-17_rk,   &
        1.2468282098775258e-16_rk, 3.639046847895518e-17_rk, 1.6737685176391862e-17_rk, -0.09760677434251697_rk,   &
        0.36427344100918363_rk, 2.532070106431794e-17_rk, 3.6230673908141455e-17_rk, 1.1392624078344315e-16_rk,   &
        8.84760394124879e-17_rk, 0.09760677434251697_rk, 1.4259153936457195e-17_rk, -5.151883817636091e-17_rk,   &
        9.129805212692682e-17_rk, 7.96027817822419e-18_rk, 0.09760677434251697_rk, -5.434085089079982e-17_rk,   &
        -1.1378211825872966e-16_rk, -4.209126738781587e-18_rk, -4.587204752713729e-18_rk, 0.02615365636088423_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,1) = reshape((/ &
        -0.07285468820183674_rk, -6.745076430365807e-18_rk, 3.906874293240703e-18_rk, -6.057483584542858e-18_rk,   &
        -6.745076430365807e-18_rk, -0.07285468820183674_rk, -6.057483584542858e-18_rk, 3.906874293240703e-18_rk,   &
        1.1160368906595233e-18_rk, 6.524652145937188e-18_rk, -0.0195213548685034_rk, 4.471276836128484e-18_rk,   &
        6.524652145937188e-18_rk, 1.116036890659523e-18_rk, 4.471276836128484e-18_rk, -0.0195213548685034_rk,   &
        0.07285468820183673_rk, 3.0828824255258822e-18_rk, -3.5810369258041453e-19_rk, 1.9435857098450135e-17_rk,   &
        3.08288242552588e-18_rk, 0.07285468820183673_rk, 1.943585709845013e-17_rk, -3.5810369258041453e-19_rk,   &
        -1.5230162622796188e-19_rk, -5.359893281728531e-18_rk, 0.019521354868503392_rk, -8.934850762066383e-18_rk,   &
        -5.359893281728533e-18_rk, -1.5230162622796188e-19_rk, -8.934850762066383e-18_rk, 0.019521354868503395_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,2) = reshape((/ &
        0.09760677434251697_rk, 8.359380341532116e-18_rk, -3.629594897547215e-17_rk, -2.4982571693089212e-17_rk,   &
        3.009617629654487e-18_rk, 0.3642734410091837_rk, 2.2646728886117563e-17_rk, 1.1181393055971028e-17_rk,   &
        -3.629594897547216e-17_rk, -2.498257169308923e-17_rk, 0.09760677434251697_rk, 8.359380341532116e-18_rk,   &
        2.2646728886117566e-17_rk, 1.1181393055971025e-17_rk, 3.0096176296544864e-18_rk, 0.3642734410091837_rk,   &
        -0.09760677434251697_rk, 1.1224209882175461e-17_rk, 3.421155205929627e-17_rk, 1.4787372142676046e-17_rk,   &
        1.8035631800527063e-17_rk, -0.36427344100918363_rk, -8.516719122628405e-17_rk, -3.165952546525439e-17_rk,   &
        3.421155205929627e-17_rk, 1.4787372142676052e-17_rk, -0.09760677434251697_rk, 1.122420988217544e-17_rk,   &
        -8.516719122628407e-17_rk, -3.165952546525439e-17_rk, 1.803563180052706e-17_rk, -0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,3) = reshape((/ &
        -0.3642734410091837_rk, -4.134074476379848e-17_rk, 3.522307198948139e-17_rk, 7.73377444832924e-18_rk,   &
        -4.2976820759162366e-17_rk, -1.3594869896942177_rk, -1.1936499255811217e-17_rk, -2.050202474216013e-17_rk,   &
        3.639046847895519e-17_rk, 1.2468282098775258e-16_rk, -0.09760677434251697_rk, 1.6737685176391862e-17_rk,   &
        2.0709603978727427e-17_rk, -3.080884993390708e-17_rk, 2.4691177159590007e-17_rk, -0.3642734410091837_rk,   &
        0.09760677434251697_rk, 8.84760394124879e-17_rk, -5.1518838176360906e-17_rk, 1.4259153936457214e-17_rk,   &
        2.5320701064317936e-17_rk, 0.36427344100918363_rk, 1.1392624078344315e-16_rk, 3.623067390814146e-17_rk,   &
        -4.209126738781588e-18_rk, -1.1378211825872966e-16_rk, 0.02615365636088423_rk, -4.587204752713725e-18_rk,   &
        7.960278178224193e-18_rk, 9.129805212692682e-17_rk, -5.434085089079983e-17_rk, 0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,1) = reshape((/ &
        -0.0195213548685034_rk, 4.471276836128485e-18_rk, 1.1160368906595233e-18_rk, 6.524652145937188e-18_rk,   &
        4.471276836128485e-18_rk, -0.0195213548685034_rk, 6.524652145937188e-18_rk, 1.116036890659523e-18_rk,   &
        3.906874293240703e-18_rk, -6.057483584542856e-18_rk, -0.07285468820183674_rk, -6.745076430365805e-18_rk,   &
        -6.057483584542858e-18_rk, 3.906874293240703e-18_rk, -6.745076430365805e-18_rk, -0.07285468820183674_rk,   &
        0.0195213548685034_rk, -8.934850762066383e-18_rk, -1.5230162622796342e-19_rk, -5.3598932817285296e-18_rk,   &
        -8.93485076206638e-18_rk, 0.0195213548685034_rk, -5.359893281728532e-18_rk, -1.5230162622796342e-19_rk,   &
        -3.581036925804153e-19_rk, 1.943585709845013e-17_rk, 0.07285468820183673_rk, 3.0828824255258815e-18_rk,   &
        1.9435857098450135e-17_rk, -3.581036925804153e-19_rk, 3.0828824255258815e-18_rk, 0.07285468820183673_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,2) = reshape((/ &
        -0.09760677434251697_rk, -8.359380341532116e-18_rk, 3.629594897547215e-17_rk, 2.4982571693089212e-17_rk,   &
        -3.009617629654487e-18_rk, -0.3642734410091837_rk, -2.2646728886117563e-17_rk, -1.1181393055971028e-17_rk,   &
        3.629594897547216e-17_rk, 2.498257169308923e-17_rk, -0.09760677434251697_rk, -8.359380341532116e-18_rk,   &
        -2.2646728886117566e-17_rk, -1.1181393055971025e-17_rk, -3.0096176296544864e-18_rk, -0.3642734410091837_rk,   &
        0.09760677434251697_rk, -1.1224209882175461e-17_rk, -3.421155205929627e-17_rk, -1.4787372142676046e-17_rk,   &
        -1.8035631800527063e-17_rk, 0.36427344100918363_rk, 8.516719122628405e-17_rk, 3.165952546525439e-17_rk,   &
        -3.421155205929627e-17_rk, -1.4787372142676052e-17_rk, 0.09760677434251697_rk, -1.122420988217544e-17_rk,   &
        8.516719122628407e-17_rk, 3.165952546525439e-17_rk, -1.803563180052706e-17_rk, 0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,3) = reshape((/ &
        -0.09760677434251697_rk, 1.6737685176391862e-17_rk, 3.639046847895518e-17_rk, 1.2468282098775258e-16_rk,   &
        2.4691177159590007e-17_rk, -0.3642734410091837_rk, 2.0709603978727436e-17_rk, -3.080884993390708e-17_rk,   &
        3.5223071989481396e-17_rk, 7.733774448329258e-18_rk, -0.3642734410091837_rk, -4.134074476379848e-17_rk,   &
        -1.193649925581122e-17_rk, -2.050202474216013e-17_rk, -4.2976820759162366e-17_rk, -1.3594869896942177_rk,   &
        0.026153656360884243_rk, -4.587204752713741e-18_rk, -4.209126738781585e-18_rk, -1.1378211825872966e-16_rk,   &
        -5.434085089079982e-17_rk, 0.09760677434251697_rk, 7.96027817822418e-18_rk, 9.129805212692682e-17_rk,   &
        -5.1518838176360906e-17_rk, 1.4259153936457186e-17_rk, 0.09760677434251697_rk, 8.84760394124879e-17_rk,   &
        1.1392624078344315e-16_rk, 3.6230673908141455e-17_rk, 2.5320701064317933e-17_rk, 0.36427344100918363_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,1) = reshape((/ &
        0.0195213548685034_rk, -4.471276836128485e-18_rk, -1.1160368906595233e-18_rk, -6.524652145937188e-18_rk,   &
        -4.471276836128485e-18_rk, 0.0195213548685034_rk, -6.524652145937188e-18_rk, -1.116036890659523e-18_rk,   &
        -3.906874293240703e-18_rk, 6.057483584542856e-18_rk, 0.07285468820183674_rk, 6.745076430365805e-18_rk,   &
        6.057483584542858e-18_rk, -3.906874293240703e-18_rk, 6.745076430365805e-18_rk, 0.07285468820183674_rk,   &
        -0.0195213548685034_rk, 8.934850762066383e-18_rk, 1.5230162622796342e-19_rk, 5.3598932817285296e-18_rk,   &
        8.93485076206638e-18_rk, -0.0195213548685034_rk, 5.359893281728532e-18_rk, 1.5230162622796342e-19_rk,   &
        3.581036925804153e-19_rk, -1.943585709845013e-17_rk, -0.07285468820183673_rk, -3.0828824255258815e-18_rk,   &
        -1.9435857098450135e-17_rk, 3.581036925804153e-19_rk, -3.0828824255258815e-18_rk, -0.07285468820183673_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,2) = reshape((/ &
        -0.3642734410091837_rk, -3.009617629654487e-18_rk, -1.1181393055971025e-17_rk, -2.264672888611756e-17_rk,   &
        -8.359380341532116e-18_rk, -0.09760677434251697_rk, 2.4982571693089233e-17_rk, 3.629594897547215e-17_rk,   &
        -1.1181393055971022e-17_rk, -2.264672888611756e-17_rk, -0.3642734410091837_rk, -3.0096176296544864e-18_rk,   &
        2.498257169308923e-17_rk, 3.629594897547215e-17_rk, -8.359380341532116e-18_rk, -0.09760677434251697_rk,   &
        0.36427344100918363_rk, -1.803563180052707e-17_rk, 3.165952546525439e-17_rk, 8.516719122628405e-17_rk,   &
        -1.1224209882175443e-17_rk, 0.09760677434251697_rk, -1.4787372142676052e-17_rk, -3.421155205929627e-17_rk,   &
        3.165952546525439e-17_rk, 8.516719122628408e-17_rk, 0.36427344100918363_rk, -1.8035631800527066e-17_rk,   &
        -1.4787372142676058e-17_rk, -3.421155205929627e-17_rk, -1.1224209882175452e-17_rk, 0.09760677434251697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,3) = reshape((/ &
        -0.3642734410091837_rk, 2.4691177159590007e-17_rk, -3.080884993390708e-17_rk, 2.0709603978727445e-17_rk,   &
        1.6737685176391862e-17_rk, -0.09760677434251697_rk, 1.2468282098775258e-16_rk, 3.639046847895518e-17_rk,   &
        -2.0502024742160128e-17_rk, -1.1936499255811214e-17_rk, -1.3594869896942177_rk, -4.2976820759162366e-17_rk,   &
        7.733774448329258e-18_rk, 3.522307198948139e-17_rk, -4.134074476379848e-17_rk, -0.3642734410091837_rk,   &
        0.09760677434251697_rk, -5.434085089079983e-17_rk, 9.129805212692682e-17_rk, 7.960278178224168e-18_rk,   &
        -4.587204752713731e-18_rk, 0.02615365636088423_rk, -1.1378211825872966e-16_rk, -4.209126738781585e-18_rk,   &
        3.6230673908141455e-17_rk, 1.1392624078344315e-16_rk, 0.36427344100918363_rk, 2.532070106431793e-17_rk,   &
        1.425915393645719e-17_rk, -5.1518838176360906e-17_rk, 8.84760394124879e-17_rk, 0.09760677434251697_rk   &
        /),(/4,8/))


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face6_dx
        ! 
        test_dbr2_vol_face6_dx(:,:,1,1) = reshape((/ &
        -0.07285468820183674_rk, -5.3362109144565684e-18_rk, -1.4602251147235048e-18_rk, -1.5673007884546612e-17_rk,   &
        -5.336210914456569e-18_rk, -0.07285468820183674_rk, -1.5673007884546612e-17_rk, -1.4602251147235051e-18_rk,   &
        -1.894441194045263e-18_rk, 5.363888145998874e-18_rk, -0.0195213548685034_rk, 7.323107623419927e-18_rk,   &
        5.363888145998872e-18_rk, -1.8944411940452624e-18_rk, 7.323107623419927e-18_rk, -0.019521354868503395_rk,   &
        0.07285468820183674_rk, 7.545882714763578e-18_rk, -6.6628283380439e-18_rk, 6.0910097033156296e-18_rk,   &
        7.54588271476358e-18_rk, 0.07285468820183674_rk, 6.091009703315627e-18_rk, -6.6628283380439e-18_rk,   &
        -1.857207029352244e-18_rk, -4.330959802711553e-18_rk, 0.019521354868503413_rk, -5.836485663414042e-18_rk,   &
        -4.330959802711553e-18_rk, -1.857207029352244e-18_rk, -5.8364856634140425e-18_rk, 0.019521354868503413_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,1,2) = reshape((/ &
        -0.36427344100918363_rk, 8.943987764007463e-18_rk, -4.292616790990783e-17_rk, -6.635294515676644e-17_rk,   &
        9.904957808093243e-19_rk, -0.09760677434251698_rk, 1.4807346464027757e-17_rk, 2.6152836366063988e-17_rk,   &
        -4.2926167909907825e-17_rk, -6.635294515676645e-17_rk, -0.36427344100918363_rk, 8.943987764007466e-18_rk,   &
        1.480734646402777e-17_rk, 2.615283636606399e-17_rk, 9.904957808093213e-19_rk, -0.09760677434251698_rk,   &
        0.3642734410091838_rk, -7.671367564499534e-18_rk, 3.620601304781189e-18_rk, 2.2814359479981426e-17_rk,   &
        1.6218352821247222e-17_rk, 0.097606774342517_rk, -1.401410997696105e-17_rk, -4.622077814176192e-17_rk,   &
        3.620601304781182e-18_rk, 2.2814359479981426e-17_rk, 0.3642734410091838_rk, -7.671367564499536e-18_rk,   &
        -1.4014109976961047e-17_rk, -4.622077814176191e-17_rk, 1.6218352821247222e-17_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,1,3) = reshape((/ &
        -0.36427344100918363_rk, -2.0123946728227993e-17_rk, -3.1033919572051524e-17_rk, -1.0128710653252318e-16_rk,   &
        -6.555397230269775e-17_rk, -0.097606774342517_rk, -1.7632227361967672e-17_rk, 4.824955436913409e-17_rk,   &
        -6.837598501713667e-17_rk, -1.1333351603734643e-17_rk, -0.09760677434251697_rk, 5.1071567083573016e-17_rk,   &
        7.852980183309592e-17_rk, 1.4293750475885074e-17_rk, 1.467182848981722e-17_rk, -0.026153656360884237_rk,   &
        1.359486989694218_rk, 2.5251507985462157e-17_rk, -8.788111204718784e-18_rk, 2.3192437493913574e-17_rk,   &
        4.73121953573539e-17_rk, 0.3642734410091838_rk, 6.722254518144138e-18_rk, -5.623620880000965e-17_rk,   &
        -6.380207135390381e-18_rk, -6.253575012254033e-18_rk, 0.3642734410091838_rk, -4.260552894025628e-17_rk,   &
        -8.055857806046813e-17_rk, -4.743882748049024e-17_rk, -1.6221221004748208e-17_rk, 0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,1) = reshape((/ &
        0.07285468820183674_rk, 5.3362109144565684e-18_rk, 1.4602251147235048e-18_rk, 1.5673007884546612e-17_rk,   &
        5.336210914456569e-18_rk, 0.07285468820183674_rk, 1.5673007884546612e-17_rk, 1.4602251147235051e-18_rk,   &
        1.894441194045263e-18_rk, -5.363888145998874e-18_rk, 0.0195213548685034_rk, -7.323107623419927e-18_rk,   &
        -5.363888145998872e-18_rk, 1.8944411940452624e-18_rk, -7.323107623419927e-18_rk, 0.019521354868503395_rk,   &
        -0.07285468820183674_rk, -7.545882714763578e-18_rk, 6.6628283380439e-18_rk, -6.0910097033156296e-18_rk,   &
        -7.54588271476358e-18_rk, -0.07285468820183674_rk, -6.091009703315627e-18_rk, 6.6628283380439e-18_rk,   &
        1.857207029352244e-18_rk, 4.330959802711553e-18_rk, -0.019521354868503413_rk, 5.836485663414042e-18_rk,   &
        4.330959802711553e-18_rk, 1.857207029352244e-18_rk, 5.8364856634140425e-18_rk, -0.019521354868503413_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,2) = reshape((/ &
        -0.09760677434251698_rk, 9.904957808093243e-19_rk, 2.615283636606399e-17_rk, 1.4807346464027754e-17_rk,   &
        8.943987764007463e-18_rk, -0.36427344100918363_rk, -6.635294515676645e-17_rk, -4.2926167909907825e-17_rk,   &
        2.6152836366063988e-17_rk, 1.4807346464027773e-17_rk, -0.09760677434251697_rk, 9.904957808093151e-19_rk,   &
        -6.635294515676645e-17_rk, -4.2926167909907825e-17_rk, 8.94398776400746e-18_rk, -0.36427344100918363_rk,   &
        0.097606774342517_rk, 1.6218352821247222e-17_rk, -4.622077814176191e-17_rk, -1.4014109976961044e-17_rk,   &
        -7.671367564499536e-18_rk, 0.3642734410091838_rk, 2.2814359479981423e-17_rk, 3.6206013047811856e-18_rk,   &
        -4.622077814176191e-17_rk, -1.4014109976961047e-17_rk, 0.097606774342517_rk, 1.621835282124722e-17_rk,   &
        2.2814359479981423e-17_rk, 3.620601304781181e-18_rk, -7.671367564499536e-18_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,3) = reshape((/ &
        -0.097606774342517_rk, -6.555397230269775e-17_rk, 4.824955436913409e-17_rk, -1.7632227361967666e-17_rk,   &
        -2.0123946728227993e-17_rk, -0.36427344100918363_rk, -1.012871065325232e-16_rk, -3.1033919572051524e-17_rk,   &
        1.4293750475885074e-17_rk, 7.852980183309593e-17_rk, -0.026153656360884237_rk, 1.467182848981722e-17_rk,   &
        -1.1333351603734656e-17_rk, -6.837598501713667e-17_rk, 5.1071567083573016e-17_rk, -0.09760677434251697_rk,   &
        0.3642734410091838_rk, 4.731219535735389e-17_rk, -5.623620880000965e-17_rk, 6.722254518144138e-18_rk,   &
        2.525150798546217e-17_rk, 1.359486989694218_rk, 2.3192437493913574e-17_rk, -8.788111204718783e-18_rk,   &
        -4.743882748049024e-17_rk, -8.055857806046813e-17_rk, 0.097606774342517_rk, -1.6221221004748205e-17_rk,   &
        -6.253575012254036e-18_rk, -6.380207135390381e-18_rk, -4.2605528940256285e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,1) = reshape((/ &
        0.019521354868503402_rk, -7.323107623419929e-18_rk, 1.8944411940452624e-18_rk, -5.3638881459988736e-18_rk,   &
        -7.323107623419927e-18_rk, 0.019521354868503402_rk, -5.363888145998875e-18_rk, 1.8944411940452632e-18_rk,   &
        1.4602251147235055e-18_rk, 1.5673007884546612e-17_rk, 0.07285468820183671_rk, 5.336210914456569e-18_rk,   &
        1.5673007884546612e-17_rk, 1.4602251147235048e-18_rk, 5.336210914456569e-18_rk, 0.07285468820183671_rk,   &
        -0.019521354868503413_rk, 5.836485663414042e-18_rk, 1.857207029352244e-18_rk, 4.3309598027115535e-18_rk,   &
        5.8364856634140425e-18_rk, -0.019521354868503413_rk, 4.330959802711553e-18_rk, 1.857207029352244e-18_rk,   &
        6.6628283380439e-18_rk, -6.091009703315627e-18_rk, -0.07285468820183674_rk, -7.54588271476358e-18_rk,   &
        -6.091009703315629e-18_rk, 6.6628283380439e-18_rk, -7.545882714763581e-18_rk, -0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,2) = reshape((/ &
        0.09760677434251698_rk, -9.904957808093243e-19_rk, -2.615283636606399e-17_rk, -1.4807346464027754e-17_rk,   &
        -8.943987764007463e-18_rk, 0.36427344100918363_rk, 6.635294515676645e-17_rk, 4.2926167909907825e-17_rk,   &
        -2.6152836366063988e-17_rk, -1.4807346464027773e-17_rk, 0.09760677434251697_rk, -9.904957808093151e-19_rk,   &
        6.635294515676645e-17_rk, 4.2926167909907825e-17_rk, -8.94398776400746e-18_rk, 0.36427344100918363_rk,   &
        -0.097606774342517_rk, -1.6218352821247222e-17_rk, 4.622077814176191e-17_rk, 1.4014109976961044e-17_rk,   &
        7.671367564499536e-18_rk, -0.3642734410091838_rk, -2.2814359479981423e-17_rk, -3.6206013047811856e-18_rk,   &
        4.622077814176191e-17_rk, 1.4014109976961047e-17_rk, -0.097606774342517_rk, -1.621835282124722e-17_rk,   &
        -2.2814359479981423e-17_rk, -3.620601304781181e-18_rk, 7.671367564499536e-18_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,3) = reshape((/ &
        -0.02615365636088427_rk, 1.467182848981722e-17_rk, 1.429375047588508e-17_rk, 7.852980183309591e-17_rk,   &
        5.1071567083573016e-17_rk, -0.097606774342517_rk, -1.1333351603734645e-17_rk, -6.837598501713667e-17_rk,   &
        4.824955436913409e-17_rk, -1.763222736196766e-17_rk, -0.097606774342517_rk, -6.555397230269776e-17_rk,   &
        -1.0128710653252319e-16_rk, -3.1033919572051524e-17_rk, -2.0123946728227993e-17_rk, -0.3642734410091837_rk,   &
        0.097606774342517_rk, -1.6221221004748196e-17_rk, -4.7438827480490245e-17_rk, -8.055857806046813e-17_rk,   &
        -4.2605528940256285e-17_rk, 0.3642734410091838_rk, -6.253575012254033e-18_rk, -6.380207135390375e-18_rk,   &
        -5.623620880000963e-17_rk, 6.722254518144141e-18_rk, 0.3642734410091838_rk, 4.731219535735389e-17_rk,   &
        2.3192437493913558e-17_rk, -8.788111204718789e-18_rk, 2.525150798546217e-17_rk, 1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,1) = reshape((/ &
        -0.019521354868503402_rk, 7.323107623419929e-18_rk, -1.8944411940452624e-18_rk, 5.3638881459988736e-18_rk,   &
        7.323107623419927e-18_rk, -0.019521354868503402_rk, 5.363888145998875e-18_rk, -1.8944411940452632e-18_rk,   &
        -1.4602251147235055e-18_rk, -1.5673007884546612e-17_rk, -0.07285468820183671_rk, -5.336210914456569e-18_rk,   &
        -1.5673007884546612e-17_rk, -1.4602251147235048e-18_rk, -5.336210914456569e-18_rk, -0.07285468820183671_rk,   &
        0.019521354868503413_rk, -5.836485663414042e-18_rk, -1.857207029352244e-18_rk, -4.3309598027115535e-18_rk,   &
        -5.8364856634140425e-18_rk, 0.019521354868503413_rk, -4.330959802711553e-18_rk, -1.857207029352244e-18_rk,   &
        -6.6628283380439e-18_rk, 6.091009703315627e-18_rk, 0.07285468820183674_rk, 7.54588271476358e-18_rk,   &
        6.091009703315629e-18_rk, -6.6628283380439e-18_rk, 7.545882714763581e-18_rk, 0.07285468820183674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,2) = reshape((/ &
        0.36427344100918363_rk, -8.943987764007463e-18_rk, 4.292616790990783e-17_rk, 6.635294515676644e-17_rk,   &
        -9.904957808093243e-19_rk, 0.09760677434251698_rk, -1.4807346464027757e-17_rk, -2.6152836366063988e-17_rk,   &
        4.2926167909907825e-17_rk, 6.635294515676645e-17_rk, 0.36427344100918363_rk, -8.943987764007466e-18_rk,   &
        -1.480734646402777e-17_rk, -2.615283636606399e-17_rk, -9.904957808093213e-19_rk, 0.09760677434251698_rk,   &
        -0.3642734410091838_rk, 7.671367564499534e-18_rk, -3.620601304781189e-18_rk, -2.2814359479981426e-17_rk,   &
        -1.6218352821247222e-17_rk, -0.097606774342517_rk, 1.401410997696105e-17_rk, 4.622077814176192e-17_rk,   &
        -3.620601304781182e-18_rk, -2.2814359479981426e-17_rk, -0.3642734410091838_rk, 7.671367564499536e-18_rk,   &
        1.4014109976961047e-17_rk, 4.622077814176191e-17_rk, -1.6218352821247222e-17_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,3) = reshape((/ &
        -0.097606774342517_rk, 5.1071567083573016e-17_rk, -6.837598501713667e-17_rk, -1.1333351603734637e-17_rk,   &
        1.467182848981722e-17_rk, -0.026153656360884264_rk, 7.852980183309592e-17_rk, 1.429375047588508e-17_rk,   &
        -3.1033919572051524e-17_rk, -1.012871065325232e-16_rk, -0.3642734410091837_rk, -2.0123946728227993e-17_rk,   &
        -1.7632227361967648e-17_rk, 4.824955436913409e-17_rk, -6.555397230269775e-17_rk, -0.097606774342517_rk,   &
        0.3642734410091838_rk, -4.260552894025627e-17_rk, -6.3802071353903735e-18_rk, -6.253575012254033e-18_rk,   &
        -1.6221221004748208e-17_rk, 0.097606774342517_rk, -8.055857806046813e-17_rk, -4.7438827480490245e-17_rk,   &
        -8.788111204718789e-18_rk, 2.3192437493913565e-17_rk, 1.359486989694218_rk, 2.5251507985462163e-17_rk,   &
        6.722254518144141e-18_rk, -5.623620880000963e-17_rk, 4.73121953573539e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,1) = reshape((/ &
        -0.01952135486850341_rk, -1.1799372891728583e-17_rk, 4.903352074140021e-18_rk, -8.11085889435156e-18_rk,   &
        -1.1799372891728582e-17_rk, -0.01952135486850341_rk, -8.110858894351562e-18_rk, 4.903352074140021e-18_rk,   &
        -8.92200571420506e-18_rk, 8.075401899873381e-18_rk, -0.005230731272176853_rk, 5.825571491258124e-18_rk,   &
        8.075401899873381e-18_rk, -8.922005714205057e-18_rk, 5.825571491258124e-18_rk, -0.005230731272176849_rk,   &
        0.27189739793884354_rk, 6.966857953799632e-18_rk, -6.342035662901784e-18_rk, -1.0807130090408681e-19_rk,   &
        6.966857953799634e-18_rk, 0.27189739793884354_rk, -1.0807130090408787e-19_rk, -6.342035662901784e-18_rk,   &
        -8.90659989382388e-18_rk, -1.3031470811832881e-17_rk, 0.07285468820183676_rk, -5.928864325586854e-18_rk,   &
        -1.3031470811832881e-17_rk, -8.90659989382388e-18_rk, -5.928864325586855e-18_rk, 0.07285468820183676_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,2) = reshape((/ &
        -0.09760677434251704_rk, 2.2003632591337563e-17_rk, -5.648373667928036e-17_rk, -4.6267512979491385e-17_rk,   &
        -5.187263959368986e-17_rk, -0.026153656360884264_rk, 4.6090228007100494e-17_rk, 3.6390468478955177e-17_rk,   &
        -5.648373667928036e-17_rk, -4.626751297949139e-17_rk, -0.09760677434251702_rk, 2.200363259133756e-17_rk,   &
        4.6090228007100506e-17_rk, 3.6390468478955177e-17_rk, -5.187263959368986e-17_rk, -0.026153656360884264_rk,   &
        1.359486989694218_rk, -9.682653390294581e-18_rk, -1.8788919644890347e-17_rk, -5.8754969983218895e-18_rk,   &
        1.4872621531358472e-17_rk, 0.3642734410091838_rk, -5.982221356536294e-17_rk, -5.745425813873797e-17_rk,   &
        -1.8788919644890353e-17_rk, -5.875496998321894e-18_rk, 1.359486989694218_rk, -9.68265339029458e-18_rk,   &
        -5.982221356536294e-17_rk, -5.745425813873796e-17_rk, 1.4872621531358472e-17_rk, 0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,3) = reshape((/ &
        0.36427344100918363_rk, 2.0123946728227993e-17_rk, 3.1033919572051524e-17_rk, 1.0128710653252318e-16_rk,   &
        6.555397230269775e-17_rk, 0.097606774342517_rk, 1.7632227361967672e-17_rk, -4.824955436913409e-17_rk,   &
        6.837598501713667e-17_rk, 1.1333351603734643e-17_rk, 0.09760677434251697_rk, -5.1071567083573016e-17_rk,   &
        -7.852980183309592e-17_rk, -1.4293750475885074e-17_rk, -1.467182848981722e-17_rk, 0.026153656360884237_rk,   &
        -1.359486989694218_rk, -2.5251507985462157e-17_rk, 8.788111204718784e-18_rk, -2.3192437493913574e-17_rk,   &
        -4.73121953573539e-17_rk, -0.3642734410091838_rk, -6.722254518144138e-18_rk, 5.623620880000965e-17_rk,   &
        6.380207135390381e-18_rk, 6.253575012254033e-18_rk, -0.3642734410091838_rk, 4.260552894025628e-17_rk,   &
        8.055857806046813e-17_rk, 4.743882748049024e-17_rk, 1.6221221004748208e-17_rk, -0.097606774342517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,1) = reshape((/ &
        0.01952135486850341_rk, 1.1799372891728583e-17_rk, -4.903352074140021e-18_rk, 8.11085889435156e-18_rk,   &
        1.1799372891728582e-17_rk, 0.01952135486850341_rk, 8.110858894351562e-18_rk, -4.903352074140021e-18_rk,   &
        8.92200571420506e-18_rk, -8.075401899873381e-18_rk, 0.005230731272176853_rk, -5.825571491258124e-18_rk,   &
        -8.075401899873381e-18_rk, 8.922005714205057e-18_rk, -5.825571491258124e-18_rk, 0.005230731272176849_rk,   &
        -0.27189739793884354_rk, -6.966857953799632e-18_rk, 6.342035662901784e-18_rk, 1.0807130090408681e-19_rk,   &
        -6.966857953799634e-18_rk, -0.27189739793884354_rk, 1.0807130090408787e-19_rk, 6.342035662901784e-18_rk,   &
        8.90659989382388e-18_rk, 1.3031470811832881e-17_rk, -0.07285468820183676_rk, 5.928864325586854e-18_rk,   &
        1.3031470811832881e-17_rk, 8.90659989382388e-18_rk, 5.928864325586855e-18_rk, -0.07285468820183676_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,2) = reshape((/ &
        -0.026153656360884278_rk, -5.187263959368986e-17_rk, 3.639046847895517e-17_rk, 4.60902280071005e-17_rk,   &
        2.2003632591337563e-17_rk, -0.09760677434251704_rk, -4.626751297949139e-17_rk, -5.648373667928036e-17_rk,   &
        3.6390468478955177e-17_rk, 4.6090228007100506e-17_rk, -0.02615365636088427_rk, -5.1872639593689855e-17_rk,   &
        -4.626751297949139e-17_rk, -5.648373667928036e-17_rk, 2.2003632591337566e-17_rk, -0.09760677434251704_rk,   &
        0.3642734410091838_rk, 1.4872621531358472e-17_rk, -5.745425813873797e-17_rk, -5.982221356536294e-17_rk,   &
        -9.682653390294583e-18_rk, 1.359486989694218_rk, -5.875496998321887e-18_rk, -1.878891964489034e-17_rk,   &
        -5.745425813873796e-17_rk, -5.982221356536294e-17_rk, 0.3642734410091838_rk, 1.487262153135847e-17_rk,   &
        -5.875496998321898e-18_rk, -1.8788919644890353e-17_rk, -9.682653390294583e-18_rk, 1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,3) = reshape((/ &
        0.097606774342517_rk, 6.555397230269775e-17_rk, -4.824955436913409e-17_rk, 1.7632227361967666e-17_rk,   &
        2.0123946728227993e-17_rk, 0.36427344100918363_rk, 1.012871065325232e-16_rk, 3.1033919572051524e-17_rk,   &
        -1.4293750475885074e-17_rk, -7.852980183309593e-17_rk, 0.026153656360884237_rk, -1.467182848981722e-17_rk,   &
        1.1333351603734656e-17_rk, 6.837598501713667e-17_rk, -5.1071567083573016e-17_rk, 0.09760677434251697_rk,   &
        -0.3642734410091838_rk, -4.731219535735389e-17_rk, 5.623620880000965e-17_rk, -6.722254518144138e-18_rk,   &
        -2.525150798546217e-17_rk, -1.359486989694218_rk, -2.3192437493913574e-17_rk, 8.788111204718783e-18_rk,   &
        4.743882748049024e-17_rk, 8.055857806046813e-17_rk, -0.097606774342517_rk, 1.6221221004748205e-17_rk,   &
        6.253575012254036e-18_rk, 6.380207135390381e-18_rk, 4.2605528940256285e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,1) = reshape((/ &
        0.005230731272176849_rk, -5.825571491258123e-18_rk, 8.922005714205058e-18_rk, -8.075401899873383e-18_rk,   &
        -5.825571491258124e-18_rk, 0.005230731272176849_rk, -8.075401899873381e-18_rk, 8.922005714205058e-18_rk,   &
        -4.903352074140021e-18_rk, 8.110858894351562e-18_rk, 0.019521354868503413_rk, 1.1799372891728582e-17_rk,   &
        8.110858894351559e-18_rk, -4.903352074140019e-18_rk, 1.1799372891728582e-17_rk, 0.019521354868503413_rk,   &
        -0.07285468820183676_rk, 5.928864325586854e-18_rk, 8.90659989382388e-18_rk, 1.3031470811832881e-17_rk,   &
        5.928864325586855e-18_rk, -0.07285468820183676_rk, 1.3031470811832881e-17_rk, 8.90659989382388e-18_rk,   &
        6.342035662901784e-18_rk, 1.0807130090408777e-19_rk, -0.27189739793884354_rk, -6.96685795379963e-18_rk,   &
        1.0807130090408661e-19_rk, 6.342035662901784e-18_rk, -6.966857953799632e-18_rk, -0.27189739793884354_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,2) = reshape((/ &
        0.026153656360884278_rk, 5.187263959368986e-17_rk, -3.639046847895517e-17_rk, -4.60902280071005e-17_rk,   &
        -2.2003632591337563e-17_rk, 0.09760677434251704_rk, 4.626751297949139e-17_rk, 5.648373667928036e-17_rk,   &
        -3.6390468478955177e-17_rk, -4.6090228007100506e-17_rk, 0.02615365636088427_rk, 5.1872639593689855e-17_rk,   &
        4.626751297949139e-17_rk, 5.648373667928036e-17_rk, -2.2003632591337566e-17_rk, 0.09760677434251704_rk,   &
        -0.3642734410091838_rk, -1.4872621531358472e-17_rk, 5.745425813873797e-17_rk, 5.982221356536294e-17_rk,   &
        9.682653390294583e-18_rk, -1.359486989694218_rk, 5.875496998321887e-18_rk, 1.878891964489034e-17_rk,   &
        5.745425813873796e-17_rk, 5.982221356536294e-17_rk, -0.3642734410091838_rk, -1.487262153135847e-17_rk,   &
        5.875496998321898e-18_rk, 1.8788919644890353e-17_rk, 9.682653390294583e-18_rk, -1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,3) = reshape((/ &
        0.02615365636088427_rk, -1.467182848981722e-17_rk, -1.429375047588508e-17_rk, -7.852980183309591e-17_rk,   &
        -5.1071567083573016e-17_rk, 0.097606774342517_rk, 1.1333351603734645e-17_rk, 6.837598501713667e-17_rk,   &
        -4.824955436913409e-17_rk, 1.763222736196766e-17_rk, 0.097606774342517_rk, 6.555397230269776e-17_rk,   &
        1.0128710653252319e-16_rk, 3.1033919572051524e-17_rk, 2.0123946728227993e-17_rk, 0.3642734410091837_rk,   &
        -0.097606774342517_rk, 1.6221221004748196e-17_rk, 4.7438827480490245e-17_rk, 8.055857806046813e-17_rk,   &
        4.2605528940256285e-17_rk, -0.3642734410091838_rk, 6.253575012254033e-18_rk, 6.380207135390375e-18_rk,   &
        5.623620880000963e-17_rk, -6.722254518144141e-18_rk, -0.3642734410091838_rk, -4.731219535735389e-17_rk,   &
        -2.3192437493913558e-17_rk, 8.788111204718789e-18_rk, -2.525150798546217e-17_rk, -1.359486989694218_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,1) = reshape((/ &
        -0.005230731272176849_rk, 5.825571491258123e-18_rk, -8.922005714205058e-18_rk, 8.075401899873383e-18_rk,   &
        5.825571491258124e-18_rk, -0.005230731272176849_rk, 8.075401899873381e-18_rk, -8.922005714205058e-18_rk,   &
        4.903352074140021e-18_rk, -8.110858894351562e-18_rk, -0.019521354868503413_rk, -1.1799372891728582e-17_rk,   &
        -8.110858894351559e-18_rk, 4.903352074140019e-18_rk, -1.1799372891728582e-17_rk, -0.019521354868503413_rk,   &
        0.07285468820183676_rk, -5.928864325586854e-18_rk, -8.90659989382388e-18_rk, -1.3031470811832881e-17_rk,   &
        -5.928864325586855e-18_rk, 0.07285468820183676_rk, -1.3031470811832881e-17_rk, -8.90659989382388e-18_rk,   &
        -6.342035662901784e-18_rk, -1.0807130090408777e-19_rk, 0.27189739793884354_rk, 6.96685795379963e-18_rk,   &
        -1.0807130090408661e-19_rk, -6.342035662901784e-18_rk, 6.966857953799632e-18_rk, 0.27189739793884354_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,2) = reshape((/ &
        0.09760677434251704_rk, -2.2003632591337563e-17_rk, 5.648373667928036e-17_rk, 4.6267512979491385e-17_rk,   &
        5.187263959368986e-17_rk, 0.026153656360884264_rk, -4.6090228007100494e-17_rk, -3.6390468478955177e-17_rk,   &
        5.648373667928036e-17_rk, 4.626751297949139e-17_rk, 0.09760677434251702_rk, -2.200363259133756e-17_rk,   &
        -4.6090228007100506e-17_rk, -3.6390468478955177e-17_rk, 5.187263959368986e-17_rk, 0.026153656360884264_rk,   &
        -1.359486989694218_rk, 9.682653390294581e-18_rk, 1.8788919644890347e-17_rk, 5.8754969983218895e-18_rk,   &
        -1.4872621531358472e-17_rk, -0.3642734410091838_rk, 5.982221356536294e-17_rk, 5.745425813873797e-17_rk,   &
        1.8788919644890353e-17_rk, 5.875496998321894e-18_rk, -1.359486989694218_rk, 9.68265339029458e-18_rk,   &
        5.982221356536294e-17_rk, 5.745425813873796e-17_rk, -1.4872621531358472e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,3) = reshape((/ &
        0.097606774342517_rk, -5.1071567083573016e-17_rk, 6.837598501713667e-17_rk, 1.1333351603734637e-17_rk,   &
        -1.467182848981722e-17_rk, 0.026153656360884264_rk, -7.852980183309592e-17_rk, -1.429375047588508e-17_rk,   &
        3.1033919572051524e-17_rk, 1.012871065325232e-16_rk, 0.3642734410091837_rk, 2.0123946728227993e-17_rk,   &
        1.7632227361967648e-17_rk, -4.824955436913409e-17_rk, 6.555397230269775e-17_rk, 0.097606774342517_rk,   &
        -0.3642734410091838_rk, 4.260552894025627e-17_rk, 6.3802071353903735e-18_rk, 6.253575012254033e-18_rk,   &
        1.6221221004748208e-17_rk, -0.097606774342517_rk, 8.055857806046813e-17_rk, 4.7438827480490245e-17_rk,   &
        8.788111204718789e-18_rk, -2.3192437493913565e-17_rk, -1.359486989694218_rk, -2.5251507985462163e-17_rk,   &
        -6.722254518144141e-18_rk, 5.623620880000963e-17_rk, -4.73121953573539e-17_rk, -0.3642734410091838_rk   &
        /),(/4,8/))


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do


    end subroutine testElement_dbr2_vol_dx
    !*******************************************************************************************





    !> Test cartesian dbr2_face_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_face_dx(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       

        !
        ! dbr2_face_face1_dx
        ! 
        test_dbr2_face_face1_dx(:,:,1,1) = reshape((/ &
        0.39808541947401366_rk, 1.3993065234954218e-17_rk, 1.3472893017390311e-17_rk, -7.336771941069482e-19_rk,   &
        1.6627396181432277e-17_rk, 0.10666666666666669_rk, -2.714151379139643e-18_rk, 7.073075231743597e-18_rk,   &
        1.2462576620719839e-17_rk, -2.380303690531384e-18_rk, 0.10666666666666669_rk, 7.231722529156943e-18_rk,   &
        -1.8045818630492222e-17_rk, 2.3883140117031216e-19_rk, 1.4266989959507327e-18_rk, 0.028581247192653085_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,1,2) = reshape((/ &
        1.8928203230275509_rk, 8.195888021113647e-17_rk, 5.173033542445328e-17_rk, -1.655648219247592e-17_rk,   &
        8.195888021113647e-17_rk, 1.892820323027551_rk, -1.655648219247592e-17_rk, 5.173033542445328e-17_rk,   &
        3.3117266660203315e-17_rk, -8.068626001162854e-17_rk, 0.507179676972449_rk, 3.287078860895667e-17_rk,   &
        -8.068626001162854e-17_rk, 3.3117266660203315e-17_rk, 3.287078860895667e-17_rk, 0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,1,3) = reshape((/ &
        1.8928203230275509_rk, 5.750596081601659e-17_rk, 6.038541257473608e-17_rk, -1.5239995338739495e-17_rk,   &
        5.732370800407656e-17_rk, 0.5071796769724494_rk, -8.200274686536498e-17_rk, 2.446218950992051e-17_rk,   &
        6.038541257473608e-17_rk, -1.5239995338739495e-17_rk, 1.8928203230275509_rk, 5.750596081601659e-17_rk,   &
        -8.200274686536498e-17_rk, 2.446218950992051e-17_rk, 5.732370800407656e-17_rk, 0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,1) = reshape((/ &
        -0.39808541947401366_rk, -1.3993065234954218e-17_rk, -1.3472893017390311e-17_rk, 7.336771941069482e-19_rk,   &
        -1.6627396181432277e-17_rk, -0.10666666666666669_rk, 2.714151379139643e-18_rk, -7.073075231743597e-18_rk,   &
        -1.2462576620719839e-17_rk, 2.380303690531384e-18_rk, -0.10666666666666669_rk, -7.231722529156943e-18_rk,   &
        1.8045818630492222e-17_rk, -2.3883140117031216e-19_rk, -1.4266989959507327e-18_rk, -0.028581247192653085_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,2) = reshape((/ &
        0.6309401076758503_rk, 7.1143426870796e-17_rk, 5.099950582121627e-17_rk, -6.8266067375702235e-19_rk,   &
        7.114342687079598e-17_rk, 0.6309401076758503_rk, -6.826606737570285e-19_rk, 5.099950582121627e-17_rk,   &
        3.0389773449247436e-17_rk, -2.144435159348948e-17_rk, 0.1690598923241498_rk, 1.0421319016581708e-17_rk,   &
        -2.144435159348948e-17_rk, 3.0389773449247436e-17_rk, 1.0421319016581696e-17_rk, 0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,3) = reshape((/ &
        0.6309401076758504_rk, 4.8617978004539216e-17_rk, 6.929193561581467e-17_rk, -3.299090844521547e-19_rk,   &
        3.294676788283847e-17_rk, 0.16905989232414972_rk, -2.1797103182794352e-17_rk, 1.209734365464903e-17_rk,   &
        6.929193561581467e-17_rk, -3.2990908445216086e-19_rk, 0.6309401076758503_rk, 4.8617978004539216e-17_rk,   &
        -2.1797103182794343e-17_rk, 1.2097343654649032e-17_rk, 3.294676788283847e-17_rk, 0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,1) = reshape((/ &
        -0.10666666666666669_rk, -1.6627396181432277e-17_rk, -7.073075231743597e-18_rk, 2.7141513791396414e-18_rk,   &
        -1.3993065234954218e-17_rk, -0.39808541947401366_rk, 7.336771941069497e-19_rk, -1.3472893017390311e-17_rk,   &
        -2.3883140117030927e-19_rk, 1.8045818630492222e-17_rk, -0.028581247192653113_rk, -1.4266989959507338e-18_rk,   &
        2.380303690531385e-18_rk, -1.2462576620719842e-17_rk, -7.231722529156942e-18_rk, -0.10666666666666663_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,2) = reshape((/ &
        -0.6309401076758503_rk, -7.1143426870796e-17_rk, -5.099950582121627e-17_rk, 6.8266067375702235e-19_rk,   &
        -7.114342687079598e-17_rk, -0.6309401076758503_rk, 6.826606737570285e-19_rk, -5.099950582121627e-17_rk,   &
        -3.0389773449247436e-17_rk, 2.144435159348948e-17_rk, -0.1690598923241498_rk, -1.0421319016581708e-17_rk,   &
        2.144435159348948e-17_rk, -3.0389773449247436e-17_rk, -1.0421319016581696e-17_rk, -0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,3) = reshape((/ &
        0.16905989232414984_rk, 3.294676788283848e-17_rk, 1.2097343654649034e-17_rk, -2.179710318279434e-17_rk,   &
        4.8617978004539204e-17_rk, 0.6309401076758504_rk, -3.299090844521578e-19_rk, 6.929193561581469e-17_rk,   &
        1.2097343654649029e-17_rk, -2.1797103182794346e-17_rk, 0.1690598923241498_rk, 3.294676788283848e-17_rk,   &
        -3.299090844521624e-19_rk, 6.929193561581466e-17_rk, 4.8617978004539204e-17_rk, 0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,1) = reshape((/ &
        0.10666666666666669_rk, 1.6627396181432277e-17_rk, 7.073075231743597e-18_rk, -2.7141513791396414e-18_rk,   &
        1.3993065234954218e-17_rk, 0.39808541947401366_rk, -7.336771941069497e-19_rk, 1.3472893017390311e-17_rk,   &
        2.3883140117030927e-19_rk, -1.8045818630492222e-17_rk, 0.028581247192653113_rk, 1.4266989959507338e-18_rk,   &
        -2.380303690531385e-18_rk, 1.2462576620719842e-17_rk, 7.231722529156942e-18_rk, 0.10666666666666663_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,2) = reshape((/ &
        -1.8928203230275509_rk, -8.195888021113647e-17_rk, -5.173033542445328e-17_rk, 1.655648219247592e-17_rk,   &
        -8.195888021113647e-17_rk, -1.892820323027551_rk, 1.655648219247592e-17_rk, -5.173033542445328e-17_rk,   &
        -3.3117266660203315e-17_rk, 8.068626001162854e-17_rk, -0.507179676972449_rk, -3.287078860895667e-17_rk,   &
        8.068626001162854e-17_rk, -3.3117266660203315e-17_rk, -3.287078860895667e-17_rk, -0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,3) = reshape((/ &
        0.5071796769724491_rk, 5.732370800407656e-17_rk, 2.4462189509920515e-17_rk, -8.200274686536498e-17_rk,   &
        5.750596081601659e-17_rk, 1.892820323027551_rk, -1.5239995338739492e-17_rk, 6.038541257473608e-17_rk,   &
        2.4462189509920506e-17_rk, -8.200274686536498e-17_rk, 0.507179676972449_rk, 5.732370800407656e-17_rk,   &
        -1.5239995338739495e-17_rk, 6.038541257473608e-17_rk, 5.750596081601659e-17_rk, 1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,1) = reshape((/ &
        0.10666666666666669_rk, 7.23172252915694e-18_rk, 1.2462576620719839e-17_rk, -2.3803036905313864e-18_rk,   &
        1.4266989959507315e-18_rk, 0.028581247192653113_rk, -1.804581863049222e-17_rk, 2.388314011703106e-19_rk,   &
        1.3472893017390311e-17_rk, -7.336771941069474e-19_rk, 0.39808541947401366_rk, 1.3993065234954218e-17_rk,   &
        -2.714151379139642e-18_rk, 7.073075231743598e-18_rk, 1.6627396181432277e-17_rk, 0.10666666666666666_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,2) = reshape((/ &
        0.507179676972449_rk, 3.287078860895667e-17_rk, 3.311726666020332e-17_rk, -8.068626001162854e-17_rk,   &
        3.287078860895667e-17_rk, 0.5071796769724493_rk, -8.068626001162854e-17_rk, 3.311726666020332e-17_rk,   &
        5.173033542445327e-17_rk, -1.6556482192475916e-17_rk, 1.8928203230275509_rk, 8.195888021113647e-17_rk,   &
        -1.6556482192475916e-17_rk, 5.173033542445327e-17_rk, 8.195888021113647e-17_rk, 1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,3) = reshape((/ &
        -1.8928203230275509_rk, -5.750596081601659e-17_rk, -6.038541257473608e-17_rk, 1.5239995338739495e-17_rk,   &
        -5.732370800407656e-17_rk, -0.5071796769724494_rk, 8.200274686536498e-17_rk, -2.446218950992051e-17_rk,   &
        -6.038541257473608e-17_rk, 1.5239995338739495e-17_rk, -1.8928203230275509_rk, -5.750596081601659e-17_rk,   &
        8.200274686536498e-17_rk, -2.446218950992051e-17_rk, -5.732370800407656e-17_rk, -0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,1) = reshape((/ &
        -0.10666666666666669_rk, -7.23172252915694e-18_rk, -1.2462576620719839e-17_rk, 2.3803036905313864e-18_rk,   &
        -1.4266989959507315e-18_rk, -0.028581247192653113_rk, 1.804581863049222e-17_rk, -2.388314011703106e-19_rk,   &
        -1.3472893017390311e-17_rk, 7.336771941069474e-19_rk, -0.39808541947401366_rk, -1.3993065234954218e-17_rk,   &
        2.714151379139642e-18_rk, -7.073075231743598e-18_rk, -1.6627396181432277e-17_rk, -0.10666666666666666_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,2) = reshape((/ &
        0.1690598923241498_rk, 1.0421319016581705e-17_rk, 3.038977344924744e-17_rk, -2.1444351593489472e-17_rk,   &
        1.0421319016581693e-17_rk, 0.1690598923241498_rk, -2.144435159348948e-17_rk, 3.038977344924744e-17_rk,   &
        5.099950582121626e-17_rk, -6.826606737570239e-19_rk, 0.6309401076758503_rk, 7.1143426870796e-17_rk,   &
        -6.826606737570239e-19_rk, 5.099950582121626e-17_rk, 7.114342687079598e-17_rk, 0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,3) = reshape((/ &
        -0.6309401076758504_rk, -4.8617978004539216e-17_rk, -6.929193561581467e-17_rk, 3.299090844521547e-19_rk,   &
        -3.294676788283847e-17_rk, -0.16905989232414972_rk, 2.1797103182794352e-17_rk, -1.209734365464903e-17_rk,   &
        -6.929193561581467e-17_rk, 3.2990908445216086e-19_rk, -0.6309401076758503_rk, -4.8617978004539216e-17_rk,   &
        2.1797103182794343e-17_rk, -1.2097343654649032e-17_rk, -3.294676788283847e-17_rk, -0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,1) = reshape((/ &
        -0.028581247192653113_rk, -1.4266989959507311e-18_rk, -2.3883140117031004e-19_rk, 1.8045818630492222e-17_rk,   &
        -7.23172252915694e-18_rk, -0.10666666666666669_rk, 2.380303690531385e-18_rk, -1.2462576620719839e-17_rk,   &
        -7.073075231743595e-18_rk, 2.714151379139642e-18_rk, -0.10666666666666669_rk, -1.6627396181432277e-17_rk,   &
        7.336771941069482e-19_rk, -1.3472893017390311e-17_rk, -1.3993065234954218e-17_rk, -0.3980854194740136_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,2) = reshape((/ &
        -0.1690598923241498_rk, -1.0421319016581705e-17_rk, -3.038977344924744e-17_rk, 2.1444351593489472e-17_rk,   &
        -1.0421319016581693e-17_rk, -0.1690598923241498_rk, 2.144435159348948e-17_rk, -3.038977344924744e-17_rk,   &
        -5.099950582121626e-17_rk, 6.826606737570239e-19_rk, -0.6309401076758503_rk, -7.1143426870796e-17_rk,   &
        6.826606737570239e-19_rk, -5.099950582121626e-17_rk, -7.114342687079598e-17_rk, -0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,3) = reshape((/ &
        -0.16905989232414984_rk, -3.294676788283848e-17_rk, -1.2097343654649034e-17_rk, 2.179710318279434e-17_rk,   &
        -4.8617978004539204e-17_rk, -0.6309401076758504_rk, 3.299090844521578e-19_rk, -6.929193561581469e-17_rk,   &
        -1.2097343654649029e-17_rk, 2.1797103182794346e-17_rk, -0.1690598923241498_rk, -3.294676788283848e-17_rk,   &
        3.299090844521624e-19_rk, -6.929193561581466e-17_rk, -4.8617978004539204e-17_rk, -0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,1) = reshape((/ &
        0.028581247192653113_rk, 1.4266989959507311e-18_rk, 2.3883140117031004e-19_rk, -1.8045818630492222e-17_rk,   &
        7.23172252915694e-18_rk, 0.10666666666666669_rk, -2.380303690531385e-18_rk, 1.2462576620719839e-17_rk,   &
        7.073075231743595e-18_rk, -2.714151379139642e-18_rk, 0.10666666666666669_rk, 1.6627396181432277e-17_rk,   &
        -7.336771941069482e-19_rk, 1.3472893017390311e-17_rk, 1.3993065234954218e-17_rk, 0.3980854194740136_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,2) = reshape((/ &
        -0.507179676972449_rk, -3.287078860895667e-17_rk, -3.311726666020332e-17_rk, 8.068626001162854e-17_rk,   &
        -3.287078860895667e-17_rk, -0.5071796769724493_rk, 8.068626001162854e-17_rk, -3.311726666020332e-17_rk,   &
        -5.173033542445327e-17_rk, 1.6556482192475916e-17_rk, -1.8928203230275509_rk, -8.195888021113647e-17_rk,   &
        1.6556482192475916e-17_rk, -5.173033542445327e-17_rk, -8.195888021113647e-17_rk, -1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,3) = reshape((/ &
        -0.5071796769724491_rk, -5.732370800407656e-17_rk, -2.4462189509920515e-17_rk, 8.200274686536498e-17_rk,   &
        -5.750596081601659e-17_rk, -1.892820323027551_rk, 1.5239995338739492e-17_rk, -6.038541257473608e-17_rk,   &
        -2.4462189509920506e-17_rk, 8.200274686536498e-17_rk, -0.507179676972449_rk, -5.732370800407656e-17_rk,   &
        1.5239995338739495e-17_rk, -6.038541257473608e-17_rk, -5.750596081601659e-17_rk, -1.8928203230275509_rk   &
        /),(/4,4/))


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face2_dx
        ! 
        test_dbr2_face_face2_dx(:,:,1,1) = reshape((/ &
        0.3980854194740136_rk, 1.3993065234954218e-17_rk, 1.3472893017390311e-17_rk, -7.336771941069482e-19_rk,   &
        1.6627396181432277e-17_rk, 0.10666666666666666_rk, -2.714151379139643e-18_rk, 7.073075231743598e-18_rk,   &
        1.2462576620719839e-17_rk, -2.380303690531384e-18_rk, 0.10666666666666663_rk, 7.231722529156942e-18_rk,   &
        -1.804581863049222e-17_rk, 2.388314011703116e-19_rk, 1.426698995950733e-18_rk, 0.028581247192653085_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,1,2) = reshape((/ &
        0.6309401076758503_rk, 7.1143426870796e-17_rk, 5.099950582121627e-17_rk, -6.8266067375702235e-19_rk,   &
        7.114342687079598e-17_rk, 0.6309401076758503_rk, -6.826606737570285e-19_rk, 5.099950582121627e-17_rk,   &
        3.038977344924744e-17_rk, -2.144435159348948e-17_rk, 0.1690598923241498_rk, 1.0421319016581705e-17_rk,   &
        -2.144435159348948e-17_rk, 3.0389773449247436e-17_rk, 1.0421319016581705e-17_rk, 0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,1,3) = reshape((/ &
        0.6309401076758503_rk, 4.8617978004539216e-17_rk, 6.929193561581467e-17_rk, -3.299090844521547e-19_rk,   &
        3.294676788283847e-17_rk, 0.1690598923241498_rk, -2.1797103182794346e-17_rk, 1.2097343654649032e-17_rk,   &
        6.929193561581467e-17_rk, -3.2990908445216395e-19_rk, 0.6309401076758503_rk, 4.8617978004539216e-17_rk,   &
        -2.1797103182794337e-17_rk, 1.2097343654649026e-17_rk, 3.294676788283848e-17_rk, 0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,1) = reshape((/ &
        -0.3980854194740136_rk, -1.3993065234954218e-17_rk, -1.3472893017390311e-17_rk, 7.336771941069482e-19_rk,   &
        -1.6627396181432277e-17_rk, -0.10666666666666666_rk, 2.714151379139643e-18_rk, -7.073075231743598e-18_rk,   &
        -1.2462576620719839e-17_rk, 2.380303690531384e-18_rk, -0.10666666666666663_rk, -7.231722529156942e-18_rk,   &
        1.804581863049222e-17_rk, -2.388314011703116e-19_rk, -1.426698995950733e-18_rk, -0.028581247192653085_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,2) = reshape((/ &
        1.8928203230275509_rk, 8.195888021113647e-17_rk, 5.1730335424453266e-17_rk, -1.655648219247592e-17_rk,   &
        8.195888021113647e-17_rk, 1.8928203230275509_rk, -1.655648219247592e-17_rk, 5.173033542445328e-17_rk,   &
        3.311726666020331e-17_rk, -8.068626001162854e-17_rk, 0.507179676972449_rk, 3.287078860895667e-17_rk,   &
        -8.068626001162854e-17_rk, 3.3117266660203315e-17_rk, 3.2870788608956685e-17_rk, 0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,3) = reshape((/ &
        1.8928203230275509_rk, 5.750596081601659e-17_rk, 6.038541257473607e-17_rk, -1.5239995338739495e-17_rk,   &
        5.732370800407656e-17_rk, 0.507179676972449_rk, -8.200274686536498e-17_rk, 2.446218950992051e-17_rk,   &
        6.038541257473607e-17_rk, -1.5239995338739498e-17_rk, 1.8928203230275509_rk, 5.750596081601659e-17_rk,   &
        -8.200274686536496e-17_rk, 2.4462189509920503e-17_rk, 5.732370800407657e-17_rk, 0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,1) = reshape((/ &
        -0.10666666666666666_rk, -1.6627396181432277e-17_rk, -7.073075231743598e-18_rk, 2.714151379139646e-18_rk,   &
        -1.3993065234954218e-17_rk, -0.3980854194740136_rk, 7.336771941069482e-19_rk, -1.3472893017390311e-17_rk,   &
        -2.3883140117031004e-19_rk, 1.804581863049222e-17_rk, -0.028581247192653085_rk, -1.4266989959507319e-18_rk,   &
        2.380303690531384e-18_rk, -1.246257662071984e-17_rk, -7.231722529156942e-18_rk, -0.10666666666666663_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,2) = reshape((/ &
        -1.8928203230275509_rk, -8.195888021113647e-17_rk, -5.1730335424453266e-17_rk, 1.655648219247592e-17_rk,   &
        -8.195888021113647e-17_rk, -1.8928203230275509_rk, 1.655648219247592e-17_rk, -5.173033542445328e-17_rk,   &
        -3.311726666020331e-17_rk, 8.068626001162854e-17_rk, -0.507179676972449_rk, -3.287078860895667e-17_rk,   &
        8.068626001162854e-17_rk, -3.3117266660203315e-17_rk, -3.2870788608956685e-17_rk, -0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,3) = reshape((/ &
        0.507179676972449_rk, 5.732370800407656e-17_rk, 2.4462189509920503e-17_rk, -8.200274686536498e-17_rk,   &
        5.750596081601659e-17_rk, 1.8928203230275509_rk, -1.5239995338739495e-17_rk, 6.038541257473608e-17_rk,   &
        2.44621895099205e-17_rk, -8.200274686536496e-17_rk, 0.507179676972449_rk, 5.732370800407656e-17_rk,   &
        -1.5239995338739495e-17_rk, 6.038541257473608e-17_rk, 5.75059608160166e-17_rk, 1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,1) = reshape((/ &
        0.10666666666666666_rk, 1.6627396181432277e-17_rk, 7.073075231743598e-18_rk, -2.714151379139646e-18_rk,   &
        1.3993065234954218e-17_rk, 0.3980854194740136_rk, -7.336771941069482e-19_rk, 1.3472893017390311e-17_rk,   &
        2.3883140117031004e-19_rk, -1.804581863049222e-17_rk, 0.028581247192653085_rk, 1.4266989959507319e-18_rk,   &
        -2.380303690531384e-18_rk, 1.246257662071984e-17_rk, 7.231722529156942e-18_rk, 0.10666666666666663_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,2) = reshape((/ &
        -0.6309401076758503_rk, -7.1143426870796e-17_rk, -5.099950582121627e-17_rk, 6.8266067375702235e-19_rk,   &
        -7.114342687079598e-17_rk, -0.6309401076758503_rk, 6.826606737570285e-19_rk, -5.099950582121627e-17_rk,   &
        -3.038977344924744e-17_rk, 2.144435159348948e-17_rk, -0.1690598923241498_rk, -1.0421319016581705e-17_rk,   &
        2.144435159348948e-17_rk, -3.0389773449247436e-17_rk, -1.0421319016581705e-17_rk, -0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,3) = reshape((/ &
        0.1690598923241498_rk, 3.294676788283848e-17_rk, 1.2097343654649038e-17_rk, -2.179710318279434e-17_rk,   &
        4.8617978004539204e-17_rk, 0.6309401076758503_rk, -3.2990908445216086e-19_rk, 6.929193561581469e-17_rk,   &
        1.2097343654649035e-17_rk, -2.179710318279434e-17_rk, 0.1690598923241498_rk, 3.294676788283848e-17_rk,   &
        -3.299090844521655e-19_rk, 6.929193561581467e-17_rk, 4.8617978004539216e-17_rk, 0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,1) = reshape((/ &
        0.10666666666666663_rk, 7.231722529156942e-18_rk, 1.246257662071984e-17_rk, -2.3803036905313833e-18_rk,   &
        1.4266989959507311e-18_rk, 0.028581247192653085_rk, -1.804581863049222e-17_rk, 2.388314011703116e-19_rk,   &
        1.3472893017390311e-17_rk, -7.33677194106949e-19_rk, 0.3980854194740136_rk, 1.3993065234954215e-17_rk,   &
        -2.714151379139643e-18_rk, 7.073075231743598e-18_rk, 1.6627396181432277e-17_rk, 0.10666666666666666_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,2) = reshape((/ &
        0.1690598923241498_rk, 1.0421319016581704e-17_rk, 3.038977344924744e-17_rk, -2.1444351593489472e-17_rk,   &
        1.042131901658169e-17_rk, 0.1690598923241498_rk, -2.144435159348948e-17_rk, 3.038977344924744e-17_rk,   &
        5.099950582121627e-17_rk, -6.826606737570285e-19_rk, 0.6309401076758503_rk, 7.1143426870796e-17_rk,   &
        -6.82660673757027e-19_rk, 5.099950582121626e-17_rk, 7.1143426870796e-17_rk, 0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,3) = reshape((/ &
        -0.6309401076758503_rk, -4.8617978004539216e-17_rk, -6.929193561581467e-17_rk, 3.299090844521547e-19_rk,   &
        -3.294676788283847e-17_rk, -0.1690598923241498_rk, 2.1797103182794346e-17_rk, -1.2097343654649032e-17_rk,   &
        -6.929193561581467e-17_rk, 3.2990908445216395e-19_rk, -0.6309401076758503_rk, -4.8617978004539216e-17_rk,   &
        2.1797103182794337e-17_rk, -1.2097343654649026e-17_rk, -3.294676788283848e-17_rk, -0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,1) = reshape((/ &
        -0.10666666666666663_rk, -7.231722529156942e-18_rk, -1.246257662071984e-17_rk, 2.3803036905313833e-18_rk,   &
        -1.4266989959507311e-18_rk, -0.028581247192653085_rk, 1.804581863049222e-17_rk, -2.388314011703116e-19_rk,   &
        -1.3472893017390311e-17_rk, 7.33677194106949e-19_rk, -0.3980854194740136_rk, -1.3993065234954215e-17_rk,   &
        2.714151379139643e-18_rk, -7.073075231743598e-18_rk, -1.6627396181432277e-17_rk, -0.10666666666666666_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,2) = reshape((/ &
        0.507179676972449_rk, 3.287078860895667e-17_rk, 3.311726666020331e-17_rk, -8.068626001162854e-17_rk,   &
        3.287078860895667e-17_rk, 0.507179676972449_rk, -8.068626001162854e-17_rk, 3.311726666020332e-17_rk,   &
        5.1730335424453266e-17_rk, -1.655648219247592e-17_rk, 1.8928203230275509_rk, 8.195888021113647e-17_rk,   &
        -1.6556482192475922e-17_rk, 5.173033542445327e-17_rk, 8.195888021113649e-17_rk, 1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,3) = reshape((/ &
        -1.8928203230275509_rk, -5.750596081601659e-17_rk, -6.038541257473607e-17_rk, 1.5239995338739495e-17_rk,   &
        -5.732370800407656e-17_rk, -0.507179676972449_rk, 8.200274686536498e-17_rk, -2.446218950992051e-17_rk,   &
        -6.038541257473607e-17_rk, 1.5239995338739498e-17_rk, -1.8928203230275509_rk, -5.750596081601659e-17_rk,   &
        8.200274686536496e-17_rk, -2.4462189509920503e-17_rk, -5.732370800407657e-17_rk, -0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,1) = reshape((/ &
        -0.028581247192653085_rk, -1.426698995950733e-18_rk, -2.388314011703118e-19_rk, 1.8045818630492226e-17_rk,   &
        -7.23172252915694e-18_rk, -0.10666666666666663_rk, 2.3803036905313833e-18_rk, -1.246257662071984e-17_rk,   &
        -7.073075231743597e-18_rk, 2.714151379139643e-18_rk, -0.10666666666666666_rk, -1.6627396181432274e-17_rk,   &
        7.33677194106949e-19_rk, -1.3472893017390311e-17_rk, -1.3993065234954218e-17_rk, -0.3980854194740136_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,2) = reshape((/ &
        -0.507179676972449_rk, -3.287078860895667e-17_rk, -3.311726666020331e-17_rk, 8.068626001162854e-17_rk,   &
        -3.287078860895667e-17_rk, -0.507179676972449_rk, 8.068626001162854e-17_rk, -3.311726666020332e-17_rk,   &
        -5.1730335424453266e-17_rk, 1.655648219247592e-17_rk, -1.8928203230275509_rk, -8.195888021113647e-17_rk,   &
        1.6556482192475922e-17_rk, -5.173033542445327e-17_rk, -8.195888021113649e-17_rk, -1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,3) = reshape((/ &
        -0.507179676972449_rk, -5.732370800407656e-17_rk, -2.4462189509920503e-17_rk, 8.200274686536498e-17_rk,   &
        -5.750596081601659e-17_rk, -1.8928203230275509_rk, 1.5239995338739495e-17_rk, -6.038541257473608e-17_rk,   &
        -2.44621895099205e-17_rk, 8.200274686536496e-17_rk, -0.507179676972449_rk, -5.732370800407656e-17_rk,   &
        1.5239995338739495e-17_rk, -6.038541257473608e-17_rk, -5.75059608160166e-17_rk, -1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,1) = reshape((/ &
        0.028581247192653085_rk, 1.426698995950733e-18_rk, 2.388314011703118e-19_rk, -1.8045818630492226e-17_rk,   &
        7.23172252915694e-18_rk, 0.10666666666666663_rk, -2.3803036905313833e-18_rk, 1.246257662071984e-17_rk,   &
        7.073075231743597e-18_rk, -2.714151379139643e-18_rk, 0.10666666666666666_rk, 1.6627396181432274e-17_rk,   &
        -7.33677194106949e-19_rk, 1.3472893017390311e-17_rk, 1.3993065234954218e-17_rk, 0.3980854194740136_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,2) = reshape((/ &
        -0.1690598923241498_rk, -1.0421319016581704e-17_rk, -3.038977344924744e-17_rk, 2.1444351593489472e-17_rk,   &
        -1.042131901658169e-17_rk, -0.1690598923241498_rk, 2.144435159348948e-17_rk, -3.038977344924744e-17_rk,   &
        -5.099950582121627e-17_rk, 6.826606737570285e-19_rk, -0.6309401076758503_rk, -7.1143426870796e-17_rk,   &
        6.82660673757027e-19_rk, -5.099950582121626e-17_rk, -7.1143426870796e-17_rk, -0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,3) = reshape((/ &
        -0.1690598923241498_rk, -3.294676788283848e-17_rk, -1.2097343654649038e-17_rk, 2.179710318279434e-17_rk,   &
        -4.8617978004539204e-17_rk, -0.6309401076758503_rk, 3.2990908445216086e-19_rk, -6.929193561581469e-17_rk,   &
        -1.2097343654649035e-17_rk, 2.179710318279434e-17_rk, -0.1690598923241498_rk, -3.294676788283848e-17_rk,   &
        3.299090844521655e-19_rk, -6.929193561581467e-17_rk, -4.8617978004539216e-17_rk, -0.6309401076758503_rk   &
        /),(/4,4/))

        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face3_dx
        ! 
        test_dbr2_face_face3_dx(:,:,1,1) = reshape((/ &
        0.37856406460551023_rk, 1.7055763373523564e-17_rk, 7.198483228734268e-18_rk, -5.05800450728302e-18_rk,   &
        1.7055763373523567e-17_rk, 0.37856406460551023_rk, -5.05800450728302e-18_rk, 7.198483228734268e-18_rk,   &
        -7.305484108983247e-18_rk, -8.909237519089013e-18_rk, 0.10143593539448983_rk, 9.1001305490152e-18_rk,   &
        -8.909237519089015e-18_rk, -7.305484108983245e-18_rk, 9.1001305490152e-18_rk, 0.10143593539448983_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,1,2) = reshape((/ &
        1.9904270973700677_rk, 6.049847230782036e-17_rk, 3.3359442436198486e-17_rk, 1.792113797569233e-17_rk,   &
        7.940188577754545e-17_rk, 0.5333333333333334_rk, 1.04880281756629e-17_rk, 2.0056187741122733e-17_rk,   &
        -1.8991146778182095e-17_rk, 9.71333191819741e-18_rk, 0.5333333333333334_rk, 3.331805970174457e-17_rk,   &
        -5.630004977558984e-17_rk, -1.2125153999050868e-17_rk, 3.6594129703997426e-17_rk, 0.14290623596326552_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,1,3) = reshape((/ &
        1.8928203230275509_rk, 6.101493647946401e-17_rk, -3.9933272154377685e-18_rk, -2.5901006211541798e-17_rk,   &
        6.976453313322986e-17_rk, 0.5071796769724491_rk, -4.393520392031838e-17_rk, 3.4583228141928832e-18_rk,   &
        -3.993327215437772e-18_rk, -2.5901006211541792e-17_rk, 1.8928203230275509_rk, 6.101493647946401e-17_rk,   &
        -4.393520392031837e-17_rk, 3.458322814192878e-18_rk, 6.976453313322986e-17_rk, 0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,1) = reshape((/ &
        -0.37856406460551023_rk, -1.7055763373523564e-17_rk, -7.198483228734268e-18_rk, 5.05800450728302e-18_rk,   &
        -1.7055763373523567e-17_rk, -0.37856406460551023_rk, 5.05800450728302e-18_rk, -7.198483228734268e-18_rk,   &
        7.305484108983247e-18_rk, 8.909237519089013e-18_rk, -0.10143593539448983_rk, -9.1001305490152e-18_rk,   &
        8.909237519089015e-18_rk, 7.305484108983245e-18_rk, -9.1001305490152e-18_rk, -0.10143593539448983_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,2) = reshape((/ &
        0.5333333333333334_rk, 7.940188577754545e-17_rk, 2.0056187741122727e-17_rk, 1.048802817566289e-17_rk,   &
        6.049847230782034e-17_rk, 1.9904270973700677_rk, 1.7921137975692323e-17_rk, 3.335944243619849e-17_rk,   &
        -1.2125153999050868e-17_rk, -5.630004977558986e-17_rk, 0.14290623596326552_rk, 3.6594129703997426e-17_rk,   &
        9.713331918197406e-18_rk, -1.8991146778182095e-17_rk, 3.331805970174458e-17_rk, 0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,3) = reshape((/ &
        0.5071796769724491_rk, 6.976453313322986e-17_rk, 3.4583228141928825e-18_rk, -4.393520392031838e-17_rk,   &
        6.101493647946401e-17_rk, 1.8928203230275509_rk, -2.5901006211541798e-17_rk, -3.993327215437768e-18_rk,   &
        3.458322814192877e-18_rk, -4.393520392031838e-17_rk, 0.507179676972449_rk, 6.976453313322986e-17_rk,   &
        -2.5901006211541795e-17_rk, -3.993327215437775e-18_rk, 6.101493647946401e-17_rk, 1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,1) = reshape((/ &
        -0.12618802153517011_rk, -1.0924308243549588e-17_rk, -3.484642806729976e-18_rk, -1.0739837737554068e-17_rk,   &
        -1.092430824354959e-17_rk, -0.12618802153517011_rk, -1.0739837737554068e-17_rk, -3.484642806729976e-18_rk,   &
        -1.0822239535366525e-18_rk, 4.081060523894737e-19_rk, -0.033811978464829966_rk, -4.882307332133192e-18_rk,   &
        4.0810605238947407e-19_rk, -1.0822239535366529e-18_rk, -4.882307332133192e-18_rk, -0.033811978464829966_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,2) = reshape((/ &
        -0.5333333333333334_rk, -7.940188577754545e-17_rk, -2.0056187741122727e-17_rk, -1.048802817566289e-17_rk,   &
        -6.049847230782034e-17_rk, -1.9904270973700677_rk, -1.7921137975692323e-17_rk, -3.335944243619849e-17_rk,   &
        1.2125153999050868e-17_rk, 5.630004977558986e-17_rk, -0.14290623596326552_rk, -3.6594129703997426e-17_rk,   &
        -9.713331918197406e-18_rk, 1.8991146778182095e-17_rk, -3.331805970174458e-17_rk, -0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,3) = reshape((/ &
        0.16905989232414972_rk, 4.6231482348313024e-17_rk, 4.472710927878978e-18_rk, -1.8768176796085803e-18_rk,   &
        3.28015955301009e-17_rk, 0.6309401076758503_rk, 5.353547610543153e-17_rk, 1.8361622873454168e-17_rk,   &
        4.4727109278789804e-18_rk, -1.8768176796085803e-18_rk, 0.1690598923241498_rk, 4.623148234831302e-17_rk,   &
        5.3535476105431537e-17_rk, 1.8361622873454162e-17_rk, 3.280159553010091e-17_rk, 0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,1) = reshape((/ &
        0.12618802153517011_rk, 1.0924308243549588e-17_rk, 3.484642806729976e-18_rk, 1.0739837737554068e-17_rk,   &
        1.092430824354959e-17_rk, 0.12618802153517011_rk, 1.0739837737554068e-17_rk, 3.484642806729976e-18_rk,   &
        1.0822239535366525e-18_rk, -4.081060523894737e-19_rk, 0.033811978464829966_rk, 4.882307332133192e-18_rk,   &
        -4.0810605238947407e-19_rk, 1.0822239535366529e-18_rk, 4.882307332133192e-18_rk, 0.033811978464829966_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,2) = reshape((/ &
        -1.9904270973700677_rk, -6.049847230782036e-17_rk, -3.3359442436198486e-17_rk, -1.792113797569233e-17_rk,   &
        -7.940188577754545e-17_rk, -0.5333333333333334_rk, -1.04880281756629e-17_rk, -2.0056187741122733e-17_rk,   &
        1.8991146778182095e-17_rk, -9.71333191819741e-18_rk, -0.5333333333333334_rk, -3.331805970174457e-17_rk,   &
        5.630004977558984e-17_rk, 1.2125153999050868e-17_rk, -3.6594129703997426e-17_rk, -0.14290623596326552_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,3) = reshape((/ &
        0.6309401076758503_rk, 3.2801595530100915e-17_rk, 1.8361622873454165e-17_rk, 5.353547610543153e-17_rk,   &
        4.6231482348313024e-17_rk, 0.16905989232414972_rk, -1.8768176796085803e-18_rk, 4.472710927878981e-18_rk,   &
        1.8361622873454168e-17_rk, 5.353547610543153e-17_rk, 0.6309401076758503_rk, 3.280159553010091e-17_rk,   &
        -1.876817679608582e-18_rk, 4.472710927878979e-18_rk, 4.623148234831302e-17_rk, 0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,1) = reshape((/ &
        0.10143593539448985_rk, 9.100130549015203e-18_rk, -7.305484108983245e-18_rk, -8.909237519089015e-18_rk,   &
        9.100130549015202e-18_rk, 0.10143593539448985_rk, -8.909237519089015e-18_rk, -7.305484108983245e-18_rk,   &
        7.198483228734267e-18_rk, -5.0580045072830186e-18_rk, 0.37856406460551023_rk, 1.7055763373523564e-17_rk,   &
        -5.05800450728302e-18_rk, 7.198483228734267e-18_rk, 1.7055763373523564e-17_rk, 0.37856406460551023_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,2) = reshape((/ &
        0.5333333333333334_rk, 3.331805970174457e-17_rk, -1.899114677818209e-17_rk, 9.713331918197405e-18_rk,   &
        3.6594129703997426e-17_rk, 0.14290623596326552_rk, -5.630004977558986e-17_rk, -1.2125153999050868e-17_rk,   &
        3.3359442436198486e-17_rk, 1.7921137975692332e-17_rk, 1.9904270973700677_rk, 6.049847230782036e-17_rk,   &
        1.0488028175662893e-17_rk, 2.0056187741122727e-17_rk, 7.940188577754543e-17_rk, 0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,3) = reshape((/ &
        -1.8928203230275509_rk, -6.101493647946401e-17_rk, 3.9933272154377685e-18_rk, 2.5901006211541798e-17_rk,   &
        -6.976453313322986e-17_rk, -0.5071796769724491_rk, 4.393520392031838e-17_rk, -3.4583228141928832e-18_rk,   &
        3.993327215437772e-18_rk, 2.5901006211541792e-17_rk, -1.8928203230275509_rk, -6.101493647946401e-17_rk,   &
        4.393520392031837e-17_rk, -3.458322814192878e-18_rk, -6.976453313322986e-17_rk, -0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,1) = reshape((/ &
        -0.10143593539448985_rk, -9.100130549015203e-18_rk, 7.305484108983245e-18_rk, 8.909237519089015e-18_rk,   &
        -9.100130549015202e-18_rk, -0.10143593539448985_rk, 8.909237519089015e-18_rk, 7.305484108983245e-18_rk,   &
        -7.198483228734267e-18_rk, 5.0580045072830186e-18_rk, -0.37856406460551023_rk, -1.7055763373523564e-17_rk,   &
        5.05800450728302e-18_rk, -7.198483228734267e-18_rk, -1.7055763373523564e-17_rk, -0.37856406460551023_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,2) = reshape((/ &
        0.14290623596326552_rk, 3.6594129703997426e-17_rk, -1.2125153999050868e-17_rk, -5.630004977558984e-17_rk,   &
        3.3318059701744556e-17_rk, 0.5333333333333334_rk, 9.713331918197408e-18_rk, -1.8991146778182095e-17_rk,   &
        2.0056187741122727e-17_rk, 1.0488028175662896e-17_rk, 0.5333333333333334_rk, 7.940188577754545e-17_rk,   &
        1.7921137975692335e-17_rk, 3.3359442436198486e-17_rk, 6.049847230782034e-17_rk, 1.9904270973700677_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,3) = reshape((/ &
        -0.5071796769724491_rk, -6.976453313322986e-17_rk, -3.4583228141928825e-18_rk, 4.393520392031838e-17_rk,   &
        -6.101493647946401e-17_rk, -1.8928203230275509_rk, 2.5901006211541798e-17_rk, 3.993327215437768e-18_rk,   &
        -3.458322814192877e-18_rk, 4.393520392031838e-17_rk, -0.507179676972449_rk, -6.976453313322986e-17_rk,   &
        2.5901006211541795e-17_rk, 3.993327215437775e-18_rk, -6.101493647946401e-17_rk, -1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,1) = reshape((/ &
        -0.033811978464829945_rk, -4.8823073321331935e-18_rk, -1.0822239535366536e-18_rk, 4.081060523894733e-19_rk,   &
        -4.882307332133193e-18_rk, -0.033811978464829945_rk, 4.081060523894737e-19_rk, -1.0822239535366529e-18_rk,   &
        -3.484642806729976e-18_rk, -1.0739837737554068e-17_rk, -0.1261880215351701_rk, -1.0924308243549588e-17_rk,   &
        -1.0739837737554066e-17_rk, -3.484642806729976e-18_rk, -1.0924308243549588e-17_rk, -0.1261880215351701_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,2) = reshape((/ &
        -0.14290623596326552_rk, -3.6594129703997426e-17_rk, 1.2125153999050868e-17_rk, 5.630004977558984e-17_rk,   &
        -3.3318059701744556e-17_rk, -0.5333333333333334_rk, -9.713331918197408e-18_rk, 1.8991146778182095e-17_rk,   &
        -2.0056187741122727e-17_rk, -1.0488028175662896e-17_rk, -0.5333333333333334_rk, -7.940188577754545e-17_rk,   &
        -1.7921137975692335e-17_rk, -3.3359442436198486e-17_rk, -6.049847230782034e-17_rk, -1.9904270973700677_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,3) = reshape((/ &
        -0.16905989232414972_rk, -4.6231482348313024e-17_rk, -4.472710927878978e-18_rk, 1.8768176796085803e-18_rk,   &
        -3.28015955301009e-17_rk, -0.6309401076758503_rk, -5.353547610543153e-17_rk, -1.8361622873454168e-17_rk,   &
        -4.4727109278789804e-18_rk, 1.8768176796085803e-18_rk, -0.1690598923241498_rk, -4.623148234831302e-17_rk,   &
        -5.3535476105431537e-17_rk, -1.8361622873454162e-17_rk, -3.280159553010091e-17_rk, -0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,1) = reshape((/ &
        0.033811978464829945_rk, 4.8823073321331935e-18_rk, 1.0822239535366536e-18_rk, -4.081060523894733e-19_rk,   &
        4.882307332133193e-18_rk, 0.033811978464829945_rk, -4.081060523894737e-19_rk, 1.0822239535366529e-18_rk,   &
        3.484642806729976e-18_rk, 1.0739837737554068e-17_rk, 0.1261880215351701_rk, 1.0924308243549588e-17_rk,   &
        1.0739837737554066e-17_rk, 3.484642806729976e-18_rk, 1.0924308243549588e-17_rk, 0.1261880215351701_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,2) = reshape((/ &
        -0.5333333333333334_rk, -3.331805970174457e-17_rk, 1.899114677818209e-17_rk, -9.713331918197405e-18_rk,   &
        -3.6594129703997426e-17_rk, -0.14290623596326552_rk, 5.630004977558986e-17_rk, 1.2125153999050868e-17_rk,   &
        -3.3359442436198486e-17_rk, -1.7921137975692332e-17_rk, -1.9904270973700677_rk, -6.049847230782036e-17_rk,   &
        -1.0488028175662893e-17_rk, -2.0056187741122727e-17_rk, -7.940188577754543e-17_rk, -0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,3) = reshape((/ &
        -0.6309401076758503_rk, -3.2801595530100915e-17_rk, -1.8361622873454165e-17_rk, -5.353547610543153e-17_rk,   &
        -4.6231482348313024e-17_rk, -0.16905989232414972_rk, 1.8768176796085803e-18_rk, -4.472710927878981e-18_rk,   &
        -1.8361622873454168e-17_rk, -5.353547610543153e-17_rk, -0.6309401076758503_rk, -3.280159553010091e-17_rk,   &
        1.876817679608582e-18_rk, -4.472710927878979e-18_rk, -4.623148234831302e-17_rk, -0.1690598923241498_rk   &
        /),(/4,4/))

        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face4_dx
        ! 
        test_dbr2_face_face4_dx(:,:,1,1) = reshape((/ &
        0.12618802153517011_rk, 1.092430824354959e-17_rk, 3.484642806729976e-18_rk, 1.0739837737554066e-17_rk,   &
        1.0924308243549593e-17_rk, 0.12618802153517011_rk, 1.0739837737554068e-17_rk, 3.484642806729975e-18_rk,   &
        1.0822239535366533e-18_rk, -4.0810605238947407e-19_rk, 0.033811978464829966_rk, 4.882307332133191e-18_rk,   &
        -4.0810605238947407e-19_rk, 1.0822239535366533e-18_rk, 4.882307332133191e-18_rk, 0.033811978464829966_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,1,2) = reshape((/ &
        1.9904270973700677_rk, 6.049847230782036e-17_rk, 3.3359442436198486e-17_rk, 1.7921137975692332e-17_rk,   &
        7.940188577754545e-17_rk, 0.5333333333333334_rk, 1.0488028175662896e-17_rk, 2.0056187741122724e-17_rk,   &
        -1.8991146778182095e-17_rk, 9.7133319181974e-18_rk, 0.5333333333333334_rk, 3.331805970174457e-17_rk,   &
        -5.630004977558986e-17_rk, -1.2125153999050868e-17_rk, 3.6594129703997426e-17_rk, 0.14290623596326552_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,1,3) = reshape((/ &
        0.6309401076758503_rk, 3.2801595530100915e-17_rk, 1.8361622873454162e-17_rk, 5.353547610543153e-17_rk,   &
        4.6231482348313024e-17_rk, 0.1690598923241497_rk, -1.8768176796085803e-18_rk, 4.472710927878977e-18_rk,   &
        1.8361622873454165e-17_rk, 5.353547610543152e-17_rk, 0.6309401076758503_rk, 3.280159553010091e-17_rk,   &
        -1.876817679608591e-18_rk, 4.472710927878982e-18_rk, 4.6231482348313024e-17_rk, 0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,1) = reshape((/ &
        -0.12618802153517011_rk, -1.092430824354959e-17_rk, -3.484642806729976e-18_rk, -1.0739837737554066e-17_rk,   &
        -1.0924308243549593e-17_rk, -0.12618802153517011_rk, -1.0739837737554068e-17_rk, -3.484642806729975e-18_rk,   &
        -1.0822239535366533e-18_rk, 4.0810605238947407e-19_rk, -0.033811978464829966_rk, -4.882307332133191e-18_rk,   &
        4.0810605238947407e-19_rk, -1.0822239535366533e-18_rk, -4.882307332133191e-18_rk, -0.033811978464829966_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,2) = reshape((/ &
        0.5333333333333334_rk, 7.940188577754545e-17_rk, 2.005618774112272e-17_rk, 1.0488028175662896e-17_rk,   &
        6.049847230782034e-17_rk, 1.9904270973700677_rk, 1.7921137975692332e-17_rk, 3.3359442436198486e-17_rk,   &
        -1.2125153999050874e-17_rk, -5.630004977558986e-17_rk, 0.14290623596326552_rk, 3.6594129703997426e-17_rk,   &
        9.713331918197403e-18_rk, -1.899114677818209e-17_rk, 3.331805970174457e-17_rk, 0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,3) = reshape((/ &
        0.1690598923241497_rk, 4.6231482348313024e-17_rk, 4.472710927878976e-18_rk, -1.8768176796085803e-18_rk,   &
        3.280159553010091e-17_rk, 0.6309401076758503_rk, 5.353547610543153e-17_rk, 1.8361622873454165e-17_rk,   &
        4.472710927878976e-18_rk, -1.8768176796085864e-18_rk, 0.1690598923241498_rk, 4.623148234831302e-17_rk,   &
        5.3535476105431524e-17_rk, 1.8361622873454168e-17_rk, 3.2801595530100915e-17_rk, 0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,1) = reshape((/ &
        -0.37856406460551023_rk, -1.7055763373523564e-17_rk, -7.19848322873427e-18_rk, 5.058004507283017e-18_rk,   &
        -1.7055763373523567e-17_rk, -0.37856406460551023_rk, 5.0580045072830186e-18_rk, -7.198483228734268e-18_rk,   &
        7.305484108983247e-18_rk, 8.909237519089015e-18_rk, -0.10143593539448983_rk, -9.100130549015202e-18_rk,   &
        8.909237519089015e-18_rk, 7.305484108983247e-18_rk, -9.1001305490152e-18_rk, -0.10143593539448983_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,2) = reshape((/ &
        -0.5333333333333334_rk, -7.940188577754545e-17_rk, -2.005618774112272e-17_rk, -1.0488028175662896e-17_rk,   &
        -6.049847230782034e-17_rk, -1.9904270973700677_rk, -1.7921137975692332e-17_rk, -3.3359442436198486e-17_rk,   &
        1.2125153999050874e-17_rk, 5.630004977558986e-17_rk, -0.14290623596326552_rk, -3.6594129703997426e-17_rk,   &
        -9.713331918197403e-18_rk, 1.899114677818209e-17_rk, -3.331805970174457e-17_rk, -0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,3) = reshape((/ &
        0.5071796769724491_rk, 6.976453313322985e-17_rk, 3.4583228141928794e-18_rk, -4.393520392031838e-17_rk,   &
        6.1014936479464e-17_rk, 1.8928203230275509_rk, -2.5901006211541792e-17_rk, -3.99332721543777e-18_rk,   &
        3.4583228141928748e-18_rk, -4.3935203920318366e-17_rk, 0.507179676972449_rk, 6.976453313322986e-17_rk,   &
        -2.590100621154179e-17_rk, -3.99332721543777e-18_rk, 6.101493647946401e-17_rk, 1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,1) = reshape((/ &
        0.37856406460551023_rk, 1.7055763373523564e-17_rk, 7.19848322873427e-18_rk, -5.058004507283017e-18_rk,   &
        1.7055763373523567e-17_rk, 0.37856406460551023_rk, -5.0580045072830186e-18_rk, 7.198483228734268e-18_rk,   &
        -7.305484108983247e-18_rk, -8.909237519089015e-18_rk, 0.10143593539448983_rk, 9.100130549015202e-18_rk,   &
        -8.909237519089015e-18_rk, -7.305484108983247e-18_rk, 9.1001305490152e-18_rk, 0.10143593539448983_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,2) = reshape((/ &
        -1.9904270973700677_rk, -6.049847230782036e-17_rk, -3.3359442436198486e-17_rk, -1.7921137975692332e-17_rk,   &
        -7.940188577754545e-17_rk, -0.5333333333333334_rk, -1.0488028175662896e-17_rk, -2.0056187741122724e-17_rk,   &
        1.8991146778182095e-17_rk, -9.7133319181974e-18_rk, -0.5333333333333334_rk, -3.331805970174457e-17_rk,   &
        5.630004977558986e-17_rk, 1.2125153999050868e-17_rk, -3.6594129703997426e-17_rk, -0.14290623596326552_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,3) = reshape((/ &
        1.8928203230275509_rk, 6.1014936479464e-17_rk, -3.993327215437769e-18_rk, -2.5901006211541792e-17_rk,   &
        6.976453313322985e-17_rk, 0.5071796769724491_rk, -4.393520392031838e-17_rk, 3.4583228141928786e-18_rk,   &
        -3.993327215437773e-18_rk, -2.5901006211541792e-17_rk, 1.8928203230275509_rk, 6.101493647946401e-17_rk,   &
        -4.393520392031837e-17_rk, 3.45832281419288e-18_rk, 6.976453313322986e-17_rk, 0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,1) = reshape((/ &
        0.033811978464829945_rk, 4.8823073321331935e-18_rk, 1.0822239535366533e-18_rk, -4.0810605238947407e-19_rk,   &
        4.882307332133195e-18_rk, 0.03381197846482996_rk, -4.081060523894733e-19_rk, 1.082223953536654e-18_rk,   &
        3.484642806729976e-18_rk, 1.0739837737554066e-17_rk, 0.1261880215351701_rk, 1.092430824354959e-17_rk,   &
        1.0739837737554066e-17_rk, 3.484642806729976e-18_rk, 1.0924308243549588e-17_rk, 0.1261880215351701_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,2) = reshape((/ &
        0.5333333333333334_rk, 3.331805970174457e-17_rk, -1.899114677818209e-17_rk, 9.71333191819741e-18_rk,   &
        3.6594129703997426e-17_rk, 0.14290623596326552_rk, -5.630004977558986e-17_rk, -1.212515399905087e-17_rk,   &
        3.3359442436198486e-17_rk, 1.7921137975692332e-17_rk, 1.9904270973700677_rk, 6.049847230782036e-17_rk,   &
        1.0488028175662896e-17_rk, 2.0056187741122727e-17_rk, 7.940188577754545e-17_rk, 0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,3) = reshape((/ &
        -0.6309401076758503_rk, -3.2801595530100915e-17_rk, -1.8361622873454162e-17_rk, -5.353547610543153e-17_rk,   &
        -4.6231482348313024e-17_rk, -0.1690598923241497_rk, 1.8768176796085803e-18_rk, -4.472710927878977e-18_rk,   &
        -1.8361622873454165e-17_rk, -5.353547610543152e-17_rk, -0.6309401076758503_rk, -3.280159553010091e-17_rk,   &
        1.876817679608591e-18_rk, -4.472710927878982e-18_rk, -4.6231482348313024e-17_rk, -0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,1) = reshape((/ &
        -0.033811978464829945_rk, -4.8823073321331935e-18_rk, -1.0822239535366533e-18_rk, 4.0810605238947407e-19_rk,   &
        -4.882307332133195e-18_rk, -0.03381197846482996_rk, 4.081060523894733e-19_rk, -1.082223953536654e-18_rk,   &
        -3.484642806729976e-18_rk, -1.0739837737554066e-17_rk, -0.1261880215351701_rk, -1.092430824354959e-17_rk,   &
        -1.0739837737554066e-17_rk, -3.484642806729976e-18_rk, -1.0924308243549588e-17_rk, -0.1261880215351701_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,2) = reshape((/ &
        0.14290623596326552_rk, 3.6594129703997426e-17_rk, -1.2125153999050868e-17_rk, -5.630004977558986e-17_rk,   &
        3.331805970174457e-17_rk, 0.5333333333333334_rk, 9.71333191819741e-18_rk, -1.8991146778182086e-17_rk,   &
        2.005618774112272e-17_rk, 1.04880281756629e-17_rk, 0.5333333333333334_rk, 7.940188577754545e-17_rk,   &
        1.7921137975692332e-17_rk, 3.3359442436198486e-17_rk, 6.049847230782036e-17_rk, 1.9904270973700677_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,3) = reshape((/ &
        -0.1690598923241497_rk, -4.6231482348313024e-17_rk, -4.472710927878976e-18_rk, 1.8768176796085803e-18_rk,   &
        -3.280159553010091e-17_rk, -0.6309401076758503_rk, -5.353547610543153e-17_rk, -1.8361622873454165e-17_rk,   &
        -4.472710927878976e-18_rk, 1.8768176796085864e-18_rk, -0.1690598923241498_rk, -4.623148234831302e-17_rk,   &
        -5.3535476105431524e-17_rk, -1.8361622873454168e-17_rk, -3.2801595530100915e-17_rk, -0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,1) = reshape((/ &
        -0.10143593539448985_rk, -9.100130549015205e-18_rk, 7.305484108983245e-18_rk, 8.909237519089012e-18_rk,   &
        -9.100130549015205e-18_rk, -0.10143593539448985_rk, 8.909237519089013e-18_rk, 7.305484108983244e-18_rk,   &
        -7.198483228734268e-18_rk, 5.05800450728302e-18_rk, -0.37856406460551023_rk, -1.7055763373523564e-17_rk,   &
        5.05800450728302e-18_rk, -7.198483228734268e-18_rk, -1.7055763373523564e-17_rk, -0.37856406460551023_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,2) = reshape((/ &
        -0.14290623596326552_rk, -3.6594129703997426e-17_rk, 1.2125153999050868e-17_rk, 5.630004977558986e-17_rk,   &
        -3.331805970174457e-17_rk, -0.5333333333333334_rk, -9.71333191819741e-18_rk, 1.8991146778182086e-17_rk,   &
        -2.005618774112272e-17_rk, -1.04880281756629e-17_rk, -0.5333333333333334_rk, -7.940188577754545e-17_rk,   &
        -1.7921137975692332e-17_rk, -3.3359442436198486e-17_rk, -6.049847230782036e-17_rk, -1.9904270973700677_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,3) = reshape((/ &
        -0.5071796769724491_rk, -6.976453313322985e-17_rk, -3.4583228141928794e-18_rk, 4.393520392031838e-17_rk,   &
        -6.1014936479464e-17_rk, -1.8928203230275509_rk, 2.5901006211541792e-17_rk, 3.99332721543777e-18_rk,   &
        -3.4583228141928748e-18_rk, 4.3935203920318366e-17_rk, -0.507179676972449_rk, -6.976453313322986e-17_rk,   &
        2.590100621154179e-17_rk, 3.99332721543777e-18_rk, -6.101493647946401e-17_rk, -1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,1) = reshape((/ &
        0.10143593539448985_rk, 9.100130549015205e-18_rk, -7.305484108983245e-18_rk, -8.909237519089012e-18_rk,   &
        9.100130549015205e-18_rk, 0.10143593539448985_rk, -8.909237519089013e-18_rk, -7.305484108983244e-18_rk,   &
        7.198483228734268e-18_rk, -5.05800450728302e-18_rk, 0.37856406460551023_rk, 1.7055763373523564e-17_rk,   &
        -5.05800450728302e-18_rk, 7.198483228734268e-18_rk, 1.7055763373523564e-17_rk, 0.37856406460551023_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,2) = reshape((/ &
        -0.5333333333333334_rk, -3.331805970174457e-17_rk, 1.899114677818209e-17_rk, -9.71333191819741e-18_rk,   &
        -3.6594129703997426e-17_rk, -0.14290623596326552_rk, 5.630004977558986e-17_rk, 1.212515399905087e-17_rk,   &
        -3.3359442436198486e-17_rk, -1.7921137975692332e-17_rk, -1.9904270973700677_rk, -6.049847230782036e-17_rk,   &
        -1.0488028175662896e-17_rk, -2.0056187741122727e-17_rk, -7.940188577754545e-17_rk, -0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,3) = reshape((/ &
        -1.8928203230275509_rk, -6.1014936479464e-17_rk, 3.993327215437769e-18_rk, 2.5901006211541792e-17_rk,   &
        -6.976453313322985e-17_rk, -0.5071796769724491_rk, 4.393520392031838e-17_rk, -3.4583228141928786e-18_rk,   &
        3.993327215437773e-18_rk, 2.5901006211541792e-17_rk, -1.8928203230275509_rk, -6.101493647946401e-17_rk,   &
        4.393520392031837e-17_rk, -3.45832281419288e-18_rk, -6.976453313322986e-17_rk, -0.507179676972449_rk   &
        /),(/4,4/))

        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face5_dx
        ! 
        test_dbr2_face_face5_dx(:,:,1,1) = reshape((/ &
        0.37856406460551023_rk, 1.2835015713026325e-17_rk, 1.6986780260272616e-17_rk, -1.2454013255478957e-17_rk,   &
        1.2835015713026325e-17_rk, 0.37856406460551023_rk, -1.2454013255478957e-17_rk, 1.6986780260272616e-17_rk,   &
        2.110930037136658e-17_rk, -2.3412134436151418e-17_rk, 0.10143593539448983_rk, 8.712495601932362e-18_rk,   &
        -2.3412134436151418e-17_rk, 2.110930037136658e-17_rk, 8.712495601932362e-18_rk, 0.10143593539448983_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,1,2) = reshape((/ &
        1.8928203230275509_rk, 6.23460455512766e-17_rk, 1.1835861880489226e-16_rk, -6.191731468808991e-17_rk,   &
        4.539151102351682e-17_rk, 0.507179676972449_rk, -1.1741342377006193e-16_rk, 7.21217843533037e-17_rk,   &
        1.1835861880489226e-16_rk, -6.191731468808993e-17_rk, 1.8928203230275509_rk, 6.234604555127659e-17_rk,   &
        -1.1741342377006193e-16_rk, 7.21217843533037e-17_rk, 4.539151102351683e-17_rk, 0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,1,3) = reshape((/ &
        1.9904270973700677_rk, 5.227212602072422e-17_rk, 5.845115585084692e-17_rk, -4.4076073997804455e-17_rk,   &
        7.06084224695511e-17_rk, 0.5333333333333334_rk, -2.0316903746719115e-17_rk, 5.2025647969477557e-17_rk,   &
        1.148018584756913e-16_rk, -1.620373060317107e-17_rk, 0.5333333333333334_rk, 4.7893934596328246e-17_rk,   &
        -1.1352923827618338e-16_rk, 5.4337982707298846e-17_rk, 3.3255652817914855e-17_rk, 0.14290623596326552_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,1) = reshape((/ &
        -0.37856406460551023_rk, -1.2835015713026325e-17_rk, -1.6986780260272616e-17_rk, 1.2454013255478957e-17_rk,   &
        -1.2835015713026325e-17_rk, -0.37856406460551023_rk, 1.2454013255478957e-17_rk, -1.6986780260272616e-17_rk,   &
        -2.110930037136658e-17_rk, 2.3412134436151418e-17_rk, -0.10143593539448983_rk, -8.712495601932362e-18_rk,   &
        2.3412134436151418e-17_rk, -2.110930037136658e-17_rk, -8.712495601932362e-18_rk, -0.10143593539448983_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,2) = reshape((/ &
        0.507179676972449_rk, 4.5391511023516816e-17_rk, 7.21217843533037e-17_rk, -1.1741342377006193e-16_rk,   &
        6.23460455512766e-17_rk, 1.8928203230275509_rk, -6.191731468808993e-17_rk, 1.1835861880489229e-16_rk,   &
        7.21217843533037e-17_rk, -1.1741342377006193e-16_rk, 0.507179676972449_rk, 4.539151102351682e-17_rk,   &
        -6.191731468808993e-17_rk, 1.1835861880489226e-16_rk, 6.23460455512766e-17_rk, 1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,3) = reshape((/ &
        0.5333333333333334_rk, 7.06084224695511e-17_rk, 5.2025647969477544e-17_rk, -2.031690374671912e-17_rk,   &
        5.227212602072422e-17_rk, 1.9904270973700677_rk, -4.407607399780447e-17_rk, 5.845115585084694e-17_rk,   &
        5.4337982707298846e-17_rk, -1.1352923827618338e-16_rk, 0.14290623596326552_rk, 3.3255652817914843e-17_rk,   &
        -1.620373060317107e-17_rk, 1.1480185847569132e-16_rk, 4.789393459632827e-17_rk, 0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,1) = reshape((/ &
        -0.10143593539448983_rk, -8.71249560193236e-18_rk, -2.110930037136658e-17_rk, 2.3412134436151418e-17_rk,   &
        -8.71249560193236e-18_rk, -0.10143593539448983_rk, 2.3412134436151418e-17_rk, -2.110930037136658e-17_rk,   &
        -1.6986780260272616e-17_rk, 1.245401325547896e-17_rk, -0.37856406460551023_rk, -1.2835015713026326e-17_rk,   &
        1.2454013255478957e-17_rk, -1.6986780260272616e-17_rk, -1.2835015713026326e-17_rk, -0.37856406460551023_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,2) = reshape((/ &
        -0.507179676972449_rk, -4.5391511023516816e-17_rk, -7.21217843533037e-17_rk, 1.1741342377006193e-16_rk,   &
        -6.23460455512766e-17_rk, -1.8928203230275509_rk, 6.191731468808993e-17_rk, -1.1835861880489229e-16_rk,   &
        -7.21217843533037e-17_rk, 1.1741342377006193e-16_rk, -0.507179676972449_rk, -4.539151102351682e-17_rk,   &
        6.191731468808993e-17_rk, -1.1835861880489226e-16_rk, -6.23460455512766e-17_rk, -1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,3) = reshape((/ &
        0.14290623596326557_rk, 3.325565281791485e-17_rk, 5.4337982707298833e-17_rk, -1.1352923827618338e-16_rk,   &
        4.789393459632827e-17_rk, 0.5333333333333334_rk, -1.6203730603171063e-17_rk, 1.1480185847569132e-16_rk,   &
        5.202564796947754e-17_rk, -2.031690374671912e-17_rk, 0.5333333333333334_rk, 7.06084224695511e-17_rk,   &
        -4.407607399780446e-17_rk, 5.84511558508469e-17_rk, 5.227212602072422e-17_rk, 1.9904270973700677_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,1) = reshape((/ &
        0.10143593539448983_rk, 8.71249560193236e-18_rk, 2.110930037136658e-17_rk, -2.3412134436151418e-17_rk,   &
        8.71249560193236e-18_rk, 0.10143593539448983_rk, -2.3412134436151418e-17_rk, 2.110930037136658e-17_rk,   &
        1.6986780260272616e-17_rk, -1.245401325547896e-17_rk, 0.37856406460551023_rk, 1.2835015713026326e-17_rk,   &
        -1.2454013255478957e-17_rk, 1.6986780260272616e-17_rk, 1.2835015713026326e-17_rk, 0.37856406460551023_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,2) = reshape((/ &
        -1.8928203230275509_rk, -6.23460455512766e-17_rk, -1.1835861880489226e-16_rk, 6.191731468808991e-17_rk,   &
        -4.539151102351682e-17_rk, -0.507179676972449_rk, 1.1741342377006193e-16_rk, -7.21217843533037e-17_rk,   &
        -1.1835861880489226e-16_rk, 6.191731468808993e-17_rk, -1.8928203230275509_rk, -6.234604555127659e-17_rk,   &
        1.1741342377006193e-16_rk, -7.21217843533037e-17_rk, -4.539151102351683e-17_rk, -0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,3) = reshape((/ &
        0.5333333333333334_rk, 4.7893934596328264e-17_rk, 1.148018584756913e-16_rk, -1.6203730603171063e-17_rk,   &
        3.3255652817914843e-17_rk, 0.14290623596326557_rk, -1.1352923827618338e-16_rk, 5.433798270729886e-17_rk,   &
        5.84511558508469e-17_rk, -4.407607399780446e-17_rk, 1.9904270973700677_rk, 5.2272126020724205e-17_rk,   &
        -2.031690374671912e-17_rk, 5.202564796947754e-17_rk, 7.06084224695511e-17_rk, 0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,1) = reshape((/ &
        0.1261880215351701_rk, 1.1741093985028737e-17_rk, 5.1085805037922764e-18_rk, -4.2458229342576346e-19_rk,   &
        1.1741093985028737e-17_rk, 0.1261880215351701_rk, -4.2458229342576346e-19_rk, 5.108580503792277e-18_rk,   &
        1.271866786523145e-17_rk, -2.5344593397194728e-18_rk, 0.033811978464829966_rk, 7.517421880916265e-18_rk,   &
        -2.5344593397194728e-18_rk, 1.271866786523145e-17_rk, 7.517421880916265e-18_rk, 0.033811978464829966_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,2) = reshape((/ &
        0.6309401076758503_rk, 3.782001506577588e-17_rk, 5.489439552164594e-17_rk, 1.6375100871143925e-18_rk,   &
        5.847256426394913e-17_rk, 0.16905989232414986_rk, -1.6432718252840558e-17_rk, 3.4241846323472696e-17_rk,   &
        5.489439552164594e-17_rk, 1.6375100871143863e-18_rk, 0.6309401076758503_rk, 3.7820015065775864e-17_rk,   &
        -1.6432718252840558e-17_rk, 3.4241846323472684e-17_rk, 5.847256426394914e-17_rk, 0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,3) = reshape((/ &
        -1.9904270973700677_rk, -5.227212602072422e-17_rk, -5.845115585084692e-17_rk, 4.4076073997804455e-17_rk,   &
        -7.06084224695511e-17_rk, -0.5333333333333334_rk, 2.0316903746719115e-17_rk, -5.2025647969477557e-17_rk,   &
        -1.148018584756913e-16_rk, 1.620373060317107e-17_rk, -0.5333333333333334_rk, -4.7893934596328246e-17_rk,   &
        1.1352923827618338e-16_rk, -5.4337982707298846e-17_rk, -3.3255652817914855e-17_rk, -0.14290623596326552_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,1) = reshape((/ &
        -0.1261880215351701_rk, -1.1741093985028737e-17_rk, -5.1085805037922764e-18_rk, 4.2458229342576346e-19_rk,   &
        -1.1741093985028737e-17_rk, -0.1261880215351701_rk, 4.2458229342576346e-19_rk, -5.108580503792277e-18_rk,   &
        -1.271866786523145e-17_rk, 2.5344593397194728e-18_rk, -0.033811978464829966_rk, -7.517421880916265e-18_rk,   &
        2.5344593397194728e-18_rk, -1.271866786523145e-17_rk, -7.517421880916265e-18_rk, -0.033811978464829966_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,2) = reshape((/ &
        0.16905989232414986_rk, 5.847256426394914e-17_rk, 3.4241846323472684e-17_rk, -1.6432718252840558e-17_rk,   &
        3.7820015065775877e-17_rk, 0.6309401076758503_rk, 1.6375100871143863e-18_rk, 5.4894395521645965e-17_rk,   &
        3.4241846323472684e-17_rk, -1.6432718252840558e-17_rk, 0.1690598923241498_rk, 5.847256426394913e-17_rk,   &
        1.6375100871143863e-18_rk, 5.489439552164594e-17_rk, 3.782001506577588e-17_rk, 0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,3) = reshape((/ &
        -0.5333333333333334_rk, -7.06084224695511e-17_rk, -5.2025647969477544e-17_rk, 2.031690374671912e-17_rk,   &
        -5.227212602072422e-17_rk, -1.9904270973700677_rk, 4.407607399780447e-17_rk, -5.845115585084694e-17_rk,   &
        -5.4337982707298846e-17_rk, 1.1352923827618338e-16_rk, -0.14290623596326552_rk, -3.3255652817914843e-17_rk,   &
        1.620373060317107e-17_rk, -1.1480185847569132e-16_rk, -4.789393459632827e-17_rk, -0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,1) = reshape((/ &
        -0.033811978464829966_rk, -7.517421880916263e-18_rk, -1.2718667865231451e-17_rk, 2.5344593397194728e-18_rk,   &
        -7.517421880916263e-18_rk, -0.033811978464829966_rk, 2.5344593397194728e-18_rk, -1.2718667865231451e-17_rk,   &
        -5.108580503792277e-18_rk, 4.2458229342576346e-19_rk, -0.1261880215351701_rk, -1.1741093985028739e-17_rk,   &
        4.2458229342576346e-19_rk, -5.108580503792277e-18_rk, -1.1741093985028739e-17_rk, -0.1261880215351701_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,2) = reshape((/ &
        -0.16905989232414986_rk, -5.847256426394914e-17_rk, -3.4241846323472684e-17_rk, 1.6432718252840558e-17_rk,   &
        -3.7820015065775877e-17_rk, -0.6309401076758503_rk, -1.6375100871143863e-18_rk, -5.4894395521645965e-17_rk,   &
        -3.4241846323472684e-17_rk, 1.6432718252840558e-17_rk, -0.1690598923241498_rk, -5.847256426394913e-17_rk,   &
        -1.6375100871143863e-18_rk, -5.489439552164594e-17_rk, -3.782001506577588e-17_rk, -0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,3) = reshape((/ &
        -0.14290623596326557_rk, -3.325565281791485e-17_rk, -5.4337982707298833e-17_rk, 1.1352923827618338e-16_rk,   &
        -4.789393459632827e-17_rk, -0.5333333333333334_rk, 1.6203730603171063e-17_rk, -1.1480185847569132e-16_rk,   &
        -5.202564796947754e-17_rk, 2.031690374671912e-17_rk, -0.5333333333333334_rk, -7.06084224695511e-17_rk,   &
        4.407607399780446e-17_rk, -5.84511558508469e-17_rk, -5.227212602072422e-17_rk, -1.9904270973700677_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,1) = reshape((/ &
        0.033811978464829966_rk, 7.517421880916263e-18_rk, 1.2718667865231451e-17_rk, -2.5344593397194728e-18_rk,   &
        7.517421880916263e-18_rk, 0.033811978464829966_rk, -2.5344593397194728e-18_rk, 1.2718667865231451e-17_rk,   &
        5.108580503792277e-18_rk, -4.2458229342576346e-19_rk, 0.1261880215351701_rk, 1.1741093985028739e-17_rk,   &
        -4.2458229342576346e-19_rk, 5.108580503792277e-18_rk, 1.1741093985028739e-17_rk, 0.1261880215351701_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,2) = reshape((/ &
        -0.6309401076758503_rk, -3.782001506577588e-17_rk, -5.489439552164594e-17_rk, -1.6375100871143925e-18_rk,   &
        -5.847256426394913e-17_rk, -0.16905989232414986_rk, 1.6432718252840558e-17_rk, -3.4241846323472696e-17_rk,   &
        -5.489439552164594e-17_rk, -1.6375100871143863e-18_rk, -0.6309401076758503_rk, -3.7820015065775864e-17_rk,   &
        1.6432718252840558e-17_rk, -3.4241846323472684e-17_rk, -5.847256426394914e-17_rk, -0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,3) = reshape((/ &
        -0.5333333333333334_rk, -4.7893934596328264e-17_rk, -1.148018584756913e-16_rk, 1.6203730603171063e-17_rk,   &
        -3.3255652817914843e-17_rk, -0.14290623596326557_rk, 1.1352923827618338e-16_rk, -5.433798270729886e-17_rk,   &
        -5.84511558508469e-17_rk, 4.407607399780446e-17_rk, -1.9904270973700677_rk, -5.2272126020724205e-17_rk,   &
        2.031690374671912e-17_rk, -5.202564796947754e-17_rk, -7.06084224695511e-17_rk, -0.5333333333333334_rk   &
        /),(/4,4/))


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face6_dx
        ! 
        test_dbr2_face_face6_dx(:,:,1,1) = reshape((/ &
        0.12618802153517003_rk, 1.3002331358482959e-17_rk, 5.263414772482969e-18_rk, 1.1527197207333188e-17_rk,   &
        1.3002331358482957e-17_rk, 0.12618802153517003_rk, 1.1527197207333191e-17_rk, 5.263414772482969e-18_rk,   &
        8.813542612148463e-18_rk, 3.9054120714330856e-18_rk, 0.03381197846482994_rk, 1.11076033460876e-17_rk,   &
        3.905412071433085e-18_rk, 8.813542612148463e-18_rk, 1.1107603346087598e-17_rk, 0.03381197846482994_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,1,2) = reshape((/ &
        0.6309401076758503_rk, 4.5497259647563e-17_rk, 2.9466511741531354e-17_rk, 5.779969861900474e-17_rk,   &
        7.505241387528979e-17_rk, 0.1690598923241498_rk, 1.9363347774826632e-17_rk, 4.091827518162581e-17_rk,   &
        2.946651174153135e-17_rk, 5.779969861900474e-17_rk, 0.6309401076758503_rk, 4.549725964756299e-17_rk,   &
        1.9363347774826632e-17_rk, 4.0918275181625804e-17_rk, 7.505241387528979e-17_rk, 0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,1,3) = reshape((/ &
        1.9904270973700677_rk, 3.4208683875795305e-17_rk, 1.1028384680183335e-17_rk, 3.4290783780405466e-18_rk,   &
        7.098114838020768e-17_rk, 0.5333333333333334_rk, 1.857063620177195e-17_rk, 3.541067690469698e-17_rk,   &
        1.80634421449289e-17_rk, 1.9345332459237442e-17_rk, 0.5333333333333334_rk, 3.8251229848737104e-17_rk,   &
        -2.2623886381264866e-17_rk, 4.852632668455716e-17_rk, 5.012637204874269e-17_rk, 0.14290623596326552_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,1) = reshape((/ &
        -0.12618802153517003_rk, -1.3002331358482959e-17_rk, -5.263414772482969e-18_rk, -1.1527197207333188e-17_rk,   &
        -1.3002331358482957e-17_rk, -0.12618802153517003_rk, -1.1527197207333191e-17_rk, -5.263414772482969e-18_rk,   &
        -8.813542612148463e-18_rk, -3.9054120714330856e-18_rk, -0.03381197846482994_rk, -1.11076033460876e-17_rk,   &
        -3.905412071433085e-18_rk, -8.813542612148463e-18_rk, -1.1107603346087598e-17_rk, -0.03381197846482994_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,2) = reshape((/ &
        0.1690598923241498_rk, 7.505241387528979e-17_rk, 4.0918275181625804e-17_rk, 1.9363347774826632e-17_rk,   &
        4.5497259647563e-17_rk, 0.6309401076758503_rk, 5.779969861900474e-17_rk, 2.946651174153136e-17_rk,   &
        4.091827518162581e-17_rk, 1.9363347774826632e-17_rk, 0.1690598923241498_rk, 7.505241387528979e-17_rk,   &
        5.779969861900474e-17_rk, 2.9466511741531354e-17_rk, 4.549725964756299e-17_rk, 0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,3) = reshape((/ &
        0.5333333333333334_rk, 7.098114838020768e-17_rk, 3.541067690469697e-17_rk, 1.857063620177195e-17_rk,   &
        3.4208683875795305e-17_rk, 1.9904270973700677_rk, 3.4290783780405466e-18_rk, 1.1028384680183342e-17_rk,   &
        4.852632668455717e-17_rk, -2.2623886381264866e-17_rk, 0.14290623596326552_rk, 5.012637204874269e-17_rk,   &
        1.9345332459237442e-17_rk, 1.8063442144928903e-17_rk, 3.8251229848737104e-17_rk, 0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,1) = reshape((/ &
        -0.03381197846482994_rk, -1.1107603346087598e-17_rk, -8.813542612148463e-18_rk, -3.905412071433084e-18_rk,   &
        -1.11076033460876e-17_rk, -0.03381197846482994_rk, -3.9054120714330856e-18_rk, -8.813542612148463e-18_rk,   &
        -5.263414772482969e-18_rk, -1.1527197207333188e-17_rk, -0.12618802153517003_rk, -1.3002331358482957e-17_rk,   &
        -1.1527197207333188e-17_rk, -5.263414772482969e-18_rk, -1.3002331358482959e-17_rk, -0.12618802153517003_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,2) = reshape((/ &
        -0.1690598923241498_rk, -7.505241387528979e-17_rk, -4.0918275181625804e-17_rk, -1.9363347774826632e-17_rk,   &
        -4.5497259647563e-17_rk, -0.6309401076758503_rk, -5.779969861900474e-17_rk, -2.946651174153136e-17_rk,   &
        -4.091827518162581e-17_rk, -1.9363347774826632e-17_rk, -0.1690598923241498_rk, -7.505241387528979e-17_rk,   &
        -5.779969861900474e-17_rk, -2.9466511741531354e-17_rk, -4.549725964756299e-17_rk, -0.6309401076758503_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,3) = reshape((/ &
        0.14290623596326552_rk, 5.012637204874269e-17_rk, 4.852632668455716e-17_rk, -2.2623886381264872e-17_rk,   &
        3.825122984873711e-17_rk, 0.5333333333333334_rk, 1.9345332459237442e-17_rk, 1.806344214492891e-17_rk,   &
        3.541067690469698e-17_rk, 1.857063620177195e-17_rk, 0.5333333333333334_rk, 7.09811483802077e-17_rk,   &
        3.4290783780405466e-18_rk, 1.1028384680183335e-17_rk, 3.42086838757953e-17_rk, 1.9904270973700677_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,1) = reshape((/ &
        0.03381197846482994_rk, 1.1107603346087598e-17_rk, 8.813542612148463e-18_rk, 3.905412071433084e-18_rk,   &
        1.11076033460876e-17_rk, 0.03381197846482994_rk, 3.9054120714330856e-18_rk, 8.813542612148463e-18_rk,   &
        5.263414772482969e-18_rk, 1.1527197207333188e-17_rk, 0.12618802153517003_rk, 1.3002331358482957e-17_rk,   &
        1.1527197207333188e-17_rk, 5.263414772482969e-18_rk, 1.3002331358482959e-17_rk, 0.12618802153517003_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,2) = reshape((/ &
        -0.6309401076758503_rk, -4.5497259647563e-17_rk, -2.9466511741531354e-17_rk, -5.779969861900474e-17_rk,   &
        -7.505241387528979e-17_rk, -0.1690598923241498_rk, -1.9363347774826632e-17_rk, -4.091827518162581e-17_rk,   &
        -2.946651174153135e-17_rk, -5.779969861900474e-17_rk, -0.6309401076758503_rk, -4.549725964756299e-17_rk,   &
        -1.9363347774826632e-17_rk, -4.0918275181625804e-17_rk, -7.505241387528979e-17_rk, -0.1690598923241498_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,3) = reshape((/ &
        0.5333333333333334_rk, 3.825122984873711e-17_rk, 1.8063442144928903e-17_rk, 1.9345332459237436e-17_rk,   &
        5.012637204874269e-17_rk, 0.14290623596326552_rk, -2.2623886381264866e-17_rk, 4.852632668455717e-17_rk,   &
        1.1028384680183334e-17_rk, 3.4290783780405466e-18_rk, 1.9904270973700677_rk, 3.42086838757953e-17_rk,   &
        1.857063620177195e-17_rk, 3.541067690469697e-17_rk, 7.098114838020768e-17_rk, 0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,1) = reshape((/ &
        0.3785640646055102_rk, 8.03563509271764e-18_rk, 4.0243975444930936e-18_rk, -7.12725429137069e-18_rk,   &
        8.035635092717639e-18_rk, 0.3785640646055102_rk, -7.127254291370692e-18_rk, 4.0243975444930936e-18_rk,   &
        4.5044111537487506e-18_rk, -4.561122855838572e-18_rk, 0.1014359353944898_rk, 6.567917033408363e-18_rk,   &
        -4.561122855838572e-18_rk, 4.5044111537487506e-18_rk, 6.567917033408362e-18_rk, 0.1014359353944898_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,2) = reshape((/ &
        1.8928203230275509_rk, 2.696265407696942e-17_rk, -3.7468491641911437e-19_rk, -3.5025287781726755e-17_rk,   &
        4.605510655366059e-17_rk, 0.507179676972449_rk, -2.341659795431955e-17_rk, 4.3018728407628335e-17_rk,   &
        -3.746849164191159e-19_rk, -3.5025287781726755e-17_rk, 1.8928203230275509_rk, 2.6962654076969414e-17_rk,   &
        -2.341659795431955e-17_rk, 4.301872840762833e-17_rk, 4.605510655366059e-17_rk, 0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,3) = reshape((/ &
        -1.9904270973700677_rk, -3.4208683875795305e-17_rk, -1.1028384680183335e-17_rk, -3.4290783780405466e-18_rk,   &
        -7.098114838020768e-17_rk, -0.5333333333333334_rk, -1.857063620177195e-17_rk, -3.541067690469698e-17_rk,   &
        -1.80634421449289e-17_rk, -1.9345332459237442e-17_rk, -0.5333333333333334_rk, -3.8251229848737104e-17_rk,   &
        2.2623886381264866e-17_rk, -4.852632668455716e-17_rk, -5.012637204874269e-17_rk, -0.14290623596326552_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,1) = reshape((/ &
        -0.3785640646055102_rk, -8.03563509271764e-18_rk, -4.0243975444930936e-18_rk, 7.12725429137069e-18_rk,   &
        -8.035635092717639e-18_rk, -0.3785640646055102_rk, 7.127254291370692e-18_rk, -4.0243975444930936e-18_rk,   &
        -4.5044111537487506e-18_rk, 4.561122855838572e-18_rk, -0.1014359353944898_rk, -6.567917033408363e-18_rk,   &
        4.561122855838572e-18_rk, -4.5044111537487506e-18_rk, -6.567917033408362e-18_rk, -0.1014359353944898_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,2) = reshape((/ &
        0.507179676972449_rk, 4.605510655366059e-17_rk, 4.301872840762833e-17_rk, -2.341659795431955e-17_rk,   &
        2.696265407696942e-17_rk, 1.8928203230275509_rk, -3.5025287781726755e-17_rk, -3.746849164191082e-19_rk,   &
        4.3018728407628335e-17_rk, -2.341659795431955e-17_rk, 0.507179676972449_rk, 4.605510655366059e-17_rk,   &
        -3.5025287781726755e-17_rk, -3.7468491641911437e-19_rk, 2.6962654076969414e-17_rk, 1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,3) = reshape((/ &
        -0.5333333333333334_rk, -7.098114838020768e-17_rk, -3.541067690469697e-17_rk, -1.857063620177195e-17_rk,   &
        -3.4208683875795305e-17_rk, -1.9904270973700677_rk, -3.4290783780405466e-18_rk, -1.1028384680183342e-17_rk,   &
        -4.852632668455717e-17_rk, 2.2623886381264866e-17_rk, -0.14290623596326552_rk, -5.012637204874269e-17_rk,   &
        -1.9345332459237442e-17_rk, -1.8063442144928903e-17_rk, -3.8251229848737104e-17_rk, -0.5333333333333334_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,1) = reshape((/ &
        -0.1014359353944898_rk, -6.567917033408362e-18_rk, -4.5044111537487506e-18_rk, 4.561122855838571e-18_rk,   &
        -6.567917033408364e-18_rk, -0.1014359353944898_rk, 4.561122855838572e-18_rk, -4.5044111537487506e-18_rk,   &
        -4.0243975444930936e-18_rk, 7.127254291370692e-18_rk, -0.3785640646055102_rk, -8.035635092717639e-18_rk,   &
        7.127254291370692e-18_rk, -4.0243975444930936e-18_rk, -8.03563509271764e-18_rk, -0.3785640646055102_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,2) = reshape((/ &
        -0.507179676972449_rk, -4.605510655366059e-17_rk, -4.301872840762833e-17_rk, 2.341659795431955e-17_rk,   &
        -2.696265407696942e-17_rk, -1.8928203230275509_rk, 3.5025287781726755e-17_rk, 3.746849164191082e-19_rk,   &
        -4.3018728407628335e-17_rk, 2.341659795431955e-17_rk, -0.507179676972449_rk, -4.605510655366059e-17_rk,   &
        3.5025287781726755e-17_rk, 3.7468491641911437e-19_rk, -2.6962654076969414e-17_rk, -1.8928203230275509_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,3) = reshape((/ &
        -0.14290623596326552_rk, -5.012637204874269e-17_rk, -4.852632668455716e-17_rk, 2.2623886381264872e-17_rk,   &
        -3.825122984873711e-17_rk, -0.5333333333333334_rk, -1.9345332459237442e-17_rk, -1.806344214492891e-17_rk,   &
        -3.541067690469698e-17_rk, -1.857063620177195e-17_rk, -0.5333333333333334_rk, -7.09811483802077e-17_rk,   &
        -3.4290783780405466e-18_rk, -1.1028384680183335e-17_rk, -3.42086838757953e-17_rk, -1.9904270973700677_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,1) = reshape((/ &
        0.1014359353944898_rk, 6.567917033408362e-18_rk, 4.5044111537487506e-18_rk, -4.561122855838571e-18_rk,   &
        6.567917033408364e-18_rk, 0.1014359353944898_rk, -4.561122855838572e-18_rk, 4.5044111537487506e-18_rk,   &
        4.0243975444930936e-18_rk, -7.127254291370692e-18_rk, 0.3785640646055102_rk, 8.035635092717639e-18_rk,   &
        -7.127254291370692e-18_rk, 4.0243975444930936e-18_rk, 8.03563509271764e-18_rk, 0.3785640646055102_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,2) = reshape((/ &
        -1.8928203230275509_rk, -2.696265407696942e-17_rk, 3.7468491641911437e-19_rk, 3.5025287781726755e-17_rk,   &
        -4.605510655366059e-17_rk, -0.507179676972449_rk, 2.341659795431955e-17_rk, -4.3018728407628335e-17_rk,   &
        3.746849164191159e-19_rk, 3.5025287781726755e-17_rk, -1.8928203230275509_rk, -2.6962654076969414e-17_rk,   &
        2.341659795431955e-17_rk, -4.301872840762833e-17_rk, -4.605510655366059e-17_rk, -0.507179676972449_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,3) = reshape((/ &
        -0.5333333333333334_rk, -3.825122984873711e-17_rk, -1.8063442144928903e-17_rk, -1.9345332459237436e-17_rk,   &
        -5.012637204874269e-17_rk, -0.14290623596326552_rk, 2.2623886381264866e-17_rk, -4.852632668455717e-17_rk,   &
        -1.1028384680183334e-17_rk, -3.4290783780405466e-18_rk, -1.9904270973700677_rk, -3.42086838757953e-17_rk,   &
        -1.857063620177195e-17_rk, -3.541067690469697e-17_rk, -7.098114838020768e-17_rk, -0.5333333333333334_rk   &
        /),(/4,4/))


        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do
    
    
    
    
    
    
    
    
    
    end subroutine testElement_dbr2_face_dx
    !*******************************************************************************************






    !> Test face dmetrics_dx
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dmetrics_dx_ximin(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        real(rk)    :: test_dmetric_dx_ximin(3,3,self%faces(XI_MIN)%basis_s%nnodes_face(),self%elem%nterms_c,3)
        real(rk)    :: tol
        
        integer(ik)     :: inode_diff, idir, inode, irow
        
        tol = 1.e-14_rk
        
        test_dmetric_dx_ximin(:,:,1,1,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, 3.154700538379252017e-01_rk, 3.154700538379252017e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.577350269189625731e+00_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.577350269189625731e+00_rk, 1.577350269189625731e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,2,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,3,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,4,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -3.154700538379252017e-01_rk, 8.452994616207487599e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -1.577350269189625731e+00_rk, 4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -1.577350269189625731e+00_rk, 4.226497308103742689e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,5,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 8.452994616207487599e-02_rk, -3.154700538379252017e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 4.226497308103742689e-01_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 4.226497308103742689e-01_rk, -1.577350269189625731e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,6,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,7,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,8,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, -8.452994616207487599e-02_rk, -8.452994616207487599e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -4.226497308103742689e-01_rk, -4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,1,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -4.226497308103742689e-01_rk, -4.226497308103742689e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,1,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 3.154700538379252017e-01_rk, 8.452994616207487599e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 1.577350269189625731e+00_rk, 4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 1.577350269189625731e+00_rk, 4.226497308103742689e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,2,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,3,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,4,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, -3.154700538379252017e-01_rk, 3.154700538379252017e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.577350269189625731e+00_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.577350269189625731e+00_rk, 1.577350269189625731e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,5,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, 8.452994616207487599e-02_rk, -8.452994616207487599e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 4.226497308103742689e-01_rk, -4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 4.226497308103742689e-01_rk, -4.226497308103742689e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,6,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,7,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,8,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -8.452994616207487599e-02_rk, -3.154700538379252017e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -4.226497308103742689e-01_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,2,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -4.226497308103742689e-01_rk, -1.577350269189625731e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,1,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 8.452994616207487599e-02_rk, 3.154700538379252017e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 4.226497308103742689e-01_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 4.226497308103742689e-01_rk, 1.577350269189625731e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,2,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,3,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,4,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, -8.452994616207487599e-02_rk, 8.452994616207487599e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -4.226497308103742689e-01_rk, 4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, -4.226497308103742689e-01_rk, 4.226497308103742689e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,5,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, 3.154700538379252017e-01_rk, -3.154700538379252017e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.577350269189625731e+00_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, 1.577350269189625731e+00_rk, -1.577350269189625731e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,6,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,7,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,8,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -3.154700538379252017e-01_rk, -8.452994616207487599e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -1.577350269189625731e+00_rk, -4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,3,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -1.577350269189625731e+00_rk, -4.226497308103742689e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,1,1) = reshape((/                                                                                 &
                                        3.572655899081636499e-03_rk, 8.452994616207487599e-02_rk, 8.452994616207487599e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 4.226497308103742689e-01_rk, 4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.786327949540818943e-02_rk, 4.226497308103742689e-01_rk, 4.226497308103742689e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,2,1) = reshape((/                                                                                 &
                                        -3.572655899081636499e-03_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,3,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,4,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, -8.452994616207487599e-02_rk, 3.154700538379252017e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -4.226497308103742689e-01_rk, 1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, -4.226497308103742689e-01_rk, 1.577350269189625731e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,5,1) = reshape((/                                                                                 &
                                        1.333333333333333592e-02_rk, 3.154700538379252017e-01_rk, -8.452994616207487599e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 1.577350269189625731e+00_rk, -4.226497308103742689e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.666666666666667962e-02_rk, 1.577350269189625731e+00_rk, -4.226497308103742689e-01_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,6,1) = reshape((/                                                                                 &
                                        -1.333333333333333592e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,7,1) = reshape((/                                                                                 &
                                        -4.976067743425170720e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,8,1) = reshape((/                                                                                 &
                                        4.976067743425170720e-02_rk, -3.154700538379252017e-01_rk, -3.154700538379252017e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.577350269189625731e+00_rk, -1.577350269189625731e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))

        test_dmetric_dx_ximin(:,:,4,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.488033871712584666e-01_rk, -1.577350269189625731e+00_rk, -1.577350269189625731e+00_rk  &
                                        /),(/3,3/))

        
        
        do inode = 1,self%elem%basis_s%nnodes_face()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx_ximin(:,:,inode,inode_diff,idir)),self%faces(XI_MIN)%dmetric_dx(:,:,inode,inode_diff,idir),tol)
                end do
            end do
        end do

    end subroutine testElement_face_dmetrics_dx_ximin
    !*******************************************************************************************








    !> Test cartesian face dgrad_dx  
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dgrad_dx_ximin(self)
        class(test_element_linearA_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode, irow
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.572655899081636499e-03_rk,2.062673845056688798e-03_rk,2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,-1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-4.976067743425170720e-02_rk,-2.872934051172335024e-02_rk,-2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,-1.658689247808389777e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.786327949540818943e-02_rk,1.031336922528343358e-02_rk,-1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.488033871712584666e-01_rk,-1.436467025586167789e-01_rk,1.436467025586167789e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.572655899081636499e-03_rk,-2.062673845056688798e-03_rk,-2.062673845056688798e-03_rk,0.000000000000000000e+00_rk,1.190885299693878688e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,7.698003589195010626e-03_rk,-7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444443573e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.333333333333333592e-02_rk,-7.698003589195010626e-03_rk,7.698003589195010626e-03_rk,0.000000000000000000e+00_rk,-4.444444444444445308e-03_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.976067743425170720e-02_rk,2.872934051172335024e-02_rk,2.872934051172335024e-02_rk,0.000000000000000000e+00_rk,1.658689247808389777e-02_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk  &
                                        /),(/8,4/))

        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.786327949540818943e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.786327949540818943e-02_rk,-1.031336922528343358e-02_rk,1.031336922528343358e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,3.849001794597504966e-02_rk,-3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.666666666666667962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.666666666666667962e-02_rk,-3.849001794597504966e-02_rk,3.849001794597504966e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.488033871712584666e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.488033871712584666e-01_rk,1.436467025586167789e-01_rk,-1.436467025586167789e-01_rk  &
                                        /),(/8,4/))

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad2
        !
        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.154700538379252017e-01_rk,-1.821367205045918147e-01_rk,-1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.154700538379252017e-01_rk,1.821367205045918147e-01_rk,-1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,-1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.452994616207487599e-02_rk,-4.880338717125847631e-02_rk,4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,-2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.452994616207487599e-02_rk,4.880338717125847631e-02_rk,4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,2.817664872069161608e-02_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.154700538379252017e-01_rk,1.821367205045918147e-01_rk,1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,-1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.154700538379252017e-01_rk,-1.821367205045918147e-01_rk,1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.452994616207487599e-02_rk,4.880338717125847631e-02_rk,-4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.452994616207487599e-02_rk,-4.880338717125847631e-02_rk,-4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,-2.817664872069161608e-02_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.452994616207487599e-02_rk,-4.880338717125847631e-02_rk,-4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.452994616207487599e-02_rk,4.880338717125847631e-02_rk,-4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,-2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.154700538379252017e-01_rk,-1.821367205045918147e-01_rk,1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,-1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.154700538379252017e-01_rk,1.821367205045918147e-01_rk,1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,1.051566846126417154e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.452994616207487599e-02_rk,4.880338717125847631e-02_rk,4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,-2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.452994616207487599e-02_rk,-4.880338717125847631e-02_rk,4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.154700538379252017e-01_rk,1.821367205045918147e-01_rk,-1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.154700538379252017e-01_rk,-1.821367205045918147e-01_rk,-1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,-1.051566846126417154e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk  &
                                        /),(/8,4/))

        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk  &
                                        /),(/8,4/))


        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad3
        !
        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.154700538379252017e-01_rk,-1.821367205045918147e-01_rk,-1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.452994616207487599e-02_rk,4.880338717125847631e-02_rk,-4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,-2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.154700538379252017e-01_rk,-1.821367205045918147e-01_rk,1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,-1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.452994616207487599e-02_rk,4.880338717125847631e-02_rk,4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,2.817664872069161608e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.452994616207487599e-02_rk,-4.880338717125847631e-02_rk,-4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.154700538379252017e-01_rk,1.821367205045918147e-01_rk,-1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,-1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.452994616207487599e-02_rk,-4.880338717125847631e-02_rk,4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,-2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.154700538379252017e-01_rk,1.821367205045918147e-01_rk,1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,1.051566846126417154e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189625731e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.154700538379252017e-01_rk,1.821367205045918147e-01_rk,1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,-1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.452994616207487599e-02_rk,-4.880338717125847631e-02_rk,4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.154700538379252017e-01_rk,1.821367205045918147e-01_rk,-1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.452994616207487599e-02_rk,-4.880338717125847631e-02_rk,-4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,-2.817664872069161608e-02_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.452994616207487599e-02_rk,4.880338717125847631e-02_rk,4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,-2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.154700538379252017e-01_rk,-1.821367205045918147e-01_rk,1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,1.051566846126417154e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.452994616207487599e-02_rk,4.880338717125847631e-02_rk,-4.880338717125847631e-02_rk,0.000000000000000000e+00_rk,2.817664872069161608e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.154700538379252017e-01_rk,-1.821367205045918147e-01_rk,-1.821367205045918147e-01_rk,0.000000000000000000e+00_rk,-1.051566846126417154e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,9.106836025229589904e-01_rk,-9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,-2.440169358562924440e-01_rk,2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk  &
                                        /),(/8,4/))

        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103742689e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103742689e-01_rk,2.440169358562924440e-01_rk,-2.440169358562924440e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189625731e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189625731e+00_rk,-9.106836025229589904e-01_rk,9.106836025229589904e-01_rk  &
                                        /),(/8,4/))


        
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_face_dgrad_dx_ximin
    !*******************************************************************************************








    !>  Test that the derivatives of the scaled normal vectors have been computed correctly. These are really
    !!  unit vectors scaled by the inverse jacobian of the face metric terms. Essentially,
    !!  an area scaling.
    !!
    !!  @author Matteo Ugolotti
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testelement_face_dnormals_dx(self)
        class(test_element_lineara_dx),    intent(inout)   :: self

        real(rk), dimension(3,self%faces(XI_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dnorm_dx
        integer(ik) :: inode_diff, idir, irow
        real(rk)    :: tol = 1.e-14_rk
        real(rk)    :: mat(4,3)
        
        
        ! xi_min
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, -5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, -1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))


        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        ! xi_max
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, -5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, -1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))





        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        ! eta_min
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))


        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        ! eta_max
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        5.283121635129678362e-02_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        1.971687836487032164e-01_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))


        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! zeta_min
        !
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))



        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! zeta_max
        !
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        1.971687836487032164e-01_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.858439182435161374e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.971687836487032164e-01_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, 9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -5.283121635129678362e-02_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129678362e-02_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487032164e-01_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.283121635129678362e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.971687836487032164e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.858439182435161374e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.641560817564838626e-01_rk  &
                                        /),(/3,4/))

        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        5.283121635129678362e-02_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129678362e-02_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -9.858439182435161374e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487032164e-01_rk, -2.641560817564838626e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))


        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do



    end subroutine testelement_face_dnormals_dx
    !*******************************************************************************************





!    !>  Test dmetric_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The dmetric_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_dmetric_dx_point(self)
!        class(test_element_lineara_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_dmetric_dx(:,:,:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [-1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_dmetric_dx = self%elem%dmetric_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_dmetric_dx,self%elem%dmetric_dx(:,:,1,:,:),tol)
!
!
!    end subroutine testelement_dmetric_dx_point
!    !*******************************************************************************************







!    !>  Test djinv_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The djinv_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_djinv_dx_point(self)
!        class(test_element_lineara_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_djinv_dx(:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_djinv_dx = self%elem%djinv_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_djinv_dx,self%elem%djinv_dx(2,:,:),tol)
!
!
!    end subroutine testelement_djinv_dx_point
!    !*******************************************************************************************







!    !>  Test h_index
!    !!
!    !!  Fortran search the minimum x, y and z coordinate among all the support nodes.
!    !!  If multiple minimum are found, fortran returns the location of the first minimum starting 
!    !!  from the first minimum found (ie. first location in connectivity vector).
!    !!
!    !!  In this case, for instance for x direction, there exists 4 minima. However, the one stored
!    !!  for dX differentiation (needed for artificial viscosity) will be node 1, since it comes first
!    !!
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_h_index(self)
!        class(test_element_lineara_dx),    intent(inout)   :: self
!
!        integer(ik) :: x_min, x_max, y_min, y_max, z_min, z_max
!        
!        x_min = 1
!        x_max = 2
!        y_min = 1
!        y_max = 3
!        z_min = 1
!        z_max = 5
!
!
!        ! Test
!        @assertequal(x_min,self%elem%h_index(1,1))
!        @assertequal(x_max,self%elem%h_index(1,2))
!        @assertequal(y_min,self%elem%h_index(2,1))
!        @assertequal(y_max,self%elem%h_index(2,2))
!        @assertequal(z_min,self%elem%h_index(3,1))
!        @assertequal(z_max,self%elem%h_index(3,2))
!
!
!    end subroutine testelement_h_index
!    !*******************************************************************************************









!####################################################
!
!   PYTHON SCRIPT FOR TESTING ELEMENT DX INITIALIZATION
!
!       This requires PyTORCH. For installation refer to
!       https://pytorch.org/get-started/locally/
!
!####################################################


!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!
!
!
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data  = [[ 1.0,   0.0,       0.0],
!                [ 2.0,   0.0,       0.0],
!                [ 1.0,   np.pi/2.0, 0.0],
!                [ 2.0,   np.pi/2.0, 0.0],
!                [ 1.0,   0.0,       1.0],
!                [ 2.0,   0.0,       1.0],
!                [ 1.0,   np.pi/2.0, 1.0],
!                [ 2.0,   np.pi/2.0, 1.0],
!                ]
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_elem  = 8 
!nnodes_face  = 4 
!nterms_s   = 8
!ndirs      = 3
!coord_sys  = 'CYLINDRICAL'
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              ] 
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              ]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                ]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_elem-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_elem):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_elem-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_elem, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_elem))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_elem*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_elem*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_elem))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            for irow in range(0,3):
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_elem*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    i += 1
!            np.savetxt(f,array)
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("xcoord interpolation, coord 1,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("ycoord interpolation, coord 2,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("zcoord interpolation, coord 3,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    array = np.zeros([nnodes_r,ndirs])
!    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_elem*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file           ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dinvmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file        ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_vol_dx
!#
!# 
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face1_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face2_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face3_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_face_dx
!#
!# 
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()









!
!####################################################
!#
!#   PYTHON SCRIPT FOR TESTING ELEMENT DX INITIALIZATION
!#
!#       This requires PyTORCH. For installation refer to
!#       https://pytorch.org/get-started/locally/
!#
!####################################################
!
!
!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data_A = [[0., 0., 0.],
!                 [5., 0., 0.],
!                 [5., 1., 0.],
!                 [0., 1., 0.],
!                 [0., 0., 1.],
!                 [5., 0., 1.],
!                 [5., 1., 1.],
!                 [0., 1., 1.]]
!
!sqrt_two     = np.sqrt(2.)
!inv_sqrt_two = 1./sqrt_two
!coords_data_B = [[0., 0., 0.],
!                 [inv_sqrt_two,inv_sqrt_two, 0.],
!                 [0., sqrt_two, 0.],
!                 [-inv_sqrt_two,inv_sqrt_two, 0.],
!                 [0., 0., 1.],
!                 [inv_sqrt_two,inv_sqrt_two, 1.],
!                 [0., sqrt_two, 1.],
!                 [-inv_sqrt_two,inv_sqrt_two, 1.]]
!
!coords_data_C = [[0., 0., 0.],
!                 [inv_sqrt_two, 0., inv_sqrt_two],
!                 [sqrt_two, 0., 0.],
!                 [inv_sqrt_two, 0., -inv_sqrt_two],
!                 [0., 1., 0.],
!                 [inv_sqrt_two, 1., inv_sqrt_two],
!                 [sqrt_two, 1., 0. ],
!                 [inv_sqrt_two, 1., -inv_sqrt_two]]
!
!coords_data_D  = [[ 1.0, 0.0,       0.0],
!                  [ 2.0, 0.0,       0.0],
!                  [ 2.0, np.pi/2.0, 0.0],
!                  [ 1.0, np.pi/2.0, 0.0],
!                  [ 1.0, 0.0,       1.0],
!                  [ 2.0, 0.0,       1.0],
!                  [ 2.0, np.pi/2.0, 1.0],
!                  [ 1.0, np.pi/2.0, 1.0]]
!
!coords_data = coords_data_A
!coord_sys  = 'CARTESIAN'
!
!#coords_data = coords_data_B
!#coord_sys  = 'CARTESIAN'
!
!#coords_data = coords_data_C
!#coord_sys  = 'CARTESIAN'
!
!#coords_data = coords_data_D
!#coord_sys  = 'CYLINDRICAL'
!
!
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_elem  = 8 
!nnodes_face  = 4 
!nterms_s   = 8
!ndirs      = 3
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0]]
!
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)]]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0]]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0]]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0]]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!                ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_elem-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_elem):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_elem-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_elem, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_elem))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_elem*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_elem*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_elem))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!#            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            f.write("test_dmetric_dx(:,:,"+str(inode+1)+","+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!            for irow in range(0,3):
!                row = ''
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_elem*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    row = row + str(array[irow,icol])+'_rk'
!                    if ((icol == 2) and (irow == 2)):
!                        row = row + '   &\n'
!                    elif ((icol == 2) and (irow != 2)):
!                        row = row + "," +  "   &\n"
!                    else:
!                        row = row + ', '
!                    i += 1
!                f.write(row)
!            f.write("/),(/3,3/))\n")
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!
!    f.write("test_djinv_dx("+str(inode+1)+",:,:) = reshape((/ &\n")
!    array = np.zeros([nnodes_r,ndirs])
!#    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        row = ''
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_elem*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!
!                row = row + str(array[inode_diff,idir])+'_rk'
!                if ((idir == ndirs-1) and (inode_diff == nnodes_r-1)):
!                    row = row + '   &\n'
!                elif ((idir == ndirs-1) and (inode_diff != nnodes_r-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!
!        f.write(row)
!    f.write("/),(/3,8/))\n")
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dmass_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nterms_s-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nterms_s-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dinvmass_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nterms_s-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nterms_s-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!#
!# dbr2_vol_dx
!#
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face1_dx to file          ", i/(nnodes_r*ndirs*nnodes_elem*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dbr2_vol_face3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face4_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face5_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face6_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!#
!# dbr2_face_dx
!#
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face4_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face5_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face6_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!











end module test_element_linearA_dx_mod

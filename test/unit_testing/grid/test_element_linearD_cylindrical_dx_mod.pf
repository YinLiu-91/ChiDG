module test_element_linearD_cylindrical_dx_mod
    use pfunit_mod
    use mod_kinds,                  only: rk,ik
    use mod_constants,              only: ZERO, ONE, TWO, THREE, FIVE, SIX, EIGHT, NINE, TEN, &
                                          XI_MIN, XI_MAX, ETA_MIN, ETA_MAX, ZETA_MIN, ZETA_MAX, PI
    use mod_chidg_mpi,              only: IRANK
    use type_chidg,                 only: chidg_t
    use type_element,               only: element_t
    use type_face,                  only: face_t
    use type_element_connectivity,  only: element_connectivity_t
    use mod_io,                     only: gq_rule
    use type_point,                 only: point_t


    use mod_inv,                    only: inv
    implicit none

    public  :: test_element_linearD_dx


    !>
    !!
    !!  @author Matteo Ugolotti
    !!  @date   10/4/2018
    !!
    !!  This test is build based on test_element_linearD test case.
    !!  The standard initialization is not tested here but the dx initialization 
    !!  is verified.
    !!
    !!  Symbolic pyhton solution is used to check ChiDG matrices.
    !!  The python script is available at the end of this module.
    !!  The input matrices used in the test herein are given by the
    !!  python script
    !!
    !!
    !--------------------------------------------------------------------------
    @TestCase
    type, extends(TestCase) ::  test_element_linearD_dx

        type(chidg_t)               :: chidg
        type(element_t)             :: elem
        type(face_t),   allocatable :: faces(:)
        real(rk),       allocatable :: nodes(:,:)

    contains

        procedure   ::  setUp
        procedure   ::  tearDown

    end type test_element_linearD_dx
    !***************************************************************************


contains

    !> NOTE: make sure to use 'this' instead of 'self' since these are over-writting a 
    !! derived type procedure. The argument names have to match
    !!
    !!  @author Matteo Ugolotti
    !!
    !!
    !-----------------------------------------------------------------------------------------
    subroutine setUp(this)
        class(test_element_linearD_dx),    intent(inout)   :: this
        
        integer(ik), parameter          :: npt = 8
        real(rk)                        :: nodes(npt,3)
        integer(ik)                     :: ftype, ielem, idomain,                           &
                                           ntime, nfields, nterms_s,                        &
                                           dof_start, dof_local_start,                      &
                                           xdof_start, xdof_local_start,                    &
                                           ineighbor_domain_g,  ineighbor_domain_l,         &
                                           ineighbor_element_g, ineighbor_element_l,        &
                                           ineighbor_face, ineighbor_proc,                  &
                                           ineighbor_nfields, ineighbor_nterms_s,           &
                                           ineighbor_nterms_c, ineighbor_nnodes_r,          &
                                           ineighbor_ntime,                                 &
                                           ineighbor_dof_start, ineighbor_dof_local_start,  &
                                           ineighbor_xdof_start, ineighbor_xdof_local_start
        

        ! Set collocation quadrature for testing coordinates at quadrature nodes
        gq_rule = 1
        
        
        call this%chidg%start_up('core')
        allocate(this%faces(6))
        
        ! !( r = 1-2  ::  theta = 0-pi/2  ::  z = 0-1 )
        !
        ! ( theta = 0-pi/2  ::  r = 1-2  ::  z = 0-1 )
        !           
        !                           theta
        !                           ---_
        !                               >
        !          _-------_ _------_
        !        _-         -_       -_
        !       -             -        -
        !      *              *--------*     ^ r
        !       \   _----_   /        /     /  
        !        \ -      - /        /     /
        !         *        *--------*
        !
        !                    ----> z
        !
        nodes(1,:) = [1._rk, 0._rk,  0._rk]
        nodes(2,:) = [2._rk, 0._rk,  0._rk]
        nodes(3,:) = [2._rk, PI/TWO, 0._rk]
        nodes(4,:) = [1._rk, PI/TWO, 0._rk]
        nodes(5,:) = [1._rk, 0._rk,  1._rk]
        nodes(6,:) = [2._rk, 0._rk,  1._rk]
        nodes(7,:) = [2._rk, PI/TWO, 1._rk]
        nodes(8,:) = [1._rk, PI/TWO, 1._rk]
        this%nodes = nodes

        
        !
        ! Initialize Element geometry and Numerics
        !
        idomain         = 1
        ielem           = 1
        nfields         = 2
        nterms_s        = 8
        ntime           = 1
        dof_start       = 1
        dof_local_start = 1
        xdof_start       = 1
        xdof_local_start = 1
        call this%elem%init_geom(nodes        = nodes,                              &
                                 connectivity = [1, 2, 3, 4, 5, 6, 7, 8],           &
                                 etype        = 1,                                  &
                                 location     = [idomain,idomain,ielem,ielem,IRANK],&
                                 coord_system = 'Cylindrical')
        call this%elem%init_sol('Quadrature',1,nterms_s,nfields,ntime,dof_start,dof_local_start,xdof_start,xdof_local_start)
        call this%elem%update_interpolations_dx()
        
        
        !
        ! Initialize face geometries
        !
        call this%faces(XI_MIN)%init_geom(XI_MIN,this%elem)
        call this%faces(XI_MAX)%init_geom(XI_MAX,this%elem)
        call this%faces(ETA_MIN)%init_geom(ETA_MIN,this%elem)
        call this%faces(ETA_MAX)%init_geom(ETA_MAX,this%elem)
        call this%faces(ZETA_MIN)%init_geom(ZETA_MIN,this%elem)
        call this%faces(ZETA_MAX)%init_geom(ZETA_MAX,this%elem)


        !
        ! Initialize face neighbors
        !
        ftype = 0
        ineighbor_domain_g        = 0
        ineighbor_domain_l        = 0
        ineighbor_element_g       = 0
        ineighbor_element_l       = 0
        ineighbor_face            = 0
        ineighbor_nfields         = 2
        ineighbor_nterms_s        = 8
        ineighbor_nterms_c        = 8
        ineighbor_proc            = 0
        ineighbor_dof_start       = 1
        ineighbor_dof_local_start = 1
        ineighbor_xdof_start       = 1
        ineighbor_xdof_local_start = 1
        call this%faces(XI_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,               &
                                                   ineighbor_element_g,ineighbor_element_l,             &
                                                   ineighbor_face,ineighbor_nfields,ineighbor_ntime,    &
                                                   ineighbor_nterms_s,ineighbor_nterms_c,               &
                                                   ineighbor_proc,                                      &
                                                   ineighbor_dof_start,ineighbor_dof_local_start,       &
                                                   ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(XI_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,               &
                                                   ineighbor_element_g,ineighbor_element_l,             &
                                                   ineighbor_face,ineighbor_nfields,ineighbor_ntime,    &
                                                   ineighbor_nterms_s,ineighbor_nterms_c,               &
                                                   ineighbor_proc,                                      &
                                                   ineighbor_dof_start,ineighbor_dof_local_start,       &
                                                   ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,              &
                                                    ineighbor_element_g,ineighbor_element_l,            &
                                                    ineighbor_face,ineighbor_nfields,ineighbor_ntime,   &
                                                    ineighbor_nterms_s,ineighbor_nterms_c,              &
                                                    ineighbor_proc,                                     &
                                                    ineighbor_dof_start,ineighbor_dof_local_start,      &
                                                    ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,              &
                                                    ineighbor_element_g,ineighbor_element_l,            &
                                                    ineighbor_face,ineighbor_nfields,ineighbor_ntime,   &
                                                    ineighbor_nterms_s,ineighbor_nterms_c,              &
                                                    ineighbor_proc,                                     &
                                                    ineighbor_dof_start,ineighbor_dof_local_start,      &
                                                    ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ZETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                                    &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,     &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)
        call this%faces(ZETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                                    &
                                                     ineighbor_dof_start,ineighbor_dof_local_start,     &
                                                     ineighbor_xdof_start,ineighbor_xdof_local_start)


        call this%faces(XI_MIN)%init_sol(this%elem)
        call this%faces(XI_MAX)%init_sol(this%elem)
        call this%faces(ETA_MIN)%init_sol(this%elem)
        call this%faces(ETA_MAX)%init_sol(this%elem)
        call this%faces(ZETA_MIN)%init_sol(this%elem)
        call this%faces(ZETA_MAX)%init_sol(this%elem)

        !
        ! Update dx interpolators
        !
        call this%faces(XI_MIN)%update_interpolations_dx(this%elem)
        call this%faces(XI_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MAX)%update_interpolations_dx(this%elem)        


    end subroutine setUp
    !************************************************************************************
    

    !>
    !!
    !!
    !-------------------------------------------------------------------------------------
    subroutine tearDown(this)
        class(test_element_linearD_dx),    intent(inout)   :: this


        !
        ! Close ChiDG interface
        !
        call this%chidg%shut_down('core')

    end subroutine tearDown
    !**************************************************************************************



    
    
    !> Test element djinv_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_djinv_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self

        integer(ik) :: inode, inode_diff, idir, irow
        real(rk)    :: test_djinv_dx(8,3,8), test_djinv_dx_trans(8,3)


        test_djinv_dx(1,:,:) = reshape((/ &
        -0.05161866685233347_rk, -0.09418179046174355_rk, -0.1479404105082734_rk,   &
        0.17374974393444012_rk, -0.0252359346959414_rk, -0.039640513523620635_rk,   &
        0.046556103572347594_rk, 0.0252359346959414_rk, -0.01062164358620915_rk,   &
        -0.013831180097453911_rk, 0.09418179046174355_rk, -0.039640513523620635_rk,   &
        -0.013831180097453911_rk, -0.025235934695941407_rk, 0.1479404105082734_rk,   &
        0.046556103572347594_rk, -0.006761948322022048_rk, 0.039640513523620635_rk,   &
        0.012474670354950252_rk, 0.006761948322022048_rk, 0.01062164358620915_rk,   &
        -0.0037060535374821898_rk, 0.025235934695941407_rk, 0.039640513523620635_rk   &
        /),(/3,8/))
        test_djinv_dx(2,:,:) = reshape((/ &
        -0.19264348731187989_rk, -0.037264065304058604_rk, -0.0585342569010604_rk,   &
        0.31477456439398654_rk, -0.13907138501131128_rk, -0.21845282073804662_rk,   &
        0.08434359032722712_rk, 0.13907138501131128_rk, -0.058534256901060414_rk,   &
        -0.05161866685233345_rk, 0.037264065304058604_rk, -0.01568420686619501_rk,   &
        -0.05161866685233345_rk, -0.009984876204923117_rk, 0.0585342569010604_rk,   &
        0.08434359032722712_rk, -0.03726406530405861_rk, 0.21845282073804662_rk,   &
        0.02259979691492197_rk, 0.03726406530405861_rk, 0.058534256901060414_rk,   &
        -0.013831180097453911_rk, 0.009984876204923117_rk, 0.01568420686619501_rk   &
        /),(/3,8/))
        test_djinv_dx(3,:,:) = reshape((/ &
        -0.013831180097453911_rk, -0.09418179046174355_rk, -0.039640513523620635_rk,   &
        0.046556103572347594_rk, -0.0252359346959414_rk, -0.01062164358620915_rk,   &
        0.17374974393444012_rk, 0.0252359346959414_rk, -0.039640513523620635_rk,   &
        -0.05161866685233347_rk, 0.09418179046174355_rk, -0.1479404105082734_rk,   &
        -0.0037060535374821898_rk, -0.025235934695941407_rk, 0.039640513523620635_rk,   &
        0.012474670354950252_rk, -0.006761948322022048_rk, 0.01062164358620915_rk,   &
        0.046556103572347594_rk, 0.006761948322022048_rk, 0.039640513523620635_rk,   &
        -0.013831180097453911_rk, 0.025235934695941407_rk, 0.1479404105082734_rk   &
        /),(/3,8/))
        test_djinv_dx(4,:,:) = reshape((/ &
        -0.05161866685233345_rk, -0.037264065304058604_rk, -0.01568420686619501_rk,   &
        0.08434359032722712_rk, -0.13907138501131128_rk, -0.058534256901060414_rk,   &
        0.31477456439398654_rk, 0.13907138501131128_rk, -0.21845282073804662_rk,   &
        -0.19264348731187989_rk, 0.037264065304058604_rk, -0.0585342569010604_rk,   &
        -0.013831180097453911_rk, -0.009984876204923117_rk, 0.01568420686619501_rk,   &
        0.02259979691492197_rk, -0.03726406530405861_rk, 0.058534256901060414_rk,   &
        0.08434359032722712_rk, 0.03726406530405861_rk, 0.21845282073804662_rk,   &
        -0.05161866685233345_rk, 0.009984876204923117_rk, 0.0585342569010604_rk   &
        /),(/3,8/))
        test_djinv_dx(5,:,:) = reshape((/ &
        -0.013831180097453911_rk, -0.025235934695941407_rk, -0.1479404105082734_rk,   &
        0.046556103572347594_rk, -0.006761948322022048_rk, -0.039640513523620635_rk,   &
        0.012474670354950252_rk, 0.006761948322022048_rk, -0.01062164358620915_rk,   &
        -0.0037060535374821898_rk, 0.025235934695941407_rk, -0.039640513523620635_rk,   &
        -0.05161866685233347_rk, -0.09418179046174355_rk, 0.1479404105082734_rk,   &
        0.17374974393444012_rk, -0.0252359346959414_rk, 0.039640513523620635_rk,   &
        0.046556103572347594_rk, 0.0252359346959414_rk, 0.01062164358620915_rk,   &
        -0.013831180097453911_rk, 0.09418179046174355_rk, 0.039640513523620635_rk   &
        /),(/3,8/))
        test_djinv_dx(6,:,:) = reshape((/ &
        -0.05161866685233345_rk, -0.009984876204923117_rk, -0.0585342569010604_rk,   &
        0.08434359032722712_rk, -0.03726406530405861_rk, -0.21845282073804662_rk,   &
        0.02259979691492197_rk, 0.03726406530405861_rk, -0.058534256901060414_rk,   &
        -0.013831180097453911_rk, 0.009984876204923117_rk, -0.01568420686619501_rk,   &
        -0.19264348731187989_rk, -0.037264065304058604_rk, 0.0585342569010604_rk,   &
        0.31477456439398654_rk, -0.13907138501131128_rk, 0.21845282073804662_rk,   &
        0.08434359032722712_rk, 0.13907138501131128_rk, 0.058534256901060414_rk,   &
        -0.05161866685233345_rk, 0.037264065304058604_rk, 0.01568420686619501_rk   &
        /),(/3,8/))
        test_djinv_dx(7,:,:) = reshape((/ &
        -0.0037060535374821898_rk, -0.025235934695941407_rk, -0.039640513523620635_rk,   &
        0.012474670354950252_rk, -0.006761948322022048_rk, -0.01062164358620915_rk,   &
        0.046556103572347594_rk, 0.006761948322022048_rk, -0.039640513523620635_rk,   &
        -0.013831180097453911_rk, 0.025235934695941407_rk, -0.1479404105082734_rk,   &
        -0.013831180097453911_rk, -0.09418179046174355_rk, 0.039640513523620635_rk,   &
        0.046556103572347594_rk, -0.0252359346959414_rk, 0.01062164358620915_rk,   &
        0.17374974393444012_rk, 0.0252359346959414_rk, 0.039640513523620635_rk,   &
        -0.05161866685233347_rk, 0.09418179046174355_rk, 0.1479404105082734_rk   &
        /),(/3,8/))
        test_djinv_dx(8,:,:) = reshape((/ &
        -0.013831180097453911_rk, -0.009984876204923117_rk, -0.01568420686619501_rk,   &
        0.02259979691492197_rk, -0.03726406530405861_rk, -0.058534256901060414_rk,   &
        0.08434359032722712_rk, 0.03726406530405861_rk, -0.21845282073804662_rk,   &
        -0.05161866685233345_rk, 0.009984876204923117_rk, -0.0585342569010604_rk,   &
        -0.05161866685233345_rk, -0.037264065304058604_rk, 0.01568420686619501_rk,   &
        0.08434359032722712_rk, -0.13907138501131128_rk, 0.058534256901060414_rk,   &
        0.31477456439398654_rk, 0.13907138501131128_rk, 0.21845282073804662_rk,   &
        -0.19264348731187989_rk, 0.037264065304058604_rk, 0.0585342569010604_rk   &
        /),(/3,8/))


        do inode = 1,self%elem%basis_s%nnodes_elem()
            @assertEqual(transpose(test_djinv_dx(inode,:,:)),self%elem%djinv_dx(inode,:,:), 1.e-14_rk)
        end do
        
    end subroutine testElement_djinv_dx
    !***************************************************************************************





    !> Test element dmetric_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmetric_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self

        real(rk)    :: test_metric(3,3,self%elem%basis_s%nnodes_elem())
        real(rk)    :: test_dmetric_dx(3,3,8,8,3), test_dmetric_dx_trans(3,3)
        integer(ik) :: inode, inode_diff, idir, irow
        
        test_dmetric_dx(:,:,1,1,1) = reshape((/ &
        1.2440169358562925_rk, 0.6538013056153495_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.42568005283369637_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.7919657785262487_rk, 0.4162228383544712_rk, 0.7919657785262487_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        1.2440169358562925_rk, 0.6538013056153495_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,1) = reshape((/ &
        -1.2440169358562925_rk, 0.17518553185004657_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.7919657785262487_rk, 0.1115265734084703_rk, 0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -1.2440169358562925_rk, 0.17518553185004657_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,1) = reshape((/ &
        -0.33333333333333337_rk, -0.17518553185004657_rk, 0.08931639747704093_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.21220659078919377_rk, -0.1115265734084703_rk, 0.056860584630526206_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, -0.17518553185004657_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,1) = reshape((/ &
        0.33333333333333337_rk, -0.6538013056153495_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.21220659078919377_rk, -0.4162228383544712_rk, 0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, -0.6538013056153495_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,1) = reshape((/ &
        0.33333333333333337_rk, 0.17518553185004662_rk, -1.2440169358562925_rk,   &
        0.0_rk, -0.11406062639082654_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.21220659078919377_rk, 0.11152657340847033_rk, -0.7919657785262487_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, 0.17518553185004662_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,1) = reshape((/ &
        -0.33333333333333337_rk, 0.04694082178483669_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.21220659078919377_rk, 0.02988345527940995_rk, -0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, 0.04694082178483669_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,1) = reshape((/ &
        -0.08931639747704093_rk, -0.04694082178483669_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.008189184527613348_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.056860584630526206_rk, -0.02988345527940995_rk, -0.056860584630526206_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.08931639747704093_rk, -0.04694082178483669_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,1) = reshape((/ &
        0.08931639747704093_rk, -0.17518553185004662_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.056860584630526206_rk, -0.11152657340847033_rk, -0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,1,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.08931639747704093_rk, -0.17518553185004662_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,1) = reshape((/ &
        1.2440169358562925_rk, 0.11863897847345253_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.7919657785262488_rk, 0.07552791946969173_rk, 0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        1.2440169358562925_rk, 0.11863897847345253_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,1) = reshape((/ &
        -1.2440169358562925_rk, 0.4427666954209951_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.19522778415788597_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.7919657785262488_rk, 0.2818740328508601_rk, 0.7919657785262488_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -1.2440169358562925_rk, 0.4427666954209951_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,1) = reshape((/ &
        -0.33333333333333337_rk, -0.4427666954209951_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.2122065907891938_rk, -0.2818740328508601_rk, 0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, -0.4427666954209951_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,1) = reshape((/ &
        0.33333333333333337_rk, -0.11863897847345253_rk, 0.08931639747704093_rk,   &
        0.0_rk, -0.01401672426300634_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.2122065907891938_rk, -0.07552791946969173_rk, 0.056860584630526234_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, -0.11863897847345253_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,1) = reshape((/ &
        0.33333333333333337_rk, 0.03178921847281497_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.014016724263006337_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.2122065907891938_rk, 0.020237645027906787_rk, -0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, 0.03178921847281497_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,1) = reshape((/ &
        -0.33333333333333337_rk, 0.1186389784734525_rk, -1.2440169358562925_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.2122065907891938_rk, 0.07552791946969171_rk, -0.7919657785262488_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, 0.1186389784734525_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,1) = reshape((/ &
        -0.08931639747704093_rk, -0.1186389784734525_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.014016724263006344_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.056860584630526234_rk, -0.07552791946969171_rk, -0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.08931639747704093_rk, -0.1186389784734525_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,1) = reshape((/ &
        0.08931639747704093_rk, -0.03178921847281497_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.003755769946802278_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.056860584630526234_rk, -0.020237645027906787_rk, -0.056860584630526234_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,2,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.08931639747704093_rk, -0.03178921847281497_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,1) = reshape((/ &
        0.33333333333333337_rk, 0.6538013056153495_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.21220659078919377_rk, 0.4162228383544712_rk, 0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, 0.6538013056153495_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,1) = reshape((/ &
        -0.33333333333333337_rk, 0.17518553185004657_rk, 0.08931639747704093_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.21220659078919377_rk, 0.1115265734084703_rk, 0.056860584630526206_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, 0.17518553185004657_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,1) = reshape((/ &
        -1.2440169358562925_rk, -0.17518553185004657_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.7919657785262487_rk, -0.1115265734084703_rk, 0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -1.2440169358562925_rk, -0.17518553185004657_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,1) = reshape((/ &
        1.2440169358562925_rk, -0.6538013056153495_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.42568005283369637_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.7919657785262487_rk, -0.4162228383544712_rk, 0.7919657785262487_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        1.2440169358562925_rk, -0.6538013056153495_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,1) = reshape((/ &
        0.08931639747704093_rk, 0.17518553185004662_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.056860584630526206_rk, 0.11152657340847033_rk, -0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.08931639747704093_rk, 0.17518553185004662_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,1) = reshape((/ &
        -0.08931639747704093_rk, 0.04694082178483669_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.008189184527613348_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.056860584630526206_rk, 0.02988345527940995_rk, -0.056860584630526206_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.08931639747704093_rk, 0.04694082178483669_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,1) = reshape((/ &
        -0.33333333333333337_rk, -0.04694082178483669_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.21220659078919377_rk, -0.02988345527940995_rk, -0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, -0.04694082178483669_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,1) = reshape((/ &
        0.33333333333333337_rk, -0.17518553185004662_rk, -1.2440169358562925_rk,   &
        0.0_rk, -0.11406062639082654_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.21220659078919377_rk, -0.11152657340847033_rk, -0.7919657785262487_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,3,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, -0.17518553185004662_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,1) = reshape((/ &
        0.33333333333333337_rk, 0.11863897847345253_rk, 0.08931639747704093_rk,   &
        0.0_rk, -0.01401672426300634_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.2122065907891938_rk, 0.07552791946969173_rk, 0.056860584630526234_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, 0.11863897847345253_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,1) = reshape((/ &
        -0.33333333333333337_rk, 0.4427666954209951_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.2122065907891938_rk, 0.2818740328508601_rk, 0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, 0.4427666954209951_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,1) = reshape((/ &
        -1.2440169358562925_rk, -0.4427666954209951_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.19522778415788597_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.7919657785262488_rk, -0.2818740328508601_rk, 0.7919657785262488_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -1.2440169358562925_rk, -0.4427666954209951_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,1) = reshape((/ &
        1.2440169358562925_rk, -0.11863897847345253_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.7919657785262488_rk, -0.07552791946969173_rk, 0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        1.2440169358562925_rk, -0.11863897847345253_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,1) = reshape((/ &
        0.08931639747704093_rk, 0.03178921847281497_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.003755769946802278_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.056860584630526234_rk, 0.020237645027906787_rk, -0.056860584630526234_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.08931639747704093_rk, 0.03178921847281497_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,1) = reshape((/ &
        -0.08931639747704093_rk, 0.1186389784734525_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.014016724263006344_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.056860584630526234_rk, 0.07552791946969171_rk, -0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.08931639747704093_rk, 0.1186389784734525_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,1) = reshape((/ &
        -0.33333333333333337_rk, -0.1186389784734525_rk, -1.2440169358562925_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.2122065907891938_rk, -0.07552791946969171_rk, -0.7919657785262488_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, -0.1186389784734525_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,1) = reshape((/ &
        0.33333333333333337_rk, -0.03178921847281497_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.014016724263006337_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.2122065907891938_rk, -0.020237645027906787_rk, -0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,4,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, -0.03178921847281497_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,1) = reshape((/ &
        0.33333333333333337_rk, 0.17518553185004662_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.11406062639082654_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.21220659078919377_rk, 0.11152657340847033_rk, 0.7919657785262487_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, 0.17518553185004662_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,1) = reshape((/ &
        -0.33333333333333337_rk, 0.04694082178483669_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.21220659078919377_rk, 0.02988345527940995_rk, 0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, 0.04694082178483669_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,1) = reshape((/ &
        -0.08931639747704093_rk, -0.04694082178483669_rk, 0.08931639747704093_rk,   &
        0.0_rk, -0.008189184527613348_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.056860584630526206_rk, -0.02988345527940995_rk, 0.056860584630526206_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.08931639747704093_rk, -0.04694082178483669_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,1) = reshape((/ &
        0.08931639747704093_rk, -0.17518553185004662_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.056860584630526206_rk, -0.11152657340847033_rk, 0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.08931639747704093_rk, -0.17518553185004662_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,1) = reshape((/ &
        1.2440169358562925_rk, 0.6538013056153495_rk, -1.2440169358562925_rk,   &
        0.0_rk, -0.42568005283369637_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.7919657785262487_rk, 0.4162228383544712_rk, -0.7919657785262487_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        1.2440169358562925_rk, 0.6538013056153495_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,1) = reshape((/ &
        -1.2440169358562925_rk, 0.17518553185004657_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.7919657785262487_rk, 0.1115265734084703_rk, -0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -1.2440169358562925_rk, 0.17518553185004657_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,1) = reshape((/ &
        -0.33333333333333337_rk, -0.17518553185004657_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.21220659078919377_rk, -0.1115265734084703_rk, -0.056860584630526206_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, -0.17518553185004657_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,1) = reshape((/ &
        0.33333333333333337_rk, -0.6538013056153495_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.21220659078919377_rk, -0.4162228383544712_rk, -0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,5,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, -0.6538013056153495_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,1) = reshape((/ &
        0.33333333333333337_rk, 0.03178921847281497_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.014016724263006337_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.2122065907891938_rk, 0.020237645027906787_rk, 0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, 0.03178921847281497_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,1) = reshape((/ &
        -0.33333333333333337_rk, 0.1186389784734525_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.2122065907891938_rk, 0.07552791946969171_rk, 0.7919657785262488_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, 0.1186389784734525_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,1) = reshape((/ &
        -0.08931639747704093_rk, -0.1186389784734525_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.014016724263006344_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.056860584630526234_rk, -0.07552791946969171_rk, 0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.08931639747704093_rk, -0.1186389784734525_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,1) = reshape((/ &
        0.08931639747704093_rk, -0.03178921847281497_rk, 0.08931639747704093_rk,   &
        0.0_rk, -0.003755769946802278_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.056860584630526234_rk, -0.020237645027906787_rk, 0.056860584630526234_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.08931639747704093_rk, -0.03178921847281497_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,1) = reshape((/ &
        1.2440169358562925_rk, 0.11863897847345253_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.7919657785262488_rk, 0.07552791946969173_rk, -0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        1.2440169358562925_rk, 0.11863897847345253_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,1) = reshape((/ &
        -1.2440169358562925_rk, 0.4427666954209951_rk, -1.2440169358562925_rk,   &
        0.0_rk, -0.19522778415788597_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.7919657785262488_rk, 0.2818740328508601_rk, -0.7919657785262488_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -1.2440169358562925_rk, 0.4427666954209951_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,1) = reshape((/ &
        -0.33333333333333337_rk, -0.4427666954209951_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.2122065907891938_rk, -0.2818740328508601_rk, -0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, -0.4427666954209951_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,1) = reshape((/ &
        0.33333333333333337_rk, -0.11863897847345253_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.01401672426300634_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.2122065907891938_rk, -0.07552791946969173_rk, -0.056860584630526234_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,6,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, -0.11863897847345253_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,1) = reshape((/ &
        0.08931639747704093_rk, 0.17518553185004662_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.056860584630526206_rk, 0.11152657340847033_rk, 0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.08931639747704093_rk, 0.17518553185004662_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,1) = reshape((/ &
        -0.08931639747704093_rk, 0.04694082178483669_rk, 0.08931639747704093_rk,   &
        0.0_rk, -0.008189184527613348_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.056860584630526206_rk, 0.02988345527940995_rk, 0.056860584630526206_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.08931639747704093_rk, 0.04694082178483669_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,1) = reshape((/ &
        -0.33333333333333337_rk, -0.04694082178483669_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.21220659078919377_rk, -0.02988345527940995_rk, 0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, -0.04694082178483669_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,1) = reshape((/ &
        0.33333333333333337_rk, -0.17518553185004662_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.11406062639082654_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.21220659078919377_rk, -0.11152657340847033_rk, 0.7919657785262487_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, -0.17518553185004662_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,1) = reshape((/ &
        0.33333333333333337_rk, 0.6538013056153495_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.21220659078919377_rk, 0.4162228383544712_rk, -0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, 0.6538013056153495_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,1) = reshape((/ &
        -0.33333333333333337_rk, 0.17518553185004657_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.21220659078919377_rk, 0.1115265734084703_rk, -0.056860584630526206_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, 0.17518553185004657_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,1) = reshape((/ &
        -1.2440169358562925_rk, -0.17518553185004657_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.7919657785262487_rk, -0.1115265734084703_rk, -0.21220659078919377_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -1.2440169358562925_rk, -0.17518553185004657_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,1) = reshape((/ &
        1.2440169358562925_rk, -0.6538013056153495_rk, -1.2440169358562925_rk,   &
        0.0_rk, -0.42568005283369637_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.7919657785262487_rk, -0.4162228383544712_rk, -0.7919657785262487_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,7,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        1.2440169358562925_rk, -0.6538013056153495_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,1) = reshape((/ &
        0.08931639747704093_rk, 0.03178921847281497_rk, 0.08931639747704093_rk,   &
        0.0_rk, -0.003755769946802278_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.056860584630526234_rk, 0.020237645027906787_rk, 0.056860584630526234_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.08931639747704093_rk, 0.03178921847281497_rk, 0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,1) = reshape((/ &
        -0.08931639747704093_rk, 0.1186389784734525_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.014016724263006344_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.056860584630526234_rk, 0.07552791946969171_rk, 0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.08931639747704093_rk, 0.1186389784734525_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,1) = reshape((/ &
        -0.33333333333333337_rk, -0.1186389784734525_rk, 1.2440169358562925_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.2122065907891938_rk, -0.07552791946969171_rk, 0.7919657785262488_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, -0.1186389784734525_rk, 1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,1) = reshape((/ &
        0.33333333333333337_rk, -0.03178921847281497_rk, 0.33333333333333337_rk,   &
        0.0_rk, -0.014016724263006337_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.2122065907891938_rk, -0.020237645027906787_rk, 0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, -0.03178921847281497_rk, 0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,1) = reshape((/ &
        0.33333333333333337_rk, 0.11863897847345253_rk, -0.08931639747704093_rk,   &
        0.0_rk, -0.01401672426300634_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.2122065907891938_rk, 0.07552791946969173_rk, -0.056860584630526234_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.33333333333333337_rk, 0.11863897847345253_rk, -0.08931639747704093_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,1) = reshape((/ &
        -0.33333333333333337_rk, 0.4427666954209951_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.2122065907891938_rk, 0.2818740328508601_rk, -0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.33333333333333337_rk, 0.4427666954209951_rk, -0.33333333333333337_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,1) = reshape((/ &
        -1.2440169358562925_rk, -0.4427666954209951_rk, -1.2440169358562925_rk,   &
        0.0_rk, -0.19522778415788597_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -0.7919657785262488_rk, -0.2818740328508601_rk, -0.7919657785262488_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        -1.2440169358562925_rk, -0.4427666954209951_rk, -1.2440169358562925_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,1) = reshape((/ &
        1.2440169358562925_rk, -0.11863897847345253_rk, -0.33333333333333337_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,2) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.7919657785262488_rk, -0.07552791946969173_rk, -0.2122065907891938_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/3,3/))
        test_dmetric_dx(:,:,8,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk,   &
        1.2440169358562925_rk, -0.11863897847345253_rk, -0.33333333333333337_rk   &
        /),(/3,3/))


        do inode = 1,self%elem%basis_s%nnodes_elem()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx(:,:,inode,inode_diff,idir)),self%elem%dmetric_dx(:,:,inode,inode_diff,idir), 1.e-14_rk)
                end do
            end do
        end do 


    end subroutine testElement_dmetric_dx
    !***************************************************************************************





    !> Test cartesian dgrad1_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad1_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        test_dgrad1_dx(:,:,1,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,1,2) = reshape((/ &
        0.0_rk, 0.7919657785262487_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, 0.2639885928420829_rk,   &
        0.0_rk, 0.7919657785262488_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, -0.263988592842083_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, 0.056860584630526206_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, -0.018953528210175395_rk,   &
        0.0_rk, 0.056860584630526234_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, 0.018953528210175402_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,2) = reshape((/ &
        0.0_rk, -0.7919657785262487_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, -0.2639885928420829_rk,   &
        0.0_rk, -0.7919657785262488_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, 0.263988592842083_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, -0.056860584630526206_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, 0.018953528210175395_rk,   &
        0.0_rk, -0.056860584630526234_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, -0.018953528210175402_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,2) = reshape((/ &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, -0.7919657785262487_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, -0.2639885928420829_rk,   &
        0.0_rk, -0.7919657785262488_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, 0.263988592842083_rk,   &
        0.0_rk, -0.056860584630526206_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, 0.018953528210175395_rk,   &
        0.0_rk, -0.056860584630526234_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, -0.018953528210175402_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,2) = reshape((/ &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, 0.7919657785262487_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, 0.2639885928420829_rk,   &
        0.0_rk, 0.7919657785262488_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, -0.263988592842083_rk,   &
        0.0_rk, 0.056860584630526206_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, -0.018953528210175395_rk,   &
        0.0_rk, 0.056860584630526234_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, 0.018953528210175402_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,2) = reshape((/ &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, 0.056860584630526206_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, 0.018953528210175395_rk,   &
        0.0_rk, 0.056860584630526234_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, -0.018953528210175402_rk,   &
        0.0_rk, 0.7919657785262487_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, -0.2639885928420829_rk,   &
        0.0_rk, 0.7919657785262488_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, 0.263988592842083_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,2) = reshape((/ &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, -0.056860584630526206_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, -0.018953528210175395_rk,   &
        0.0_rk, -0.056860584630526234_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, 0.018953528210175402_rk,   &
        0.0_rk, -0.7919657785262487_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, 0.2639885928420829_rk,   &
        0.0_rk, -0.7919657785262488_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, -0.263988592842083_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,2) = reshape((/ &
        0.0_rk, -0.056860584630526206_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, -0.018953528210175395_rk,   &
        0.0_rk, -0.056860584630526234_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, 0.018953528210175402_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, -0.7919657785262487_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, 0.2639885928420829_rk,   &
        0.0_rk, -0.7919657785262488_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, -0.263988592842083_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,2) = reshape((/ &
        0.0_rk, 0.056860584630526206_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, 0.018953528210175395_rk,   &
        0.0_rk, 0.056860584630526234_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, -0.018953528210175402_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, 0.7919657785262487_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, -0.2639885928420829_rk,   &
        0.0_rk, 0.7919657785262488_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, 0.263988592842083_rk   &
        /),(/8,8/))
        test_dgrad1_dx(:,:,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk   &
        /),(/8,8/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%elem%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad1_dx
    !*******************************************************************************************






    !> Test cartesian dgrad2_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad2_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad2_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad2_dx
        ! 
        test_dgrad2_dx(:,:,1,1) = reshape((/ &
        0.0_rk, -0.42568005283369637_rk, 0.0_rk, 0.6538013056153495_rk, -0.13170586670136214_rk, -0.37747235979355087_rk, 0.24576649309218865_rk, 0.07604041759388439_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, 0.11863897847345253_rk, -0.09869808947384329_rk, -0.06849624615803003_rk, 0.030201843315813288_rk, 0.056983368526225216_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk, 0.6538013056153495_rk, 0.4433252931442319_rk, -0.37747235979355087_rk, 0.06585293335068106_rk, -0.255953977335392_rk,   &
        0.0_rk, -0.01401672426300634_rk, 0.0_rk, 0.11863897847345253_rk, 0.06040368663162656_rk, -0.06849624615803003_rk, 0.008092559526403469_rk, -0.03487408473681539_rk,   &
        0.0_rk, -0.11406062639082654_rk, 0.0_rk, 0.17518553185004662_rk, -0.035290480621071076_rk, 0.10114341397175214_rk, -0.06585293335068106_rk, -0.02037496848640665_rk,   &
        0.0_rk, -0.014016724263006337_rk, 0.0_rk, 0.03178921847281497_rk, -0.026446073369011024_rk, 0.01835351384260754_rk, -0.008092559526403472_rk, -0.015268647578607103_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, 0.17518553185004662_rk, 0.11878865428228769_rk, 0.10114341397175214_rk, -0.01764524031053554_rk, 0.06858266152655218_rk,   &
        0.0_rk, -0.003755769946802278_rk, 0.0_rk, 0.03178921847281497_rk, 0.016185119052806958_rk, 0.01835351384260754_rk, -0.002168394789800598_rk, 0.009344482842004221_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,1,2) = reshape((/ &
        0.0_rk, 0.4162228383544712_rk, 0.0_rk, 0.0_rk, -0.24030636776682412_rk, 0.0_rk, -0.24030636776682412_rk, 0.13874094611815707_rk,   &
        0.0_rk, 0.07552791946969173_rk, 0.0_rk, 0.0_rk, 0.0436060646371589_rk, 0.0_rk, -0.0436060646371589_rk, -0.025175973156563912_rk,   &
        0.0_rk, 0.4162228383544712_rk, 0.0_rk, 0.0_rk, -0.24030636776682412_rk, 0.0_rk, -0.24030636776682412_rk, 0.13874094611815707_rk,   &
        0.0_rk, 0.07552791946969173_rk, 0.0_rk, 0.0_rk, 0.0436060646371589_rk, 0.0_rk, -0.0436060646371589_rk, -0.025175973156563912_rk,   &
        0.0_rk, 0.11152657340847033_rk, 0.0_rk, 0.0_rk, -0.06438989717917688_rk, 0.0_rk, 0.06438989717917688_rk, -0.0371755244694901_rk,   &
        0.0_rk, 0.020237645027906787_rk, 0.0_rk, 0.0_rk, 0.011684209804626068_rk, 0.0_rk, 0.011684209804626068_rk, 0.006745881675968924_rk,   &
        0.0_rk, 0.11152657340847033_rk, 0.0_rk, 0.0_rk, -0.06438989717917688_rk, 0.0_rk, 0.06438989717917688_rk, -0.0371755244694901_rk,   &
        0.0_rk, 0.020237645027906787_rk, 0.0_rk, 0.0_rk, 0.011684209804626068_rk, 0.0_rk, 0.011684209804626068_rk, 0.006745881675968924_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.6538013056153495_rk, 0.0_rk, 0.0_rk, -0.37747235979355087_rk, -0.37747235979355087_rk, 0.21793376853844984_rk,   &
        0.0_rk, 0.0_rk, 0.11863897847345253_rk, 0.0_rk, 0.0_rk, 0.06849624615803003_rk, -0.06849624615803003_rk, -0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, 0.6538013056153495_rk, 0.0_rk, 0.0_rk, -0.37747235979355087_rk, 0.37747235979355087_rk, -0.21793376853844984_rk,   &
        0.0_rk, 0.0_rk, 0.11863897847345253_rk, 0.0_rk, 0.0_rk, 0.06849624615803003_rk, 0.06849624615803003_rk, 0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, 0.17518553185004662_rk, 0.0_rk, 0.0_rk, -0.10114341397175214_rk, -0.10114341397175214_rk, 0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, 0.03178921847281497_rk, 0.0_rk, 0.0_rk, 0.01835351384260754_rk, -0.01835351384260754_rk, -0.01059640615760498_rk,   &
        0.0_rk, 0.0_rk, 0.17518553185004662_rk, 0.0_rk, 0.0_rk, -0.10114341397175214_rk, 0.10114341397175214_rk, -0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, 0.03178921847281497_rk, 0.0_rk, 0.0_rk, 0.01835351384260754_rk, 0.01835351384260754_rk, 0.01059640615760498_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,1) = reshape((/ &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk, 0.17518553185004657_rk, -0.03529048062107109_rk, -0.10114341397175214_rk, 0.06585293335068106_rk, 0.02037496848640665_rk,   &
        0.0_rk, -0.19522778415788597_rk, 0.0_rk, 0.4427666954209951_rk, -0.3683462845263622_rk, -0.25563147078951254_rk, 0.11271481373684966_rk, 0.21266482652629373_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, 0.17518553185004657_rk, 0.11878865428228769_rk, -0.10114341397175214_rk, 0.01764524031053554_rk, -0.06858266152655218_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, 0.4427666954209951_rk, 0.22542962747369927_rk, -0.25563147078951254_rk, 0.030201843315813288_rk, -0.13015185610525737_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, 0.04694082178483669_rk, -0.009456055782922183_rk, 0.02710129609345774_rk, -0.01764524031053554_rk, -0.005459456351742251_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, 0.1186389784734525_rk, -0.09869808947384334_rk, 0.06849624615803004_rk, -0.030201843315813288_rk, -0.0569833685262252_rk,   &
        0.0_rk, -0.008189184527613348_rk, 0.0_rk, 0.04694082178483669_rk, 0.03182932398491884_rk, 0.02710129609345774_rk, -0.004728027891461104_rk, 0.01837666877081668_rk,   &
        0.0_rk, -0.014016724263006344_rk, 0.0_rk, 0.1186389784734525_rk, 0.06040368663162656_rk, 0.06849624615803004_rk, -0.008092559526403472_rk, 0.03487408473681539_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,2) = reshape((/ &
        0.0_rk, 0.1115265734084703_rk, 0.0_rk, 0.0_rk, -0.0643898971791769_rk, 0.0_rk, -0.0643898971791769_rk, 0.0371755244694901_rk,   &
        0.0_rk, 0.2818740328508601_rk, 0.0_rk, 0.0_rk, 0.16274004874400952_rk, 0.0_rk, -0.16274004874400952_rk, -0.09395801095028672_rk,   &
        0.0_rk, 0.1115265734084703_rk, 0.0_rk, 0.0_rk, -0.0643898971791769_rk, 0.0_rk, -0.0643898971791769_rk, 0.0371755244694901_rk,   &
        0.0_rk, 0.2818740328508601_rk, 0.0_rk, 0.0_rk, 0.16274004874400952_rk, 0.0_rk, -0.16274004874400952_rk, -0.09395801095028672_rk,   &
        0.0_rk, 0.02988345527940995_rk, 0.0_rk, 0.0_rk, -0.017253220949883477_rk, 0.0_rk, 0.017253220949883477_rk, -0.009961151759803308_rk,   &
        0.0_rk, 0.07552791946969171_rk, 0.0_rk, 0.0_rk, 0.0436060646371589_rk, 0.0_rk, 0.0436060646371589_rk, 0.025175973156563912_rk,   &
        0.0_rk, 0.02988345527940995_rk, 0.0_rk, 0.0_rk, -0.017253220949883477_rk, 0.0_rk, 0.017253220949883477_rk, -0.009961151759803308_rk,   &
        0.0_rk, 0.07552791946969171_rk, 0.0_rk, 0.0_rk, 0.0436060646371589_rk, 0.0_rk, 0.0436060646371589_rk, 0.025175973156563912_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.17518553185004657_rk, 0.0_rk, 0.0_rk, -0.10114341397175214_rk, -0.10114341397175214_rk, 0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, 0.4427666954209951_rk, 0.0_rk, 0.0_rk, 0.25563147078951254_rk, -0.25563147078951254_rk, -0.14758889847366505_rk,   &
        0.0_rk, 0.0_rk, 0.17518553185004657_rk, 0.0_rk, 0.0_rk, -0.10114341397175214_rk, 0.10114341397175214_rk, -0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, 0.4427666954209951_rk, 0.0_rk, 0.0_rk, 0.25563147078951254_rk, 0.25563147078951254_rk, 0.14758889847366505_rk,   &
        0.0_rk, 0.0_rk, 0.04694082178483669_rk, 0.0_rk, 0.0_rk, -0.02710129609345774_rk, -0.02710129609345774_rk, 0.015646940594945567_rk,   &
        0.0_rk, 0.0_rk, 0.1186389784734525_rk, 0.0_rk, 0.0_rk, 0.06849624615803004_rk, -0.06849624615803004_rk, -0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, 0.04694082178483669_rk, 0.0_rk, 0.0_rk, -0.02710129609345774_rk, 0.02710129609345774_rk, -0.015646940594945567_rk,   &
        0.0_rk, 0.0_rk, 0.1186389784734525_rk, 0.0_rk, 0.0_rk, 0.06849624615803004_rk, 0.06849624615803004_rk, 0.03954632615781751_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,1) = reshape((/ &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, -0.17518553185004657_rk, 0.11878865428228769_rk, 0.10114341397175214_rk, 0.01764524031053554_rk, -0.06858266152655218_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, -0.4427666954209951_rk, 0.22542962747369927_rk, 0.25563147078951254_rk, 0.030201843315813288_rk, -0.13015185610525737_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk, -0.17518553185004657_rk, -0.03529048062107109_rk, 0.10114341397175214_rk, 0.06585293335068106_rk, 0.02037496848640665_rk,   &
        0.0_rk, -0.19522778415788597_rk, 0.0_rk, -0.4427666954209951_rk, -0.3683462845263622_rk, 0.25563147078951254_rk, 0.11271481373684966_rk, 0.21266482652629373_rk,   &
        0.0_rk, -0.008189184527613348_rk, 0.0_rk, -0.04694082178483669_rk, 0.03182932398491884_rk, -0.02710129609345774_rk, -0.004728027891461104_rk, 0.01837666877081668_rk,   &
        0.0_rk, -0.014016724263006344_rk, 0.0_rk, -0.1186389784734525_rk, 0.06040368663162656_rk, -0.06849624615803004_rk, -0.008092559526403472_rk, 0.03487408473681539_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, -0.04694082178483669_rk, -0.009456055782922183_rk, -0.02710129609345774_rk, -0.01764524031053554_rk, -0.005459456351742251_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, -0.1186389784734525_rk, -0.09869808947384334_rk, -0.06849624615803004_rk, -0.030201843315813288_rk, -0.0569833685262252_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,2) = reshape((/ &
        0.0_rk, -0.1115265734084703_rk, 0.0_rk, 0.0_rk, 0.0643898971791769_rk, 0.0_rk, 0.0643898971791769_rk, -0.0371755244694901_rk,   &
        0.0_rk, -0.2818740328508601_rk, 0.0_rk, 0.0_rk, -0.16274004874400952_rk, 0.0_rk, 0.16274004874400952_rk, 0.09395801095028672_rk,   &
        0.0_rk, -0.1115265734084703_rk, 0.0_rk, 0.0_rk, 0.0643898971791769_rk, 0.0_rk, 0.0643898971791769_rk, -0.0371755244694901_rk,   &
        0.0_rk, -0.2818740328508601_rk, 0.0_rk, 0.0_rk, -0.16274004874400952_rk, 0.0_rk, 0.16274004874400952_rk, 0.09395801095028672_rk,   &
        0.0_rk, -0.02988345527940995_rk, 0.0_rk, 0.0_rk, 0.017253220949883477_rk, 0.0_rk, -0.017253220949883477_rk, 0.009961151759803308_rk,   &
        0.0_rk, -0.07552791946969171_rk, 0.0_rk, 0.0_rk, -0.0436060646371589_rk, 0.0_rk, -0.0436060646371589_rk, -0.025175973156563912_rk,   &
        0.0_rk, -0.02988345527940995_rk, 0.0_rk, 0.0_rk, 0.017253220949883477_rk, 0.0_rk, -0.017253220949883477_rk, 0.009961151759803308_rk,   &
        0.0_rk, -0.07552791946969171_rk, 0.0_rk, 0.0_rk, -0.0436060646371589_rk, 0.0_rk, -0.0436060646371589_rk, -0.025175973156563912_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.17518553185004657_rk, 0.0_rk, 0.0_rk, 0.10114341397175214_rk, 0.10114341397175214_rk, -0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, -0.4427666954209951_rk, 0.0_rk, 0.0_rk, -0.25563147078951254_rk, 0.25563147078951254_rk, 0.14758889847366505_rk,   &
        0.0_rk, 0.0_rk, -0.17518553185004657_rk, 0.0_rk, 0.0_rk, 0.10114341397175214_rk, -0.10114341397175214_rk, 0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, -0.4427666954209951_rk, 0.0_rk, 0.0_rk, -0.25563147078951254_rk, -0.25563147078951254_rk, -0.14758889847366505_rk,   &
        0.0_rk, 0.0_rk, -0.04694082178483669_rk, 0.0_rk, 0.0_rk, 0.02710129609345774_rk, 0.02710129609345774_rk, -0.015646940594945567_rk,   &
        0.0_rk, 0.0_rk, -0.1186389784734525_rk, 0.0_rk, 0.0_rk, -0.06849624615803004_rk, 0.06849624615803004_rk, 0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, -0.04694082178483669_rk, 0.0_rk, 0.0_rk, 0.02710129609345774_rk, -0.02710129609345774_rk, 0.015646940594945567_rk,   &
        0.0_rk, 0.0_rk, -0.1186389784734525_rk, 0.0_rk, 0.0_rk, -0.06849624615803004_rk, -0.06849624615803004_rk, -0.03954632615781751_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,1) = reshape((/ &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk, -0.6538013056153495_rk, 0.4433252931442319_rk, 0.37747235979355087_rk, 0.06585293335068106_rk, -0.255953977335392_rk,   &
        0.0_rk, -0.01401672426300634_rk, 0.0_rk, -0.11863897847345253_rk, 0.06040368663162656_rk, 0.06849624615803003_rk, 0.008092559526403469_rk, -0.03487408473681539_rk,   &
        0.0_rk, -0.42568005283369637_rk, 0.0_rk, -0.6538013056153495_rk, -0.13170586670136214_rk, 0.37747235979355087_rk, 0.24576649309218865_rk, 0.07604041759388439_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, -0.11863897847345253_rk, -0.09869808947384329_rk, 0.06849624615803003_rk, 0.030201843315813288_rk, 0.056983368526225216_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, -0.17518553185004662_rk, 0.11878865428228769_rk, -0.10114341397175214_rk, -0.01764524031053554_rk, 0.06858266152655218_rk,   &
        0.0_rk, -0.003755769946802278_rk, 0.0_rk, -0.03178921847281497_rk, 0.016185119052806958_rk, -0.01835351384260754_rk, -0.002168394789800598_rk, 0.009344482842004221_rk,   &
        0.0_rk, -0.11406062639082654_rk, 0.0_rk, -0.17518553185004662_rk, -0.035290480621071076_rk, -0.10114341397175214_rk, -0.06585293335068106_rk, -0.02037496848640665_rk,   &
        0.0_rk, -0.014016724263006337_rk, 0.0_rk, -0.03178921847281497_rk, -0.026446073369011024_rk, -0.01835351384260754_rk, -0.008092559526403472_rk, -0.015268647578607103_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,2) = reshape((/ &
        0.0_rk, -0.4162228383544712_rk, 0.0_rk, 0.0_rk, 0.24030636776682412_rk, 0.0_rk, 0.24030636776682412_rk, -0.13874094611815707_rk,   &
        0.0_rk, -0.07552791946969173_rk, 0.0_rk, 0.0_rk, -0.0436060646371589_rk, 0.0_rk, 0.0436060646371589_rk, 0.025175973156563912_rk,   &
        0.0_rk, -0.4162228383544712_rk, 0.0_rk, 0.0_rk, 0.24030636776682412_rk, 0.0_rk, 0.24030636776682412_rk, -0.13874094611815707_rk,   &
        0.0_rk, -0.07552791946969173_rk, 0.0_rk, 0.0_rk, -0.0436060646371589_rk, 0.0_rk, 0.0436060646371589_rk, 0.025175973156563912_rk,   &
        0.0_rk, -0.11152657340847033_rk, 0.0_rk, 0.0_rk, 0.06438989717917688_rk, 0.0_rk, -0.06438989717917688_rk, 0.0371755244694901_rk,   &
        0.0_rk, -0.020237645027906787_rk, 0.0_rk, 0.0_rk, -0.011684209804626068_rk, 0.0_rk, -0.011684209804626068_rk, -0.006745881675968924_rk,   &
        0.0_rk, -0.11152657340847033_rk, 0.0_rk, 0.0_rk, 0.06438989717917688_rk, 0.0_rk, -0.06438989717917688_rk, 0.0371755244694901_rk,   &
        0.0_rk, -0.020237645027906787_rk, 0.0_rk, 0.0_rk, -0.011684209804626068_rk, 0.0_rk, -0.011684209804626068_rk, -0.006745881675968924_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.6538013056153495_rk, 0.0_rk, 0.0_rk, 0.37747235979355087_rk, 0.37747235979355087_rk, -0.21793376853844984_rk,   &
        0.0_rk, 0.0_rk, -0.11863897847345253_rk, 0.0_rk, 0.0_rk, -0.06849624615803003_rk, 0.06849624615803003_rk, 0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, -0.6538013056153495_rk, 0.0_rk, 0.0_rk, 0.37747235979355087_rk, -0.37747235979355087_rk, 0.21793376853844984_rk,   &
        0.0_rk, 0.0_rk, -0.11863897847345253_rk, 0.0_rk, 0.0_rk, -0.06849624615803003_rk, -0.06849624615803003_rk, -0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, -0.17518553185004662_rk, 0.0_rk, 0.0_rk, 0.10114341397175214_rk, 0.10114341397175214_rk, -0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, -0.03178921847281497_rk, 0.0_rk, 0.0_rk, -0.01835351384260754_rk, 0.01835351384260754_rk, 0.01059640615760498_rk,   &
        0.0_rk, 0.0_rk, -0.17518553185004662_rk, 0.0_rk, 0.0_rk, 0.10114341397175214_rk, -0.10114341397175214_rk, 0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, -0.03178921847281497_rk, 0.0_rk, 0.0_rk, -0.01835351384260754_rk, -0.01835351384260754_rk, -0.01059640615760498_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,1) = reshape((/ &
        0.0_rk, -0.11406062639082654_rk, 0.0_rk, 0.17518553185004662_rk, -0.035290480621071076_rk, -0.10114341397175214_rk, 0.06585293335068106_rk, 0.02037496848640665_rk,   &
        0.0_rk, -0.014016724263006337_rk, 0.0_rk, 0.03178921847281497_rk, -0.026446073369011024_rk, -0.01835351384260754_rk, 0.008092559526403472_rk, 0.015268647578607103_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, 0.17518553185004662_rk, 0.11878865428228769_rk, -0.10114341397175214_rk, 0.01764524031053554_rk, -0.06858266152655218_rk,   &
        0.0_rk, -0.003755769946802278_rk, 0.0_rk, 0.03178921847281497_rk, 0.016185119052806958_rk, -0.01835351384260754_rk, 0.002168394789800598_rk, -0.009344482842004221_rk,   &
        0.0_rk, -0.42568005283369637_rk, 0.0_rk, 0.6538013056153495_rk, -0.13170586670136214_rk, 0.37747235979355087_rk, -0.24576649309218865_rk, -0.07604041759388439_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, 0.11863897847345253_rk, -0.09869808947384329_rk, 0.06849624615803003_rk, -0.030201843315813288_rk, -0.056983368526225216_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk, 0.6538013056153495_rk, 0.4433252931442319_rk, 0.37747235979355087_rk, -0.06585293335068106_rk, 0.255953977335392_rk,   &
        0.0_rk, -0.01401672426300634_rk, 0.0_rk, 0.11863897847345253_rk, 0.06040368663162656_rk, 0.06849624615803003_rk, -0.008092559526403469_rk, 0.03487408473681539_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,2) = reshape((/ &
        0.0_rk, 0.11152657340847033_rk, 0.0_rk, 0.0_rk, -0.06438989717917688_rk, 0.0_rk, -0.06438989717917688_rk, 0.0371755244694901_rk,   &
        0.0_rk, 0.020237645027906787_rk, 0.0_rk, 0.0_rk, 0.011684209804626068_rk, 0.0_rk, -0.011684209804626068_rk, -0.006745881675968924_rk,   &
        0.0_rk, 0.11152657340847033_rk, 0.0_rk, 0.0_rk, -0.06438989717917688_rk, 0.0_rk, -0.06438989717917688_rk, 0.0371755244694901_rk,   &
        0.0_rk, 0.020237645027906787_rk, 0.0_rk, 0.0_rk, 0.011684209804626068_rk, 0.0_rk, -0.011684209804626068_rk, -0.006745881675968924_rk,   &
        0.0_rk, 0.4162228383544712_rk, 0.0_rk, 0.0_rk, -0.24030636776682412_rk, 0.0_rk, 0.24030636776682412_rk, -0.13874094611815707_rk,   &
        0.0_rk, 0.07552791946969173_rk, 0.0_rk, 0.0_rk, 0.0436060646371589_rk, 0.0_rk, 0.0436060646371589_rk, 0.025175973156563912_rk,   &
        0.0_rk, 0.4162228383544712_rk, 0.0_rk, 0.0_rk, -0.24030636776682412_rk, 0.0_rk, 0.24030636776682412_rk, -0.13874094611815707_rk,   &
        0.0_rk, 0.07552791946969173_rk, 0.0_rk, 0.0_rk, 0.0436060646371589_rk, 0.0_rk, 0.0436060646371589_rk, 0.025175973156563912_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.17518553185004662_rk, 0.0_rk, 0.0_rk, -0.10114341397175214_rk, -0.10114341397175214_rk, 0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, 0.03178921847281497_rk, 0.0_rk, 0.0_rk, 0.01835351384260754_rk, -0.01835351384260754_rk, -0.01059640615760498_rk,   &
        0.0_rk, 0.0_rk, 0.17518553185004662_rk, 0.0_rk, 0.0_rk, -0.10114341397175214_rk, 0.10114341397175214_rk, -0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, 0.03178921847281497_rk, 0.0_rk, 0.0_rk, 0.01835351384260754_rk, 0.01835351384260754_rk, 0.01059640615760498_rk,   &
        0.0_rk, 0.0_rk, 0.6538013056153495_rk, 0.0_rk, 0.0_rk, -0.37747235979355087_rk, -0.37747235979355087_rk, 0.21793376853844984_rk,   &
        0.0_rk, 0.0_rk, 0.11863897847345253_rk, 0.0_rk, 0.0_rk, 0.06849624615803003_rk, -0.06849624615803003_rk, -0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, 0.6538013056153495_rk, 0.0_rk, 0.0_rk, -0.37747235979355087_rk, 0.37747235979355087_rk, -0.21793376853844984_rk,   &
        0.0_rk, 0.0_rk, 0.11863897847345253_rk, 0.0_rk, 0.0_rk, 0.06849624615803003_rk, 0.06849624615803003_rk, 0.03954632615781751_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,1) = reshape((/ &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, 0.04694082178483669_rk, -0.009456055782922183_rk, -0.02710129609345774_rk, 0.01764524031053554_rk, 0.005459456351742251_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, 0.1186389784734525_rk, -0.09869808947384334_rk, -0.06849624615803004_rk, 0.030201843315813288_rk, 0.0569833685262252_rk,   &
        0.0_rk, -0.008189184527613348_rk, 0.0_rk, 0.04694082178483669_rk, 0.03182932398491884_rk, -0.02710129609345774_rk, 0.004728027891461104_rk, -0.01837666877081668_rk,   &
        0.0_rk, -0.014016724263006344_rk, 0.0_rk, 0.1186389784734525_rk, 0.06040368663162656_rk, -0.06849624615803004_rk, 0.008092559526403472_rk, -0.03487408473681539_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk, 0.17518553185004657_rk, -0.03529048062107109_rk, 0.10114341397175214_rk, -0.06585293335068106_rk, -0.02037496848640665_rk,   &
        0.0_rk, -0.19522778415788597_rk, 0.0_rk, 0.4427666954209951_rk, -0.3683462845263622_rk, 0.25563147078951254_rk, -0.11271481373684966_rk, -0.21266482652629373_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, 0.17518553185004657_rk, 0.11878865428228769_rk, 0.10114341397175214_rk, -0.01764524031053554_rk, 0.06858266152655218_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, 0.4427666954209951_rk, 0.22542962747369927_rk, 0.25563147078951254_rk, -0.030201843315813288_rk, 0.13015185610525737_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,2) = reshape((/ &
        0.0_rk, 0.02988345527940995_rk, 0.0_rk, 0.0_rk, -0.017253220949883477_rk, 0.0_rk, -0.017253220949883477_rk, 0.009961151759803308_rk,   &
        0.0_rk, 0.07552791946969171_rk, 0.0_rk, 0.0_rk, 0.0436060646371589_rk, 0.0_rk, -0.0436060646371589_rk, -0.025175973156563912_rk,   &
        0.0_rk, 0.02988345527940995_rk, 0.0_rk, 0.0_rk, -0.017253220949883477_rk, 0.0_rk, -0.017253220949883477_rk, 0.009961151759803308_rk,   &
        0.0_rk, 0.07552791946969171_rk, 0.0_rk, 0.0_rk, 0.0436060646371589_rk, 0.0_rk, -0.0436060646371589_rk, -0.025175973156563912_rk,   &
        0.0_rk, 0.1115265734084703_rk, 0.0_rk, 0.0_rk, -0.0643898971791769_rk, 0.0_rk, 0.0643898971791769_rk, -0.0371755244694901_rk,   &
        0.0_rk, 0.2818740328508601_rk, 0.0_rk, 0.0_rk, 0.16274004874400952_rk, 0.0_rk, 0.16274004874400952_rk, 0.09395801095028672_rk,   &
        0.0_rk, 0.1115265734084703_rk, 0.0_rk, 0.0_rk, -0.0643898971791769_rk, 0.0_rk, 0.0643898971791769_rk, -0.0371755244694901_rk,   &
        0.0_rk, 0.2818740328508601_rk, 0.0_rk, 0.0_rk, 0.16274004874400952_rk, 0.0_rk, 0.16274004874400952_rk, 0.09395801095028672_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.04694082178483669_rk, 0.0_rk, 0.0_rk, -0.02710129609345774_rk, -0.02710129609345774_rk, 0.015646940594945567_rk,   &
        0.0_rk, 0.0_rk, 0.1186389784734525_rk, 0.0_rk, 0.0_rk, 0.06849624615803004_rk, -0.06849624615803004_rk, -0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, 0.04694082178483669_rk, 0.0_rk, 0.0_rk, -0.02710129609345774_rk, 0.02710129609345774_rk, -0.015646940594945567_rk,   &
        0.0_rk, 0.0_rk, 0.1186389784734525_rk, 0.0_rk, 0.0_rk, 0.06849624615803004_rk, 0.06849624615803004_rk, 0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, 0.17518553185004657_rk, 0.0_rk, 0.0_rk, -0.10114341397175214_rk, -0.10114341397175214_rk, 0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, 0.4427666954209951_rk, 0.0_rk, 0.0_rk, 0.25563147078951254_rk, -0.25563147078951254_rk, -0.14758889847366505_rk,   &
        0.0_rk, 0.0_rk, 0.17518553185004657_rk, 0.0_rk, 0.0_rk, -0.10114341397175214_rk, 0.10114341397175214_rk, -0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, 0.4427666954209951_rk, 0.0_rk, 0.0_rk, 0.25563147078951254_rk, 0.25563147078951254_rk, 0.14758889847366505_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,1) = reshape((/ &
        0.0_rk, -0.008189184527613348_rk, 0.0_rk, -0.04694082178483669_rk, 0.03182932398491884_rk, 0.02710129609345774_rk, 0.004728027891461104_rk, -0.01837666877081668_rk,   &
        0.0_rk, -0.014016724263006344_rk, 0.0_rk, -0.1186389784734525_rk, 0.06040368663162656_rk, 0.06849624615803004_rk, 0.008092559526403472_rk, -0.03487408473681539_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, -0.04694082178483669_rk, -0.009456055782922183_rk, 0.02710129609345774_rk, 0.01764524031053554_rk, 0.005459456351742251_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, -0.1186389784734525_rk, -0.09869808947384334_rk, 0.06849624615803004_rk, 0.030201843315813288_rk, 0.0569833685262252_rk,   &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, -0.17518553185004657_rk, 0.11878865428228769_rk, -0.10114341397175214_rk, -0.01764524031053554_rk, 0.06858266152655218_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, -0.4427666954209951_rk, 0.22542962747369927_rk, -0.25563147078951254_rk, -0.030201843315813288_rk, 0.13015185610525737_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk, -0.17518553185004657_rk, -0.03529048062107109_rk, -0.10114341397175214_rk, -0.06585293335068106_rk, -0.02037496848640665_rk,   &
        0.0_rk, -0.19522778415788597_rk, 0.0_rk, -0.4427666954209951_rk, -0.3683462845263622_rk, -0.25563147078951254_rk, -0.11271481373684966_rk, -0.21266482652629373_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,2) = reshape((/ &
        0.0_rk, -0.02988345527940995_rk, 0.0_rk, 0.0_rk, 0.017253220949883477_rk, 0.0_rk, 0.017253220949883477_rk, -0.009961151759803308_rk,   &
        0.0_rk, -0.07552791946969171_rk, 0.0_rk, 0.0_rk, -0.0436060646371589_rk, 0.0_rk, 0.0436060646371589_rk, 0.025175973156563912_rk,   &
        0.0_rk, -0.02988345527940995_rk, 0.0_rk, 0.0_rk, 0.017253220949883477_rk, 0.0_rk, 0.017253220949883477_rk, -0.009961151759803308_rk,   &
        0.0_rk, -0.07552791946969171_rk, 0.0_rk, 0.0_rk, -0.0436060646371589_rk, 0.0_rk, 0.0436060646371589_rk, 0.025175973156563912_rk,   &
        0.0_rk, -0.1115265734084703_rk, 0.0_rk, 0.0_rk, 0.0643898971791769_rk, 0.0_rk, -0.0643898971791769_rk, 0.0371755244694901_rk,   &
        0.0_rk, -0.2818740328508601_rk, 0.0_rk, 0.0_rk, -0.16274004874400952_rk, 0.0_rk, -0.16274004874400952_rk, -0.09395801095028672_rk,   &
        0.0_rk, -0.1115265734084703_rk, 0.0_rk, 0.0_rk, 0.0643898971791769_rk, 0.0_rk, -0.0643898971791769_rk, 0.0371755244694901_rk,   &
        0.0_rk, -0.2818740328508601_rk, 0.0_rk, 0.0_rk, -0.16274004874400952_rk, 0.0_rk, -0.16274004874400952_rk, -0.09395801095028672_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.04694082178483669_rk, 0.0_rk, 0.0_rk, 0.02710129609345774_rk, 0.02710129609345774_rk, -0.015646940594945567_rk,   &
        0.0_rk, 0.0_rk, -0.1186389784734525_rk, 0.0_rk, 0.0_rk, -0.06849624615803004_rk, 0.06849624615803004_rk, 0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, -0.04694082178483669_rk, 0.0_rk, 0.0_rk, 0.02710129609345774_rk, -0.02710129609345774_rk, 0.015646940594945567_rk,   &
        0.0_rk, 0.0_rk, -0.1186389784734525_rk, 0.0_rk, 0.0_rk, -0.06849624615803004_rk, -0.06849624615803004_rk, -0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, -0.17518553185004657_rk, 0.0_rk, 0.0_rk, 0.10114341397175214_rk, 0.10114341397175214_rk, -0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, -0.4427666954209951_rk, 0.0_rk, 0.0_rk, -0.25563147078951254_rk, 0.25563147078951254_rk, 0.14758889847366505_rk,   &
        0.0_rk, 0.0_rk, -0.17518553185004657_rk, 0.0_rk, 0.0_rk, 0.10114341397175214_rk, -0.10114341397175214_rk, 0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, -0.4427666954209951_rk, 0.0_rk, 0.0_rk, -0.25563147078951254_rk, -0.25563147078951254_rk, -0.14758889847366505_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,1) = reshape((/ &
        0.0_rk, -0.030562452729609984_rk, 0.0_rk, -0.17518553185004662_rk, 0.11878865428228769_rk, 0.10114341397175214_rk, 0.01764524031053554_rk, -0.06858266152655218_rk,   &
        0.0_rk, -0.003755769946802278_rk, 0.0_rk, -0.03178921847281497_rk, 0.016185119052806958_rk, 0.01835351384260754_rk, 0.002168394789800598_rk, -0.009344482842004221_rk,   &
        0.0_rk, -0.11406062639082654_rk, 0.0_rk, -0.17518553185004662_rk, -0.035290480621071076_rk, 0.10114341397175214_rk, 0.06585293335068106_rk, 0.02037496848640665_rk,   &
        0.0_rk, -0.014016724263006337_rk, 0.0_rk, -0.03178921847281497_rk, -0.026446073369011024_rk, 0.01835351384260754_rk, 0.008092559526403472_rk, 0.015268647578607103_rk,   &
        0.0_rk, -0.11406062639082659_rk, 0.0_rk, -0.6538013056153495_rk, 0.4433252931442319_rk, -0.37747235979355087_rk, -0.06585293335068106_rk, 0.255953977335392_rk,   &
        0.0_rk, -0.01401672426300634_rk, 0.0_rk, -0.11863897847345253_rk, 0.06040368663162656_rk, -0.06849624615803003_rk, -0.008092559526403469_rk, 0.03487408473681539_rk,   &
        0.0_rk, -0.42568005283369637_rk, 0.0_rk, -0.6538013056153495_rk, -0.13170586670136214_rk, -0.37747235979355087_rk, -0.24576649309218865_rk, -0.07604041759388439_rk,   &
        0.0_rk, -0.05231112710522308_rk, 0.0_rk, -0.11863897847345253_rk, -0.09869808947384329_rk, -0.06849624615803003_rk, -0.030201843315813288_rk, -0.056983368526225216_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,2) = reshape((/ &
        0.0_rk, -0.11152657340847033_rk, 0.0_rk, 0.0_rk, 0.06438989717917688_rk, 0.0_rk, 0.06438989717917688_rk, -0.0371755244694901_rk,   &
        0.0_rk, -0.020237645027906787_rk, 0.0_rk, 0.0_rk, -0.011684209804626068_rk, 0.0_rk, 0.011684209804626068_rk, 0.006745881675968924_rk,   &
        0.0_rk, -0.11152657340847033_rk, 0.0_rk, 0.0_rk, 0.06438989717917688_rk, 0.0_rk, 0.06438989717917688_rk, -0.0371755244694901_rk,   &
        0.0_rk, -0.020237645027906787_rk, 0.0_rk, 0.0_rk, -0.011684209804626068_rk, 0.0_rk, 0.011684209804626068_rk, 0.006745881675968924_rk,   &
        0.0_rk, -0.4162228383544712_rk, 0.0_rk, 0.0_rk, 0.24030636776682412_rk, 0.0_rk, -0.24030636776682412_rk, 0.13874094611815707_rk,   &
        0.0_rk, -0.07552791946969173_rk, 0.0_rk, 0.0_rk, -0.0436060646371589_rk, 0.0_rk, -0.0436060646371589_rk, -0.025175973156563912_rk,   &
        0.0_rk, -0.4162228383544712_rk, 0.0_rk, 0.0_rk, 0.24030636776682412_rk, 0.0_rk, -0.24030636776682412_rk, 0.13874094611815707_rk,   &
        0.0_rk, -0.07552791946969173_rk, 0.0_rk, 0.0_rk, -0.0436060646371589_rk, 0.0_rk, -0.0436060646371589_rk, -0.025175973156563912_rk   &
        /),(/8,8/))
        test_dgrad2_dx(:,:,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.17518553185004662_rk, 0.0_rk, 0.0_rk, 0.10114341397175214_rk, 0.10114341397175214_rk, -0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, -0.03178921847281497_rk, 0.0_rk, 0.0_rk, -0.01835351384260754_rk, 0.01835351384260754_rk, 0.01059640615760498_rk,   &
        0.0_rk, 0.0_rk, -0.17518553185004662_rk, 0.0_rk, 0.0_rk, 0.10114341397175214_rk, -0.10114341397175214_rk, 0.05839517728334885_rk,   &
        0.0_rk, 0.0_rk, -0.03178921847281497_rk, 0.0_rk, 0.0_rk, -0.01835351384260754_rk, -0.01835351384260754_rk, -0.01059640615760498_rk,   &
        0.0_rk, 0.0_rk, -0.6538013056153495_rk, 0.0_rk, 0.0_rk, 0.37747235979355087_rk, 0.37747235979355087_rk, -0.21793376853844984_rk,   &
        0.0_rk, 0.0_rk, -0.11863897847345253_rk, 0.0_rk, 0.0_rk, -0.06849624615803003_rk, 0.06849624615803003_rk, 0.03954632615781751_rk,   &
        0.0_rk, 0.0_rk, -0.6538013056153495_rk, 0.0_rk, 0.0_rk, 0.37747235979355087_rk, -0.37747235979355087_rk, 0.21793376853844984_rk,   &
        0.0_rk, 0.0_rk, -0.11863897847345253_rk, 0.0_rk, 0.0_rk, -0.06849624615803003_rk, -0.06849624615803003_rk, -0.03954632615781751_rk   &
        /),(/8,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%elem%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad2_dx
    !*******************************************************************************************







    !> Test cartesian dgrad3_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad3_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad3_dx
        ! 
        test_dgrad3_dx(:,:,1,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,1,2) = reshape((/ &
        0.0_rk, 0.7919657785262487_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, 0.2639885928420829_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, 0.056860584630526234_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, -0.018953528210175402_rk,   &
        0.0_rk, 0.7919657785262487_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, -0.2639885928420829_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, 0.056860584630526234_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, 0.018953528210175402_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,1,3) = reshape((/ &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,2) = reshape((/ &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, 0.7919657785262488_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, -0.263988592842083_rk,   &
        0.0_rk, 0.056860584630526206_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, 0.018953528210175395_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, 0.7919657785262488_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, 0.263988592842083_rk,   &
        0.0_rk, 0.056860584630526206_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, -0.018953528210175395_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,2,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,2) = reshape((/ &
        0.0_rk, 0.056860584630526206_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, 0.018953528210175395_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, 0.7919657785262488_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, -0.263988592842083_rk,   &
        0.0_rk, 0.056860584630526206_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, -0.018953528210175395_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, 0.7919657785262488_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, 0.263988592842083_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,3,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.08931639747704093_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,2) = reshape((/ &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, 0.056860584630526234_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, -0.018953528210175402_rk,   &
        0.0_rk, 0.7919657785262487_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, 0.2639885928420829_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, 0.21220659078919377_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, 0.056860584630526234_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, 0.018953528210175402_rk,   &
        0.0_rk, 0.7919657785262487_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, -0.2639885928420829_rk,   &
        0.0_rk, 0.2122065907891938_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,4,3) = reshape((/ &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,2) = reshape((/ &
        0.0_rk, -0.7919657785262487_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, -0.2639885928420829_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, -0.056860584630526234_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, 0.018953528210175402_rk,   &
        0.0_rk, -0.7919657785262487_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, 0.2639885928420829_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, -0.056860584630526234_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, -0.018953528210175402_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,5,3) = reshape((/ &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, -0.029772132492346975_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, -0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,2) = reshape((/ &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, -0.7919657785262488_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, 0.263988592842083_rk,   &
        0.0_rk, -0.056860584630526206_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, -0.018953528210175395_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, -0.7919657785262488_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, -0.263988592842083_rk,   &
        0.0_rk, -0.056860584630526206_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, 0.018953528210175395_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,6,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.11111111111111113_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,2) = reshape((/ &
        0.0_rk, -0.056860584630526206_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, -0.018953528210175395_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, -0.7919657785262488_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, 0.263988592842083_rk,   &
        0.0_rk, -0.056860584630526206_rk, 0.0_rk, 0.0_rk, 0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, 0.018953528210175395_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, -0.7919657785262488_rk, 0.0_rk, 0.0_rk, -0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, -0.263988592842083_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,7,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, -0.4146723119520974_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,1) = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.05156684612641717_rk, 0.05156684612641717_rk, 0.0_rk, -0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, -0.7182335127930838_rk, 0.7182335127930838_rk, 0.0_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, 0.19245008972987526_rk, 0.0_rk, 0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, 0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.05156684612641717_rk, -0.05156684612641717_rk, 0.0_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -1.2440169358562925_rk, -0.7182335127930838_rk, -0.7182335127930838_rk, 0.0_rk, -0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, -0.33333333333333337_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, 0.0_rk, -0.1111111111111111_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,2) = reshape((/ &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, -0.07073553026306459_rk,   &
        0.0_rk, -0.056860584630526234_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, 0.0328284738427138_rk, 0.018953528210175402_rk,   &
        0.0_rk, -0.7919657785262487_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, 0.45724165542110135_rk, -0.2639885928420829_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, 0.12251753231595379_rk, 0.0707355302630646_rk,   &
        0.0_rk, -0.21220659078919377_rk, 0.0_rk, 0.0_rk, 0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, 0.07073553026306459_rk,   &
        0.0_rk, -0.056860584630526234_rk, 0.0_rk, 0.0_rk, -0.0328284738427138_rk, 0.0_rk, -0.0328284738427138_rk, -0.018953528210175402_rk,   &
        0.0_rk, -0.7919657785262487_rk, 0.0_rk, 0.0_rk, 0.45724165542110135_rk, 0.0_rk, -0.45724165542110135_rk, 0.2639885928420829_rk,   &
        0.0_rk, -0.2122065907891938_rk, 0.0_rk, 0.0_rk, -0.12251753231595379_rk, 0.0_rk, -0.12251753231595379_rk, -0.0707355302630646_rk   &
        /),(/8,8/))
        test_dgrad3_dx(:,:,8,3) = reshape((/ &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, 0.19245008972987526_rk, 0.19245008972987526_rk, -0.11111111111111113_rk,   &
        0.0_rk, 0.0_rk, -0.08931639747704093_rk, 0.0_rk, 0.0_rk, -0.05156684612641717_rk, 0.05156684612641717_rk, 0.029772132492346975_rk,   &
        0.0_rk, 0.0_rk, -1.2440169358562925_rk, 0.0_rk, 0.0_rk, 0.7182335127930838_rk, -0.7182335127930838_rk, 0.4146723119520974_rk,   &
        0.0_rk, 0.0_rk, -0.33333333333333337_rk, 0.0_rk, 0.0_rk, -0.19245008972987526_rk, -0.19245008972987526_rk, -0.1111111111111111_rk   &
        /),(/8,8/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%elem%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad3_dx
    !*******************************************************************************************








    !> Test cartesian dinvmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dinvmass_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dinvmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dinvmass_dx
        ! 
        test_dinvmass_dx(:,:,1,1) = reshape((/ &
        0.06215518487612483_rk, -0.062155184876124814_rk, -0.06215518487612483_rk, 0.028252356761874913_rk, -0.028252356761874903_rk, -0.028252356761874892_rk, 0.062155184876124786_rk, 0.028252356761874917_rk,   &
        -0.06215518487612484_rk, 0.18646555462837452_rk, 0.06215518487612484_rk, -0.02825235676187494_rk, 0.08475707028562474_rk, 0.028252356761874937_rk, -0.18646555462837439_rk, -0.08475707028562474_rk,   &
        -0.062155184876124814_rk, 0.06215518487612483_rk, 0.18646555462837458_rk, -0.02825235676187494_rk, 0.02825235676187491_rk, 0.08475707028562472_rk, -0.18646555462837439_rk, -0.08475707028562476_rk,   &
        0.028252356761874917_rk, -0.028252356761874913_rk, -0.02825235676187493_rk, 0.18646555462837444_rk, -0.18646555462837436_rk, -0.18646555462837444_rk, 0.02825235676187492_rk, 0.1864655546283744_rk,   &
        -0.028252356761874906_rk, 0.08475707028562474_rk, 0.028252356761874892_rk, -0.1864655546283744_rk, 0.5593966638851231_rk, 0.18646555462837444_rk, -0.08475707028562478_rk, -0.5593966638851235_rk,   &
        -0.028252356761874906_rk, 0.028252356761874906_rk, 0.08475707028562471_rk, -0.18646555462837439_rk, 0.18646555462837439_rk, 0.5593966638851234_rk, -0.08475707028562479_rk, -0.5593966638851235_rk,   &
        0.062155184876124835_rk, -0.1864655546283744_rk, -0.18646555462837444_rk, 0.02825235676187495_rk, -0.08475707028562486_rk, -0.08475707028562476_rk, 0.5593966638851231_rk, 0.254271210856874_rk,   &
        0.028252356761874924_rk, -0.08475707028562472_rk, -0.08475707028562472_rk, 0.18646555462837439_rk, -0.5593966638851235_rk, -0.5593966638851234_rk, 0.2542712108568742_rk, 1.67818999165537_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,1,2) = reshape((/ &
        0.07793937203256751_rk, 5.204170427930421e-18_rk, -0.07793937203256752_rk, -0.09352724643908102_rk, 0.0_rk, 0.09352724643908099_rk, -1.734723475976807e-17_rk, -6.938893903907228e-18_rk,   &
        -5.204170427930421e-18_rk, 0.23381811609770264_rk, -1.0408340855860843e-17_rk, 0.0_rk, -0.2805817393172429_rk, -2.42861286636753e-17_rk, -0.23381811609770245_rk, 0.280581739317243_rk,   &
        -0.07793937203256754_rk, 0.0_rk, 0.23381811609770256_rk, 0.09352724643908104_rk, 1.0408340855860843e-17_rk, -0.2805817393172429_rk, -3.469446951953614e-18_rk, 0.0_rk,   &
        -0.09352724643908102_rk, 1.9081958235744878e-17_rk, 0.09352724643908103_rk, 0.23381811609770262_rk, -1.3877787807814457e-17_rk, -0.23381811609770256_rk, -1.3877787807814457e-17_rk, 1.3877787807814457e-17_rk,   &
        1.734723475976807e-18_rk, -0.2805817393172429_rk, -3.469446951953614e-18_rk, 6.938893903907228e-18_rk, 0.7014543482931073_rk, 0.0_rk, 0.2805817393172429_rk, -0.7014543482931075_rk,   &
        0.09352724643908097_rk, 6.938893903907228e-18_rk, -0.28058173931724295_rk, -0.23381811609770253_rk, -2.0816681711721685e-17_rk, 0.7014543482931074_rk, 2.0816681711721685e-17_rk, 2.7755575615628914e-17_rk,   &
        -3.469446951953614e-18_rk, -0.23381811609770253_rk, -6.938893903907228e-18_rk, 6.938893903907228e-18_rk, 0.28058173931724284_rk, 0.0_rk, 0.7014543482931073_rk, -0.8417452179517289_rk,   &
        0.0_rk, 0.28058173931724306_rk, 0.0_rk, -6.938893903907228e-18_rk, -0.7014543482931075_rk, 0.0_rk, -0.841745217951729_rk, 2.1043630448793227_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,1,3) = reshape((/ &
        0.12242687930145797_rk, -0.12242687930145796_rk, -5.204170427930421e-18_rk, -0.14691225516174955_rk, 0.1469122551617495_rk, 2.0816681711721685e-17_rk, 1.0408340855860843e-17_rk, -3.469446951953614e-18_rk,   &
        -0.12242687930145796_rk, 0.36728063790437393_rk, 2.0816681711721685e-17_rk, 0.14691225516174955_rk, -0.44073676548524837_rk, -4.5102810375396984e-17_rk, 6.938893903907228e-18_rk, 5.551115123125783e-17_rk,   &
        1.0408340855860843e-17_rk, 4.5102810375396984e-17_rk, 0.36728063790437393_rk, 3.8163916471489756e-17_rk, 6.938893903907228e-18_rk, -0.4407367654852484_rk, -0.3672806379043737_rk, 0.4407367654852484_rk,   &
        -0.14691225516174955_rk, 0.14691225516174955_rk, 2.42861286636753e-17_rk, 0.36728063790437393_rk, -0.3672806379043737_rk, -1.3877787807814457e-16_rk, -5.204170427930421e-17_rk, 0.0_rk,   &
        0.1469122551617495_rk, -0.4407367654852484_rk, -6.938893903907228e-18_rk, -0.3672806379043737_rk, 1.101841913713121_rk, 9.020562075079397e-17_rk, 9.020562075079397e-17_rk, -5.551115123125783e-17_rk,   &
        3.469446951953614e-18_rk, -1.734723475976807e-17_rk, -0.4407367654852484_rk, -8.326672684688674e-17_rk, -2.0816681711721685e-17_rk, 1.101841913713121_rk, 0.4407367654852483_rk, -1.1018419137131217_rk,   &
        3.469446951953614e-18_rk, -1.249000902703301e-16_rk, -0.36728063790437376_rk, -1.0408340855860843e-17_rk, -6.938893903907228e-18_rk, 0.4407367654852483_rk, 1.101841913713121_rk, -1.3222102964557456_rk,   &
        -3.469446951953614e-18_rk, 2.636779683484747e-16_rk, 0.4407367654852485_rk, 5.551115123125783e-17_rk, -5.551115123125783e-17_rk, -1.1018419137131215_rk, -1.3222102964557458_rk, 3.305525741139365_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,1) = reshape((/ &
        -0.14126178380937457_rk, 0.1412617838093746_rk, 0.1412617838093746_rk, 0.022601885409499898_rk, -0.02260188540949991_rk, -0.022601885409499933_rk, -0.1412617838093745_rk, 0.0226018854094999_rk,   &
        0.14126178380937457_rk, -0.42378535142812374_rk, -0.1412617838093746_rk, -0.02260188540949989_rk, 0.0678056562284996_rk, 0.02260188540949988_rk, 0.42378535142812357_rk, -0.06780565622849971_rk,   &
        0.14126178380937454_rk, -0.14126178380937465_rk, -0.4237853514281239_rk, -0.022601885409499905_rk, 0.022601885409499888_rk, 0.06780565622849967_rk, 0.42378535142812357_rk, -0.06780565622849963_rk,   &
        0.02260188540949991_rk, -0.02260188540949992_rk, -0.022601885409499888_rk, -0.4237853514281238_rk, 0.4237853514281235_rk, 0.42378535142812374_rk, 0.022601885409499905_rk, -0.4237853514281237_rk,   &
        -0.02260188540949989_rk, 0.06780565622849968_rk, 0.022601885409499898_rk, 0.42378535142812357_rk, -1.2713560542843705_rk, -0.42378535142812357_rk, -0.06780565622849964_rk, 1.271356054284371_rk,   &
        -0.022601885409499877_rk, 0.02260188540949992_rk, 0.06780565622849968_rk, 0.4237853514281237_rk, -0.42378535142812346_rk, -1.271356054284371_rk, -0.06780565622849963_rk, 1.271356054284371_rk,   &
        -0.14126178380937454_rk, 0.4237853514281237_rk, 0.42378535142812357_rk, 0.022601885409499853_rk, -0.06780565622849953_rk, -0.06780565622849963_rk, -1.2713560542843705_rk, 0.2034169686854991_rk,   &
        0.02260188540949991_rk, -0.06780565622849978_rk, -0.06780565622849972_rk, -0.4237853514281237_rk, 1.271356054284371_rk, 1.271356054284371_rk, 0.20341696868549927_rk, -3.814068162853113_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,2) = reshape((/ &
        0.06235149762605402_rk, 8.673617379884035e-18_rk, -0.06235149762605404_rk, 0.04676362321954055_rk, 0.0_rk, -0.0467636232195405_rk, -1.0408340855860843e-17_rk, 6.938893903907228e-18_rk,   &
        -5.204170427930421e-18_rk, 0.18705449287816217_rk, -1.0408340855860843e-17_rk, 0.0_rk, 0.1402908696586216_rk, -3.469446951953614e-18_rk, -0.187054492878162_rk, -0.1402908696586216_rk,   &
        -0.062351497626054034_rk, 0.0_rk, 0.18705449287816214_rk, -0.04676362321954056_rk, -1.0408340855860843e-17_rk, 0.1402908696586216_rk, -2.42861286636753e-17_rk, 0.0_rk,   &
        0.04676362321954054_rk, -1.9081958235744878e-17_rk, -0.04676362321954056_rk, 0.1870544928781621_rk, -2.7755575615628914e-17_rk, -0.1870544928781621_rk, 2.7755575615628914e-17_rk, 4.163336342344337e-17_rk,   &
        -1.734723475976807e-18_rk, 0.1402908696586216_rk, 3.469446951953614e-18_rk, 6.938893903907228e-18_rk, 0.5611634786344859_rk, 0.0_rk, -0.14029086965862153_rk, -0.5611634786344861_rk,   &
        -0.046763623219540515_rk, -6.938893903907228e-18_rk, 0.14029086965862161_rk, -0.1870544928781621_rk, -2.0816681711721685e-17_rk, 0.561163478634486_rk, 2.0816681711721685e-17_rk, 2.7755575615628914e-17_rk,   &
        -3.469446951953614e-18_rk, -0.18705449287816212_rk, -6.938893903907228e-18_rk, -6.938893903907228e-18_rk, -0.14029086965862156_rk, 0.0_rk, 0.5611634786344859_rk, 0.42087260897586476_rk,   &
        0.0_rk, -0.14029086965862156_rk, 0.0_rk, -6.938893903907228e-18_rk, -0.5611634786344861_rk, 2.7755575615628914e-17_rk, 0.42087260897586465_rk, 1.6834904359034581_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,2,3) = reshape((/ &
        0.09794150344116638_rk, -0.0979415034411664_rk, 5.204170427930421e-18_rk, 0.0734561275808748_rk, -0.07345612758087473_rk, -6.938893903907228e-18_rk, 1.0408340855860843e-17_rk, 1.734723475976807e-17_rk,   &
        -0.0979415034411664_rk, 0.2938245103234992_rk, 2.0816681711721685e-17_rk, -0.0734561275808748_rk, 0.22036838274262432_rk, -1.0408340855860843e-17_rk, 2.0816681711721685e-17_rk, 5.551115123125783e-17_rk,   &
        1.734723475976807e-17_rk, 1.734723475976807e-17_rk, 0.2938245103234992_rk, -1.0408340855860843e-17_rk, -2.0816681711721685e-17_rk, 0.2203683827426243_rk, -0.293824510323499_rk, -0.22036838274262438_rk,   &
        0.0734561275808748_rk, -0.07345612758087479_rk, -1.0408340855860843e-17_rk, 0.2938245103234992_rk, -0.293824510323499_rk, -1.3877787807814457e-16_rk, -3.469446951953614e-18_rk, 5.551115123125783e-17_rk,   &
        -0.07345612758087482_rk, 0.2203683827426243_rk, -6.938893903907228e-18_rk, -0.293824510323499_rk, 0.8814735309704971_rk, 1.0408340855860843e-16_rk, 2.0816681711721685e-17_rk, -1.1102230246251565e-16_rk,   &
        -4.5102810375396984e-17_rk, -2.42861286636753e-17_rk, 0.22036838274262435_rk, -9.71445146547012e-17_rk, -6.938893903907228e-18_rk, 0.8814735309704971_rk, -0.22036838274262438_rk, -0.8814735309704974_rk,   &
        1.734723475976807e-17_rk, -1.1102230246251565e-16_rk, -0.29382451032349904_rk, 5.204170427930421e-17_rk, 6.938893903907228e-18_rk, -0.22036838274262427_rk, 0.8814735309704971_rk, 0.6611051482278731_rk,   &
        1.734723475976807e-17_rk, 6.938893903907228e-17_rk, -0.22036838274262432_rk, 2.7755575615628914e-17_rk, -1.1102230246251565e-16_rk, -0.8814735309704973_rk, 0.6611051482278729_rk, 2.6444205929114912_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,1) = reshape((/ &
        -0.14126178380937457_rk, -0.1412617838093746_rk, 0.1412617838093746_rk, 0.022601885409499898_rk, 0.02260188540949991_rk, -0.022601885409499888_rk, 0.14126178380937454_rk, -0.0226018854094999_rk,   &
        -0.14126178380937457_rk, -0.42378535142812374_rk, 0.1412617838093746_rk, 0.02260188540949989_rk, 0.0678056562284996_rk, -0.0226018854094998_rk, 0.4237853514281236_rk, -0.06780565622849971_rk,   &
        0.14126178380937454_rk, 0.14126178380937462_rk, -0.4237853514281239_rk, -0.022601885409499905_rk, -0.022601885409499888_rk, 0.06780565622849964_rk, -0.4237853514281236_rk, 0.06780565622849963_rk,   &
        0.0226018854094999_rk, 0.02260188540949992_rk, -0.0226018854094999_rk, -0.4237853514281238_rk, -0.4237853514281235_rk, 0.4237853514281237_rk, -0.022601885409499915_rk, 0.42378535142812357_rk,   &
        0.02260188540949989_rk, 0.06780565622849968_rk, -0.022601885409499898_rk, -0.4237853514281235_rk, -1.2713560542843705_rk, 0.42378535142812357_rk, -0.06780565622849956_rk, 1.2713560542843707_rk,   &
        -0.022601885409499877_rk, -0.02260188540949992_rk, 0.06780565622849968_rk, 0.4237853514281237_rk, 0.4237853514281235_rk, -1.271356054284371_rk, 0.06780565622849949_rk, -1.2713560542843707_rk,   &
        0.14126178380937457_rk, 0.42378535142812374_rk, -0.4237853514281236_rk, -0.022601885409499853_rk, -0.06780565622849953_rk, 0.06780565622849963_rk, -1.2713560542843705_rk, 0.2034169686854991_rk,   &
        -0.02260188540949991_rk, -0.06780565622849978_rk, 0.06780565622849972_rk, 0.4237853514281237_rk, 1.2713560542843707_rk, -1.271356054284371_rk, 0.20341696868549927_rk, -3.814068162853113_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,2) = reshape((/ &
        -0.06235149762605402_rk, -8.673617379884035e-18_rk, 0.06235149762605404_rk, -0.04676362321954055_rk, 0.0_rk, 0.0467636232195405_rk, 1.0408340855860843e-17_rk, -6.938893903907228e-18_rk,   &
        5.204170427930421e-18_rk, -0.18705449287816217_rk, 1.0408340855860843e-17_rk, 0.0_rk, -0.1402908696586216_rk, 3.469446951953614e-18_rk, 0.187054492878162_rk, 0.1402908696586216_rk,   &
        0.062351497626054034_rk, 0.0_rk, -0.18705449287816214_rk, 0.04676362321954056_rk, 1.0408340855860843e-17_rk, -0.1402908696586216_rk, 2.42861286636753e-17_rk, 0.0_rk,   &
        -0.04676362321954054_rk, 1.9081958235744878e-17_rk, 0.04676362321954056_rk, -0.1870544928781621_rk, 2.7755575615628914e-17_rk, 0.1870544928781621_rk, -2.7755575615628914e-17_rk, -4.163336342344337e-17_rk,   &
        1.734723475976807e-18_rk, -0.1402908696586216_rk, -3.469446951953614e-18_rk, -6.938893903907228e-18_rk, -0.5611634786344859_rk, 0.0_rk, 0.14029086965862153_rk, 0.5611634786344861_rk,   &
        0.046763623219540515_rk, 6.938893903907228e-18_rk, -0.14029086965862161_rk, 0.1870544928781621_rk, 2.0816681711721685e-17_rk, -0.561163478634486_rk, -2.0816681711721685e-17_rk, -2.7755575615628914e-17_rk,   &
        3.469446951953614e-18_rk, 0.18705449287816212_rk, 6.938893903907228e-18_rk, 6.938893903907228e-18_rk, 0.14029086965862156_rk, 0.0_rk, -0.5611634786344859_rk, -0.42087260897586476_rk,   &
        0.0_rk, 0.14029086965862156_rk, 0.0_rk, 6.938893903907228e-18_rk, 0.5611634786344861_rk, -2.7755575615628914e-17_rk, -0.42087260897586465_rk, -1.6834904359034581_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,3,3) = reshape((/ &
        0.09794150344116638_rk, 0.0979415034411664_rk, -1.214306433183765e-17_rk, 0.0734561275808748_rk, 0.07345612758087473_rk, -4.85722573273506e-17_rk, -3.122502256758253e-17_rk, -3.469446951953614e-18_rk,   &
        0.0979415034411664_rk, 0.2938245103234992_rk, -2.0816681711721685e-17_rk, 0.0734561275808748_rk, 0.22036838274262432_rk, -3.122502256758253e-17_rk, -6.938893903907228e-18_rk, 5.551115123125783e-17_rk,   &
        1.0408340855860843e-17_rk, -3.469446951953614e-18_rk, 0.2938245103234992_rk, -1.0408340855860843e-17_rk, -6.938893903907228e-18_rk, 0.2203683827426243_rk, 0.293824510323499_rk, 0.22036838274262438_rk,   &
        0.0734561275808748_rk, 0.07345612758087479_rk, 3.469446951953614e-18_rk, 0.2938245103234992_rk, 0.293824510323499_rk, -9.71445146547012e-17_rk, 1.734723475976807e-17_rk, 2.7755575615628914e-17_rk,   &
        0.07345612758087482_rk, 0.2203683827426243_rk, 6.938893903907228e-18_rk, 0.293824510323499_rk, 0.8814735309704971_rk, -1.5959455978986625e-16_rk, 6.938893903907228e-18_rk, -5.551115123125783e-17_rk,   &
        -4.5102810375396984e-17_rk, 1.0408340855860843e-17_rk, 0.22036838274262435_rk, -1.1102230246251565e-16_rk, 6.938893903907228e-18_rk, 0.8814735309704971_rk, 0.22036838274262444_rk, 0.8814735309704972_rk,   &
        -4.5102810375396984e-17_rk, -1.249000902703301e-16_rk, 0.29382451032349904_rk, -6.591949208711867e-17_rk, 2.0816681711721685e-17_rk, 0.22036838274262427_rk, 0.8814735309704971_rk, 0.6611051482278731_rk,   &
        -3.469446951953614e-18_rk, 6.938893903907228e-17_rk, 0.22036838274262432_rk, -2.7755575615628914e-17_rk, -5.551115123125783e-17_rk, 0.8814735309704973_rk, 0.6611051482278729_rk, 2.6444205929114912_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,1) = reshape((/ &
        0.06215518487612483_rk, 0.06215518487612483_rk, -0.06215518487612484_rk, 0.028252356761874913_rk, 0.028252356761874903_rk, -0.028252356761874917_rk, -0.06215518487612482_rk, -0.028252356761874917_rk,   &
        0.06215518487612483_rk, 0.18646555462837452_rk, -0.06215518487612485_rk, 0.02825235676187494_rk, 0.08475707028562474_rk, -0.02825235676187497_rk, -0.1864655546283744_rk, -0.08475707028562474_rk,   &
        -0.062155184876124814_rk, -0.06215518487612483_rk, 0.18646555462837458_rk, -0.02825235676187494_rk, -0.02825235676187491_rk, 0.08475707028562475_rk, 0.18646555462837444_rk, 0.08475707028562476_rk,   &
        0.02825235676187491_rk, 0.028252356761874913_rk, -0.028252356761874903_rk, 0.18646555462837444_rk, 0.18646555462837436_rk, -0.18646555462837439_rk, -0.028252356761874903_rk, -0.18646555462837439_rk,   &
        0.028252356761874906_rk, 0.08475707028562474_rk, -0.028252356761874892_rk, 0.18646555462837436_rk, 0.5593966638851231_rk, -0.18646555462837447_rk, -0.08475707028562486_rk, -0.5593966638851234_rk,   &
        -0.028252356761874906_rk, -0.028252356761874906_rk, 0.08475707028562471_rk, -0.1864655546283744_rk, -0.18646555462837439_rk, 0.5593966638851234_rk, 0.08475707028562487_rk, 0.5593966638851233_rk,   &
        -0.062155184876124855_rk, -0.18646555462837444_rk, 0.18646555462837439_rk, -0.02825235676187495_rk, -0.08475707028562486_rk, 0.08475707028562476_rk, 0.5593966638851231_rk, 0.254271210856874_rk,   &
        -0.028252356761874924_rk, -0.08475707028562472_rk, 0.08475707028562472_rk, -0.1864655546283744_rk, -0.5593966638851234_rk, 0.5593966638851234_rk, 0.2542712108568742_rk, 1.67818999165537_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,2) = reshape((/ &
        -0.07793937203256751_rk, -5.204170427930421e-18_rk, 0.07793937203256752_rk, 0.09352724643908102_rk, 0.0_rk, -0.09352724643908099_rk, 1.734723475976807e-17_rk, 6.938893903907228e-18_rk,   &
        5.204170427930421e-18_rk, -0.23381811609770264_rk, 1.0408340855860843e-17_rk, 0.0_rk, 0.2805817393172429_rk, 2.42861286636753e-17_rk, 0.23381811609770245_rk, -0.280581739317243_rk,   &
        0.07793937203256754_rk, 0.0_rk, -0.23381811609770256_rk, -0.09352724643908104_rk, -1.0408340855860843e-17_rk, 0.2805817393172429_rk, 3.469446951953614e-18_rk, 0.0_rk,   &
        0.09352724643908102_rk, -1.9081958235744878e-17_rk, -0.09352724643908103_rk, -0.23381811609770262_rk, 1.3877787807814457e-17_rk, 0.23381811609770256_rk, 1.3877787807814457e-17_rk, -1.3877787807814457e-17_rk,   &
        -1.734723475976807e-18_rk, 0.2805817393172429_rk, 3.469446951953614e-18_rk, -6.938893903907228e-18_rk, -0.7014543482931073_rk, 0.0_rk, -0.2805817393172429_rk, 0.7014543482931075_rk,   &
        -0.09352724643908097_rk, -6.938893903907228e-18_rk, 0.28058173931724295_rk, 0.23381811609770253_rk, 2.0816681711721685e-17_rk, -0.7014543482931074_rk, -2.0816681711721685e-17_rk, -2.7755575615628914e-17_rk,   &
        3.469446951953614e-18_rk, 0.23381811609770253_rk, 6.938893903907228e-18_rk, -6.938893903907228e-18_rk, -0.28058173931724284_rk, 0.0_rk, -0.7014543482931073_rk, 0.8417452179517289_rk,   &
        0.0_rk, -0.28058173931724306_rk, 0.0_rk, 6.938893903907228e-18_rk, 0.7014543482931075_rk, 0.0_rk, 0.841745217951729_rk, -2.1043630448793227_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,4,3) = reshape((/ &
        0.12242687930145797_rk, 0.12242687930145796_rk, -1.5612511283791264e-17_rk, -0.14691225516174955_rk, -0.1469122551617495_rk, 6.938893903907228e-18_rk, -1.734723475976807e-17_rk, -1.0408340855860843e-17_rk,   &
        0.12242687930145796_rk, 0.36728063790437393_rk, -2.0816681711721685e-17_rk, -0.14691225516174955_rk, -0.44073676548524837_rk, -2.42861286636753e-17_rk, -2.0816681711721685e-17_rk, 5.551115123125783e-17_rk,   &
        3.469446951953614e-18_rk, -3.122502256758253e-17_rk, 0.36728063790437393_rk, 3.8163916471489756e-17_rk, 2.0816681711721685e-17_rk, -0.4407367654852484_rk, 0.3672806379043737_rk, -0.4407367654852484_rk,   &
        -0.14691225516174955_rk, -0.14691225516174955_rk, 1.0408340855860843e-17_rk, 0.36728063790437393_rk, 0.3672806379043737_rk, -6.938893903907228e-17_rk, -1.734723475976807e-17_rk, 2.7755575615628914e-17_rk,   &
        -0.1469122551617495_rk, -0.4407367654852484_rk, 6.938893903907228e-18_rk, 0.3672806379043737_rk, 1.101841913713121_rk, -1.457167719820518e-16_rk, -6.938893903907228e-18_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, 3.122502256758253e-17_rk, -0.4407367654852484_rk, -9.71445146547012e-17_rk, 2.0816681711721685e-17_rk, 1.101841913713121_rk, -0.44073676548524826_rk, 1.1018419137131215_rk,   &
        -3.122502256758253e-17_rk, -1.3877787807814457e-16_rk, 0.36728063790437376_rk, 2.42861286636753e-17_rk, -2.0816681711721685e-17_rk, -0.4407367654852483_rk, 1.101841913713121_rk, -1.3222102964557456_rk,   &
        -1.0408340855860843e-17_rk, 2.636779683484747e-16_rk, -0.4407367654852485_rk, -5.551115123125783e-17_rk, 0.0_rk, 1.1018419137131215_rk, -1.3222102964557458_rk, 3.305525741139365_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,1) = reshape((/ &
        0.062155184876124814_rk, -0.062155184876124814_rk, 0.06215518487612483_rk, 0.028252356761874913_rk, -0.028252356761874896_rk, 0.0282523567618749_rk, -0.06215518487612478_rk, -0.02825235676187491_rk,   &
        -0.06215518487612483_rk, 0.18646555462837447_rk, -0.06215518487612481_rk, -0.02825235676187492_rk, 0.08475707028562474_rk, -0.028252356761874913_rk, 0.18646555462837444_rk, 0.08475707028562479_rk,   &
        0.06215518487612483_rk, -0.0621551848761248_rk, 0.18646555462837452_rk, 0.02825235676187492_rk, -0.028252356761874917_rk, 0.08475707028562472_rk, -0.18646555462837439_rk, -0.08475707028562476_rk,   &
        0.02825235676187491_rk, -0.028252356761874906_rk, 0.028252356761874903_rk, 0.1864655546283745_rk, -0.18646555462837436_rk, 0.18646555462837427_rk, -0.028252356761874875_rk, -0.18646555462837444_rk,   &
        -0.028252356761874906_rk, 0.08475707028562476_rk, -0.028252356761874913_rk, -0.18646555462837436_rk, 0.5593966638851231_rk, -0.18646555462837425_rk, 0.08475707028562486_rk, 0.5593966638851232_rk,   &
        0.02825235676187488_rk, -0.028252356761874927_rk, 0.08475707028562471_rk, 0.18646555462837433_rk, -0.18646555462837439_rk, 0.5593966638851232_rk, -0.08475707028562485_rk, -0.5593966638851235_rk,   &
        -0.062155184876124814_rk, 0.1864655546283744_rk, -0.18646555462837444_rk, -0.02825235676187486_rk, 0.08475707028562486_rk, -0.08475707028562474_rk, 0.5593966638851231_rk, 0.254271210856874_rk,   &
        -0.028252356761874903_rk, 0.08475707028562483_rk, -0.08475707028562472_rk, -0.18646555462837436_rk, 0.5593966638851232_rk, -0.5593966638851232_rk, 0.2542712108568742_rk, 1.67818999165537_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,2) = reshape((/ &
        0.07793937203256751_rk, 8.673617379884035e-18_rk, 0.07793937203256752_rk, -0.09352724643908102_rk, 0.0_rk, -0.09352724643908097_rk, -3.469446951953614e-18_rk, -6.938893903907228e-18_rk,   &
        -1.734723475976807e-18_rk, 0.2338181160977026_rk, -3.469446951953614e-18_rk, 0.0_rk, -0.2805817393172429_rk, -1.734723475976807e-17_rk, 0.23381811609770245_rk, -0.28058173931724284_rk,   &
        0.07793937203256751_rk, 0.0_rk, 0.23381811609770256_rk, -0.09352724643908097_rk, 3.469446951953614e-18_rk, -0.2805817393172429_rk, 3.469446951953614e-18_rk, 0.0_rk,   &
        -0.09352724643908102_rk, 8.673617379884035e-18_rk, -0.093527246439081_rk, 0.23381811609770256_rk, 2.7755575615628914e-17_rk, 0.2338181160977024_rk, -2.7755575615628914e-17_rk, 2.7755575615628914e-17_rk,   &
        5.204170427930421e-18_rk, -0.2805817393172429_rk, -1.0408340855860843e-17_rk, -6.938893903907228e-18_rk, 0.7014543482931073_rk, 0.0_rk, -0.28058173931724284_rk, 0.7014543482931075_rk,   &
        -0.09352724643908097_rk, 6.938893903907228e-18_rk, -0.28058173931724295_rk, 0.23381811609770242_rk, -6.938893903907228e-18_rk, 0.7014543482931074_rk, 6.938893903907228e-18_rk, 2.7755575615628914e-17_rk,   &
        -1.0408340855860843e-17_rk, 0.23381811609770237_rk, 6.938893903907228e-18_rk, 6.938893903907228e-18_rk, -0.28058173931724284_rk, 0.0_rk, 0.7014543482931073_rk, -0.8417452179517289_rk,   &
        0.0_rk, -0.28058173931724273_rk, 0.0_rk, 6.938893903907228e-18_rk, 0.7014543482931075_rk, 2.7755575615628914e-17_rk, -0.841745217951729_rk, 2.1043630448793227_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,5,3) = reshape((/ &
        -0.12242687930145797_rk, 0.12242687930145796_rk, 5.204170427930421e-18_rk, 0.14691225516174955_rk, -0.1469122551617495_rk, -2.0816681711721685e-17_rk, -1.0408340855860843e-17_rk, 3.469446951953614e-18_rk,   &
        0.12242687930145796_rk, -0.36728063790437393_rk, -2.0816681711721685e-17_rk, -0.14691225516174955_rk, 0.44073676548524837_rk, 4.5102810375396984e-17_rk, -6.938893903907228e-18_rk, -5.551115123125783e-17_rk,   &
        -1.0408340855860843e-17_rk, -4.5102810375396984e-17_rk, -0.36728063790437393_rk, -3.8163916471489756e-17_rk, -6.938893903907228e-18_rk, 0.4407367654852484_rk, 0.3672806379043737_rk, -0.4407367654852484_rk,   &
        0.14691225516174955_rk, -0.14691225516174955_rk, -2.42861286636753e-17_rk, -0.36728063790437393_rk, 0.3672806379043737_rk, 1.3877787807814457e-16_rk, 5.204170427930421e-17_rk, 0.0_rk,   &
        -0.1469122551617495_rk, 0.4407367654852484_rk, 6.938893903907228e-18_rk, 0.3672806379043737_rk, -1.101841913713121_rk, -9.020562075079397e-17_rk, -9.020562075079397e-17_rk, 5.551115123125783e-17_rk,   &
        -3.469446951953614e-18_rk, 1.734723475976807e-17_rk, 0.4407367654852484_rk, 8.326672684688674e-17_rk, 2.0816681711721685e-17_rk, -1.101841913713121_rk, -0.4407367654852483_rk, 1.1018419137131217_rk,   &
        -3.469446951953614e-18_rk, 1.249000902703301e-16_rk, 0.36728063790437376_rk, 1.0408340855860843e-17_rk, 6.938893903907228e-18_rk, -0.4407367654852483_rk, -1.101841913713121_rk, 1.3222102964557456_rk,   &
        3.469446951953614e-18_rk, -2.636779683484747e-16_rk, -0.4407367654852485_rk, -5.551115123125783e-17_rk, 5.551115123125783e-17_rk, 1.1018419137131215_rk, 1.3222102964557458_rk, -3.305525741139365_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,1) = reshape((/ &
        -0.14126178380937457_rk, 0.1412617838093746_rk, -0.1412617838093746_rk, 0.022601885409499898_rk, -0.022601885409499915_rk, 0.022601885409499912_rk, 0.14126178380937449_rk, -0.022601885409499922_rk,   &
        0.14126178380937457_rk, -0.42378535142812374_rk, 0.14126178380937457_rk, -0.022601885409499898_rk, 0.0678056562284996_rk, -0.022601885409499856_rk, -0.42378535142812357_rk, 0.06780565622849966_rk,   &
        -0.14126178380937457_rk, 0.14126178380937454_rk, -0.4237853514281239_rk, 0.022601885409499884_rk, -0.022601885409499867_rk, 0.06780565622849961_rk, 0.42378535142812357_rk, -0.06780565622849963_rk,   &
        0.0226018854094999_rk, -0.022601885409499898_rk, 0.0226018854094999_rk, -0.42378535142812374_rk, 0.4237853514281235_rk, -0.42378535142812335_rk, -0.022601885409499915_rk, 0.4237853514281235_rk,   &
        -0.02260188540949989_rk, 0.0678056562284996_rk, -0.02260188540949989_rk, 0.42378535142812357_rk, -1.2713560542843705_rk, 0.42378535142812335_rk, 0.0678056562284995_rk, -1.2713560542843707_rk,   &
        0.022601885409499933_rk, -0.022601885409499856_rk, 0.06780565622849968_rk, -0.4237853514281234_rk, 0.4237853514281235_rk, -1.2713560542843705_rk, -0.06780565622849957_rk, 1.271356054284371_rk,   &
        0.14126178380937454_rk, -0.42378535142812346_rk, 0.42378535142812357_rk, -0.022601885409499957_rk, 0.06780565622849953_rk, -0.06780565622849966_rk, -1.2713560542843705_rk, 0.20341696868549922_rk,   &
        -0.022601885409499915_rk, 0.06780565622849945_rk, -0.06780565622849972_rk, 0.42378535142812357_rk, -1.2713560542843707_rk, 1.271356054284371_rk, 0.20341696868549927_rk, -3.814068162853113_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,2) = reshape((/ &
        0.06235149762605402_rk, 5.204170427930421e-18_rk, 0.06235149762605404_rk, 0.046763623219540536_rk, 0.0_rk, 0.04676362321954049_rk, 3.469446951953614e-18_rk, 6.938893903907228e-18_rk,   &
        -1.734723475976807e-18_rk, 0.18705449287816212_rk, -3.469446951953614e-18_rk, 0.0_rk, 0.1402908696586216_rk, -1.0408340855860843e-17_rk, 0.18705449287816206_rk, 0.14029086965862164_rk,   &
        0.062351497626054034_rk, 0.0_rk, 0.18705449287816214_rk, 0.04676362321954054_rk, -3.469446951953614e-18_rk, 0.1402908696586216_rk, -3.469446951953614e-18_rk, 0.0_rk,   &
        0.04676362321954054_rk, -8.673617379884035e-18_rk, 0.04676362321954053_rk, 0.18705449287816203_rk, 1.3877787807814457e-17_rk, 0.18705449287816192_rk, 1.3877787807814457e-17_rk, 8.326672684688674e-17_rk,   &
        -5.204170427930421e-18_rk, 0.1402908696586216_rk, 1.0408340855860843e-17_rk, -6.938893903907228e-18_rk, 0.5611634786344859_rk, 0.0_rk, 0.1402908696586216_rk, 0.5611634786344861_rk,   &
        0.04676362321954049_rk, -6.938893903907228e-18_rk, 0.14029086965862161_rk, 0.18705449287816192_rk, -6.938893903907228e-18_rk, 0.561163478634486_rk, 6.938893903907228e-18_rk, 2.7755575615628914e-17_rk,   &
        -1.0408340855860843e-17_rk, 0.18705449287816195_rk, 6.938893903907228e-18_rk, -6.938893903907228e-18_rk, 0.14029086965862156_rk, 0.0_rk, 0.5611634786344859_rk, 0.42087260897586476_rk,   &
        0.0_rk, 0.14029086965862167_rk, 0.0_rk, 6.938893903907228e-18_rk, 0.5611634786344861_rk, 5.551115123125783e-17_rk, 0.42087260897586465_rk, 1.6834904359034581_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,6,3) = reshape((/ &
        -0.09794150344116638_rk, 0.0979415034411664_rk, -5.204170427930421e-18_rk, -0.0734561275808748_rk, 0.07345612758087473_rk, 6.938893903907228e-18_rk, -1.0408340855860843e-17_rk, -1.734723475976807e-17_rk,   &
        0.0979415034411664_rk, -0.2938245103234992_rk, -2.0816681711721685e-17_rk, 0.0734561275808748_rk, -0.22036838274262432_rk, 1.0408340855860843e-17_rk, -2.0816681711721685e-17_rk, -5.551115123125783e-17_rk,   &
        -1.734723475976807e-17_rk, -1.734723475976807e-17_rk, -0.2938245103234992_rk, 1.0408340855860843e-17_rk, 2.0816681711721685e-17_rk, -0.2203683827426243_rk, 0.293824510323499_rk, 0.22036838274262438_rk,   &
        -0.0734561275808748_rk, 0.07345612758087479_rk, 1.0408340855860843e-17_rk, -0.2938245103234992_rk, 0.293824510323499_rk, 1.3877787807814457e-16_rk, 3.469446951953614e-18_rk, -5.551115123125783e-17_rk,   &
        0.07345612758087482_rk, -0.2203683827426243_rk, 6.938893903907228e-18_rk, 0.293824510323499_rk, -0.8814735309704971_rk, -1.0408340855860843e-16_rk, -2.0816681711721685e-17_rk, 1.1102230246251565e-16_rk,   &
        4.5102810375396984e-17_rk, 2.42861286636753e-17_rk, -0.22036838274262435_rk, 9.71445146547012e-17_rk, 6.938893903907228e-18_rk, -0.8814735309704971_rk, 0.22036838274262438_rk, 0.8814735309704974_rk,   &
        -1.734723475976807e-17_rk, 1.1102230246251565e-16_rk, 0.29382451032349904_rk, -5.204170427930421e-17_rk, -6.938893903907228e-18_rk, 0.22036838274262427_rk, -0.8814735309704971_rk, -0.6611051482278731_rk,   &
        -1.734723475976807e-17_rk, -6.938893903907228e-17_rk, 0.22036838274262432_rk, -2.7755575615628914e-17_rk, 1.1102230246251565e-16_rk, 0.8814735309704973_rk, -0.6611051482278729_rk, -2.6444205929114912_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,1) = reshape((/ &
        -0.14126178380937457_rk, -0.1412617838093746_rk, -0.14126178380937457_rk, 0.022601885409499898_rk, 0.022601885409499915_rk, 0.022601885409499943_rk, -0.14126178380937449_rk, 0.022601885409499922_rk,   &
        -0.14126178380937457_rk, -0.42378535142812374_rk, -0.14126178380937454_rk, 0.022601885409499898_rk, 0.0678056562284996_rk, 0.02260188540949993_rk, -0.42378535142812357_rk, 0.06780565622849966_rk,   &
        -0.14126178380937457_rk, -0.14126178380937454_rk, -0.4237853514281239_rk, 0.022601885409499884_rk, 0.022601885409499867_rk, 0.06780565622849959_rk, -0.4237853514281236_rk, 0.06780565622849963_rk,   &
        0.022601885409499894_rk, 0.022601885409499912_rk, 0.022601885409499915_rk, -0.42378535142812374_rk, -0.42378535142812357_rk, -0.4237853514281234_rk, 0.022601885409499884_rk, -0.4237853514281236_rk,   &
        0.02260188540949989_rk, 0.0678056562284996_rk, 0.02260188540949989_rk, -0.4237853514281235_rk, -1.2713560542843705_rk, -0.4237853514281233_rk, 0.06780565622849953_rk, -1.271356054284371_rk,   &
        0.022601885409499933_rk, 0.022601885409499856_rk, 0.06780565622849968_rk, -0.4237853514281234_rk, -0.42378535142812357_rk, -1.2713560542843705_rk, 0.06780565622849954_rk, -1.2713560542843707_rk,   &
        -0.14126178380937449_rk, -0.42378535142812346_rk, -0.4237853514281236_rk, 0.022601885409499957_rk, 0.06780565622849953_rk, 0.06780565622849966_rk, -1.2713560542843705_rk, 0.20341696868549922_rk,   &
        0.022601885409499915_rk, 0.06780565622849945_rk, 0.06780565622849972_rk, -0.42378535142812357_rk, -1.271356054284371_rk, -1.271356054284371_rk, 0.20341696868549927_rk, -3.814068162853113_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,2) = reshape((/ &
        -0.06235149762605402_rk, -5.204170427930421e-18_rk, -0.06235149762605404_rk, -0.046763623219540536_rk, 0.0_rk, -0.04676362321954049_rk, -3.469446951953614e-18_rk, -6.938893903907228e-18_rk,   &
        1.734723475976807e-18_rk, -0.18705449287816212_rk, 3.469446951953614e-18_rk, 0.0_rk, -0.1402908696586216_rk, 1.0408340855860843e-17_rk, -0.18705449287816206_rk, -0.14029086965862164_rk,   &
        -0.062351497626054034_rk, 0.0_rk, -0.18705449287816214_rk, -0.04676362321954054_rk, 3.469446951953614e-18_rk, -0.1402908696586216_rk, 3.469446951953614e-18_rk, 0.0_rk,   &
        -0.04676362321954054_rk, 8.673617379884035e-18_rk, -0.04676362321954053_rk, -0.18705449287816203_rk, -1.3877787807814457e-17_rk, -0.18705449287816192_rk, -1.3877787807814457e-17_rk, -8.326672684688674e-17_rk,   &
        5.204170427930421e-18_rk, -0.1402908696586216_rk, -1.0408340855860843e-17_rk, 6.938893903907228e-18_rk, -0.5611634786344859_rk, 0.0_rk, -0.1402908696586216_rk, -0.5611634786344861_rk,   &
        -0.04676362321954049_rk, 6.938893903907228e-18_rk, -0.14029086965862161_rk, -0.18705449287816192_rk, 6.938893903907228e-18_rk, -0.561163478634486_rk, -6.938893903907228e-18_rk, -2.7755575615628914e-17_rk,   &
        1.0408340855860843e-17_rk, -0.18705449287816195_rk, -6.938893903907228e-18_rk, 6.938893903907228e-18_rk, -0.14029086965862156_rk, 0.0_rk, -0.5611634786344859_rk, -0.42087260897586476_rk,   &
        0.0_rk, -0.14029086965862167_rk, 0.0_rk, -6.938893903907228e-18_rk, -0.5611634786344861_rk, -5.551115123125783e-17_rk, -0.42087260897586465_rk, -1.6834904359034581_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,7,3) = reshape((/ &
        -0.09794150344116638_rk, -0.0979415034411664_rk, 1.214306433183765e-17_rk, -0.0734561275808748_rk, -0.07345612758087473_rk, 4.85722573273506e-17_rk, 3.122502256758253e-17_rk, 3.469446951953614e-18_rk,   &
        -0.0979415034411664_rk, -0.2938245103234992_rk, 2.0816681711721685e-17_rk, -0.0734561275808748_rk, -0.22036838274262432_rk, 3.122502256758253e-17_rk, 6.938893903907228e-18_rk, -5.551115123125783e-17_rk,   &
        -1.0408340855860843e-17_rk, 3.469446951953614e-18_rk, -0.2938245103234992_rk, 1.0408340855860843e-17_rk, 6.938893903907228e-18_rk, -0.2203683827426243_rk, -0.293824510323499_rk, -0.22036838274262438_rk,   &
        -0.0734561275808748_rk, -0.07345612758087479_rk, -3.469446951953614e-18_rk, -0.2938245103234992_rk, -0.293824510323499_rk, 9.71445146547012e-17_rk, -1.734723475976807e-17_rk, -2.7755575615628914e-17_rk,   &
        -0.07345612758087482_rk, -0.2203683827426243_rk, -6.938893903907228e-18_rk, -0.293824510323499_rk, -0.8814735309704971_rk, 1.5959455978986625e-16_rk, -6.938893903907228e-18_rk, 5.551115123125783e-17_rk,   &
        4.5102810375396984e-17_rk, -1.0408340855860843e-17_rk, -0.22036838274262435_rk, 1.1102230246251565e-16_rk, -6.938893903907228e-18_rk, -0.8814735309704971_rk, -0.22036838274262444_rk, -0.8814735309704972_rk,   &
        4.5102810375396984e-17_rk, 1.249000902703301e-16_rk, -0.29382451032349904_rk, 6.591949208711867e-17_rk, -2.0816681711721685e-17_rk, -0.22036838274262427_rk, -0.8814735309704971_rk, -0.6611051482278731_rk,   &
        3.469446951953614e-18_rk, -6.938893903907228e-17_rk, -0.22036838274262432_rk, 2.7755575615628914e-17_rk, 5.551115123125783e-17_rk, -0.8814735309704973_rk, -0.6611051482278729_rk, -2.6444205929114912_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,1) = reshape((/ &
        0.062155184876124814_rk, 0.06215518487612483_rk, 0.062155184876124814_rk, 0.028252356761874913_rk, 0.028252356761874896_rk, 0.02825235676187489_rk, 0.06215518487612478_rk, 0.02825235676187491_rk,   &
        0.06215518487612484_rk, 0.18646555462837447_rk, 0.062155184876124814_rk, 0.02825235676187492_rk, 0.08475707028562474_rk, 0.028252356761874875_rk, 0.1864655546283744_rk, 0.08475707028562479_rk,   &
        0.06215518487612483_rk, 0.06215518487612483_rk, 0.18646555462837452_rk, 0.02825235676187492_rk, 0.028252356761874917_rk, 0.08475707028562475_rk, 0.18646555462837444_rk, 0.08475707028562476_rk,   &
        0.028252356761874903_rk, 0.02825235676187492_rk, 0.028252356761874903_rk, 0.1864655546283745_rk, 0.1864655546283744_rk, 0.18646555462837433_rk, 0.028252356761874927_rk, 0.18646555462837444_rk,   &
        0.028252356761874906_rk, 0.08475707028562476_rk, 0.028252356761874913_rk, 0.1864655546283743_rk, 0.5593966638851231_rk, 0.18646555462837416_rk, 0.08475707028562483_rk, 0.5593966638851233_rk,   &
        0.02825235676187488_rk, 0.028252356761874927_rk, 0.08475707028562471_rk, 0.1864655546283743_rk, 0.1864655546283744_rk, 0.5593966638851232_rk, 0.08475707028562482_rk, 0.5593966638851233_rk,   &
        0.062155184876124786_rk, 0.18646555462837439_rk, 0.18646555462837439_rk, 0.02825235676187486_rk, 0.08475707028562486_rk, 0.08475707028562474_rk, 0.5593966638851231_rk, 0.254271210856874_rk,   &
        0.028252356761874903_rk, 0.08475707028562483_rk, 0.08475707028562472_rk, 0.18646555462837439_rk, 0.5593966638851233_rk, 0.5593966638851232_rk, 0.2542712108568742_rk, 1.67818999165537_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,2) = reshape((/ &
        -0.07793937203256751_rk, -8.673617379884035e-18_rk, -0.07793937203256752_rk, 0.09352724643908102_rk, 0.0_rk, 0.09352724643908097_rk, 3.469446951953614e-18_rk, 6.938893903907228e-18_rk,   &
        1.734723475976807e-18_rk, -0.2338181160977026_rk, 3.469446951953614e-18_rk, 0.0_rk, 0.2805817393172429_rk, 1.734723475976807e-17_rk, -0.23381811609770245_rk, 0.28058173931724284_rk,   &
        -0.07793937203256751_rk, 0.0_rk, -0.23381811609770256_rk, 0.09352724643908097_rk, -3.469446951953614e-18_rk, 0.2805817393172429_rk, -3.469446951953614e-18_rk, 0.0_rk,   &
        0.09352724643908102_rk, -8.673617379884035e-18_rk, 0.093527246439081_rk, -0.23381811609770256_rk, -2.7755575615628914e-17_rk, -0.2338181160977024_rk, 2.7755575615628914e-17_rk, -2.7755575615628914e-17_rk,   &
        -5.204170427930421e-18_rk, 0.2805817393172429_rk, 1.0408340855860843e-17_rk, 6.938893903907228e-18_rk, -0.7014543482931073_rk, 0.0_rk, 0.28058173931724284_rk, -0.7014543482931075_rk,   &
        0.09352724643908097_rk, -6.938893903907228e-18_rk, 0.28058173931724295_rk, -0.23381811609770242_rk, 6.938893903907228e-18_rk, -0.7014543482931074_rk, -6.938893903907228e-18_rk, -2.7755575615628914e-17_rk,   &
        1.0408340855860843e-17_rk, -0.23381811609770237_rk, -6.938893903907228e-18_rk, -6.938893903907228e-18_rk, 0.28058173931724284_rk, 0.0_rk, -0.7014543482931073_rk, 0.8417452179517289_rk,   &
        0.0_rk, 0.28058173931724273_rk, 0.0_rk, -6.938893903907228e-18_rk, -0.7014543482931075_rk, -2.7755575615628914e-17_rk, 0.841745217951729_rk, -2.1043630448793227_rk   &
        /),(/8,8/))
        test_dinvmass_dx(:,:,8,3) = reshape((/ &
        -0.12242687930145797_rk, -0.12242687930145796_rk, 1.5612511283791264e-17_rk, 0.14691225516174955_rk, 0.1469122551617495_rk, -6.938893903907228e-18_rk, 1.734723475976807e-17_rk, 1.0408340855860843e-17_rk,   &
        -0.12242687930145796_rk, -0.36728063790437393_rk, 2.0816681711721685e-17_rk, 0.14691225516174955_rk, 0.44073676548524837_rk, 2.42861286636753e-17_rk, 2.0816681711721685e-17_rk, -5.551115123125783e-17_rk,   &
        -3.469446951953614e-18_rk, 3.122502256758253e-17_rk, -0.36728063790437393_rk, -3.8163916471489756e-17_rk, -2.0816681711721685e-17_rk, 0.4407367654852484_rk, -0.3672806379043737_rk, 0.4407367654852484_rk,   &
        0.14691225516174955_rk, 0.14691225516174955_rk, -1.0408340855860843e-17_rk, -0.36728063790437393_rk, -0.3672806379043737_rk, 6.938893903907228e-17_rk, 1.734723475976807e-17_rk, -2.7755575615628914e-17_rk,   &
        0.1469122551617495_rk, 0.4407367654852484_rk, -6.938893903907228e-18_rk, -0.3672806379043737_rk, -1.101841913713121_rk, 1.457167719820518e-16_rk, 6.938893903907228e-18_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, -3.122502256758253e-17_rk, 0.4407367654852484_rk, 9.71445146547012e-17_rk, -2.0816681711721685e-17_rk, -1.101841913713121_rk, 0.44073676548524826_rk, -1.1018419137131215_rk,   &
        3.122502256758253e-17_rk, 1.3877787807814457e-16_rk, -0.36728063790437376_rk, -2.42861286636753e-17_rk, 2.0816681711721685e-17_rk, 0.4407367654852483_rk, -1.101841913713121_rk, 1.3222102964557456_rk,   &
        1.0408340855860843e-17_rk, -2.636779683484747e-16_rk, 0.4407367654852485_rk, 5.551115123125783e-17_rk, 0.0_rk, -1.1018419137131215_rk, 1.3222102964557458_rk, -3.305525741139365_rk   &
        /),(/8,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dinvmass_dx(:,:,inode_diff,idir)),self%elem%dinvmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dinvmass_dx
    !*******************************************************************************************








    !> Test cartesian dmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmass_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dmass_dx
        ! 
        test_dmass_dx(:,:,1,1) = reshape((/ &
        -0.39269908169872414_rk, 0.13089969389957468_rk, 0.13089969389957468_rk, -0.13089969389957465_rk, 0.043633231299858216_rk, 0.043633231299858216_rk, -0.04363323129985824_rk, -0.014544410433286081_rk,   &
        0.13089969389957468_rk, -0.13089969389957473_rk, -0.04363323129985824_rk, 0.043633231299858216_rk, -0.043633231299858216_rk, -0.014544410433286081_rk, 0.04363323129985824_rk, 0.014544410433286078_rk,   &
        0.13089969389957468_rk, -0.04363323129985824_rk, -0.13089969389957473_rk, 0.043633231299858216_rk, -0.014544410433286081_rk, -0.043633231299858216_rk, 0.04363323129985823_rk, 0.014544410433286078_rk,   &
        -0.13089969389957465_rk, 0.043633231299858216_rk, 0.043633231299858216_rk, -0.13089969389957473_rk, 0.04363323129985823_rk, 0.04363323129985824_rk, -0.014544410433286081_rk, -0.014544410433286073_rk,   &
        0.043633231299858216_rk, -0.043633231299858216_rk, -0.014544410433286081_rk, 0.04363323129985823_rk, -0.04363323129985823_rk, -0.014544410433286085_rk, 0.01454441043328608_rk, 0.014544410433286081_rk,   &
        0.043633231299858216_rk, -0.014544410433286081_rk, -0.043633231299858216_rk, 0.04363323129985824_rk, -0.014544410433286085_rk, -0.04363323129985823_rk, 0.014544410433286081_rk, 0.014544410433286081_rk,   &
        -0.04363323129985824_rk, 0.04363323129985824_rk, 0.04363323129985823_rk, -0.014544410433286081_rk, 0.01454441043328608_rk, 0.014544410433286081_rk, -0.04363323129985823_rk, -0.014544410433286078_rk,   &
        -0.014544410433286081_rk, 0.014544410433286078_rk, 0.014544410433286078_rk, -0.014544410433286073_rk, 0.014544410433286081_rk, 0.014544410433286081_rk, -0.014544410433286078_rk, -0.014544410433286074_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,1,2) = reshape((/ &
        -0.3333333333333333_rk, 3.469446951953614e-18_rk, 0.1111111111111111_rk, 0.08333333333333331_rk, 2.6020852139652106e-18_rk, -0.02777777777777777_rk, 1.734723475976807e-18_rk, -4.336808689942018e-19_rk,   &
        3.469446951953614e-18_rk, -0.1111111111111111_rk, 1.734723475976807e-18_rk, 2.6020852139652106e-18_rk, 0.02777777777777777_rk, -4.336808689942018e-19_rk, 0.03703703703703703_rk, -0.009259259259259257_rk,   &
        0.1111111111111111_rk, 1.734723475976807e-18_rk, -0.1111111111111111_rk, -0.02777777777777777_rk, -4.336808689942018e-19_rk, 0.02777777777777777_rk, -1.734723475976807e-18_rk, -4.336808689942018e-19_rk,   &
        0.08333333333333331_rk, 2.6020852139652106e-18_rk, -0.02777777777777777_rk, -0.1111111111111111_rk, -1.734723475976807e-18_rk, 0.03703703703703703_rk, -4.336808689942018e-19_rk, 4.336808689942018e-19_rk,   &
        2.6020852139652106e-18_rk, 0.02777777777777777_rk, -4.336808689942018e-19_rk, -1.734723475976807e-18_rk, -0.037037037037037035_rk, -4.336808689942018e-19_rk, -0.009259259259259264_rk, 0.012345679012345675_rk,   &
        -0.02777777777777777_rk, -4.336808689942018e-19_rk, 0.02777777777777777_rk, 0.03703703703703703_rk, -4.336808689942018e-19_rk, -0.037037037037037035_rk, 2.168404344971009e-19_rk, 0.0_rk,   &
        1.734723475976807e-18_rk, 0.03703703703703703_rk, -1.734723475976807e-18_rk, -4.336808689942018e-19_rk, -0.009259259259259264_rk, 2.168404344971009e-19_rk, -0.037037037037037035_rk, 0.009259259259259255_rk,   &
        -4.336808689942018e-19_rk, -0.009259259259259257_rk, -4.336808689942018e-19_rk, 4.336808689942018e-19_rk, 0.012345679012345675_rk, 0.0_rk, 0.009259259259259255_rk, -0.012345679012345675_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,1,3) = reshape((/ &
        -0.5235987755982989_rk, 0.17453292519943292_rk, 3.469446951953614e-18_rk, 0.1308996938995747_rk, -0.043633231299858244_rk, -4.336808689942018e-18_rk, -4.336808689942018e-18_rk, 4.336808689942018e-18_rk,   &
        0.17453292519943292_rk, -0.17453292519943298_rk, -4.336808689942018e-18_rk, -0.043633231299858244_rk, 0.043633231299858244_rk, 4.336808689942018e-18_rk, 6.938893903907228e-18_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, -4.336808689942018e-18_rk, -0.17453292519943298_rk, -4.336808689942018e-18_rk, 4.336808689942018e-18_rk, 0.043633231299858244_rk, 0.05817764173314432_rk, -0.014544410433286078_rk,   &
        0.1308996938995747_rk, -0.043633231299858244_rk, -4.336808689942018e-18_rk, -0.17453292519943298_rk, 0.05817764173314432_rk, 6.938893903907228e-18_rk, 4.336808689942018e-18_rk, 1.734723475976807e-18_rk,   &
        -0.043633231299858244_rk, 0.043633231299858244_rk, 4.336808689942018e-18_rk, 0.05817764173314432_rk, -0.05817764173314432_rk, -1.734723475976807e-18_rk, -1.734723475976807e-18_rk, 4.336808689942018e-19_rk,   &
        -4.336808689942018e-18_rk, 4.336808689942018e-18_rk, 0.043633231299858244_rk, 6.938893903907228e-18_rk, -1.734723475976807e-18_rk, -0.05817764173314432_rk, -0.014544410433286087_rk, 0.019392547244381438_rk,   &
        -4.336808689942018e-18_rk, 6.938893903907228e-18_rk, 0.05817764173314432_rk, 4.336808689942018e-18_rk, -1.734723475976807e-18_rk, -0.014544410433286087_rk, -0.05817764173314432_rk, 0.014544410433286081_rk,   &
        4.336808689942018e-18_rk, 0.0_rk, -0.014544410433286078_rk, 1.734723475976807e-18_rk, 4.336808689942018e-19_rk, 0.019392547244381438_rk, 0.014544410433286081_rk, -0.019392547244381435_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,1) = reshape((/ &
        0.7853981633974483_rk, -0.2617993877991494_rk, -0.2617993877991494_rk, 0.13089969389957465_rk, -0.043633231299858216_rk, -0.043633231299858216_rk, 0.08726646259971647_rk, 0.014544410433286081_rk,   &
        -0.2617993877991494_rk, 0.2617993877991494_rk, 0.08726646259971647_rk, -0.043633231299858216_rk, 0.043633231299858216_rk, 0.014544410433286081_rk, -0.08726646259971649_rk, -0.014544410433286078_rk,   &
        -0.2617993877991494_rk, 0.08726646259971647_rk, 0.2617993877991494_rk, -0.043633231299858216_rk, 0.014544410433286081_rk, 0.043633231299858216_rk, -0.08726646259971647_rk, -0.014544410433286078_rk,   &
        0.13089969389957465_rk, -0.043633231299858216_rk, -0.043633231299858216_rk, 0.2617993877991494_rk, -0.08726646259971647_rk, -0.08726646259971649_rk, 0.014544410433286081_rk, 0.029088820866572152_rk,   &
        -0.043633231299858216_rk, 0.043633231299858216_rk, 0.014544410433286081_rk, -0.08726646259971647_rk, 0.08726646259971647_rk, 0.029088820866572163_rk, -0.014544410433286081_rk, -0.02908882086657216_rk,   &
        -0.043633231299858216_rk, 0.014544410433286081_rk, 0.043633231299858216_rk, -0.08726646259971649_rk, 0.029088820866572163_rk, 0.08726646259971647_rk, -0.014544410433286081_rk, -0.02908882086657216_rk,   &
        0.08726646259971647_rk, -0.08726646259971649_rk, -0.08726646259971647_rk, 0.014544410433286081_rk, -0.014544410433286081_rk, -0.014544410433286081_rk, 0.08726646259971647_rk, 0.014544410433286078_rk,   &
        0.014544410433286081_rk, -0.014544410433286078_rk, -0.014544410433286078_rk, 0.029088820866572152_rk, -0.02908882086657216_rk, -0.02908882086657216_rk, 0.014544410433286078_rk, 0.029088820866572156_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,2) = reshape((/ &
        -0.4166666666666667_rk, 3.469446951953614e-18_rk, 0.1388888888888889_rk, -0.16666666666666669_rk, -2.6020852139652106e-18_rk, 0.055555555555555546_rk, 1.734723475976807e-18_rk, 4.336808689942018e-19_rk,   &
        3.469446951953614e-18_rk, -0.1388888888888889_rk, 1.734723475976807e-18_rk, -2.6020852139652106e-18_rk, -0.055555555555555546_rk, 4.336808689942018e-19_rk, 0.04629629629629629_rk, 0.01851851851851851_rk,   &
        0.1388888888888889_rk, 1.734723475976807e-18_rk, -0.1388888888888889_rk, 0.055555555555555546_rk, 4.336808689942018e-19_rk, -0.055555555555555546_rk, -1.734723475976807e-18_rk, 4.336808689942018e-19_rk,   &
        -0.16666666666666669_rk, -2.6020852139652106e-18_rk, 0.055555555555555546_rk, -0.1388888888888889_rk, -1.734723475976807e-18_rk, 0.04629629629629629_rk, 4.336808689942018e-19_rk, 4.336808689942018e-19_rk,   &
        -2.6020852139652106e-18_rk, -0.055555555555555546_rk, 4.336808689942018e-19_rk, -1.734723475976807e-18_rk, -0.046296296296296294_rk, -4.336808689942018e-19_rk, 0.018518518518518517_rk, 0.015432098765432094_rk,   &
        0.055555555555555546_rk, 4.336808689942018e-19_rk, -0.055555555555555546_rk, 0.04629629629629629_rk, -4.336808689942018e-19_rk, -0.046296296296296294_rk, -2.168404344971009e-19_rk, 0.0_rk,   &
        1.734723475976807e-18_rk, 0.04629629629629629_rk, -1.734723475976807e-18_rk, 4.336808689942018e-19_rk, 0.018518518518518517_rk, -2.168404344971009e-19_rk, -0.046296296296296294_rk, -0.018518518518518514_rk,   &
        4.336808689942018e-19_rk, 0.01851851851851851_rk, 4.336808689942018e-19_rk, 4.336808689942018e-19_rk, 0.015432098765432094_rk, 0.0_rk, -0.018518518518518514_rk, -0.015432098765432094_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,2,3) = reshape((/ &
        -0.6544984694978735_rk, 0.21816615649929116_rk, -3.469446951953614e-18_rk, -0.26179938779914935_rk, 0.08726646259971646_rk, 4.336808689942018e-18_rk, -2.6020852139652106e-18_rk, -2.6020852139652106e-18_rk,   &
        0.21816615649929116_rk, -0.21816615649929116_rk, -2.6020852139652106e-18_rk, 0.08726646259971646_rk, -0.08726646259971646_rk, -2.6020852139652106e-18_rk, 5.204170427930421e-18_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, -2.6020852139652106e-18_rk, -0.21816615649929116_rk, 4.336808689942018e-18_rk, -2.6020852139652106e-18_rk, -0.08726646259971646_rk, 0.07272205216643039_rk, 0.029088820866572152_rk,   &
        -0.26179938779914935_rk, 0.08726646259971646_rk, 4.336808689942018e-18_rk, -0.21816615649929116_rk, 0.07272205216643039_rk, 5.204170427930421e-18_rk, -2.6020852139652106e-18_rk, 2.6020852139652106e-18_rk,   &
        0.08726646259971646_rk, -0.08726646259971646_rk, -2.6020852139652106e-18_rk, 0.07272205216643039_rk, -0.07272205216643039_rk, -1.734723475976807e-18_rk, 0.0_rk, 1.3010426069826053e-18_rk,   &
        4.336808689942018e-18_rk, -2.6020852139652106e-18_rk, -0.08726646259971646_rk, 5.204170427930421e-18_rk, -1.734723475976807e-18_rk, -0.07272205216643039_rk, 0.02908882086657216_rk, 0.0242406840554768_rk,   &
        -2.6020852139652106e-18_rk, 5.204170427930421e-18_rk, 0.07272205216643039_rk, -2.6020852139652106e-18_rk, 0.0_rk, 0.02908882086657216_rk, -0.07272205216643039_rk, -0.029088820866572156_rk,   &
        -2.6020852139652106e-18_rk, 0.0_rk, 0.029088820866572152_rk, 2.6020852139652106e-18_rk, 1.3010426069826053e-18_rk, 0.0242406840554768_rk, -0.029088820866572156_rk, -0.024240684055476795_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,1) = reshape((/ &
        0.7853981633974483_rk, 0.2617993877991494_rk, -0.2617993877991494_rk, 0.13089969389957465_rk, 0.043633231299858216_rk, -0.043633231299858216_rk, -0.08726646259971647_rk, -0.014544410433286081_rk,   &
        0.2617993877991494_rk, 0.2617993877991494_rk, -0.08726646259971647_rk, 0.043633231299858216_rk, 0.043633231299858216_rk, -0.014544410433286081_rk, -0.08726646259971647_rk, -0.014544410433286078_rk,   &
        -0.2617993877991494_rk, -0.08726646259971647_rk, 0.2617993877991494_rk, -0.043633231299858216_rk, -0.014544410433286081_rk, 0.043633231299858216_rk, 0.08726646259971647_rk, 0.014544410433286078_rk,   &
        0.13089969389957465_rk, 0.043633231299858216_rk, -0.043633231299858216_rk, 0.2617993877991494_rk, 0.08726646259971647_rk, -0.08726646259971647_rk, -0.014544410433286081_rk, -0.029088820866572156_rk,   &
        0.043633231299858216_rk, 0.043633231299858216_rk, -0.014544410433286081_rk, 0.08726646259971647_rk, 0.08726646259971647_rk, -0.02908882086657216_rk, -0.014544410433286081_rk, -0.02908882086657216_rk,   &
        -0.043633231299858216_rk, -0.014544410433286081_rk, 0.043633231299858216_rk, -0.08726646259971647_rk, -0.02908882086657216_rk, 0.08726646259971647_rk, 0.014544410433286081_rk, 0.029088820866572156_rk,   &
        -0.08726646259971647_rk, -0.08726646259971647_rk, 0.08726646259971647_rk, -0.014544410433286081_rk, -0.014544410433286081_rk, 0.014544410433286081_rk, 0.08726646259971647_rk, 0.014544410433286078_rk,   &
        -0.014544410433286081_rk, -0.014544410433286078_rk, 0.014544410433286078_rk, -0.029088820866572156_rk, -0.02908882086657216_rk, 0.029088820866572156_rk, 0.014544410433286078_rk, 0.029088820866572156_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,2) = reshape((/ &
        0.4166666666666667_rk, -3.469446951953614e-18_rk, -0.1388888888888889_rk, 0.16666666666666669_rk, 2.6020852139652106e-18_rk, -0.055555555555555546_rk, -1.734723475976807e-18_rk, -4.336808689942018e-19_rk,   &
        -3.469446951953614e-18_rk, 0.1388888888888889_rk, -1.734723475976807e-18_rk, 2.6020852139652106e-18_rk, 0.055555555555555546_rk, -4.336808689942018e-19_rk, -0.04629629629629629_rk, -0.01851851851851851_rk,   &
        -0.1388888888888889_rk, -1.734723475976807e-18_rk, 0.1388888888888889_rk, -0.055555555555555546_rk, -4.336808689942018e-19_rk, 0.055555555555555546_rk, 1.734723475976807e-18_rk, -4.336808689942018e-19_rk,   &
        0.16666666666666669_rk, 2.6020852139652106e-18_rk, -0.055555555555555546_rk, 0.1388888888888889_rk, 1.734723475976807e-18_rk, -0.04629629629629629_rk, -4.336808689942018e-19_rk, -4.336808689942018e-19_rk,   &
        2.6020852139652106e-18_rk, 0.055555555555555546_rk, -4.336808689942018e-19_rk, 1.734723475976807e-18_rk, 0.046296296296296294_rk, 4.336808689942018e-19_rk, -0.018518518518518517_rk, -0.015432098765432094_rk,   &
        -0.055555555555555546_rk, -4.336808689942018e-19_rk, 0.055555555555555546_rk, -0.04629629629629629_rk, 4.336808689942018e-19_rk, 0.046296296296296294_rk, 2.168404344971009e-19_rk, 0.0_rk,   &
        -1.734723475976807e-18_rk, -0.04629629629629629_rk, 1.734723475976807e-18_rk, -4.336808689942018e-19_rk, -0.018518518518518517_rk, 2.168404344971009e-19_rk, 0.046296296296296294_rk, 0.018518518518518514_rk,   &
        -4.336808689942018e-19_rk, -0.01851851851851851_rk, -4.336808689942018e-19_rk, -4.336808689942018e-19_rk, -0.015432098765432094_rk, 0.0_rk, 0.018518518518518514_rk, 0.015432098765432094_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,3,3) = reshape((/ &
        -0.6544984694978735_rk, -0.21816615649929116_rk, -3.469446951953614e-18_rk, -0.26179938779914935_rk, -0.08726646259971646_rk, 2.6020852139652106e-18_rk, 2.6020852139652106e-18_rk, -2.6020852139652106e-18_rk,   &
        -0.21816615649929116_rk, -0.21816615649929116_rk, 2.6020852139652106e-18_rk, -0.08726646259971646_rk, -0.08726646259971646_rk, -2.6020852139652106e-18_rk, 0.0_rk, -8.673617379884035e-19_rk,   &
        -3.469446951953614e-18_rk, 2.6020852139652106e-18_rk, -0.21816615649929116_rk, 2.6020852139652106e-18_rk, -2.6020852139652106e-18_rk, -0.08726646259971646_rk, -0.07272205216643039_rk, -0.029088820866572152_rk,   &
        -0.26179938779914935_rk, -0.08726646259971646_rk, 2.6020852139652106e-18_rk, -0.21816615649929116_rk, -0.07272205216643039_rk, 0.0_rk, -2.6020852139652106e-18_rk, 8.673617379884035e-19_rk,   &
        -0.08726646259971646_rk, -0.08726646259971646_rk, -2.6020852139652106e-18_rk, -0.07272205216643039_rk, -0.07272205216643039_rk, 0.0_rk, 0.0_rk, 1.3010426069826053e-18_rk,   &
        2.6020852139652106e-18_rk, -2.6020852139652106e-18_rk, -0.08726646259971646_rk, 0.0_rk, 0.0_rk, -0.07272205216643039_rk, -0.029088820866572156_rk, -0.0242406840554768_rk,   &
        2.6020852139652106e-18_rk, 0.0_rk, -0.07272205216643039_rk, -2.6020852139652106e-18_rk, 0.0_rk, -0.029088820866572156_rk, -0.07272205216643039_rk, -0.029088820866572156_rk,   &
        -2.6020852139652106e-18_rk, -8.673617379884035e-19_rk, -0.029088820866572152_rk, 8.673617379884035e-19_rk, 1.3010426069826053e-18_rk, -0.0242406840554768_rk, -0.029088820866572156_rk, -0.024240684055476795_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,1) = reshape((/ &
        -0.39269908169872414_rk, -0.13089969389957468_rk, 0.13089969389957468_rk, -0.13089969389957465_rk, -0.043633231299858216_rk, 0.043633231299858216_rk, 0.04363323129985824_rk, 0.014544410433286081_rk,   &
        -0.13089969389957468_rk, -0.13089969389957473_rk, 0.04363323129985824_rk, -0.043633231299858216_rk, -0.043633231299858216_rk, 0.014544410433286081_rk, 0.04363323129985823_rk, 0.014544410433286078_rk,   &
        0.13089969389957468_rk, 0.04363323129985824_rk, -0.13089969389957473_rk, 0.043633231299858216_rk, 0.014544410433286081_rk, -0.043633231299858216_rk, -0.04363323129985823_rk, -0.014544410433286078_rk,   &
        -0.13089969389957465_rk, -0.043633231299858216_rk, 0.043633231299858216_rk, -0.13089969389957473_rk, -0.04363323129985823_rk, 0.04363323129985823_rk, 0.014544410433286081_rk, 0.014544410433286078_rk,   &
        -0.043633231299858216_rk, -0.043633231299858216_rk, 0.014544410433286081_rk, -0.04363323129985823_rk, -0.04363323129985823_rk, 0.014544410433286083_rk, 0.01454441043328608_rk, 0.014544410433286081_rk,   &
        0.043633231299858216_rk, 0.014544410433286081_rk, -0.043633231299858216_rk, 0.04363323129985823_rk, 0.014544410433286083_rk, -0.04363323129985823_rk, -0.014544410433286081_rk, -0.014544410433286078_rk,   &
        0.04363323129985824_rk, 0.04363323129985823_rk, -0.04363323129985823_rk, 0.014544410433286081_rk, 0.01454441043328608_rk, -0.014544410433286081_rk, -0.04363323129985823_rk, -0.014544410433286078_rk,   &
        0.014544410433286081_rk, 0.014544410433286078_rk, -0.014544410433286078_rk, 0.014544410433286078_rk, 0.014544410433286081_rk, -0.014544410433286078_rk, -0.014544410433286078_rk, -0.014544410433286074_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,2) = reshape((/ &
        0.3333333333333333_rk, -3.469446951953614e-18_rk, -0.1111111111111111_rk, -0.08333333333333331_rk, -2.6020852139652106e-18_rk, 0.02777777777777777_rk, -1.734723475976807e-18_rk, 4.336808689942018e-19_rk,   &
        -3.469446951953614e-18_rk, 0.1111111111111111_rk, -1.734723475976807e-18_rk, -2.6020852139652106e-18_rk, -0.02777777777777777_rk, 4.336808689942018e-19_rk, -0.03703703703703703_rk, 0.009259259259259257_rk,   &
        -0.1111111111111111_rk, -1.734723475976807e-18_rk, 0.1111111111111111_rk, 0.02777777777777777_rk, 4.336808689942018e-19_rk, -0.02777777777777777_rk, 1.734723475976807e-18_rk, 4.336808689942018e-19_rk,   &
        -0.08333333333333331_rk, -2.6020852139652106e-18_rk, 0.02777777777777777_rk, 0.1111111111111111_rk, 1.734723475976807e-18_rk, -0.03703703703703703_rk, 4.336808689942018e-19_rk, -4.336808689942018e-19_rk,   &
        -2.6020852139652106e-18_rk, -0.02777777777777777_rk, 4.336808689942018e-19_rk, 1.734723475976807e-18_rk, 0.037037037037037035_rk, 4.336808689942018e-19_rk, 0.009259259259259264_rk, -0.012345679012345675_rk,   &
        0.02777777777777777_rk, 4.336808689942018e-19_rk, -0.02777777777777777_rk, -0.03703703703703703_rk, 4.336808689942018e-19_rk, 0.037037037037037035_rk, -2.168404344971009e-19_rk, 0.0_rk,   &
        -1.734723475976807e-18_rk, -0.03703703703703703_rk, 1.734723475976807e-18_rk, 4.336808689942018e-19_rk, 0.009259259259259264_rk, -2.168404344971009e-19_rk, 0.037037037037037035_rk, -0.009259259259259255_rk,   &
        4.336808689942018e-19_rk, 0.009259259259259257_rk, 4.336808689942018e-19_rk, -4.336808689942018e-19_rk, -0.012345679012345675_rk, 0.0_rk, -0.009259259259259255_rk, 0.012345679012345675_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,4,3) = reshape((/ &
        -0.5235987755982989_rk, -0.17453292519943292_rk, 3.469446951953614e-18_rk, 0.1308996938995747_rk, 0.043633231299858244_rk, -2.6020852139652106e-18_rk, 4.336808689942018e-18_rk, 8.673617379884035e-19_rk,   &
        -0.17453292519943292_rk, -0.17453292519943298_rk, 4.336808689942018e-18_rk, 0.043633231299858244_rk, 0.043633231299858244_rk, 8.673617379884035e-19_rk, 1.734723475976807e-18_rk, 8.673617379884035e-19_rk,   &
        3.469446951953614e-18_rk, 4.336808689942018e-18_rk, -0.17453292519943298_rk, -2.6020852139652106e-18_rk, 8.673617379884035e-19_rk, 0.043633231299858244_rk, -0.05817764173314432_rk, 0.014544410433286078_rk,   &
        0.1308996938995747_rk, 0.043633231299858244_rk, -2.6020852139652106e-18_rk, -0.17453292519943298_rk, -0.05817764173314432_rk, 1.734723475976807e-18_rk, 8.673617379884035e-19_rk, 1.734723475976807e-18_rk,   &
        0.043633231299858244_rk, 0.043633231299858244_rk, 8.673617379884035e-19_rk, -0.05817764173314432_rk, -0.05817764173314432_rk, 0.0_rk, -1.734723475976807e-18_rk, 4.336808689942018e-19_rk,   &
        -2.6020852139652106e-18_rk, 8.673617379884035e-19_rk, 0.043633231299858244_rk, 1.734723475976807e-18_rk, 0.0_rk, -0.05817764173314432_rk, 0.014544410433286085_rk, -0.019392547244381438_rk,   &
        4.336808689942018e-18_rk, 1.734723475976807e-18_rk, -0.05817764173314432_rk, 8.673617379884035e-19_rk, -1.734723475976807e-18_rk, 0.014544410433286085_rk, -0.05817764173314432_rk, 0.014544410433286081_rk,   &
        8.673617379884035e-19_rk, 8.673617379884035e-19_rk, 0.014544410433286078_rk, 1.734723475976807e-18_rk, 4.336808689942018e-19_rk, -0.019392547244381438_rk, 0.014544410433286081_rk, -0.019392547244381435_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,1) = reshape((/ &
        -0.39269908169872414_rk, 0.13089969389957468_rk, -0.13089969389957468_rk, -0.13089969389957465_rk, 0.043633231299858216_rk, -0.043633231299858216_rk, 0.04363323129985823_rk, 0.014544410433286081_rk,   &
        0.13089969389957468_rk, -0.13089969389957473_rk, 0.04363323129985823_rk, 0.043633231299858216_rk, -0.043633231299858216_rk, 0.014544410433286081_rk, -0.04363323129985823_rk, -0.014544410433286078_rk,   &
        -0.13089969389957468_rk, 0.04363323129985823_rk, -0.13089969389957473_rk, -0.043633231299858216_rk, 0.014544410433286081_rk, -0.043633231299858216_rk, 0.04363323129985823_rk, 0.014544410433286078_rk,   &
        -0.13089969389957465_rk, 0.043633231299858216_rk, -0.043633231299858216_rk, -0.13089969389957473_rk, 0.04363323129985823_rk, -0.04363323129985823_rk, 0.014544410433286081_rk, 0.014544410433286078_rk,   &
        0.043633231299858216_rk, -0.043633231299858216_rk, 0.014544410433286081_rk, 0.04363323129985823_rk, -0.04363323129985823_rk, 0.014544410433286081_rk, -0.014544410433286081_rk, -0.014544410433286078_rk,   &
        -0.043633231299858216_rk, 0.014544410433286081_rk, -0.043633231299858216_rk, -0.04363323129985823_rk, 0.014544410433286081_rk, -0.04363323129985823_rk, 0.014544410433286081_rk, 0.014544410433286081_rk,   &
        0.04363323129985823_rk, -0.04363323129985823_rk, 0.04363323129985823_rk, 0.014544410433286081_rk, -0.014544410433286081_rk, 0.014544410433286081_rk, -0.04363323129985823_rk, -0.014544410433286078_rk,   &
        0.014544410433286081_rk, -0.014544410433286078_rk, 0.014544410433286078_rk, 0.014544410433286078_rk, -0.014544410433286078_rk, 0.014544410433286081_rk, -0.014544410433286078_rk, -0.014544410433286078_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,2) = reshape((/ &
        -0.3333333333333333_rk, 3.469446951953614e-18_rk, -0.1111111111111111_rk, 0.08333333333333331_rk, 8.673617379884035e-19_rk, 0.02777777777777777_rk, -1.734723475976807e-18_rk, -1.3010426069826053e-18_rk,   &
        3.469446951953614e-18_rk, -0.1111111111111111_rk, -1.734723475976807e-18_rk, 8.673617379884035e-19_rk, 0.02777777777777777_rk, -1.3010426069826053e-18_rk, -0.03703703703703703_rk, 0.009259259259259257_rk,   &
        -0.1111111111111111_rk, -1.734723475976807e-18_rk, -0.1111111111111111_rk, 0.02777777777777777_rk, -1.3010426069826053e-18_rk, 0.02777777777777777_rk, 0.0_rk, -4.336808689942018e-19_rk,   &
        0.08333333333333331_rk, 8.673617379884035e-19_rk, 0.02777777777777777_rk, -0.1111111111111111_rk, 0.0_rk, -0.03703703703703703_rk, -1.3010426069826053e-18_rk, 1.3010426069826053e-18_rk,   &
        8.673617379884035e-19_rk, 0.02777777777777777_rk, -1.3010426069826053e-18_rk, 0.0_rk, -0.037037037037037035_rk, -1.3010426069826053e-18_rk, 0.009259259259259264_rk, -0.012345679012345675_rk,   &
        0.02777777777777777_rk, -1.3010426069826053e-18_rk, 0.02777777777777777_rk, -0.03703703703703703_rk, -1.3010426069826053e-18_rk, -0.037037037037037035_rk, 6.505213034913027e-19_rk, 0.0_rk,   &
        -1.734723475976807e-18_rk, -0.03703703703703703_rk, 0.0_rk, -1.3010426069826053e-18_rk, 0.009259259259259264_rk, 6.505213034913027e-19_rk, -0.037037037037037035_rk, 0.009259259259259255_rk,   &
        -1.3010426069826053e-18_rk, 0.009259259259259257_rk, -4.336808689942018e-19_rk, 1.3010426069826053e-18_rk, -0.012345679012345675_rk, 0.0_rk, 0.009259259259259255_rk, -0.012345679012345675_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,5,3) = reshape((/ &
        0.5235987755982989_rk, -0.17453292519943292_rk, -3.469446951953614e-18_rk, -0.1308996938995747_rk, 0.043633231299858244_rk, 4.336808689942018e-18_rk, 4.336808689942018e-18_rk, -4.336808689942018e-18_rk,   &
        -0.17453292519943292_rk, 0.17453292519943298_rk, 4.336808689942018e-18_rk, 0.043633231299858244_rk, -0.043633231299858244_rk, -4.336808689942018e-18_rk, -6.938893903907228e-18_rk, 0.0_rk,   &
        -3.469446951953614e-18_rk, 4.336808689942018e-18_rk, 0.17453292519943298_rk, 4.336808689942018e-18_rk, -4.336808689942018e-18_rk, -0.043633231299858244_rk, -0.05817764173314432_rk, 0.014544410433286078_rk,   &
        -0.1308996938995747_rk, 0.043633231299858244_rk, 4.336808689942018e-18_rk, 0.17453292519943298_rk, -0.05817764173314432_rk, -6.938893903907228e-18_rk, -4.336808689942018e-18_rk, -1.734723475976807e-18_rk,   &
        0.043633231299858244_rk, -0.043633231299858244_rk, -4.336808689942018e-18_rk, -0.05817764173314432_rk, 0.05817764173314432_rk, 1.734723475976807e-18_rk, 1.734723475976807e-18_rk, -4.336808689942018e-19_rk,   &
        4.336808689942018e-18_rk, -4.336808689942018e-18_rk, -0.043633231299858244_rk, -6.938893903907228e-18_rk, 1.734723475976807e-18_rk, 0.05817764173314432_rk, 0.014544410433286087_rk, -0.019392547244381438_rk,   &
        4.336808689942018e-18_rk, -6.938893903907228e-18_rk, -0.05817764173314432_rk, -4.336808689942018e-18_rk, 1.734723475976807e-18_rk, 0.014544410433286087_rk, 0.05817764173314432_rk, -0.014544410433286081_rk,   &
        -4.336808689942018e-18_rk, 0.0_rk, 0.014544410433286078_rk, -1.734723475976807e-18_rk, -4.336808689942018e-19_rk, -0.019392547244381438_rk, -0.014544410433286081_rk, 0.019392547244381435_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,1) = reshape((/ &
        0.7853981633974483_rk, -0.2617993877991494_rk, 0.2617993877991494_rk, 0.13089969389957465_rk, -0.043633231299858216_rk, 0.043633231299858216_rk, -0.08726646259971646_rk, -0.014544410433286081_rk,   &
        -0.2617993877991494_rk, 0.2617993877991494_rk, -0.08726646259971646_rk, -0.043633231299858216_rk, 0.043633231299858216_rk, -0.014544410433286081_rk, 0.08726646259971646_rk, 0.014544410433286078_rk,   &
        0.2617993877991494_rk, -0.08726646259971646_rk, 0.2617993877991494_rk, 0.043633231299858216_rk, -0.014544410433286081_rk, 0.043633231299858216_rk, -0.08726646259971647_rk, -0.014544410433286078_rk,   &
        0.13089969389957465_rk, -0.043633231299858216_rk, 0.043633231299858216_rk, 0.2617993877991494_rk, -0.08726646259971647_rk, 0.08726646259971646_rk, -0.014544410433286081_rk, -0.029088820866572156_rk,   &
        -0.043633231299858216_rk, 0.043633231299858216_rk, -0.014544410433286081_rk, -0.08726646259971647_rk, 0.08726646259971647_rk, -0.029088820866572163_rk, 0.014544410433286083_rk, 0.029088820866572156_rk,   &
        0.043633231299858216_rk, -0.014544410433286081_rk, 0.043633231299858216_rk, 0.08726646259971646_rk, -0.029088820866572163_rk, 0.08726646259971647_rk, -0.014544410433286081_rk, -0.02908882086657216_rk,   &
        -0.08726646259971646_rk, 0.08726646259971646_rk, -0.08726646259971647_rk, -0.014544410433286081_rk, 0.014544410433286083_rk, -0.014544410433286081_rk, 0.08726646259971647_rk, 0.014544410433286078_rk,   &
        -0.014544410433286081_rk, 0.014544410433286078_rk, -0.014544410433286078_rk, -0.029088820866572156_rk, 0.029088820866572156_rk, -0.02908882086657216_rk, 0.014544410433286078_rk, 0.029088820866572156_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,2) = reshape((/ &
        -0.4166666666666667_rk, 3.469446951953614e-18_rk, -0.1388888888888889_rk, -0.16666666666666669_rk, -8.673617379884035e-19_rk, -0.055555555555555546_rk, -1.734723475976807e-18_rk, 1.3010426069826053e-18_rk,   &
        3.469446951953614e-18_rk, -0.1388888888888889_rk, -1.734723475976807e-18_rk, -8.673617379884035e-19_rk, -0.055555555555555546_rk, 1.3010426069826053e-18_rk, -0.04629629629629629_rk, -0.018518518518518514_rk,   &
        -0.1388888888888889_rk, -1.734723475976807e-18_rk, -0.1388888888888889_rk, -0.055555555555555546_rk, 1.3010426069826053e-18_rk, -0.055555555555555546_rk, 0.0_rk, 4.336808689942018e-19_rk,   &
        -0.16666666666666669_rk, -8.673617379884035e-19_rk, -0.055555555555555546_rk, -0.1388888888888889_rk, 0.0_rk, -0.04629629629629629_rk, 1.3010426069826053e-18_rk, 1.3010426069826053e-18_rk,   &
        -8.673617379884035e-19_rk, -0.055555555555555546_rk, 1.3010426069826053e-18_rk, 0.0_rk, -0.046296296296296294_rk, -1.3010426069826053e-18_rk, -0.018518518518518517_rk, -0.015432098765432094_rk,   &
        -0.055555555555555546_rk, 1.3010426069826053e-18_rk, -0.055555555555555546_rk, -0.04629629629629629_rk, -1.3010426069826053e-18_rk, -0.046296296296296294_rk, -6.505213034913027e-19_rk, 0.0_rk,   &
        -1.734723475976807e-18_rk, -0.04629629629629629_rk, 0.0_rk, 1.3010426069826053e-18_rk, -0.018518518518518517_rk, -6.505213034913027e-19_rk, -0.046296296296296294_rk, -0.018518518518518514_rk,   &
        1.3010426069826053e-18_rk, -0.018518518518518514_rk, 4.336808689942018e-19_rk, 1.3010426069826053e-18_rk, -0.015432098765432094_rk, 0.0_rk, -0.018518518518518514_rk, -0.015432098765432094_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,6,3) = reshape((/ &
        0.6544984694978735_rk, -0.21816615649929116_rk, 3.469446951953614e-18_rk, 0.26179938779914935_rk, -0.08726646259971646_rk, -4.336808689942018e-18_rk, 2.6020852139652106e-18_rk, 2.6020852139652106e-18_rk,   &
        -0.21816615649929116_rk, 0.21816615649929116_rk, 2.6020852139652106e-18_rk, -0.08726646259971646_rk, 0.08726646259971646_rk, 2.6020852139652106e-18_rk, -5.204170427930421e-18_rk, 0.0_rk,   &
        3.469446951953614e-18_rk, 2.6020852139652106e-18_rk, 0.21816615649929116_rk, -4.336808689942018e-18_rk, 2.6020852139652106e-18_rk, 0.08726646259971646_rk, -0.07272205216643039_rk, -0.029088820866572152_rk,   &
        0.26179938779914935_rk, -0.08726646259971646_rk, -4.336808689942018e-18_rk, 0.21816615649929116_rk, -0.07272205216643039_rk, -5.204170427930421e-18_rk, 2.6020852139652106e-18_rk, -2.6020852139652106e-18_rk,   &
        -0.08726646259971646_rk, 0.08726646259971646_rk, 2.6020852139652106e-18_rk, -0.07272205216643039_rk, 0.07272205216643039_rk, 1.734723475976807e-18_rk, 0.0_rk, -1.3010426069826053e-18_rk,   &
        -4.336808689942018e-18_rk, 2.6020852139652106e-18_rk, 0.08726646259971646_rk, -5.204170427930421e-18_rk, 1.734723475976807e-18_rk, 0.07272205216643039_rk, -0.02908882086657216_rk, -0.0242406840554768_rk,   &
        2.6020852139652106e-18_rk, -5.204170427930421e-18_rk, -0.07272205216643039_rk, 2.6020852139652106e-18_rk, 0.0_rk, -0.02908882086657216_rk, 0.07272205216643039_rk, 0.029088820866572156_rk,   &
        2.6020852139652106e-18_rk, 0.0_rk, -0.029088820866572152_rk, -2.6020852139652106e-18_rk, -1.3010426069826053e-18_rk, -0.0242406840554768_rk, 0.029088820866572156_rk, 0.024240684055476795_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,1) = reshape((/ &
        0.7853981633974483_rk, 0.2617993877991494_rk, 0.2617993877991494_rk, 0.13089969389957465_rk, 0.043633231299858216_rk, 0.043633231299858216_rk, 0.08726646259971646_rk, 0.014544410433286081_rk,   &
        0.2617993877991494_rk, 0.2617993877991494_rk, 0.08726646259971646_rk, 0.043633231299858216_rk, 0.043633231299858216_rk, 0.014544410433286081_rk, 0.08726646259971646_rk, 0.014544410433286078_rk,   &
        0.2617993877991494_rk, 0.08726646259971646_rk, 0.2617993877991494_rk, 0.043633231299858216_rk, 0.014544410433286081_rk, 0.043633231299858216_rk, 0.08726646259971647_rk, 0.014544410433286078_rk,   &
        0.13089969389957465_rk, 0.043633231299858216_rk, 0.043633231299858216_rk, 0.2617993877991494_rk, 0.08726646259971647_rk, 0.08726646259971646_rk, 0.014544410433286081_rk, 0.029088820866572152_rk,   &
        0.043633231299858216_rk, 0.043633231299858216_rk, 0.014544410433286081_rk, 0.08726646259971647_rk, 0.08726646259971647_rk, 0.029088820866572163_rk, 0.014544410433286083_rk, 0.029088820866572156_rk,   &
        0.043633231299858216_rk, 0.014544410433286081_rk, 0.043633231299858216_rk, 0.08726646259971646_rk, 0.029088820866572163_rk, 0.08726646259971647_rk, 0.014544410433286081_rk, 0.029088820866572156_rk,   &
        0.08726646259971646_rk, 0.08726646259971646_rk, 0.08726646259971647_rk, 0.014544410433286081_rk, 0.014544410433286083_rk, 0.014544410433286081_rk, 0.08726646259971647_rk, 0.014544410433286078_rk,   &
        0.014544410433286081_rk, 0.014544410433286078_rk, 0.014544410433286078_rk, 0.029088820866572152_rk, 0.029088820866572156_rk, 0.029088820866572156_rk, 0.014544410433286078_rk, 0.029088820866572156_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,2) = reshape((/ &
        0.4166666666666667_rk, -3.469446951953614e-18_rk, 0.1388888888888889_rk, 0.16666666666666669_rk, 8.673617379884035e-19_rk, 0.055555555555555546_rk, 1.734723475976807e-18_rk, -1.3010426069826053e-18_rk,   &
        -3.469446951953614e-18_rk, 0.1388888888888889_rk, 1.734723475976807e-18_rk, 8.673617379884035e-19_rk, 0.055555555555555546_rk, -1.3010426069826053e-18_rk, 0.04629629629629629_rk, 0.018518518518518514_rk,   &
        0.1388888888888889_rk, 1.734723475976807e-18_rk, 0.1388888888888889_rk, 0.055555555555555546_rk, -1.3010426069826053e-18_rk, 0.055555555555555546_rk, 0.0_rk, -4.336808689942018e-19_rk,   &
        0.16666666666666669_rk, 8.673617379884035e-19_rk, 0.055555555555555546_rk, 0.1388888888888889_rk, 0.0_rk, 0.04629629629629629_rk, -1.3010426069826053e-18_rk, -1.3010426069826053e-18_rk,   &
        8.673617379884035e-19_rk, 0.055555555555555546_rk, -1.3010426069826053e-18_rk, 0.0_rk, 0.046296296296296294_rk, 1.3010426069826053e-18_rk, 0.018518518518518517_rk, 0.015432098765432094_rk,   &
        0.055555555555555546_rk, -1.3010426069826053e-18_rk, 0.055555555555555546_rk, 0.04629629629629629_rk, 1.3010426069826053e-18_rk, 0.046296296296296294_rk, 6.505213034913027e-19_rk, 0.0_rk,   &
        1.734723475976807e-18_rk, 0.04629629629629629_rk, 0.0_rk, -1.3010426069826053e-18_rk, 0.018518518518518517_rk, 6.505213034913027e-19_rk, 0.046296296296296294_rk, 0.018518518518518514_rk,   &
        -1.3010426069826053e-18_rk, 0.018518518518518514_rk, -4.336808689942018e-19_rk, -1.3010426069826053e-18_rk, 0.015432098765432094_rk, 0.0_rk, 0.018518518518518514_rk, 0.015432098765432094_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,7,3) = reshape((/ &
        0.6544984694978735_rk, 0.21816615649929116_rk, 3.469446951953614e-18_rk, 0.26179938779914935_rk, 0.08726646259971646_rk, -2.6020852139652106e-18_rk, -2.6020852139652106e-18_rk, 2.6020852139652106e-18_rk,   &
        0.21816615649929116_rk, 0.21816615649929116_rk, -2.6020852139652106e-18_rk, 0.08726646259971646_rk, 0.08726646259971646_rk, 2.6020852139652106e-18_rk, 0.0_rk, 8.673617379884035e-19_rk,   &
        3.469446951953614e-18_rk, -2.6020852139652106e-18_rk, 0.21816615649929116_rk, -2.6020852139652106e-18_rk, 2.6020852139652106e-18_rk, 0.08726646259971646_rk, 0.07272205216643039_rk, 0.029088820866572152_rk,   &
        0.26179938779914935_rk, 0.08726646259971646_rk, -2.6020852139652106e-18_rk, 0.21816615649929116_rk, 0.07272205216643039_rk, 0.0_rk, 2.6020852139652106e-18_rk, -8.673617379884035e-19_rk,   &
        0.08726646259971646_rk, 0.08726646259971646_rk, 2.6020852139652106e-18_rk, 0.07272205216643039_rk, 0.07272205216643039_rk, 0.0_rk, 0.0_rk, -1.3010426069826053e-18_rk,   &
        -2.6020852139652106e-18_rk, 2.6020852139652106e-18_rk, 0.08726646259971646_rk, 0.0_rk, 0.0_rk, 0.07272205216643039_rk, 0.029088820866572156_rk, 0.0242406840554768_rk,   &
        -2.6020852139652106e-18_rk, 0.0_rk, 0.07272205216643039_rk, 2.6020852139652106e-18_rk, 0.0_rk, 0.029088820866572156_rk, 0.07272205216643039_rk, 0.029088820866572156_rk,   &
        2.6020852139652106e-18_rk, 8.673617379884035e-19_rk, 0.029088820866572152_rk, -8.673617379884035e-19_rk, -1.3010426069826053e-18_rk, 0.0242406840554768_rk, 0.029088820866572156_rk, 0.024240684055476795_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,1) = reshape((/ &
        -0.39269908169872414_rk, -0.13089969389957468_rk, -0.13089969389957468_rk, -0.13089969389957465_rk, -0.043633231299858216_rk, -0.043633231299858216_rk, -0.04363323129985823_rk, -0.014544410433286081_rk,   &
        -0.13089969389957468_rk, -0.13089969389957473_rk, -0.04363323129985823_rk, -0.043633231299858216_rk, -0.043633231299858216_rk, -0.014544410433286081_rk, -0.04363323129985824_rk, -0.014544410433286078_rk,   &
        -0.13089969389957468_rk, -0.04363323129985823_rk, -0.13089969389957473_rk, -0.043633231299858216_rk, -0.014544410433286081_rk, -0.043633231299858216_rk, -0.04363323129985823_rk, -0.014544410433286078_rk,   &
        -0.13089969389957465_rk, -0.043633231299858216_rk, -0.043633231299858216_rk, -0.13089969389957473_rk, -0.04363323129985823_rk, -0.04363323129985824_rk, -0.014544410433286081_rk, -0.014544410433286076_rk,   &
        -0.043633231299858216_rk, -0.043633231299858216_rk, -0.014544410433286081_rk, -0.04363323129985823_rk, -0.04363323129985823_rk, -0.01454441043328608_rk, -0.014544410433286081_rk, -0.014544410433286078_rk,   &
        -0.043633231299858216_rk, -0.014544410433286081_rk, -0.043633231299858216_rk, -0.04363323129985824_rk, -0.01454441043328608_rk, -0.04363323129985823_rk, -0.014544410433286081_rk, -0.014544410433286078_rk,   &
        -0.04363323129985823_rk, -0.04363323129985824_rk, -0.04363323129985823_rk, -0.014544410433286081_rk, -0.014544410433286081_rk, -0.014544410433286081_rk, -0.04363323129985823_rk, -0.014544410433286078_rk,   &
        -0.014544410433286081_rk, -0.014544410433286078_rk, -0.014544410433286078_rk, -0.014544410433286076_rk, -0.014544410433286078_rk, -0.014544410433286078_rk, -0.014544410433286078_rk, -0.014544410433286078_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,2) = reshape((/ &
        0.3333333333333333_rk, -3.469446951953614e-18_rk, 0.1111111111111111_rk, -0.08333333333333331_rk, -8.673617379884035e-19_rk, -0.02777777777777777_rk, 1.734723475976807e-18_rk, 1.3010426069826053e-18_rk,   &
        -3.469446951953614e-18_rk, 0.1111111111111111_rk, 1.734723475976807e-18_rk, -8.673617379884035e-19_rk, -0.02777777777777777_rk, 1.3010426069826053e-18_rk, 0.03703703703703703_rk, -0.009259259259259257_rk,   &
        0.1111111111111111_rk, 1.734723475976807e-18_rk, 0.1111111111111111_rk, -0.02777777777777777_rk, 1.3010426069826053e-18_rk, -0.02777777777777777_rk, 0.0_rk, 4.336808689942018e-19_rk,   &
        -0.08333333333333331_rk, -8.673617379884035e-19_rk, -0.02777777777777777_rk, 0.1111111111111111_rk, 0.0_rk, 0.03703703703703703_rk, 1.3010426069826053e-18_rk, -1.3010426069826053e-18_rk,   &
        -8.673617379884035e-19_rk, -0.02777777777777777_rk, 1.3010426069826053e-18_rk, 0.0_rk, 0.037037037037037035_rk, 1.3010426069826053e-18_rk, -0.009259259259259264_rk, 0.012345679012345675_rk,   &
        -0.02777777777777777_rk, 1.3010426069826053e-18_rk, -0.02777777777777777_rk, 0.03703703703703703_rk, 1.3010426069826053e-18_rk, 0.037037037037037035_rk, -6.505213034913027e-19_rk, 0.0_rk,   &
        1.734723475976807e-18_rk, 0.03703703703703703_rk, 0.0_rk, 1.3010426069826053e-18_rk, -0.009259259259259264_rk, -6.505213034913027e-19_rk, 0.037037037037037035_rk, -0.009259259259259255_rk,   &
        1.3010426069826053e-18_rk, -0.009259259259259257_rk, 4.336808689942018e-19_rk, -1.3010426069826053e-18_rk, 0.012345679012345675_rk, 0.0_rk, -0.009259259259259255_rk, 0.012345679012345675_rk   &
        /),(/8,8/))
        test_dmass_dx(:,:,8,3) = reshape((/ &
        0.5235987755982989_rk, 0.17453292519943292_rk, -3.469446951953614e-18_rk, -0.1308996938995747_rk, -0.043633231299858244_rk, 2.6020852139652106e-18_rk, -4.336808689942018e-18_rk, -8.673617379884035e-19_rk,   &
        0.17453292519943292_rk, 0.17453292519943298_rk, -4.336808689942018e-18_rk, -0.043633231299858244_rk, -0.043633231299858244_rk, -8.673617379884035e-19_rk, -1.734723475976807e-18_rk, -8.673617379884035e-19_rk,   &
        -3.469446951953614e-18_rk, -4.336808689942018e-18_rk, 0.17453292519943298_rk, 2.6020852139652106e-18_rk, -8.673617379884035e-19_rk, -0.043633231299858244_rk, 0.05817764173314432_rk, -0.014544410433286078_rk,   &
        -0.1308996938995747_rk, -0.043633231299858244_rk, 2.6020852139652106e-18_rk, 0.17453292519943298_rk, 0.05817764173314432_rk, -1.734723475976807e-18_rk, -8.673617379884035e-19_rk, -1.734723475976807e-18_rk,   &
        -0.043633231299858244_rk, -0.043633231299858244_rk, -8.673617379884035e-19_rk, 0.05817764173314432_rk, 0.05817764173314432_rk, 0.0_rk, 1.734723475976807e-18_rk, -4.336808689942018e-19_rk,   &
        2.6020852139652106e-18_rk, -8.673617379884035e-19_rk, -0.043633231299858244_rk, -1.734723475976807e-18_rk, 0.0_rk, 0.05817764173314432_rk, -0.014544410433286085_rk, 0.019392547244381438_rk,   &
        -4.336808689942018e-18_rk, -1.734723475976807e-18_rk, 0.05817764173314432_rk, -8.673617379884035e-19_rk, 1.734723475976807e-18_rk, -0.014544410433286085_rk, 0.05817764173314432_rk, -0.014544410433286081_rk,   &
        -8.673617379884035e-19_rk, -8.673617379884035e-19_rk, -0.014544410433286078_rk, -1.734723475976807e-18_rk, -4.336808689942018e-19_rk, 0.019392547244381438_rk, -0.014544410433286081_rk, 0.019392547244381435_rk   &
        /),(/8,8/))


        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dmass_dx(:,:,inode_diff,idir)),self%elem%dmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dmass_dx
    !*******************************************************************************************









    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_vol_dcoords_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_elem()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol = 1.e-14_rk
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/ &
        0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/24,8/))
        
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','1',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk   &
        /),(/24,8/))
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','2',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/ &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk, 0.03522081090086451_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.03522081090086453_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.13144585576580214_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk,   &
        0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk, 0.00943738783765594_rk, 0.03522081090086453_rk, 0.13144585576580214_rk, 0.03522081090086453_rk, 0.03522081090086451_rk, 0.13144585576580214_rk, 0.4905626121623441_rk, 0.13144585576580214_rk   &
        /),(/24,8/))
                
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','3',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_vol_dcoords_dx
    !*******************************************************************************************



!------------------------------------------------------------------------------
!                                Face tests
!------------------------------------------------------------------------------






    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_zetamin_dcoords_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_face()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_face(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        6.220084679281462359e-01_rk, 1.666666666666666852e-01_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.666666666666666852e-01_rk, 6.220084679281462359e-01_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.666666666666666574e-01_rk, 4.465819873852045624e-02_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        4.465819873852045624e-02_rk, 1.666666666666666574e-01_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','1',inode,5)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281462359e-01_rk, 1.666666666666666852e-01_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 6.220084679281462359e-01_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666574e-01_rk, 4.465819873852045624e-02_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852045624e-02_rk, 1.666666666666666574e-01_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','2',inode,5)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281462359e-01_rk, 1.666666666666666852e-01_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 6.220084679281462359e-01_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666574e-01_rk, 4.465819873852045624e-02_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852045624e-02_rk, 1.666666666666666574e-01_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','3',inode,5)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_zetamin_dcoords_dx
    !*******************************************************************************************








    !> Test cartesian dbr2_vol_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_vol_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)   :: test_dbr2_vol_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)   :: test_dbr2_vol_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)  :: test_dbr2_vol_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)  :: test_dbr2_vol_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dbr2_vol_face1_dx
        ! 
        test_dbr2_vol_face1_dx(:,:,1,1) = reshape((/ &
        1.2464777057714787_rk, 5.943200026618496e-17_rk, 1.9893223348162227e-16_rk, 5.609904382386387e-17_rk,   &
        -0.5716666282106515_rk, -6.26545036924577e-17_rk, 1.0324359112826446e-17_rk, -3.1561353336945307e-16_rk,   &
        1.1123351158165457e-16_rk, 0.3339926946448664_rk, 5.3714628324858706e-17_rk, 1.0083857048073584e-16_rk,   &
        -3.7492828026645484e-17_rk, -0.15317761136886685_rk, -7.586757276692433e-17_rk, 1.769011324507936e-17_rk,   &
        1.575127695462481e-16_rk, 1.5042388228231978e-16_rk, 0.33399269464486625_rk, 2.570855436381201e-17_rk,   &
        1.7625141744635354e-18_rk, -1.0837586607287349e-16_rk, -0.15317761136886687_rk, 8.051028913513981e-18_rk,   &
        3.220028581766918e-16_rk, 6.554737550162645e-17_rk, -4.174798038879427e-18_rk, 0.08949307280798657_rk,   &
        -2.4420767663583093e-16_rk, 1.0889416942001614e-16_rk, 2.631997636773021e-17_rk, -0.04104381726481625_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,1,2) = reshape((/ &
        2.274283883309887_rk, 3.353557015744258e-16_rk, 2.0301098121341804e-16_rk, 1.8303812387443337e-16_rk,   &
        -0.11058054888356983_rk, -3.9325342850034615e-17_rk, 1.2749645100645469e-17_rk, -1.184470263811169e-16_rk,   &
        4.94083041442633e-16_rk, 2.2742838833098866_rk, 1.7170738611764172e-16_rk, 2.0617187441959856e-16_rk,   &
        -9.249699948851479e-17_rk, -0.1105805488835698_rk, -1.3675790766341018e-16_rk, 4.077263736068167e-18_rk,   &
        1.7417634853526464e-16_rk, 2.0824298257838133e-16_rk, 0.6093925298920018_rk, 8.107460170827116e-17_rk,   &
        -3.378913438550289e-17_rk, -2.1578836850919e-16_rk, -0.029629968771942808_rk, 2.5188749319698138e-17_rk,   &
        2.0824298257838133e-16_rk, 1.7417634853526464e-16_rk, 7.164811641523341e-17_rk, 0.6093925298920018_rk,   &
        -2.4001353626994707e-16_rk, 7.408626719209395e-17_rk, 4.2196198761721136e-17_rk, -0.029629968771942752_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,1,3) = reshape((/ &
        3.572436769992004_rk, 2.904521638373194e-16_rk, 5.2508260625638215e-16_rk, 2.917543417228303e-16_rk,   &
        -0.17369952000127498_rk, 2.974924755427539e-17_rk, 1.6509833456320124e-17_rk, -1.9939132521957384e-16_rk,   &
        5.599985386991787e-16_rk, 0.9572315475306058_rk, 2.7888415147901416e-16_rk, 1.164036986913026e-16_rk,   &
        -6.388242062238796e-17_rk, -0.046542646110015226_rk, -4.58677652842649e-16_rk, 8.33604273053395e-18_rk,   &
        4.205117567864068e-16_rk, 3.6923999389878317e-16_rk, 3.5724367699920028_rk, 3.226121719140885e-16_rk,   &
        -1.0546035555046199e-16_rk, -1.7054389254200884e-16_rk, -0.1736995200012748_rk, -1.344798399107089e-17_rk,   &
        3.5942256775419826e-16_rk, 5.252543991644307e-17_rk, 4.206333760922374e-16_rk, 0.9572315475306057_rk,   &
        -3.9919583246696943e-16_rk, 1.8146868411533288e-16_rk, 1.212101703899004e-16_rk, -0.04654264611001527_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,1) = reshape((/ &
        -4.195675622877744_rk, -3.155208228909154e-16_rk, -5.185719682769913e-16_rk, -2.362228090882471e-16_rk,   &
        0.9340887480004108_rk, 1.0856474189203106e-16_rk, 1.3900942328758775e-18_rk, 5.486194495190757e-16_rk,   &
        -5.503425008438211e-16_rk, -1.124227894853039_rk, -1.4799218313486694e-16_rk, -1.7917278990457973e-16_rk,   &
        1.342911134951558e-16_rk, 0.25028832568570847_rk, 1.9032490702765475e-16_rk, -3.436892435747996e-17_rk,   &
        -4.278416996936726e-16_rk, -3.2530766746268104e-16_rk, -1.1242278948530386_rk, -7.767003267114628e-17_rk,   &
        6.928069495274803e-17_rk, 2.1165438469431704e-16_rk, 0.25028832568570836_rk, -8.74663361179409e-18_rk,   &
        -6.299653721487083e-16_rk, -1.2532613765506928e-16_rk, -4.4443523296431414e-17_rk, -0.30123595653441315_rk,   &
        5.98237757293679e-16_rk, -2.2262095147299987e-16_rk, -7.054896579067442e-17_rk, 0.06706455474242341_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,2) = reshape((/ &
        0.609392529892002_rk, 2.0628305083362185e-17_rk, 1.5323893984775127e-16_rk, 3.390712947634417e-17_rk,   &
        -0.41269222676233674_rk, -2.5574065941658046e-17_rk, 2.397998198493149e-17_rk, -1.9612724688184277e-16_rk,   &
        2.4255914437935293e-17_rk, 0.6093925298920019_rk, 5.008582917670803e-17_rk, 1.4885963363174707e-16_rk,   &
        -7.365753632890729e-17_rk, -0.41269222676233663_rk, -2.3228675246446997e-16_rk, 2.6410409258970388e-17_rk,   &
        1.069789847764299e-16_rk, 2.495246204622217e-16_rk, 0.16328623625812066_rk, 6.6533633324906936e-18_rk,   &
        3.7761360598819566e-17_rk, -1.4430426338380655e-16_rk, -0.1105805488835699_rk, 1.7313158782617253e-17_rk,   &
        2.495246204622217e-16_rk, 1.069789847764299e-16_rk, 1.2797873475930746e-17_rk, 0.16328623625812066_rk,   &
        -1.9935907148391951e-16_rk, 1.152301812968294e-16_rk, 2.9679604324290856e-17_rk, -0.1105805488835699_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,2,3) = reshape((/ &
        0.9572315475306059_rk, -2.7126136126618095e-17_rk, 1.8779082711104675e-16_rk, 8.990601279419708e-17_rk,   &
        -0.648255433895085_rk, -3.082316147271266e-17_rk, 2.998773939380867e-17_rk, -3.3594391565510094e-16_rk,   &
        -6.548042512197777e-17_rk, 0.25648942013041964_rk, 2.0708168540588183e-16_rk, 1.663446536570435e-16_rk,   &
        1.937780888212012e-17_rk, -0.17369952000127503_rk, -1.6112190588773495e-16_rk, 8.193484799744234e-18_rk,   &
        3.274409014904486e-16_rk, 2.414485288395976e-16_rk, 0.9572315475306057_rk, 1.4251490107679827e-16_rk,   &
        -3.082890134767773e-18_rk, -3.242345899170071e-16_rk, -0.6482554338950848_rk, -4.313378338682462e-17_rk,   &
        4.259530235303694e-16_rk, 1.6543895572372567e-16_rk, 1.3391498724332234e-16_rk, 0.2564894201304198_rk,   &
        -2.6053688326624807e-16_rk, 1.7817164094255837e-16_rk, -1.43228962624505e-17_rk, -0.173699520001275_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,1) = reshape((/ &
        -1.124227894853039_rk, -3.0162643679359723e-16_rk, -1.9516556456475826e-16_rk, -1.553496882738651e-16_rk,   &
        0.25028832568570847_rk, 1.976159920260894e-17_rk, -8.090799362204647e-17_rk, 1.2571173010840123e-16_rk,   &
        -3.4407869906845146e-16_rk, -4.195675622877743_rk, -2.6351053759321133e-16_rk, -5.293287206115576e-16_rk,   &
        2.0018081024559055e-16_rk, 0.9340887480004108_rk, 6.023648635058728e-16_rk, -3.635193638580242e-17_rk,   &
        -1.253261376550692e-16_rk, -6.299653721487083e-16_rk, -0.30123595653441315_rk, -7.555652006009413e-17_rk,   &
        -1.0337656079670859e-16_rk, 5.021060929943538e-16_rk, 0.06706455474242343_rk, -7.570247816745128e-17_rk,   &
        -3.253076674626811e-16_rk, -4.278416996936726e-16_rk, -1.0768581717672725e-16_rk, -1.1242278948530386_rk,   &
        2.895486488723252e-16_rk, -1.811717423375696e-16_rk, -7.255527615864128e-17_rk, 0.25028832568570847_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,2) = reshape((/ &
        -0.609392529892002_rk, -2.0628305083362185e-17_rk, -1.5323893984775127e-16_rk, -3.390712947634417e-17_rk,   &
        0.41269222676233674_rk, 2.5574065941658046e-17_rk, -2.397998198493149e-17_rk, 1.9612724688184277e-16_rk,   &
        -2.4255914437935293e-17_rk, -0.6093925298920019_rk, -5.008582917670803e-17_rk, -1.4885963363174707e-16_rk,   &
        7.365753632890729e-17_rk, 0.41269222676233663_rk, 2.3228675246446997e-16_rk, -2.6410409258970388e-17_rk,   &
        -1.069789847764299e-16_rk, -2.495246204622217e-16_rk, -0.16328623625812066_rk, -6.6533633324906936e-18_rk,   &
        -3.7761360598819566e-17_rk, 1.4430426338380655e-16_rk, 0.1105805488835699_rk, -1.7313158782617253e-17_rk,   &
        -2.495246204622217e-16_rk, -1.069789847764299e-16_rk, -1.2797873475930746e-17_rk, -0.16328623625812066_rk,   &
        1.9935907148391951e-16_rk, -1.152301812968294e-16_rk, -2.9679604324290856e-17_rk, 0.1105805488835699_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,3,3) = reshape((/ &
        0.25648942013041975_rk, -7.150316458068367e-17_rk, 1.380391014571866e-16_rk, 2.9078311470722665e-16_rk,   &
        -0.1736995200012751_rk, 5.329825020958856e-17_rk, 4.1374084464329055e-17_rk, -1.688354623691279e-16_rk,   &
        -4.2303210124607957e-17_rk, 0.9572315475306058_rk, 8.013490453797986e-17_rk, 2.6425276631353767e-16_rk,   &
        -1.0056579075813756e-16_rk, -0.6482554338950851_rk, -3.799661373177728e-16_rk, 1.5877492843730322e-18_rk,   &
        1.6543895572372567e-16_rk, 4.259530235303694e-16_rk, 0.2564894201304198_rk, 1.4523948219904539e-16_rk,   &
        9.043200755275232e-17_rk, -1.7405699293019266e-16_rk, -0.17369952000127503_rk, -7.108506636084222e-18_rk,   &
        2.414485288395976e-16_rk, 3.2744090149044864e-16_rk, 1.4657300332833657e-16_rk, 0.9572315475306057_rk,   &
        -4.0254030869179584e-16_rk, 1.1860484885879852e-16_rk, -1.2805144041570224e-17_rk, -0.6482554338950848_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,1) = reshape((/ &
        0.33399269464486636_rk, 5.65057789912739e-17_rk, 1.0935069735416353e-16_rk, 4.549233674238113e-17_rk,   &
        -0.153177611368867_rk, 9.889327385480313e-18_rk, 3.332191304437351e-17_rk, -4.478459999423877e-17_rk,   &
        4.9199032379093093e-17_rk, 1.246477705771479_rk, 7.25068773465093e-17_rk, 2.0080007306452584e-16_rk,   &
        -1.0946115037021188e-16_rk, -0.5716666282106515_rk, -3.5012397519584067e-16_rk, 2.797175873522435e-17_rk,   &
        6.554737550162636e-17_rk, 3.2200285817669177e-16_rk, 0.08949307280798657_rk, 5.13902061222934e-18_rk,   &
        5.3950100823305094e-17_rk, -1.8788072233761653e-16_rk, -0.04104381726481626_rk, 2.7323512387194187e-17_rk,   &
        1.5042388228231978e-16_rk, 1.5751276954624808e-16_rk, 4.313857751799739e-17_rk, 0.33399269464486625_rk,   &
        -1.5103537898804014e-16_rk, 1.0393605442461059e-16_rk, 3.408401258501944e-17_rk, -0.15317761136886696_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,2) = reshape((/ &
        -2.274283883309887_rk, -3.353557015744258e-16_rk, -2.0301098121341804e-16_rk, -1.8303812387443337e-16_rk,   &
        0.11058054888356983_rk, 3.9325342850034615e-17_rk, -1.2749645100645469e-17_rk, 1.184470263811169e-16_rk,   &
        -4.94083041442633e-16_rk, -2.2742838833098866_rk, -1.7170738611764172e-16_rk, -2.0617187441959856e-16_rk,   &
        9.249699948851479e-17_rk, 0.1105805488835698_rk, 1.3675790766341018e-16_rk, -4.077263736068167e-18_rk,   &
        -1.7417634853526464e-16_rk, -2.0824298257838133e-16_rk, -0.6093925298920018_rk, -8.107460170827116e-17_rk,   &
        3.378913438550289e-17_rk, 2.1578836850919e-16_rk, 0.029629968771942808_rk, -2.5188749319698138e-17_rk,   &
        -2.0824298257838133e-16_rk, -1.7417634853526464e-16_rk, -7.164811641523341e-17_rk, -0.6093925298920018_rk,   &
        2.4001353626994707e-16_rk, -7.408626719209395e-17_rk, -4.2196198761721136e-17_rk, 0.029629968771942752_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,4,3) = reshape((/ &
        0.9572315475306059_rk, 3.0628761001123957e-16_rk, 1.0630656308366767e-16_rk, 4.2175957187941417e-16_rk,   &
        -0.04654264611001524_rk, -1.728358216678828e-17_rk, 3.337779917879929e-17_rk, -4.3174503726275676e-16_rk,   &
        3.876831213184904e-16_rk, 3.572436769992003_rk, 2.688240443046101e-16_rk, 5.589352334886818e-16_rk,   &
        1.0110233417576813e-18_rk, -0.17369952000127503_rk, -2.361118258331138e-16_rk, 2.6893302133778142e-17_rk,   &
        5.252543991644314e-17_rk, 3.5942256775419816e-16_rk, 0.9572315475306057_rk, 4.522214797003212e-16_rk,   &
        1.1039829359186942e-16_rk, -3.611430279323819e-16_rk, -0.046542646110015254_rk, 1.2997604253836987e-16_rk,   &
        3.6923999389878307e-16_rk, 4.2051175678640676e-16_rk, 3.1060191929706445e-16_rk, 3.5724367699920028_rk,   &
        -2.0640643440796148e-16_rk, 6.398992899915155e-17_rk, 2.1990032810916227e-17_rk, -0.17369952000127478_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,1) = reshape((/ &
        0.33399269464486636_rk, -4.395981396603223e-17_rk, 8.408598129279463e-17_rk, 8.560809945032227e-17_rk,   &
        -0.15317761136886696_rk, 3.40371371148095e-17_rk, 2.4510103843016768e-17_rk, -7.684781044674382e-17_rk,   &
        -9.55972711439108e-17_rk, 0.0894930728079868_rk, 2.1220167157055469e-16_rk, 9.621008710243437e-17_rk,   &
        4.853317288086901e-17_rk, -0.04104381726481632_rk, -1.6821411862642844e-16_rk, -7.583892271426503e-18_rk,   &
        2.598100100259899e-16_rk, 1.6640376322167502e-16_rk, 1.2464777057714789_rk, 1.7740167324413821e-16_rk,   &
        -2.1307219788899925e-17_rk, -2.670373680749816e-16_rk, -0.5716666282106513_rk, -5.657171625179755e-17_rk,   &
        1.9201156220281342e-16_rk, 1.20698490649531e-16_rk, 2.131037652381862e-16_rk, 0.33399269464486636_rk,   &
        -9.778524879966252e-17_rk, 1.1090124145894405e-16_rk, -2.3096915359615318e-17_rk, -0.1531776113688669_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,2) = reshape((/ &
        0.609392529892002_rk, 4.454063741572577e-17_rk, 1.989438480472008e-16_rk, 2.711989413841295e-16_rk,   &
        -0.029629968771942766_rk, 4.7261231911427116e-17_rk, 1.9009808231481792e-17_rk, -2.833468610352878e-16_rk,   &
        1.0922984123474708e-16_rk, 0.6093925298920018_rk, 1.7697448080598784e-16_rk, 2.237622428557884e-16_rk,   &
        5.2471824863288183e-17_rk, -0.029629968771942766_rk, -3.055588120945445e-16_rk, 1.8350433772109223e-17_rk,   &
        1.2696848395110253e-16_rk, 2.556380115539184e-16_rk, 2.2742838833098866_rk, 4.1219982120523624e-16_rk,   &
        3.693272337738892e-17_rk, -1.22694037774037e-16_rk, -0.11058054888356973_rk, 4.899531678711953e-17_rk,   &
        2.556380115539184e-16_rk, 1.2696848395110253e-16_rk, 3.9387073088264493e-16_rk, 2.2742838833098866_rk,   &
        -1.4552484101326253e-16_rk, 8.217753921451131e-17_rk, 4.896788200297414e-17_rk, -0.1105805488835697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,5,3) = reshape((/ &
        -3.572436769992004_rk, -2.904521638373194e-16_rk, -5.2508260625638215e-16_rk, -2.917543417228303e-16_rk,   &
        0.17369952000127498_rk, -2.974924755427539e-17_rk, -1.6509833456320124e-17_rk, 1.9939132521957384e-16_rk,   &
        -5.599985386991787e-16_rk, -0.9572315475306058_rk, -2.7888415147901416e-16_rk, -1.164036986913026e-16_rk,   &
        6.388242062238796e-17_rk, 0.046542646110015226_rk, 4.58677652842649e-16_rk, -8.33604273053395e-18_rk,   &
        -4.205117567864068e-16_rk, -3.6923999389878317e-16_rk, -3.5724367699920028_rk, -3.226121719140885e-16_rk,   &
        1.0546035555046199e-16_rk, 1.7054389254200884e-16_rk, 0.1736995200012748_rk, 1.344798399107089e-17_rk,   &
        -3.5942256775419826e-16_rk, -5.252543991644307e-17_rk, -4.206333760922374e-16_rk, -0.9572315475306057_rk,   &
        3.9919583246696943e-16_rk, -1.8146868411533288e-16_rk, -1.212101703899004e-16_rk, 0.04654264611001527_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,1) = reshape((/ &
        -1.1242278948530393_rk, 4.4458702030137847e-17_rk, -3.35810572477646e-16_rk, -2.1629111706587338e-16_rk,   &
        0.25028832568570847_rk, -9.318214468476968e-17_rk, -6.530489856092629e-17_rk, 1.8294646326369752e-16_rk,   &
        4.8006267047748326e-17_rk, -0.30123595653441304_rk, -4.709318036977357e-16_rk, -2.0209989123535139e-16_rk,   &
        -9.530667418199973e-17_rk, 0.0670645547424234_rk, 5.515154973994055e-16_rk, 1.278628634037534e-17_rk,   &
        -5.287723483693019e-16_rk, -4.4379467802769707e-16_rk, -4.195675622877742_rk, -4.890121541237156e-16_rk,   &
        4.903490353969991e-17_rk, 4.708307148386263e-16_rk, 0.9340887480004103_rk, 8.958874465883135e-17_rk,   &
        -4.124174293256118e-16_rk, -1.8576119106067816e-16_rk, -6.145693236387816e-16_rk, -1.1242278948530386_rk,   &
        2.3249142115728527e-16_rk, -2.469170790243715e-16_rk, -3.794983884083286e-17_rk, 0.25028832568570836_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,2) = reshape((/ &
        0.1632862362581209_rk, -8.341766804841838e-17_rk, 5.4190835107902696e-17_rk, 2.084470962164253e-16_rk,   &
        -0.11058054888356986_rk, 3.988215181726919e-17_rk, 2.145036607537159e-17_rk, -1.2522528585179118e-16_rk,   &
        -9.287310777356715e-17_rk, 0.16328623625812078_rk, 1.3276193093354621e-16_rk, 1.2526719785199208e-16_rk,   &
        2.197166178801373e-17_rk, -0.11058054888356988_rk, -1.121805944318405e-16_rk, -2.018348224286562e-17_rk,   &
        2.0679807772782375e-16_rk, 1.7535640388531707e-16_rk, 0.6093925298920018_rk, 1.7653676664635068e-16_rk,   &
        1.784681464832688e-17_rk, -1.7291801066105964e-16_rk, -0.4126922267623367_rk, -4.929839402022747e-17_rk,   &
        1.7535640388531707e-16_rk, 2.0679807772782375e-16_rk, 1.6576632723363897e-16_rk, 0.6093925298920018_rk,   &
        -2.2276897952254544e-16_rk, 7.370360008456023e-17_rk, -4.6949851167415094e-17_rk, -0.4126922267623367_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,6,3) = reshape((/ &
        -0.9572315475306059_rk, 2.7126136126618095e-17_rk, -1.8779082711104675e-16_rk, -8.990601279419708e-17_rk,   &
        0.648255433895085_rk, 3.082316147271266e-17_rk, -2.998773939380867e-17_rk, 3.3594391565510094e-16_rk,   &
        6.548042512197777e-17_rk, -0.25648942013041964_rk, -2.0708168540588183e-16_rk, -1.663446536570435e-16_rk,   &
        -1.937780888212012e-17_rk, 0.17369952000127503_rk, 1.6112190588773495e-16_rk, -8.193484799744234e-18_rk,   &
        -3.274409014904486e-16_rk, -2.414485288395976e-16_rk, -0.9572315475306057_rk, -1.4251490107679827e-16_rk,   &
        3.082890134767773e-18_rk, 3.242345899170071e-16_rk, 0.6482554338950848_rk, 4.313378338682462e-17_rk,   &
        -4.259530235303694e-16_rk, -1.6543895572372567e-16_rk, -1.3391498724332234e-16_rk, -0.2564894201304198_rk,   &
        2.6053688326624807e-16_rk, -1.7817164094255837e-16_rk, 1.43228962624505e-17_rk, 0.173699520001275_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,1) = reshape((/ &
        -0.30123595653441315_rk, 8.178310998254495e-17_rk, -1.3168627484409402e-16_rk, -7.46211565607391e-16_rk,   &
        0.06706455474242348_rk, -8.31458187300501e-17_rk, -1.8689766207935946e-17_rk, 5.98991329050149e-16_rk,   &
        -8.344339082833597e-18_rk, -1.1242278948530393_rk, -1.49276747870184e-16_rk, -4.791442482432343e-16_rk,   &
        -4.655300344727181e-17_rk, 0.2502883256857087_rk, 2.3647269864943876e-16_rk, 4.947227496544368e-18_rk,   &
        -1.8576119106067813e-16_rk, -4.1241742932561186e-16_rk, -1.1242278948530386_rk, -6.3489658453878315e-16_rk,   &
        -1.546400746910774e-16_rk, 1.5459715697927702e-16_rk, 0.2502883256857084_rk, -5.333555743374055e-17_rk,   &
        -4.437946780276969e-16_rk, -5.287723483693019e-16_rk, -4.523054856483216e-16_rk, -4.195675622877742_rk,   &
        5.520279861697807e-16_rk, -7.020948713659131e-17_rk, 6.857392396468572e-17_rk, 0.9340887480004103_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,2) = reshape((/ &
        -0.1632862362581209_rk, 8.341766804841838e-17_rk, -5.4190835107902696e-17_rk, -2.084470962164253e-16_rk,   &
        0.11058054888356986_rk, -3.988215181726919e-17_rk, -2.145036607537159e-17_rk, 1.2522528585179118e-16_rk,   &
        9.287310777356715e-17_rk, -0.16328623625812078_rk, -1.3276193093354621e-16_rk, -1.2526719785199208e-16_rk,   &
        -2.197166178801373e-17_rk, 0.11058054888356988_rk, 1.121805944318405e-16_rk, 2.018348224286562e-17_rk,   &
        -2.0679807772782375e-16_rk, -1.7535640388531707e-16_rk, -0.6093925298920018_rk, -1.7653676664635068e-16_rk,   &
        -1.784681464832688e-17_rk, 1.7291801066105964e-16_rk, 0.4126922267623367_rk, 4.929839402022747e-17_rk,   &
        -1.7535640388531707e-16_rk, -2.0679807772782375e-16_rk, -1.6576632723363897e-16_rk, -0.6093925298920018_rk,   &
        2.2276897952254544e-16_rk, -7.370360008456023e-17_rk, 4.6949851167415094e-17_rk, 0.4126922267623367_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,7,3) = reshape((/ &
        -0.25648942013041975_rk, 7.150316458068367e-17_rk, -1.380391014571866e-16_rk, -2.9078311470722665e-16_rk,   &
        0.1736995200012751_rk, -5.329825020958856e-17_rk, -4.1374084464329055e-17_rk, 1.688354623691279e-16_rk,   &
        4.2303210124607957e-17_rk, -0.9572315475306058_rk, -8.013490453797986e-17_rk, -2.6425276631353767e-16_rk,   &
        1.0056579075813756e-16_rk, 0.6482554338950851_rk, 3.799661373177728e-16_rk, -1.5877492843730322e-18_rk,   &
        -1.6543895572372567e-16_rk, -4.259530235303694e-16_rk, -0.2564894201304198_rk, -1.4523948219904539e-16_rk,   &
        -9.043200755275232e-17_rk, 1.7405699293019266e-16_rk, 0.17369952000127503_rk, 7.108506636084222e-18_rk,   &
        -2.414485288395976e-16_rk, -3.2744090149044864e-16_rk, -1.4657300332833657e-16_rk, -0.9572315475306057_rk,   &
        4.0254030869179584e-16_rk, -1.1860484885879852e-16_rk, 1.2805144041570224e-17_rk, 0.6482554338950848_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,1) = reshape((/ &
        0.0894930728079868_rk, -8.638801623028094e-17_rk, 5.566165238183242e-17_rk, 3.3254479784684967e-16_rk,   &
        -0.04104381726481629_rk, 4.484977558380148e-17_rk, 1.636983932933461e-17_rk, -2.0346051905909228e-16_rk,   &
        -3.511277846428772e-17_rk, 0.33399269464486664_rk, 5.514979589510138e-17_rk, 1.6976986504061965e-16_rk,   &
        1.3150716063341614e-18_rk, -0.15317761136886696_rk, -9.539522281300897e-17_rk, -2.21244437930106e-17_rk,   &
        1.2069849064953096e-16_rk, 1.9201156220281344e-16_rk, 0.33399269464486636_rk, 2.2084526478679207e-16_rk,   &
        6.042256786302349e-17_rk, -5.512573588449589e-17_rk, -0.15317761136886693_rk, -1.498251298938181e-17_rk,   &
        1.6640376322167502e-16_rk, 2.5981001002598993e-16_rk, 1.6249418288129808e-16_rk, 1.2464777057714789_rk,   &
        -3.142244048966572e-16_rk, 3.3636848807811114e-17_rk, -4.449108573580028e-17_rk, -0.5716666282106513_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,2) = reshape((/ &
        -0.609392529892002_rk, -4.454063741572577e-17_rk, -1.989438480472008e-16_rk, -2.711989413841295e-16_rk,   &
        0.029629968771942766_rk, -4.7261231911427116e-17_rk, -1.9009808231481792e-17_rk, 2.833468610352878e-16_rk,   &
        -1.0922984123474708e-16_rk, -0.6093925298920018_rk, -1.7697448080598784e-16_rk, -2.237622428557884e-16_rk,   &
        -5.2471824863288183e-17_rk, 0.029629968771942766_rk, 3.055588120945445e-16_rk, -1.8350433772109223e-17_rk,   &
        -1.2696848395110253e-16_rk, -2.556380115539184e-16_rk, -2.2742838833098866_rk, -4.1219982120523624e-16_rk,   &
        -3.693272337738892e-17_rk, 1.22694037774037e-16_rk, 0.11058054888356973_rk, -4.899531678711953e-17_rk,   &
        -2.556380115539184e-16_rk, -1.2696848395110253e-16_rk, -3.9387073088264493e-16_rk, -2.2742838833098866_rk,   &
        1.4552484101326253e-16_rk, -8.217753921451131e-17_rk, -4.896788200297414e-17_rk, 0.1105805488835697_rk   &
        /),(/4,8/))
        test_dbr2_vol_face1_dx(:,:,8,3) = reshape((/ &
        -0.9572315475306059_rk, -3.0628761001123957e-16_rk, -1.0630656308366767e-16_rk, -4.2175957187941417e-16_rk,   &
        0.04654264611001524_rk, 1.728358216678828e-17_rk, -3.337779917879929e-17_rk, 4.3174503726275676e-16_rk,   &
        -3.876831213184904e-16_rk, -3.572436769992003_rk, -2.688240443046101e-16_rk, -5.589352334886818e-16_rk,   &
        -1.0110233417576813e-18_rk, 0.17369952000127503_rk, 2.361118258331138e-16_rk, -2.6893302133778142e-17_rk,   &
        -5.252543991644314e-17_rk, -3.5942256775419816e-16_rk, -0.9572315475306057_rk, -4.522214797003212e-16_rk,   &
        -1.1039829359186942e-16_rk, 3.611430279323819e-16_rk, 0.046542646110015254_rk, -1.2997604253836987e-16_rk,   &
        -3.6923999389878307e-16_rk, -4.2051175678640676e-16_rk, -3.1060191929706445e-16_rk, -3.5724367699920028_rk,   &
        2.0640643440796148e-16_rk, -6.398992899915155e-17_rk, -2.1990032810916227e-17_rk, 0.17369952000127478_rk   &
        /),(/4,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        !
        ! dbr2_vol_face2_dx
        ! 
        test_dbr2_vol_face2_dx(:,:,1,1) = reshape((/ &
        -0.3339926946448662_rk, -6.811244516929149e-17_rk, -7.334902507674592e-17_rk, -1.0418591664304505e-16_rk,   &
        2.1334889014737395_rk, 9.71148839693306e-17_rk, 1.4016529369179925e-16_rk, 1.4955819477241872e-16_rk,   &
        -1.2313881962571916e-16_rk, -0.08949307280798646_rk, -1.512376040653036e-16_rk, 3.2505552755783314e-17_rk,   &
        6.414531595710614e-17_rk, 0.5716666282106516_rk, 1.1423167144836201e-16_rk, 8.980889902811085e-17_rk,   &
        -1.0770962573916896e-16_rk, -1.0640127978416751e-16_rk, -0.08949307280798646_rk, -2.509403831700477e-17_rk,   &
        2.720933858501917e-16_rk, -2.187083791342931e-17_rk, 0.5716666282106516_rk, -1.6576467694146506e-17_rk,   &
        -2.6890086906399507e-16_rk, -3.286632352754878e-17_rk, -5.79876452853648e-17_rk, -0.02397959658707971_rk,   &
        2.688889884622966e-17_rk, 5.75144799692473e-17_rk, 7.367443015266314e-17_rk, 0.15317761136886704_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,1,2) = reshape((/ &
        -0.6093925298920015_rk, -7.97728345179872e-17_rk, -7.156834035352502e-17_rk, -2.9557316702735715e-16_rk,   &
        0.41269222676233686_rk, 3.126093197506245e-17_rk, 2.904513635833593e-17_rk, 8.515584841944854e-17_rk,   &
        -8.689129923761611e-17_rk, -0.6093925298920017_rk, -3.1118239019643783e-16_rk, -6.156262033391859e-17_rk,   &
        3.879437768401326e-17_rk, 0.41269222676233686_rk, 7.85329243531549e-17_rk, 3.123388464033459e-17_rk,   &
        -2.9076586599382705e-17_rk, -1.3558777291760384e-16_rk, -0.16328623625812066_rk, -7.483150904780235e-17_rk,   &
        7.385486377192521e-17_rk, 1.251789471669491e-16_rk, 0.11058054888356997_rk, 4.2983287654046204e-17_rk,   &
        -1.3558777291760384e-16_rk, -2.907658659938271e-17_rk, -7.082533678450322e-17_rk, -0.1632862362581206_rk,   &
        1.451809839785019e-16_rk, 5.3852826960372436e-17_rk, 5.153796393182341e-17_rk, 0.11058054888356997_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,1,3) = reshape((/ &
        -0.9572315475306055_rk, -6.126740512114624e-17_rk, -2.4397097325776216e-16_rk, -4.724376789801525e-16_rk,   &
        0.6482554338950852_rk, 8.448422602692982e-17_rk, -3.252439678559954e-17_rk, 7.980552803227444e-17_rk,   &
        -1.483101519107701e-16_rk, -0.25648942013041953_rk, -2.532395144823851e-16_rk, -8.916320281250624e-17_rk,   &
        3.181556855329544e-17_rk, 0.17369952000127525_rk, 2.438772970191444e-16_rk, 9.219086643924984e-17_rk,   &
        -1.9580884003525403e-17_rk, -5.473466123186179e-16_rk, -0.9572315475306054_rk, -5.516340392784113e-18_rk,   &
        1.2416480394068565e-16_rk, 9.01169187224755e-17_rk, 0.6482554338950852_rk, 1.5990921505055586e-17_rk,   &
        -2.0390891371592308e-16_rk, 6.868013676816855e-17_rk, -9.243927000942053e-17_rk, -0.25648942013041964_rk,   &
        2.37472644074595e-16_rk, 6.103713493211048e-17_rk, 5.876726960302382e-17_rk, 0.17369952000127525_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,1) = reshape((/ &
        1.1242278948530384_rk, 1.3702398096155873e-16_rk, 1.760614638144153e-16_rk, 4.4399894667782363e-16_rk,   &
        -3.486066666315935_rk, -1.7455047459576877e-16_rk, -1.9619454454128927e-16_rk, -2.5238736664833026e-16_rk,   &
        2.459550767702464e-16_rk, 0.3012359565344128_rk, 3.307222730413329e-16_rk, -2.890442396753126e-17_rk,   &
        -1.0919565388078842e-16_rk, -0.9340887480004111_rk, -2.385525729956836e-16_rk, -1.7854544483060762e-16_rk,   &
        2.0078800570832192e-16_rk, 2.476486343430993e-16_rk, 0.3012359565344127_rk, 9.222638520193728e-17_rk,   &
        -4.595335680173732e-16_rk, -1.561772622112823e-17_rk, -0.9340887480004111_rk, 1.0292774429026153e-17_rk,   &
        4.710522431462238e-16_rk, 3.9183403609312605e-17_rk, 1.2361871059316932e-16_rk, 0.0807159312846128_rk,   &
        -1.8305203011215747e-16_rk, -1.0680264590394905e-16_rk, -1.5882305702955324e-16_rk, -0.25028832568570863_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,2) = reshape((/ &
        -0.16328623625812055_rk, -1.0339925753298664e-16_rk, -3.099048473819374e-17_rk, -5.0848528952201403e-17_rk,   &
        1.5401883581657771_rk, 8.979272434266807e-17_rk, 1.3490949455753467e-16_rk, 1.381146418673612e-16_rk,   &
        -1.0121545331221501e-16_rk, -0.16328623625812053_rk, -1.2409470359580072e-16_rk, 4.075423576171871e-17_rk,   &
        8.865716554365858e-17_rk, 1.5401883581657771_rk, 1.441988534864897e-16_rk, 1.1227671362172567e-16_rk,   &
        -7.894724296387024e-17_rk, -2.0248903182563929e-16_rk, -0.04375241514048088_rk, -3.346324394364321e-17_rk,   &
        1.8472645240545395e-16_rk, -1.9548650605815323e-17_rk, 0.41269222676233686_rk, 1.342234950267316e-17_rk,   &
        -2.0248903182563934e-16_rk, -7.894724296387024e-17_rk, -4.147558847024137e-17_rk, -0.04375241514048085_rk,   &
        -1.734326048812875e-17_rk, 1.825210622877674e-16_rk, 3.8194793075836325e-17_rk, 0.41269222676233686_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,2,3) = reshape((/ &
        -0.2564894201304195_rk, -1.8459230899357696e-17_rk, -2.4493335634736773e-16_rk, -7.666245052009193e-17_rk,   &
        2.4193222155790655_rk, 1.3044977910770813e-16_rk, 2.919789267224155e-16_rk, 1.7930900301951725e-16_rk,   &
        -1.4212595946917857e-16_rk, -0.06872613299107275_rk, -3.714179987934739e-16_rk, 8.850374647888359e-18_rk,   &
        6.95229814757079e-17_rk, 0.6482554338950852_rk, 8.887227603739433e-17_rk, 1.4293054486386463e-16_rk,   &
        -8.625157534670208e-17_rk, -2.3148304999251263e-16_rk, -0.2564894201304194_rk, 3.939770971415851e-17_rk,   &
        3.349329196561006e-16_rk, 5.3973085702801645e-18_rk, 2.4193222155790655_rk, -6.135776294845956e-19_rk,   &
        -3.0962145384860364e-16_rk, 7.103459296985491e-17_rk, 6.1592949592524e-17_rk, -0.06872613299107297_rk,   &
        1.395509370567401e-17_rk, 4.500065720964814e-17_rk, 1.6626851586681746e-16_rk, 0.6482554338950852_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,1) = reshape((/ &
        0.30123595653441276_rk, 2.477975370897411e-16_rk, 1.989736678840757e-17_rk, 1.7888159800992543e-16_rk,   &
        -0.9340887480004111_rk, -9.532532779407571e-17_rk, -1.789625846168388e-16_rk, -2.254337377416767e-16_rk,   &
        1.4563082453548624e-16_rk, 1.1242278948530384_rk, 4.955706706842975e-16_rk, 3.455832040757855e-17_rk,   &
        -1.7067972482146593e-16_rk, -3.486066666315935_rk, -2.427681804798418e-16_rk, -1.4561963090294676e-16_rk,   &
        3.9183403609312605e-17_rk, 4.710522431462237e-16_rk, 0.08071593128461282_rk, 1.1522820302557225e-16_rk,   &
        -1.1181304276809406e-16_rk, -1.4889687795720365e-16_rk, -0.25028832568570863_rk, -1.1544103681077577e-16_rk,   &
        2.476486343430993e-16_rk, 2.007880057083219e-16_rk, 9.642163898573582e-17_rk, 0.3012359565344128_rk,   &
        -2.0628123085273212e-17_rk, -4.253784158624194e-16_rk, -2.0661853386496126e-17_rk, -0.9340887480004111_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,2) = reshape((/ &
        0.16328623625812055_rk, 1.0339925753298664e-16_rk, 3.099048473819374e-17_rk, 5.0848528952201403e-17_rk,   &
        -1.5401883581657771_rk, -8.979272434266807e-17_rk, -1.3490949455753467e-16_rk, -1.381146418673612e-16_rk,   &
        1.0121545331221501e-16_rk, 0.16328623625812053_rk, 1.2409470359580072e-16_rk, -4.075423576171871e-17_rk,   &
        -8.865716554365858e-17_rk, -1.5401883581657771_rk, -1.441988534864897e-16_rk, -1.1227671362172567e-16_rk,   &
        7.894724296387024e-17_rk, 2.0248903182563929e-16_rk, 0.04375241514048088_rk, 3.346324394364321e-17_rk,   &
        -1.8472645240545395e-16_rk, 1.9548650605815323e-17_rk, -0.41269222676233686_rk, -1.342234950267316e-17_rk,   &
        2.0248903182563934e-16_rk, 7.894724296387024e-17_rk, 4.147558847024137e-17_rk, 0.04375241514048085_rk,   &
        1.734326048812875e-17_rk, -1.825210622877674e-16_rk, -3.8194793075836325e-17_rk, -0.41269222676233686_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,3,3) = reshape((/ &
        -0.06872613299107277_rk, -1.5426351658148371e-16_rk, -5.713403880304623e-17_rk, -1.2325054087229097e-16_rk,   &
        0.6482554338950852_rk, 8.529089234538013e-17_rk, 1.48350315401026e-16_rk, 1.2213310063793146e-16_rk,   &
        -2.68497384669548e-17_rk, -0.25648942013041953_rk, -1.4500534262478085e-16_rk, -5.5678605905625056e-18_rk,   &
        1.0929676641942014e-16_rk, 2.4193222155790655_rk, 1.5873434166032617e-16_rk, 2.282272107718761e-16_rk,   &
        7.103459296985491e-17_rk, -3.096214538486036e-16_rk, -0.06872613299107289_rk, 7.417871094391962e-17_rk,   &
        2.5873853052404026e-17_rk, 2.5095078778886887e-17_rk, 0.6482554338950852_rk, 1.0885988153695109e-16_rk,   &
        -2.3148304999251263e-16_rk, -8.625157534670208e-17_rk, 2.6811948362762854e-17_rk, -0.2564894201304194_rk,   &
        -1.3729495586963982e-17_rk, 3.460729047293134e-16_rk, 1.531762570681754e-17_rk, 2.4193222155790655_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,1) = reshape((/ &
        -0.08949307280798639_rk, -1.260784922032956e-16_rk, 3.6294153400443886e-18_rk, -5.325931759895506e-17_rk,   &
        0.5716666282106517_rk, 6.233544343239266e-17_rk, 9.507030061713178e-17_rk, 1.0465908195916256e-16_rk,   &
        -6.907819108456353e-17_rk, -0.3339926946448663_rk, -1.3388496325234533e-16_rk, 2.155812246921645e-17_rk,   &
        9.520460955466671e-17_rk, 2.1334889014737395_rk, 1.4867731852066746e-16_rk, 1.0766941122663333e-16_rk,   &
        -3.2866323527548794e-17_rk, -2.6890086906399507e-16_rk, -0.023979596587079738_rk, -4.959713771776776e-17_rk,   &
        5.824267246230875e-17_rk, 1.9052682597124028e-17_rk, 0.15317761136886704_rk, 4.9669457145044715e-17_rk,   &
        -1.0640127978416756e-16_rk, -1.0770962573916894e-16_rk, -2.9289292100803295e-17_rk, -0.08949307280798643_rk,   &
        -2.1142645420367892e-17_rk, 2.64257169601086e-16_rk, 3.3916204778138006e-18_rk, 0.5716666282106516_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,2) = reshape((/ &
        0.6093925298920015_rk, 7.97728345179872e-17_rk, 7.156834035352502e-17_rk, 2.9557316702735715e-16_rk,   &
        -0.41269222676233686_rk, -3.126093197506245e-17_rk, -2.904513635833593e-17_rk, -8.515584841944854e-17_rk,   &
        8.689129923761611e-17_rk, 0.6093925298920017_rk, 3.1118239019643783e-16_rk, 6.156262033391859e-17_rk,   &
        -3.879437768401326e-17_rk, -0.41269222676233686_rk, -7.85329243531549e-17_rk, -3.123388464033459e-17_rk,   &
        2.9076586599382705e-17_rk, 1.3558777291760384e-16_rk, 0.16328623625812066_rk, 7.483150904780235e-17_rk,   &
        -7.385486377192521e-17_rk, -1.251789471669491e-16_rk, -0.11058054888356997_rk, -4.2983287654046204e-17_rk,   &
        1.3558777291760384e-16_rk, 2.907658659938271e-17_rk, 7.082533678450322e-17_rk, 0.1632862362581206_rk,   &
        -1.451809839785019e-16_rk, -5.3852826960372436e-17_rk, -5.153796393182341e-17_rk, -0.11058054888356997_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,4,3) = reshape((/ &
        -0.2564894201304195_rk, -1.4045840343523482e-16_rk, -8.90648818463201e-17_rk, -2.2396537377253097e-16_rk,   &
        0.17369952000127525_rk, 1.2989970065902499e-17_rk, 8.282684684316592e-17_rk, 2.769140195001363e-16_rk,   &
        -8.190571872797794e-17_rk, -0.9572315475306055_rk, -4.811413201783441e-16_rk, -2.475462025516644e-16_rk,   &
        7.137599948086308e-17_rk, 0.6482554338950852_rk, 6.347632140185703e-17_rk, -2.5482106200960123e-17_rk,   &
        6.868013676816855e-17_rk, -2.0390891371592295e-16_rk, -0.25648942013041964_rk, -9.873215068511832e-17_rk,   &
        5.549082157062903e-17_rk, 2.0137539138115707e-16_rk, 0.17369952000127525_rk, 3.7804451986696497e-17_rk,   &
        -5.47346612318618e-16_rk, -1.9580884003525403e-17_rk, 7.765402829137018e-19_rk, -0.9572315475306052_rk,   &
        8.457060536099405e-17_rk, 8.806755124724772e-17_rk, 1.4679454164407774e-17_rk, 0.6482554338950852_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,1) = reshape((/ &
        -0.08949307280798645_rk, 3.880751879749915e-17_rk, -2.279593545677673e-16_rk, -5.1056365298615924e-17_rk,   &
        0.5716666282106516_rk, 5.636706676619047e-17_rk, 1.6926979711917133e-16_rk, 5.5821582022796e-17_rk,   &
        -5.273685240428394e-17_rk, -0.0239795965870796_rk, -2.8771093532495836e-16_rk, -3.669179587536603e-17_rk,   &
        1.5620290024932447e-17_rk, 0.15317761136886715_rk, 1.899651767177713e-17_rk, 7.829951335439724e-17_rk,   &
        1.1810870134485887e-17_rk, -2.2709532979524897e-16_rk, -0.3339926946448661_rk, 6.667367333336251e-17_rk,   &
        1.077058820780221e-16_rk, 4.154746540795804e-17_rk, 2.1334889014737395_rk, 1.837583355547932e-17_rk,   &
        -9.590822180618166e-17_rk, 1.1993129084403386e-16_rk, 1.1009708792201826e-16_rk, -0.08949307280798649_rk,   &
        2.4673916540587736e-17_rk, 3.380947076215436e-19_rk, 1.1442508995052855e-16_rk, 0.5716666282106517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,2) = reshape((/ &
        -0.16328623625812055_rk, -4.864980380584243e-17_rk, -1.4044886991307852e-16_rk, -1.477707858921449e-16_rk,   &
        0.11058054888356997_rk, 3.079306855326946e-17_rk, 2.9783979468435744e-18_rk, 1.4193886872970138e-16_rk,   &
        -5.966867592382823e-17_rk, -0.1632862362581206_rk, -1.5633896959639005e-16_rk, -1.527932446630434e-16_rk,   &
        2.6899414868146538e-17_rk, 0.11058054888356997_rk, 1.171344662423755e-16_rk, 1.123423111748897e-17_rk,   &
        6.033414171782817e-17_rk, -3.4267634905639323e-16_rk, -0.6093925298920015_rk, 8.464858388124235e-18_rk,   &
        4.051745964564338e-17_rk, 6.039082093812587e-17_rk, 0.41269222676233686_rk, -8.736089227297967e-18_rk,   &
        -3.4267634905639323e-16_rk, 6.033414171782817e-17_rk, 1.247103065142331e-17_rk, -0.6093925298920015_rk,   &
        5.983811616969903e-17_rk, 4.107016441407021e-17_rk, -4.780327365856484e-18_rk, 0.41269222676233686_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,5,3) = reshape((/ &
        0.9572315475306055_rk, 6.126740512114624e-17_rk, 2.4397097325776216e-16_rk, 4.724376789801525e-16_rk,   &
        -0.6482554338950852_rk, -8.448422602692982e-17_rk, 3.252439678559954e-17_rk, -7.980552803227444e-17_rk,   &
        1.483101519107701e-16_rk, 0.25648942013041953_rk, 2.532395144823851e-16_rk, 8.916320281250624e-17_rk,   &
        -3.181556855329544e-17_rk, -0.17369952000127525_rk, -2.438772970191444e-16_rk, -9.219086643924984e-17_rk,   &
        1.9580884003525403e-17_rk, 5.473466123186179e-16_rk, 0.9572315475306054_rk, 5.516340392784113e-18_rk,   &
        -1.2416480394068565e-16_rk, -9.01169187224755e-17_rk, -0.6482554338950852_rk, -1.5990921505055586e-17_rk,   &
        2.0390891371592308e-16_rk, -6.868013676816855e-17_rk, 9.243927000942053e-17_rk, 0.25648942013041964_rk,   &
        -2.37472644074595e-16_rk, -6.103713493211048e-17_rk, -5.876726960302382e-17_rk, -0.17369952000127525_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,1) = reshape((/ &
        0.3012359565344129_rk, -4.264488175515859e-17_rk, 4.634970556129711e-16_rk, 1.8272232379325129e-16_rk,   &
        -0.9340887480004111_rk, -1.1712450590662967e-16_rk, -2.1797753080101195e-16_rk, -1.0941705280106891e-16_rk,   &
        1.3241887062470385e-16_rk, 0.08071593128461246_rk, 5.134095099296571e-16_rk, 1.113103736919405e-16_rk,   &
        -3.202569913923421e-17_rk, -0.25028832568570875_rk, -1.6081109462092474e-16_rk, -1.4063017266376092e-16_rk,   &
        -4.70061685557529e-17_rk, 6.979293327577394e-16_rk, 1.1242278948530382_rk, -1.4689757203149053e-16_rk,   &
        -1.8946378954352005e-16_rk, -8.973481481889176e-17_rk, -3.486066666315935_rk, -2.656980123526354e-17_rk,   &
        2.248826698533912e-16_rk, -2.224306170055786e-16_rk, -1.188271114945995e-16_rk, 0.3012359565344127_rk,   &
        -9.41571153615203e-17_rk, -2.816143357624399e-17_rk, -1.6026248849188386e-16_rk, -0.9340887480004111_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,2) = reshape((/ &
        -0.04375241514048088_rk, -6.559458650969879e-18_rk, -1.6131159160213105e-16_rk, -7.64200341213396e-17_rk,   &
        0.41269222676233686_rk, 4.755205280822615e-17_rk, 1.454128073298803e-16_rk, 5.37893615450487e-17_rk,   &
        -6.357817043539416e-18_rk, -0.043752415140480866_rk, -2.0467060646319436e-16_rk, -3.8664522409750505e-17_rk,   &
        2.5183021656166153e-17_rk, 0.41269222676233686_rk, 1.3432415108939873e-17_rk, 1.2400965228356204e-16_rk,   &
        6.925981110700029e-17_rk, -1.4198879423676518e-16_rk, -0.1632862362581205_rk, 1.0576823900931357e-16_rk,   &
        4.497027310491593e-17_rk, 3.8960707298986154e-17_rk, 1.5401883581657771_rk, 5.54893878505302e-17_rk,   &
        -1.4198879423676523e-16_rk, 6.925981110700029e-17_rk, 9.775589448271537e-17_rk, -0.1632862362581205_rk,   &
        1.7486880711108484e-17_rk, 6.644409969279355e-17_rk, 7.740653503787858e-17_rk, 1.5401883581657771_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,6,3) = reshape((/ &
        0.2564894201304195_rk, 1.8459230899357696e-17_rk, 2.4493335634736773e-16_rk, 7.666245052009193e-17_rk,   &
        -2.4193222155790655_rk, -1.3044977910770813e-16_rk, -2.919789267224155e-16_rk, -1.7930900301951725e-16_rk,   &
        1.4212595946917857e-16_rk, 0.06872613299107275_rk, 3.714179987934739e-16_rk, -8.850374647888359e-18_rk,   &
        -6.95229814757079e-17_rk, -0.6482554338950852_rk, -8.887227603739433e-17_rk, -1.4293054486386463e-16_rk,   &
        8.625157534670208e-17_rk, 2.3148304999251263e-16_rk, 0.2564894201304194_rk, -3.939770971415851e-17_rk,   &
        -3.349329196561006e-16_rk, -5.3973085702801645e-18_rk, -2.4193222155790655_rk, 6.135776294845956e-19_rk,   &
        3.0962145384860364e-16_rk, -7.103459296985491e-17_rk, -6.1592949592524e-17_rk, 0.06872613299107297_rk,   &
        -1.395509370567401e-17_rk, -4.500065720964814e-17_rk, -1.6626851586681746e-16_rk, -0.6482554338950852_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,1) = reshape((/ &
        0.08071593128461256_rk, 1.407938459658713e-16_rk, 1.639171810507774e-16_rk, 2.51928098164017e-16_rk,   &
        -0.25028832568570863_rk, -4.98806281928656e-17_rk, -1.384668126004568e-16_rk, -2.606784380860569e-16_rk,   &
        -1.611737595619489e-17_rk, 0.3012359565344127_rk, 2.4566666277665896e-16_rk, 2.4059583709507924e-16_rk,   &
        -7.433560757241765e-17_rk, -0.9340887480004111_rk, -6.979761435342911e-17_rk, -1.7805688668352102e-16_rk,   &
        -2.224306170055786e-16_rk, 2.248826698533911e-16_rk, 0.3012359565344127_rk, -1.2302236527839805e-16_rk,   &
        1.2247768688333513e-17_rk, -1.065767416515607e-16_rk, -0.9340887480004111_rk, -9.27481907702068e-17_rk,   &
        6.979293327577394e-16_rk, -4.7006168555752917e-17_rk, -1.3850706446389342e-16_rk, 1.1242278948530382_rk,   &
        -4.932561255431424e-17_rk, -2.018834158335604e-16_rk, -1.8712367570277685e-17_rk, -3.486066666315935_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,2) = reshape((/ &
        0.04375241514048088_rk, 6.559458650969879e-18_rk, 1.6131159160213105e-16_rk, 7.64200341213396e-17_rk,   &
        -0.41269222676233686_rk, -4.755205280822615e-17_rk, -1.454128073298803e-16_rk, -5.37893615450487e-17_rk,   &
        6.357817043539416e-18_rk, 0.043752415140480866_rk, 2.0467060646319436e-16_rk, 3.8664522409750505e-17_rk,   &
        -2.5183021656166153e-17_rk, -0.41269222676233686_rk, -1.3432415108939873e-17_rk, -1.2400965228356204e-16_rk,   &
        -6.925981110700029e-17_rk, 1.4198879423676518e-16_rk, 0.1632862362581205_rk, -1.0576823900931357e-16_rk,   &
        -4.497027310491593e-17_rk, -3.8960707298986154e-17_rk, -1.5401883581657771_rk, -5.54893878505302e-17_rk,   &
        1.4198879423676523e-16_rk, -6.925981110700029e-17_rk, -9.775589448271537e-17_rk, 0.1632862362581205_rk,   &
        -1.7486880711108484e-17_rk, -6.644409969279355e-17_rk, -7.740653503787858e-17_rk, -1.5401883581657771_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,7,3) = reshape((/ &
        0.06872613299107277_rk, 1.5426351658148371e-16_rk, 5.713403880304623e-17_rk, 1.2325054087229097e-16_rk,   &
        -0.6482554338950852_rk, -8.529089234538013e-17_rk, -1.48350315401026e-16_rk, -1.2213310063793146e-16_rk,   &
        2.68497384669548e-17_rk, 0.25648942013041953_rk, 1.4500534262478085e-16_rk, 5.5678605905625056e-18_rk,   &
        -1.0929676641942014e-16_rk, -2.4193222155790655_rk, -1.5873434166032617e-16_rk, -2.282272107718761e-16_rk,   &
        -7.103459296985491e-17_rk, 3.096214538486036e-16_rk, 0.06872613299107289_rk, -7.417871094391962e-17_rk,   &
        -2.5873853052404026e-17_rk, -2.5095078778886887e-17_rk, -0.6482554338950852_rk, -1.0885988153695109e-16_rk,   &
        2.3148304999251263e-16_rk, 8.625157534670208e-17_rk, -2.6811948362762854e-17_rk, 0.2564894201304194_rk,   &
        1.3729495586963982e-17_rk, -3.460729047293134e-16_rk, -1.531762570681754e-17_rk, -2.4193222155790655_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,1) = reshape((/ &
        -0.023979596587079585_rk, -6.166043387449223e-17_rk, -7.886066971968182e-17_rk, -1.1392824545928614e-16_rk,   &
        0.15317761136886704_rk, 3.1514743718924787e-17_rk, 7.743416932907557e-17_rk, 6.947102942016932e-17_rk,   &
        2.7562208315846353e-17_rk, -0.08949307280798643_rk, -9.629637806331787e-17_rk, -6.563831119007826e-17_rk,   &
        3.3480523432533894e-17_rk, 0.5716666282106517_rk, 3.203294502150797e-17_rk, 1.3419341480447017e-16_rk,   &
        1.1993129084403386e-16_rk, -9.590822180618161e-17_rk, -0.08949307280798643_rk, 1.1429234170581682e-16_rk,   &
        -2.184147354885377e-17_rk, 3.895361630031684e-17_rk, 0.5716666282106517_rk, 7.338033096962519e-17_rk,   &
        -2.27095329795249e-16_rk, 1.1810870134485921e-17_rk, 5.828316576576545e-17_rk, -0.33399269464486614_rk,   &
        1.9367897151482698e-17_rk, 1.2198558183775114e-16_rk, 1.5362661693283243e-17_rk, 2.1334889014737395_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,2) = reshape((/ &
        0.16328623625812055_rk, 4.864980380584243e-17_rk, 1.4044886991307852e-16_rk, 1.477707858921449e-16_rk,   &
        -0.11058054888356997_rk, -3.079306855326946e-17_rk, -2.9783979468435744e-18_rk, -1.4193886872970138e-16_rk,   &
        5.966867592382823e-17_rk, 0.1632862362581206_rk, 1.5633896959639005e-16_rk, 1.527932446630434e-16_rk,   &
        -2.6899414868146538e-17_rk, -0.11058054888356997_rk, -1.171344662423755e-16_rk, -1.123423111748897e-17_rk,   &
        -6.033414171782817e-17_rk, 3.4267634905639323e-16_rk, 0.6093925298920015_rk, -8.464858388124235e-18_rk,   &
        -4.051745964564338e-17_rk, -6.039082093812587e-17_rk, -0.41269222676233686_rk, 8.736089227297967e-18_rk,   &
        3.4267634905639323e-16_rk, -6.033414171782817e-17_rk, -1.247103065142331e-17_rk, 0.6093925298920015_rk,   &
        -5.983811616969903e-17_rk, -4.107016441407021e-17_rk, 4.780327365856484e-18_rk, -0.41269222676233686_rk   &
        /),(/4,8/))
        test_dbr2_vol_face2_dx(:,:,8,3) = reshape((/ &
        0.2564894201304195_rk, 1.4045840343523482e-16_rk, 8.90648818463201e-17_rk, 2.2396537377253097e-16_rk,   &
        -0.17369952000127525_rk, -1.2989970065902499e-17_rk, -8.282684684316592e-17_rk, -2.769140195001363e-16_rk,   &
        8.190571872797794e-17_rk, 0.9572315475306055_rk, 4.811413201783441e-16_rk, 2.475462025516644e-16_rk,   &
        -7.137599948086308e-17_rk, -0.6482554338950852_rk, -6.347632140185703e-17_rk, 2.5482106200960123e-17_rk,   &
        -6.868013676816855e-17_rk, 2.0390891371592295e-16_rk, 0.25648942013041964_rk, 9.873215068511832e-17_rk,   &
        -5.549082157062903e-17_rk, -2.0137539138115707e-16_rk, -0.17369952000127525_rk, -3.7804451986696497e-17_rk,   &
        5.47346612318618e-16_rk, 1.9580884003525403e-17_rk, -7.765402829137018e-19_rk, 0.9572315475306052_rk,   &
        -8.457060536099405e-17_rk, -8.806755124724772e-17_rk, -1.4679454164407774e-17_rk, -0.6482554338950852_rk   &
        /),(/4,8/))
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face3_dx
        ! 
        test_dbr2_vol_face3_dx(:,:,1,1) = reshape((/ &
        1.246477705771479_rk, 1.2326962634212722e-16_rk, -3.464995307333306e-17_rk, 2.2656756024660797e-17_rk,   &
        1.0845401008506156e-16_rk, 2.1334889014737395_rk, 2.4727614970785325e-16_rk, 1.7208060450864348e-16_rk,   &
        -0.08949307280798653_rk, -6.56581073085958e-17_rk, -1.1906246461387322e-17_rk, -1.9135763066533266e-16_rk,   &
        -5.565568840146077e-17_rk, -0.15317761136886687_rk, -1.2090896472004918e-16_rk, -6.739305925132701e-17_rk,   &
        1.3043173409975407e-16_rk, -2.9597604257467696e-17_rk, 0.3339926946448664_rk, 3.741932874202586e-17_rk,   &
        -1.892211732073594e-17_rk, 4.8854453460158816e-17_rk, 4.218686782999019e-17_rk, 0.5716666282106517_rk,   &
        2.091390604343444e-16_rk, -4.2556316718494954e-16_rk, -0.02397959658707964_rk, 8.108133721477438e-17_rk,   &
        -4.839914273425522e-17_rk, 4.180723935702987e-17_rk, 2.6604990184750187e-17_rk, -0.041043817264816276_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,1,2) = reshape((/ &
        2.274283883309887_rk, 1.1074897196729377e-16_rk, 1.0043668533773388e-16_rk, 4.182975355866567e-17_rk,   &
        7.014509506693655e-17_rk, 0.41269222676233686_rk, 9.458076650787618e-17_rk, 2.1549740898175275e-17_rk,   &
        -0.6093925298920015_rk, -1.1331530062566638e-17_rk, -7.300515803016559e-17_rk, -2.839373086415236e-16_rk,   &
        -1.229310801158314e-16_rk, -0.11058054888356988_rk, -9.929919566301898e-17_rk, -5.620441548049853e-17_rk,   &
        2.749631922079914e-16_rk, 4.0317328982708674e-17_rk, 0.6093925298920018_rk, 8.423221317112418e-19_rk,   &
        -2.1918471944561497e-17_rk, -3.103239673839467e-17_rk, 5.0344552528705904e-18_rk, 0.11058054888356994_rk,   &
        -4.263830712420741e-18_rk, -1.4176734390263467e-16_rk, -0.1632862362581207_rk, 3.5292818112406335e-17_rk,   &
        -1.0788348004804391e-16_rk, 8.214428802492758e-17_rk, -1.1280214834705475e-18_rk, -0.029629968771942843_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,1,3) = reshape((/ &
        3.572436769992004_rk, 1.2444134099580953e-16_rk, 1.7322451549057343e-16_rk, 1.4989212763251174e-16_rk,   &
        6.304838248994552e-17_rk, 0.6482554338950852_rk, 7.496514928609212e-17_rk, 3.9418165459077677e-17_rk,   &
        -0.25648942013041953_rk, 6.161217445782076e-17_rk, -1.4261603729495265e-17_rk, -2.7300026364085217e-16_rk,   &
        -1.817622630674298e-16_rk, -0.046542646110015254_rk, -2.4369642875322166e-16_rk, -4.2709904277882095e-17_rk,   &
        5.017645334165064e-16_rk, 1.0926540950426116e-16_rk, 3.5724367699920028_rk, 1.4244663144434653e-16_rk,   &
        -1.0148053670657227e-16_rk, -3.254603238786136e-17_rk, 3.1118808776165593e-16_rk, 0.6482554338950851_rk,   &
        1.2941086372101728e-16_rk, -2.452211990877344e-16_rk, -0.2564894201304194_rk, 1.2601057606356707e-16_rk,   &
        -1.601921105929106e-16_rk, 9.701505333260097e-17_rk, 4.2989651091833103e-17_rk, -0.04654264611001527_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,1) = reshape((/ &
        -4.195675622877744_rk, -2.9096166060936507e-16_rk, -8.791734291918133e-17_rk, -8.48374721255004e-17_rk,   &
        -2.1629330003419698e-16_rk, -3.486066666315935_rk, -4.0263204340210995e-16_rk, -2.6497901727829537e-16_rk,   &
        0.30123595653441276_rk, 8.104496840794505e-17_rk, 6.728222539979816e-17_rk, 4.0537694087381565e-16_rk,   &
        1.8331891054804251e-16_rk, 0.25028832568570836_rk, 2.350353107599713e-16_rk, 1.1845951302694192e-16_rk,   &
        -4.710997408919342e-16_rk, 1.3901492584131397e-17_rk, -1.1242278948530389_rk, -6.520033482344738e-17_rk,   &
        1.2424740226270193e-16_rk, -5.1501587547520534e-17_rk, -1.0072117771609217e-16_rk, -0.9340887480004108_rk,   &
        -3.565815969782884e-16_rk, 7.164342729413433e-16_rk, 0.08071593128461267_rk, -1.4715478217675822e-16_rk,   &
        1.6135207403221126e-16_rk, -1.344448003648267e-16_rk, -4.049393253263776e-17_rk, 0.06706455474242339_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,2) = reshape((/ &
        0.609392529892002_rk, 5.042097784420725e-17_rk, -7.580413016330808e-17_rk, 4.649404048770849e-17_rk,   &
        8.527952361717754e-17_rk, 1.5401883581657771_rk, 2.2056995566867537e-16_rk, 1.2884533411250317e-16_rk,   &
        -0.1632862362581206_rk, -8.343128799511476e-17_rk, 4.793206169786367e-17_rk, -1.5304212978131938e-16_rk,   &
        -3.392939515880557e-17_rk, -0.4126922267623366_rk, -2.240053916070624e-16_rk, -8.18871144705998e-17_rk,   &
        8.167994646177219e-17_rk, 5.817855588350691e-17_rk, 0.16328623625812066_rk, 3.494585915021767e-17_rk,   &
        2.4862051497211316e-17_rk, -6.982009437622823e-18_rk, 2.232816897988313e-17_rk, 0.41269222676233674_rk,   &
        1.6879680023232655e-16_rk, -2.96243035727676e-16_rk, -0.04375241514048095_rk, 6.218925227682337e-17_rk,   &
        -7.116270633174906e-17_rk, -2.6249056187016614e-17_rk, 4.308468209446163e-17_rk, -0.11058054888356986_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,2,3) = reshape((/ &
        0.9572315475306059_rk, 1.1792037309939962e-16_rk, -5.923147527720521e-17_rk, 2.1094893295905788e-16_rk,   &
        1.0432358840624626e-16_rk, 2.4193222155790655_rk, 2.9822027352895624e-16_rk, 2.9599256424070894e-16_rk,   &
        -0.06872613299107289_rk, -2.1943956362568428e-17_rk, -6.803512627715511e-19_rk, -3.677314290884803e-16_rk,   &
        -7.06608774549865e-17_rk, -0.17369952000127492_rk, -1.8371311915873113e-16_rk, -1.4764547226988875e-16_rk,   &
        8.455256035303995e-17_rk, -5.096643272114504e-17_rk, 0.9572315475306057_rk, 1.277604006063263e-16_rk,   &
        1.2731829974306803e-16_rk, 1.903422550583062e-16_rk, 1.907692418815165e-16_rk, 2.419322215579065_rk,   &
        2.8717692300502444e-16_rk, -4.924985933465886e-16_rk, -0.06872613299107297_rk, 2.902871712824057e-16_rk,   &
        -1.2312977161060226e-16_rk, -3.333101208177015e-17_rk, 1.0018749520935909e-16_rk, -0.1736995200012749_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,1) = reshape((/ &
        -1.124227894853039_rk, -1.8232095767346975e-17_rk, 1.0120495174014974e-16_rk, -9.828081138900287e-17_rk,   &
        -1.0845335045865999e-16_rk, -0.934088748000411_rk, -2.903948190546298e-16_rk, -8.284399078469843e-17_rk,   &
        1.1242278948530384_rk, 1.397446143335401e-16_rk, -5.961782940149821e-17_rk, 4.447821242388893e-16_rk,   &
        1.0662870737847798e-16_rk, 0.9340887480004105_rk, 4.742754809007002e-16_rk, 1.745065811157447e-16_rk,   &
        -1.9142392141857965e-16_rk, -2.2269823176966747e-16_rk, -0.3012359565344128_rk, -2.0675063249141524e-17_rk,   &
        -1.4725140305466065e-16_rk, 1.2086961392303408e-16_rk, 3.824628773041234e-17_rk, -0.25028832568570847_rk,   &
        -4.412158309074003e-17_rk, 2.392869709091367e-16_rk, 0.3012359565344128_rk, -6.283464763832043e-17_rk,   &
        1.931190023333546e-16_rk, 5.89210448458755e-17_rk, -6.17167381952996e-17_rk, 0.2502883256857086_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,2) = reshape((/ &
        -0.609392529892002_rk, -5.042097784420725e-17_rk, 7.580413016330808e-17_rk, -4.649404048770849e-17_rk,   &
        -8.527952361717754e-17_rk, -1.5401883581657771_rk, -2.2056995566867537e-16_rk, -1.2884533411250317e-16_rk,   &
        0.1632862362581206_rk, 8.343128799511476e-17_rk, -4.793206169786367e-17_rk, 1.5304212978131938e-16_rk,   &
        3.392939515880557e-17_rk, 0.4126922267623366_rk, 2.240053916070624e-16_rk, 8.18871144705998e-17_rk,   &
        -8.167994646177219e-17_rk, -5.817855588350691e-17_rk, -0.16328623625812066_rk, -3.494585915021767e-17_rk,   &
        -2.4862051497211316e-17_rk, 6.982009437622823e-18_rk, -2.232816897988313e-17_rk, -0.41269222676233674_rk,   &
        -1.6879680023232655e-16_rk, 2.96243035727676e-16_rk, 0.04375241514048095_rk, -6.218925227682337e-17_rk,   &
        7.116270633174906e-17_rk, 2.6249056187016614e-17_rk, -4.308468209446163e-17_rk, 0.11058054888356986_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,3,3) = reshape((/ &
        0.25648942013041964_rk, 2.866591479338445e-18_rk, -8.690091317889415e-17_rk, 2.9446793330165673e-16_rk,   &
        6.71040229822391e-17_rk, 0.6482554338950852_rk, 2.0156724919050044e-16_rk, 7.439026282722105e-17_rk,   &
        -0.2564894201304194_rk, -9.146997085074188e-17_rk, 1.1176270242765827e-16_rk, -2.2414619101617394e-16_rk,   &
        -4.99288876095371e-17_rk, -0.6482554338950848_rk, -3.8255882023945e-16_rk, -1.2346361609751445e-16_rk,   &
        1.054380703299424e-16_rk, 1.4130105772503387e-16_rk, 0.2564894201304198_rk, -4.054219194930928e-18_rk,   &
        6.713036800572772e-17_rk, -5.253467834930025e-17_rk, 1.2031976592466647e-17_rk, 0.648255433895085_rk,   &
        1.2356126376592037e-16_rk, -2.0642116761252893e-16_rk, -0.25648942013041975_rk, 4.3689951539961354e-17_rk,   &
        -3.8555314807182984e-16_rk, -2.1566916471905208e-16_rk, 9.660235418481932e-17_rk, -0.6482554338950851_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,1) = reshape((/ &
        0.33399269464486625_rk, -1.1212443895950341e-17_rk, -6.931071894372516e-17_rk, 6.610242849107881e-17_rk,   &
        5.275845065564467e-17_rk, 0.5716666282106517_rk, 1.4870238164225398e-16_rk, 5.108534882771086e-17_rk,   &
        -0.33399269464486636_rk, -7.821488513089643e-17_rk, 7.534690970509639e-17_rk, -1.361491060410803e-16_rk,   &
        -3.144783069017731e-17_rk, -0.5716666282106513_rk, -2.820213023617261e-16_rk, -8.471179301670083e-17_rk,   &
        7.418812612313842e-17_rk, 1.3775713432401078e-16_rk, 0.08949307280798663_rk, 2.189958000250434e-17_rk,   &
        5.568259100679155e-17_rk, -6.816472703803093e-17_rk, -3.199307131187802e-18_rk, 0.15317761136886687_rk,   &
        7.537173138666293e-17_rk, -1.0982912967334994e-16_rk, -0.08949307280798656_rk, 3.264856622385574e-17_rk,   &
        -9.805282621285027e-17_rk, -6.635977803180698e-17_rk, 4.6005614526474725e-17_rk, -0.15317761136886698_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,2) = reshape((/ &
        -2.274283883309887_rk, -1.1074897196729377e-16_rk, -1.0043668533773388e-16_rk, -4.182975355866567e-17_rk,   &
        -7.014509506693655e-17_rk, -0.41269222676233686_rk, -9.458076650787618e-17_rk, -2.1549740898175275e-17_rk,   &
        0.6093925298920015_rk, 1.1331530062566638e-17_rk, 7.300515803016559e-17_rk, 2.839373086415236e-16_rk,   &
        1.229310801158314e-16_rk, 0.11058054888356988_rk, 9.929919566301898e-17_rk, 5.620441548049853e-17_rk,   &
        -2.749631922079914e-16_rk, -4.0317328982708674e-17_rk, -0.6093925298920018_rk, -8.423221317112418e-19_rk,   &
        2.1918471944561497e-17_rk, 3.103239673839467e-17_rk, -5.0344552528705904e-18_rk, -0.11058054888356994_rk,   &
        4.263830712420741e-18_rk, 1.4176734390263467e-16_rk, 0.1632862362581207_rk, -3.5292818112406335e-17_rk,   &
        1.0788348004804391e-16_rk, -8.214428802492758e-17_rk, 1.1280214834705475e-18_rk, 0.029629968771942843_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,4,3) = reshape((/ &
        0.9572315475306059_rk, 4.187491405673838e-17_rk, -1.2754690719472122e-16_rk, 7.036757729381065e-17_rk,   &
        1.755916713321078e-17_rk, 0.17369952000127525_rk, 2.711248483624742e-16_rk, 3.815457669962081e-17_rk,   &
        -0.9572315475306055_rk, -8.935285325545191e-19_rk, -1.5525933751001267e-16_rk, -4.2805699523812087e-16_rk,   &
        -1.1580086916521856e-16_rk, -0.17369952000127503_rk, -1.7022488330422352e-16_rk, -8.243414790302071e-17_rk,   &
        1.6280523558812834e-16_rk, 7.778907816502881e-17_rk, 0.9572315475306057_rk, -1.6830175618287225e-17_rk,   &
        9.957879007608426e-17_rk, -7.220530451255624e-17_rk, -3.2322552543816654e-17_rk, 0.1736995200012751_rk,   &
        3.525596867872176e-17_rk, -4.3765122032958214e-16_rk, -0.9572315475306054_rk, 1.0457681345034708e-16_rk,   &
        -1.609764680113188e-16_rk, 2.1417937924490685e-17_rk, -7.210320253432212e-17_rk, -0.17369952000127512_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,1) = reshape((/ &
        0.3339926946448665_rk, 2.28663663796585e-17_rk, -2.487864072799725e-18_rk, 2.2757934525932645e-16_rk,   &
        1.3594220889349108e-17_rk, 0.5716666282106517_rk, 8.541724475195996e-17_rk, 1.5274495166736268e-16_rk,   &
        -0.023979596587079724_rk, 5.150495037318688e-17_rk, 8.979467604634064e-18_rk, -2.4666087199008493e-16_rk,   &
        -4.8404066252744684e-17_rk, -0.04104381726481629_rk, -1.1442769110523388e-16_rk, -9.818051154361196e-17_rk,   &
        3.7819412959905364e-17_rk, -8.479260287725252e-18_rk, 1.2464777057714787_rk, 1.2208366136391732e-16_rk,   &
        1.404217421661058e-16_rk, 1.5112243161988459e-16_rk, 2.1113202154420543e-16_rk, 2.1334889014737395_rk,   &
        1.2003775875891534e-16_rk, -1.4254627166333582e-16_rk, -0.0894930728079865_rk, 2.509218589452883e-16_rk,   &
        -1.0884708986068733e-16_rk, -6.277678262468989e-17_rk, 8.790302790099543e-17_rk, -0.15317761136886682_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,2) = reshape((/ &
        0.609392529892002_rk, -4.8687555347121224e-18_rk, -7.135741674213286e-17_rk, 9.83919296532803e-17_rk,   &
        -1.8828735174734246e-17_rk, 0.11058054888356997_rk, 1.257469690138508e-16_rk, 2.7834600556824426e-17_rk,   &
        -0.1632862362581206_rk, 4.998622060997738e-17_rk, -3.491522499326804e-17_rk, -1.6236960392264873e-16_rk,   &
        -6.65034933911017e-17_rk, -0.029629968771942843_rk, -1.642112957970824e-16_rk, -2.3464762532064548e-17_rk,   &
        1.4811506285811525e-16_rk, 7.876525637764926e-17_rk, 2.2742838833098866_rk, 7.912759738189696e-17_rk,   &
        2.070778243755942e-17_rk, -3.5654375514348994e-17_rk, 1.7249685829867396e-16_rk, 0.41269222676233674_rk,   &
        1.0909399207123322e-16_rk, -2.929627403029169e-16_rk, -0.6093925298920015_rk, 1.1150367331077654e-16_rk,   &
        -9.65787873546003e-17_rk, -6.74750409002615e-18_rk, -1.7406241008658672e-17_rk, -0.11058054888356986_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,5,3) = reshape((/ &
        -3.572436769992004_rk, -1.2444134099580953e-16_rk, -1.7322451549057343e-16_rk, -1.4989212763251174e-16_rk,   &
        -6.304838248994552e-17_rk, -0.6482554338950852_rk, -7.496514928609212e-17_rk, -3.9418165459077677e-17_rk,   &
        0.25648942013041953_rk, -6.161217445782076e-17_rk, 1.4261603729495265e-17_rk, 2.7300026364085217e-16_rk,   &
        1.817622630674298e-16_rk, 0.046542646110015254_rk, 2.4369642875322166e-16_rk, 4.2709904277882095e-17_rk,   &
        -5.017645334165064e-16_rk, -1.0926540950426116e-16_rk, -3.5724367699920028_rk, -1.4244663144434653e-16_rk,   &
        1.0148053670657227e-16_rk, 3.254603238786136e-17_rk, -3.1118808776165593e-16_rk, -0.6482554338950851_rk,   &
        -1.2941086372101728e-16_rk, 2.452211990877344e-16_rk, 0.2564894201304194_rk, -1.2601057606356707e-16_rk,   &
        1.601921105929106e-16_rk, -9.701505333260097e-17_rk, -4.2989651091833103e-17_rk, 0.04654264611001527_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,1) = reshape((/ &
        -1.124227894853039_rk, -2.4468049846736923e-17_rk, -7.506788721120506e-18_rk, -4.011216391080628e-16_rk,   &
        -1.210278634920014e-17_rk, -0.934088748000411_rk, -1.3690007664284504e-16_rk, -2.3284449050949433e-16_rk,   &
        0.08071593128461274_rk, -1.136366080354929e-16_rk, -5.0876880979154735e-17_rk, 4.543640031832255e-16_rk,   &
        1.211341073014765e-16_rk, 0.06706455474242337_rk, 3.100425650646231e-16_rk, 1.5468264891829837e-16_rk,   &
        -1.9934292640744184e-16_rk, -5.316203709465103e-17_rk, -4.195675622877742_rk, -2.84758192280197e-16_rk,   &
        -2.1083497772188267e-16_rk, -2.0628307766294606e-16_rk, -5.27895596614178e-16_rk, -3.4860666663159345_rk,   &
        -2.2459459934438325e-16_rk, 3.0534023891712236e-16_rk, 0.3012359565344127_rk, -4.3514456324924586e-16_rk,   &
        2.0059292446877284e-16_rk, 8.124553074782587e-17_rk, -1.5993722281142722e-16_rk, 0.2502883256857083_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,2) = reshape((/ &
        0.1632862362581209_rk, 2.6474392050880095e-17_rk, -1.722663771114487e-17_rk, 2.75264329861924e-16_rk,   &
        2.385468332247821e-17_rk, 0.41269222676233686_rk, 9.76046632771425e-17_rk, 1.0694769694434367e-16_rk,   &
        -0.04375241514048095_rk, 1.1229739469263708e-17_rk, 2.2785159414782273e-17_rk, -2.237588659991715e-16_rk,   &
        -4.284043362643156e-17_rk, -0.11058054888356988_rk, -1.3649452155075655e-16_rk, -9.070629165263892e-17_rk,   &
        3.927184559560126e-17_rk, -6.697474766203779e-19_rk, 0.6093925298920018_rk, 4.3807941900367577e-17_rk,   &
        9.892781510220654e-17_rk, 9.471303755263821e-17_rk, 1.0677909656089209e-16_rk, 1.5401883581657771_rk,   &
        9.268725073246545e-17_rk, -1.487031033973218e-16_rk, -0.16328623625812066_rk, 1.504271876303317e-16_rk,   &
        -2.5267489820375753e-16_rk, -1.3226937968741038e-16_rk, 8.219562703111081e-17_rk, -0.4126922267623366_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,6,3) = reshape((/ &
        -0.9572315475306059_rk, -1.1792037309939962e-16_rk, 5.923147527720521e-17_rk, -2.1094893295905788e-16_rk,   &
        -1.0432358840624626e-16_rk, -2.4193222155790655_rk, -2.9822027352895624e-16_rk, -2.9599256424070894e-16_rk,   &
        0.06872613299107289_rk, 2.1943956362568428e-17_rk, 6.803512627715511e-19_rk, 3.677314290884803e-16_rk,   &
        7.06608774549865e-17_rk, 0.17369952000127492_rk, 1.8371311915873113e-16_rk, 1.4764547226988875e-16_rk,   &
        -8.455256035303995e-17_rk, 5.096643272114504e-17_rk, -0.9572315475306057_rk, -1.277604006063263e-16_rk,   &
        -1.2731829974306803e-16_rk, -1.903422550583062e-16_rk, -1.907692418815165e-16_rk, -2.419322215579065_rk,   &
        -2.8717692300502444e-16_rk, 4.924985933465886e-16_rk, 0.06872613299107297_rk, -2.902871712824057e-16_rk,   &
        1.2312977161060226e-16_rk, 3.333101208177015e-17_rk, -1.0018749520935909e-16_rk, 0.1736995200012749_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,1) = reshape((/ &
        -0.3012359565344128_rk, -3.1274106261968907e-17_rk, 1.698469685909256e-16_rk, -4.3052724616072665e-16_rk,   &
        -1.369348027285793e-17_rk, -0.2502883256857089_rk, -3.116892471672661e-16_rk, -7.269211154907935e-17_rk,   &
        0.30123595653441265_rk, 1.940679241121488e-18_rk, 5.4877573754345215e-17_rk, 3.6104262604243153e-16_rk,   &
        9.489359419873758e-17_rk, 0.2502883256857085_rk, 2.975956553337713e-16_rk, 1.0421267985291524e-16_rk,   &
        -1.4611720972239295e-16_rk, -7.84608642927234e-17_rk, -1.1242278948530384_rk, 4.5037128061036865e-17_rk,   &
        -6.326478318993435e-17_rk, 3.7712526858642274e-17_rk, -2.194811821009689e-17_rk, -0.9340887480004108_rk,   &
        -1.8394063512622245e-16_rk, 5.496007550035349e-16_rk, 1.1242278948530384_rk, -1.1700184613891696e-16_rk,   &
        5.733989602508807e-16_rk, 2.4981219849552236e-16_rk, -9.252665513613971e-18_rk, 0.9340887480004108_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,2) = reshape((/ &
        -0.1632862362581209_rk, -2.6474392050880095e-17_rk, 1.722663771114487e-17_rk, -2.75264329861924e-16_rk,   &
        -2.385468332247821e-17_rk, -0.41269222676233686_rk, -9.76046632771425e-17_rk, -1.0694769694434367e-16_rk,   &
        0.04375241514048095_rk, -1.1229739469263708e-17_rk, -2.2785159414782273e-17_rk, 2.237588659991715e-16_rk,   &
        4.284043362643156e-17_rk, 0.11058054888356988_rk, 1.3649452155075655e-16_rk, 9.070629165263892e-17_rk,   &
        -3.927184559560126e-17_rk, 6.697474766203779e-19_rk, -0.6093925298920018_rk, -4.3807941900367577e-17_rk,   &
        -9.892781510220654e-17_rk, -9.471303755263821e-17_rk, -1.0677909656089209e-16_rk, -1.5401883581657771_rk,   &
        -9.268725073246545e-17_rk, 1.487031033973218e-16_rk, 0.16328623625812066_rk, -1.504271876303317e-16_rk,   &
        2.5267489820375753e-16_rk, 1.3226937968741038e-16_rk, -8.219562703111081e-17_rk, 0.4126922267623366_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,7,3) = reshape((/ &
        -0.25648942013041964_rk, -2.866591479338445e-18_rk, 8.690091317889415e-17_rk, -2.9446793330165673e-16_rk,   &
        -6.71040229822391e-17_rk, -0.6482554338950852_rk, -2.0156724919050044e-16_rk, -7.439026282722105e-17_rk,   &
        0.2564894201304194_rk, 9.146997085074188e-17_rk, -1.1176270242765827e-16_rk, 2.2414619101617394e-16_rk,   &
        4.99288876095371e-17_rk, 0.6482554338950848_rk, 3.8255882023945e-16_rk, 1.2346361609751445e-16_rk,   &
        -1.054380703299424e-16_rk, -1.4130105772503387e-16_rk, -0.2564894201304198_rk, 4.054219194930928e-18_rk,   &
        -6.713036800572772e-17_rk, 5.253467834930025e-17_rk, -1.2031976592466647e-17_rk, -0.648255433895085_rk,   &
        -1.2356126376592037e-16_rk, 2.0642116761252893e-16_rk, 0.25648942013041975_rk, -4.3689951539961354e-17_rk,   &
        3.8555314807182984e-16_rk, 2.1566916471905208e-16_rk, -9.660235418481932e-17_rk, 0.6482554338950851_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,1) = reshape((/ &
        0.08949307280798646_rk, 2.0741836882428464e-17_rk, -4.38974809711949e-17_rk, 2.6184266541744546e-16_rk,   &
        2.220883057649141e-17_rk, 0.15317761136886732_rk, 1.1008155569558868e-16_rk, 3.4897176786161105e-17_rk,   &
        -0.08949307280798642_rk, -2.042870325183396e-17_rk, 2.1126871753918276e-17_rk, -1.7109402201297182e-16_rk,   &
        -4.013725891474243e-17_rk, -0.15317761136886693_rk, -1.561535630198698e-16_rk, -6.09312009195487e-17_rk,   &
        6.440752432266544e-17_rk, 2.6380786020645517e-17_rk, 0.3339926946448661_rk, -2.885491999985874e-17_rk,   &
        3.193146531877442e-17_rk, 4.804111983912209e-19_rk, 1.1184119993256954e-17_rk, 0.5716666282106515_rk,   &
        6.311824015797775e-17_rk, -1.7980154626777072e-16_rk, -0.3339926946448663_rk, 3.0490891350002205e-17_rk,   &
        -3.4192386678932323e-16_rk, -1.626042550618659e-16_rk, 4.693488959035802e-17_rk, -0.5716666282106515_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,2) = reshape((/ &
        -0.609392529892002_rk, 4.8687555347121224e-18_rk, 7.135741674213286e-17_rk, -9.83919296532803e-17_rk,   &
        1.8828735174734246e-17_rk, -0.11058054888356997_rk, -1.257469690138508e-16_rk, -2.7834600556824426e-17_rk,   &
        0.1632862362581206_rk, -4.998622060997738e-17_rk, 3.491522499326804e-17_rk, 1.6236960392264873e-16_rk,   &
        6.65034933911017e-17_rk, 0.029629968771942843_rk, 1.642112957970824e-16_rk, 2.3464762532064548e-17_rk,   &
        -1.4811506285811525e-16_rk, -7.876525637764926e-17_rk, -2.2742838833098866_rk, -7.912759738189696e-17_rk,   &
        -2.070778243755942e-17_rk, 3.5654375514348994e-17_rk, -1.7249685829867396e-16_rk, -0.41269222676233674_rk,   &
        -1.0909399207123322e-16_rk, 2.929627403029169e-16_rk, 0.6093925298920015_rk, -1.1150367331077654e-16_rk,   &
        9.65787873546003e-17_rk, 6.74750409002615e-18_rk, 1.7406241008658672e-17_rk, 0.11058054888356986_rk   &
        /),(/4,8/))
        test_dbr2_vol_face3_dx(:,:,8,3) = reshape((/ &
        -0.9572315475306059_rk, -4.187491405673838e-17_rk, 1.2754690719472122e-16_rk, -7.036757729381065e-17_rk,   &
        -1.755916713321078e-17_rk, -0.17369952000127525_rk, -2.711248483624742e-16_rk, -3.815457669962081e-17_rk,   &
        0.9572315475306055_rk, 8.935285325545191e-19_rk, 1.5525933751001267e-16_rk, 4.2805699523812087e-16_rk,   &
        1.1580086916521856e-16_rk, 0.17369952000127503_rk, 1.7022488330422352e-16_rk, 8.243414790302071e-17_rk,   &
        -1.6280523558812834e-16_rk, -7.778907816502881e-17_rk, -0.9572315475306057_rk, 1.6830175618287225e-17_rk,   &
        -9.957879007608426e-17_rk, 7.220530451255624e-17_rk, 3.2322552543816654e-17_rk, -0.1736995200012751_rk,   &
        -3.525596867872176e-17_rk, 4.3765122032958214e-16_rk, 0.9572315475306054_rk, -1.0457681345034708e-16_rk,   &
        1.609764680113188e-16_rk, -2.1417937924490685e-17_rk, 7.210320253432212e-17_rk, 0.17369952000127512_rk   &
        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face4_dx
        ! 
        test_dbr2_vol_face4_dx(:,:,1,1) = reshape((/ &
        -0.33399269464486625_rk, -7.539683185915053e-17_rk, -5.01970125964232e-17_rk, -1.5145820396372192e-16_rk,   &
        -4.5943866456236807e-17_rk, -0.5716666282106513_rk, -3.093251206749621e-16_rk, -5.527151724549145e-17_rk,   &
        0.33399269464486636_rk, -1.256842699212282e-17_rk, -6.051028012126956e-17_rk, 5.786460468217162e-17_rk,   &
        3.212013704881297e-17_rk, 0.5716666282106518_rk, 9.564737004432657e-17_rk, 8.15705549882625e-17_rk,   &
        7.537173138666289e-17_rk, -9.322770090217647e-17_rk, -0.08949307280798637_rk, 1.2147404149284261e-17_rk,   &
        -9.805282621285023e-17_rk, -6.97264374325937e-17_rk, 3.063286435619247e-17_rk, -0.15317761136886693_rk,   &
        7.418812612313839e-17_rk, 1.4100785960841747e-16_rk, 0.08949307280798657_rk, 3.6669918833084225e-17_rk,   &
        5.568259100679157e-17_rk, -6.538910859804542e-17_rk, 3.615719863083273e-17_rk, 0.15317761136886698_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,1,2) = reshape((/ &
        -0.6093925298920014_rk, -3.9097478695443367e-17_rk, -8.426848858178623e-17_rk, -2.773278920016979e-16_rk,   &
        -8.784502515589524e-17_rk, -0.11058054888356988_rk, -1.183538078565248e-16_rk, -4.9774569656394465e-17_rk,   &
        2.274283883309887_rk, 7.287105355507449e-17_rk, 1.8390372903483799e-16_rk, 4.8867658614281173e-17_rk,   &
        6.340603311845284e-17_rk, 0.41269222676233686_rk, 6.926731594074715e-17_rk, 2.2277072421096852e-17_rk,   &
        -4.2638307124207345e-18_rk, -1.2742416470364066e-16_rk, -0.1632862362581205_rk, 3.624205238246018e-17_rk,   &
        -1.078834800480439e-16_rk, 7.610735239843664e-17_rk, -1.2657751333266478e-17_rk, -0.029629968771942836_rk,   &
        2.7496319220799145e-16_rk, 2.4280942155051384e-17_rk, 0.6093925298920018_rk, -1.21545608441637e-18_rk,   &
        -2.1918471944561488e-17_rk, -2.902008486289771e-17_rk, 2.4969439826877807e-17_rk, 0.11058054888356994_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,1,3) = reshape((/ &
        -0.9572315475306052_rk, -3.419963055957735e-17_rk, -8.14112476227995e-17_rk, -4.0843462849153635e-16_rk,   &
        -1.1162967539202552e-16_rk, -0.17369952000127503_rk, -1.798554398516131e-16_rk, -8.416275502989974e-17_rk,   &
        0.9572315475306059_rk, -7.31503295633668e-18_rk, -1.9370321559826376e-17_rk, 7.883442674075266e-17_rk,   &
        4.126436577648449e-18_rk, 0.17369952000127525_rk, 1.9628619087842245e-16_rk, 3.9297066384188134e-17_rk,   &
        3.525596867872177e-17_rk, -4.1295764706593736e-16_rk, -0.9572315475306052_rk, 9.023138051921316e-17_rk,   &
        -1.6097646801131876e-16_rk, 1.0586924634343836e-17_rk, -9.89558382815169e-18_rk, -0.17369952000127512_rk,   &
        1.6280523558812834e-16_rk, 3.1406575715759577e-17_rk, 0.9572315475306057_rk, -8.983350661241479e-18_rk,   &
        9.957879007608426e-17_rk, -6.306822963074282e-17_rk, -6.502021822034197e-18_rk, 0.1736995200012751_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,1) = reshape((/ &
        1.1242278948530382_rk, 1.520214039018697e-16_rk, 1.4875101188626224e-16_rk, 4.667722590943649e-16_rk,   &
        1.2117494408951265e-16_rk, 0.9340887480004105_rk, 5.219065601139376e-16_rk, 1.2323037758967153e-16_rk,   &
        -1.124227894853039_rk, 9.867729134119624e-18_rk, 5.139234173157207e-17_rk, -9.142795420536312e-17_rk,   &
        -7.32320504984838e-17_rk, -0.9340887480004111_rk, -1.966117863720799e-16_rk, -1.2842403978532554e-16_rk,   &
        -4.4121583090740037e-17_rk, 2.082397073168788e-16_rk, 0.3012359565344126_rk, -3.4555236372833256e-17_rk,   &
        1.9311900233335466e-16_rk, 6.46596342030819e-17_rk, -4.12854711396614e-17_rk, 0.2502883256857086_rk,   &
        -1.9142392141857965e-16_rk, -2.2408888358438547e-16_rk, -0.30123595653441315_rk, -3.959045491854475e-17_rk,   &
        -1.4725140305466065e-16_rk, 1.171204834545617e-16_rk, -4.61338947899797e-17_rk, -0.2502883256857086_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,2) = reshape((/ &
        -0.1632862362581205_rk, -4.8272751841612224e-17_rk, -6.643868814371267e-17_rk, -1.5462330372660037e-16_rk,   &
        -4.7872910446952474e-17_rk, -0.4126922267623366_rk, -2.3087904292543095e-16_rk, -5.041926563757661e-17_rk,   &
        0.609392529892002_rk, 8.543009244414384e-17_rk, -3.535951538232645e-17_rk, 4.837984146376754e-17_rk,   &
        6.012900203008226e-17_rk, 1.5401883581657771_rk, 1.9280449193059244e-16_rk, 1.5110498109560705e-16_rk,   &
        1.6879680023232652e-16_rk, -2.4644923098128166e-16_rk, -0.04375241514048096_rk, 4.668711872989806e-17_rk,   &
        -7.116270633174908e-17_rk, -2.786664821289352e-17_rk, 1.576651322748877e-17_rk, -0.11058054888356987_rk,   &
        8.167994646177218e-17_rk, 9.391994606759208e-17_rk, 0.16328623625812066_rk, 4.6310850367972873e-17_rk,   &
        2.4862051497211313e-17_rk, -6.442812095663835e-18_rk, 5.189851906238628e-17_rk, 0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,2,3) = reshape((/ &
        -0.25648942013041937_rk, -5.5453983555138393e-17_rk, -7.020649513826169e-17_rk, -2.0388050144004875e-16_rk,   &
        -6.328035276726503e-17_rk, -0.6482554338950848_rk, -3.625441353882008e-16_rk, -1.1016311355572279e-16_rk,   &
        0.25648942013041975_rk, 3.8647867947456615e-17_rk, -1.451629635733388e-16_rk, 2.8405045553205475e-16_rk,   &
        4.903560051700258e-17_rk, 0.6482554338950852_rk, 1.2952542756231436e-16_rk, 1.0935563454403169e-16_rk,   &
        1.2356126376592037e-16_rk, -1.4789902712719028e-16_rk, -0.25648942013041964_rk, -1.7863735628728318e-17_rk,   &
        -3.8555314807182974e-16_rk, -2.312574892247037e-16_rk, 1.3230008024221987e-16_rk, -0.6482554338950851_rk,   &
        1.0543807032994238e-16_rk, 1.461191785934539e-16_rk, 0.2564894201304198_rk, 3.324633283598962e-17_rk,   &
        6.713036800572775e-17_rk, -3.740024327218964e-17_rk, 3.7979811809530245e-17_rk, 0.648255433895085_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,1) = reshape((/ &
        0.3012359565344126_rk, 3.077334136321796e-17_rk, 1.5435620338049908e-16_rk, 3.760272199555776e-16_rk,   &
        1.4311619725281637e-16_rk, 0.2502883256857083_rk, 2.3624845713443296e-16_rk, 8.281330716731975e-17_rk,   &
        -4.195675622877744_rk, -3.3958955019073384e-16_rk, -2.770386718184324e-16_rk, -1.0815308320613151e-16_rk,   &
        -1.79335626833927e-16_rk, -3.486066666315935_rk, -3.8649587443837854e-16_rk, -2.7442222134844947e-16_rk,   &
        -3.565815969782884e-16_rk, 6.028860367904981e-16_rk, 0.08071593128461277_rk, -1.3957733676574333e-16_rk,   &
        1.6135207403221121e-16_rk, -1.260620589104444e-16_rk, 2.4596153363880158e-17_rk, 0.06706455474242332_rk,   &
        -4.710997408919342e-16_rk, -4.3953265061061164e-17_rk, -1.1242278948530386_rk, -7.026869874578241e-17_rk,   &
        1.2424740226270196e-16_rk, -5.245956734957771e-17_rk, -1.2152354546051486e-16_rk, -0.9340887480004108_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,2) = reshape((/ &
        0.1632862362581205_rk, 4.8272751841612224e-17_rk, 6.643868814371267e-17_rk, 1.5462330372660037e-16_rk,   &
        4.7872910446952474e-17_rk, 0.4126922267623366_rk, 2.3087904292543095e-16_rk, 5.041926563757661e-17_rk,   &
        -0.609392529892002_rk, -8.543009244414384e-17_rk, 3.535951538232645e-17_rk, -4.837984146376754e-17_rk,   &
        -6.012900203008226e-17_rk, -1.5401883581657771_rk, -1.9280449193059244e-16_rk, -1.5110498109560705e-16_rk,   &
        -1.6879680023232652e-16_rk, 2.4644923098128166e-16_rk, 0.04375241514048096_rk, -4.668711872989806e-17_rk,   &
        7.116270633174908e-17_rk, 2.786664821289352e-17_rk, -1.576651322748877e-17_rk, 0.11058054888356987_rk,   &
        -8.167994646177218e-17_rk, -9.391994606759208e-17_rk, -0.16328623625812066_rk, -4.6310850367972873e-17_rk,   &
        -2.4862051497211313e-17_rk, 6.442812095663835e-18_rk, -5.189851906238628e-17_rk, -0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,3,3) = reshape((/ &
        -0.06872613299107283_rk, 1.3098518904548219e-17_rk, 7.598941617816168e-18_rk, -3.4366640809890766e-16_rk,   &
        -7.641576070958359e-17_rk, -0.17369952000127492_rk, -1.225998701159171e-16_rk, -5.639273849189885e-17_rk,   &
        0.9572315475306059_rk, 1.6518451347138116e-16_rk, 5.916518452395827e-17_rk, 2.26792424037114e-16_rk,   &
        8.096478082289381e-17_rk, 2.4193222155790655_rk, 2.7262744919240525e-16_rk, 3.0300302870152804e-16_rk,   &
        2.871769230050245e-16_rk, -4.3158330548895014e-16_rk, -0.06872613299107289_rk, 2.780895661881463e-16_rk,   &
        -1.231297716106022e-16_rk, -2.0964429331430223e-17_rk, 9.066434499417369e-17_rk, -0.17369952000127495_rk,   &
        8.455256035303993e-17_rk, -1.303240489766286e-17_rk, 0.9572315475306057_rk, 1.3345939772649766e-16_rk,   &
        1.2731829974306808e-16_rk, 1.7628173389963282e-16_rk, 1.5538749204943566e-16_rk, 2.419322215579065_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,1) = reshape((/ &
        -0.08949307280798648_rk, -1.5710984273364334e-17_rk, -8.255685869301316e-17_rk, -1.7712605092681454e-16_rk,   &
        -5.626794677814219e-17_rk, -0.15317761136886682_rk, -1.0983755541296636e-16_rk, -4.2047635373965756e-17_rk,   &
        1.2464777057714789_rk, 1.746943517793617e-16_rk, 4.513752995098732e-17_rk, 3.5785438315646696e-17_rk,   &
        8.491845873241381e-17_rk, 2.1334889014737395_rk, 2.47245085254994e-16_rk, 1.7942618168689832e-16_rk,   &
        2.091390604343444e-16_rk, -3.544658740561553e-16_rk, -0.023979596587079724_rk, 7.55880673929934e-17_rk,   &
        -4.839914273425513e-17_rk, 4.0978644974018046e-17_rk, -7.020692333278728e-18_rk, -0.04104381726481621_rk,   &
        1.3043173409975407e-16_rk, 2.3737395594430696e-17_rk, 0.33399269464486625_rk, 4.137702910361385e-17_rk,   &
        -1.8922117320735953e-17_rk, 4.7477252948106156e-17_rk, 5.766986692720192e-17_rk, 0.5716666282106517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,2) = reshape((/ &
        0.6093925298920014_rk, 3.9097478695443367e-17_rk, 8.426848858178623e-17_rk, 2.773278920016979e-16_rk,   &
        8.784502515589524e-17_rk, 0.11058054888356988_rk, 1.183538078565248e-16_rk, 4.9774569656394465e-17_rk,   &
        -2.274283883309887_rk, -7.287105355507449e-17_rk, -1.8390372903483799e-16_rk, -4.8867658614281173e-17_rk,   &
        -6.340603311845284e-17_rk, -0.41269222676233686_rk, -6.926731594074715e-17_rk, -2.2277072421096852e-17_rk,   &
        4.2638307124207345e-18_rk, 1.2742416470364066e-16_rk, 0.1632862362581205_rk, -3.624205238246018e-17_rk,   &
        1.078834800480439e-16_rk, -7.610735239843664e-17_rk, 1.2657751333266478e-17_rk, 0.029629968771942836_rk,   &
        -2.7496319220799145e-16_rk, -2.4280942155051384e-17_rk, -0.6093925298920018_rk, 1.21545608441637e-18_rk,   &
        2.1918471944561488e-17_rk, 2.902008486289771e-17_rk, -2.4969439826877807e-17_rk, -0.11058054888356994_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,4,3) = reshape((/ &
        -0.2564894201304195_rk, 5.1517119773950094e-17_rk, 3.1432889393233393e-16_rk, -2.5822784388650804e-16_rk,   &
        -1.1373118534053218e-16_rk, -0.046542646110015254_rk, -2.1830857004410004e-16_rk, -2.78469296705666e-17_rk,   &
        3.572436769992004_rk, 1.0394794503445278e-16_rk, 4.380803527702151e-16_rk, 1.6167543553526523e-16_rk,   &
        6.538072020933012e-17_rk, 0.6482554338950852_rk, 3.1440292345603844e-17_rk, 3.0922332483040653e-17_rk,   &
        1.2941086372101728e-16_rk, -2.25754358694565e-16_rk, -0.2564894201304193_rk, 1.3819833412084752e-16_rk,   &
        -1.6019211059291058e-16_rk, 9.582236270305843e-17_rk, 7.846687929537481e-17_rk, -0.046542646110015296_rk,   &
        5.017645334165064e-16_rk, 7.762426235647683e-17_rk, 3.5724367699920028_rk, 1.2851757662848275e-16_rk,   &
        -1.0148053670657227e-16_rk, -3.767520596311167e-17_rk, 2.5015970838236263e-16_rk, 0.6482554338950851_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,1) = reshape((/ &
        -0.08949307280798648_rk, 1.0415675636758823e-17_rk, -3.79347894944432e-17_rk, -1.3094150966272083e-16_rk,   &
        -3.937800196882178e-17_rk, -0.15317761136886698_rk, -1.0877709279719452e-16_rk, -7.631379812681001e-17_rk,   &
        0.08949307280798657_rk, 5.3063818173024326e-17_rk, -9.879911473614551e-17_rk, 2.601642592355417e-16_rk,   &
        2.1322269135289557e-17_rk, 0.15317761136886715_rk, 7.403942746561542e-17_rk, 4.2242753964415926e-17_rk,   &
        6.311824015797777e-17_rk, -1.295801201680189e-16_rk, -0.33399269464486625_rk, -1.7503522438804986e-17_rk,   &
        -3.419238667893232e-16_rk, -1.7769133178872661e-16_rk, 1.1032174762340558e-16_rk, -0.5716666282106515_rk,   &
        6.440752432266544e-17_rk, 2.1183036679265128e-17_rk, 0.33399269464486636_rk, -2.248229726824862e-18_rk,   &
        3.193146531877438e-17_rk, 1.540911897711153e-17_rk, 3.7438261145022695e-18_rk, 0.5716666282106515_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,2) = reshape((/ &
        -0.16328623625812053_rk, 5.01221347370754e-17_rk, 2.32548467555755e-16_rk, -1.4708261940962179e-16_rk,   &
        -5.562415470422785e-17_rk, -0.029629968771942843_rk, -1.3512527348824742e-16_rk, -2.1533010320580964e-17_rk,   &
        0.609392529892002_rk, -1.1352631064687703e-17_rk, 8.265535572234255e-17_rk, 1.0424567516003565e-16_rk,   &
        -1.9156402786808776e-17_rk, 0.11058054888356997_rk, 7.57078659714023e-17_rk, 2.2425985301546768e-17_rk,   &
        1.0909399207123324e-16_rk, -2.791925270120516e-16_rk, -0.6093925298920013_rk, 1.091808205536868e-16_rk,   &
        -9.657878735460032e-17_rk, -8.365096115903069e-18_rk, 5.631159384456022e-17_rk, -0.11058054888356987_rk,   &
        1.4811506285811527e-16_rk, 4.513024515954237e-17_rk, 2.2742838833098866_rk, 7.731330780981656e-17_rk,   &
        2.0707782437559422e-17_rk, -3.511517817239e-17_rk, 1.3014786112676996e-16_rk, 0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,5,3) = reshape((/ &
        0.9572315475306052_rk, 3.419963055957735e-17_rk, 8.14112476227995e-17_rk, 4.0843462849153635e-16_rk,   &
        1.1162967539202552e-16_rk, 0.17369952000127503_rk, 1.798554398516131e-16_rk, 8.416275502989974e-17_rk,   &
        -0.9572315475306059_rk, 7.31503295633668e-18_rk, 1.9370321559826376e-17_rk, -7.883442674075266e-17_rk,   &
        -4.126436577648449e-18_rk, -0.17369952000127525_rk, -1.9628619087842245e-16_rk, -3.9297066384188134e-17_rk,   &
        -3.525596867872177e-17_rk, 4.1295764706593736e-16_rk, 0.9572315475306052_rk, -9.023138051921316e-17_rk,   &
        1.6097646801131876e-16_rk, -1.0586924634343836e-17_rk, 9.89558382815169e-18_rk, 0.17369952000127512_rk,   &
        -1.6280523558812834e-16_rk, -3.1406575715759577e-17_rk, -0.9572315475306057_rk, 8.983350661241479e-18_rk,   &
        -9.957879007608426e-17_rk, 6.306822963074282e-17_rk, 6.502021822034197e-18_rk, -0.1736995200012751_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,1) = reshape((/ &
        0.3012359565344126_rk, -2.9877211675958124e-17_rk, 4.6932631920232156e-17_rk, 2.8674272765044155e-16_rk,   &
        9.639601828230716e-17_rk, 0.25028832568570847_rk, 2.2954412186195444e-16_rk, 1.3688814868210174e-16_rk,   &
        -0.30123595653441293_rk, -6.144825971569032e-17_rk, 1.927956408303006e-16_rk, -4.304713600263009e-16_rk,   &
        -6.651189688218485e-18_rk, -0.25028832568570875_rk, -2.140432308236279e-16_rk, -8.213531561923345e-17_rk,   &
        -1.8394063512622245e-16_rk, 4.640208774113465e-16_rk, 1.1242278948530384_rk, -3.513434937289121e-17_rk,   &
        5.733989602508807e-16_rk, 2.7971981499793814e-16_rk, -1.5159633126420584e-16_rk, 0.9340887480004106_rk,   &
        -1.4611720972239295e-16_rk, -3.4532318868669343e-17_rk, -1.1242278948530386_rk, -1.8833718093330943e-18_rk,   &
        -6.326478318993434e-17_rk, 8.337984258837678e-18_rk, -5.2944075701839104e-18_rk, -0.934088748000411_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,2) = reshape((/ &
        -0.043752415140480894_rk, 2.1308425577230372e-17_rk, 2.6581481673035434e-17_rk, -1.9395588518466275e-16_rk,   &
        -4.106039751531471e-17_rk, -0.11058054888356988_rk, -7.797322342409717e-17_rk, -5.561348297946884e-17_rk,   &
        0.1632862362581209_rk, 4.433363181585866e-17_rk, -1.9388371140207753e-17_rk, 2.768328362431564e-16_rk,   &
        2.263181114622134e-17_rk, 0.41269222676233686_rk, 6.32139809259652e-17_rk, 1.1141069723358138e-16_rk,   &
        9.268725073246547e-17_rk, -1.2246067969984067e-16_rk, -0.16328623625812055_rk, 1.1897779028500343e-16_rk,   &
        -2.5267489820375753e-16_rk, -1.3270281216442713e-16_rk, 1.261770484125727e-16_rk, -0.4126922267623366_rk,   &
        3.9271845595601245e-17_rk, -9.194274492241776e-18_rk, 0.6093925298920018_rk, 5.981731387508913e-17_rk,   &
        9.892781510220656e-17_rk, 9.485751504497713e-17_rk, 7.12029299036415e-17_rk, 1.5401883581657771_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,6,3) = reshape((/ &
        0.25648942013041937_rk, 5.5453983555138393e-17_rk, 7.020649513826169e-17_rk, 2.0388050144004875e-16_rk,   &
        6.328035276726503e-17_rk, 0.6482554338950848_rk, 3.625441353882008e-16_rk, 1.1016311355572279e-16_rk,   &
        -0.25648942013041975_rk, -3.8647867947456615e-17_rk, 1.451629635733388e-16_rk, -2.8405045553205475e-16_rk,   &
        -4.903560051700258e-17_rk, -0.6482554338950852_rk, -1.2952542756231436e-16_rk, -1.0935563454403169e-16_rk,   &
        -1.2356126376592037e-16_rk, 1.4789902712719028e-16_rk, 0.25648942013041964_rk, 1.7863735628728318e-17_rk,   &
        3.8555314807182974e-16_rk, 2.312574892247037e-16_rk, -1.3230008024221987e-16_rk, 0.6482554338950851_rk,   &
        -1.0543807032994238e-16_rk, -1.461191785934539e-16_rk, -0.2564894201304198_rk, -3.324633283598962e-17_rk,   &
        -6.713036800572775e-17_rk, 3.740024327218964e-17_rk, -3.7979811809530245e-17_rk, -0.648255433895085_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,1) = reshape((/ &
        0.08071593128461271_rk, -1.0640488404985377e-16_rk, -5.045549224119605e-16_rk, 4.3078185515128906e-16_rk,   &
        9.692624959019306e-17_rk, 0.06706455474242337_rk, 1.874682646298548e-16_rk, 3.3933753234673304e-17_rk,   &
        -1.124227894853039_rk, -2.6484411340801682e-17_rk, -2.8576353043250417e-16_rk, -4.14870345888945e-16_rk,   &
        -1.5635580811342086e-17_rk, -0.9340887480004111_rk, -6.678974684520305e-17_rk, -2.250372577894836e-16_rk,   &
        -2.2459459934438325e-16_rk, 3.0420835794049526e-16_rk, 0.3012359565344125_rk, -4.3708174026924057e-16_rk,   &
        2.0059292446877277e-16_rk, 5.5121713432427966e-17_rk, -2.4858255413455103e-16_rk, 0.25028832568570825_rk,   &
        -1.9934292640744184e-16_rk, -1.959224071104794e-17_rk, -4.195675622877742_rk, -2.734569956641185e-16_rk,   &
        -2.1083497772188267e-16_rk, -1.7816980145881408e-16_rk, -3.869368974888536e-16_rk, -3.4860666663159345_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,2) = reshape((/ &
        0.043752415140480894_rk, -2.1308425577230372e-17_rk, -2.6581481673035434e-17_rk, 1.9395588518466275e-16_rk,   &
        4.106039751531471e-17_rk, 0.11058054888356988_rk, 7.797322342409717e-17_rk, 5.561348297946884e-17_rk,   &
        -0.1632862362581209_rk, -4.433363181585866e-17_rk, 1.9388371140207753e-17_rk, -2.768328362431564e-16_rk,   &
        -2.263181114622134e-17_rk, -0.41269222676233686_rk, -6.32139809259652e-17_rk, -1.1141069723358138e-16_rk,   &
        -9.268725073246547e-17_rk, 1.2246067969984067e-16_rk, 0.16328623625812055_rk, -1.1897779028500343e-16_rk,   &
        2.5267489820375753e-16_rk, 1.3270281216442713e-16_rk, -1.261770484125727e-16_rk, 0.4126922267623366_rk,   &
        -3.9271845595601245e-17_rk, 9.194274492241776e-18_rk, -0.6093925298920018_rk, -5.981731387508913e-17_rk,   &
        -9.892781510220656e-17_rk, -9.485751504497713e-17_rk, -7.12029299036415e-17_rk, -1.5401883581657771_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,7,3) = reshape((/ &
        0.06872613299107283_rk, -1.3098518904548219e-17_rk, -7.598941617816168e-18_rk, 3.4366640809890766e-16_rk,   &
        7.641576070958359e-17_rk, 0.17369952000127492_rk, 1.225998701159171e-16_rk, 5.639273849189885e-17_rk,   &
        -0.9572315475306059_rk, -1.6518451347138116e-16_rk, -5.916518452395827e-17_rk, -2.26792424037114e-16_rk,   &
        -8.096478082289381e-17_rk, -2.4193222155790655_rk, -2.7262744919240525e-16_rk, -3.0300302870152804e-16_rk,   &
        -2.871769230050245e-16_rk, 4.3158330548895014e-16_rk, 0.06872613299107289_rk, -2.780895661881463e-16_rk,   &
        1.231297716106022e-16_rk, 2.0964429331430223e-17_rk, -9.066434499417369e-17_rk, 0.17369952000127495_rk,   &
        -8.455256035303993e-17_rk, 1.303240489766286e-17_rk, -0.9572315475306057_rk, -1.3345939772649766e-16_rk,   &
        -1.2731829974306808e-16_rk, -1.7628173389963282e-16_rk, -1.5538749204943566e-16_rk, -2.419322215579065_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,1) = reshape((/ &
        -0.023979596587079807_rk, 3.7742792289639356e-17_rk, 1.390986256556358e-16_rk, -2.3270359531608725e-16_rk,   &
        -4.3523054807645113e-17_rk, -0.04104381726481629_rk, -5.577900779557501e-17_rk, -2.2967149105089416e-17_rk,   &
        0.3339926946448665_rk, 1.918865427204153e-17_rk, 8.59757999625393e-17_rk, 2.333257007297477e-16_rk,   &
        1.2332954493676462e-17_rk, 0.5716666282106516_rk, 5.1190674236150757e-17_rk, 1.5164205421983043e-16_rk,   &
        1.2003775875891532e-16_rk, -1.4504758703880098e-16_rk, -0.08949307280798639_rk, 2.4515428605898686e-16_rk,   &
        -1.0884708986068731e-16_rk, -4.8813820761241585e-17_rk, 1.1673104529552343e-16_rk, -0.15317761136886676_rk,   &
        3.7819412959905364e-17_rk, -2.5830098967840426e-17_rk, 1.2464777057714789_rk, 1.2212041100622716e-16_rk,   &
        1.404217421661058e-16_rk, 1.3656842879563507e-16_rk, 1.481566181079384e-16_rk, 2.1334889014737395_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,2) = reshape((/ &
        0.16328623625812053_rk, -5.01221347370754e-17_rk, -2.32548467555755e-16_rk, 1.4708261940962179e-16_rk,   &
        5.562415470422785e-17_rk, 0.029629968771942843_rk, 1.3512527348824742e-16_rk, 2.1533010320580964e-17_rk,   &
        -0.609392529892002_rk, 1.1352631064687703e-17_rk, -8.265535572234255e-17_rk, -1.0424567516003565e-16_rk,   &
        1.9156402786808776e-17_rk, -0.11058054888356997_rk, -7.57078659714023e-17_rk, -2.2425985301546768e-17_rk,   &
        -1.0909399207123324e-16_rk, 2.791925270120516e-16_rk, 0.6093925298920013_rk, -1.091808205536868e-16_rk,   &
        9.657878735460032e-17_rk, 8.365096115903069e-18_rk, -5.631159384456022e-17_rk, 0.11058054888356987_rk,   &
        -1.4811506285811527e-16_rk, -4.513024515954237e-17_rk, -2.2742838833098866_rk, -7.731330780981656e-17_rk,   &
        -2.0707782437559422e-17_rk, 3.511517817239e-17_rk, -1.3014786112676996e-16_rk, -0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face4_dx(:,:,8,3) = reshape((/ &
        0.2564894201304195_rk, -5.1517119773950094e-17_rk, -3.1432889393233393e-16_rk, 2.5822784388650804e-16_rk,   &
        1.1373118534053218e-16_rk, 0.046542646110015254_rk, 2.1830857004410004e-16_rk, 2.78469296705666e-17_rk,   &
        -3.572436769992004_rk, -1.0394794503445278e-16_rk, -4.380803527702151e-16_rk, -1.6167543553526523e-16_rk,   &
        -6.538072020933012e-17_rk, -0.6482554338950852_rk, -3.1440292345603844e-17_rk, -3.0922332483040653e-17_rk,   &
        -1.2941086372101728e-16_rk, 2.25754358694565e-16_rk, 0.2564894201304193_rk, -1.3819833412084752e-16_rk,   &
        1.6019211059291058e-16_rk, -9.582236270305843e-17_rk, -7.846687929537481e-17_rk, 0.046542646110015296_rk,   &
        -5.017645334165064e-16_rk, -7.762426235647683e-17_rk, -3.5724367699920028_rk, -1.2851757662848275e-16_rk,   &
        1.0148053670657227e-16_rk, 3.767520596311167e-17_rk, -2.5015970838236263e-16_rk, -0.6482554338950851_rk   &
        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face5_dx
        ! 
        test_dbr2_vol_face5_dx(:,:,1,1) = reshape((/ &
        1.2464777057714787_rk, 2.09588305135317e-16_rk, 8.119310948362589e-17_rk, 1.463991294965239e-17_rk,   &
        1.1411910015764836e-16_rk, 2.1334889014737395_rk, 8.94509061574123e-17_rk, 1.4044760430955448e-16_rk,   &
        -7.826369212126645e-18_rk, 1.5212170374726064e-16_rk, 0.33399269464486636_rk, 2.7573476650188053e-17_rk,   &
        -2.9985760514603866e-17_rk, 2.6288267228829814e-16_rk, 1.767922574621817e-17_rk, 0.5716666282106517_rk,   &
        -0.0894930728079864_rk, -2.517649450928476e-16_rk, 7.918243317901162e-17_rk, -9.570779886176141e-17_rk,   &
        2.2167157415692055e-17_rk, -0.1531776113688669_rk, -4.399816165206631e-17_rk, -9.424857128091323e-17_rk,   &
        1.5286022615734108e-16_rk, -1.5571246526759266e-16_rk, -0.023979596587079557_rk, -7.889003408425737e-17_rk,   &
        4.198256182896252e-17_rk, -5.944156851224287e-17_rk, 3.745788051717883e-17_rk, -0.04104381726481622_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,1,2) = reshape((/ &
        2.274283883309887_rk, 1.0120116228344212e-16_rk, 1.6774789243195784e-16_rk, 7.033364917910879e-17_rk,   &
        9.367621497614797e-17_rk, 0.41269222676233686_rk, 1.8166161342557443e-17_rk, 4.958788145634346e-17_rk,   &
        1.3639702134354397e-16_rk, 9.053057388485806e-17_rk, 2.274283883309887_rk, 9.410609311273505e-17_rk,   &
        2.925208569808879e-17_rk, 4.2172140834192717e-17_rk, 5.108505391740986e-17_rk, 0.41269222676233686_rk,   &
        -0.16328623625812028_rk, -1.896144992902804e-17_rk, -8.926000578475394e-18_rk, -1.515583997831366e-16_rk,   &
        -2.2581885639157568e-17_rk, -0.029629968771942822_rk, 1.6058457619366047e-17_rk, -4.087394305919076e-18_rk,   &
        -5.364958566653981e-18_rk, -1.5474317343303278e-16_rk, -0.16328623625812028_rk, -2.2146223578924243e-17_rk,   &
        -1.2997415427313083e-17_rk, 3.503215518123299e-18_rk, 4.3652913906968126e-17_rk, -0.029629968771942836_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,1,3) = reshape((/ &
        3.572436769992004_rk, 1.5368895993581347e-16_rk, 2.7808075961304936e-16_rk, 1.2955307816722754e-16_rk,   &
        1.085844359659891e-16_rk, 0.6482554338950852_rk, 8.888288474533441e-17_rk, 3.343306303772456e-17_rk,   &
        1.1057958004417384e-17_rk, 1.4715492157221873e-16_rk, 0.9572315475306059_rk, 1.6392998273518534e-17_rk,   &
        1.8984043602629457e-16_rk, 2.5424088120490402e-17_rk, -1.2901362209786306e-16_rk, 0.17369952000127525_rk,   &
        -0.957231547530605_rk, 3.3986249200675393e-18_rk, 4.742278811104301e-17_rk, -4.692457707980776e-16_rk,   &
        -8.894445606921079e-17_rk, -0.17369952000127503_rk, -1.0941871553845151e-16_rk, -6.416809406580946e-17_rk,   &
        -1.0018796441802039e-16_rk, -2.9946113520198954e-16_rk, -0.2564894201304193_rk, -1.4953185975707406e-17_rk,   &
        -7.072751169281297e-17_rk, 1.709206784202439e-17_rk, 3.619273106489881e-17_rk, -0.04654264611001528_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,1) = reshape((/ &
        -4.195675622877744_rk, -4.150174465027437e-16_rk, -3.002427147193308e-16_rk, -9.19264614339882e-17_rk,   &
        -2.893090145263504e-16_rk, -3.486066666315935_rk, -1.4694468894172049e-16_rk, -2.1287824182127832e-16_rk,   &
        -1.602023484735139e-17_rk, -2.732710644842457e-16_rk, -1.124227894853039_rk, -6.136207079936635e-17_rk,   &
        2.072886845980304e-17_rk, -4.179638447316528e-16_rk, -9.71182194522396e-18_rk, -0.9340887480004111_rk,   &
        0.30123595653441226_rk, 3.840465247898307e-16_rk, -1.3486322205295994e-16_rk, 2.5567982978719464e-16_rk,   &
        7.24309436454023e-18_rk, 0.25028832568570836_rk, 7.984336915874615e-17_rk, 1.51892956900147e-16_rk,   &
        -1.9158609872152526e-16_rk, 3.1387462366831243e-16_rk, 0.08071593128461252_rk, 1.1181044161338873e-16_rk,   &
        -5.662247477861491e-17_rk, 6.545342047208758e-17_rk, -6.560194238324895e-17_rk, 0.06706455474242341_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,2) = reshape((/ &
        0.609392529892002_rk, 1.4374884413736924e-16_rk, 5.716842567411911e-17_rk, 2.7646918788863575e-17_rk,   &
        5.699620598665367e-17_rk, 1.5401883581657771_rk, 1.520075344559581e-17_rk, 2.425315193686303e-16_rk,   &
        1.0642603756060587e-17_rk, 1.1796554301262754e-16_rk, 0.609392529892002_rk, 1.1850293070257956e-16_rk,   &
        4.2400004988783983e-17_rk, 2.418050926717122e-16_rk, 6.981272584103195e-17_rk, 1.5401883581657771_rk,   &
        -0.04375241514048091_rk, -1.9380507391029953e-16_rk, 8.82753232236919e-17_rk, -1.251596233350429e-16_rk,   &
        3.225934063166717e-17_rk, -0.11058054888356984_rk, 4.197683300878644e-18_rk, -9.588612922385191e-17_rk,   &
        1.3788509798793143e-16_rk, -1.254719738686426e-16_rk, -0.04375241514048091_rk, -1.941174244438992e-16_rk,   &
        8.526579115025243e-18_rk, -8.890357863132101e-17_rk, 6.212129521327434e-17_rk, -0.11058054888356984_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,2,3) = reshape((/ &
        0.9572315475306059_rk, 2.0048565753202916e-16_rk, 2.6710696428670652e-17_rk, 6.733987631616598e-17_rk,   &
        4.548599192652891e-17_rk, 2.4193222155790655_rk, 1.614990726014505e-16_rk, 1.347409804716289e-16_rk,   &
        -4.1977359519551933e-17_rk, 3.412875110511353e-16_rk, 0.2564894201304197_rk, 1.6373202155000972e-17_rk,   &
        1.4586488574471408e-17_rk, 2.4419758815883177e-16_rk, -1.1167268514024152e-17_rk, 0.6482554338950852_rk,   &
        -0.2564894201304196_rk, -3.090118476489072e-16_rk, 1.2335810027133427e-16_rk, -1.814108564526034e-16_rk,   &
        2.2968468357892587e-17_rk, -0.6482554338950849_rk, -3.688000386529474e-16_rk, -2.5191981181986113e-16_rk,   &
        2.706075991485922e-16_rk, -3.009430014960806e-16_rk, -0.06872613299107283_rk, -1.3503403919278473e-16_rk,   &
        -3.929143221701731e-17_rk, -1.5490546913594146e-16_rk, 2.3690696870582382e-17_rk, -0.17369952000127503_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,1) = reshape((/ &
        -1.124227894853039_rk, -1.0356200909654139e-16_rk, -1.2167789195658727e-16_rk, -9.38636384539828e-17_rk,   &
        -6.893768673478069e-18_rk, -0.9340887480004111_rk, 7.948003458317643e-17_rk, -4.571099784677146e-16_rk,   &
        -2.4043164356202765e-16_rk, -1.6494956120387585e-16_rk, -4.195675622877744_rk, -3.8420565540893216e-16_rk,   &
        -1.7267674573429586e-16_rk, -2.3772422005269184e-16_rk, -2.454151378208419e-16_rk, -3.486066666315935_rk,   &
        0.08071593128461246_rk, 1.1638040035165813e-16_rk, -6.336432136436422e-17_rk, 3.031623870892709e-16_rk,   &
        -4.700120768636229e-17_rk, 0.06706455474242337_rk, -1.1715244897384255e-16_rk, 8.674074209791061e-17_rk,   &
        -1.325528634204166e-16_rk, 2.5110987104892535e-16_rk, 0.3012359565344124_rk, 3.9475876136887227e-16_rk,   &
        5.800383713819605e-17_rk, 1.4346569969024e-16_rk, -1.5836542393986537e-16_rk, 0.25028832568570836_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,2) = reshape((/ &
        -0.609392529892002_rk, -1.4374884413736924e-16_rk, -5.716842567411911e-17_rk, -2.7646918788863575e-17_rk,   &
        -5.699620598665367e-17_rk, -1.5401883581657771_rk, -1.520075344559581e-17_rk, -2.425315193686303e-16_rk,   &
        -1.0642603756060587e-17_rk, -1.1796554301262754e-16_rk, -0.609392529892002_rk, -1.1850293070257956e-16_rk,   &
        -4.2400004988783983e-17_rk, -2.418050926717122e-16_rk, -6.981272584103195e-17_rk, -1.5401883581657771_rk,   &
        0.04375241514048091_rk, 1.9380507391029953e-16_rk, -8.82753232236919e-17_rk, 1.251596233350429e-16_rk,   &
        -3.225934063166717e-17_rk, 0.11058054888356984_rk, -4.197683300878644e-18_rk, 9.588612922385191e-17_rk,   &
        -1.3788509798793143e-16_rk, 1.254719738686426e-16_rk, 0.04375241514048091_rk, 1.941174244438992e-16_rk,   &
        -8.526579115025243e-18_rk, 8.890357863132101e-17_rk, -6.212129521327434e-17_rk, 0.11058054888356984_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,3,3) = reshape((/ &
        0.25648942013041975_rk, 5.1523083754321746e-17_rk, 1.4580656519380047e-16_rk, 2.186397113317475e-16_rk,   &
        -1.8394830652134714e-17_rk, 0.6482554338950852_rk, -1.7215108445217604e-17_rk, 3.2230004139447507e-16_rk,   &
        -1.050366668592597e-17_rk, 1.4735506572571788e-16_rk, 0.9572315475306059_rk, 1.8032813595906924e-16_rk,   &
        1.554507497902171e-16_rk, 1.5040991074871336e-16_rk, 1.808537598902878e-17_rk, 2.4193222155790655_rk,   &
        -0.0687261329910728_rk, -1.4637975156438789e-16_rk, 2.400530555509495e-16_rk, -3.012597393923613e-16_rk,   &
        -1.1625645940059593e-18_rk, -0.17369952000127503_rk, -3.9149357166267535e-17_rk, -1.7440129305820581e-16_rk,   &
        1.043459109776669e-16_rk, -1.7006514408100035e-16_rk, -0.2564894201304197_rk, -3.086951097526264e-16_rk,   &
        -3.901155821369045e-16_rk, -2.602417436213281e-16_rk, 3.631348665520886e-17_rk, -0.6482554338950849_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,1) = reshape((/ &
        0.3339926946448665_rk, 5.803746539485947e-17_rk, 5.605265123369386e-17_rk, 4.9125254303552326e-17_rk,   &
        4.935095446682197e-18_rk, 0.5716666282106518_rk, -5.934685181174306e-17_rk, 2.818086726656415e-16_rk,   &
        5.879152003136956e-17_rk, 6.930967848184303e-17_rk, 1.2464777057714789_rk, 1.956310284613193e-16_rk,   &
        1.0877983334736042e-16_rk, 1.5635266671148684e-16_rk, 1.1276311706147588e-16_rk, 2.1334889014737395_rk,   &
        -0.0239795965870796_rk, -8.066315696666101e-17_rk, 6.798940456609828e-17_rk, -1.5264132634720653e-16_rk,   &
        2.6946447718038064e-17_rk, -0.04104381726481618_rk, 5.4979777777138785e-17_rk, -6.894273964058707e-17_rk,   &
        7.909340166796236e-17_rk, -9.393467597935779e-17_rk, -0.08949307280798639_rk, -2.548360840132337e-16_rk,   &
        -3.069974003403889e-17_rk, -9.010351844208982e-17_rk, 7.817737381762554e-17_rk, -0.15317761136886687_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,2) = reshape((/ &
        -2.274283883309887_rk, -1.0120116228344212e-16_rk, -1.6774789243195784e-16_rk, -7.033364917910879e-17_rk,   &
        -9.367621497614797e-17_rk, -0.41269222676233686_rk, -1.8166161342557443e-17_rk, -4.958788145634346e-17_rk,   &
        -1.3639702134354397e-16_rk, -9.053057388485806e-17_rk, -2.274283883309887_rk, -9.410609311273505e-17_rk,   &
        -2.925208569808879e-17_rk, -4.2172140834192717e-17_rk, -5.108505391740986e-17_rk, -0.41269222676233686_rk,   &
        0.16328623625812028_rk, 1.896144992902804e-17_rk, 8.926000578475394e-18_rk, 1.515583997831366e-16_rk,   &
        2.2581885639157568e-17_rk, 0.029629968771942822_rk, -1.6058457619366047e-17_rk, 4.087394305919076e-18_rk,   &
        5.364958566653981e-18_rk, 1.5474317343303278e-16_rk, 0.16328623625812028_rk, 2.2146223578924243e-17_rk,   &
        1.2997415427313083e-17_rk, -3.503215518123299e-18_rk, -4.3652913906968126e-17_rk, 0.029629968771942836_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,4,3) = reshape((/ &
        0.9572315475306059_rk, 1.0720142087716923e-17_rk, 2.675729310795948e-17_rk, 8.14986163964661e-17_rk,   &
        -1.2047819688479096e-16_rk, 0.17369952000127525_rk, 1.0666431451434622e-16_rk, 6.327466757781445e-17_rk,   &
        2.9167886355900583e-16_rk, 1.2909350354923596e-16_rk, 3.572436769992004_rk, 1.1512998410394556e-16_rk,   &
        1.018192910405954e-16_rk, 1.9845186964227615e-17_rk, 4.183299945591906e-17_rk, 0.6482554338950852_rk,   &
        -0.25648942013041937_rk, -1.3122096035113756e-17_rk, -5.918564026887742e-17_rk, -2.8880686568113793e-16_rk,   &
        1.4457205199985443e-17_rk, -0.04654264611001528_rk, 8.208282697970144e-19_rk, 1.2759662525965653e-17_rk,   &
        6.999827873786936e-17_rk, -4.710768607386714e-16_rk, -0.9572315475306048_rk, -7.255644600784016e-18_rk,   &
        -1.1795129815679835e-16_rk, -5.956138568523032e-17_rk, 3.187793889903391e-17_rk, -0.17369952000127503_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,1) = reshape((/ &
        0.33399269464486625_rk, 2.996378142776264e-17_rk, -9.646088773819133e-18_rk, 7.781119664733062e-17_rk,   &
        -4.8428887934311194e-17_rk, 0.5716666282106516_rk, 9.814546198958581e-17_rk, 9.801615127234308e-18_rk,   &
        -3.567879365440356e-17_rk, 2.380579114727648e-16_rk, 0.08949307280798657_rk, -7.418797671953398e-18_rk,   &
        7.490050759884915e-17_rk, 4.010743901288457e-18_rk, -4.955376446868469e-17_rk, 0.15317761136886726_rk,   &
        -0.3339926946448664_rk, -8.049417931058052e-17_rk, 6.096056528412421e-17_rk, -1.7184939590228508e-16_rk,   &
        -1.1115646271686323e-17_rk, -0.5716666282106515_rk, -3.7000475928779274e-16_rk, -1.869217020736772e-16_rk,   &
        1.2314980916913977e-16_rk, -2.1445094175926175e-16_rk, -0.08949307280798645_rk, -6.883172904269654e-17_rk,   &
        -9.51775675538755e-17_rk, -1.0475015704307492e-16_rk, -6.3767098773364486e-18_rk, -0.15317761136886693_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,2) = reshape((/ &
        0.609392529892002_rk, 3.4649228219362537e-18_rk, 2.631803930026753e-17_rk, 6.402603257182219e-17_rk,   &
        -1.0124801834487003e-16_rk, 0.11058054888356997_rk, 1.0632305213725853e-16_rk, 1.1978171994306364e-17_rk,   &
        5.63312250874476e-17_rk, 8.533463563286523e-17_rk, 0.609392529892002_rk, -1.0375962010488472e-17_rk,   &
        1.5642426335602557e-16_rk, -1.3352825234514123e-17_rk, -1.0658596205858828e-16_rk, 0.11058054888356997_rk,   &
        -0.6093925298920014_rk, 1.2771295961144556e-17_rk, 1.4375363153613799e-18_rk, -3.310328970949065e-16_rk,   &
        -2.4838171053495602e-17_rk, -0.1105805488835699_rk, -8.519401989193715e-17_rk, -2.864022967875075e-17_rk,   &
        -1.3854392258892595e-17_rk, -3.3579655014328296e-16_rk, -0.6093925298920014_rk, 8.007642912768109e-18_rk,   &
        -1.071192455497326e-16_rk, -3.0540022976071536e-17_rk, -3.177794896205287e-19_rk, -0.1105805488835699_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,5,3) = reshape((/ &
        -3.572436769992004_rk, -1.5368895993581347e-16_rk, -2.7808075961304936e-16_rk, -1.2955307816722754e-16_rk,   &
        -1.085844359659891e-16_rk, -0.6482554338950852_rk, -8.888288474533441e-17_rk, -3.343306303772456e-17_rk,   &
        -1.1057958004417384e-17_rk, -1.4715492157221873e-16_rk, -0.9572315475306059_rk, -1.6392998273518534e-17_rk,   &
        -1.8984043602629457e-16_rk, -2.5424088120490402e-17_rk, 1.2901362209786306e-16_rk, -0.17369952000127525_rk,   &
        0.957231547530605_rk, -3.3986249200675393e-18_rk, -4.742278811104301e-17_rk, 4.692457707980776e-16_rk,   &
        8.894445606921079e-17_rk, 0.17369952000127503_rk, 1.0941871553845151e-16_rk, 6.416809406580946e-17_rk,   &
        1.0018796441802039e-16_rk, 2.9946113520198954e-16_rk, 0.2564894201304193_rk, 1.4953185975707406e-17_rk,   &
        7.072751169281297e-17_rk, -1.709206784202439e-17_rk, -3.619273106489881e-17_rk, 0.04654264611001528_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,1) = reshape((/ &
        -1.124227894853039_rk, -5.893321424663876e-17_rk, -4.032225167729253e-17_rk, -1.5119204784789685e-16_rk,   &
        1.0239348052216378e-16_rk, -0.9340887480004111_rk, -1.9723545247856355e-16_rk, -3.0420411406469516e-17_rk,   &
        6.869221779575101e-17_rk, -4.10261175749121e-16_rk, -0.30123595653441293_rk, 1.8518530881729564e-17_rk,   &
        -2.476131666026916e-16_rk, 1.4895460357537342e-17_rk, 1.6582998191834438e-16_rk, -0.25028832568570886_rk,   &
        1.1242278948530386_rk, 8.769626014072303e-17_rk, -1.0598916556098522e-16_rk, 5.287553948455096e-16_rk,   &
        5.320713777477511e-17_rk, 0.9340887480004108_rk, 6.053768455025823e-16_rk, 3.0478008566281886e-16_rk,   &
        -1.16838553672287e-16_rk, 4.716112165431847e-16_rk, 0.30123595653441265_rk, 1.1203766511858033e-16_rk,   &
        1.932389215509016e-16_rk, 1.5445584359948838e-16_rk, -9.822070872153427e-18_rk, 0.2502883256857085_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,2) = reshape((/ &
        0.1632862362581209_rk, 1.668490337498817e-17_rk, 5.2659474149456937e-17_rk, 1.5441334120132594e-16_rk,   &
        -3.974943706297542e-17_rk, 0.41269222676233686_rk, 7.665327097183745e-17_rk, 4.8429831934415566e-17_rk,   &
        -4.4053062712609026e-17_rk, 1.9311398298416113e-16_rk, 0.1632862362581209_rk, 6.721030391998458e-18_rk,   &
        6.584906299295616e-17_rk, 9.409843457349773e-18_rk, -6.540852183508005e-17_rk, 0.41269222676233686_rk,   &
        -0.16328623625812072_rk, -9.610622231897727e-17_rk, 1.4307940407172998e-16_rk, -1.8211802152030339e-16_rk,   &
        -1.8377271141232272e-17_rk, -0.41269222676233674_rk, -2.6390633480479967e-16_rk, -1.755183155191189e-16_rk,   &
        1.0081772027707335e-16_rk, -1.7438112455191515e-16_rk, -0.16328623625812072_rk, -8.836932535058901e-17_rk,   &
        -2.8189557484606165e-16_rk, -1.7538734545324783e-16_rk, -2.392144555598255e-17_rk, -0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,6,3) = reshape((/ &
        -0.9572315475306059_rk, -2.0048565753202916e-16_rk, -2.6710696428670652e-17_rk, -6.733987631616598e-17_rk,   &
        -4.548599192652891e-17_rk, -2.4193222155790655_rk, -1.614990726014505e-16_rk, -1.347409804716289e-16_rk,   &
        4.1977359519551933e-17_rk, -3.412875110511353e-16_rk, -0.2564894201304197_rk, -1.6373202155000972e-17_rk,   &
        -1.4586488574471408e-17_rk, -2.4419758815883177e-16_rk, 1.1167268514024152e-17_rk, -0.6482554338950852_rk,   &
        0.2564894201304196_rk, 3.090118476489072e-16_rk, -1.2335810027133427e-16_rk, 1.814108564526034e-16_rk,   &
        -2.2968468357892587e-17_rk, 0.6482554338950849_rk, 3.688000386529474e-16_rk, 2.5191981181986113e-16_rk,   &
        -2.706075991485922e-16_rk, 3.009430014960806e-16_rk, 0.06872613299107283_rk, 1.3503403919278473e-16_rk,   &
        3.929143221701731e-17_rk, 1.5490546913594146e-16_rk, -2.3690696870582382e-17_rk, 0.17369952000127503_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,1) = reshape((/ &
        -0.30123595653441304_rk, 1.275095799542814e-17_rk, -1.3145544707321607e-16_rk, -3.3027288894489983e-16_rk,   &
        1.6493925862961412e-16_rk, -0.25028832568570875_rk, -1.678645141444453e-16_rk, -1.0687818876143186e-16_rk,   &
        -5.752456844624636e-17_rk, -2.0077431296563653e-16_rk, -1.124227894853039_rk, -1.7208382793884924e-17_rk,   &
        -1.7612979814052547e-16_rk, -1.5047382445266182e-17_rk, 1.7254055996211558e-16_rk, -0.9340887480004111_rk,   &
        0.3012359565344127_rk, 1.2295070547752273e-16_rk, -2.422096899629209e-16_rk, 4.713369134786642e-16_rk,   &
        3.322047069254099e-17_rk, 0.2502883256857086_rk, 1.764982603237035e-16_rk, 1.678277645021355e-16_rk,   &
        -1.0336206903216108e-16_rk, 5.178423544865673e-16_rk, 1.1242278948530384_rk, 8.797056320524346e-17_rk,   &
        6.691984564720552e-16_rk, 3.21049244311282e-16_rk, 6.816843334827672e-17_rk, 0.9340887480004108_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,2) = reshape((/ &
        -0.1632862362581209_rk, -1.668490337498817e-17_rk, -5.2659474149456937e-17_rk, -1.5441334120132594e-16_rk,   &
        3.974943706297542e-17_rk, -0.41269222676233686_rk, -7.665327097183745e-17_rk, -4.8429831934415566e-17_rk,   &
        4.4053062712609026e-17_rk, -1.9311398298416113e-16_rk, -0.1632862362581209_rk, -6.721030391998458e-18_rk,   &
        -6.584906299295616e-17_rk, -9.409843457349773e-18_rk, 6.540852183508005e-17_rk, -0.41269222676233686_rk,   &
        0.16328623625812072_rk, 9.610622231897727e-17_rk, -1.4307940407172998e-16_rk, 1.8211802152030339e-16_rk,   &
        1.8377271141232272e-17_rk, 0.41269222676233674_rk, 2.6390633480479967e-16_rk, 1.755183155191189e-16_rk,   &
        -1.0081772027707335e-16_rk, 1.7438112455191515e-16_rk, 0.16328623625812072_rk, 8.836932535058901e-17_rk,   &
        2.8189557484606165e-16_rk, 1.7538734545324783e-16_rk, 2.392144555598255e-17_rk, 0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,7,3) = reshape((/ &
        -0.25648942013041975_rk, -5.1523083754321746e-17_rk, -1.4580656519380047e-16_rk, -2.186397113317475e-16_rk,   &
        1.8394830652134714e-17_rk, -0.6482554338950852_rk, 1.7215108445217604e-17_rk, -3.2230004139447507e-16_rk,   &
        1.050366668592597e-17_rk, -1.4735506572571788e-16_rk, -0.9572315475306059_rk, -1.8032813595906924e-16_rk,   &
        -1.554507497902171e-16_rk, -1.5040991074871336e-16_rk, -1.808537598902878e-17_rk, -2.4193222155790655_rk,   &
        0.0687261329910728_rk, 1.4637975156438789e-16_rk, -2.400530555509495e-16_rk, 3.012597393923613e-16_rk,   &
        1.1625645940059593e-18_rk, 0.17369952000127503_rk, 3.9149357166267535e-17_rk, 1.7440129305820581e-16_rk,   &
        -1.043459109776669e-16_rk, 1.7006514408100035e-16_rk, 0.2564894201304197_rk, 3.086951097526264e-16_rk,   &
        3.901155821369045e-16_rk, 2.602417436213281e-16_rk, -3.631348665520886e-17_rk, 0.6482554338950849_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,1) = reshape((/ &
        0.08949307280798668_rk, -9.018148767103525e-19_rk, 1.0508631022239274e-16_rk, 1.9887114503778588e-16_rk,   &
        -4.3280020285102824e-17_rk, 0.15317761136886715_rk, 5.721739879602352e-17_rk, 7.501824384807233e-17_rk,   &
        -2.5229489760981245e-17_rk, 1.0924093130727407e-16_rk, 0.3339926946448665_rk, 1.6280807818285314e-17_rk,   &
        7.429317274065726e-17_rk, 8.680342858547136e-18_rk, -8.685071223391888e-17_rk, 0.5716666282106517_rk,   &
        -0.08949307280798646_rk, -7.89953594926973e-17_rk, 1.8142378752432769e-16_rk, -2.1622406464166533e-16_rk,   &
        -2.597425494235442e-17_rk, -0.15317761136886696_rk, -9.701434268391965e-17_rk, -1.1691101249502458e-16_rk,   &
        4.404808380612041e-17_rk, -1.6168576545228437e-16_rk, -0.3339926946448663_rk, -7.87210564281769e-17_rk,   &
        -4.0757108659905797e-16_rk, -1.9932011094783736e-16_rk, -3.416624374293384e-17_rk, -0.5716666282106515_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,2) = reshape((/ &
        -0.609392529892002_rk, -3.4649228219362537e-18_rk, -2.631803930026753e-17_rk, -6.402603257182219e-17_rk,   &
        1.0124801834487003e-16_rk, -0.11058054888356997_rk, -1.0632305213725853e-16_rk, -1.1978171994306364e-17_rk,   &
        -5.63312250874476e-17_rk, -8.533463563286523e-17_rk, -0.609392529892002_rk, 1.0375962010488472e-17_rk,   &
        -1.5642426335602557e-16_rk, 1.3352825234514123e-17_rk, 1.0658596205858828e-16_rk, -0.11058054888356997_rk,   &
        0.6093925298920014_rk, -1.2771295961144556e-17_rk, -1.4375363153613799e-18_rk, 3.310328970949065e-16_rk,   &
        2.4838171053495602e-17_rk, 0.1105805488835699_rk, 8.519401989193715e-17_rk, 2.864022967875075e-17_rk,   &
        1.3854392258892595e-17_rk, 3.3579655014328296e-16_rk, 0.6093925298920014_rk, -8.007642912768109e-18_rk,   &
        1.071192455497326e-16_rk, 3.0540022976071536e-17_rk, 3.177794896205287e-19_rk, 0.1105805488835699_rk   &
        /),(/4,8/))
        test_dbr2_vol_face5_dx(:,:,8,3) = reshape((/ &
        -0.9572315475306059_rk, -1.0720142087716923e-17_rk, -2.675729310795948e-17_rk, -8.14986163964661e-17_rk,   &
        1.2047819688479096e-16_rk, -0.17369952000127525_rk, -1.0666431451434622e-16_rk, -6.327466757781445e-17_rk,   &
        -2.9167886355900583e-16_rk, -1.2909350354923596e-16_rk, -3.572436769992004_rk, -1.1512998410394556e-16_rk,   &
        -1.018192910405954e-16_rk, -1.9845186964227615e-17_rk, -4.183299945591906e-17_rk, -0.6482554338950852_rk,   &
        0.25648942013041937_rk, 1.3122096035113756e-17_rk, 5.918564026887742e-17_rk, 2.8880686568113793e-16_rk,   &
        -1.4457205199985443e-17_rk, 0.04654264611001528_rk, -8.208282697970144e-19_rk, -1.2759662525965653e-17_rk,   &
        -6.999827873786936e-17_rk, 4.710768607386714e-16_rk, 0.9572315475306048_rk, 7.255644600784016e-18_rk,   &
        1.1795129815679835e-16_rk, 5.956138568523032e-17_rk, -3.187793889903391e-17_rk, 0.17369952000127503_rk   &
        /),(/4,8/))
        
        
        


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face6_dx
        ! 
        test_dbr2_vol_face6_dx(:,:,1,1) = reshape((/ &
        -0.3339926946448663_rk, -6.345335287541346e-17_rk, 5.43338911437939e-17_rk, -1.8950740423262303e-16_rk,   &
        -9.018019379787046e-18_rk, -0.5716666282106514_rk, -1.2698332642109292e-16_rk, -2.276464523690491e-17_rk,   &
        5.604488512047906e-17_rk, -2.1282946217366577e-16_rk, -0.08949307280798646_rk, -5.087500414450923e-18_rk,   &
        -3.725915766104234e-17_rk, -1.2017727000586088e-16_rk, -6.513356119016045e-17_rk, -0.1531776113688669_rk,   &
        0.33399269464486697_rk, 1.6162675793221212e-16_rk, 1.1578204881492474e-16_rk, 1.1018365767382273e-16_rk,   &
        2.0839396177653573e-17_rk, 0.5716666282106517_rk, 1.192086814958636e-16_rk, 5.894420379005945e-17_rk,   &
        1.647620519965663e-17_rk, 2.771665338955557e-16_rk, 0.08949307280798652_rk, 7.206720089159468e-17_rk,   &
        9.466002587769383e-17_rk, 5.054308751452222e-17_rk, 6.471545564384929e-17_rk, 0.15317761136886698_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,1,2) = reshape((/ &
        -0.6093925298920014_rk, -5.247363451529513e-17_rk, -1.2325609821347967e-16_rk, -2.4830909941422113e-16_rk,   &
        -1.4467395551631053e-17_rk, -0.11058054888356998_rk, -5.779577625574471e-17_rk, 4.290603117959553e-18_rk,   &
        -8.468232229770774e-17_rk, -2.7033514587573175e-16_rk, -0.6093925298920015_rk, -5.0834456592503336e-17_rk,   &
        -7.053487085532963e-17_rk, -1.0586344466972543e-17_rk, -3.846752615603585e-17_rk, -0.1105805488835699_rk,   &
        0.6093925298920018_rk, 6.424129412594904e-17_rk, 7.79085219934667e-17_rk, 1.3122598088149886e-16_rk,   &
        4.782285501272027e-17_rk, 0.11058054888356994_rk, 8.681788073625417e-17_rk, 3.716583900418828e-17_rk,   &
        8.226889182698222e-17_rk, 9.474242699081112e-17_rk, 0.6093925298920018_rk, 6.742606777584524e-17_rk,   &
        8.681788073625417e-17_rk, 3.097091845889055e-17_rk, 4.7822855012720244e-17_rk, 0.11058054888356994_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,1,3) = reshape((/ &
        -0.9572315475306051_rk, -6.904158083771423e-17_rk, -7.004223691155184e-17_rk, -3.889251118265866e-16_rk,   &
        3.1890349739817167e-17_rk, -0.17369952000127512_rk, -6.803211818877973e-17_rk, 6.724828100131252e-17_rk,   &
        -1.7004312764325788e-16_rk, -2.7132626074649685e-16_rk, -0.25648942013041953_rk, 3.22542045463279e-17_rk,   &
        -1.77081813962211e-16_rk, -2.4159254810032744e-18_rk, -2.9051079052191093e-17_rk, -0.04654264611001528_rk,   &
        3.5724367699920023_rk, 3.391070954194795e-16_rk, 3.133352049498491e-16_rk, 3.7623610599051533e-16_rk,   &
        3.4465365022098097e-16_rk, 0.6482554338950851_rk, 5.997388074389308e-17_rk, 2.2172601165122645e-17_rk,   &
        3.75991789566071e-16_rk, 1.6888410262127992e-16_rk, 0.9572315475306057_rk, 1.218917015100145e-16_rk,   &
        1.360546681315015e-16_rk, 9.229922486015528e-17_rk, 5.379409158985e-17_rk, 0.1736995200012751_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,1) = reshape((/ &
        1.1242278948530382_rk, 1.621747044348514e-16_rk, -2.421902400106568e-17_rk, 5.178058836351785e-16_rk,   &
        3.126228034578508e-17_rk, 0.9340887480004105_rk, 2.1577745844629922e-16_rk, 1.3374865541931802e-17_rk,   &
        2.147183150833305e-17_rk, 4.125676513250571e-16_rk, 0.3012359565344128_rk, -8.178836305122917e-19_rk,   &
        1.0360018003621386e-16_rk, 1.8879408433958967e-16_rk, 1.1913490342032285e-16_rk, 0.25028832568570847_rk,   &
        -1.1242278948530393_rk, -3.000990142820995e-16_rk, -2.2331226493643473e-16_rk, -2.6530962466362304e-16_rk,   &
        -8.288476287907623e-17_rk, -0.9340887480004108_rk, -2.0146253238618237e-16_rk, -9.936675531274289e-17_rk,   &
        -6.862551886426624e-17_rk, -4.575276758357879e-16_rk, -0.30123595653441315_rk, -1.3306080950778298e-16_rk,   &
        -2.2095551371372144e-16_rk, -1.017733539877081e-16_rk, -1.0372499542949298e-16_rk, -0.2502883256857086_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,2) = reshape((/ &
        -0.16328623625812055_rk, -1.5602049524637094e-17_rk, 1.2335326489930116e-17_rk, -1.4747709681184492e-16_rk,   &
        -1.9728463868933972e-17_rk, -0.4126922267623367_rk, -7.557390649833182e-17_rk, -6.490936187773087e-17_rk,   &
        1.278747888747234e-16_rk, -1.866210591941508e-16_rk, -0.16328623625812058_rk, -1.9056001914303177e-17_rk,   &
        -9.149777474781297e-17_rk, -1.1712864983693714e-16_rk, -4.606001059566938e-17_rk, -0.41269222676233663_rk,   &
        0.16328623625812078_rk, 1.2043847970188975e-16_rk, 7.525244274111321e-17_rk, 2.3488145088269563e-16_rk,   &
        4.374365169747673e-17_rk, 0.41269222676233674_rk, 1.1402527571347362e-16_rk, 6.064908550573979e-17_rk,   &
        7.858482829256843e-17_rk, 1.9718177852898495e-16_rk, 0.16328623625812078_rk, 1.4813375679320705e-16_rk,   &
        1.140252757134736e-16_rk, 6.081020483376665e-17_rk, 4.374365169747672e-17_rk, 0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,2,3) = reshape((/ &
        -0.2564894201304194_rk, 8.345066601648874e-17_rk, 1.4496916423569172e-16_rk, -2.0851879450442822e-16_rk,   &
        3.82969815635713e-17_rk, -0.6482554338950847_rk, -1.5986129911846392e-16_rk, -2.918601026522653e-17_rk,   &
        1.7590617890102015e-16_rk, -5.24632460488988e-16_rk, -0.06872613299107291_rk, 6.875590739429269e-17_rk,   &
        -8.995926042301641e-17_rk, -1.6621599255805802e-16_rk, -8.117539428887255e-17_rk, -0.17369952000127498_rk,   &
        0.9572315475306061_rk, 5.631815892838769e-16_rk, 1.9842509642426189e-16_rk, 1.9215207656074e-16_rk,   &
        2.0209562734326344e-16_rk, 2.419322215579065_rk, 2.84916459183778e-16_rk, 1.5985387648982847e-16_rk,   &
        4.5741818125335066e-17_rk, 4.587831176465494e-16_rk, 0.25648942013041975_rk, 1.93774596608218e-16_rk,   &
        1.5444977757455733e-16_rk, 2.4010197459402253e-16_rk, 9.651174830956827e-17_rk, 0.648255433895085_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,1) = reshape((/ &
        0.3012359565344128_rk, -3.5704832544213816e-17_rk, 2.029126746010125e-16_rk, 2.586350345912007e-16_rk,   &
        4.088715170372402e-17_rk, 0.25028832568570847_rk, 6.462406441811481e-17_rk, 1.3622763088874884e-16_rk,   &
        -1.8724440395032963e-16_rk, 4.957287981924179e-16_rk, 1.1242278948530382_rk, 1.3286173315892315e-16_rk,   &
        2.3683291183936214e-16_rk, 1.1216829508862677e-16_rk, 5.724686520515852e-17_rk, 0.9340887480004105_rk,   &
        -0.30123595653441326_rk, -9.962608373267577e-17_rk, -9.033566546577102e-17_rk, -5.242925636485234e-16_rk,   &
        -1.0372499542949293e-16_rk, -0.25028832568570847_rk, -2.2095551371372144e-16_rk, -1.100691448548054e-16_rk,   &
        -2.6045160542448963e-16_rk, -1.7925255930324934e-16_rk, -1.1242278948530389_rk, -3.3898041319969883e-16_rk,   &
        -2.0146253238618242e-16_rk, -9.757241501445898e-17_rk, -8.288476287907621e-17_rk, -0.9340887480004108_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,2) = reshape((/ &
        0.16328623625812055_rk, 1.5602049524637094e-17_rk, -1.2335326489930116e-17_rk, 1.4747709681184492e-16_rk,   &
        1.9728463868933972e-17_rk, 0.4126922267623367_rk, 7.557390649833182e-17_rk, 6.490936187773087e-17_rk,   &
        -1.278747888747234e-16_rk, 1.866210591941508e-16_rk, 0.16328623625812058_rk, 1.9056001914303177e-17_rk,   &
        9.149777474781297e-17_rk, 1.1712864983693714e-16_rk, 4.606001059566938e-17_rk, 0.41269222676233663_rk,   &
        -0.16328623625812078_rk, -1.2043847970188975e-16_rk, -7.525244274111321e-17_rk, -2.3488145088269563e-16_rk,   &
        -4.374365169747673e-17_rk, -0.41269222676233674_rk, -1.1402527571347362e-16_rk, -6.064908550573979e-17_rk,   &
        -7.858482829256843e-17_rk, -1.9718177852898495e-16_rk, -0.16328623625812078_rk, -1.4813375679320705e-16_rk,   &
        -1.140252757134736e-16_rk, -6.081020483376665e-17_rk, -4.374365169747672e-17_rk, -0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,3,3) = reshape((/ &
        -0.06872613299107289_rk, 7.870888702741359e-17_rk, -1.611751535165544e-17_rk, -4.0054456968086806e-16_rk,   &
        -6.582056340246256e-18_rk, -0.173699520001275_rk, -5.034190289914092e-17_rk, -5.639358853604069e-17_rk,   &
        2.9381164204949064e-16_rk, -2.3551287936363723e-16_rk, -0.25648942013041953_rk, 1.269584673886253e-16_rk,   &
        -1.6219647943257373e-16_rk, -9.848119698252207e-17_rk, 5.312540951318819e-18_rk, -0.6482554338950846_rk,   &
        0.25648942013042_rk, 1.482235311366859e-16_rk, 8.39897412503727e-17_rk, 5.206245591824249e-16_rk,   &
        9.651174830956828e-17_rk, 0.648255433895085_rk, 1.5444977757455728e-16_rk, 2.473026341268024e-16_rk,   &
        1.8503195810573465e-16_rk, 1.454189291676054e-16_rk, 0.9572315475306059_rk, 6.12970343370968e-16_rk,   &
        2.8491645918377805e-16_rk, 1.4178261142986663e-16_rk, 2.0209562734326344e-16_rk, 2.419322215579065_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,1) = reshape((/ &
        -0.08949307280798653_rk, 2.437967796208925e-17_rk, -6.325331076647369e-17_rk, -1.1997542576407797e-16_rk,   &
        -2.7851383980394805e-17_rk, -0.15317761136886687_rk, -1.4826503755926767e-17_rk, -8.600090043502689e-17_rk,   &
        1.398071240747391e-16_rk, -1.6819318000146942e-16_rk, -0.33399269464486625_rk, -3.943284764136538e-17_rk,   &
        -1.3456645702155836e-16_rk, -8.051900099214705e-17_rk, -2.2078887575603877e-17_rk, -0.5716666282106513_rk,   &
        0.08949307280798707_rk, 5.763481737317575e-17_rk, 3.0344450362605095e-17_rk, 3.1886030089545023e-16_rk,   &
        6.471545564384929e-17_rk, 0.15317761136886687_rk, 9.466002587769383e-17_rk, 5.263294829320669e-17_rk,   &
        1.3634117794768623e-16_rk, 7.92869969164905e-17_rk, 0.33399269464486664_rk, 1.9481408324812966e-16_rk,   &
        1.192086814958636e-16_rk, 5.980954781538102e-17_rk, 2.083939617765355e-17_rk, 0.5716666282106517_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,2) = reshape((/ &
        0.6093925298920014_rk, 5.247363451529513e-17_rk, 1.2325609821347967e-16_rk, 2.4830909941422113e-16_rk,   &
        1.4467395551631053e-17_rk, 0.11058054888356998_rk, 5.779577625574471e-17_rk, -4.290603117959553e-18_rk,   &
        8.468232229770774e-17_rk, 2.7033514587573175e-16_rk, 0.6093925298920015_rk, 5.0834456592503336e-17_rk,   &
        7.053487085532963e-17_rk, 1.0586344466972543e-17_rk, 3.846752615603585e-17_rk, 0.1105805488835699_rk,   &
        -0.6093925298920018_rk, -6.424129412594904e-17_rk, -7.79085219934667e-17_rk, -1.3122598088149886e-16_rk,   &
        -4.782285501272027e-17_rk, -0.11058054888356994_rk, -8.681788073625417e-17_rk, -3.716583900418828e-17_rk,   &
        -8.226889182698222e-17_rk, -9.474242699081112e-17_rk, -0.6093925298920018_rk, -6.742606777584524e-17_rk,   &
        -8.681788073625417e-17_rk, -3.097091845889055e-17_rk, -4.7822855012720244e-17_rk, -0.11058054888356994_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,4,3) = reshape((/ &
        -0.2564894201304194_rk, 3.791152850569988e-17_rk, -1.1839998527592877e-16_rk, -2.2079662453463988e-16_rk,   &
        2.6143994269395955e-17_rk, -0.04654264611001535_rk, -1.617494176999249e-16_rk, 3.169963443691542e-17_rk,   &
        7.575643278171729e-18_rk, -4.051143243300185e-16_rk, -0.9572315475306052_rk, -5.4197742722514714e-17_rk,   &
        -8.626175219688194e-17_rk, 4.6792396353226663e-17_rk, 1.3618280899954578e-17_rk, -0.17369952000127498_rk,   &
        0.9572315475306057_rk, 8.642508201441293e-17_rk, 3.893849278845982e-16_rk, 2.1400818126960185e-16_rk,   &
        5.3794091589850015e-17_rk, 0.1736995200012751_rk, 1.3605466813150146e-16_rk, 1.0617523613631855e-16_rk,   &
        2.980105748007778e-16_rk, 3.1268519381987674e-16_rk, 3.5724367699920023_rk, 3.329068505205173e-16_rk,   &
        5.997388074389313e-17_rk, 3.2359920798391882e-18_rk, 3.4465365022098097e-16_rk, 0.6482554338950851_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,1) = reshape((/ &
        -0.08949307280798645_rk, 1.4270151922582988e-16_rk, 9.101101850825078e-17_rk, -9.48859301300822e-17_rk,   &
        5.5167130254374174e-17_rk, -0.15317761136886665_rk, -5.564147542783433e-17_rk, 1.6794466437859516e-18_rk,   &
        1.0723205713550302e-16_rk, -3.939018430831671e-16_rk, -0.02397959658707967_rk, 8.409450907697044e-17_rk,   &
        -8.686340186562325e-17_rk, -5.91962489768175e-17_rk, -2.675549097511632e-17_rk, -0.04104381726481619_rk,   &
        1.246477705771479_rk, 4.970468144380366e-16_rk, 1.461119327111802e-16_rk, 1.5463182569782269e-16_rk,   &
        2.498256871490888e-16_rk, 2.1334889014737395_rk, 1.9685117927803476e-16_rk, 1.166172941474671e-16_rk,   &
        9.062910502240733e-17_rk, 2.4288976243477134e-16_rk, 0.3339926946448662_rk, 1.5536570338033464e-16_rk,   &
        9.260199122282965e-17_rk, 2.2222815048829514e-16_rk, 4.749628739566269e-17_rk, 0.5716666282106515_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,2) = reshape((/ &
        -0.1632862362581205_rk, 3.265562768589727e-17_rk, 3.2900536200446073e-18_rk, -1.3985181359562938e-16_rk,   &
        5.141320642427822e-17_rk, -0.029629968771942863_rk, -8.848769281599566e-17_rk, 5.87015962845718e-17_rk,   &
        -1.8747690615926962e-17_rk, -1.6030030541587283e-16_rk, -0.16328623625812053_rk, 3.686476631383993e-17_rk,   &
        -9.711485028733924e-17_rk, 3.883728325212402e-17_rk, 2.8642701709364215e-17_rk, -0.029629968771942808_rk,   &
        2.2742838833098866_rk, 2.0666090380709682e-16_rk, 3.6945700900971573e-16_rk, 2.4453520291530223e-16_rk,   &
        2.0583685567926775e-16_rk, 0.41269222676233674_rk, 3.7977769426346825e-17_rk, 4.454293196252655e-17_rk,   &
        3.468143399514527e-16_rk, 2.1183410888877432e-16_rk, 2.2742838833098866_rk, 2.2210768289093757e-16_rk,   &
        3.7977769426346837e-17_rk, 2.984868960253621e-17_rk, 2.0583685567926777e-16_rk, 0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,5,3) = reshape((/ &
        0.9572315475306051_rk, 6.904158083771423e-17_rk, 7.004223691155184e-17_rk, 3.889251118265866e-16_rk,   &
        -3.1890349739817167e-17_rk, 0.17369952000127512_rk, 6.803211818877973e-17_rk, -6.724828100131252e-17_rk,   &
        1.7004312764325788e-16_rk, 2.7132626074649685e-16_rk, 0.25648942013041953_rk, -3.22542045463279e-17_rk,   &
        1.77081813962211e-16_rk, 2.4159254810032744e-18_rk, 2.9051079052191093e-17_rk, 0.04654264611001528_rk,   &
        -3.5724367699920023_rk, -3.391070954194795e-16_rk, -3.133352049498491e-16_rk, -3.7623610599051533e-16_rk,   &
        -3.4465365022098097e-16_rk, -0.6482554338950851_rk, -5.997388074389308e-17_rk, -2.2172601165122645e-17_rk,   &
        -3.75991789566071e-16_rk, -1.6888410262127992e-16_rk, -0.9572315475306057_rk, -1.218917015100145e-16_rk,   &
        -1.360546681315015e-16_rk, -9.229922486015528e-17_rk, -5.379409158985e-17_rk, -0.1736995200012751_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,1) = reshape((/ &
        0.3012359565344125_rk, -2.162078727888341e-16_rk, -1.2338035814909657e-16_rk, 2.2183468987718894e-16_rk,   &
        -1.2452416708646712e-16_rk, 0.25028832568570814_rk, 1.034283597854081e-16_rk, -4.089453698145831e-17_rk,   &
        -1.0897335389408639e-16_rk, 6.867567225388442e-16_rk, 0.08071593128461267_rk, -1.3969573264136808e-16_rk,   &
        2.2550217411234636e-16_rk, 6.952459319081084e-17_rk, 3.703609600337918e-17_rk, 0.06706455474242341_rk,   &
        -4.195675622877742_rk, -9.315264566063811e-16_rk, -4.1939502720072854e-16_rk, -4.3548629957345505e-16_rk,   &
        -5.991970563485394e-16_rk, -3.4860666663159345_rk, -3.014577379284379e-16_rk, -1.7044047131097156e-16_rk,   &
        -4.0666074393817168e-16_rk, -4.30167692597205e-16_rk, -1.1242278948530386_rk, -2.963219407464143e-16_rk,   &
        -1.6317994054259907e-16_rk, -3.6701346446787845e-16_rk, -1.0268671598968131e-16_rk, -0.934088748000411_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,2) = reshape((/ &
        -0.043752415140480935_rk, 1.1883602727067493e-16_rk, 6.96941808918126e-17_rk, -2.4026468345323174e-16_rk,   &
        3.9918812345262014e-17_rk, -0.11058054888356976_rk, -5.824560812105247e-17_rk, 1.0427697169559188e-17_rk,   &
        1.7115686337578722e-16_rk, -2.973024940291052e-16_rk, -0.04375241514048098_rk, 1.4365164263766792e-16_rk,   &
        -6.902955496023196e-17_rk, -5.1382814714725495e-17_rk, -2.2357818272392957e-18_rk, -0.11058054888356973_rk,   &
        0.6093925298920019_rk, 3.324560861213808e-16_rk, 1.0453842693254014e-16_rk, 2.1888624871304853e-16_rk,   &
        1.4635570781790982e-16_rk, 1.5401883581657771_rk, 1.6568395791761871e-16_rk, 1.985547996009984e-16_rk,   &
        6.833032060006237e-17_rk, 1.8746519097786906e-16_rk, 0.6093925298920019_rk, 3.654560232550404e-16_rk,   &
        1.656839579176187e-16_rk, 1.8230507339144977e-16_rk, 1.4635570781790984e-16_rk, 1.5401883581657771_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,6,3) = reshape((/ &
        0.2564894201304194_rk, -8.345066601648874e-17_rk, -1.4496916423569172e-16_rk, 2.0851879450442822e-16_rk,   &
        -3.82969815635713e-17_rk, 0.6482554338950847_rk, 1.5986129911846392e-16_rk, 2.918601026522653e-17_rk,   &
        -1.7590617890102015e-16_rk, 5.24632460488988e-16_rk, 0.06872613299107291_rk, -6.875590739429269e-17_rk,   &
        8.995926042301641e-17_rk, 1.6621599255805802e-16_rk, 8.117539428887255e-17_rk, 0.17369952000127498_rk,   &
        -0.9572315475306061_rk, -5.631815892838769e-16_rk, -1.9842509642426189e-16_rk, -1.9215207656074e-16_rk,   &
        -2.0209562734326344e-16_rk, -2.419322215579065_rk, -2.84916459183778e-16_rk, -1.5985387648982847e-16_rk,   &
        -4.5741818125335066e-17_rk, -4.587831176465494e-16_rk, -0.25648942013041975_rk, -1.93774596608218e-16_rk,   &
        -1.5444977757455733e-16_rk, -2.4010197459402253e-16_rk, -9.651174830956827e-17_rk, -0.648255433895085_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,1) = reshape((/ &
        0.08071593128461266_rk, -1.2621356281179159e-16_rk, -5.0608820685927013e-17_rk, 5.953683605705163e-16_rk,   &
        -5.891598193192544e-17_rk, 0.0670645547424234_rk, 1.8701669756509814e-16_rk, -8.360633176536437e-17_rk,   &
        -2.72931891963841e-16_rk, 3.0287567318396725e-16_rk, 0.3012359565344126_rk, -2.698156523633308e-16_rk,   &
        1.0559740503816273e-16_rk, -1.1050572726683081e-17_rk, -8.008584609944624e-17_rk, 0.25028832568570825_rk,   &
        -1.1242278948530389_rk, -2.2148328326236253e-16_rk, -4.582169357182159e-16_rk, -5.071386456917016e-16_rk,   &
        -1.0268671598968124e-16_rk, -0.9340887480004112_rk, -1.6317994054259912e-16_rk, -3.847390081024645e-16_rk,   &
        -3.4514741067747815e-16_rk, -3.8120677122216467e-16_rk, -4.195675622877742_rk, -9.625659540854244e-16_rk,   &
        -3.014577379284379e-16_rk, -1.2403959404054735e-16_rk, -5.991970563485394e-16_rk, -3.4860666663159345_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,2) = reshape((/ &
        0.043752415140480935_rk, -1.1883602727067493e-16_rk, -6.96941808918126e-17_rk, 2.4026468345323174e-16_rk,   &
        -3.9918812345262014e-17_rk, 0.11058054888356976_rk, 5.824560812105247e-17_rk, -1.0427697169559188e-17_rk,   &
        -1.7115686337578722e-16_rk, 2.973024940291052e-16_rk, 0.04375241514048098_rk, -1.4365164263766792e-16_rk,   &
        6.902955496023196e-17_rk, 5.1382814714725495e-17_rk, 2.2357818272392957e-18_rk, 0.11058054888356973_rk,   &
        -0.6093925298920019_rk, -3.324560861213808e-16_rk, -1.0453842693254014e-16_rk, -2.1888624871304853e-16_rk,   &
        -1.4635570781790982e-16_rk, -1.5401883581657771_rk, -1.6568395791761871e-16_rk, -1.985547996009984e-16_rk,   &
        -6.833032060006237e-17_rk, -1.8746519097786906e-16_rk, -0.6093925298920019_rk, -3.654560232550404e-16_rk,   &
        -1.656839579176187e-16_rk, -1.8230507339144977e-16_rk, -1.4635570781790984e-16_rk, -1.5401883581657771_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,7,3) = reshape((/ &
        0.06872613299107289_rk, -7.870888702741359e-17_rk, 1.611751535165544e-17_rk, 4.0054456968086806e-16_rk,   &
        6.582056340246256e-18_rk, 0.173699520001275_rk, 5.034190289914092e-17_rk, 5.639358853604069e-17_rk,   &
        -2.9381164204949064e-16_rk, 2.3551287936363723e-16_rk, 0.25648942013041953_rk, -1.269584673886253e-16_rk,   &
        1.6219647943257373e-16_rk, 9.848119698252207e-17_rk, -5.312540951318819e-18_rk, 0.6482554338950846_rk,   &
        -0.25648942013042_rk, -1.482235311366859e-16_rk, -8.39897412503727e-17_rk, -5.206245591824249e-16_rk,   &
        -9.651174830956828e-17_rk, -0.648255433895085_rk, -1.5444977757455728e-16_rk, -2.473026341268024e-16_rk,   &
        -1.8503195810573465e-16_rk, -1.454189291676054e-16_rk, -0.9572315475306059_rk, -6.12970343370968e-16_rk,   &
        -2.8491645918377805e-16_rk, -1.4178261142986663e-16_rk, -2.0209562734326344e-16_rk, -2.419322215579065_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,1) = reshape((/ &
        -0.02397959658707975_rk, 6.621628168369462e-17_rk, 2.7680604191471113e-17_rk, -3.4534897612833997e-16_rk,   &
        2.4785168578498206e-17_rk, -0.04104381726481618_rk, -6.427237901236732e-17_rk, 3.0146210386508507e-17_rk,   &
        1.777708970982773e-16_rk, -1.4776135536398904e-16_rk, -0.08949307280798646_rk, 1.678192367179596e-16_rk,   &
        -5.337771347457987e-17_rk, -1.8338842473149524e-17_rk, 2.989520566163253e-17_rk, -0.15317761136886673_rk,   &
        0.3339926946448663_rk, 1.152866903147033e-16_rk, 1.2001141373542675e-16_rk, 2.7473663688094606e-16_rk,   &
        4.749628739566269e-17_rk, 0.5716666282106517_rk, 9.260199122282965e-17_rk, 2.300276170950911e-16_rk,   &
        1.0877178844322456e-16_rk, 1.2542341815937333e-16_rk, 1.2464777057714789_rk, 5.165242635391463e-16_rk,   &
        1.9685117927803476e-16_rk, 9.337726327521986e-17_rk, 2.498256871490888e-16_rk, 2.1334889014737395_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,2) = reshape((/ &
        0.1632862362581205_rk, -3.265562768589727e-17_rk, -3.2900536200446073e-18_rk, 1.3985181359562938e-16_rk,   &
        -5.141320642427822e-17_rk, 0.029629968771942863_rk, 8.848769281599566e-17_rk, -5.87015962845718e-17_rk,   &
        1.8747690615926962e-17_rk, 1.6030030541587283e-16_rk, 0.16328623625812053_rk, -3.686476631383993e-17_rk,   &
        9.711485028733924e-17_rk, -3.883728325212402e-17_rk, -2.8642701709364215e-17_rk, 0.029629968771942808_rk,   &
        -2.2742838833098866_rk, -2.0666090380709682e-16_rk, -3.6945700900971573e-16_rk, -2.4453520291530223e-16_rk,   &
        -2.0583685567926775e-16_rk, -0.41269222676233674_rk, -3.7977769426346825e-17_rk, -4.454293196252655e-17_rk,   &
        -3.468143399514527e-16_rk, -2.1183410888877432e-16_rk, -2.2742838833098866_rk, -2.2210768289093757e-16_rk,   &
        -3.7977769426346837e-17_rk, -2.984868960253621e-17_rk, -2.0583685567926777e-16_rk, -0.41269222676233674_rk   &
        /),(/4,8/))
        test_dbr2_vol_face6_dx(:,:,8,3) = reshape((/ &
        0.2564894201304194_rk, -3.791152850569988e-17_rk, 1.1839998527592877e-16_rk, 2.2079662453463988e-16_rk,   &
        -2.6143994269395955e-17_rk, 0.04654264611001535_rk, 1.617494176999249e-16_rk, -3.169963443691542e-17_rk,   &
        -7.575643278171729e-18_rk, 4.051143243300185e-16_rk, 0.9572315475306052_rk, 5.4197742722514714e-17_rk,   &
        8.626175219688194e-17_rk, -4.6792396353226663e-17_rk, -1.3618280899954578e-17_rk, 0.17369952000127498_rk,   &
        -0.9572315475306057_rk, -8.642508201441293e-17_rk, -3.893849278845982e-16_rk, -2.1400818126960185e-16_rk,   &
        -5.3794091589850015e-17_rk, -0.1736995200012751_rk, -1.3605466813150146e-16_rk, -1.0617523613631855e-16_rk,   &
        -2.980105748007778e-16_rk, -3.1268519381987674e-16_rk, -3.5724367699920023_rk, -3.329068505205173e-16_rk,   &
        -5.997388074389313e-17_rk, -3.2359920798391882e-18_rk, -3.4465365022098097e-16_rk, -0.6482554338950851_rk   &
        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do


    end subroutine testElement_dbr2_vol_dx
    !*******************************************************************************************





    !> Test cartesian dbr2_face_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_face_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       

        !
        ! dbr2_face_face1_dx
        ! 
        test_dbr2_face_face1_dx(:,:,1,1) = reshape((/ &
        1.911964719755678_rk, 1.5327431925972813e-16_rk, 1.6722042964394362e-16_rk, 3.4933733276454935e-16_rk,   &
        1.3346460003590822e-16_rk, 0.5123094026153316_rk, 1.5611643254207945e-16_rk, -7.840024603910938e-18_rk,   &
        1.8886408140308243e-17_rk, 9.654159555418383e-17_rk, 0.5123094026153319_rk, -1.303419409177437e-16_rk,   &
        2.299243726104154e-16_rk, -1.1992030130061325e-16_rk, -2.1460827024551993e-16_rk, 0.1372728907056489_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,1,2) = reshape((/ &
        3.147204850074643_rk, 5.662980324313677e-16_rk, 2.370145372906285e-16_rk, 3.7871259937250106e-16_rk,   &
        5.300125008440967e-16_rk, 3.147204850074643_rk, 4.3773124780450266e-16_rk, 1.7910443280470074e-16_rk,   &
        4.2342728353463927e-17_rk, 3.0697946412682106e-16_rk, 0.8432909979928132_rk, -3.3571335837178324e-17_rk,   &
        3.06979464126821e-16_rk, 4.234272835346393e-17_rk, -5.126897137933625e-17_rk, 0.8432909979928132_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,1,3) = reshape((/ &
        4.943617818168333_rk, 4.99559296103284e-16_rk, 7.188566826336593e-16_rk, 5.84715689093389e-16_rk,   &
        5.135605309509642e-16_rk, 1.3246384020663142_rk, 8.123781018833931e-16_rk, 1.4878404789185698e-17_rk,   &
        2.6375293983210936e-16_rk, 6.394109359335478e-16_rk, 4.943617818168333_rk, 2.505449710224938e-16_rk,   &
        5.3114892305329e-16_rk, 4.791314839097285e-17_rk, -1.3987323808162444e-16_rk, 1.3246384020663138_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,1) = reshape((/ &
        -6.073299698047447_rk, -6.069792632978646e-16_rk, -5.311209799860773e-16_rk, -7.926271587477692e-16_rk,   &
        -5.644739574833097e-16_rk, -1.6273357494839944_rk, -4.430170462606215e-16_rk, 5.979622590003238e-17_rk,   &
        -1.0102820797085444e-16_rk, -2.8171090928129755e-16_rk, -1.6273357494839946_rk, 1.6855415486235367e-16_rk,   &
        -5.979852292268809e-16_rk, 1.8835222491635137e-16_rk, 4.2345569325607123e-16_rk, -0.43604329988853213_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,2) = reshape((/ &
        0.9835015156483258_rk, 4.918742523972143e-17_rk, 5.472429608285969e-17_rk, 2.6596420813421593e-16_rk,   &
        6.812770920304415e-17_rk, 0.9835015156483258_rk, 2.315384324596558e-16_rk, 9.328721408659e-17_rk,   &
        -6.577483711096703e-17_rk, 1.4913514615354127e-16_rk, 0.26352843687275423_rk, -1.6911698678897637e-16_rk,   &
        1.4913514615354122e-16_rk, -6.577483711096706e-17_rk, -1.8213333859877815e-16_rk, 0.26352843687275423_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,2,3) = reshape((/ &
        1.5448805681776037_rk, -8.896247739764246e-17_rk, 2.4944359691688364e-16_rk, 4.2793534858953303e-16_rk,   &
        -6.159916868429425e-17_rk, 0.4139495006457231_rk, 3.2363096136906107e-16_rk, 5.585050085823264e-17_rk,   &
        1.00187128045257e-17_rk, 3.559011163282001e-16_rk, 1.5448805681776037_rk, -1.1713008905152076e-16_rk,   &
        2.790915788656881e-16_rk, -1.7173318299498396e-16_rk, -2.6393602841725673e-16_rk, 0.4139495006457229_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,1) = reshape((/ &
        -1.6273357494839944_rk, -4.698524833807691e-16_rk, -2.066433051723321e-18_rk, -4.907449230981233e-16_rk,   &
        -4.967474856028309e-16_rk, -6.073299698047447_rk, -8.569988991882047e-16_rk, -5.882128764196627e-16_rk,   &
        1.8835222491635132e-16_rk, -5.97985229226881e-16_rk, -0.43604329988853213_rk, 2.9692577338347934e-16_rk,   &
        -2.8171090928129755e-16_rk, -1.0102820797085445e-16_rk, 1.0341747228654686e-16_rk, -1.6273357494839946_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,2) = reshape((/ &
        -0.9835015156483258_rk, -4.918742523972143e-17_rk, -5.472429608285969e-17_rk, -2.6596420813421593e-16_rk,   &
        -6.812770920304415e-17_rk, -0.9835015156483258_rk, -2.315384324596558e-16_rk, -9.328721408659e-17_rk,   &
        6.577483711096703e-17_rk, -1.4913514615354127e-16_rk, -0.26352843687275423_rk, 1.6911698678897637e-16_rk,   &
        -1.4913514615354122e-16_rk, 6.577483711096706e-17_rk, 1.8213333859877815e-16_rk, -0.26352843687275423_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,3,3) = reshape((/ &
        0.41394950064572245_rk, -1.2913884566938e-16_rk, -5.185305885600519e-17_rk, 4.0355067240715205e-16_rk,   &
        -1.6681999193334082e-16_rk, 1.5448805681776037_rk, 3.267303968493833e-16_rk, 3.5361644309274384e-16_rk,   &
        -1.71733182994984e-16_rk, 2.790915788656881e-16_rk, 0.4139495006457229_rk, -1.8538214751231727e-16_rk,   &
        3.559011163282001e-16_rk, 1.0018712804525716e-17_rk, -1.459666342302246e-16_rk, 1.5448805681776037_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,1) = reshape((/ &
        0.5123094026153315_rk, 6.678458188669362e-17_rk, -1.7370179261349997e-17_rk, 1.9209490852441212e-16_rk,   &
        1.0986539643561985e-16_rk, 1.9119647197556782_rk, 3.413427475673033e-16_rk, 2.0892972887026783e-16_rk,   &
        -1.199203013006132e-16_rk, 2.2992437261041543e-16_rk, 0.1372728907056489_rk, -1.638537702431568e-16_rk,   &
        9.654159555418373e-17_rk, 1.8886408140308262e-17_rk, -1.0588307848158423e-16_rk, 0.5123094026153319_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,2) = reshape((/ &
        -3.147204850074643_rk, -5.662980324313677e-16_rk, -2.370145372906285e-16_rk, -3.7871259937250106e-16_rk,   &
        -5.300125008440967e-16_rk, -3.147204850074643_rk, -4.3773124780450266e-16_rk, -1.7910443280470074e-16_rk,   &
        -4.2342728353463927e-17_rk, -3.0697946412682106e-16_rk, -0.8432909979928132_rk, 3.3571335837178324e-17_rk,   &
        -3.06979464126821e-16_rk, -4.234272835346393e-17_rk, 5.126897137933625e-17_rk, -0.8432909979928132_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,4,3) = reshape((/ &
        1.324638402066313_rk, 5.432497305232855e-16_rk, 6.015516719619745e-17_rk, 8.288084720747221e-16_rk,   &
        3.8166520333371477e-16_rk, 4.943617818168334_rk, 6.317337482589842e-16_rk, 7.417856607990761e-16_rk,   &
        4.7913148390972847e-17_rk, 5.3114892305329e-16_rk, 1.3246384020663138_rk, -3.7248650997661686e-17_rk,   &
        6.394109359335478e-16_rk, 2.6375293983210936e-16_rk, 2.269408439037159e-16_rk, 4.943617818168333_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,1) = reshape((/ &
        0.5123094026153315_rk, -1.7222478782591472e-16_rk, 2.1200447205634024e-16_rk, 2.0147237942316148e-16_rk,   &
        -1.2079285385730756e-16_rk, 0.13727289070564885_rk, 3.1739046460666215e-16_rk, 7.027570318803616e-17_rk,   &
        3.248035023873632e-17_rk, 3.8510744294288527e-16_rk, 1.9119647197556775_rk, 4.2747225173412715e-17_rk,   &
        1.523510081762164e-16_rk, -5.765187294152751e-17_rk, -9.114948929331417e-17_rk, 0.5123094026153316_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,2) = reshape((/ &
        0.8432909979928129_rk, 9.75748127224979e-17_rk, 2.5891980921970327e-16_rk, 5.211648303464181e-16_rk,   &
        3.9905902333816555e-17_rk, 0.8432909979928129_rk, 4.816189095064644e-16_rk, 3.026028723888272e-16_rk,   &
        1.560700657858092e-16_rk, 4.3822208684400784e-16_rk, 3.1472048500746426_rk, 1.6935999053822974e-16_rk,   &
        4.382220868440079e-16_rk, 1.5607006578580918e-16_rk, 1.0669793077838638e-16_rk, 3.1472048500746426_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,5,3) = reshape((/ &
        -4.943617818168333_rk, -4.99559296103284e-16_rk, -7.188566826336593e-16_rk, -5.84715689093389e-16_rk,   &
        -5.135605309509642e-16_rk, -1.3246384020663142_rk, -8.123781018833931e-16_rk, -1.4878404789185698e-17_rk,   &
        -2.6375293983210936e-16_rk, -6.394109359335478e-16_rk, -4.943617818168333_rk, -2.505449710224938e-16_rk,   &
        -5.3114892305329e-16_rk, -4.791314839097285e-17_rk, 1.3987323808162444e-16_rk, -1.3246384020663138_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,1) = reshape((/ &
        -1.6273357494839944_rk, 2.058576788753163e-16_rk, -6.267917504146075e-16_rk, -4.954287350290085e-16_rk,   &
        1.0617672212733955e-16_rk, -0.4360432998885322_rk, -9.297454655662033e-16_rk, -1.6174297083951334e-16_rk,   &
        -1.984268238553029e-16_rk, -9.544256622289847e-16_rk, -6.073299698047445_rk, -2.5817167896116126e-16_rk,   &
        -4.033929630854132e-16_rk, 2.4253896808730132e-17_rk, 1.3323245301222716e-16_rk, -1.6273357494839946_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,2) = reshape((/ &
        0.263528436872754_rk, -1.880350398837175e-16_rk, 7.106574727944461e-17_rk, 2.633762332795198e-16_rk,   &
        -2.1354386323983696e-16_rk, 0.263528436872754_rk, 1.824944673660413e-16_rk, 1.6738753856352992e-16_rk,   &
        -3.7175792090226505e-17_rk, 2.5511375891586883e-16_rk, 0.9835015156483258_rk, -2.3468284390702113e-17_rk,   &
        2.551137589158689e-16_rk, -3.71757920902265e-17_rk, -7.881880118872692e-17_rk, 0.983501515648326_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,6,3) = reshape((/ &
        -1.5448805681776037_rk, 8.896247739764246e-17_rk, -2.4944359691688364e-16_rk, -4.2793534858953303e-16_rk,   &
        6.159916868429425e-17_rk, -0.4139495006457231_rk, -3.2363096136906107e-16_rk, -5.585050085823264e-17_rk,   &
        -1.00187128045257e-17_rk, -3.559011163282001e-16_rk, -1.5448805681776037_rk, 1.1713008905152076e-16_rk,   &
        -2.790915788656881e-16_rk, 1.7173318299498396e-16_rk, 2.6393602841725673e-16_rk, -0.4139495006457229_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,1) = reshape((/ &
        -0.43604329988853163_rk, 8.348945923166166e-17_rk, 1.705788200351878e-17_rk, -1.022665235147196e-15_rk,   &
        3.4236956191012404e-16_rk, -1.6273357494839944_rk, -3.259919017820602e-16_rk, -7.546585168912559e-16_rk,   &
        2.4253896808730107e-17_rk, -4.033929630854132e-16_rk, -1.6273357494839946_rk, 2.839146232525973e-17_rk,   &
        -9.544256622289847e-16_rk, -1.9842682385530293e-16_rk, -1.232512515209723e-16_rk, -6.073299698047445_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,2) = reshape((/ &
        -0.263528436872754_rk, 1.880350398837175e-16_rk, -7.106574727944461e-17_rk, -2.633762332795198e-16_rk,   &
        2.1354386323983696e-16_rk, -0.263528436872754_rk, -1.824944673660413e-16_rk, -1.6738753856352992e-16_rk,   &
        3.7175792090226505e-17_rk, -2.5511375891586883e-16_rk, -0.9835015156483258_rk, 2.3468284390702113e-17_rk,   &
        -2.551137589158689e-16_rk, 3.71757920902265e-17_rk, 7.881880118872692e-17_rk, -0.983501515648326_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,7,3) = reshape((/ &
        -0.41394950064572245_rk, 1.2913884566938e-16_rk, 5.185305885600519e-17_rk, -4.0355067240715205e-16_rk,   &
        1.6681999193334082e-16_rk, -1.5448805681776037_rk, -3.267303968493833e-16_rk, -3.5361644309274384e-16_rk,   &
        1.71733182994984e-16_rk, -2.790915788656881e-16_rk, -0.4139495006457229_rk, 1.8538214751231727e-16_rk,   &
        -3.559011163282001e-16_rk, -1.0018712804525716e-17_rk, 1.459666342302246e-16_rk, -1.5448805681776037_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,1) = reshape((/ &
        0.13727289070564874_rk, -1.222803032962896e-16_rk, -2.9216935322625233e-17_rk, 3.700071190024781e-16_rk,   &
        -2.307999718509539e-16_rk, 0.5123094026153316_rk, 1.0771056415649164e-16_rk, 2.860088499679296e-16_rk,   &
        -5.765187294152745e-17_rk, 1.5235100817621644e-16_rk, 0.5123094026153316_rk, -4.151910415436349e-17_rk,   &
        3.851074429428852e-16_rk, 3.248035023873633e-17_rk, -1.639778239654743e-17_rk, 1.9119647197556775_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,2) = reshape((/ &
        -0.8432909979928129_rk, -9.75748127224979e-17_rk, -2.5891980921970327e-16_rk, -5.211648303464181e-16_rk,   &
        -3.9905902333816555e-17_rk, -0.8432909979928129_rk, -4.816189095064644e-16_rk, -3.026028723888272e-16_rk,   &
        -1.560700657858092e-16_rk, -4.3822208684400784e-16_rk, -3.1472048500746426_rk, -1.6935999053822974e-16_rk,   &
        -4.382220868440079e-16_rk, -1.5607006578580918e-16_rk, -1.0669793077838638e-16_rk, -3.1472048500746426_rk   &
        /),(/4,4/))
        test_dbr2_face_face1_dx(:,:,8,3) = reshape((/ &
        -1.324638402066313_rk, -5.432497305232855e-16_rk, -6.015516719619745e-17_rk, -8.288084720747221e-16_rk,   &
        -3.8166520333371477e-16_rk, -4.943617818168334_rk, -6.317337482589842e-16_rk, -7.417856607990761e-16_rk,   &
        -4.7913148390972847e-17_rk, -5.3114892305329e-16_rk, -1.3246384020663138_rk, 3.7248650997661686e-17_rk,   &
        -6.394109359335478e-16_rk, -2.6375293983210936e-16_rk, -2.269408439037159e-16_rk, -4.943617818168333_rk   &
        /),(/4,4/))
        
        


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face2_dx
        ! 
        test_dbr2_face_face2_dx(:,:,1,1) = reshape((/ &
        3.0366498490237235_rk, 1.1448817094494837e-16_rk, 1.377252571779108e-16_rk, 2.5365457334485204e-16_rk,   &
        1.7143941532501443e-20_rk, 0.8136678747419973_rk, -1.2263668078865066e-17_rk, 8.188880255508678e-17_rk,   &
        5.383425508010588e-17_rk, 1.907617135450873e-17_rk, 0.8136678747419975_rk, -5.758945157350928e-17_rk,   &
        9.963064008706346e-17_rk, 2.853074580356394e-17_rk, -2.967115456436703e-17_rk, 0.2180216499442661_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,1,2) = reshape((/ &
        0.786801212518661_rk, -4.610934676630083e-19_rk, 2.802849053137615e-17_rk, 2.0583101114377226e-16_rk,   &
        1.3783074579622661e-17_rk, 0.786801212518661_rk, 1.513048498845576e-16_rk, 8.698882757488578e-17_rk,   &
        4.3915952589422445e-17_rk, 1.5196236161750007e-16_rk, 0.2108227494982033_rk, 1.687725862672198e-17_rk,   &
        1.5196236161750007e-16_rk, 4.391595258942246e-17_rk, 3.6819659292569686e-17_rk, 0.2108227494982033_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,1,3) = reshape((/ &
        1.2359044545420832_rk, 3.761731543834121e-17_rk, 4.3652345017820357e-17_rk, 3.4863439564243206e-16_rk,   &
        -2.5076139540200512e-17_rk, 0.3311596005165784_rk, -2.5610253904693882e-17_rk, 7.959162827404902e-17_rk,   &
        6.366040626229624e-17_rk, 2.4679898745080764e-16_rk, 1.2359044545420832_rk, -5.896577653028025e-17_rk,   &
        2.4182986423653095e-16_rk, 2.5637746438695946e-17_rk, 8.260866451740194e-17_rk, 0.33115960051657845_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,1) = reshape((/ &
        -5.17355159463301_rk, -1.8913410190006433e-16_rk, -2.227360405493099e-16_rk, -5.697686014894418e-16_rk,   &
        1.9783127756239397e-17_rk, -1.386248971782662_rk, -8.577701973921384e-18_rk, -1.597832248040061e-16_rk,   &
        -1.242901855831137e-16_rk, -7.847977802027e-17_rk, -1.386248971782662_rk, 8.787965986362074e-17_rk,   &
        -2.9570302641613046e-16_rk, -5.250240169226917e-17_rk, 1.5895856315904426e-17_rk, -0.37144429249763833_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,2) = reshape((/ &
        2.1637033344263177_rk, 6.114197229291393e-17_rk, 1.0134643091551212e-16_rk, 1.5775521118492154e-16_rk,   &
        7.8947182352021e-17_rk, 2.1637033344263177_rk, 1.0023982654861375e-16_rk, 1.7541038486850042e-16_rk,   &
        4.241611002129878e-17_rk, 4.8464258527456804e-17_rk, 0.5797625611200592_rk, -4.341031384802834e-17_rk,   &
        4.8464258527456817e-17_rk, 4.2416110021298775e-17_rk, -3.049526773673562e-17_rk, 0.5797625611200592_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,2,3) = reshape((/ &
        3.3987372499907287_rk, 1.3822779369429314e-16_rk, 1.1936659307510383e-16_rk, 3.0040884294499673e-16_rk,   &
        -5.932172582811565e-17_rk, 0.9106889014205906_rk, -2.2159256826082947e-16_rk, 1.168038781180522e-16_rk,   &
        1.4702712235713637e-16_rk, 7.090698917658471e-17_rk, 3.3987372499907287_rk, -5.546567691155099e-17_rk,   &
        5.0512225319164463e-17_rk, 1.0889842647641478e-16_rk, 6.330523731087248e-17_rk, 0.9106889014205906_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,1) = reshape((/ &
        -1.386248971782662_rk, 4.215781460316494e-17_rk, -6.959247698371015e-17_rk, -1.5965343486995772e-16_rk,   &
        -2.3388347559391546e-16_rk, -5.17355159463301_rk, -4.896141796238654e-16_rk, -4.1126785182968183e-16_rk,   &
        -5.250240169226919e-17_rk, -2.9570302641613046e-16_rk, -0.37144429249763833_rk, -1.1523896113711664e-17_rk,   &
        -7.847977802026994e-17_rk, -1.2429018558311367e-16_rk, -4.48581839888044e-18_rk, -1.386248971782662_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,2) = reshape((/ &
        -2.1637033344263177_rk, -6.114197229291393e-17_rk, -1.0134643091551212e-16_rk, -1.5775521118492154e-16_rk,   &
        -7.8947182352021e-17_rk, -2.1637033344263177_rk, -1.0023982654861375e-16_rk, -1.7541038486850042e-16_rk,   &
        -4.241611002129878e-17_rk, -4.8464258527456804e-17_rk, -0.5797625611200592_rk, 4.341031384802834e-17_rk,   &
        -4.8464258527456817e-17_rk, -4.2416110021298775e-17_rk, 3.049526773673562e-17_rk, -0.5797625611200592_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,3,3) = reshape((/ &
        0.9106889014205906_rk, -8.729008438677257e-17_rk, 1.2258407911485399e-17_rk, -5.874621709374401e-17_rk,   &
        1.6619615225295006e-16_rk, 3.3987372499907287_rk, 2.2185780463478247e-16_rk, 3.7922548479326586e-16_rk,   &
        1.0889842647641478e-16_rk, 5.051222531916446e-17_rk, 0.9106889014205906_rk, 8.501746483614142e-17_rk,   &
        7.090698917658472e-17_rk, 1.4702712235713637e-16_rk, -3.517876991954567e-17_rk, 3.3987372499907287_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,1) = reshape((/ &
        0.8136678747419973_rk, -1.1170199481930258e-17_rk, 4.0488475111828555e-17_rk, 6.294969435965747e-17_rk,   &
        1.368628577918739e-16_rk, 3.0366498490237235_rk, 2.1839652374236601e-16_rk, 2.3586191259239967e-16_rk,   &
        2.853074580356395e-17_rk, 9.963064008706345e-17_rk, 0.2180216499442661_rk, -1.1766024565760442e-17_rk,   &
        1.907617135450868e-17_rk, 5.3834255080105875e-17_rk, -1.3017583319914567e-17_rk, 0.8136678747419975_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,2) = reshape((/ &
        -0.786801212518661_rk, 4.610934676630083e-19_rk, -2.802849053137615e-17_rk, -2.0583101114377226e-16_rk,   &
        -1.3783074579622661e-17_rk, -0.786801212518661_rk, -1.513048498845576e-16_rk, -8.698882757488578e-17_rk,   &
        -4.3915952589422445e-17_rk, -1.5196236161750007e-16_rk, -0.2108227494982033_rk, -1.687725862672198e-17_rk,   &
        -1.5196236161750007e-16_rk, -4.391595258942246e-17_rk, -3.6819659292569686e-17_rk, -0.2108227494982033_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,4,3) = reshape((/ &
        0.3311596005165784_rk, -4.745082638712605e-17_rk, 7.319740545946056e-18_rk, 8.46041894310671e-17_rk,   &
        5.999200228526677e-17_rk, 1.2359044545420832_rk, 2.833276949486626e-16_rk, 1.7986122024993377e-16_rk,   &
        2.5637746438695906e-17_rk, 2.4182986423653095e-16_rk, 0.33115960051657845_rk, 6.598990138695555e-17_rk,   &
        2.4679898745080764e-16_rk, 6.366040626229629e-17_rk, -2.7640326816894574e-17_rk, 1.2359044545420832_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,1) = reshape((/ &
        0.8136678747419975_rk, 4.015980925480446e-17_rk, -2.4608730942881204e-18_rk, 1.2349870300244163e-16_rk,   &
        -6.775994707030332e-17_rk, 0.2180216499442661_rk, -2.30314521418135e-16_rk, 5.614485515266924e-17_rk,   &
        1.14296554575625e-16_rk, 9.525427659732222e-17_rk, 3.0366498490237235_rk, -1.1214473797434903e-17_rk,   &
        -8.028264476189243e-18_rk, 9.268875139237442e-17_rk, 1.1055505082490694e-16_rk, 0.8136678747419973_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,2) = reshape((/ &
        0.2108227494982033_rk, -5.799114034126518e-18_rk, 4.4213469773297306e-18_rk, 6.997723826657182e-17_rk,   &
        8.44505401315913e-18_rk, 0.2108227494982033_rk, 1.2763168768009367e-17_rk, 7.818398579257271e-17_rk,   &
        1.2933017055928728e-17_rk, 1.5910842671592605e-16_rk, 0.786801212518661_rk, -1.2405561859383862e-17_rk,   &
        1.5910842671592605e-16_rk, 1.2933017055928737e-17_rk, -1.8257286582483605e-18_rk, 0.786801212518661_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,5,3) = reshape((/ &
        -1.2359044545420832_rk, -3.761731543834121e-17_rk, -4.3652345017820357e-17_rk, -3.4863439564243206e-16_rk,   &
        2.5076139540200512e-17_rk, -0.3311596005165784_rk, 2.5610253904693882e-17_rk, -7.959162827404902e-17_rk,   &
        -6.366040626229624e-17_rk, -2.4679898745080764e-16_rk, -1.2359044545420832_rk, 5.896577653028025e-17_rk,   &
        -2.4182986423653095e-16_rk, -2.5637746438695946e-17_rk, -8.260866451740194e-17_rk, -0.33115960051657845_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,1) = reshape((/ &
        -1.386248971782662_rk, -6.403499733244643e-17_rk, -7.915089585425618e-18_rk, -2.678512752716337e-16_rk,   &
        9.848613917646218e-17_rk, -0.37144429249763833_rk, 3.7706961888794476e-16_rk, -1.0562911044197304e-16_rk,   &
        -1.7046274786418438e-16_rk, -2.963914225830379e-16_rk, -5.17355159463301_rk, 6.095375626368262e-17_rk,   &
        -4.244025094500204e-17_rk, -1.4264351982081073e-16_rk, -2.022517062744488e-16_rk, -1.386248971782662_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,2) = reshape((/ &
        0.5797625611200592_rk, -2.871401938863415e-17_rk, -1.755135274954703e-17_rk, -3.908005325745052e-18_rk,   &
        -1.0908809329527093e-17_rk, 0.5797625611200592_rk, -1.0007097182860423e-16_rk, 1.403717152357392e-16_rk,   &
        1.2051115462016485e-16_rk, 2.8833614165877554e-17_rk, 2.1637033344263177_rk, 6.222356634963614e-17_rk,   &
        2.883361416587759e-17_rk, 1.2051115462016485e-16_rk, 4.840113300490628e-17_rk, 2.1637033344263177_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,6,3) = reshape((/ &
        -3.3987372499907287_rk, -1.3822779369429314e-16_rk, -1.1936659307510383e-16_rk, -3.0040884294499673e-16_rk,   &
        5.932172582811565e-17_rk, -0.9106889014205906_rk, 2.2159256826082947e-16_rk, -1.168038781180522e-16_rk,   &
        -1.4702712235713637e-16_rk, -7.090698917658471e-17_rk, -3.3987372499907287_rk, 5.546567691155099e-17_rk,   &
        -5.0512225319164463e-17_rk, -1.0889842647641478e-16_rk, -6.330523731087248e-17_rk, -0.9106889014205906_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,1) = reshape((/ &
        -0.37144429249763833_rk, 1.432355128703132e-16_rk, 4.285059037809839e-17_rk, 1.5892002639610702e-16_rk,   &
        -8.640968417937196e-17_rk, -1.386248971782662_rk, -1.5682765283589816e-16_rk, -3.6585266965988645e-16_rk,   &
        -1.4264351982081073e-16_rk, -4.244025094500205e-17_rk, -1.386248971782662_rk, -1.903382512816888e-16_rk,   &
        -2.963914225830379e-16_rk, -1.7046274786418438e-16_rk, 8.83735086932987e-17_rk, -5.17355159463301_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,2) = reshape((/ &
        -0.5797625611200592_rk, 2.871401938863415e-17_rk, 1.755135274954703e-17_rk, 3.908005325745052e-18_rk,   &
        1.0908809329527093e-17_rk, -0.5797625611200592_rk, 1.0007097182860423e-16_rk, -1.403717152357392e-16_rk,   &
        -1.2051115462016485e-16_rk, -2.8833614165877554e-17_rk, -2.1637033344263177_rk, -6.222356634963614e-17_rk,   &
        -2.883361416587759e-17_rk, -1.2051115462016485e-16_rk, -4.840113300490628e-17_rk, -2.1637033344263177_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,7,3) = reshape((/ &
        -0.9106889014205906_rk, 8.729008438677257e-17_rk, -1.2258407911485399e-17_rk, 5.874621709374401e-17_rk,   &
        -1.6619615225295006e-16_rk, -3.3987372499907287_rk, -2.2185780463478247e-16_rk, -3.7922548479326586e-16_rk,   &
        -1.0889842647641478e-16_rk, -5.051222531916446e-17_rk, -0.9106889014205906_rk, -8.501746483614142e-17_rk,   &
        -7.090698917658472e-17_rk, -1.4702712235713637e-16_rk, 3.517876991954567e-17_rk, -3.3987372499907287_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,1) = reshape((/ &
        0.2180216499442661_rk, -9.013463391722882e-17_rk, -2.6160998815467962e-17_rk, -1.1319882208660228e-16_rk,   &
        5.1347152678267225e-17_rk, 0.8136678747419975_rk, 6.41161420102709e-17_rk, 2.0020572030033792e-16_rk,   &
        9.268875139237442e-17_rk, -8.028264476189243e-18_rk, 0.8136678747419973_rk, 1.1347558691036745e-16_rk,   &
        9.525427659732223e-17_rk, 1.14296554575625e-16_rk, -2.911960379604146e-17_rk, 3.0366498490237235_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,2) = reshape((/ &
        -0.2108227494982033_rk, 5.799114034126518e-18_rk, -4.4213469773297306e-18_rk, -6.997723826657182e-17_rk,   &
        -8.44505401315913e-18_rk, -0.2108227494982033_rk, -1.2763168768009367e-17_rk, -7.818398579257271e-17_rk,   &
        -1.2933017055928728e-17_rk, -1.5910842671592605e-16_rk, -0.786801212518661_rk, 1.2405561859383862e-17_rk,   &
        -1.5910842671592605e-16_rk, -1.2933017055928737e-17_rk, 1.8257286582483605e-18_rk, -0.786801212518661_rk   &
        /),(/4,4/))
        test_dbr2_face_face2_dx(:,:,8,3) = reshape((/ &
        -0.3311596005165784_rk, 4.745082638712605e-17_rk, -7.319740545946056e-18_rk, -8.46041894310671e-17_rk,   &
        -5.999200228526677e-17_rk, -1.2359044545420832_rk, -2.833276949486626e-16_rk, -1.7986122024993377e-16_rk,   &
        -2.5637746438695906e-17_rk, -2.4182986423653095e-16_rk, -0.33115960051657845_rk, -6.598990138695555e-17_rk,   &
        -2.4679898745080764e-16_rk, -6.366040626229629e-17_rk, 2.7640326816894574e-17_rk, -1.2359044545420832_rk   &
        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face3_dx
        ! 
        test_dbr2_face_face3_dx(:,:,1,1) = reshape((/ &
        1.7354769494452384_rk, 6.379803383890713e-17_rk, 4.9696118310355487e-17_rk, 1.6425177353727213e-16_rk,   &
        1.2163989776327642e-16_rk, 2.970466935157309_rk, 2.684136301697115e-16_rk, 2.103528664352077e-16_rk,   &
        2.867448085742058e-16_rk, -1.1164884923504253e-16_rk, 0.46501964708667987_rk, 1.7969518039744875e-16_rk,   &
        4.31791355151129e-18_rk, 1.0382608428860225e-16_rk, 6.690450110424044e-17_rk, 0.7959342164187533_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,1,2) = reshape((/ &
        3.3297827068357693_rk, 9.808862737971534e-17_rk, 1.0579078599234615e-16_rk, 2.238402005620199e-16_rk,   &
        8.13905715458847e-17_rk, 0.6042233557575338_rk, 1.1498650646549955e-16_rk, 7.206496735597117e-18_rk,   &
        2.4289247065208074e-16_rk, 5.2049185334728894e-17_rk, 0.8922125872677622_rk, 5.707308138306902e-17_rk,   &
        4.828065282824656e-17_rk, 2.026207854938154e-17_rk, 7.306871218739572e-17_rk, 0.16190116022325413_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,1,3) = reshape((/ &
        4.973921024792375_rk, 1.5354158053109367e-16_rk, 5.310467190304965e-16_rk, 3.2890865685547264e-16_rk,   &
        5.022752947558406e-17_rk, 0.9025691816776048_rk, 3.418002175820081e-16_rk, 6.42553744662953e-17_rk,   &
        3.5254669102183513e-16_rk, 1.787883026067883e-16_rk, 4.973921024792375_rk, 3.0049559627885215e-16_rk,   &
        1.3883725366283968e-16_rk, 5.645828124556338e-17_rk, 1.9893294413030358e-16_rk, 0.9025691816776047_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,1) = reshape((/ &
        -5.841659499514995_rk, -2.125244754917666e-16_rk, -2.4838303225655235e-16_rk, -3.836572260262532e-16_rk,   &
        -2.1345070387180562e-16_rk, -4.85366751094534_rk, -4.704040714999956e-16_rk, -3.1112386426079445e-16_rk,   &
        -6.889279507599226e-16_rk, 1.3993564577826395e-16_rk, -1.5652679453526392_rk, -3.1877543123192957e-16_rk,   &
        -5.562528357500317e-17_rk, -1.7875415411918374e-16_rk, -1.5434393193517632e-16_rk, -1.3005362898869814_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,2) = reshape((/ &
        0.8922125872677622_rk, -3.0661637370926643e-18_rk, -6.245313198774082e-17_rk, 1.3968303572836511e-16_rk,   &
        7.775541617230265e-17_rk, 2.254992262806881_rk, 2.982626012860529e-16_rk, 1.2331177516239762e-16_rk,   &
        2.310830115614544e-16_rk, 1.0304450606509756e-17_rk, 0.23906764223527954_rk, 1.027842584009586e-16_rk,   &
        -3.714383317606374e-17_rk, 6.408822949004709e-17_rk, 4.169296708735632e-17_rk, 0.6042233557575338_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,2,3) = reshape((/ &
        1.3327581218092992_rk, 1.1209843742059454e-16_rk, 9.093495541982696e-17_rk, 5.293917132327966e-16_rk,   &
        1.2301685683530908e-16_rk, 3.368434043366685_rk, 3.5982065942149416e-16_rk, 4.935622283702865e-16_rk,   &
        2.483565104867021e-16_rk, -1.2686194855528228e-16_rk, 1.3327581218092992_rk, 5.268773273901466e-16_rk,   &
        1.842073114729886e-16_rk, 2.9580113828912585e-16_rk, 1.734600763622006e-16_rk, 3.368434043366685_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,1) = reshape((/ &
        -1.947219833171665_rk, 5.40048444512893e-17_rk, 2.2034934870472842e-16_rk, -3.3255624292755296e-16_rk,   &
        -1.1213626487568757e-16_rk, -1.6178891703151135_rk, -4.448944914404839e-16_rk, 9.36725035275919e-19_rk,   &
        -2.8039292037843593e-16_rk, -2.5288527894421205e-16_rk, -0.521755981784213_rk, -2.616036286858886e-17_rk,   &
        6.371458547274899e-17_rk, -1.0397960442005533e-17_rk, -7.001669090992539e-17_rk, -0.43351209662899387_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,2) = reshape((/ &
        -0.8922125872677622_rk, 3.0661637370926643e-18_rk, 6.245313198774082e-17_rk, -1.3968303572836511e-16_rk,   &
        -7.775541617230265e-17_rk, -2.254992262806881_rk, -2.982626012860529e-16_rk, -1.2331177516239762e-16_rk,   &
        -2.310830115614544e-16_rk, -1.0304450606509756e-17_rk, -0.23906764223527954_rk, -1.027842584009586e-16_rk,   &
        3.714383317606374e-17_rk, -6.408822949004709e-17_rk, -4.169296708735632e-17_rk, -0.6042233557575338_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,3,3) = reshape((/ &
        0.4442527072697664_rk, 2.8986246947207867e-17_rk, -1.6937234462654437e-16_rk, 2.535850454900206e-16_rk,   &
        4.358078042581513e-17_rk, 1.122811347788895_rk, 3.242307578826794e-16_rk, 8.481100137792995e-17_rk,   &
        9.639865678791353e-17_rk, 2.075690636956258e-16_rk, 0.4442527072697664_rk, 1.3512463139665712e-16_rk,   &
        1.0422214605441379e-16_rk, 6.45812113999728e-17_rk, -2.2296315066096114e-17_rk, 1.1228113477888948_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,1) = reshape((/ &
        0.5784923164817461_rk, -4.528064546361915e-17_rk, -1.2977800665139215e-16_rk, 1.2613323583127983e-16_rk,   &
        2.9562173867961055e-17_rk, 0.9901556450524363_rk, 2.639231346964335e-16_rk, -1.3832138145890693e-20_rk,   &
        1.6285904079878983e-16_rk, 1.4165839096933082e-16_rk, 0.15500654902889305_rk, 7.969763515679545e-18_rk,   &
        -5.548386815065494e-17_rk, 9.483836769071337e-18_rk, 2.1282296062773993e-17_rk, 0.2653114054729178_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,2) = reshape((/ &
        -3.3297827068357693_rk, -9.808862737971534e-17_rk, -1.0579078599234615e-16_rk, -2.238402005620199e-16_rk,   &
        -8.13905715458847e-17_rk, -0.6042233557575338_rk, -1.1498650646549955e-16_rk, -7.206496735597117e-18_rk,   &
        -2.4289247065208074e-16_rk, -5.2049185334728894e-17_rk, -0.8922125872677622_rk, -5.707308138306902e-17_rk,   &
        -4.828065282824656e-17_rk, -2.026207854938154e-17_rk, -7.306871218739572e-17_rk, -0.16190116022325413_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,4,3) = reshape((/ &
        1.6579736749307918_rk, 2.3001957219095503e-17_rk, -5.3316346239822414e-17_rk, 2.851118565651493e-16_rk,   &
        1.2766013811183646e-16_rk, 0.30085639389253493_rk, 2.22653144760922e-16_rk, 2.2279296848645456e-17_rk,   &
        -7.683342072675578e-17_rk, 2.2344864478959005e-16_rk, 1.6579736749307918_rk, 1.1609746745840237e-16_rk,   &
        5.442988974619582e-17_rk, -4.769553048274027e-17_rk, 4.9756356710049995e-17_rk, 0.300856393892535_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,1) = reshape((/ &
        0.46501964708667987_rk, 8.054514192651678e-17_rk, 1.2993332891568837e-16_rk, 4.564637109988892e-16_rk,   &
        1.8567106440223228e-17_rk, 0.7959342164187533_rk, 1.7167019037374492e-16_rk, 3.3106112941991556e-16_rk,   &
        3.4954001337909556e-17_rk, 2.5341819611674802e-18_rk, 1.7354769494452384_rk, 4.339412639117633e-16_rk,   &
        2.1541876859829786e-16_rk, 2.2341487713746613e-16_rk, 1.5050372638279154e-16_rk, 2.9704669351573085_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,2) = reshape((/ &
        0.8922125872677622_rk, 1.430247943577762e-17_rk, 1.9834181518673248e-16_rk, 1.670573989208418e-16_rk,   &
        3.1856234900618935e-17_rk, 0.16190116022325424_rk, 2.443556645813726e-16_rk, 4.7883186018823986e-17_rk,   &
        -6.736795127810588e-17_rk, 2.040228085545842e-16_rk, 3.3297827068357693_rk, 2.0813830002325528e-16_rk,   &
        7.475703201494631e-17_rk, -1.4683538153439184e-17_rk, 8.525181390384315e-17_rk, 0.6042233557575338_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,5,3) = reshape((/ &
        -4.973921024792375_rk, -1.5354158053109367e-16_rk, -5.310467190304965e-16_rk, -3.2890865685547264e-16_rk,   &
        -5.022752947558406e-17_rk, -0.9025691816776048_rk, -3.418002175820081e-16_rk, -6.42553744662953e-17_rk,   &
        -3.5254669102183513e-16_rk, -1.787883026067883e-16_rk, -4.973921024792375_rk, -3.0049559627885215e-16_rk,   &
        -1.3883725366283968e-16_rk, -5.645828124556338e-17_rk, -1.9893294413030358e-16_rk, -0.9025691816776047_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,1) = reshape((/ &
        -1.5652679453526392_rk, -1.2528713034263353e-16_rk, -4.634133658067931e-16_rk, -7.850008863300967e-16_rk,   &
        -2.9897184540837327e-17_rk, -1.3005362898869814_rk, -4.51258715775235e-16_rk, -5.174007365033489e-16_rk,   &
        -7.282465570467218e-17_rk, -1.3730466619283241e-16_rk, -5.841659499514995_rk, -8.154157145916751e-16_rk,   &
        -3.772876226357297e-16_rk, -3.3712574612853977e-16_rk, -3.267532023008439e-16_rk, -4.85366751094534_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,2) = reshape((/ &
        0.23906764223527954_rk, 9.288346338387508e-17_rk, 1.251833912585302e-17_rk, 3.587754501788614e-16_rk,   &
        2.8303933737851104e-17_rk, 0.6042233557575338_rk, 1.372180562858515e-16_rk, 2.448920587034148e-16_rk,   &
        -1.1605055448541123e-17_rk, 4.107529466257986e-17_rk, 0.8922125872677622_rk, 3.1865927790878936e-16_rk,   &
        2.207637287712636e-16_rk, 1.6533829993432102e-16_rk, 5.4540872219197126e-17_rk, 2.254992262806881_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,6,3) = reshape((/ &
        -1.3327581218092992_rk, -1.1209843742059454e-16_rk, -9.093495541982696e-17_rk, -5.293917132327966e-16_rk,   &
        -1.2301685683530908e-16_rk, -3.368434043366685_rk, -3.5982065942149416e-16_rk, -4.935622283702865e-16_rk,   &
        -2.483565104867021e-16_rk, 1.2686194855528228e-16_rk, -1.3327581218092992_rk, -5.268773273901466e-16_rk,   &
        -1.842073114729886e-16_rk, -2.9580113828912585e-16_rk, -1.734600763622006e-16_rk, -3.368434043366685_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,1) = reshape((/ &
        -0.521755981784213_rk, -1.2337040906755807e-16_rk, 9.764109282514853e-17_rk, -3.646181341272548e-16_rk,   &
        -9.239123836139036e-17_rk, -0.43351209662899387_rk, -2.9370236889078494e-16_rk, -1.5540827760755562e-16_rk,   &
        2.1483097841045982e-16_rk, -3.070887442070784e-16_rk, -1.947219833171665_rk, -3.0675172731224005e-16_rk,   &
        -2.8267315297544256e-16_rk, -3.7593331961155366e-17_rk, 5.0734945323865536e-17_rk, -1.6178891703151135_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,2) = reshape((/ &
        -0.23906764223527954_rk, -9.288346338387508e-17_rk, -1.251833912585302e-17_rk, -3.587754501788614e-16_rk,   &
        -2.8303933737851104e-17_rk, -0.6042233557575338_rk, -1.372180562858515e-16_rk, -2.448920587034148e-16_rk,   &
        1.1605055448541123e-17_rk, -4.107529466257986e-17_rk, -0.8922125872677622_rk, -3.1865927790878936e-16_rk,   &
        -2.207637287712636e-16_rk, -1.6533829993432102e-16_rk, -5.4540872219197126e-17_rk, -2.254992262806881_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,7,3) = reshape((/ &
        -0.4442527072697664_rk, -2.8986246947207867e-17_rk, 1.6937234462654437e-16_rk, -2.535850454900206e-16_rk,   &
        -4.358078042581513e-17_rk, -1.122811347788895_rk, -3.242307578826794e-16_rk, -8.481100137792995e-17_rk,   &
        -9.639865678791353e-17_rk, -2.075690636956258e-16_rk, -0.4442527072697664_rk, -1.3512463139665712e-16_rk,   &
        -1.0422214605441379e-16_rk, -6.45812113999728e-17_rk, 2.2296315066096114e-17_rk, -1.1228113477888948_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,1) = reshape((/ &
        0.15500654902889305_rk, 8.003536636354999e-17_rk, -6.082549467562824e-17_rk, 1.9082171416799617e-16_rk,   &
        3.70109955308916e-17_rk, 0.2653114054729178_rk, 1.1950278067890147e-16_rk, 9.477634082955438e-17_rk,   &
        -7.086562898515308e-17_rk, 1.162542383628185e-16_rk, 0.5784923164817461_rk, 1.5541021913585926e-16_rk,   &
        1.7609693155482296e-16_rk, 5.2727386202785434e-17_rk, -3.7638888178562075e-17_rk, 0.9901556450524363_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,2) = reshape((/ &
        -0.8922125872677622_rk, -1.430247943577762e-17_rk, -1.9834181518673248e-16_rk, -1.670573989208418e-16_rk,   &
        -3.1856234900618935e-17_rk, -0.16190116022325424_rk, -2.443556645813726e-16_rk, -4.7883186018823986e-17_rk,   &
        6.736795127810588e-17_rk, -2.040228085545842e-16_rk, -3.3297827068357693_rk, -2.0813830002325528e-16_rk,   &
        -7.475703201494631e-17_rk, 1.4683538153439184e-17_rk, -8.525181390384315e-17_rk, -0.6042233557575338_rk   &
        /),(/4,4/))
        test_dbr2_face_face3_dx(:,:,8,3) = reshape((/ &
        -1.6579736749307918_rk, -2.3001957219095503e-17_rk, 5.3316346239822414e-17_rk, -2.851118565651493e-16_rk,   &
        -1.2766013811183646e-16_rk, -0.30085639389253493_rk, -2.22653144760922e-16_rk, -2.2279296848645456e-17_rk,   &
        7.683342072675578e-17_rk, -2.2344864478959005e-16_rk, -1.6579736749307918_rk, -1.1609746745840237e-16_rk,   &
        -5.442988974619582e-17_rk, 4.769553048274027e-17_rk, -4.9756356710049995e-17_rk, -0.300856393892535_rk   &
        /),(/4,4/))
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face4_dx
        ! 
        test_dbr2_face_face4_dx(:,:,1,1) = reshape((/ &
        0.5784923164817461_rk, -6.643081555718183e-17_rk, -2.6862146573462346e-16_rk, 1.5311463105878455e-16_rk,   &
        2.18235169140805e-17_rk, 0.9901556450524363_rk, 2.88904462327264e-16_rk, 2.2634396102339082e-17_rk,   &
        1.6285904079878983e-16_rk, 1.9876013443989542e-16_rk, 0.155006549028893_rk, 3.0798339791146184e-17_rk,   &
        -2.370348854684614e-17_rk, 6.394323027530358e-18_rk, -1.6891366106683013e-17_rk, 0.26531140547291776_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,1,2) = reshape((/ &
        3.3297827068357693_rk, 6.64708720983324e-17_rk, 9.0789622054777e-17_rk, 2.0326025378111142e-16_rk,   &
        7.361520439749671e-17_rk, 0.6042233557575338_rk, 1.5728780771355635e-16_rk, 2.064535814678984e-17_rk,   &
        2.428924706520807e-16_rk, 5.390302739662527e-17_rk, 0.8922125872677622_rk, 1.0204293455677529e-16_rk,   &
        1.3099853665811731e-16_rk, 5.595824484023302e-17_rk, 2.556816949778347e-18_rk, 0.16190116022325413_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,1,3) = reshape((/ &
        1.6579736749307918_rk, 1.341591642723062e-17_rk, -7.961122213506501e-17_rk, 2.9381625943430177e-16_rk,   &
        1.2978816983019337e-16_rk, 0.30085639389253493_rk, 2.793109478844841e-16_rk, 4.493414869590373e-17_rk,   &
        -7.683342072675582e-17_rk, 1.9868212982316785e-16_rk, 1.6579736749307918_rk, 1.4276496738435158e-16_rk,   &
        7.566274653495562e-17_rk, -2.0341892060009483e-17_rk, -2.896716147737161e-17_rk, 0.30085639389253493_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,1) = reshape((/ &
        -1.947219833171665_rk, 1.0684352004288623e-16_rk, 4.312579277557902e-16_rk, -3.663423753174865e-16_rk,   &
        -9.263655789681577e-17_rk, -1.617889170315114_rk, -5.188002695949661e-16_rk, -3.148157099954406e-17_rk,   &
        -2.8039292037843593e-16_rk, -3.317090969770246e-16_rk, -0.5217559817842129_rk, -9.102842756932578e-17_rk,   &
        -6.420083126419529e-18_rk, -2.847879374802536e-17_rk, 2.107587178708092e-17_rk, -0.4335120966289938_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,2) = reshape((/ &
        0.8922125872677622_rk, 2.14529030695693e-17_rk, -2.2696897477716484e-16_rk, 1.5623341469705252e-16_rk,   &
        7.3751958387014e-17_rk, 2.254992262806881_rk, 3.660126048497303e-16_rk, 1.888423962871267e-16_rk,   &
        2.310830115614543e-16_rk, 1.7868777209054025e-16_rk, 0.23906764223527954_rk, 1.0331356762046359e-16_rk,   &
        -7.002391801023068e-18_rk, 6.050964081653426e-17_rk, -1.5338332222680156e-17_rk, 0.6042233557575338_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,2,3) = reshape((/ &
        0.4442527072697664_rk, 4.188098008166951e-17_rk, -3.589788314963146e-16_rk, 2.905766257378752e-16_rk,   &
        4.272074075446353e-17_rk, 1.122811347788895_rk, 3.460246316412633e-16_rk, 2.375997071298561e-16_rk,   &
        9.639865678791352e-17_rk, 3.2182351325269117e-16_rk, 0.4442527072697664_rk, 1.0010697781110703e-16_rk,   &
        1.2719942098740327e-16_rk, 7.318916012944117e-18_rk, -6.818211241958342e-17_rk, 1.122811347788895_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,1) = reshape((/ &
        -5.841659499514995_rk, -2.71130723969665e-16_rk, -3.6344653152627625e-17_rk, -3.550533107512702e-16_rk,   &
        -2.1012259624617188e-16_rk, -4.85366751094534_rk, -6.317816268401748e-16_rk, -4.598010433860014e-16_rk,   &
        -6.889279507599226e-16_rk, -1.912933187912905e-16_rk, -1.5652679453526392_rk, -3.3125870976961053e-16_rk,   &
        -1.9825850582562406e-16_rk, -2.124098606281898e-16_rk, 1.1665711048990873e-17_rk, -1.3005362898869812_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,2) = reshape((/ &
        -0.8922125872677622_rk, -2.14529030695693e-17_rk, 2.2696897477716484e-16_rk, -1.5623341469705252e-16_rk,   &
        -7.3751958387014e-17_rk, -2.254992262806881_rk, -3.660126048497303e-16_rk, -1.888423962871267e-16_rk,   &
        -2.310830115614543e-16_rk, -1.7868777209054025e-16_rk, -0.23906764223527954_rk, -1.0331356762046359e-16_rk,   &
        7.002391801023068e-18_rk, -6.050964081653426e-17_rk, 1.5338332222680156e-17_rk, -0.6042233557575338_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,3,3) = reshape((/ &
        1.3327581218092992_rk, 1.927973035676833e-16_rk, -8.951400082321069e-17_rk, 5.330143008769487e-16_rk,   &
        1.3361742319005855e-16_rk, 3.368434043366685_rk, 4.751299884494402e-16_rk, 8.95477412307335e-16_rk,   &
        2.4835651048670213e-16_rk, 1.4222304955574232e-16_rk, 1.3327581218092992_rk, 4.954136856826185e-16_rk,   &
        1.9055105272006317e-16_rk, 2.712443357222608e-16_rk, 2.7035669646827578e-17_rk, 3.368434043366685_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,1) = reshape((/ &
        1.7354769494452384_rk, 1.1878453726737863e-16_rk, -9.338502938843465e-17_rk, 1.602940731756841e-16_rk,   &
        1.2072719538770487e-16_rk, 2.970466935157309_rk, 3.6826259881368885e-16_rk, 3.0180564232213727e-16_rk,   &
        2.867448085742058e-16_rk, 1.1653915013527902e-16_rk, 0.4650196470866799_rk, 1.6862945627981647e-16_rk,   &
        4.3515288694430346e-17_rk, 1.0948833176646377e-16_rk, -8.437485082366469e-18_rk, 0.7959342164187532_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,2) = reshape((/ &
        -3.3297827068357693_rk, -6.64708720983324e-17_rk, -9.0789622054777e-17_rk, -2.0326025378111142e-16_rk,   &
        -7.361520439749671e-17_rk, -0.6042233557575338_rk, -1.5728780771355635e-16_rk, -2.064535814678984e-17_rk,   &
        -2.428924706520807e-16_rk, -5.390302739662527e-17_rk, -0.8922125872677622_rk, -1.0204293455677529e-16_rk,   &
        -1.3099853665811731e-16_rk, -5.595824484023302e-17_rk, -2.556816949778347e-18_rk, -0.16190116022325413_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,4,3) = reshape((/ &
        4.973921024792375_rk, 1.7930622511845039e-16_rk, 5.161053216200718e-16_rk, 3.0776909546985e-16_rk,   &
        5.369989512029123e-17_rk, 0.9025691816776048_rk, 3.6997392260357493e-16_rk, 1.6977217373302531e-16_rk,   &
        3.525466910218351e-16_rk, 1.7832588539407138e-16_rk, 4.973921024792375_rk, 3.4529801351240365e-16_rk,   &
        2.5778366209948556e-16_rk, 8.835677793407594e-17_rk, 8.782351361372444e-17_rk, 0.9025691816776048_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,1) = reshape((/ &
        0.1550065490288931_rk, 1.1359739663393834e-16_rk, -1.3021900235911e-16_rk, 2.050165442642045e-16_rk,   &
        4.415084541075613e-17_rk, 0.2653114054729177_rk, 1.2670836373017084e-16_rk, 2.4015515752918354e-16_rk,   &
        -7.086562898515309e-17_rk, 1.7838551518964403e-16_rk, 0.5784923164817461_rk, 9.897301591071558e-17_rk,   &
        1.7232790292327364e-16_rk, -1.6419353305150781e-18_rk, -6.099201057246397e-17_rk, 0.9901556450524361_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,2) = reshape((/ &
        0.8922125872677622_rk, 5.621985378267179e-17_rk, 1.8709115219916044e-16_rk, 1.797208779176403e-16_rk,   &
        4.3196925743448775e-17_rk, 0.16190116022325424_rk, 2.560597787382663e-16_rk, 1.160409319637955e-16_rk,   &
        -6.736795127810584e-17_rk, 1.861077294317272e-16_rk, 3.3297827068357693_rk, 2.0866760924276022e-16_rk,   &
        8.128004010352819e-17_rk, -1.2658623677477842e-17_rk, 3.4912300549652815e-17_rk, 0.6042233557575338_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,5,3) = reshape((/ &
        -1.6579736749307918_rk, -1.341591642723062e-17_rk, 7.961122213506501e-17_rk, -2.9381625943430177e-16_rk,   &
        -1.2978816983019337e-16_rk, -0.30085639389253493_rk, -2.793109478844841e-16_rk, -4.493414869590373e-17_rk,   &
        7.683342072675582e-17_rk, -1.9868212982316785e-16_rk, -1.6579736749307918_rk, -1.4276496738435158e-16_rk,   &
        -7.566274653495562e-17_rk, 2.0341892060009483e-17_rk, 2.896716147737161e-17_rk, -0.30085639389253493_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,1) = reshape((/ &
        -0.521755981784213_rk, -1.8572370709016458e-16_rk, 2.0675235992245623e-16_rk, -3.971160975161849e-16_rk,   &
        -1.1285953385025945e-16_rk, -0.43351209662899376_rk, -3.143417229594988e-16_rk, -3.8244706164197716e-16_rk,   &
        2.1483097841045977e-16_rk, -3.773693709136041e-16_rk, -1.947219833171665_rk, -2.1672919547706365e-16_rk,   &
        -2.7075429158415313e-16_rk, 3.912557594658308e-17_rk, 1.1501509044944762e-16_rk, -1.617889170315114_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,2) = reshape((/ &
        0.23906764223527954_rk, 1.2794793244689632e-16_rk, -5.855043004258316e-17_rk, 3.68080853528482e-16_rk,   &
        3.85084034030649e-17_rk, 0.6042233557575338_rk, 1.5675066247100121e-16_rk, 5.324969015638928e-16_rk,   &
        -1.1605055448541083e-17_rk, 1.167334450925232e-16_rk, 0.8922125872677622_rk, 2.75806661613103e-16_rk,   &
        2.0928862604236155e-16_rk, 1.168292330931051e-16_rk, -1.0856306809047389e-17_rk, 2.254992262806881_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,6,3) = reshape((/ &
        -0.4442527072697664_rk, -4.188098008166951e-17_rk, 3.589788314963146e-16_rk, -2.905766257378752e-16_rk,   &
        -4.272074075446353e-17_rk, -1.122811347788895_rk, -3.460246316412633e-16_rk, -2.375997071298561e-16_rk,   &
        -9.639865678791352e-17_rk, -3.2182351325269117e-16_rk, -0.4442527072697664_rk, -1.0010697781110703e-16_rk,   &
        -1.2719942098740327e-16_rk, -7.318916012944117e-18_rk, 6.818211241958342e-17_rk, -1.122811347788895_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,1) = reshape((/ &
        -1.5652679453526392_rk, -2.1857952395433268e-16_rk, -3.817472304025102e-16_rk, -7.964123318731047e-16_rk,   &
        -5.327332648346258e-17_rk, -1.3005362898869814_rk, -4.976210412705062e-16_rk, -1.1006880857223872e-15_rk,   &
        -7.282465570467222e-17_rk, -2.1955463402654386e-16_rk, -5.841659499514995_rk, -8.027755904477758e-16_rk,   &
        -3.725101344662268e-16_rk, -3.000425705658316e-16_rk, -1.47838217474275e-16_rk, -4.85366751094534_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,2) = reshape((/ &
        -0.23906764223527954_rk, -1.2794793244689632e-16_rk, 5.855043004258316e-17_rk, -3.68080853528482e-16_rk,   &
        -3.85084034030649e-17_rk, -0.6042233557575338_rk, -1.5675066247100121e-16_rk, -5.324969015638928e-16_rk,   &
        1.1605055448541083e-17_rk, -1.167334450925232e-16_rk, -0.8922125872677622_rk, -2.75806661613103e-16_rk,   &
        -2.0928862604236155e-16_rk, -1.168292330931051e-16_rk, 1.0856306809047389e-17_rk, -2.254992262806881_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,7,3) = reshape((/ &
        -1.3327581218092992_rk, -1.927973035676833e-16_rk, 8.951400082321069e-17_rk, -5.330143008769487e-16_rk,   &
        -1.3361742319005855e-16_rk, -3.368434043366685_rk, -4.751299884494402e-16_rk, -8.95477412307335e-16_rk,   &
        -2.4835651048670213e-16_rk, -1.4222304955574232e-16_rk, -1.3327581218092992_rk, -4.954136856826185e-16_rk,   &
        -1.9055105272006317e-16_rk, -2.712443357222608e-16_rk, -2.7035669646827578e-17_rk, -3.368434043366685_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,1) = reshape((/ &
        0.4650196470866798_rk, 1.1642890120834962e-16_rk, 7.638615490498814e-17_rk, 4.610704193794682e-16_rk,   &
        3.1430013450864546e-17_rk, 0.7959342164187533_rk, 2.0033491530164305e-16_rk, 6.886734438139196e-16_rk,   &
        3.4954001337909556e-17_rk, 6.405888560076217e-17_rk, 1.7354769494452384_rk, 4.180157457649117e-16_rk,   &
        2.0135256225017393e-16_rk, 1.9621430330890571e-16_rk, 5.106413141183069e-17_rk, 2.970466935157309_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,2) = reshape((/ &
        -0.8922125872677622_rk, -5.621985378267179e-17_rk, -1.8709115219916044e-16_rk, -1.797208779176403e-16_rk,   &
        -4.3196925743448775e-17_rk, -0.16190116022325424_rk, -2.560597787382663e-16_rk, -1.160409319637955e-16_rk,   &
        6.736795127810584e-17_rk, -1.861077294317272e-16_rk, -3.3297827068357693_rk, -2.0866760924276022e-16_rk,   &
        -8.128004010352819e-17_rk, 1.2658623677477842e-17_rk, -3.4912300549652815e-17_rk, -0.6042233557575338_rk   &
        /),(/4,4/))
        test_dbr2_face_face4_dx(:,:,8,3) = reshape((/ &
        -4.973921024792375_rk, -1.7930622511845039e-16_rk, -5.161053216200718e-16_rk, -3.0776909546985e-16_rk,   &
        -5.369989512029123e-17_rk, -0.9025691816776048_rk, -3.6997392260357493e-16_rk, -1.6977217373302531e-16_rk,   &
        -3.525466910218351e-16_rk, -1.7832588539407138e-16_rk, -4.973921024792375_rk, -3.4529801351240365e-16_rk,   &
        -2.5778366209948556e-16_rk, -8.835677793407594e-17_rk, -8.782351361372444e-17_rk, -0.9025691816776048_rk   &
        /),(/4,4/))

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face5_dx
        ! 
        test_dbr2_face_face5_dx(:,:,1,1) = reshape((/ &
        1.7354769494452387_rk, 2.2768078761115897e-16_rk, 2.4195929750540165e-17_rk, 1.899871558046126e-16_rk,   &
        5.697194987328159e-18_rk, 2.9704669351573094_rk, 7.864395287787092e-17_rk, 1.9326478369435024e-16_rk,   &
        1.7832726934053295e-16_rk, 3.621535683940996e-16_rk, 0.4650196470866803_rk, 7.032978718961882e-17_rk,   &
        1.0033988650574919e-16_rk, 3.287641200454781e-16_rk, 1.3171395913667324e-17_rk, 0.7959342164187533_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,1,2) = reshape((/ &
        3.166496470577649_rk, 1.4091676581666361e-16_rk, 1.4746678875818125e-16_rk, 1.2179991551967082e-16_rk,   &
        7.987633731792073e-17_rk, 0.574593386985591_rk, 1.0795777089361722e-16_rk, 1.113723958339246e-17_rk,   &
        2.3812742788290693e-16_rk, 1.5840503624856943e-16_rk, 3.1664964705776493_rk, 1.9646843932732507e-16_rk,   &
        1.206729850494864e-16_rk, -1.582078771284479e-18_rk, 7.856928617363656e-17_rk, 0.574593386985591_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,1,3) = reshape((/ &
        5.230410444922795_rk, 1.9204997458250586e-16_rk, 2.3147984023368545e-16_rk, 3.401674559906918e-16_rk,   &
        1.1376172956245034e-16_rk, 0.94911182778762_rk, 2.3092270632046907e-17_rk, -2.3465275498233947e-17_rk,   &
        2.0377649528441206e-16_rk, 1.991621601860786e-16_rk, 1.4014842548003723_rk, 1.8070842405843117e-16_rk,   &
        1.936428888253884e-16_rk, 4.804243176545871e-17_rk, -2.7186918436776237e-18_rk, 0.25431374778251964_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,1) = reshape((/ &
        -5.841659499514995_rk, -4.777589007824863e-16_rk, -2.4906330881752166e-16_rk, -3.913043897098394e-16_rk,   &
        -9.313818651108723e-17_rk, -4.85366751094534_rk, -1.2042078740844315e-16_rk, -2.5597441185027265e-16_rk,   &
        -3.9678791453920087e-16_rk, -6.098292447379901e-16_rk, -1.5652679453526397_rk, -1.8312539000131653e-16_rk,   &
        -2.7589597804474616e-16_rk, -5.091846503412629e-16_rk, -2.0143308599333497e-17_rk, -1.3005362898869817_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,2) = reshape((/ &
        0.8484601721272813_rk, 1.72714269397581e-16_rk, 4.991469646323423e-18_rk, 3.1619647178937806e-16_rk,   &
        1.160036657747546e-18_rk, 2.144411713923311_rk, 9.9991490122672e-17_rk, 3.011014832087245e-16_rk,   &
        1.123024686810325e-16_rk, 2.8504362300438083e-16_rk, 0.8484601721272815_rk, 1.5450215681959906e-16_rk,   &
        1.1334177836298842e-16_rk, 2.7729756525572936e-16_rk, 2.2181494386119752e-17_rk, 2.144411713923311_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,2,3) = reshape((/ &
        1.4014842548003723_rk, 1.9826433041053507e-16_rk, -8.564901094016058e-17_rk, 2.9610338442085905e-16_rk,   &
        -9.414646930267909e-17_rk, 3.54213356336796_rk, 1.2679094838080855e-16_rk, 2.606398489600028e-16_rk,   &
        4.501335230990394e-16_rk, 4.412904827066056e-16_rk, 0.3755265742786935_rk, 8.507942883525954e-17_rk,   &
        8.777315960191006e-17_rk, 4.287975985719655e-16_rk, -3.9138190876485293e-17_rk, 0.9491118277876198_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,1) = reshape((/ &
        -1.5652679453526392_rk, -1.780026632864779e-16_rk, -1.2457899274272242e-17_rk, -5.788590846960382e-16_rk,   &
        -4.47861233361609e-17_rk, -1.3005362898869812_rk, -3.0384388085848396e-16_rk, -4.905104163597567e-16_rk,   &
        -2.7742606640460764e-16_rk, -3.469721558022196e-16_rk, -5.841659499514995_rk, -5.225973059873867e-16_rk,   &
        -2.0214052393426856e-16_rk, -1.5825905806954333e-16_rk, -1.6637061784505152e-16_rk, -4.85366751094534_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,2) = reshape((/ &
        -0.8484601721272813_rk, -1.72714269397581e-16_rk, -4.991469646323423e-18_rk, -3.1619647178937806e-16_rk,   &
        -1.160036657747546e-18_rk, -2.144411713923311_rk, -9.9991490122672e-17_rk, -3.011014832087245e-16_rk,   &
        -1.123024686810325e-16_rk, -2.8504362300438083e-16_rk, -0.8484601721272815_rk, -1.5450215681959906e-16_rk,   &
        -1.1334177836298842e-16_rk, -2.7729756525572936e-16_rk, -2.2181494386119752e-17_rk, -2.144411713923311_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,3,3) = reshape((/ &
        0.3755265742786933_rk, 1.7720679609370793e-16_rk, 2.5561780292603557e-16_rk, 5.681774943834743e-16_rk,   &
        -4.578745297078937e-19_rk, 0.9491118277876198_rk, 1.583575557820911e-16_rk, 3.607991086398493e-16_rk,   &
        1.158818931230332e-17_rk, 2.1599764015833586e-16_rk, 1.4014842548003723_rk, 2.3252765056865406e-16_rk,   &
        1.7564966573305525e-16_rk, 1.6976105846552266e-16_rk, -9.13902661457306e-17_rk, 3.54213356336796_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,1) = reshape((/ &
        0.46501964708667987_rk, 9.854138435993687e-17_rk, 1.988474185036153e-17_rk, 3.7433356033816516e-16_rk,   &
        1.556814755165354e-17_rk, 0.7959342164187533_rk, 1.165935129277827e-16_rk, 3.187779950357337e-16_rk,   &
        6.919270390358095e-17_rk, 1.5831418253300805e-16_rk, 1.7354769494452391_rk, 2.385089583065806e-16_rk,   &
        1.205540558840959e-16_rk, 1.3993754995566657e-16_rk, 4.3338544925134964e-17_rk, 2.9704669351573085_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,2) = reshape((/ &
        -3.166496470577649_rk, -1.4091676581666361e-16_rk, -1.4746678875818125e-16_rk, -1.2179991551967082e-16_rk,   &
        -7.987633731792073e-17_rk, -0.574593386985591_rk, -1.0795777089361722e-16_rk, -1.113723958339246e-17_rk,   &
        -2.3812742788290693e-16_rk, -1.5840503624856943e-16_rk, -3.1664964705776493_rk, -1.9646843932732507e-16_rk,   &
        -1.206729850494864e-16_rk, 1.582078771284479e-18_rk, -7.856928617363656e-17_rk, -0.574593386985591_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,4,3) = reshape((/ &
        1.4014842548003723_rk, 7.180725019616125e-17_rk, 9.308895132619178e-18_rk, 1.218956866111814e-16_rk,   &
        -9.52939298647808e-18_rk, 0.2543137477825197_rk, 2.376283608457504e-16_rk, 2.681876238727642e-17_rk,   &
        1.5504043769987807e-16_rk, 3.506535095264239e-16_rk, 5.230410444922795_rk, 2.852631837201348e-16_rk,   &
        4.8235850267625244e-17_rk, -6.63680270250618e-17_rk, 2.1815839906693465e-16_rk, 0.94911182778762_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,1) = reshape((/ &
        0.5784923164817464_rk, 1.5380795074418175e-17_rk, -8.082104303476145e-17_rk, 1.812268668010343e-16_rk,   &
        -8.958389584214399e-17_rk, 0.9901556450524365_rk, 6.145280239869934e-17_rk, 8.381424203207837e-17_rk,   &
        3.377821394252652e-16_rk, 1.437226683954877e-16_rk, 0.1550065490288936_rk, 4.9095509103496344e-17_rk,   &
        2.3976268269444478e-17_rk, 1.4040905253440146e-16_rk, -5.573847714121728e-17_rk, 0.2653114054729178_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,2) = reshape((/ &
        1.0554988235258829_rk, 2.7059960559473174e-17_rk, 5.824081139393387e-18_rk, 1.7235861714298298e-16_rk,   &
        -1.351997093358413e-17_rk, 0.19153112899519692_rk, 5.802213816931015e-17_rk, -9.002343523452566e-18_rk,   &
        -9.697473684814465e-18_rk, 1.916184902479332e-16_rk, 1.0554988235258833_rk, 1.0017829954642146e-16_rk,   &
        3.331180277246554e-17_rk, -1.0084357511384422e-17_rk, 5.858389119777174e-17_rk, 0.19153112899519692_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,5,3) = reshape((/ &
        -5.230410444922795_rk, -1.9204997458250586e-16_rk, -2.3147984023368545e-16_rk, -3.401674559906918e-16_rk,   &
        -1.1376172956245034e-16_rk, -0.94911182778762_rk, -2.3092270632046907e-17_rk, 2.3465275498233947e-17_rk,   &
        -2.0377649528441206e-16_rk, -1.991621601860786e-16_rk, -1.4014842548003723_rk, -1.8070842405843117e-16_rk,   &
        -1.936428888253884e-16_rk, -4.804243176545871e-17_rk, 2.7186918436776237e-18_rk, -0.25431374778251964_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,1) = reshape((/ &
        -1.947219833171665_rk, -3.408619555334315e-17_rk, 1.3154503616610745e-16_rk, -4.3057346200453494e-16_rk,   &
        1.1546627667872387e-16_rk, -1.6178891703151135_rk, -9.951080924269744e-17_rk, -1.197396744747105e-16_rk,   &
        -5.151768082271495e-16_rk, -2.8356151654948763e-16_rk, -0.5217559817842135_rk, -1.423751110389317e-16_rk,   &
        -6.767814777014915e-17_rk, -2.0224196628610113e-16_rk, 8.328373193327139e-17_rk, -0.43351209662899387_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,2) = reshape((/ &
        0.2828200573757606_rk, 6.631807368814955e-17_rk, 1.0321402401731715e-16_rk, 2.3402182453668983e-16_rk,   &
        -6.138703249330612e-17_rk, 0.7148039046411037_rk, 8.153968568846949e-17_rk, 9.451884451884033e-17_rk,   &
        1.8163870277144641e-16_rk, 1.333989921538131e-16_rk, 0.2828200573757607_rk, 4.769278977285268e-17_rk,   &
        5.4358400738182344e-17_rk, 1.0375671073612158e-16_rk, -1.0527849098309452e-16_rk, 0.7148039046411037_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,6,3) = reshape((/ &
        -1.4014842548003723_rk, -1.9826433041053507e-16_rk, 8.564901094016058e-17_rk, -2.9610338442085905e-16_rk,   &
        9.414646930267909e-17_rk, -3.54213356336796_rk, -1.2679094838080855e-16_rk, -2.606398489600028e-16_rk,   &
        -4.501335230990394e-16_rk, -4.412904827066056e-16_rk, -0.3755265742786935_rk, -8.507942883525954e-17_rk,   &
        -8.777315960191006e-17_rk, -4.287975985719655e-16_rk, 3.9138190876485293e-17_rk, -0.9491118277876198_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,1) = reshape((/ &
        -0.521755981784213_rk, -1.7195406168432334e-16_rk, -3.9082522306244925e-16_rk, -4.2653241532134837e-16_rk,   &
        5.575296890576475e-17_rk, -0.43351209662899376_rk, -1.9569059356323353e-16_rk, -9.344687950323219e-17_rk,   &
        9.263145763196457e-17_rk, -3.629587623929075e-16_rk, -1.947219833171665_rk, -1.4234404658607244e-16_rk,   &
        -1.200360313278744e-16_rk, -3.14385412350404e-17_rk, 7.203121292024596e-17_rk, -1.6178891703151135_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,2) = reshape((/ &
        -0.2828200573757606_rk, -6.631807368814955e-17_rk, -1.0321402401731715e-16_rk, -2.3402182453668983e-16_rk,   &
        6.138703249330612e-17_rk, -0.7148039046411037_rk, -8.153968568846949e-17_rk, -9.451884451884033e-17_rk,   &
        -1.8163870277144641e-16_rk, -1.333989921538131e-16_rk, -0.2828200573757607_rk, -4.769278977285268e-17_rk,   &
        -5.4358400738182344e-17_rk, -1.0375671073612158e-16_rk, 1.0527849098309452e-16_rk, -0.7148039046411037_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,7,3) = reshape((/ &
        -0.3755265742786933_rk, -1.7720679609370793e-16_rk, -2.5561780292603557e-16_rk, -5.681774943834743e-16_rk,   &
        4.578745297078937e-19_rk, -0.9491118277876198_rk, -1.583575557820911e-16_rk, -3.607991086398493e-16_rk,   &
        -1.158818931230332e-17_rk, -2.1599764015833586e-16_rk, -1.4014842548003723_rk, -2.3252765056865406e-16_rk,   &
        -1.7564966573305525e-16_rk, -1.6976105846552266e-16_rk, 9.13902661457306e-17_rk, -3.54213356336796_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,1) = reshape((/ &
        0.15500654902889305_rk, 1.0334397300192726e-16_rk, 2.56828106705772e-16_rk, 2.563030777072966e-16_rk,   &
        -1.7527303658489414e-17_rk, 0.2653114054729177_rk, 9.050360265996932e-17_rk, 7.39008546359926e-17_rk,   &
        -3.2860740382657636e-17_rk, 1.2824535448772656e-16_rk, 0.5784923164817468_rk, 5.579207826275997e-17_rk,   &
        7.6028022638829e-17_rk, 3.267158577257907e-17_rk, -1.0819600091793185e-16_rk, 0.990155645052436_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,2) = reshape((/ &
        -1.0554988235258829_rk, -2.7059960559473174e-17_rk, -5.824081139393387e-18_rk, -1.7235861714298298e-16_rk,   &
        1.351997093358413e-17_rk, -0.19153112899519692_rk, -5.802213816931015e-17_rk, 9.002343523452566e-18_rk,   &
        9.697473684814465e-18_rk, -1.916184902479332e-16_rk, -1.0554988235258833_rk, -1.0017829954642146e-16_rk,   &
        -3.331180277246554e-17_rk, 1.0084357511384422e-17_rk, -5.858389119777174e-17_rk, -0.19153112899519692_rk   &
        /),(/4,4/))
        test_dbr2_face_face5_dx(:,:,8,3) = reshape((/ &
        -1.4014842548003723_rk, -7.180725019616125e-17_rk, -9.308895132619178e-18_rk, -1.218956866111814e-16_rk,   &
        9.52939298647808e-18_rk, -0.2543137477825197_rk, -2.376283608457504e-16_rk, -2.681876238727642e-17_rk,   &
        -1.5504043769987807e-16_rk, -3.506535095264239e-16_rk, -5.230410444922795_rk, -2.852631837201348e-16_rk,   &
        -4.8235850267625244e-17_rk, 6.63680270250618e-17_rk, -2.1815839906693465e-16_rk, -0.94911182778762_rk   &
        /),(/4,4/))
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face6_dx
        ! 
        test_dbr2_face_face6_dx(:,:,1,1) = reshape((/ &
        0.5784923164817465_rk, 1.7389578138732702e-16_rk, -6.869734540335943e-17_rk, 1.3505965989621337e-16_rk,   &
        -1.4407283045931305e-17_rk, 0.9901556450524365_rk, 2.1833285782334683e-16_rk, 1.0335250078610313e-16_rk,   &
        1.63092228284353e-16_rk, 6.76217040538812e-17_rk, 0.15500654902889294_rk, 1.539731307721595e-18_rk,   &
        1.112692207620822e-16_rk, 1.0556530012342141e-16_rk, -5.243394664614905e-17_rk, 0.2653114054729177_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,1,2) = reshape((/ &
        1.0554988235258829_rk, 7.106815434647392e-17_rk, 6.66249303021442e-17_rk, 1.0342542382003317e-16_rk,   &
        3.2390068250141284e-17_rk, 0.19153112899519703_rk, 1.3695912933963102e-16_rk, -2.3604085997571655e-17_rk,   &
        6.66249303021442e-17_rk, 1.0698646583185455e-16_rk, 1.0554988235258829_rk, 8.531232239375959e-17_rk,   &
        1.3947867964292425e-16_rk, -3.390913401910374e-17_rk, 4.536589778053946e-17_rk, 0.19153112899519703_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,1,3) = reshape((/ &
        5.2304104449227955_rk, 3.396344841326402e-16_rk, 2.0388494207849828e-16_rk, 3.8674413861308865e-16_rk,   &
        1.0523691305731836e-16_rk, 0.94911182778762_rk, 1.435490460118387e-16_rk, -1.1134021092841216e-17_rk,   &
        4.653896521837829e-16_rk, 7.936281856489426e-17_rk, 1.4014842548003723_rk, 5.3523430141917104e-17_rk,   &
        3.4093093947779945e-16_rk, 2.5201546693768353e-17_rk, -3.5123387172227725e-18_rk, 0.2543137477825197_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,1) = reshape((/ &
        -1.947219833171665_rk, -3.3413046620745854e-16_rk, 1.0352292708230353e-16_rk, -3.253970798092109e-16_rk,   &
        -2.5184974005456643e-17_rk, -1.6178891703151135_rk, -3.7798596788417565e-16_rk, -1.4034019797735028e-16_rk,   &
        -3.28076356162215e-16_rk, -1.0988103070660895e-16_rk, -0.5217559817842128_rk, -5.28875973163454e-18_rk,   &
        -2.884747349538881e-16_rk, -1.2795163614016915e-16_rk, 8.189439937135654e-17_rk, -0.43351209662899376_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,2) = reshape((/ &
        0.28282005737576044_rk, 1.7753574893965552e-16_rk, 4.628339817688755e-17_rk, 1.2042183786620179e-16_rk,   &
        -4.7911558110764945e-17_rk, 0.7148039046411037_rk, 1.627748093097451e-16_rk, 1.3880049872823137e-16_rk,   &
        4.628339817688755e-17_rk, 1.1753590732343738e-16_rk, 0.28282005737576044_rk, 9.851771321052748e-17_rk,   &
        1.7778140220333517e-16_rk, 7.726181509814277e-17_rk, -3.010321364243781e-17_rk, 0.7148039046411037_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,2,3) = reshape((/ &
        1.4014842548003723_rk, 4.492084472335856e-16_rk, -1.3143491662649474e-16_rk, 2.0753183117327599e-16_rk,   &
        9.61224768887478e-17_rk, 3.54213356336796_rk, 4.349912945659566e-16_rk, 2.381050930766531e-16_rk,   &
        2.3027245375047647e-16_rk, 1.563834897243261e-16_rk, 0.3755265742786934_rk, 6.886719678310431e-17_rk,   &
        2.026615678315771e-16_rk, 3.2409025719613153e-16_rk, -9.944642266685301e-17_rk, 0.9491118277876198_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,1) = reshape((/ &
        -0.5217559817842128_rk, -2.1512494820618111e-16_rk, -3.280763561622151e-16_rk, -1.405727258365119e-16_rk,   &
        8.617660374244006e-17_rk, -0.43351209662899376_rk, -2.4706095620796445e-16_rk, -1.5515713348721906e-16_rk,   &
        1.0352292708230352e-16_rk, -3.5513856125027147e-16_rk, -1.947219833171665_rk, -3.7710671701890606e-16_rk,   &
        -3.7709940644297383e-16_rk, -1.3984179279328731e-18_rk, -8.588884937525433e-17_rk, -1.6178891703151135_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,2) = reshape((/ &
        -0.28282005737576044_rk, -1.7753574893965552e-16_rk, -4.628339817688755e-17_rk, -1.2042183786620179e-16_rk,   &
        4.7911558110764945e-17_rk, -0.7148039046411037_rk, -1.627748093097451e-16_rk, -1.3880049872823137e-16_rk,   &
        -4.628339817688755e-17_rk, -1.1753590732343738e-16_rk, -0.28282005737576044_rk, -9.851771321052748e-17_rk,   &
        -1.7778140220333517e-16_rk, -7.726181509814277e-17_rk, 3.010321364243781e-17_rk, -0.7148039046411037_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,3,3) = reshape((/ &
        0.3755265742786934_rk, 2.634579395826498e-16_rk, 2.302724537504765e-16_rk, 1.9642575314764765e-16_rk,   &
        -9.022447812151883e-17_rk, 0.9491118277876198_rk, 1.7536911989724213e-16_rk, 3.461771896758712e-16_rk,   &
        -1.3143491662649474e-16_rk, 2.2612271883318363e-16_rk, 1.4014842548003723_rk, 4.638783841742152e-16_rk,   &
        4.245901106937454e-16_rk, 1.2382297924329591e-16_rk, 1.278159059052716e-16_rk, 3.54213356336796_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,1) = reshape((/ &
        0.15500654902889294_rk, 1.4360285122250032e-16_rk, 1.6309222828435308e-16_rk, 9.364303855556448e-17_rk,   &
        -5.881377790913187e-17_rk, 0.2653114054729177_rk, 9.011905066851954e-17_rk, 1.2574195818849725e-16_rk,   &
        -6.869734540335942e-17_rk, 1.5705964178866817e-16_rk, 0.5784923164817465_rk, 1.8573213282978103e-16_rk,   &
        2.231771196261366e-16_rk, 1.6938343621452472e-17_rk, 1.2473710291623055e-17_rk, 0.9901556450524365_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,2) = reshape((/ &
        -1.0554988235258829_rk, -7.106815434647392e-17_rk, -6.66249303021442e-17_rk, -1.0342542382003317e-16_rk,   &
        -3.2390068250141284e-17_rk, -0.19153112899519703_rk, -1.3695912933963102e-16_rk, 2.3604085997571655e-17_rk,   &
        -6.66249303021442e-17_rk, -1.0698646583185455e-16_rk, -1.0554988235258829_rk, -8.531232239375959e-17_rk,   &
        -1.3947867964292425e-16_rk, 3.390913401910374e-17_rk, -4.536589778053946e-17_rk, -0.19153112899519703_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,4,3) = reshape((/ &
        1.4014842548003723_rk, 6.863172428465798e-17_rk, 4.653896521837828e-16_rk, 8.328376928417246e-17_rk,   &
        8.392588491361316e-18_rk, 0.2543137477825197_rk, 3.2308946172683337e-16_rk, -1.912076547507047e-18_rk,   &
        2.0388494207849835e-16_rk, 4.1713462807314047e-16_rk, 5.2304104449227955_rk, 4.289593303457724e-16_rk,   &
        1.2724313772106584e-16_rk, -2.881997249039213e-17_rk, 1.3950307581016265e-16_rk, 0.94911182778762_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,1) = reshape((/ &
        1.7354769494452387_rk, 3.621186208846329e-16_rk, -4.148103525925049e-17_rk, 1.4793525653855904e-16_rk,   &
        1.341140909349394e-16_rk, 2.9704669351573094_rk, 2.7220377417258167e-16_rk, 1.5135544235908624e-16_rk,   &
        1.5649189916751135e-16_rk, 1.130009492746076e-16_rk, 0.46501964708668_rk, 8.085931601899337e-17_rk,   &
        1.5943261220697e-16_rk, 2.4733213788683853e-16_rk, -5.520256064388076e-17_rk, 0.7959342164187533_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,2) = reshape((/ &
        3.1664964705776484_rk, 1.8884218632152188e-16_rk, 3.594485095485146e-16_rk, 1.9580363591193172e-16_rk,   &
        3.9948719160020905e-17_rk, 0.574593386985591_rk, 1.6011217123491035e-16_rk, 1.5298682287487898e-17_rk,   &
        3.594485095485146e-16_rk, 2.0909362562793653e-16_rk, 3.1664964705776484_rk, 2.218457427591955e-16_rk,   &
        1.5857019481181982e-16_rk, 3.160557261212818e-17_rk, 4.120849431166752e-17_rk, 0.574593386985591_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,5,3) = reshape((/ &
        -5.2304104449227955_rk, -3.396344841326402e-16_rk, -2.0388494207849828e-16_rk, -3.8674413861308865e-16_rk,   &
        -1.0523691305731836e-16_rk, -0.94911182778762_rk, -1.435490460118387e-16_rk, 1.1134021092841216e-17_rk,   &
        -4.653896521837829e-16_rk, -7.936281856489426e-17_rk, -1.4014842548003723_rk, -5.3523430141917104e-17_rk,   &
        -3.4093093947779945e-16_rk, -2.5201546693768353e-17_rk, 3.5123387172227725e-18_rk, -0.2543137477825197_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,1) = reshape((/ &
        -5.841659499514995_rk, -7.227196662947471e-16_rk, -1.2088376220300214e-16_rk, -4.1037634819454e-16_rk,   &
        -2.360278198851135e-16_rk, -4.85366751094534_rk, -4.45822688691584e-16_rk, -2.139848455790563e-16_rk,   &
        -5.273778134979764e-16_rk, -2.1617660424685594e-16_rk, -1.5652679453526392_rk, -1.5830139085674428e-16_rk,   &
        -3.9046868884001455e-16_rk, -3.9778888675486073e-16_rk, 7.488261565773417e-17_rk, -1.3005362898869817_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,2) = reshape((/ &
        0.8484601721272813_rk, 2.761617640093229e-16_rk, 1.6638532208354096e-17_rk, 1.3674554751034267e-16_rk,   &
        5.166634074338251e-17_rk, 2.144411713923311_rk, 2.2579269880799915e-16_rk, 2.331651551160915e-16_rk,   &
        1.6638532208354096e-17_rk, 1.2597510809763108e-16_rk, 0.8484601721272813_rk, 2.406386572683562e-16_rk,   &
        2.215394185966389e-16_rk, 2.078886075243522e-16_rk, 4.8163787603865764e-17_rk, 2.144411713923311_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,6,3) = reshape((/ &
        -1.4014842548003723_rk, -4.492084472335856e-16_rk, 1.3143491662649474e-16_rk, -2.0753183117327599e-16_rk,   &
        -9.61224768887478e-17_rk, -3.54213356336796_rk, -4.349912945659566e-16_rk, -2.381050930766531e-16_rk,   &
        -2.3027245375047647e-16_rk, -1.563834897243261e-16_rk, -0.3755265742786934_rk, -6.886719678310431e-17_rk,   &
        -2.026615678315771e-16_rk, -3.2409025719613153e-16_rk, 9.944642266685301e-17_rk, -0.9491118277876198_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,1) = reshape((/ &
        -1.5652679453526392_rk, -2.641060465352194e-16_rk, -5.273778134979765e-16_rk, -2.513109536197471e-16_rk,   &
        4.3592113453815146e-17_rk, -1.3005362898869812_rk, -3.706801870320748e-16_rk, -3.753639989629599e-16_rk,   &
        -1.2088376220300217e-16_rk, -4.41964451802624e-16_rk, -5.841659499514995_rk, -7.985085374676414e-16_rk,   &
        -4.1314721986239764e-16_rk, -1.5806157976440783e-16_rk, -2.6098508750533864e-16_rk, -4.85366751094534_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,2) = reshape((/ &
        -0.8484601721272813_rk, -2.761617640093229e-16_rk, -1.6638532208354096e-17_rk, -1.3674554751034267e-16_rk,   &
        -5.166634074338251e-17_rk, -2.144411713923311_rk, -2.2579269880799915e-16_rk, -2.331651551160915e-16_rk,   &
        -1.6638532208354096e-17_rk, -1.2597510809763108e-16_rk, -0.8484601721272813_rk, -2.406386572683562e-16_rk,   &
        -2.215394185966389e-16_rk, -2.078886075243522e-16_rk, -4.8163787603865764e-17_rk, -2.144411713923311_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,7,3) = reshape((/ &
        -0.3755265742786934_rk, -2.634579395826498e-16_rk, -2.302724537504765e-16_rk, -1.9642575314764765e-16_rk,   &
        9.022447812151883e-17_rk, -0.9491118277876198_rk, -1.7536911989724213e-16_rk, -3.461771896758712e-16_rk,   &
        1.3143491662649474e-16_rk, -2.2612271883318363e-16_rk, -1.4014842548003723_rk, -4.638783841742152e-16_rk,   &
        -4.245901106937454e-16_rk, -1.2382297924329591e-16_rk, -1.278159059052716e-16_rk, -3.54213356336796_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,1) = reshape((/ &
        0.46501964708668_rk, 1.5067981052568532e-16_rk, 1.5649189916751137e-16_rk, 1.307052754933134e-16_rk,   &
        -3.7059877223063565e-17_rk, 0.7959342164187533_rk, 1.4844607256340792e-16_rk, 2.467700804551322e-16_rk,   &
        -4.148103525925049e-17_rk, 1.506316905044744e-16_rk, 1.7354769494452387_rk, 3.798229471033388e-16_rk,   &
        2.5364963615498393e-16_rk, 1.1197563825742134e-16_rk, 1.4663620003869449e-16_rk, 2.9704669351573094_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,2) = reshape((/ &
        -3.1664964705776484_rk, -1.8884218632152188e-16_rk, -3.594485095485146e-16_rk, -1.9580363591193172e-16_rk,   &
        -3.9948719160020905e-17_rk, -0.574593386985591_rk, -1.6011217123491035e-16_rk, -1.5298682287487898e-17_rk,   &
        -3.594485095485146e-16_rk, -2.0909362562793653e-16_rk, -3.1664964705776484_rk, -2.218457427591955e-16_rk,   &
        -1.5857019481181982e-16_rk, -3.160557261212818e-17_rk, -4.120849431166752e-17_rk, -0.574593386985591_rk   &
        /),(/4,4/))
        test_dbr2_face_face6_dx(:,:,8,3) = reshape((/ &
        -1.4014842548003723_rk, -6.863172428465798e-17_rk, -4.653896521837828e-16_rk, -8.328376928417246e-17_rk,   &
        -8.392588491361316e-18_rk, -0.2543137477825197_rk, -3.2308946172683337e-16_rk, 1.912076547507047e-18_rk,   &
        -2.0388494207849835e-16_rk, -4.1713462807314047e-16_rk, -5.2304104449227955_rk, -4.289593303457724e-16_rk,   &
        -1.2724313772106584e-16_rk, 2.881997249039213e-17_rk, -1.3950307581016265e-16_rk, -0.94911182778762_rk   &
        /),(/4,4/))
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do
    
    
    
    
    
    
    
    
    
    end subroutine testElement_dbr2_face_dx
    !*******************************************************************************************


    !>
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dmetrics_dx_zetamax(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        real(rk)    :: test_dmetric_dx_zetamax(3,3,self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3)
        real(rk)    :: tol
        
        integer(ik)     :: inode_diff, idir, inode, irow
        
        tol = 1.e-14_rk
        
        
        test_dmetric_dx_zetamax(:,:,1,1,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 1.814663157560373372e-17_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.412928223397790205e-34_rk, 4.396293210175144752e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.155250446289920996e-17_rk, 7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.206464111698897241e-34_rk, 2.198146605087573609e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,1,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, -1.899062337165527671e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.632101532570580464e-18_rk, &
                                        0.000000000000000000e+00_rk, 1.814663157560373372e-17_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.862375276028130239e-18_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.718338938578192433e-34_rk, 1.177983215356857940e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.095484241390784422e-18_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.591694692890965372e-35_rk, 5.889916076784292781e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.961736132466737216e-33_rk, -5.088522196198633938e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, -2.312964634635742664e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.862375276028131010e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,1) = reshape((/                                                                                 &
                                        -3.081487911019577365e-33_rk, 4.862375276028130239e-18_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.718338938578192433e-34_rk, 1.177983215356857940e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.095484241390784422e-18_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.591694692890965372e-35_rk, 5.889916076784292781e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.961736132466737216e-33_rk, -5.088522196198633938e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, -2.312964634635742664e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.862375276028131010e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 1.302869528508794360e-18_rk, 8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,2) = reshape((/                                                                                 &
                                        -2.452170165583421520e-34_rk, 4.604275309149788320e-35_rk, 3.156396512522872000e-18_rk, &
                                        0.000000000000000000e+00_rk, 8.294325026639264780e-19_rk, 5.686058463052615780e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.302137654574895496e-35_rk, 1.578198256261436770e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 4.904340331166843040e-34_rk, -1.363465413139267668e-17_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, -6.197570059723943330e-19_rk, &
                                        0.000000000000000000e+00_rk, 1.302869528508795708e-18_rk, 8.931639747704094023e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,1) = reshape((/                                                                                 &
                                        1.577350269189629728e+00_rk, 8.289868374653944771e-01_rk, -1.244016935856292694e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.397406792245191820e-01_rk, -8.011868568650901149e-32_rk, &
                                        0.000000000000000000e+00_rk, 8.028193616584889848e-18_rk, 6.661338147750939243e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 2.929597740857995717e-17_rk, -4.396293210175149067e-17_rk, &
                                        1.004172369315441626e+00_rk, 5.277494117629406567e-01_rk, -7.919657785262490535e-01_rk, &
                                        2.787138212765998958e-17_rk, 1.464798870428998475e-17_rk, 2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,3) = reshape((/                                                                                 &
                                        -4.440892098500626162e-16_rk, -1.265495376839751228e-16_rk, 1.899062337165541723e-16_rk, &
                                        -1.094506616720631042e-17_rk, 0.000000000000000000e+00_rk, 8.632101532570643635e-18_rk, &
                                        1.577350269189624399e+00_rk, 8.289868374653949212e-01_rk, -1.244016935856302020e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,1) = reshape((/                                                                                 &
                                        -1.577350269189629950e+00_rk, 2.221263536348839773e-01_rk, -3.333333333333330928e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.446230791204398958e-01_rk, 8.320017359752858885e-32_rk, &
                                        0.000000000000000000e+00_rk, 8.482044460251395826e-16_rk, -7.105427357601001859e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 7.849833488109454348e-18_rk, -1.177983215356857016e-17_rk, &
                                        -1.004172369315441626e+00_rk, 1.414100286878807455e-01_rk, -2.122065907891936276e-01_rk, &
                                        -2.787138212765998958e-17_rk, 3.924916744054727944e-18_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, -3.390884642495298948e-17_rk, 5.088522196198564297e-17_rk, &
                                        1.094506616720631042e-17_rk, 0.000000000000000000e+00_rk, 2.312964634635711079e-18_rk, &
                                        -1.577350269189624399e+00_rk, 2.221263536348823953e-01_rk, -3.333333333333287629e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,1) = reshape((/                                                                                 &
                                        4.226497308103744910e-01_rk, -8.289868374653945882e-01_rk, -3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.446230791204374255e-01_rk, 1.155557966632341512e-32_rk, &
                                        0.000000000000000000e+00_rk, -8.730764016888194944e-16_rk, -1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, -2.929597740857996334e-17_rk, -1.177983215356853780e-17_rk, &
                                        2.690671754197210830e-01_rk, -5.277494117629406567e-01_rk, -2.122065907891937941e-01_rk, &
                                        7.468114333045759404e-18_rk, -1.464798870428998475e-17_rk, -2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, 1.265495376839748762e-16_rk, 5.088522196198647497e-17_rk, &
                                        -2.932721640608149419e-18_rk, 0.000000000000000000e+00_rk, 2.312964634635748827e-18_rk, &
                                        4.226497308103761008e-01_rk, -8.289868374653931449e-01_rk, -3.333333333333342030e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,1) = reshape((/                                                                                 &
                                        -4.226497308103746020e-01_rk, -2.221263536348840606e-01_rk, -8.931639747704077370e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.875163725722260283e-02_rk, -1.001483571081362644e-32_rk, &
                                        0.000000000000000000e+00_rk, -7.240818802659196119e-18_rk, 1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, -7.849833488109455889e-18_rk, -3.156396512522870074e-18_rk, &
                                        -2.690671754197210830e-01_rk, -1.414100286878807178e-01_rk, -5.686058463052611617e-02_rk, &
                                        -7.468114333045759404e-18_rk, -3.924916744054728715e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 3.390884642495312507e-17_rk, 1.363465413139261042e-17_rk, &
                                        2.932721640608149419e-18_rk, 0.000000000000000000e+00_rk, 6.197570059723913479e-19_rk, &
                                        -4.226497308103761008e-01_rk, -2.221263536348832834e-01_rk, -8.931639747704051002e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 1.850371707708594131e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,1) = reshape((/                                                                                 &
                                        -3.081487911019577365e-33_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.761451541109629564e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.905681226056464371e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,1) = reshape((/                                                                                 &
                                        -3.081487911019577365e-33_rk, 0.000000000000000000e+00_rk, 8.931639747704082921e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.761451541109629564e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.686058463052615086e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 4.958056047779155435e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.761451541109629564e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 1.850371707708594131e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,1) = reshape((/                                                                                 &
                                        1.577350269189629062e+00_rk, 1.504281969462680779e-01_rk, -3.333333333333332038e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.632785136822774708e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.322354824923294315e-16_rk, 6.217248937900876626e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, 1.961736132466737216e-33_rk, &
                                        1.004172369315441848e+00_rk, 9.576556449759883460e-02_rk, -2.122065907891937386e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 8.350442390129762627e-18_rk, -1.850371707708644668e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.577350269189624621e+00_rk, 1.504281969462687440e-01_rk, -3.333333333333424187e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,1) = reshape((/                                                                                 &
                                        -1.577350269189629284e+00_rk, 5.614056738944469549e-01_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.475389112631104505e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.217248937900876626e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,2) = reshape((/                                                                                 &
                                        -5.654319433712918851e-16_rk, 0.000000000000000000e+00_rk, 7.846944529866948863e-33_rk, &
                                        -1.004172369315441848e+00_rk, 3.574019523205512749e-01_rk, -7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.413579858428229713e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.116427526564086536e-17_rk, -6.905681226056439720e-17_rk, &
                                        0.000000000000000000e+00_rk, 7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.577350269189624621e+00_rk, 5.614056738944470659e-01_rk, -1.244016935856288475e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,1) = reshape((/                                                                                 &
                                        4.226497308103743800e-01_rk, -1.504281969462680779e-01_rk, -8.931639747704080146e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.777249420980925657e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.443289932012703503e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, -1.961736132466737216e-33_rk, &
                                        2.690671754197211385e-01_rk, -9.576556449759883460e-02_rk, -5.686058463052613005e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, -8.350442390129693293e-18_rk, -4.958056047779207050e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 0.000000000000000000e+00_rk, &
                                        4.226497308103761563e-01_rk, -1.504281969462675228e-01_rk, -8.931639747704188392e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,1) = reshape((/                                                                                 &
                                        -4.226497308103741579e-01_rk, -5.614056738944469549e-01_rk, -3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.632785136822895444e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.927207648365589221e-16_rk, 1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,2) = reshape((/                                                                                 &
                                        5.654319433712918851e-16_rk, 0.000000000000000000e+00_rk, -7.846944529866948863e-33_rk, &
                                        -2.690671754197211385e-01_rk, -3.574019523205512749e-01_rk, -2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.413579858428229713e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, -3.116427526564090234e-17_rk, -1.850371707708591666e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -4.226497308103761563e-01_rk, -5.614056738944476210e-01_rk, -3.333333333333328707e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,1) = reshape((/                                                                                 &
                                        -3.081487911019577365e-33_rk, 4.862375276028130239e-18_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.718338938578192433e-34_rk, 1.177983215356858094e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.095484241390784422e-18_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.591694692890965372e-35_rk, 5.889916076784292781e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.961736132466737216e-33_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 9.251858538542970657e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.862375276028131010e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 1.302869528508794360e-18_rk, 8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,2) = reshape((/                                                                                 &
                                        -2.452170165583421520e-34_rk, 4.604275309149788320e-35_rk, 3.156396512522872385e-18_rk, &
                                        0.000000000000000000e+00_rk, 8.294325026639264780e-19_rk, 5.686058463052615780e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.302137654574895496e-35_rk, 1.578198256261436770e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 4.904340331166843040e-34_rk, 1.487416814333746939e-17_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 2.479028023889577717e-18_rk, &
                                        0.000000000000000000e+00_rk, 1.302869528508796093e-18_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 1.814663157560373372e-17_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.412928223397790205e-34_rk, 4.396293210175144752e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.155250446289920996e-17_rk, 7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.206464111698897241e-34_rk, 2.198146605087573609e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, 7.846944529866948863e-33_rk, 2.071704367816939928e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.413579858428229713e-16_rk, 3.452840613028232186e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.814663157560373989e-17_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.862375276028130239e-18_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.718338938578192433e-34_rk, 1.177983215356858094e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.095484241390784422e-18_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.591694692890965372e-35_rk, 5.889916076784292781e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.961736132466737216e-33_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 9.251858538542970657e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.862375276028131010e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,1) = reshape((/                                                                                 &
                                        4.226497308103744910e-01_rk, 8.289868374653945882e-01_rk, -3.333333333333332038e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.446230791204374255e-01_rk, -4.622231866529366047e-32_rk, &
                                        0.000000000000000000e+00_rk, 9.357272009936460733e-16_rk, -1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 2.929597740857995717e-17_rk, -1.177983215356853780e-17_rk, &
                                        2.690671754197210830e-01_rk, 5.277494117629406567e-01_rk, -2.122065907891936554e-01_rk, &
                                        7.468114333045759404e-18_rk, 1.464798870428998475e-17_rk, 2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.380540411097907786e-16_rk, -5.551115123125796261e-17_rk, &
                                        1.173088656243259768e-17_rk, 3.533949646070574282e-17_rk, -9.251858538542993768e-18_rk, &
                                        4.226497308103761008e-01_rk, 8.289868374653931449e-01_rk, -3.333333333333341475e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,1) = reshape((/                                                                                 &
                                        -4.226497308103746020e-01_rk, 2.221263536348840051e-01_rk, -8.931639747704089860e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.875163725722260283e-02_rk, 4.005934284325450574e-32_rk, &
                                        0.000000000000000000e+00_rk, -7.240818802659196119e-18_rk, 1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 7.849833488109455889e-18_rk, -3.156396512522870074e-18_rk, &
                                        -2.690671754197210830e-01_rk, 1.414100286878807178e-01_rk, -5.686058463052618556e-02_rk, &
                                        -7.468114333045759404e-18_rk, 3.924916744054728715e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,3) = reshape((/                                                                                 &
                                        -8.326672684688674053e-17_rk, 3.699146882722158650e-17_rk, -1.487416814333739235e-17_rk, &
                                        -1.173088656243259768e-17_rk, 0.000000000000000000e+00_rk, -2.479028023889565391e-18_rk, &
                                        -4.226497308103761008e-01_rk, 2.221263536348832834e-01_rk, -8.931639747704051002e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,1) = reshape((/                                                                                 &
                                        1.577350269189629728e+00_rk, -8.289868374653945882e-01_rk, -1.244016935856292250e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.397406792245191820e-01_rk, 3.204747427460360459e-31_rk, &
                                        0.000000000000000000e+00_rk, 8.028193616584889848e-18_rk, 6.661338147750939243e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, -2.929597740857995717e-17_rk, -4.396293210175147218e-17_rk, &
                                        1.004172369315441626e+00_rk, -5.277494117629406567e-01_rk, -7.919657785262488314e-01_rk, &
                                        2.787138212765998958e-17_rk, -1.464798870428998475e-17_rk, -2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, -1.380540411097910744e-16_rk, -2.071704367816954226e-16_rk, &
                                        4.378026466882524167e-17_rk, 0.000000000000000000e+00_rk, -3.452840613028256838e-17_rk, &
                                        1.577350269189624399e+00_rk, -8.289868374653949212e-01_rk, -1.244016935856301798e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,1) = reshape((/                                                                                 &
                                        -1.577350269189629950e+00_rk, -2.221263536348841161e-01_rk, -3.333333333333335369e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.446230791204398958e-01_rk, -3.328006943901143554e-31_rk, &
                                        0.000000000000000000e+00_rk, -9.605991566573259851e-16_rk, -7.105427357601001859e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, -7.849833488109455889e-18_rk, -1.177983215356859789e-17_rk, &
                                        -1.004172369315441626e+00_rk, -1.414100286878807455e-01_rk, -2.122065907891939607e-01_rk, &
                                        -2.787138212765998958e-17_rk, -3.924916744054730255e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, -3.699146882722143859e-17_rk, -5.551115123125711828e-17_rk, &
                                        -4.378026466882524167e-17_rk, 3.533949646070574282e-17_rk, -9.251858538542853560e-18_rk, &
                                        -1.577350269189624399e+00_rk, -2.221263536348823953e-01_rk, -3.333333333333290960e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.761451541109630335e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704098187e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.761451541109630335e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.761451541109630335e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,1) = reshape((/                                                                                 &
                                        4.226497308103746020e-01_rk, 1.504281969462680502e-01_rk, -8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.777249420980918371e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.443289932012703503e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.690671754197210830e-01_rk, 9.576556449759886236e-02_rk, -5.686058463052615780e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        4.226497308103762118e-01_rk, 1.504281969462675228e-01_rk, -8.931639747704188392e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,1) = reshape((/                                                                                 &
                                        -4.226497308103747130e-01_rk, 5.614056738944467329e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.632785136822895444e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.322354824923294315e-16_rk, 1.110223024625156540e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.690671754197210830e-01_rk, 3.574019523205513305e-01_rk, -2.122065907891937941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -4.226497308103762118e-01_rk, 5.614056738944476210e-01_rk, -3.333333333333329818e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,1) = reshape((/                                                                                 &
                                        1.577350269189630616e+00_rk, -1.504281969462680502e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.632785136822719196e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.322354824923294315e-16_rk, 7.549516567451064475e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.004172369315441626e+00_rk, -9.576556449759886236e-02_rk, -2.122065907891937941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.577350269189624843e+00_rk, -1.504281969462687440e-01_rk, -3.333333333333426962e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,1) = reshape((/                                                                                 &
                                        -1.577350269189630172e+00_rk, -5.614056738944467329e-01_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.475389112631110056e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.105427357601001859e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.004172369315441626e+00_rk, -3.574019523205513305e-01_rk, -7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.577350269189624843e+00_rk, -5.614056738944470659e-01_rk, -1.244016935856288919e+00_rk  &
                                        /),(/3,3/))
        
       
        
        do inode = 1,self%elem%basis_s%nnodes_face()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx_zetamax(:,:,inode,inode_diff,idir)),self%faces(ZETA_MAX)%dmetric_dx(:,:,inode,inode_diff,idir),tol)
                end do
            end do
        end do

    end subroutine testElement_face_dmetrics_dx_zetamax
    !*******************************************************************************************








    !> Test cartesian face dgrad_dx  
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dgrad_dx_ximax(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode, irow
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,-7.182335127930851160e-01_rk,-7.182335127930851160e-01_rk,0.000000000000000000e+00_rk,4.146723119520953627e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298752067e-01_rk,-1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,-1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,5.156684612641734833e-02_rk,5.156684612641734833e-02_rk,0.000000000000000000e+00_rk,2.977213249234704484e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.919657785262489424e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016226e-01_rk,-4.572416554211016226e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,3.282847384271378455e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,6.905681226056465604e-17_rk,-3.986996914801447028e-17_rk,1.244016935856292472e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595672e-17_rk,-1.068312603546425370e-17_rk,3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753455e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.931639747704084309e-02_rk,5.156684612641715404e-02_rk,5.156684612641715404e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,7.182335127930847829e-01_rk,7.182335127930847829e-01_rk,0.000000000000000000e+00_rk,-4.146723119520960843e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,1.111111111111112160e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704092636e-02_rk,-5.156684612641726506e-02_rk,-5.156684612641726506e-02_rk,0.000000000000000000e+00_rk,-2.977213249234699627e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.919657785262488314e-01_rk,0.000000000000000000e+00_rk,4.572416554211016226e-01_rk,4.572416554211015116e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891938774e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,-3.282847384271378455e-02_rk,-3.282847384271378455e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.244016935856292472e+00_rk,7.182335127930842278e-01_rk,7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.931639747704084309e-02_rk,-5.156684612641715404e-02_rk,-5.156684612641715404e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,-1.924500897298752067e-01_rk,-1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,7.182335127930851160e-01_rk,-7.182335127930851160e-01_rk,0.000000000000000000e+00_rk,-4.146723119520953627e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,-5.156684612641734833e-02_rk,5.156684612641734833e-02_rk,0.000000000000000000e+00_rk,-2.977213249234704484e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111115768e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.919657785262489424e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016226e-01_rk,-4.572416554211016226e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595672e-17_rk,-1.068312603546425370e-17_rk,3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298752899e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.244016935856292472e+00_rk,7.182335127930842278e-01_rk,7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk,4.958056047779150813e-18_rk,-2.862534993842546434e-18_rk,8.931639747704084309e-02_rk,-5.156684612641715404e-02_rk,-5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298754287e-01_rk,1.924500897298754287e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112160e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,-7.182335127930847829e-01_rk,7.182335127930847829e-01_rk,0.000000000000000000e+00_rk,4.146723119520960843e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704092636e-02_rk,5.156684612641726506e-02_rk,-5.156684612641726506e-02_rk,0.000000000000000000e+00_rk,2.977213249234699627e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333335924e-01_rk,-1.924500897298753732e-01_rk,-1.924500897298753732e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112715e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891938774e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.919657785262488314e-01_rk,0.000000000000000000e+00_rk,4.572416554211016226e-01_rk,4.572416554211015116e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,-3.282847384271378455e-02_rk,-3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.244016935856292472e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.931639747704084309e-02_rk,5.156684612641715404e-02_rk,5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,-1.924500897298752067e-01_rk,-1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,5.156684612641734833e-02_rk,-5.156684612641734833e-02_rk,0.000000000000000000e+00_rk,-2.977213249234704484e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,-7.182335127930851160e-01_rk,7.182335127930851160e-01_rk,0.000000000000000000e+00_rk,-4.146723119520953627e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111115768e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,-3.282847384271378455e-02_rk,-3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.919657785262489424e-01_rk,0.000000000000000000e+00_rk,4.572416554211016226e-01_rk,4.572416554211016226e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595672e-17_rk,-1.068312603546425370e-17_rk,3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298752899e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.931639747704084309e-02_rk,5.156684612641715404e-02_rk,5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,6.905681226056465604e-17_rk,-3.986996914801447028e-17_rk,1.244016935856292472e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112715e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704089860e-02_rk,-5.156684612641726506e-02_rk,5.156684612641726506e-02_rk,0.000000000000000000e+00_rk,2.977213249234698239e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,7.182335127930847829e-01_rk,-7.182335127930847829e-01_rk,0.000000000000000000e+00_rk,4.146723119520960843e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112715e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.919657785262488314e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016226e-01_rk,-4.572416554211015116e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891938774e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.931639747704081533e-02_rk,-5.156684612641715404e-02_rk,-5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.244016935856292472e+00_rk,7.182335127930842278e-01_rk,7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,-5.156684612641734833e-02_rk,-5.156684612641734833e-02_rk,0.000000000000000000e+00_rk,2.977213249234704484e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298752067e-01_rk,-1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,-1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,7.182335127930851160e-01_rk,7.182335127930851160e-01_rk,0.000000000000000000e+00_rk,4.146723119520953627e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,-3.282847384271378455e-02_rk,-3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.919657785262489424e-01_rk,0.000000000000000000e+00_rk,4.572416554211016226e-01_rk,4.572416554211016226e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk,4.958056047779150813e-18_rk,-2.862534993842546434e-18_rk,8.931639747704084309e-02_rk,-5.156684612641715404e-02_rk,-5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595672e-17_rk,-1.068312603546425370e-17_rk,3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753455e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.244016935856292472e+00_rk,7.182335127930842278e-01_rk,7.182335127930842278e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704089860e-02_rk,5.156684612641726506e-02_rk,5.156684612641726506e-02_rk,0.000000000000000000e+00_rk,-2.977213249234698239e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,1.111111111111112715e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,1.111111111111112715e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,-7.182335127930847829e-01_rk,-7.182335127930847829e-01_rk,0.000000000000000000e+00_rk,-4.146723119520960843e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891938774e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.919657785262488314e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016226e-01_rk,-4.572416554211015116e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.931639747704081533e-02_rk,5.156684612641715404e-02_rk,5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.244016935856292472e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk  &
                                        /),(/8,4/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad2
        !

        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,0.000000000000000000e+00_rk,1.413579858428229713e-16_rk,1.413579858428229713e-16_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.650462234552930558e-17_rk,2.650462234552930558e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.979914446315619303e-01_rk, -1.766974823035286956e-16_rk,5.020861846577208132e-01_rk,-4.878710385000892269e-01_rk,-2.898795938685275186e-01_rk,1.143104138552752391e-01_rk,2.816724754078486770e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, -1.766974823035286956e-16_rk,5.020861846577208132e-01_rk,2.368279461712288481e-01_rk,-2.898795938685275186e-01_rk,3.062938307898831550e-02_rk,-1.367326784735851120e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729853874e-02_rk, -1.766974823035286956e-16_rk,1.345335877098605692e-01_rk,-1.307246507766327004e-01_rk,7.767300307933397430e-02_rk,-3.062938307898831550e-02_rk,-7.547391231560846014e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.421514615763156547e-02_rk, -1.766974823035286956e-16_rk,1.345335877098605692e-01_rk,6.345785692170258230e-02_rk,7.767300307933397430e-02_rk,-8.207118460678569302e-03_rk,3.663741077594157708e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,-1.845430810625886819e-01_rk,-1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,-1.845430810625886819e-01_rk,-1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,4.944816953947211297e-02_rk,4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,4.944816953947211297e-02_rk,4.944816953947211297e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.020861846577240328e-01_rk,2.787138212766017447e-17_rk,-1.609154997409153190e-17_rk,5.020861846577240328e-01_rk,-2.898795938685291285e-01_rk,-2.898795938685291285e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.020861846577240328e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.020861846577240328e-01_rk,2.898795938685291840e-01_rk,2.898795938685291840e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.345335877098601807e-01_rk,7.468114333045742455e-18_rk,-4.311717820522863137e-18_rk,1.345335877098601807e-01_rk,-7.767300307933400205e-02_rk,-7.767300307933400205e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.345335877098601807e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.345335877098601807e-01_rk,7.767300307933391879e-02_rk,7.767300307933391879e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,0.000000000000000000e+00_rk,1.413579858428229713e-16_rk,1.413579858428229713e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.650462234552930558e-17_rk,2.650462234552930558e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-3.533949646070574282e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.305164769729853874e-02_rk, 1.722800452459404801e-16_rk,-5.020861846577208132e-01_rk,2.368279461712287925e-01_rk,2.898795938685275186e-01_rk,3.062938307898835019e-02_rk,-1.367326784735850842e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.979914446315619303e-01_rk, 1.766974823035286956e-16_rk,-5.020861846577208132e-01_rk,-4.878710385000892269e-01_rk,2.898795938685275186e-01_rk,1.143104138552752391e-01_rk,2.816724754078486770e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.421514615763156547e-02_rk, 1.722800452459404801e-16_rk,-1.345335877098605692e-01_rk,6.345785692170258230e-02_rk,-7.767300307933398817e-02_rk,-8.207118460678560629e-03_rk,3.663741077594158402e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, 1.766974823035286956e-16_rk,-1.345335877098605692e-01_rk,-1.307246507766326171e-01_rk,-7.767300307933397430e-02_rk,-3.062938307898831550e-02_rk,-7.547391231560846014e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,1.845430810625886819e-01_rk,1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,1.845430810625886819e-01_rk,1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,-4.944816953947211297e-02_rk,-4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,-4.944816953947211297e-02_rk,-4.944816953947211297e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.020861846577240328e-01_rk,-2.787138212766017447e-17_rk,1.609154997409153190e-17_rk,-5.020861846577240328e-01_rk,2.898795938685291840e-01_rk,2.898795938685291840e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.020861846577240328e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.020861846577240328e-01_rk,-2.898795938685291285e-01_rk,-2.898795938685291285e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.345335877098601807e-01_rk,-7.468114333045742455e-18_rk,4.311717820522863137e-18_rk,-1.345335877098601807e-01_rk,7.767300307933393266e-02_rk,7.767300307933393266e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.345335877098601807e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.345335877098601807e-01_rk,-7.767300307933400205e-02_rk,-7.767300307933400205e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.650462234552930558e-17_rk,-2.650462234552930558e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,0.000000000000000000e+00_rk,-1.413579858428229713e-16_rk,-1.413579858428229713e-16_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-3.533949646070574282e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, 2.650462234552930558e-17_rk,1.345335877098605692e-01_rk,-1.307246507766326171e-01_rk,-7.767300307933412695e-02_rk,3.062938307898838836e-02_rk,7.547391231560852953e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.421514615763154812e-02_rk, 2.650462234552930558e-17_rk,1.345335877098605692e-01_rk,6.345785692170259618e-02_rk,-7.767300307933412695e-02_rk,8.207118460678472158e-03_rk,-3.663741077594167422e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.979914446315619303e-01_rk, -1.272221872585406668e-15_rk,5.020861846577208132e-01_rk,-4.878710385000892269e-01_rk,2.898795938685260754e-01_rk,-1.143104138552743926e-01_rk,-2.816724754078478443e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, -1.272221872585406668e-15_rk,5.020861846577208132e-01_rk,2.368279461712288481e-01_rk,2.898795938685260754e-01_rk,-3.062938307898912735e-02_rk,1.367326784735843070e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,-4.944816953947211297e-02_rk,-4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,-4.944816953947211297e-02_rk,-4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,1.845430810625886819e-01_rk,1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,1.845430810625886819e-01_rk,1.845430810625886819e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.345335877098601807e-01_rk,7.468114333045742455e-18_rk,-4.311717820522863137e-18_rk,1.345335877098601807e-01_rk,-7.767300307933400205e-02_rk,-7.767300307933400205e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.345335877098602084e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.345335877098602084e-01_rk,7.767300307933393266e-02_rk,7.767300307933393266e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.020861846577240328e-01_rk,2.787138212766017447e-17_rk,-1.609154997409153190e-17_rk,5.020861846577240328e-01_rk,-2.898795938685291840e-01_rk,-2.898795938685291840e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.020861846577240328e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.020861846577240328e-01_rk,2.898795938685291840e-01_rk,2.898795938685291840e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.650462234552930558e-17_rk,-2.650462234552930558e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,0.000000000000000000e+00_rk,-1.413579858428229713e-16_rk,-1.413579858428229713e-16_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.421514615763154812e-02_rk, -2.540026308113225169e-17_rk,-1.345335877098605692e-01_rk,6.345785692170259618e-02_rk,7.767300307933412695e-02_rk,8.207118460678472158e-03_rk,-3.663741077594167422e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, -2.650462234552930558e-17_rk,-1.345335877098605692e-01_rk,-1.307246507766326171e-01_rk,7.767300307933412695e-02_rk,3.062938307898838836e-02_rk,7.547391231560852953e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, 1.289891620815759530e-15_rk,-5.020861846577208132e-01_rk,2.368279461712288481e-01_rk,-2.898795938685260754e-01_rk,-3.062938307898912735e-02_rk,1.367326784735843070e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.979914446315619303e-01_rk, 1.272221872585406668e-15_rk,-5.020861846577208132e-01_rk,-4.878710385000892269e-01_rk,-2.898795938685260754e-01_rk,-1.143104138552743926e-01_rk,-2.816724754078478443e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,4.944816953947211297e-02_rk,4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,4.944816953947211297e-02_rk,4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,-1.845430810625886819e-01_rk,-1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,-1.845430810625886819e-01_rk,-1.845430810625886819e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.345335877098602084e-01_rk,-7.468114333045743996e-18_rk,4.311717820522863907e-18_rk,-1.345335877098602084e-01_rk,7.767300307933393266e-02_rk,7.767300307933393266e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.345335877098601807e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.345335877098601807e-01_rk,-7.767300307933400205e-02_rk,-7.767300307933400205e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.020861846577240328e-01_rk,-2.787138212766017447e-17_rk,1.609154997409153190e-17_rk,-5.020861846577240328e-01_rk,2.898795938685291840e-01_rk,2.898795938685292395e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.020861846577241439e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.020861846577241439e-01_rk,-2.898795938685291840e-01_rk,-2.898795938685291840e-01_rk  &
                                        /),(/8,4/))
        
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad3
        !

        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,6.905681226056466837e-17_rk,-3.986996914801447644e-17_rk,4.440892098500626162e-16_rk,2.220446049250313081e-16_rk,2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,1.850371707708594131e-17_rk,-1.068312603546424753e-17_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.326672684688674053e-17_rk,-6.938893903907228378e-17_rk,-6.938893903907228378e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.396293210175144752e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.396293210175144752e-17_rk,0.000000000000000000e+00_rk,-2.538201068331145550e-17_rk,-2.538201068331145550e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.177983215356858094e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.177983215356858094e-17_rk,0.000000000000000000e+00_rk,6.801089264871430346e-18_rk,6.801089264871430346e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625157033e-16_rk,6.162975822039160204e-33_rk,-3.558195749863465697e-33_rk,1.110223024625157033e-16_rk,-6.409875621278552218e-17_rk,-6.409875621278552218e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562892584e-17_rk,-1.540743955509790051e-33_rk,8.895489374658664243e-34_rk,-2.775557561562892584e-17_rk,1.602468905319638054e-17_rk,1.602468905319638054e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.884981308350688778e-15_rk,1.577350269189624399e+00_rk,-9.106836025229586573e-01_rk,-9.106836025229636533e-01_rk,2.442490654175344389e-15_rk,5.257834230632101313e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.330669073875469621e-16_rk,4.226497308103761563e-01_rk,2.440169358562936375e-01_rk,-2.440169358562939150e-01_rk,-2.220446049250313081e-16_rk,-1.408832436034588298e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-15_rk,1.577350269189624621e+00_rk,-9.106836025229587683e-01_rk,9.106836025229543274e-01_rk,2.609024107869117870e-15_rk,-5.257834230632050243e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.273559366969493567e-16_rk,4.226497308103761563e-01_rk,2.440169358562936375e-01_rk,2.440169358562931379e-01_rk,-2.498001805406602216e-16_rk,1.408832436034583302e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.004172369315441626e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.004172369315441626e+00_rk,0.000000000000000000e+00_rk,-5.797591877370547042e-01_rk,-5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.690671754197210830e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.690671754197210830e-01_rk,0.000000000000000000e+00_rk,-1.553460061586682817e-01_rk,-1.553460061586682817e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.004172369315441626e+00_rk, 3.533949646070574282e-17_rk,1.961736132466737216e-33_rk,1.004172369315441626e+00_rk,3.533949646070574282e-17_rk,5.797591877370547042e-01_rk,5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.690671754197210830e-01_rk, 3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,2.690671754197210830e-01_rk,3.533949646070574282e-17_rk,1.553460061586682817e-01_rk,1.553460061586682817e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189634835e+00_rk,8.756052933765109964e-17_rk,-5.055309518347900131e-17_rk,1.577350269189634835e+00_rk,-9.106836025229645415e-01_rk,-9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103751016e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103751016e-01_rk,2.440169358562929991e-01_rk,2.440169358562929991e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189634835e+00_rk,8.756052933765109964e-17_rk,-5.055309518347900131e-17_rk,1.577350269189634835e+00_rk,-9.106836025229645415e-01_rk,-9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103750461e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103750461e-01_rk,2.440169358562929713e-01_rk,2.440169358562929713e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,1.850371707708594131e-17_rk,-1.068312603546424753e-17_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.440892098500626162e-16_rk,-2.220446049250313081e-16_rk,-2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,4.958056047779156205e-18_rk,-2.862534993842549131e-18_rk,8.326672684688674053e-17_rk,6.938893903907228378e-17_rk,6.938893903907228378e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.177983215356858094e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.177983215356858094e-17_rk,0.000000000000000000e+00_rk,-6.801089264871430346e-18_rk,-6.801089264871430346e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.156396512522872000e-18_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.156396512522872000e-18_rk,0.000000000000000000e+00_rk,1.822346376174278980e-18_rk,1.822346376174278980e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562892584e-17_rk,-1.540743955509790051e-33_rk,8.895489374658664243e-34_rk,-2.775557561562892584e-17_rk,1.602468905319638054e-17_rk,1.602468905319638054e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.938893903907231459e-18_rk,3.851859888774475127e-34_rk,-2.223872343664666061e-34_rk,6.938893903907231459e-18_rk,-4.006172263299095136e-18_rk,-4.006172263299095136e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk,4.226497308103761563e-01_rk,-2.440169358562936375e-01_rk,-2.440169358562941371e-01_rk,3.330669073875469621e-16_rk,1.408832436034589408e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.884981308350688778e-15_rk,1.577350269189624621e+00_rk,9.106836025229587683e-01_rk,-9.106836025229636533e-01_rk,-2.442490654175344389e-15_rk,-5.257834230632101313e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.273559366969493567e-16_rk,4.226497308103761563e-01_rk,-2.440169358562936375e-01_rk,2.440169358562931379e-01_rk,2.498001805406602216e-16_rk,-1.408832436034583302e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.551914400963141816e-15_rk,1.577350269189624621e+00_rk,9.106836025229587683e-01_rk,9.106836025229542164e-01_rk,-2.664535259100375697e-15_rk,5.257834230632049133e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.690671754197210830e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.690671754197210830e-01_rk,0.000000000000000000e+00_rk,-1.553460061586683094e-01_rk,-1.553460061586683094e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.004172369315441626e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.004172369315441626e+00_rk,0.000000000000000000e+00_rk,-5.797591877370547042e-01_rk,-5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.690671754197210830e-01_rk, -3.533949646070574282e-17_rk,-1.961736132466737216e-33_rk,2.690671754197210830e-01_rk,-3.533949646070574282e-17_rk,1.553460061586682817e-01_rk,1.553460061586682817e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.004172369315441626e+00_rk, -3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,1.004172369315441626e+00_rk,-3.533949646070574282e-17_rk,5.797591877370547042e-01_rk,5.797591877370547042e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103751016e-01_rk,2.346177312486515221e-17_rk,-1.354566102930682748e-17_rk,4.226497308103751016e-01_rk,-2.440169358562929991e-01_rk,-2.440169358562929991e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189634835e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189634835e+00_rk,9.106836025229645415e-01_rk,9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103750461e-01_rk,2.346177312486514913e-17_rk,-1.354566102930682594e-17_rk,4.226497308103750461e-01_rk,-2.440169358562929713e-01_rk,-2.440169358562929713e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189634835e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189634835e+00_rk,9.106836025229645415e-01_rk,9.106836025229645415e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,1.850371707708594131e-17_rk,-1.068312603546424753e-17_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.326672684688674053e-17_rk,-6.938893903907228378e-17_rk,-6.938893903907228378e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,6.905681226056466837e-17_rk,-3.986996914801447644e-17_rk,4.440892098500626162e-16_rk,2.220446049250313081e-16_rk,2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.177983215356858094e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.177983215356858094e-17_rk,0.000000000000000000e+00_rk,-6.801089264871430346e-18_rk,-6.801089264871430346e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.396293210175144752e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.396293210175144752e-17_rk,0.000000000000000000e+00_rk,2.538201068331145550e-17_rk,2.538201068331145550e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562892584e-17_rk,-1.540743955509790051e-33_rk,8.895489374658664243e-34_rk,-2.775557561562892584e-17_rk,1.602468905319638054e-17_rk,1.602468905319638054e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625157033e-16_rk,6.162975822039160204e-33_rk,-3.558195749863465697e-33_rk,1.110223024625157033e-16_rk,-6.409875621278552218e-17_rk,-6.409875621278552218e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-1.577350269189624621e+00_rk,9.106836025229587683e-01_rk,9.106836025229588794e-01_rk,0.000000000000000000e+00_rk,-5.257834230632075778e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk,-4.226497308103761563e-01_rk,-2.440169358562936375e-01_rk,2.440169358562936097e-01_rk,2.775557561562891351e-17_rk,1.408832436034586078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk,-1.577350269189624843e+00_rk,9.106836025229588794e-01_rk,-9.106836025229592124e-01_rk,-2.220446049250313081e-16_rk,5.257834230632074668e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-4.226497308103761563e-01_rk,-2.440169358562936375e-01_rk,-2.440169358562934709e-01_rk,0.000000000000000000e+00_rk,-1.408832436034586078e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.004172369315441626e+00_rk, 3.533949646070574282e-17_rk,1.961736132466737216e-33_rk,-1.004172369315441626e+00_rk,3.533949646070574282e-17_rk,5.797591877370547042e-01_rk,5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.690671754197210830e-01_rk, 3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-2.690671754197210830e-01_rk,3.533949646070574282e-17_rk,1.553460061586682817e-01_rk,1.553460061586682817e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.004172369315441626e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.004172369315441626e+00_rk,0.000000000000000000e+00_rk,-5.797591877370547042e-01_rk,-5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.690671754197210830e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.690671754197210830e-01_rk,0.000000000000000000e+00_rk,-1.553460061586683094e-01_rk,-1.553460061586683094e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189634835e+00_rk,-8.756052933765109964e-17_rk,5.055309518347900131e-17_rk,-1.577350269189634835e+00_rk,9.106836025229645415e-01_rk,9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103751016e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103751016e-01_rk,-2.440169358562929991e-01_rk,-2.440169358562929991e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189635057e+00_rk,-8.756052933765111196e-17_rk,5.055309518347901363e-17_rk,-1.577350269189635057e+00_rk,9.106836025229647635e-01_rk,9.106836025229647635e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103749906e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103749906e-01_rk,-2.440169358562929158e-01_rk,-2.440169358562929158e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,4.958056047779156205e-18_rk,-2.862534993842549131e-18_rk,8.326672684688674053e-17_rk,6.938893903907228378e-17_rk,6.938893903907228378e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,1.850371707708594131e-17_rk,-1.068312603546424753e-17_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.440892098500626162e-16_rk,-2.220446049250313081e-16_rk,-2.220446049250313081e-16_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.156396512522872000e-18_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.156396512522872000e-18_rk,0.000000000000000000e+00_rk,-1.822346376174278980e-18_rk,-1.822346376174278980e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.177983215356858094e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.177983215356858094e-17_rk,0.000000000000000000e+00_rk,6.801089264871430346e-18_rk,6.801089264871430346e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.938893903907231459e-18_rk,3.851859888774475127e-34_rk,-2.223872343664666061e-34_rk,6.938893903907231459e-18_rk,-4.006172263299095136e-18_rk,-4.006172263299095136e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562892584e-17_rk,-1.540743955509790051e-33_rk,8.895489374658664243e-34_rk,-2.775557561562892584e-17_rk,1.602468905319638054e-17_rk,1.602468905319638054e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk,-4.226497308103761563e-01_rk,2.440169358562936375e-01_rk,2.440169358562936097e-01_rk,-2.775557561562891351e-17_rk,-1.408832436034586078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-1.577350269189624621e+00_rk,-9.106836025229587683e-01_rk,9.106836025229588794e-01_rk,0.000000000000000000e+00_rk,5.257834230632075778e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-4.226497308103761563e-01_rk,2.440169358562936375e-01_rk,-2.440169358562934709e-01_rk,0.000000000000000000e+00_rk,1.408832436034585522e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk,-1.577350269189624621e+00_rk,-9.106836025229587683e-01_rk,-9.106836025229592124e-01_rk,2.220446049250313081e-16_rk,-5.257834230632074668e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.690671754197210830e-01_rk, -3.533949646070574282e-17_rk,-1.961736132466737216e-33_rk,-2.690671754197210830e-01_rk,-3.533949646070574282e-17_rk,1.553460061586682817e-01_rk,1.553460061586682817e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.004172369315441626e+00_rk, -3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-1.004172369315441626e+00_rk,-3.533949646070574282e-17_rk,5.797591877370547042e-01_rk,5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.690671754197210830e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.690671754197210830e-01_rk,0.000000000000000000e+00_rk,-1.553460061586683094e-01_rk,-1.553460061586683094e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.004172369315441626e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.004172369315441626e+00_rk,0.000000000000000000e+00_rk,-5.797591877370547042e-01_rk,-5.797591877370547042e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103751016e-01_rk,-2.346177312486515221e-17_rk,1.354566102930682748e-17_rk,-4.226497308103751016e-01_rk,2.440169358562929991e-01_rk,2.440169358562929991e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189634835e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189634835e+00_rk,-9.106836025229645415e-01_rk,-9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103750461e-01_rk,-2.346177312486514913e-17_rk,1.354566102930682594e-17_rk,-4.226497308103750461e-01_rk,2.440169358562929713e-01_rk,2.440169358562929713e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189634613e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189634613e+00_rk,-9.106836025229644305e-01_rk,-9.106836025229644305e-01_rk  &
                                        /),(/8,4/))
        
        
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_face_dgrad_dx_ximax
    !*******************************************************************************************








    !>  Test that the derivatives of the scaled normal vectors have been computed correctly. These are really
    !!  unit vectors scaled by the inverse jacobian of the face metric terms. Essentially,
    !!  an area scaling.
    !!
    !!  @author Matteo Ugolotti
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testelement_face_dnormals_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self

        real(rk), dimension(3,self%faces(XI_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dnorm_dx
        integer(ik) :: inode_diff, idir, irow, inode
        real(rk)    :: tol,mat(4,8)
        
        tol = 1.e-14_rk
        
        ! xi_min
         
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -2.442621541642132910e-01_rk, -1.971687836487029943e-01_rk, -3.097120011140004903e-01_rk, &
                                        -6.544984694978747686e-02_rk, -1.971687836487029943e-01_rk, -8.298708058472384352e-02_rk, &
                                        -6.544984694978747686e-02_rk, -5.283121635129700566e-02_rk, -3.097120011140004903e-01_rk, &
                                        -1.753723363493612034e-02_rk, -5.283121635129700566e-02_rk, -8.298708058472384352e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 5.472533083603155979e-18_rk, &
                                        1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 1.466360820304074902e-18_rk, &
                                        5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        3.097120011140004903e-01_rk, -5.472533083603144423e-18_rk, 1.452116967507729352e-32_rk, &
                                        8.298708058472384352e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.097120011140004348e-01_rk, -1.466360820304066236e-18_rk, 1.573126714800040268e-32_rk, &
                                        8.298708058472384352e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        8.719671245021579409e-17_rk, 0.000000000000000000e+00_rk, 2.420194945846215586e-33_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, -1.210097472923107793e-33_rk, &
                                        1.089958905627697426e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.143516494366212258e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.050487364615538966e-34_rk, 0.000000000000000000e+00_rk, -1.260518200961571544e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -6.544984694978747686e-02_rk, 1.971687836487029943e-01_rk, -8.298708058472384352e-02_rk, &
                                        -2.442621541642132910e-01_rk, 1.971687836487029943e-01_rk, -3.097120011140004903e-01_rk, &
                                        -1.753723363493612034e-02_rk, 5.283121635129700566e-02_rk, -8.298708058472384352e-02_rk, &
                                        -6.544984694978747686e-02_rk, 5.283121635129700566e-02_rk, -3.097120011140004903e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, -5.472533083603155979e-18_rk, &
                                        -1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, -1.466360820304074902e-18_rk, &
                                        -5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        8.298708058472385740e-02_rk, 5.472533083603143653e-18_rk, 1.270602346569263251e-32_rk, &
                                        3.097120011140004348e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.298708058472384352e-02_rk, 1.466360820304066621e-18_rk, 1.240349909746185659e-32_rk, &
                                        3.097120011140004348e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, -1.210097472923107793e-33_rk, &
                                        8.719671245021579409e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.089958905627697426e-17_rk, 0.000000000000000000e+00_rk, 4.537865523461654225e-34_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        6.050487364615538966e-34_rk, 0.000000000000000000e+00_rk, -1.260518200961571544e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.397579654728199623e-36_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -6.544984694978747686e-02_rk, -5.283121635129700566e-02_rk, 3.097120011140004903e-01_rk, &
                                        -1.753723363493612034e-02_rk, -5.283121635129700566e-02_rk, 8.298708058472384352e-02_rk, &
                                        -2.442621541642132910e-01_rk, -1.971687836487029943e-01_rk, 3.097120011140004903e-01_rk, &
                                        -6.544984694978747686e-02_rk, -1.971687836487029943e-01_rk, 8.298708058472384352e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 1.466360820304074902e-18_rk, &
                                        5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 5.472533083603155979e-18_rk, &
                                        1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -3.097120011140004903e-01_rk, -1.466360820304066428e-18_rk, -1.452116967507729352e-32_rk, &
                                        -8.298708058472384352e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.097120011140004348e-01_rk, -5.472533083603143653e-18_rk, -1.573126714800040268e-32_rk, &
                                        -8.298708058472384352e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, -1.210097472923107793e-33_rk, &
                                        1.089958905627697426e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.719671245021579409e-17_rk, 0.000000000000000000e+00_rk, 2.420194945846215586e-33_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        6.050487364615538966e-34_rk, 0.000000000000000000e+00_rk, -1.260518200961571544e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.143516494366212258e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -1.753723363493612034e-02_rk, 5.283121635129700566e-02_rk, 8.298708058472384352e-02_rk, &
                                        -6.544984694978747686e-02_rk, 5.283121635129700566e-02_rk, 3.097120011140004903e-01_rk, &
                                        -6.544984694978747686e-02_rk, 1.971687836487029943e-01_rk, 8.298708058472384352e-02_rk, &
                                        -2.442621541642132910e-01_rk, 1.971687836487029943e-01_rk, 3.097120011140004903e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, -1.466360820304074902e-18_rk, &
                                        -5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, -5.472533083603155979e-18_rk, &
                                        -1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -8.298708058472385740e-02_rk, 1.466360820304066428e-18_rk, -1.270602346569263251e-32_rk, &
                                        -3.097120011140004348e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -8.298708058472384352e-02_rk, 5.472533083603143653e-18_rk, -1.240349909746185659e-32_rk, &
                                        -3.097120011140004348e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        1.089958905627697426e-17_rk, 0.000000000000000000e+00_rk, 4.537865523461654225e-34_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, -1.210097472923107793e-33_rk, &
                                        8.719671245021579409e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.397579654728199623e-36_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.050487364615538966e-34_rk, 0.000000000000000000e+00_rk, -1.260518200961571544e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        
       
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        ! xi_max
       
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.743934249004315882e-16_rk, 0.000000000000000000e+00_rk, 9.680779783384862346e-33_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, -4.840389891692431173e-33_rk, &
                                        2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.148131954929698064e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.420194945846215586e-33_rk, 0.000000000000000000e+00_rk, -1.008414560769257236e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        2.442621541642132910e-01_rk, 1.971687836487029943e-01_rk, 6.194240022280008695e-01_rk, &
                                        6.544984694978739359e-02_rk, 1.971687836487029943e-01_rk, 1.659741611694476870e-01_rk, &
                                        6.544984694978733808e-02_rk, 5.283121635129700566e-02_rk, 6.194240022280009805e-01_rk, &
                                        1.753723363493612381e-02_rk, 5.283121635129700566e-02_rk, 1.659741611694476870e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, -2.189013233441262392e-17_rk, &
                                        -3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, -5.865443281216299609e-18_rk, &
                                        -1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -6.194240022280009805e-01_rk, 1.094506616720638283e-17_rk, 2.371791046929291548e-31_rk, &
                                        -1.659741611694476870e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.194240022280009805e-01_rk, 2.932721640608142871e-18_rk, 2.371791046929291548e-31_rk, &
                                        -1.659741611694476870e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, -4.840389891692431173e-33_rk, &
                                        1.743934249004315882e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 1.815146209384661690e-33_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        2.420194945846215586e-33_rk, 0.000000000000000000e+00_rk, -1.008414560769257236e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.318063723782559699e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        6.544984694978733808e-02_rk, -1.971687836487029943e-01_rk, 1.659741611694476870e-01_rk, &
                                        2.442621541642132910e-01_rk, -1.971687836487029943e-01_rk, 6.194240022280009805e-01_rk, &
                                        1.753723363493612381e-02_rk, -5.283121635129700566e-02_rk, 1.659741611694476870e-01_rk, &
                                        6.544984694978729645e-02_rk, -5.283121635129700566e-02_rk, 6.194240022280009805e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 2.189013233441262392e-17_rk, &
                                        3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 5.865443281216299609e-18_rk, &
                                        1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.659741611694476870e-01_rk, -1.094506616720638283e-17_rk, -1.936155956676972469e-32_rk, &
                                        -6.194240022280009805e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.659741611694476870e-01_rk, -2.932721640608142871e-18_rk, -2.057165703969283385e-32_rk, &
                                        -6.194240022280009805e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, -4.840389891692431173e-33_rk, &
                                        2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.743934249004315882e-16_rk, 0.000000000000000000e+00_rk, 9.680779783384862346e-33_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        2.420194945846215586e-33_rk, 0.000000000000000000e+00_rk, -1.008414560769257236e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.148131954929698064e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        6.544984694978739359e-02_rk, 5.283121635129700566e-02_rk, -6.194240022280009805e-01_rk, &
                                        1.753723363493613421e-02_rk, 5.283121635129700566e-02_rk, -1.659741611694476870e-01_rk, &
                                        2.442621541642132910e-01_rk, 1.971687836487029943e-01_rk, -6.194240022280009805e-01_rk, &
                                        6.544984694978739359e-02_rk, 1.971687836487029943e-01_rk, -1.659741611694476870e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, -5.865443281216299609e-18_rk, &
                                        -1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, -2.189013233441262392e-17_rk, &
                                        -3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        6.194240022280009805e-01_rk, 2.932721640608142871e-18_rk, -2.371791046929291548e-31_rk, &
                                        1.659741611694476870e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.194240022280009805e-01_rk, 1.094506616720638283e-17_rk, -2.420194945846215696e-31_rk, &
                                        1.659741611694477148e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 1.815146209384661690e-33_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, -4.840389891692431173e-33_rk, &
                                        1.743934249004315882e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.318063723782559699e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.420194945846215586e-33_rk, 0.000000000000000000e+00_rk, -1.008414560769257236e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        1.753723363493613421e-02_rk, -5.283121635129700566e-02_rk, -1.659741611694476870e-01_rk, &
                                        6.544984694978739359e-02_rk, -5.283121635129700566e-02_rk, -6.194240022280009805e-01_rk, &
                                        6.544984694978739359e-02_rk, -1.971687836487029943e-01_rk, -1.659741611694476593e-01_rk, &
                                        2.442621541642132910e-01_rk, -1.971687836487029943e-01_rk, -6.194240022280009805e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 5.865443281216299609e-18_rk, &
                                        1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 2.189013233441262392e-17_rk, &
                                        3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        1.659741611694476870e-01_rk, -2.932721640608143256e-18_rk, 1.936155956676972469e-32_rk, &
                                        6.194240022280009805e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.659741611694476870e-01_rk, -1.094506616720638283e-17_rk, 2.057165703969283385e-32_rk, &
                                        6.194240022280009805e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        


        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        ! eta_min

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487037160e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487033829e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -2.388354503153698183e-01_rk, 3.533949646070574282e-17_rk, -2.388354503153697628e-01_rk, &
                                        -3.526709006307395255e-01_rk, -8.834874115176435705e-18_rk, -9.449788301796385737e-02_rk, &
                                        -6.399576603592721513e-02_rk, 1.325231117276465279e-17_rk, -2.388354503153697628e-01_rk, &
                                        -9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, -9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487037160e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487036050e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129704730e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        2.388354503153698183e-01_rk, 8.834874115176435705e-18_rk, -6.399576603592718738e-02_rk, &
                                        3.526709006307395255e-01_rk, -3.533949646070574282e-17_rk, -3.526709006307394700e-01_rk, &
                                        6.399576603592721513e-02_rk, 3.313077793191163197e-18_rk, -6.399576603592720125e-02_rk, &
                                        9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, -3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.208718528794108926e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487037715e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487034939e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -6.399576603592721513e-02_rk, 1.766974823035287141e-17_rk, 2.388354503153697628e-01_rk, &
                                        -9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, 9.449788301796385737e-02_rk, &
                                        -2.388354503153698183e-01_rk, 3.533949646070574282e-17_rk, 2.388354503153697628e-01_rk, &
                                        -3.526709006307395255e-01_rk, 0.000000000000000000e+00_rk, 9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129704730e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129695015e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487037715e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487036050e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        6.399576603592721513e-02_rk, 4.417437057588217853e-18_rk, 6.399576603592720125e-02_rk, &
                                        9.449788301796387124e-02_rk, -8.834874115176435705e-18_rk, 3.526709006307394700e-01_rk, &
                                        2.388354503153698183e-01_rk, 8.834874115176435705e-18_rk, 6.399576603592720125e-02_rk, &
                                        3.526709006307395255e-01_rk, -3.533949646070574282e-17_rk, 3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.208718528794108926e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.208718528794108926e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! eta_max
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -7.563109205769425846e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 7.563109205769425846e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, -3.358695191199878008e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -2.519021393399908506e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.208718528794108926e-18_rk, 4.814824860968089633e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -2.519021393399908506e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.407412430484044816e-34_rk, 1.469429146149946629e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487037160e-01_rk, -1.962624980319193517e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487033829e-01_rk, -7.798329568905748780e-17_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699178e-02_rk, 5.117333987687811897e-18_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        2.388354503153698183e-01_rk, 3.533949646070574282e-17_rk, 2.388354503153697628e-01_rk, &
                                        3.526709006307395255e-01_rk, -8.834874115176435705e-18_rk, 9.449788301796385737e-02_rk, &
                                        6.399576603592721513e-02_rk, 1.325231117276465279e-17_rk, 2.388354503153697628e-01_rk, &
                                        9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, 9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.041283304203355185e-17_rk, -1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk, &
                                        2.790110204533015161e-18_rk, -1.971687836487030498e-01_rk, -2.057165703969283385e-32_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487037160e-01_rk, 2.822248466917933594e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487036050e-01_rk, 7.798329568905748780e-17_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129704730e-02_rk, -2.813979797398210674e-18_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -2.388354503153698183e-01_rk, 8.834874115176435705e-18_rk, 6.399576603592718738e-02_rk, &
                                        -3.526709006307395255e-01_rk, -3.533949646070574282e-17_rk, 3.526709006307394700e-01_rk, &
                                        -6.399576603592721513e-02_rk, 1.104359264397054463e-18_rk, 6.399576603592720125e-02_rk, &
                                        -9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, 3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.041283304203355185e-17_rk, -5.283121635129699178e-02_rk, -2.057165703969283385e-32_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, &
                                        -2.790110204533015161e-18_rk, -5.283121635129700566e-02_rk, -1.028582851984641693e-32_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 7.563109205769425846e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -7.563109205769425846e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.208718528794108926e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -2.519021393399908506e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -3.358695191199878008e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.208718528794108926e-18_rk, 4.814824860968089633e-35_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.407412430484044816e-34_rk, 1.049592247249961878e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -2.519021393399908506e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129700566e-02_rk, 5.117333987687799571e-18_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487037715e-01_rk, -1.962624980319193517e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487034939e-01_rk, -7.798329568905750013e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        6.399576603592721513e-02_rk, 1.766974823035287141e-17_rk, -2.388354503153697628e-01_rk, &
                                        9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, -9.449788301796385737e-02_rk, &
                                        2.388354503153698183e-01_rk, 3.533949646070574282e-17_rk, -2.388354503153697628e-01_rk, &
                                        3.526709006307395255e-01_rk, 0.000000000000000000e+00_rk, -9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        2.790110204533015161e-18_rk, 1.971687836487030498e-01_rk, 2.057165703969283385e-32_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.041283304203355185e-17_rk, 1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129704730e-02_rk, -2.813979797398210674e-18_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129695015e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487037715e-01_rk, 2.822248466917932362e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487036050e-01_rk, 7.798329568905750013e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -6.399576603592721513e-02_rk, 2.208718528794108926e-18_rk, -6.399576603592720125e-02_rk, &
                                        -9.449788301796387124e-02_rk, -8.834874115176435705e-18_rk, -3.526709006307394700e-01_rk, &
                                        -2.388354503153698183e-01_rk, 8.834874115176435705e-18_rk, -6.399576603592720125e-02_rk, &
                                        -3.526709006307395255e-01_rk, -3.533949646070574282e-17_rk, -3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.790110204533015161e-18_rk, 5.283121635129700566e-02_rk, 1.028582851984641693e-32_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.041283304203355185e-17_rk, 5.283121635129701260e-02_rk, 2.117670577615438843e-32_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        
        
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! zeta_min
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.308996938995754811e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.885243083284276366e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.507446726987261537e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.308996938995754811e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.449788301796385737e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -3.751618480637878283e-01_rk, -1.971687836487029943e-01_rk, -2.136319455030287202e-15_rk, &
                                        -5.539741552782135869e-01_rk, -5.283121635129722771e-02_rk, -3.182680004432876731e-15_rk, &
                                        -1.005243142196600437e-01_rk, -1.971687836487025780e-01_rk, -1.634938358441546262e-16_rk, &
                                        -1.484369275345114869e-01_rk, -5.283121635129679750e-02_rk, -3.487868498008631764e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.406116950135762211e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.982363094424282934e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.180615478545962438e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.138867744842990193e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.399576603592718738e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.526709006307394700e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.399576603592720125e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        3.751618480637878283e-01_rk, -5.283121635129658933e-02_rk, 1.188055207134190305e-15_rk, &
                                        5.539741552782135869e-01_rk, -1.971687836487029943e-01_rk, 1.656737536554100186e-15_rk, &
                                        1.005243142196600437e-01_rk, -5.283121635129679750e-02_rk, 7.629712339393881983e-17_rk, &
                                        1.484369275345114869e-01_rk, -1.971687836487032441e-01_rk, 2.397909592380934584e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.507446726987263619e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.308996938995754256e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.308996938995754811e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.885243083284271370e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.449788301796385737e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -1.005243142196600437e-01_rk, 1.971687836487025780e-01_rk, -1.852930139567085748e-16_rk, &
                                        -1.484369275345114592e-01_rk, 5.283121635129679750e-02_rk, -3.215378771601707345e-16_rk, &
                                        -3.751618480637878283e-01_rk, 1.971687836487029943e-01_rk, -2.267114523705610844e-15_rk, &
                                        -5.539741552782135869e-01_rk, 5.283121635129722771e-02_rk, -3.204479182545430605e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.180615478545962438e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.138867744842990193e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.406116950135762211e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.982363094424278493e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.399576603592720125e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.526709006307394700e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.399576603592718738e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        1.005243142196600437e-01_rk, 5.283121635129679750e-02_rk, 1.035460960346312616e-16_rk, &
                                        1.484369275345114592e-01_rk, 1.971687836487032441e-01_rk, 2.179917811255394852e-16_rk, &
                                        3.751618480637878283e-01_rk, 5.283121635129658933e-02_rk, 1.046360549402589529e-15_rk, &
                                        5.539741552782135869e-01_rk, 1.971687836487029943e-01_rk, 1.656737536554100186e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.814856169696940991e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.719671245021579409e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.907428084848470496e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.539753433766184557e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.539753433766184557e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.362448632034621783e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.719671245021579409e-17_rk  &
                                        /),(/3,4/))
        


        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! zeta_max
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.403069722661996477e-51_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.814856169696940991e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.403069722661996477e-51_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.719671245021579409e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.888894916580853780e-34_rk, 1.907428084848470496e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.539753433766184557e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.403069722661996477e-51_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 7.703719777548943412e-34_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.539753433766184557e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.403069722661996477e-51_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.888894916580853780e-34_rk, 1.362448632034621783e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.719671245021579409e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.311115933264683024e-32_rk, -1.308996938995744264e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, -4.885243083284259158e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, -3.507446726987251129e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.308996938995752868e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        6.629015400921027889e-18_rk, 4.904340331166843040e-34_rk, -2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.449788301796385737e-02_rk, &
                                        1.776239323290274043e-18_rk, 4.904340331166843040e-34_rk, -2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        3.751618480637878283e-01_rk, 1.971687836487029943e-01_rk, -2.092721098805179058e-15_rk, &
                                        5.539741552782135869e-01_rk, 5.283121635129722771e-02_rk, -3.160880826320322856e-15_rk, &
                                        1.005243142196600437e-01_rk, 1.971687836487025780e-01_rk, -2.070921920692625233e-16_rk, &
                                        1.484369275345114869e-01_rk, 5.283121635129679750e-02_rk, -3.487868498008631764e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.081668171172168020e-16_rk, 4.406116950135749999e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.982363094424268501e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.622231866529366047e-33_rk, 1.180615478545961466e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 2.138867744842988250e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -6.629015400921027889e-18_rk, 1.226085082791710760e-34_rk, -6.399576603592718738e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.526709006307394700e-01_rk, &
                                        -1.776239323290274043e-18_rk, 1.226085082791710760e-34_rk, -6.399576603592720125e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -3.751618480637878283e-01_rk, 5.283121635129658933e-02_rk, 1.057260138458866466e-15_rk, &
                                        -5.539741552782135869e-01_rk, 1.971687836487029943e-01_rk, 1.656737536554100186e-15_rk, &
                                        -1.005243142196600437e-01_rk, 5.283121635129679750e-02_rk, 1.035460960346312616e-16_rk, &
                                        -1.484369275345114869e-01_rk, 1.971687836487032441e-01_rk, 1.961926030129855367e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.081668171172168267e-16_rk, -3.507446726987251129e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.308996938995752868e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.311115933264683024e-32_rk, -1.308996938995744264e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, -4.885243083284255272e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.776239323290274043e-18_rk, -4.904340331166843040e-34_rk, 2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.449788301796385737e-02_rk, &
                                        6.629015400921027889e-18_rk, -4.904340331166843040e-34_rk, 2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        1.005243142196600437e-01_rk, -1.971687836487025780e-01_rk, -1.743934249004315882e-16_rk, &
                                        1.484369275345114592e-01_rk, -5.283121635129679750e-02_rk, -3.651362333852786316e-16_rk, &
                                        3.751618480637878283e-01_rk, -1.971687836487029943e-01_rk, -2.136319455030287202e-15_rk, &
                                        5.539741552782135869e-01_rk, -5.283121635129722771e-02_rk, -3.204479182545430605e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.622231866529366047e-33_rk, 1.180615478545961466e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.081668171172168513e-16_rk, 2.138867744842989083e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313574e-16_rk, 4.406116950135749999e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.982363094424261840e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.776239323290274043e-18_rk, -1.226085082791710760e-34_rk, 6.399576603592720125e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.526709006307394700e-01_rk, &
                                        -6.629015400921027889e-18_rk, -1.226085082791710760e-34_rk, 6.399576603592718738e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -1.005243142196600437e-01_rk, -5.283121635129679750e-02_rk, 7.357222612986957318e-17_rk, &
                                        -1.484369275345114592e-01_rk, -1.971687836487032441e-01_rk, 2.179917811255394852e-16_rk, &
                                        -3.751618480637878283e-01_rk, -5.283121635129658933e-02_rk, 1.100858494683974413e-15_rk, &
                                        -5.539741552782135869e-01_rk, -1.971687836487029943e-01_rk, 1.482344111653668598e-15_rk  &
                                        /),(/3,4/))
        
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do



    end subroutine testelement_face_dnormals_dx
    !*******************************************************************************************





!    !>  Test dmetric_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The dmetric_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_dmetric_dx_point(self)
!        class(test_element_linearD_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_dmetric_dx(:,:,:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [-1._rk/sqrt(3._rk),1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_dmetric_dx = self%elem%dmetric_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_dmetric_dx,self%elem%dmetric_dx(:,:,3,:,:),tol)
!
!
!    end subroutine testelement_dmetric_dx_point
!    !*******************************************************************************************







!    !>  Test djinv_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The djinv_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_djinv_dx_point(self)
!        class(test_element_linearD_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_djinv_dx(:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [1._rk/sqrt(3._rk),1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_djinv_dx = self%elem%djinv_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_djinv_dx,self%elem%djinv_dx(4,:,:),tol)
!
!
!    end subroutine testelement_djinv_dx_point
!    !*******************************************************************************************







!    !>  Test h_index
!    !!
!    !!  Fortran search the minimum x, y and z coordinate among all the support nodes.
!    !!  If multiple minimum are found, fortran returns the location of the first minimum starting 
!    !!  from the first minimum found (ie. first location in connectivity vector).
!    !!
!    !!  In this case, for instance for x direction, there exists 4 minima. However, the one stored
!    !!  for dX differentiation (needed for artificial viscosity) will be node 1, since it comes first
!    !!
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_h_index(self)
!        class(test_element_linearD_dx),    intent(inout)   :: self
!
!        integer(ik) :: x_min, x_max, y_min, y_max, z_min, z_max
!        
!        x_min = 1
!        x_max = 2
!        y_min = 1
!        y_max = 3
!        z_min = 1
!        z_max = 5
!
!
!        ! Test
!        @assertequal(x_min,self%elem%h_index(1,1))
!        @assertequal(x_max,self%elem%h_index(1,2))
!        @assertequal(y_min,self%elem%h_index(2,1))
!        @assertequal(y_max,self%elem%h_index(2,2))
!        @assertequal(z_min,self%elem%h_index(3,1))
!        @assertequal(z_max,self%elem%h_index(3,2))
!
!
!    end subroutine testelement_h_index
!    !*******************************************************************************************








!
!####################################################
!#
!#   PYTHON SCRIPT FOR TESTING ELEMENT DX INITIALIZATION
!#
!#       This requires PyTORCH. For installation refer to
!#       https://pytorch.org/get-started/locally/
!#
!####################################################
!
!
!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data_A = [[0., 0., 0.],
!                 [5., 0., 0.],
!                 [5., 1., 0.],
!                 [0., 1., 0.],
!                 [0., 0., 1.],
!                 [5., 0., 1.],
!                 [5., 1., 1.],
!                 [0., 1., 1.]]
!
!sqrt_two     = np.sqrt(2.)
!inv_sqrt_two = 1./sqrt_two
!coords_data_B = [[0., 0., 0.],
!                 [inv_sqrt_two,inv_sqrt_two, 0.],
!                 [0., sqrt_two, 0.],
!                 [-inv_sqrt_two,inv_sqrt_two, 0.],
!                 [0., 0., 1.],
!                 [inv_sqrt_two,inv_sqrt_two, 1.],
!                 [0., sqrt_two, 1.],
!                 [-inv_sqrt_two,inv_sqrt_two, 1.]]
!
!coords_data_C = [[0., 0., 0.],
!                 [inv_sqrt_two, 0., inv_sqrt_two],
!                 [sqrt_two, 0., 0.],
!                 [inv_sqrt_two, 0., -inv_sqrt_two],
!                 [0., 1., 0.],
!                 [inv_sqrt_two, 1., inv_sqrt_two],
!                 [sqrt_two, 1., 0. ],
!                 [inv_sqrt_two, 1., -inv_sqrt_two]]
!
!coords_data_D  = [[ 1.0, 0.0,       0.0],
!                  [ 2.0, 0.0,       0.0],
!                  [ 2.0, np.pi/2.0, 0.0],
!                  [ 1.0, np.pi/2.0, 0.0],
!                  [ 1.0, 0.0,       1.0],
!                  [ 2.0, 0.0,       1.0],
!                  [ 2.0, np.pi/2.0, 1.0],
!                  [ 1.0, np.pi/2.0, 1.0]]
!
!#coords_data = coords_data_A
!#coord_sys  = 'CARTESIAN'
!
!#coords_data = coords_data_B
!#coord_sys  = 'CARTESIAN'
!
!#coords_data = coords_data_C
!#coord_sys  = 'CARTESIAN'
!
!coords_data = coords_data_D
!coord_sys  = 'CYLINDRICAL'
!
!
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_elem  = 8 
!nnodes_face  = 4 
!nterms_s   = 8
!ndirs      = 3
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0]]
!
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)]]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0]]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0]]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0]]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!                ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_elem-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_elem):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_elem-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_elem, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_elem))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_elem*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_elem*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_elem))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!#            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            f.write("test_dmetric_dx(:,:,"+str(inode+1)+","+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!            for irow in range(0,3):
!                row = ''
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_elem*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    row = row + str(array[irow,icol])+'_rk'
!                    if ((icol == 2) and (irow == 2)):
!                        row = row + '   &\n'
!                    elif ((icol == 2) and (irow != 2)):
!                        row = row + "," +  "   &\n"
!                    else:
!                        row = row + ', '
!                    i += 1
!                f.write(row)
!            f.write("/),(/3,3/))\n")
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("test_dcoords_dx = reshape((/ &\n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!
!    row = ''
!    for idir in range(0,ndirs):
!        for inode_diff in range(0,nnodes_r):
!
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!
!            row = row + str(array[inode,index])+'_rk'
!            if ((index == ndirs*nnodes_r-1) and (inode == nnodes_r-1)):
!                row = row + '   &\n'
!            elif ((index == ndirs*nnodes_r-1) and (inode != nnodes_r-1)):
!                row = row + "," +  "   &\n"
!            else:
!                row = row + ', '
!            i += 1
!
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!    f.write(row)
!f.write("/),(/24,8/))\n")
!f.close()
!
!
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!
!    f.write("test_djinv_dx("+str(inode+1)+",:,:) = reshape((/ &\n")
!    array = np.zeros([nnodes_r,ndirs])
!#    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        row = ''
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_elem*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!
!                row = row + str(array[inode_diff,idir])+'_rk'
!                if ((idir == ndirs-1) and (inode_diff == nnodes_r-1)):
!                    row = row + '   &\n'
!                elif ((idir == ndirs-1) and (inode_diff != nnodes_r-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!
!        f.write(row)
!    f.write("/),(/3,8/))\n")
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dmass_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nterms_s-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nterms_s-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dinvmass_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nterms_s-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nterms_s-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!#
!# dbr2_vol_dx
!#
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face1_dx to file          ", i/(nnodes_r*ndirs*nnodes_elem*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dbr2_vol_face3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing ddbr2_vol_face3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face4_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face5_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_vol_face6_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,8/))\n")
!f.close()
!
!#
!# dbr2_face_dx
!#
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face4_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face5_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!
!        f.write("test_dbr2_face_face6_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            row = ''
!            for icol in range(0,nnodes_face):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file          ", i/(nnodes_face*nnodes_face*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nnodes_face-1) and (irow == nnodes_face-1)):
!                    row = row + '   &\n'
!                elif ((icol == nnodes_face-1) and (irow != nnodes_face-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/4,4/))\n")
!f.close()
!
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad1_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad2_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("test_dgrad3_dx(:,:,"+str(inode_diff+1)+","+str(idir+1)+") = reshape((/ &\n")
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            row = ''
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!
!                row = row + str(array[irow,icol])+'_rk'
!                if ((icol == nterms_s-1) and (irow == nnodes_elem-1)):
!                    row = row + '   &\n'
!                elif ((icol == nterms_s-1) and (irow != nnodes_elem-1)):
!                    row = row + "," +  "   &\n"
!                else:
!                    row = row + ', '
!                i += 1
!            f.write(row)
!        f.write("/),(/8,8/))\n")
!f.close()
!
!




end module test_element_linearD_cylindrical_dx_mod

module test_element_linearD_cylindrical_dx_mod
    use pfunit_mod
    use mod_kinds,                  only: rk,ik
    use mod_constants,              only: ZERO, ONE, TWO, THREE, FIVE, SIX, EIGHT, NINE, TEN, &
                                          XI_MIN, XI_MAX, ETA_MIN, ETA_MAX, ZETA_MIN, ZETA_MAX, PI
    use type_chidg,                 only: chidg_t
    use type_element,               only: element_t
    use type_face,                  only: face_t
    use type_element_connectivity,  only: element_connectivity_t
    use mod_io,                     only: gq_rule
    use type_point,                 only: point_t


    use mod_inv,                    only: inv
    implicit none

    public  :: test_element_linearD_dx


    !>
    !!
    !!  @author Matteo Ugolotti
    !!  @date   10/4/2018
    !!
    !!  This test is build based on test_element_linearD test case.
    !!  The standard initialization is not tested here but the dx initialization 
    !!  is verified.
    !!
    !!  Symbolic pyhton solution is used to check ChiDG matrices.
    !!  The python script is available at the end of this module.
    !!  The input matrices used in the test herein are given by the
    !!  python script
    !!
    !!
    !--------------------------------------------------------------------------
    @TestCase
    type, extends(TestCase) ::  test_element_linearD_dx

        type(chidg_t)               :: chidg
        type(element_t)             :: elem
        type(face_t),   allocatable :: faces(:)
        real(rk),       allocatable :: nodes(:,:)

    contains

        procedure   ::  setUp
        procedure   ::  tearDown

    end type test_element_linearD_dx
    !***************************************************************************


contains

    !> NOTE: make sure to use 'this' instead of 'self' since these are over-writting a 
    !! derived type procedure. The argument names have to match
    !!
    !!  @author Matteo Ugolotti
    !!
    !!
    !-----------------------------------------------------------------------------------------
    subroutine setUp(this)
        class(test_element_linearD_dx),    intent(inout)   :: this
        
        integer(ik), parameter          :: npt = 8
        real(rk)                        :: nodes(npt,3)
        integer(ik)                     :: ftype, ielem, idomain,                       &
                                           ntime, neqns, nterms_s,                      &
                                           ineighbor_domain_g,  ineighbor_domain_l,     &
                                           ineighbor_element_g, ineighbor_element_l,    &
                                           ineighbor_face, ineighbor_proc,              &
                                           ineighbor_neqns, ineighbor_nterms_s,         &
                                           ineighbor_nterms_c, ineighbor_nnodes_r
        

        ! Set collocation quadrature for testing coordinates at quadrature nodes
        gq_rule = 1
        
        
        call this%chidg%start_up('core')
        allocate(this%faces(6))
        
        ! !( r = 1-2  ::  theta = 0-pi/2  ::  z = 0-1 )
        !
        ! ( theta = 0-pi/2  ::  r = 1-2  ::  z = 0-1 )
        !           
        !                           theta
        !                           ---_
        !                               >
        !          _-------_ _------_
        !        _-         -_       -_
        !       -             -        -
        !      *              *--------*     ^ r
        !       \   _----_   /        /     /  
        !        \ -      - /        /     /
        !         *        *--------*
        !
        !                    ----> z
        !
        nodes(1,:) = [1._rk, 0._rk,  0._rk]
        nodes(2,:) = [2._rk, 0._rk,  0._rk]
        nodes(3,:) = [1._rk, PI/TWO, 0._rk]
        nodes(4,:) = [2._rk, PI/TWO, 0._rk]
        nodes(5,:) = [1._rk, 0._rk,  1._rk]
        nodes(6,:) = [2._rk, 0._rk,  1._rk]
        nodes(7,:) = [1._rk, PI/TWO, 1._rk]
        nodes(8,:) = [2._rk, PI/TWO, 1._rk]
        this%nodes = nodes

        
        !
        ! Initialize Element geometry and Numerics
        !
        idomain  = 1
        ielem    = 1
        neqns    = 2
        nterms_s = 8
        ntime    = 1
        call this%elem%init_geom(nodes        = nodes,                          &
                                 connectivity = [1, 2, 3, 4, 5, 6, 7, 8],       &
                                 etype        = 1,                              &
                                 location     = [idomain,idomain,ielem,ielem],  &
                                 coord_system = 'Cylindrical')
        call this%elem%init_sol('Quadrature',1,nterms_s,neqns,ntime)
        call this%elem%update_interpolations_dx()
        
        
        !
        ! Initialize face geometries
        !
        call this%faces(XI_MIN)%init_geom(XI_MIN,this%elem)
        call this%faces(XI_MAX)%init_geom(XI_MAX,this%elem)
        call this%faces(ETA_MIN)%init_geom(ETA_MIN,this%elem)
        call this%faces(ETA_MAX)%init_geom(ETA_MAX,this%elem)
        call this%faces(ZETA_MIN)%init_geom(ZETA_MIN,this%elem)
        call this%faces(ZETA_MAX)%init_geom(ZETA_MAX,this%elem)


        !
        ! Initialize face neighbors
        !
        ftype = 0
        ineighbor_domain_g  = 0
        ineighbor_domain_l  = 0
        ineighbor_element_g = 0
        ineighbor_element_l = 0
        ineighbor_face      = 0
        ineighbor_neqns     = 2
        ineighbor_nterms_s  = 8
        ineighbor_nterms_c  = 8
        ineighbor_nnodes_r  = 8
        ineighbor_proc      = 0
        call this%faces(XI_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,      &
                                                   ineighbor_element_g,ineighbor_element_l,    &
                                                   ineighbor_face,ineighbor_neqns,             &
                                                   ineighbor_nterms_s,ineighbor_nterms_c,      &
                                                   ineighbor_nnodes_r,ineighbor_proc)
        call this%faces(XI_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,      &
                                                   ineighbor_element_g,ineighbor_element_l,    &
                                                   ineighbor_face,ineighbor_neqns,             &
                                                   ineighbor_nterms_s,ineighbor_nterms_c,      &
                                                   ineighbor_nnodes_r,ineighbor_proc)
        call this%faces(ETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,     &
                                                    ineighbor_element_g,ineighbor_element_l,   &
                                                    ineighbor_face,ineighbor_neqns,            &
                                                    ineighbor_nterms_s,ineighbor_nterms_c,      &
                                                    ineighbor_nnodes_r,ineighbor_proc)
        call this%faces(ETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,     &
                                                    ineighbor_element_g,ineighbor_element_l,   &
                                                    ineighbor_face,ineighbor_neqns,            &
                                                    ineighbor_nterms_s,ineighbor_nterms_c,      &
                                                    ineighbor_nnodes_r,ineighbor_proc)
        call this%faces(ZETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,    &
                                                     ineighbor_element_g,ineighbor_element_l,  &
                                                     ineighbor_face,ineighbor_neqns,           &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,      &
                                                     ineighbor_nnodes_r,ineighbor_proc)
        call this%faces(ZETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,    &
                                                     ineighbor_element_g,ineighbor_element_l,  &
                                                     ineighbor_face,ineighbor_neqns,           &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,      &
                                                     ineighbor_nnodes_r,ineighbor_proc)

        
        call this%faces(XI_MIN)%init_sol(this%elem)
        call this%faces(XI_MAX)%init_sol(this%elem)
        call this%faces(ETA_MIN)%init_sol(this%elem)
        call this%faces(ETA_MAX)%init_sol(this%elem)
        call this%faces(ZETA_MIN)%init_sol(this%elem)
        call this%faces(ZETA_MAX)%init_sol(this%elem)

        !
        ! Update dx interpolators
        !
        call this%faces(XI_MIN)%update_interpolations_dx(this%elem)
        call this%faces(XI_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MAX)%update_interpolations_dx(this%elem)        


    end subroutine setUp
    !************************************************************************************
    

    !>
    !!
    !!
    !-------------------------------------------------------------------------------------
    subroutine tearDown(this)
        class(test_element_linearD_dx),    intent(inout)   :: this


        !
        ! Close ChiDG interface
        !
        call this%chidg%shut_down('core')

    end subroutine tearDown
    !**************************************************************************************



    
    
    !> Test element djinv_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_djinv_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self

        integer(ik) :: inode, inode_diff, idir, irow
        real(rk)    :: test_djinv_dx(8,3,8), test_djinv_dx_trans(8,3)


        
        test_djinv_dx(1,:,:) = reshape((/                                                                                 &
                                        -5.161866685233332946e-02_rk, -9.418179046174338098e-02_rk, -1.479404105082731125e-01_rk,  &
                                        1.737497439344400096e-01_rk, -2.523593469594135469e-02_rk, -3.964051352362057967e-02_rk,  &
                                        -1.383118009745386984e-02_rk, 9.418179046174338098e-02_rk, -3.964051352362055192e-02_rk,  &
                                        4.655610357234744867e-02_rk, 2.523593469594135122e-02_rk, -1.062164358620912644e-02_rk,  &
                                        -1.383118009745386984e-02_rk, -2.523593469594135122e-02_rk, 1.479404105082731402e-01_rk,  &
                                        4.655610357234744867e-02_rk, -6.761948322022030833e-03_rk, 3.964051352362055192e-02_rk,  &
                                        -3.706053537482187181e-03_rk, 2.523593469594135122e-02_rk, 3.964051352362055886e-02_rk,  &
                                        1.247467035495021526e-02_rk, 6.761948322022029965e-03_rk, 1.062164358620911776e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(2,:,:) = reshape((/                                                                                 &
                                        -1.926434873118799684e-01_rk, -3.726406530405853429e-02_rk, -5.853425690106030949e-02_rk,  &
                                        3.147745643939866556e-01_rk, -1.390713850113110550e-01_rk, -2.184528207380462550e-01_rk,  &
                                        -5.161866685233330865e-02_rk, 3.726406530405853429e-02_rk, -1.568420686619497254e-02_rk,  &
                                        8.434359032722688054e-02_rk, 1.390713850113110550e-01_rk, -5.853425690106029561e-02_rk,  &
                                        -5.161866685233330865e-02_rk, -9.984876204923097756e-03_rk, 5.853425690106029561e-02_rk,  &
                                        8.434359032722688054e-02_rk, -3.726406530405853429e-02_rk, 2.184528207380462550e-01_rk,  &
                                        -1.383118009745385943e-02_rk, 9.984876204923097756e-03_rk, 1.568420686619496907e-02_rk,  &
                                        2.259979691492188664e-02_rk, 3.726406530405853429e-02_rk, 5.853425690106029561e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(3,:,:) = reshape((/                                                                                 &
                                        -1.383118009745386984e-02_rk, -9.418179046174338098e-02_rk, -3.964051352362057273e-02_rk,  &
                                        4.655610357234744867e-02_rk, -2.523593469594135122e-02_rk, -1.062164358620911429e-02_rk,  &
                                        -5.161866685233332946e-02_rk, 9.418179046174338098e-02_rk, -1.479404105082731680e-01_rk,  &
                                        1.737497439344400096e-01_rk, 2.523593469594134775e-02_rk, -3.964051352362053110e-02_rk,  &
                                        -3.706053537482187181e-03_rk, -2.523593469594135122e-02_rk, 3.964051352362055886e-02_rk,  &
                                        1.247467035495021526e-02_rk, -6.761948322022029965e-03_rk, 1.062164358620912123e-02_rk,  &
                                        -1.383118009745386984e-02_rk, 2.523593469594135122e-02_rk, 1.479404105082731402e-01_rk,  &
                                        4.655610357234744867e-02_rk, 6.761948322022029098e-03_rk, 3.964051352362056579e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(4,:,:) = reshape((/                                                                                 &
                                        -5.161866685233330865e-02_rk, -3.726406530405853429e-02_rk, -1.568420686619496560e-02_rk,  &
                                        8.434359032722688054e-02_rk, -1.390713850113110550e-01_rk, -5.853425690106029561e-02_rk,  &
                                        -1.926434873118800239e-01_rk, 3.726406530405853429e-02_rk, -5.853425690106029561e-02_rk,  &
                                        3.147745643939867111e-01_rk, 1.390713850113110550e-01_rk, -2.184528207380462550e-01_rk,  &
                                        -1.383118009745385596e-02_rk, -9.984876204923094287e-03_rk, 1.568420686619496560e-02_rk,  &
                                        2.259979691492188317e-02_rk, -3.726406530405853429e-02_rk, 5.853425690106029561e-02_rk,  &
                                        -5.161866685233330865e-02_rk, 9.984876204923094287e-03_rk, 5.853425690106029561e-02_rk,  &
                                        8.434359032722688054e-02_rk, 3.726406530405853429e-02_rk, 2.184528207380462550e-01_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(5,:,:) = reshape((/                                                                                 &
                                        -1.383118009745386984e-02_rk, -2.523593469594135816e-02_rk, -1.479404105082731680e-01_rk,  &
                                        4.655610357234744867e-02_rk, -6.761948322022033435e-03_rk, -3.964051352362057273e-02_rk,  &
                                        -3.706053537482187181e-03_rk, 2.523593469594135469e-02_rk, -3.964051352362056579e-02_rk,  &
                                        1.247467035495021526e-02_rk, 6.761948322022030833e-03_rk, -1.062164358620912297e-02_rk,  &
                                        -5.161866685233332946e-02_rk, -9.418179046174340874e-02_rk, 1.479404105082731957e-01_rk,  &
                                        1.737497439344400096e-01_rk, -2.523593469594136163e-02_rk, 3.964051352362054498e-02_rk,  &
                                        -1.383118009745386984e-02_rk, 9.418179046174340874e-02_rk, 3.964051352362057273e-02_rk,  &
                                        4.655610357234744867e-02_rk, 2.523593469594135469e-02_rk, 1.062164358620911429e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(6,:,:) = reshape((/                                                                                 &
                                        -5.161866685233330865e-02_rk, -9.984876204923097756e-03_rk, -5.853425690106029561e-02_rk,  &
                                        8.434359032722688054e-02_rk, -3.726406530405853429e-02_rk, -2.184528207380462550e-01_rk,  &
                                        -1.383118009745385596e-02_rk, 9.984876204923097756e-03_rk, -1.568420686619496560e-02_rk,  &
                                        2.259979691492188317e-02_rk, 3.726406530405853429e-02_rk, -5.853425690106029561e-02_rk,  &
                                        -1.926434873118800239e-01_rk, -3.726406530405853429e-02_rk, 5.853425690106028867e-02_rk,  &
                                        3.147745643939867111e-01_rk, -1.390713850113110550e-01_rk, 2.184528207380462550e-01_rk,  &
                                        -5.161866685233330865e-02_rk, 3.726406530405853429e-02_rk, 1.568420686619496213e-02_rk,  &
                                        8.434359032722688054e-02_rk, 1.390713850113110550e-01_rk, 5.853425690106029561e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(7,:,:) = reshape((/                                                                                 &
                                        -3.706053537482187181e-03_rk, -2.523593469594135469e-02_rk, -3.964051352362057273e-02_rk,  &
                                        1.247467035495021526e-02_rk, -6.761948322022030833e-03_rk, -1.062164358620911950e-02_rk,  &
                                        -1.383118009745387504e-02_rk, 2.523593469594135122e-02_rk, -1.479404105082731680e-01_rk,  &
                                        4.655610357234744867e-02_rk, 6.761948322022028231e-03_rk, -3.964051352362055886e-02_rk,  &
                                        -1.383118009745387504e-02_rk, -9.418179046174340874e-02_rk, 3.964051352362055192e-02_rk,  &
                                        4.655610357234744867e-02_rk, -2.523593469594135469e-02_rk, 1.062164358620912644e-02_rk,  &
                                        -5.161866685233332946e-02_rk, 9.418179046174340874e-02_rk, 1.479404105082731680e-01_rk,  &
                                        1.737497439344400096e-01_rk, 2.523593469594134775e-02_rk, 3.964051352362059355e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(8,:,:) = reshape((/                                                                                 &
                                        -1.383118009745385249e-02_rk, -9.984876204923096021e-03_rk, -1.568420686619496560e-02_rk,  &
                                        2.259979691492187970e-02_rk, -3.726406530405853429e-02_rk, -5.853425690106029561e-02_rk,  &
                                        -5.161866685233330865e-02_rk, 9.984876204923096021e-03_rk, -5.853425690106029561e-02_rk,  &
                                        8.434359032722688054e-02_rk, 3.726406530405853429e-02_rk, -2.184528207380462550e-01_rk,  &
                                        -5.161866685233330865e-02_rk, -3.726406530405853429e-02_rk, 1.568420686619496560e-02_rk,  &
                                        8.434359032722688054e-02_rk, -1.390713850113110550e-01_rk, 5.853425690106029561e-02_rk,  &
                                        -1.926434873118800239e-01_rk, 3.726406530405853429e-02_rk, 5.853425690106029561e-02_rk,  &
                                        3.147745643939866556e-01_rk, 1.390713850113110550e-01_rk, 2.184528207380462550e-01_rk  &
                                        /),(/3,8/))
        


        do inode = 1,self%elem%basis_s%nnodes_ie()
            @assertEqual(transpose(test_djinv_dx(inode,:,:)),self%elem%djinv_dx(inode,:,:), 1.e-14_rk)
        end do
        
    end subroutine testElement_djinv_dx
    !***************************************************************************************





    !> Test element dmetric_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmetric_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self

        real(rk)    :: test_metric(3,3,self%elem%basis_s%nnodes_ie())
        real(rk)    :: test_dmetric_dx(3,3,8,8,3), test_dmetric_dx_trans(3,3)
        integer(ik) :: inode, inode_diff, idir, irow
        


        
        test_dmetric_dx(:,:,1,1,1) = reshape((/                                                                                 &
                                        1.244016935856293582e+00_rk, 6.538013056153503255e-01_rk, 1.244016935856292694e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.256800528336969758e-01_rk, -4.622231866529366047e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.582909170278294293e-18_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,1,2) = reshape((/                                                                                 &
                                        2.827159716856459426e-16_rk, -1.732875669434886039e-17_rk, -3.297219907631359643e-17_rk, &
                                        7.919657785262492755e-01_rk, 4.162228383544717691e-01_rk, 7.919657785262489424e-01_rk, &
                                        -5.495366512718934792e-18_rk, -2.888126115724808652e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.980647366582074656e-17_rk, -1.899062337165529150e-16_rk, &
                                        -8.632101532570583546e-18_rk, 0.000000000000000000e+00_rk, -8.632101532570585087e-18_rk, &
                                        1.244016935856292916e+00_rk, 6.538013056153504365e-01_rk, 1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,1) = reshape((/                                                                                 &
                                        -1.244016935856295580e+00_rk, 1.751855318500468162e-01_rk, 3.333333333333335924e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908275908e-01_rk, 3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.186624570596775550e-16_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, -4.643226362086187611e-18_rk, -8.834874115176443409e-18_rk, &
                                        -7.919657785262492755e-01_rk, 1.115265734084704419e-01_rk, 2.122065907891939607e-01_rk, &
                                        5.495366512718934792e-18_rk, -7.738710603476976462e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, -2.674306401815479836e-17_rk, -5.088522196198639485e-17_rk, &
                                        8.632101532570583546e-18_rk, 3.533949646070574282e-17_rk, -2.312964634635745360e-18_rk, &
                                        -1.244016935856292916e+00_rk, 1.751855318500468717e-01_rk, 3.333333333333335369e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,1) = reshape((/                                                                                 &
                                        3.333333333333331483e-01_rk, -6.538013056153503255e-01_rk, 3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268830e-01_rk, 3.851859888774471706e-34_rk, &
                                        0.000000000000000000e+00_rk, 1.162728673908075650e-16_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,2) = reshape((/                                                                                 &
                                        -2.827159716856459426e-16_rk, 1.732875669434886039e-17_rk, -8.834874115176435705e-18_rk, &
                                        2.122065907891938774e-01_rk, -4.162228383544717691e-01_rk, 2.122065907891937664e-01_rk, &
                                        -1.472479019196073388e-18_rk, 2.888126115724808652e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 9.980647366582082052e-17_rk, -5.088522196198637020e-17_rk, &
                                        -2.312964634635744590e-18_rk, 0.000000000000000000e+00_rk, -2.312964634635744205e-18_rk, &
                                        3.333333333333334259e-01_rk, -6.538013056153508806e-01_rk, 3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,1) = reshape((/                                                                                 &
                                        -3.333333333333333148e-01_rk, -1.751855318500467884e-01_rk, 8.931639747704091248e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 1.427663435940977770e-18_rk, -3.330669073875469621e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 4.643226362086186070e-18_rk, -2.367297384392164111e-18_rk, &
                                        -2.122065907891938774e-01_rk, -1.115265734084704141e-01_rk, 5.686058463052619250e-02_rk, &
                                        1.472479019196073388e-18_rk, 7.738710603476975499e-19_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,3) = reshape((/                                                                                 &
                                        6.938893903907228378e-17_rk, 2.674306401815477679e-17_rk, -1.363465413139272444e-17_rk, &
                                        2.312964634635744590e-18_rk, -8.834874115176435705e-18_rk, -6.197570059723965479e-19_rk, &
                                        -3.333333333333334259e-01_rk, -1.751855318500467329e-01_rk, 8.931639747704124555e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,1) = reshape((/                                                                                 &
                                        3.333333333333331483e-01_rk, 1.751855318500467606e-01_rk, -1.244016935856292916e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268830e-01_rk, 3.851859888774471706e-34_rk, &
                                        0.000000000000000000e+00_rk, -4.241392338678871468e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, -4.643226362086186070e-18_rk, 3.297219907631362108e-17_rk, &
                                        2.122065907891938774e-01_rk, 1.115265734084704141e-01_rk, -7.919657785262490535e-01_rk, &
                                        -1.472479019196073388e-18_rk, -7.738710603476975499e-19_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.674306401815478604e-17_rk, 1.899062337165529397e-16_rk, &
                                        -2.312964634635744590e-18_rk, -1.413579858428229713e-16_rk, 8.632101532570588168e-18_rk, &
                                        3.333333333333334259e-01_rk, 1.751855318500467329e-01_rk, -1.244016935856293582e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,1) = reshape((/                                                                                 &
                                        -3.333333333333330928e-01_rk, 4.694082178483673790e-02_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.957272925695767510e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,2) = reshape((/                                                                                 &
                                        1.766974823035287141e-17_rk, -1.244148753995893328e-18_rk, 8.834874115176438787e-18_rk, &
                                        -2.122065907891938774e-01_rk, 2.988345527940996019e-02_rk, -2.122065907891937664e-01_rk, &
                                        1.472479019196073388e-18_rk, -2.073581256659821010e-19_rk, -8.834874115176435705e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -7.165782406798409905e-18_rk, 5.088522196198637020e-17_rk, &
                                        2.312964634635744590e-18_rk, 0.000000000000000000e+00_rk, 2.312964634635744205e-18_rk, &
                                        -3.333333333333334259e-01_rk, 4.694082178483689749e-02_rk, -3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,1) = reshape((/                                                                                 &
                                        8.931639747704095411e-02_rk, -1.751855318500467606e-01_rk, -3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960998738e-02_rk, -8.666684749742561339e-34_rk, &
                                        0.000000000000000000e+00_rk, 1.709742963317297531e-18_rk, 1.387778780781445676e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 4.643226362086186070e-18_rk, 8.834874115176431083e-18_rk, &
                                        5.686058463052618556e-02_rk, -1.115265734084704141e-01_rk, -2.122065907891937941e-01_rk, &
                                        -3.945495640653592407e-19_rk, 7.738710603476975499e-19_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 2.674306401815482610e-17_rk, 5.088522196198643799e-17_rk, &
                                        -6.197570059723940442e-19_rk, 0.000000000000000000e+00_rk, 2.312964634635747286e-18_rk, &
                                        8.931639747704085697e-02_rk, -1.751855318500470104e-01_rk, -3.333333333333338699e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,1) = reshape((/                                                                                 &
                                        -8.931639747704089860e-02_rk, -4.694082178483672402e-02_rk, -8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.189184527613378728e-03_rk, 9.629649721936179265e-34_rk, &
                                        0.000000000000000000e+00_rk, 3.825412647238274223e-19_rk, -1.665334536937734811e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,2) = reshape((/                                                                                 &
                                        -1.766974823035287141e-17_rk, 1.244148753995892943e-18_rk, 2.367297384392155637e-18_rk, &
                                        -5.686058463052618556e-02_rk, -2.988345527940995325e-02_rk, -5.686058463052615780e-02_rk, &
                                        3.945495640653592407e-19_rk, 2.073581256659820528e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.165782406798391416e-18_rk, 1.363465413139268746e-17_rk, &
                                        6.197570059723940442e-19_rk, 8.834874115176435705e-18_rk, 6.197570059723948145e-19_rk, &
                                        -8.931639747704085697e-02_rk, -4.694082178483677259e-02_rk, -8.931639747704096799e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,1) = reshape((/                                                                                 &
                                        1.244016935856296691e+00_rk, 1.186389784734526165e-01_rk, 3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522232978e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.902943531154130220e-17_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        7.919657785262493865e-01_rk, 7.552791946969178438e-02_rk, 2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 6.585786275961759262e-18_rk, 1.850371707708592282e-17_rk, &
                                        0.000000000000000000e+00_rk, -3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.244016935856292916e+00_rk, 1.186389784734523528e-01_rk, 3.333333333333328152e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,1) = reshape((/                                                                                 &
                                        -1.244016935856297357e+00_rk, 4.427666954209955041e-01_rk, 1.244016935856292694e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.952277841578875517e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,2) = reshape((/                                                                                 &
                                        2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk, -7.846944529866948863e-33_rk, &
                                        -7.919657785262493865e-01_rk, 2.818740328508603787e-01_rk, 7.919657785262492755e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.457848898967916927e-17_rk, 6.905681226056468069e-17_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.244016935856292916e+00_rk, 4.427666954209956707e-01_rk, 1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,1) = reshape((/                                                                                 &
                                        3.333333333333333148e-01_rk, -1.186389784734526165e-01_rk, 8.931639747704091248e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.122065907891938774e-01_rk, -7.552791946969178438e-02_rk, 5.686058463052618556e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, -6.585786275961773129e-18_rk, 4.958056047779128472e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.333333333333334259e-01_rk, -1.186389784734526026e-01_rk, 8.931639747704042676e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,1) = reshape((/                                                                                 &
                                        -3.333333333333332038e-01_rk, -4.427666954209955041e-01_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.149910516502697136e-17_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,2) = reshape((/                                                                                 &
                                        -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk, 7.846944529866948863e-33_rk, &
                                        -2.122065907891938774e-01_rk, -2.818740328508603787e-01_rk, 2.122065907891938497e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, -2.457848898967916619e-17_rk, 1.850371707708595364e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -3.333333333333334259e-01_rk, -4.427666954209956152e-01_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,1) = reshape((/                                                                                 &
                                        3.333333333333334259e-01_rk, 3.178921847281495489e-02_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.469669853485665694e-18_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,2) = reshape((/                                                                                 &
                                        5.300924469105861115e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.122065907891938774e-01_rk, 2.023764502790677267e-02_rk, -2.122065907891938497e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 1.764656114167919394e-18_rk, -1.850371707708595364e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        3.333333333333334259e-01_rk, 3.178921847281482999e-02_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,1) = reshape((/                                                                                 &
                                        -3.333333333333332038e-01_rk, 1.186389784734526165e-01_rk, -1.244016935856292916e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.122065907891938774e-01_rk, 7.552791946969178438e-02_rk, -7.919657785262492755e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.585786275961773129e-18_rk, -6.905681226056468069e-17_rk, &
                                        0.000000000000000000e+00_rk, 7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -3.333333333333334259e-01_rk, 1.186389784734526026e-01_rk, -1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,1) = reshape((/                                                                                 &
                                        8.931639747704088472e-02_rk, -3.178921847281495489e-02_rk, -8.931639747704087084e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.755769946802310112e-03_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,2) = reshape((/                                                                                 &
                                        -5.300924469105861115e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.686058463052618556e-02_rk, -2.023764502790677267e-02_rk, -5.686058463052617862e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -1.764656114167928639e-18_rk, -4.958056047779157746e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.931639747704088472e-02_rk, -3.178921847281499652e-02_rk, -8.931639747704096799e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,1) = reshape((/                                                                                 &
                                        -8.931639747704081533e-02_rk, -1.186389784734526165e-01_rk, -3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300627425e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.234834926742832847e-18_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.686058463052618556e-02_rk, -7.552791946969178438e-02_rk, -2.122065907891938497e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -6.585786275961768506e-18_rk, -1.850371707708594439e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -8.931639747704088472e-02_rk, -1.186389784734525193e-01_rk, -3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,1) = reshape((/                                                                                 &
                                        3.333333333333331483e-01_rk, 6.538013056153503255e-01_rk, 3.333333333333335369e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268830e-01_rk, -1.540743955509788682e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.171211458585433397e-16_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,2) = reshape((/                                                                                 &
                                        2.827159716856459426e-16_rk, -1.732875669434886039e-17_rk, -8.834874115176418757e-18_rk, &
                                        2.122065907891938774e-01_rk, 4.162228383544717691e-01_rk, 2.122065907891938774e-01_rk, &
                                        -1.472479019196073388e-18_rk, -2.888126115724808652e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.088797894536227167e-16_rk, 5.551115123125786400e-17_rk, &
                                        9.251858538542978360e-18_rk, 3.533949646070574282e-17_rk, 9.251858538542975279e-18_rk, &
                                        3.333333333333334259e-01_rk, 6.538013056153507696e-01_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,1) = reshape((/                                                                                 &
                                        -3.333333333333333148e-01_rk, 1.751855318500467329e-01_rk, 8.931639747704081533e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, 1.427663435940977770e-18_rk, -3.330669073875469621e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, -4.643226362086186070e-18_rk, -2.367297384392152556e-18_rk, &
                                        -2.122065907891938774e-01_rk, 1.115265734084704141e-01_rk, 5.686058463052613698e-02_rk, &
                                        1.472479019196073388e-18_rk, -7.738710603476975499e-19_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,3) = reshape((/                                                                                 &
                                        -4.163336342344337027e-17_rk, 2.917425165616885077e-17_rk, 1.487416814333752177e-17_rk, &
                                        -9.251858538542978360e-18_rk, 8.834874115176435705e-18_rk, 2.479028023889587347e-18_rk, &
                                        -3.333333333333334259e-01_rk, 1.751855318500466774e-01_rk, 8.931639747704125942e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,1) = reshape((/                                                                                 &
                                        1.244016935856293582e+00_rk, -6.538013056153503255e-01_rk, 1.244016935856293138e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.256800528336969758e-01_rk, 1.848892746611746419e-32_rk, &
                                        0.000000000000000000e+00_rk, -1.582909170278294293e-18_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,2) = reshape((/                                                                                 &
                                        -2.827159716856459426e-16_rk, 1.732875669434886039e-17_rk, -3.297219907631362724e-17_rk, &
                                        7.919657785262492755e-01_rk, -4.162228383544717691e-01_rk, 7.919657785262492755e-01_rk, &
                                        -5.495366512718934792e-18_rk, 2.888126115724808652e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, -1.088797894536226674e-16_rk, 2.071704367816940914e-16_rk, &
                                        3.452840613028233418e-17_rk, 0.000000000000000000e+00_rk, 3.452840613028234035e-17_rk, &
                                        1.244016935856292916e+00_rk, -6.538013056153504365e-01_rk, 1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,1) = reshape((/                                                                                 &
                                        -1.244016935856295580e+00_rk, -1.751855318500466774e-01_rk, 3.333333333333332038e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908275908e-01_rk, -1.232595164407830946e-32_rk, &
                                        0.000000000000000000e+00_rk, 1.183783376466944206e-16_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 4.643226362086186070e-18_rk, -8.834874115176431083e-18_rk, &
                                        -7.919657785262492755e-01_rk, -1.115265734084704141e-01_rk, 2.122065907891936554e-01_rk, &
                                        5.495366512718934792e-18_rk, 7.738710603476975499e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,3) = reshape((/                                                                                 &
                                        -1.665334536937734811e-16_rk, -2.917425165616887542e-17_rk, 5.551115123125791330e-17_rk, &
                                        -3.452840613028233418e-17_rk, 0.000000000000000000e+00_rk, 9.251858538542984523e-18_rk, &
                                        -1.244016935856292916e+00_rk, -1.751855318500468717e-01_rk, 3.333333333333337034e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,1) = reshape((/                                                                                 &
                                        8.931639747704094023e-02_rk, 1.751855318500467606e-01_rk, -3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960997003e-02_rk, 2.696301922142130194e-33_rk, &
                                        0.000000000000000000e+00_rk, -3.760429222214364107e-18_rk, 9.714451465470119729e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, -4.643226362086186070e-18_rk, 8.834874115176446491e-18_rk, &
                                        5.686058463052618556e-02_rk, 1.115265734084704141e-01_rk, -2.122065907891937941e-01_rk, &
                                        -3.945495640653592407e-19_rk, -7.738710603476975499e-19_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 2.917425165616890007e-17_rk, -5.551115123125793795e-17_rk, &
                                        2.479028023889576177e-18_rk, 0.000000000000000000e+00_rk, -9.251858538542989146e-18_rk, &
                                        8.931639747704085697e-02_rk, 1.751855318500470104e-01_rk, -3.333333333333338699e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,1) = reshape((/                                                                                 &
                                        -8.931639747704089860e-02_rk, 4.694082178483671708e-02_rk, -8.931639747704085697e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.189184527613378728e-03_rk, -3.851859888774471706e-33_rk, &
                                        0.000000000000000000e+00_rk, 3.825412647238274223e-19_rk, -1.665334536937734811e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,2) = reshape((/                                                                                 &
                                        1.766974823035287141e-17_rk, -1.244148753995892943e-18_rk, 2.367297384392155637e-18_rk, &
                                        -5.686058463052618556e-02_rk, 2.988345527940995325e-02_rk, -5.686058463052617862e-02_rk, &
                                        3.945495640653592407e-19_rk, -2.073581256659820528e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 7.817217171052789655e-18_rk, -1.487416814333747863e-17_rk, &
                                        -2.479028023889576177e-18_rk, 8.834874115176435705e-18_rk, -2.479028023889579258e-18_rk, &
                                        -8.931639747704085697e-02_rk, 4.694082178483677259e-02_rk, -8.931639747704096799e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,1) = reshape((/                                                                                 &
                                        3.333333333333331483e-01_rk, -1.751855318500467606e-01_rk, -1.244016935856292916e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268830e-01_rk, -1.540743955509788682e-33_rk, &
                                        0.000000000000000000e+00_rk, -4.241392338678871468e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 4.643226362086186070e-18_rk, 3.297219907631359643e-17_rk, &
                                        2.122065907891938774e-01_rk, -1.115265734084704141e-01_rk, -7.919657785262490535e-01_rk, &
                                        -1.472479019196073388e-18_rk, 7.738710603476975499e-19_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.917425165616884461e-17_rk, -2.071704367816941653e-16_rk, &
                                        9.251858538542978360e-18_rk, -1.413579858428229713e-16_rk, -3.452840613028235267e-17_rk, &
                                        3.333333333333334259e-01_rk, -1.751855318500466774e-01_rk, -1.244016935856293582e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,1) = reshape((/                                                                                 &
                                        -3.333333333333330928e-01_rk, -4.694082178483671014e-02_rk, -3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.427663435940976807e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,2) = reshape((/                                                                                 &
                                        -1.766974823035287141e-17_rk, 1.244148753995892365e-18_rk, 8.834874115176440328e-18_rk, &
                                        -2.122065907891938774e-01_rk, -2.988345527940995325e-02_rk, -2.122065907891938497e-01_rk, &
                                        1.472479019196073388e-18_rk, 2.073581256659820528e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.817217171052811226e-18_rk, -5.551115123125785167e-17_rk, &
                                        -9.251858538542978360e-18_rk, 0.000000000000000000e+00_rk, -9.251858538542973738e-18_rk, &
                                        -3.333333333333334259e-01_rk, -4.694082178483689749e-02_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,1) = reshape((/                                                                                 &
                                        3.333333333333331483e-01_rk, 1.186389784734526720e-01_rk, 8.931639747704088472e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300655701e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.330669073875469621e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.122065907891938774e-01_rk, 7.552791946969179826e-02_rk, 5.686058463052617862e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.333333333333334814e-01_rk, 1.186389784734526442e-01_rk, 8.931639747704052390e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,1) = reshape((/                                                                                 &
                                        -3.333333333333330928e-01_rk, 4.427666954209956707e-01_rk, 3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.902943531154132685e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.122065907891938774e-01_rk, 2.818740328508603787e-01_rk, 2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -3.333333333333334814e-01_rk, 4.427666954209957262e-01_rk, 3.333333333333334814e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,1) = reshape((/                                                                                 &
                                        1.244016935856295358e+00_rk, -1.186389784734526720e-01_rk, 3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522204529e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.902943531154132685e-17_rk, 1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        7.919657785262493865e-01_rk, -7.552791946969179826e-02_rk, 2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.244016935856293360e+00_rk, -1.186389784734524083e-01_rk, 3.333333333333328152e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,1) = reshape((/                                                                                 &
                                        -1.244016935856296469e+00_rk, -4.427666954209956707e-01_rk, 1.244016935856293360e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.952277841578872741e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -7.919657785262493865e-01_rk, -2.818740328508603787e-01_rk, 7.919657785262494976e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.244016935856293360e+00_rk, -4.427666954209957262e-01_rk, 1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,1) = reshape((/                                                                                 &
                                        8.931639747704081533e-02_rk, 3.178921847281496182e-02_rk, -8.931639747704088472e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.755769946802327893e-03_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.387778780781445676e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.686058463052617862e-02_rk, 2.023764502790677267e-02_rk, -5.686058463052617862e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.931639747704088472e-02_rk, 3.178921847281499652e-02_rk, -8.931639747704099574e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,1) = reshape((/                                                                                 &
                                        -8.931639747704073207e-02_rk, 1.186389784734526720e-01_rk, -3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300629160e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.942890293094023946e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.686058463052617862e-02_rk, 7.552791946969179826e-02_rk, -2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -8.931639747704088472e-02_rk, 1.186389784734525193e-01_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,1) = reshape((/                                                                                 &
                                        3.333333333333332593e-01_rk, -3.178921847281496182e-02_rk, -3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.122065907891938774e-01_rk, -2.023764502790677267e-02_rk, -2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        3.333333333333334814e-01_rk, -3.178921847281483692e-02_rk, -3.333333333333334814e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,1) = reshape((/                                                                                 &
                                        -3.333333333333330928e-01_rk, -1.186389784734526720e-01_rk, -1.244016935856293360e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.122065907891938774e-01_rk, -7.552791946969179826e-02_rk, -7.919657785262494976e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -3.333333333333334814e-01_rk, -1.186389784734526442e-01_rk, -1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,1) = reshape((/                                                                                 &
                                        3.333333333333331483e-01_rk, 1.751855318500467884e-01_rk, 1.244016935856293138e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268136e-01_rk, 3.466673899897024536e-33_rk, &
                                        0.000000000000000000e+00_rk, 1.696556935471541654e-18_rk, -5.551115123125782702e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, -6.190968482781581170e-18_rk, -4.396293210175147834e-17_rk, &
                                        2.122065907891938774e-01_rk, 1.115265734084704141e-01_rk, 7.919657785262492755e-01_rk, &
                                        5.889916076784293552e-18_rk, 3.095484241390789429e-18_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, -2.674306401815477679e-17_rk, -1.899062337165529643e-16_rk, &
                                        -2.312964634635744590e-18_rk, 1.413579858428229713e-16_rk, -8.632101532570588168e-18_rk, &
                                        3.333333333333334259e-01_rk, 1.751855318500467606e-01_rk, 1.244016935856293582e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,1) = reshape((/                                                                                 &
                                        -3.333333333333329263e-01_rk, 4.694082178483672402e-02_rk, 3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, -7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, -1.297012232824815538e-16_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,2) = reshape((/                                                                                 &
                                        -1.766974823035287141e-17_rk, -1.658865005327856808e-18_rk, -1.177983215356859018e-17_rk, &
                                        -2.122065907891938774e-01_rk, 2.988345527940996019e-02_rk, 2.122065907891938497e-01_rk, &
                                        -5.889916076784293552e-18_rk, 8.294325026639284039e-19_rk, -8.834874115176435705e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.165782406798412986e-18_rk, -5.088522196198636403e-17_rk, &
                                        2.312964634635744590e-18_rk, 0.000000000000000000e+00_rk, -2.312964634635743820e-18_rk, &
                                        -3.333333333333334259e-01_rk, 4.694082178483691137e-02_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,1) = reshape((/                                                                                 &
                                        8.931639747704094023e-02_rk, -1.751855318500467606e-01_rk, 3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272961000473e-02_rk, 1.155557966632341512e-33_rk, &
                                        0.000000000000000000e+00_rk, 1.317387235135328595e-16_rk, -1.804112415015879378e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 6.190968482781578859e-18_rk, -1.177983215356859327e-17_rk, &
                                        5.686058463052617862e-02_rk, -1.115265734084703864e-01_rk, 2.122065907891937941e-01_rk, &
                                        1.578198256261436963e-18_rk, -3.095484241390788659e-18_rk, 7.067899292141148564e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 2.674306401815481993e-17_rk, -5.088522196198643799e-17_rk, &
                                        -6.197570059723941405e-19_rk, 0.000000000000000000e+00_rk, -2.312964634635747286e-18_rk, &
                                        8.931639747704085697e-02_rk, -1.751855318500469272e-01_rk, 3.333333333333338699e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,1) = reshape((/                                                                                 &
                                        -8.931639747704088472e-02_rk, -4.694082178483671014e-02_rk, 8.931639747704087084e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.189184527613342299e-03_rk, 1.925929944387235853e-34_rk, &
                                        0.000000000000000000e+00_rk, -1.530165058895308148e-18_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.658865005327856037e-18_rk, -3.156396512522877007e-18_rk, &
                                        -5.686058463052617862e-02_rk, -2.988345527940994978e-02_rk, 5.686058463052617862e-02_rk, &
                                        -1.578198256261436963e-18_rk, -8.294325026639280187e-19_rk, 8.834874115176435705e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 7.165782406798391416e-18_rk, -1.363465413139268284e-17_rk, &
                                        6.197570059723941405e-19_rk, -8.834874115176435705e-18_rk, -6.197570059723946219e-19_rk, &
                                        -8.931639747704085697e-02_rk, -4.694082178483677259e-02_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,1) = reshape((/                                                                                 &
                                        1.244016935856293138e+00_rk, 6.538013056153504365e-01_rk, -1.244016935856293360e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.256800528336969758e-01_rk, -1.540743955509788682e-33_rk, &
                                        0.000000000000000000e+00_rk, 6.331636681113173319e-18_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.310500892579846922e-17_rk, 4.396293210175155230e-17_rk, &
                                        7.919657785262493865e-01_rk, 4.162228383544717136e-01_rk, -7.919657785262493865e-01_rk, &
                                        2.198146605087574533e-17_rk, 1.155250446289923153e-17_rk, -1.413579858428229713e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, -9.980647366582078354e-17_rk, 1.899062337165528657e-16_rk, &
                                        -8.632101532570585087e-18_rk, 0.000000000000000000e+00_rk, 8.632101532570583546e-18_rk, &
                                        1.244016935856293138e+00_rk, 6.538013056153504365e-01_rk, -1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,1) = reshape((/                                                                                 &
                                        -1.244016935856294026e+00_rk, 1.751855318500467606e-01_rk, -3.333333333333332593e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908270357e-01_rk, -3.081487911019577365e-33_rk, &
                                        0.000000000000000000e+00_rk, -5.048670157232923548e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.190968482781581170e-18_rk, 1.177983215356859327e-17_rk, &
                                        -7.919657785262493865e-01_rk, 1.115265734084704141e-01_rk, -2.122065907891937109e-01_rk, &
                                        -2.198146605087574533e-17_rk, 3.095484241390790200e-18_rk, -7.067899292141148564e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-16_rk, -2.674306401815480452e-17_rk, 5.088522196198643799e-17_rk, &
                                        8.632101532570585087e-18_rk, 0.000000000000000000e+00_rk, 2.312964634635747286e-18_rk, &
                                        -1.244016935856293138e+00_rk, 1.751855318500468717e-01_rk, -3.333333333333338699e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,1) = reshape((/                                                                                 &
                                        3.333333333333331483e-01_rk, -6.538013056153503255e-01_rk, -3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268136e-01_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 3.087080859164040629e-17_rk, -1.665334536937734811e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.310500892579847538e-17_rk, 1.177983215356855475e-17_rk, &
                                        2.122065907891938774e-01_rk, -4.162228383544717136e-01_rk, -2.122065907891938497e-01_rk, &
                                        5.889916076784293552e-18_rk, -1.155250446289923153e-17_rk, 1.413579858428229713e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 9.980647366582084517e-17_rk, 5.088522196198636403e-17_rk, &
                                        -2.312964634635744590e-18_rk, 0.000000000000000000e+00_rk, 2.312964634635743820e-18_rk, &
                                        3.333333333333334259e-01_rk, -6.538013056153507696e-01_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,1) = reshape((/                                                                                 &
                                        -3.333333333333329263e-01_rk, -1.751855318500467329e-01_rk, -8.931639747704080146e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, -7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, -5.710653743763904148e-18_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 6.190968482781578859e-18_rk, 3.156396512522862370e-18_rk, &
                                        -2.122065907891938774e-01_rk, -1.115265734084703864e-01_rk, -5.686058463052613698e-02_rk, &
                                        -5.889916076784293552e-18_rk, -3.095484241390788659e-18_rk, 7.067899292141148564e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,3) = reshape((/                                                                                 &
                                        6.938893903907228378e-17_rk, 2.674306401815478604e-17_rk, 1.363465413139272444e-17_rk, &
                                        2.312964634635744590e-18_rk, 8.834874115176435705e-18_rk, 6.197570059723965479e-19_rk, &
                                        -3.333333333333334259e-01_rk, -1.751855318500467329e-01_rk, -8.931639747704121779e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,1) = reshape((/                                                                                 &
                                        3.333333333333330373e-01_rk, 3.178921847281496182e-02_rk, 3.333333333333335369e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300641476e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.902943531154132685e-17_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.904340331166843040e-34_rk, &
                                        2.122065907891939052e-01_rk, 2.023764502790677267e-02_rk, 2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 1.764656114167919779e-18_rk, 1.850371707708595364e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        3.333333333333334814e-01_rk, 3.178921847281482999e-02_rk, 3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,1) = reshape((/                                                                                 &
                                        -3.333333333333328707e-01_rk, 1.186389784734526720e-01_rk, 1.244016935856293360e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522296122e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, -1.961736132466737216e-33_rk, &
                                        -2.122065907891939052e-01_rk, 7.552791946969178438e-02_rk, 7.919657785262494976e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, 6.585786275961774669e-18_rk, 6.905681226056465604e-17_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -3.333333333333334814e-01_rk, 1.186389784734526165e-01_rk, 1.244016935856292694e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,1) = reshape((/                                                                                 &
                                        8.931639747704080146e-02_rk, -3.178921847281496182e-02_rk, 8.931639747704089860e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.755769946802327893e-03_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.904340331166843040e-34_rk, &
                                        5.686058463052618556e-02_rk, -2.023764502790677267e-02_rk, 5.686058463052618556e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.764656114167929409e-18_rk, 4.958056047779159287e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.931639747704088472e-02_rk, -3.178921847281500346e-02_rk, 8.931639747704098187e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,1) = reshape((/                                                                                 &
                                        -8.931639747704073207e-02_rk, -1.186389784734526720e-01_rk, 3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300629160e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.643844487199832200e-17_rk, 1.387778780781445676e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, 1.961736132466737216e-33_rk, &
                                        -5.686058463052618556e-02_rk, -7.552791946969178438e-02_rk, 2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -6.585786275961769277e-18_rk, 1.850371707708593823e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -8.931639747704088472e-02_rk, -1.186389784734525471e-01_rk, 3.333333333333330928e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,1) = reshape((/                                                                                 &
                                        1.244016935856295802e+00_rk, 1.186389784734526720e-01_rk, -3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522246856e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.951471765577066342e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, -1.961736132466737216e-33_rk, &
                                        7.919657785262493865e-01_rk, 7.552791946969178438e-02_rk, -2.122065907891938497e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 6.585786275961760803e-18_rk, -1.850371707708592282e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.244016935856293360e+00_rk, 1.186389784734523944e-01_rk, -3.333333333333328152e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,1) = reshape((/                                                                                 &
                                        -1.244016935856296913e+00_rk, 4.427666954209956152e-01_rk, -1.244016935856293582e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.952277841578875517e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,2) = reshape((/                                                                                 &
                                        -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk, -7.846944529866948863e-33_rk, &
                                        -7.919657785262493865e-01_rk, 2.818740328508603787e-01_rk, -7.919657785262494976e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.457848898967917851e-17_rk, -6.905681226056469302e-17_rk, &
                                        0.000000000000000000e+00_rk, 7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.244016935856293360e+00_rk, 4.427666954209957817e-01_rk, -1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,1) = reshape((/                                                                                 &
                                        3.333333333333330373e-01_rk, -1.186389784734526720e-01_rk, -8.931639747704085697e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300641476e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, 1.961736132466737216e-33_rk, &
                                        2.122065907891939052e-01_rk, -7.552791946969178438e-02_rk, -5.686058463052617862e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, -6.585786275961774669e-18_rk, -4.958056047779136946e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 0.000000000000000000e+00_rk, &
                                        3.333333333333334814e-01_rk, -1.186389784734526165e-01_rk, -8.931639747704057941e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,1) = reshape((/                                                                                 &
                                        -3.333333333333327597e-01_rk, -4.427666954209956152e-01_rk, -3.333333333333335369e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.975735882788533171e-17_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,2) = reshape((/                                                                                 &
                                        2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk, 7.846944529866948863e-33_rk, &
                                        -2.122065907891939052e-01_rk, -2.818740328508603787e-01_rk, -2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, -2.457848898967916927e-17_rk, -1.850371707708595364e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -3.333333333333334814e-01_rk, -4.427666954209956707e-01_rk, -3.333333333333333703e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,1) = reshape((/                                                                                 &
                                        8.931639747704094023e-02_rk, 1.751855318500467329e-01_rk, 3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272961000473e-02_rk, -4.622231866529366047e-33_rk, &
                                        0.000000000000000000e+00_rk, -1.308295413919868591e-16_rk, -1.804112415015879378e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, -6.190968482781580399e-18_rk, -1.177983215356859327e-17_rk, &
                                        5.686058463052617862e-02_rk, 1.115265734084703864e-01_rk, 2.122065907891937941e-01_rk, &
                                        1.578198256261436963e-18_rk, 3.095484241390788659e-18_rk, -7.067899292141148564e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 2.917425165616889391e-17_rk, 5.551115123125793795e-17_rk, &
                                        2.479028023889576562e-18_rk, 0.000000000000000000e+00_rk, 9.251858538542989146e-18_rk, &
                                        8.931639747704085697e-02_rk, 1.751855318500469272e-01_rk, 3.333333333333338699e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,1) = reshape((/                                                                                 &
                                        -8.931639747704088472e-02_rk, 4.694082178483673790e-02_rk, 8.931639747704085697e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.189184527613342299e-03_rk, -7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, -1.530165058895308148e-18_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.658865005327856423e-18_rk, -3.156396512522873926e-18_rk, &
                                        -5.686058463052617862e-02_rk, 2.988345527940994978e-02_rk, 5.686058463052615780e-02_rk, &
                                        -1.578198256261436963e-18_rk, 8.294325026639280187e-19_rk, -8.834874115176435705e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 7.817217171052789655e-18_rk, 1.487416814333747247e-17_rk, &
                                        -2.479028023889576562e-18_rk, -8.834874115176435705e-18_rk, 2.479028023889578488e-18_rk, &
                                        -8.931639747704085697e-02_rk, 4.694082178483677259e-02_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,1) = reshape((/                                                                                 &
                                        3.333333333333331483e-01_rk, -1.751855318500466774e-01_rk, 1.244016935856293138e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268136e-01_rk, -1.540743955509788682e-32_rk, &
                                        0.000000000000000000e+00_rk, 1.696556935471542617e-18_rk, -5.551115123125782702e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.190968482781580399e-18_rk, -4.396293210175147218e-17_rk, &
                                        2.122065907891938774e-01_rk, -1.115265734084703725e-01_rk, 7.919657785262492755e-01_rk, &
                                        5.889916076784293552e-18_rk, -3.095484241390788659e-18_rk, 7.067899292141148564e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, -2.917425165616884461e-17_rk, 2.071704367816941160e-16_rk, &
                                        9.251858538542978360e-18_rk, 1.413579858428229713e-16_rk, 3.452840613028235267e-17_rk, &
                                        3.333333333333334259e-01_rk, -1.751855318500466496e-01_rk, 1.244016935856293582e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,1) = reshape((/                                                                                 &
                                        -3.333333333333329263e-01_rk, -4.694082178483671708e-02_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 9.244463733058732095e-33_rk, &
                                        0.000000000000000000e+00_rk, 1.146331343379326130e-16_rk, 3.330669073875469621e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,2) = reshape((/                                                                                 &
                                        3.533949646070574282e-17_rk, 1.658865005327855460e-18_rk, -1.177983215356858094e-17_rk, &
                                        -2.122065907891938774e-01_rk, -2.988345527940992549e-02_rk, 2.122065907891937664e-01_rk, &
                                        -5.889916076784293552e-18_rk, -8.294325026639277298e-19_rk, 1.766974823035287141e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, -7.817217171052811226e-18_rk, 5.551115123125785167e-17_rk, &
                                        -9.251858538542978360e-18_rk, 0.000000000000000000e+00_rk, 9.251858538542975279e-18_rk, &
                                        -3.333333333333334259e-01_rk, -4.694082178483689749e-02_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,1) = reshape((/                                                                                 &
                                        3.333333333333332038e-01_rk, 6.538013056153503255e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268136e-01_rk, -6.162975822039154730e-33_rk, &
                                        0.000000000000000000e+00_rk, -5.665194637686616451e-17_rk, -2.775557561562891351e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.310500892579847846e-17_rk, 1.177983215356858556e-17_rk, &
                                        2.122065907891938774e-01_rk, 4.162228383544717136e-01_rk, -2.122065907891937386e-01_rk, &
                                        5.889916076784293552e-18_rk, 1.155250446289923153e-17_rk, -1.413579858428229713e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 1.088797894536227290e-16_rk, -5.551115123125785167e-17_rk, &
                                        9.251858538542978360e-18_rk, 3.533949646070574282e-17_rk, -9.251858538542972197e-18_rk, &
                                        3.333333333333334259e-01_rk, 6.538013056153507696e-01_rk, -3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,1) = reshape((/                                                                                 &
                                        -3.333333333333329263e-01_rk, 1.751855318500467606e-01_rk, -8.931639747704091248e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 9.244463733058732095e-33_rk, &
                                        0.000000000000000000e+00_rk, -5.710653743763904148e-18_rk, 3.330669073875469621e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, -6.190968482781580399e-18_rk, 3.156396512522870074e-18_rk, &
                                        -2.122065907891938774e-01_rk, 1.115265734084703864e-01_rk, -5.686058463052619250e-02_rk, &
                                        -5.889916076784293552e-18_rk, 3.095484241390788659e-18_rk, -7.067899292141148564e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 2.917425165616885077e-17_rk, -1.487416814333751253e-17_rk, &
                                        -9.251858538542978360e-18_rk, 1.766974823035287141e-17_rk, -2.479028023889585421e-18_rk, &
                                        -3.333333333333334259e-01_rk, 1.751855318500466774e-01_rk, -8.931639747704119003e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,1) = reshape((/                                                                                 &
                                        1.244016935856293138e+00_rk, -6.538013056153502145e-01_rk, -1.244016935856293138e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.256800528336969758e-01_rk, 6.162975822039154730e-33_rk, &
                                        0.000000000000000000e+00_rk, 6.331636681113173319e-18_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.310500892579847846e-17_rk, 4.396293210175149067e-17_rk, &
                                        7.919657785262493865e-01_rk, -4.162228383544717136e-01_rk, -7.919657785262490535e-01_rk, &
                                        2.198146605087574533e-17_rk, -1.155250446289923153e-17_rk, 1.413579858428229713e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, -1.088797894536226674e-16_rk, -2.071704367816940174e-16_rk, &
                                        3.452840613028234035e-17_rk, 0.000000000000000000e+00_rk, -3.452840613028233418e-17_rk, &
                                        1.244016935856293138e+00_rk, -6.538013056153504365e-01_rk, -1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,1) = reshape((/                                                                                 &
                                        -1.244016935856294026e+00_rk, -1.751855318500467329e-01_rk, -3.333333333333336479e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908270357e-01_rk, 1.232595164407830946e-32_rk, &
                                        0.000000000000000000e+00_rk, -2.131244991616037547e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 6.190968482781577318e-18_rk, 1.177983215356860867e-17_rk, &
                                        -7.919657785262493865e-01_rk, -1.115265734084703309e-01_rk, -2.122065907891939607e-01_rk, &
                                        -2.198146605087574533e-17_rk, -3.095484241390788274e-18_rk, 7.067899292141148564e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,3) = reshape((/                                                                                 &
                                        -1.665334536937734811e-16_rk, -2.917425165616887542e-17_rk, -5.551115123125788865e-17_rk, &
                                        -3.452840613028234035e-17_rk, 0.000000000000000000e+00_rk, -9.251858538542981442e-18_rk, &
                                        -1.244016935856293138e+00_rk, -1.751855318500467884e-01_rk, -3.333333333333335369e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,1) = reshape((/                                                                                 &
                                        8.931639747704074594e-02_rk, 3.178921847281496182e-02_rk, 8.931639747704088472e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.755769946802327893e-03_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.387778780781445676e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.686058463052618556e-02_rk, 2.023764502790677267e-02_rk, 5.686058463052618556e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 0.000000000000000000e+00_rk, &
                                        8.931639747704088472e-02_rk, 3.178921847281500346e-02_rk, 8.931639747704100962e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,1) = reshape((/                                                                                 &
                                        -8.931639747704070431e-02_rk, 1.186389784734526720e-01_rk, 3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300629160e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.878679413942666780e-17_rk, 8.326672684688674053e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.686058463052618556e-02_rk, 7.552791946969179826e-02_rk, 2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -8.931639747704088472e-02_rk, 1.186389784734525471e-01_rk, 3.333333333333332038e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,1) = reshape((/                                                                                 &
                                        3.333333333333329263e-01_rk, -3.178921847281496182e-02_rk, 3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.902943531154132685e-17_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.122065907891939052e-01_rk, -2.023764502790677267e-02_rk, 2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        3.333333333333334814e-01_rk, -3.178921847281482999e-02_rk, 3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,1) = reshape((/                                                                                 &
                                        -3.333333333333332038e-01_rk, -1.186389784734526720e-01_rk, 1.244016935856293360e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522296122e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.122065907891939052e-01_rk, -7.552791946969179826e-02_rk, 7.919657785262494976e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -3.333333333333334814e-01_rk, -1.186389784734526442e-01_rk, 1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,1) = reshape((/                                                                                 &
                                        3.333333333333329263e-01_rk, 1.186389784734526720e-01_rk, -8.931639747704088472e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.122065907891939052e-01_rk, 7.552791946969179826e-02_rk, -5.686058463052618556e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 0.000000000000000000e+00_rk, &
                                        3.333333333333334814e-01_rk, 1.186389784734526442e-01_rk, -8.931639747704045451e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,1) = reshape((/                                                                                 &
                                        -3.333333333333328707e-01_rk, 4.427666954209956707e-01_rk, -3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.122065907891939052e-01_rk, 2.818740328508603787e-01_rk, -2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -3.333333333333334814e-01_rk, 4.427666954209957262e-01_rk, -3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,1) = reshape((/                                                                                 &
                                        1.244016935856295802e+00_rk, -1.186389784734526720e-01_rk, -3.333333333333334814e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522232978e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        7.919657785262494976e-01_rk, -7.552791946969179826e-02_rk, -2.122065907891938774e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.244016935856293360e+00_rk, -1.186389784734524638e-01_rk, -3.333333333333330928e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,1) = reshape((/                                                                                 &
                                        -1.244016935856296469e+00_rk, -4.427666954209956707e-01_rk, -1.244016935856293360e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.952277841578872741e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -7.919657785262494976e-01_rk, -2.818740328508603787e-01_rk, -7.919657785262494976e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.244016935856293360e+00_rk, -4.427666954209957817e-01_rk, -1.244016935856293582e+00_rk  &
                                        /),(/3,3/))
        

        do inode = 1,self%elem%basis_s%nnodes_ie()
            do inode_diff = 1,self%elem%nnodes_r
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx(:,:,inode,inode_diff,idir)),self%elem%dmetric_dx(:,:,inode,inode_diff,idir), 1.e-14_rk)
                end do
            end do
        end do 


    end subroutine testElement_dmetric_dx
    !***************************************************************************************





    !> Test cartesian dgrad1_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad1_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_ie(),self%elem%nterms_s,self%elem%nnodes_r,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,-7.182335127930850049e-01_rk,-7.182335127930850049e-01_rk,0.000000000000000000e+00_rk,4.146723119520965284e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856296691e+00_rk,-7.182335127930867813e-01_rk,-7.182335127930867813e-01_rk,0.000000000000000000e+00_rk,4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333331483e-01_rk,1.924500897298751789e-01_rk,-1.924500897298751789e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333331483e-01_rk,1.924500897298752344e-01_rk,-1.924500897298752344e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112160e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333331483e-01_rk,-1.924500897298751512e-01_rk,1.924500897298751512e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111882e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333330373e-01_rk,-1.924500897298750957e-01_rk,1.924500897298750957e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,5.156684612641729282e-02_rk,5.156684612641729282e-02_rk,0.000000000000000000e+00_rk,2.977213249234700668e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704074594e-02_rk,5.156684612641716098e-02_rk,5.156684612641716098e-02_rk,0.000000000000000000e+00_rk,2.977213249234693382e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.919657785262492755e-01_rk, -5.495366512718934792e-18_rk,2.827159716856459426e-16_rk,-4.572416554211018447e-01_rk,0.000000000000000000e+00_rk,-4.572416554211017337e-01_rk,2.639885928420828698e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262493865e-01_rk, 0.000000000000000000e+00_rk,7.067899292141148564e-17_rk,4.572416554211016781e-01_rk,-3.533949646070574282e-17_rk,-4.572416554211017337e-01_rk,-2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, -1.472479019196073388e-18_rk,2.827159716856459426e-16_rk,-1.225175323159538310e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,7.073553026306447777e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,-7.067899292141148564e-17_rk,1.225175323159538310e-01_rk,7.067899292141148564e-17_rk,-1.225175323159538865e-01_rk,-7.073553026306450553e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 5.889916076784293552e-18_rk,-7.067899292141148564e-17_rk,-1.225175323159538587e-01_rk,-3.533949646070574282e-17_rk,1.225175323159538865e-01_rk,-7.073553026306451941e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891939052e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.225175323159539142e-01_rk,0.000000000000000000e+00_rk,1.225175323159539142e-01_rk,7.073553026306457492e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052617862e-02_rk, 1.578198256261436963e-18_rk,-7.067899292141148564e-17_rk,-3.282847384271381924e-02_rk,-3.533949646070574282e-17_rk,3.282847384271379843e-02_rk,-1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052618556e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.282847384271381230e-02_rk,8.834874115176435705e-18_rk,3.282847384271380536e-02_rk,1.895352821017537784e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.632101532570583546e-18_rk, 1.244016935856292916e+00_rk,0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,-7.182335127930844498e-01_rk,-7.182335127930843388e-01_rk,4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk,1.110223024625156540e-16_rk,-5.551115123125782702e-17_rk,7.182335127930843388e-01_rk,-7.182335127930844498e-01_rk,-4.146723119520971390e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.251858538542978360e-18_rk, 3.333333333333334259e-01_rk,5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,-1.924500897298754287e-01_rk,1.924500897298753732e-01_rk,-1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,1.924500897298754287e-01_rk,1.924500897298754287e-01_rk,1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.312964634635744590e-18_rk, 3.333333333333334259e-01_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,-1.924500897298753177e-01_rk,-1.924500897298753732e-01_rk,1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,1.924500897298753732e-01_rk,-1.924500897298754287e-01_rk,-1.111111111111110078e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.479028023889576562e-18_rk, 8.931639747704085697e-02_rk,-5.551115123125782702e-17_rk,-2.775557561562891351e-17_rk,-5.156684612641718179e-02_rk,5.156684612641716792e-02_rk,-2.977213249234689219e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704088472e-02_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,5.156684612641718179e-02_rk,5.156684612641718179e-02_rk,2.977213249234693035e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856295580e+00_rk,7.182335127930862262e-01_rk,7.182335127930862262e-01_rk,0.000000000000000000e+00_rk,-4.146723119520971390e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856297357e+00_rk,7.182335127930874474e-01_rk,7.182335127930874474e-01_rk,0.000000000000000000e+00_rk,-4.146723119520979717e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333148e-01_rk,-1.924500897298751512e-01_rk,1.924500897298751512e-01_rk,0.000000000000000000e+00_rk,1.111111111111111882e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333330928e-01_rk,-1.924500897298751512e-01_rk,1.924500897298751512e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333329263e-01_rk,1.924500897298750679e-01_rk,-1.924500897298750679e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333328707e-01_rk,1.924500897298750401e-01_rk,-1.924500897298750401e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704088472e-02_rk,-5.156684612641723731e-02_rk,-5.156684612641723731e-02_rk,0.000000000000000000e+00_rk,-2.977213249234698933e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704070431e-02_rk,-5.156684612641712628e-02_rk,-5.156684612641712628e-02_rk,0.000000000000000000e+00_rk,-2.977213249234691994e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.919657785262492755e-01_rk, 5.495366512718934792e-18_rk,7.067899292141148564e-17_rk,4.572416554211016781e-01_rk,-7.067899292141148564e-17_rk,4.572416554211017337e-01_rk,-2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262493865e-01_rk, 0.000000000000000000e+00_rk,2.827159716856459426e-16_rk,-4.572416554211019557e-01_rk,-1.413579858428229713e-16_rk,4.572416554211017337e-01_rk,2.639885928420829808e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 1.472479019196073388e-18_rk,-7.067899292141148564e-17_rk,1.225175323159539004e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,-7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.225175323159539698e-01_rk,1.413579858428229713e-16_rk,1.225175323159538865e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, -5.889916076784293552e-18_rk,-1.766974823035287141e-17_rk,1.225175323159539004e-01_rk,-8.834874115176435705e-18_rk,-1.225175323159538865e-01_rk,7.073553026306454716e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891939052e-01_rk, 0.000000000000000000e+00_rk,-1.413579858428229713e-16_rk,-1.225175323159538310e-01_rk,-7.067899292141148564e-17_rk,-1.225175323159539142e-01_rk,-7.073553026306450553e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052617862e-02_rk, -1.578198256261436963e-18_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,-1.766974823035287141e-17_rk,-3.282847384271379843e-02_rk,1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052618556e-02_rk, 0.000000000000000000e+00_rk,-7.067899292141148564e-17_rk,-3.282847384271388863e-02_rk,-7.067899292141148564e-17_rk,-3.282847384271380536e-02_rk,-1.895352821017542294e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.632101532570583546e-18_rk, -1.244016935856292916e+00_rk,2.220446049250313081e-16_rk,-1.110223024625156540e-16_rk,7.182335127930841168e-01_rk,7.182335127930843388e-01_rk,-4.146723119520971390e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292916e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930844498e-01_rk,7.182335127930844498e-01_rk,4.146723119520973055e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.251858538542978360e-18_rk, -3.333333333333334259e-01_rk,-4.163336342344337027e-17_rk,-6.938893903907228378e-18_rk,1.924500897298754010e-01_rk,-1.924500897298753732e-01_rk,1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,-1.924500897298754565e-01_rk,-1.924500897298754287e-01_rk,-1.111111111111110633e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.312964634635744590e-18_rk, -3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,-1.111111111111110217e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk,-2.220446049250313081e-16_rk,2.220446049250313081e-16_rk,-1.924500897298756508e-01_rk,1.924500897298754287e-01_rk,1.111111111111111049e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.479028023889576562e-18_rk, -8.931639747704085697e-02_rk,-2.775557561562891351e-17_rk,-2.081668171172168513e-17_rk,5.156684612641714710e-02_rk,-5.156684612641716792e-02_rk,2.977213249234691300e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704088472e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641718179e-02_rk,-5.156684612641718179e-02_rk,-2.977213249234693382e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333331483e-01_rk,-1.924500897298751789e-01_rk,-1.924500897298751789e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333148e-01_rk,-1.924500897298752899e-01_rk,-1.924500897298752899e-01_rk,0.000000000000000000e+00_rk,1.111111111111112854e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,7.182335127930850049e-01_rk,-7.182335127930850049e-01_rk,0.000000000000000000e+00_rk,-4.146723119520965284e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856295358e+00_rk,7.182335127930861152e-01_rk,-7.182335127930861152e-01_rk,0.000000000000000000e+00_rk,-4.146723119520971390e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,-5.156684612641729282e-02_rk,5.156684612641729282e-02_rk,0.000000000000000000e+00_rk,-2.977213249234700668e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704080146e-02_rk,-5.156684612641718873e-02_rk,5.156684612641718873e-02_rk,0.000000000000000000e+00_rk,-2.977213249234695810e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333331483e-01_rk,1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111112021e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333329263e-01_rk,1.924500897298750679e-01_rk,1.924500897298750679e-01_rk,0.000000000000000000e+00_rk,1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, -1.472479019196073388e-18_rk,-2.827159716856459426e-16_rk,-1.225175323159538310e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,7.073553026306447777e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,-7.067899292141148564e-17_rk,1.225175323159539420e-01_rk,3.533949646070574282e-17_rk,-1.225175323159538865e-01_rk,-7.073553026306458880e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262492755e-01_rk, -5.495366512718934792e-18_rk,-2.827159716856459426e-16_rk,-4.572416554211018447e-01_rk,0.000000000000000000e+00_rk,-4.572416554211017337e-01_rk,2.639885928420828698e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262493865e-01_rk, 0.000000000000000000e+00_rk,7.067899292141148564e-17_rk,4.572416554211019002e-01_rk,-7.067899292141148564e-17_rk,-4.572416554211018447e-01_rk,-2.639885928420829253e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052617862e-02_rk, 1.578198256261436963e-18_rk,7.067899292141148564e-17_rk,-3.282847384271381924e-02_rk,3.533949646070574282e-17_rk,3.282847384271379843e-02_rk,-1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052618556e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.282847384271381230e-02_rk,0.000000000000000000e+00_rk,3.282847384271380536e-02_rk,1.895352821017536396e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 5.889916076784293552e-18_rk,0.000000000000000000e+00_rk,-1.225175323159539004e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,-7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891939052e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.225175323159539004e-01_rk,-8.834874115176435705e-18_rk,1.225175323159539142e-01_rk,7.073553026306456104e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.312964634635744590e-18_rk, 3.333333333333334259e-01_rk,5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,-1.924500897298753732e-01_rk,-1.924500897298753732e-01_rk,1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk,2.775557561562891351e-17_rk,-2.081668171172168513e-17_rk,1.924500897298753732e-01_rk,-1.924500897298754010e-01_rk,-1.111111111111110217e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.452840613028233418e-17_rk, 1.244016935856292916e+00_rk,2.220446049250313081e-16_rk,2.220446049250313081e-16_rk,-7.182335127930845609e-01_rk,7.182335127930843388e-01_rk,-4.146723119520973611e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293360e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930845609e-01_rk,7.182335127930845609e-01_rk,4.146723119520973055e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.197570059723941405e-19_rk, 8.931639747704085697e-02_rk,-5.551115123125782702e-17_rk,2.775557561562891351e-17_rk,-5.156684612641718179e-02_rk,-5.156684612641716792e-02_rk,2.977213249234689219e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704088472e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641718179e-02_rk,-5.156684612641718179e-02_rk,-2.977213249234693035e-02_rk, &
                                        0.000000000000000000e+00_rk, 9.251858538542978360e-18_rk, 3.333333333333334259e-01_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,-1.924500897298753177e-01_rk,1.924500897298753732e-01_rk,-1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk,-1.110223024625156540e-16_rk,-2.775557561562891351e-17_rk,1.924500897298754010e-01_rk,1.924500897298754287e-01_rk,1.111111111111110356e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333148e-01_rk,1.924500897298751512e-01_rk,1.924500897298751512e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111882e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333332038e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856295580e+00_rk,-7.182335127930862262e-01_rk,7.182335127930862262e-01_rk,0.000000000000000000e+00_rk,4.146723119520971390e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856296469e+00_rk,-7.182335127930865593e-01_rk,7.182335127930865593e-01_rk,0.000000000000000000e+00_rk,4.146723119520969725e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704088472e-02_rk,5.156684612641723731e-02_rk,-5.156684612641723731e-02_rk,0.000000000000000000e+00_rk,2.977213249234698933e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704073207e-02_rk,5.156684612641711241e-02_rk,-5.156684612641711241e-02_rk,0.000000000000000000e+00_rk,2.977213249234693382e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333329263e-01_rk,-1.924500897298751234e-01_rk,-1.924500897298751234e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333332038e-01_rk,-1.924500897298750957e-01_rk,-1.924500897298750957e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 1.472479019196073388e-18_rk,7.067899292141148564e-17_rk,1.225175323159539004e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,-7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,-1.225175323159536922e-01_rk,1.413579858428229713e-16_rk,1.225175323159538865e-01_rk,7.073553026306433900e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262492755e-01_rk, 5.495366512718934792e-18_rk,7.067899292141148564e-17_rk,4.572416554211017337e-01_rk,0.000000000000000000e+00_rk,4.572416554211017337e-01_rk,-2.639885928420828698e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262493865e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.572416554211016781e-01_rk,-1.413579858428229713e-16_rk,4.572416554211018447e-01_rk,2.639885928420829253e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052617862e-02_rk, -1.578198256261436963e-18_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,1.766974823035287141e-17_rk,-3.282847384271379843e-02_rk,1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052618556e-02_rk, 0.000000000000000000e+00_rk,1.413579858428229713e-16_rk,-3.282847384271388863e-02_rk,7.067899292141148564e-17_rk,-3.282847384271380536e-02_rk,-1.895352821017542294e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, -5.889916076784293552e-18_rk,3.533949646070574282e-17_rk,1.225175323159539004e-01_rk,3.533949646070574282e-17_rk,-1.225175323159538865e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891939052e-01_rk, 0.000000000000000000e+00_rk,7.067899292141148564e-17_rk,-1.225175323159538310e-01_rk,7.067899292141148564e-17_rk,-1.225175323159539142e-01_rk,-7.073553026306450553e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.312964634635744590e-18_rk, -3.333333333333334259e-01_rk,6.938893903907228378e-17_rk,-3.469446951953614189e-17_rk,1.924500897298753455e-01_rk,1.924500897298753732e-01_rk,-1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk,5.551115123125782702e-17_rk,-2.775557561562891351e-17_rk,-1.924500897298754287e-01_rk,1.924500897298754010e-01_rk,1.111111111111110356e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.452840613028233418e-17_rk, -1.244016935856292916e+00_rk,-1.665334536937734811e-16_rk,-1.110223024625156540e-16_rk,7.182335127930844498e-01_rk,-7.182335127930843388e-01_rk,4.146723119520973055e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293360e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,-7.182335127930843388e-01_rk,-7.182335127930845609e-01_rk,-4.146723119520973611e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.197570059723941405e-19_rk, -8.931639747704085697e-02_rk,1.387778780781445676e-17_rk,-6.938893903907228378e-18_rk,5.156684612641717486e-02_rk,5.156684612641716792e-02_rk,-2.977213249234692688e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704088472e-02_rk,-5.551115123125782702e-17_rk,-2.775557561562891351e-17_rk,-5.156684612641715404e-02_rk,5.156684612641718179e-02_rk,2.977213249234693382e-02_rk, &
                                        0.000000000000000000e+00_rk, -9.251858538542978360e-18_rk, -3.333333333333334259e-01_rk,-1.110223024625156540e-16_rk,-2.775557561562891351e-17_rk,1.924500897298753455e-01_rk,-1.924500897298753732e-01_rk,1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,-1.924500897298756508e-01_rk,-1.924500897298754287e-01_rk,-1.111111111111109939e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333331483e-01_rk,-1.924500897298751789e-01_rk,-1.924500897298751789e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333334259e-01_rk,-1.924500897298752899e-01_rk,-1.924500897298752899e-01_rk,0.000000000000000000e+00_rk,1.111111111111112576e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,5.156684612641730669e-02_rk,-5.156684612641730669e-02_rk,0.000000000000000000e+00_rk,-2.977213249234701709e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704081533e-02_rk,5.156684612641718179e-02_rk,-5.156684612641718179e-02_rk,0.000000000000000000e+00_rk,-2.977213249234695117e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293138e+00_rk,-7.182335127930845609e-01_rk,7.182335127930845609e-01_rk,0.000000000000000000e+00_rk,-4.146723119520963063e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856295802e+00_rk,-7.182335127930858931e-01_rk,7.182335127930858931e-01_rk,0.000000000000000000e+00_rk,-4.146723119520971390e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333332038e-01_rk,1.924500897298751512e-01_rk,1.924500897298751512e-01_rk,0.000000000000000000e+00_rk,1.111111111111112021e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333329263e-01_rk,1.924500897298750679e-01_rk,1.924500897298750679e-01_rk,0.000000000000000000e+00_rk,1.111111111111111327e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, -1.472479019196073388e-18_rk,-7.067899292141148564e-17_rk,-1.225175323159539004e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,5.300924469105861115e-17_rk,1.225175323159538449e-01_rk,-3.533949646070574282e-17_rk,-1.225175323159538865e-01_rk,-7.073553026306454716e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052618556e-02_rk, -3.945495640653592407e-19_rk,-7.067899292141148564e-17_rk,-3.282847384271378455e-02_rk,0.000000000000000000e+00_rk,-3.282847384271379843e-02_rk,1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052617862e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.282847384271379843e-02_rk,-8.834874115176435705e-18_rk,-3.282847384271379149e-02_rk,-1.895352821017537784e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262493865e-01_rk, 2.198146605087574533e-17_rk,0.000000000000000000e+00_rk,-4.572416554211018447e-01_rk,0.000000000000000000e+00_rk,4.572416554211017337e-01_rk,-2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262493865e-01_rk, 0.000000000000000000e+00_rk,-1.413579858428229713e-16_rk,4.572416554211018447e-01_rk,-7.067899292141148564e-17_rk,4.572416554211017337e-01_rk,2.639885928420828698e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 5.889916076784293552e-18_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,-7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891939052e-01_rk, 0.000000000000000000e+00_rk,-7.067899292141148564e-17_rk,1.225175323159538310e-01_rk,-7.067899292141148564e-17_rk,1.225175323159539142e-01_rk,7.073553026306450553e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.312964634635744590e-18_rk, 3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,-1.924500897298752067e-01_rk,-1.924500897298753732e-01_rk,1.111111111111109384e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk,-5.551115123125782702e-17_rk,2.775557561562891351e-17_rk,1.924500897298754287e-01_rk,-1.924500897298754010e-01_rk,-1.111111111111110356e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.479028023889576177e-18_rk, 8.931639747704085697e-02_rk,5.551115123125782702e-17_rk,2.775557561562891351e-17_rk,-5.156684612641720955e-02_rk,5.156684612641716792e-02_rk,-2.977213249234691994e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704088472e-02_rk,-1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,5.156684612641717486e-02_rk,5.156684612641718179e-02_rk,2.977213249234693035e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.632101532570585087e-18_rk, 1.244016935856293138e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,-7.182335127930844498e-01_rk,-7.182335127930844498e-01_rk,4.146723119520973611e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293360e+00_rk,1.110223024625156540e-16_rk,-8.326672684688674053e-17_rk,7.182335127930846719e-01_rk,-7.182335127930845609e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.251858538542978360e-18_rk, 3.333333333333334259e-01_rk,1.110223024625156540e-16_rk,5.551115123125782702e-17_rk,-1.924500897298753177e-01_rk,1.924500897298753732e-01_rk,-1.111111111111110078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk,1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,1.924500897298754287e-01_rk,1.924500897298754287e-01_rk,1.111111111111110356e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333330928e-01_rk,1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112160e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333332038e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704089860e-02_rk,-5.156684612641727894e-02_rk,5.156684612641727894e-02_rk,0.000000000000000000e+00_rk,2.977213249234699627e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704073207e-02_rk,-5.156684612641712628e-02_rk,5.156684612641712628e-02_rk,0.000000000000000000e+00_rk,2.977213249234692688e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856294026e+00_rk,7.182335127930848939e-01_rk,-7.182335127930848939e-01_rk,0.000000000000000000e+00_rk,4.146723119520968059e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856296913e+00_rk,7.182335127930867813e-01_rk,-7.182335127930867813e-01_rk,0.000000000000000000e+00_rk,4.146723119520975276e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333329263e-01_rk,-1.924500897298751234e-01_rk,-1.924500897298751234e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333328707e-01_rk,-1.924500897298750401e-01_rk,-1.924500897298750401e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111049e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 1.472479019196073388e-18_rk,1.766974823035287141e-17_rk,1.225175323159538587e-01_rk,-1.766974823035287141e-17_rk,1.225175323159538865e-01_rk,-7.073553026306453329e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,7.067899292141148564e-17_rk,-1.225175323159539420e-01_rk,-3.533949646070574282e-17_rk,1.225175323159538865e-01_rk,7.073553026306458880e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052618556e-02_rk, 3.945495640653592407e-19_rk,1.766974823035287141e-17_rk,3.282847384271382618e-02_rk,-2.650462234552930558e-17_rk,3.282847384271379843e-02_rk,-1.895352821017538478e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052617862e-02_rk, 0.000000000000000000e+00_rk,-7.067899292141148564e-17_rk,-3.282847384271385394e-02_rk,7.067899292141148564e-17_rk,3.282847384271379149e-02_rk,1.895352821017542294e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262493865e-01_rk, -2.198146605087574533e-17_rk,0.000000000000000000e+00_rk,4.572416554211016781e-01_rk,3.533949646070574282e-17_rk,-4.572416554211017337e-01_rk,2.639885928420828698e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262493865e-01_rk, 0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,-4.572416554211018447e-01_rk,0.000000000000000000e+00_rk,-4.572416554211017337e-01_rk,-2.639885928420827033e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, -5.889916076784293552e-18_rk,-7.067899292141148564e-17_rk,1.225175323159538587e-01_rk,-3.533949646070574282e-17_rk,-1.225175323159538865e-01_rk,7.073553026306453329e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891939052e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.225175323159541085e-01_rk,-1.413579858428229713e-16_rk,-1.225175323159539142e-01_rk,-7.073553026306456104e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.312964634635744590e-18_rk, -3.333333333333334259e-01_rk,-5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,-1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298754287e-01_rk,1.924500897298754010e-01_rk,1.111111111111109384e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.479028023889576177e-18_rk, -8.931639747704085697e-02_rk,-2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk,5.156684612641718179e-02_rk,-5.156684612641716792e-02_rk,2.977213249234693035e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704088472e-02_rk,5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,-5.156684612641718179e-02_rk,-5.156684612641718179e-02_rk,-2.977213249234696157e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.632101532570585087e-18_rk, -1.244016935856293138e+00_rk,2.775557561562891351e-16_rk,-1.387778780781445676e-16_rk,7.182335127930846719e-01_rk,7.182335127930844498e-01_rk,-4.146723119520973611e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293360e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,-7.182335127930843388e-01_rk,7.182335127930845609e-01_rk,4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.251858538542978360e-18_rk, -3.333333333333334259e-01_rk,-5.551115123125782702e-17_rk,-2.081668171172168513e-17_rk,1.924500897298753455e-01_rk,-1.924500897298753732e-01_rk,1.111111111111110078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk,1.110223024625156540e-16_rk,2.775557561562891351e-17_rk,-1.924500897298754010e-01_rk,-1.924500897298754287e-01_rk,-1.111111111111110356e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704095411e-02_rk,-5.156684612641729282e-02_rk,-5.156684612641729282e-02_rk,0.000000000000000000e+00_rk,2.977213249234701015e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704088472e-02_rk,-5.156684612641725118e-02_rk,-5.156684612641725118e-02_rk,0.000000000000000000e+00_rk,2.977213249234697198e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333331483e-01_rk,1.924500897298751789e-01_rk,-1.924500897298751789e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333332593e-01_rk,1.924500897298752899e-01_rk,-1.924500897298752899e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112437e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333331483e-01_rk,-1.924500897298751512e-01_rk,1.924500897298751512e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111882e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333330373e-01_rk,-1.924500897298750957e-01_rk,1.924500897298750957e-01_rk,0.000000000000000000e+00_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293138e+00_rk,7.182335127930845609e-01_rk,7.182335127930845609e-01_rk,0.000000000000000000e+00_rk,4.146723119520963063e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856295802e+00_rk,7.182335127930856711e-01_rk,7.182335127930856711e-01_rk,0.000000000000000000e+00_rk,4.146723119520970280e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.686058463052618556e-02_rk, -3.945495640653592407e-19_rk,7.067899292141148564e-17_rk,-3.282847384271378455e-02_rk,0.000000000000000000e+00_rk,-3.282847384271379843e-02_rk,1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052618556e-02_rk, 0.000000000000000000e+00_rk,-5.300924469105861115e-17_rk,3.282847384271383312e-02_rk,3.533949646070574282e-17_rk,-3.282847384271380536e-02_rk,-1.895352821017539172e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, -1.472479019196073388e-18_rk,7.067899292141148564e-17_rk,-1.225175323159539004e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.225175323159538587e-01_rk,8.834874115176435705e-18_rk,-1.225175323159538865e-01_rk,-7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 5.889916076784293552e-18_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,-7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891939052e-01_rk, 0.000000000000000000e+00_rk,1.413579858428229713e-16_rk,1.225175323159538310e-01_rk,7.067899292141148564e-17_rk,1.225175323159539142e-01_rk,7.073553026306450553e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262493865e-01_rk, 2.198146605087574533e-17_rk,0.000000000000000000e+00_rk,-4.572416554211018447e-01_rk,0.000000000000000000e+00_rk,4.572416554211017337e-01_rk,-2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262494976e-01_rk, 0.000000000000000000e+00_rk,7.067899292141148564e-17_rk,4.572416554211019002e-01_rk,7.067899292141148564e-17_rk,4.572416554211018447e-01_rk,2.639885928420829253e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.197570059723940442e-19_rk, 8.931639747704085697e-02_rk,5.551115123125782702e-17_rk,-2.775557561562891351e-17_rk,-5.156684612641720955e-02_rk,-5.156684612641716792e-02_rk,2.977213249234691994e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704088472e-02_rk,-2.775557561562891351e-17_rk,1.387778780781445676e-17_rk,5.156684612641719567e-02_rk,-5.156684612641718179e-02_rk,-2.977213249234693729e-02_rk, &
                                        0.000000000000000000e+00_rk, 9.251858538542978360e-18_rk, 3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,-1.924500897298752067e-01_rk,1.924500897298753732e-01_rk,-1.111111111111109384e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,1.924500897298754565e-01_rk,1.924500897298754287e-01_rk,1.111111111111110633e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.312964634635744590e-18_rk, 3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298753732e-01_rk,-1.924500897298753732e-01_rk,1.111111111111110217e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk,2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk,1.924500897298754565e-01_rk,-1.924500897298754287e-01_rk,-1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.452840613028234035e-17_rk, 1.244016935856293138e+00_rk,2.220446049250313081e-16_rk,1.110223024625156540e-16_rk,-7.182335127930843388e-01_rk,7.182335127930844498e-01_rk,-4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293360e+00_rk,5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,7.182335127930845609e-01_rk,7.182335127930845609e-01_rk,4.146723119520973055e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704089860e-02_rk,5.156684612641727894e-02_rk,5.156684612641727894e-02_rk,0.000000000000000000e+00_rk,-2.977213249234699627e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704081533e-02_rk,5.156684612641722343e-02_rk,5.156684612641722343e-02_rk,0.000000000000000000e+00_rk,-2.977213249234696851e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333330928e-01_rk,-1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111112160e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333330928e-01_rk,-1.924500897298751512e-01_rk,1.924500897298751512e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333329263e-01_rk,1.924500897298750679e-01_rk,-1.924500897298750679e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333327597e-01_rk,1.924500897298749846e-01_rk,-1.924500897298749846e-01_rk,0.000000000000000000e+00_rk,1.111111111111112160e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856294026e+00_rk,-7.182335127930848939e-01_rk,-7.182335127930848939e-01_rk,0.000000000000000000e+00_rk,-4.146723119520968059e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856296469e+00_rk,-7.182335127930865593e-01_rk,-7.182335127930865593e-01_rk,0.000000000000000000e+00_rk,-4.146723119520969725e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.686058463052618556e-02_rk, 3.945495640653592407e-19_rk,-1.766974823035287141e-17_rk,3.282847384271382618e-02_rk,2.650462234552930558e-17_rk,3.282847384271379843e-02_rk,-1.895352821017538478e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052618556e-02_rk, 0.000000000000000000e+00_rk,-7.067899292141148564e-17_rk,-3.282847384271378455e-02_rk,3.533949646070574282e-17_rk,3.282847384271380536e-02_rk,1.895352821017533274e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 1.472479019196073388e-18_rk,-1.766974823035287141e-17_rk,1.225175323159538587e-01_rk,8.834874115176435705e-18_rk,1.225175323159538865e-01_rk,-7.073553026306453329e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,7.067899292141148564e-17_rk,-1.225175323159538310e-01_rk,-7.067899292141148564e-17_rk,1.225175323159538865e-01_rk,7.073553026306450553e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, -5.889916076784293552e-18_rk,7.067899292141148564e-17_rk,1.225175323159538587e-01_rk,3.533949646070574282e-17_rk,-1.225175323159538865e-01_rk,7.073553026306453329e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891939052e-01_rk, 0.000000000000000000e+00_rk,2.827159716856459426e-16_rk,-1.225175323159539698e-01_rk,0.000000000000000000e+00_rk,-1.225175323159539142e-01_rk,-7.073553026306463043e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262493865e-01_rk, -2.198146605087574533e-17_rk,7.067899292141148564e-17_rk,4.572416554211018447e-01_rk,7.067899292141148564e-17_rk,-4.572416554211017337e-01_rk,2.639885928420829253e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262494976e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.572416554211016781e-01_rk,1.413579858428229713e-16_rk,-4.572416554211018447e-01_rk,-2.639885928420829253e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.197570059723940442e-19_rk, -8.931639747704085697e-02_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,5.156684612641715404e-02_rk,5.156684612641716792e-02_rk,-2.977213249234691647e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704088472e-02_rk,-5.551115123125782702e-17_rk,2.775557561562891351e-17_rk,-5.156684612641715404e-02_rk,5.156684612641718179e-02_rk,2.977213249234691994e-02_rk, &
                                        0.000000000000000000e+00_rk, -9.251858538542978360e-18_rk, -3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,1.924500897298754287e-01_rk,-1.924500897298753732e-01_rk,1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,2.220446049250313081e-16_rk,-1.924500897298756508e-01_rk,-1.924500897298754287e-01_rk,-1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.312964634635744590e-18_rk, -3.333333333333334259e-01_rk,6.938893903907228378e-17_rk,-3.469446951953614189e-17_rk,1.924500897298754287e-01_rk,1.924500897298753732e-01_rk,-1.111111111111110356e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,-1.924500897298753732e-01_rk,1.924500897298754287e-01_rk,1.111111111111110078e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.452840613028234035e-17_rk, -1.244016935856293138e+00_rk,-1.665334536937734811e-16_rk,-8.326672684688674053e-17_rk,7.182335127930843388e-01_rk,-7.182335127930844498e-01_rk,4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293360e+00_rk,0.000000000000000000e+00_rk,2.220446049250313081e-16_rk,-7.182335127930843388e-01_rk,-7.182335127930845609e-01_rk,-4.146723119520972500e-01_rk  &
                                        /),(/8,8/))
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%elem%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad1_dx
    !*******************************************************************************************






    !> Test cartesian dgrad2_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad2_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_ie(),self%elem%nterms_s,self%elem%nnodes_r,3) :: test_dgrad2_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad2_dx
        ! 
        
        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.256800528336969758e-01_rk, -1.582909170278294293e-18_rk,6.538013056153503255e-01_rk,-1.317058667013623341e-01_rk,-3.774723597935514263e-01_rk,2.457664930921890922e-01_rk,7.604041759388437127e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522232978e-02_rk, 7.902943531154130220e-17_rk,1.186389784734526165e-01_rk,-9.869808947384309250e-02_rk,-6.849624615803007188e-02_rk,3.020184331581298245e-02_rk,5.698336852622496590e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268830e-01_rk, -1.171211458585433397e-16_rk,6.538013056153503255e-01_rk,4.433252931442326905e-01_rk,-3.774723597935513708e-01_rk,6.585293335068113929e-02_rk,-2.559539773353920467e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300655701e-02_rk, 0.000000000000000000e+00_rk,1.186389784734526720e-01_rk,6.040368663162653390e-02_rk,-6.849624615803014127e-02_rk,8.092559526403600434e-03_rk,-3.487408473681535143e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268136e-01_rk, 1.696556935471541654e-18_rk,1.751855318500467884e-01_rk,-3.529048062107108946e-02_rk,1.011434139717523051e-01_rk,-6.585293335068120868e-02_rk,-2.037496848640663744e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300641476e-02_rk, 7.902943531154132685e-17_rk,3.178921847281496182e-02_rk,-2.644607336901111383e-02_rk,1.835351384260759319e-02_rk,-8.092559526403600434e-03_rk,-1.526864757860715675e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272961000473e-02_rk, -1.308295413919868591e-16_rk,1.751855318500467329e-01_rk,1.187886542822878116e-01_rk,1.011434139717523328e-01_rk,-1.764524031053562800e-02_rk,6.858266152655220771e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.755769946802327893e-03_rk, 0.000000000000000000e+00_rk,3.178921847281496182e-02_rk,1.618511905280691984e-02_rk,1.835351384260754809e-02_rk,-2.168394789800627814e-03_rk,9.344482842004205383e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.162228383544717691e-01_rk, -2.888126115724808652e-18_rk,-1.732875669434886039e-17_rk,-2.403063677668244857e-01_rk,1.167222273257115162e-17_rk,-2.403063677668244857e-01_rk,1.387409461181570713e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.552791946969178438e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.360606463715893666e-02_rk,0.000000000000000000e+00_rk,-4.360606463715893666e-02_rk,-2.517597315656390153e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.162228383544717691e-01_rk, -2.888126115724808652e-18_rk,-1.732875669434886039e-17_rk,-2.403063677668244857e-01_rk,1.167222273257115162e-17_rk,-2.403063677668244857e-01_rk,1.387409461181570713e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.552791946969179826e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.360606463715894360e-02_rk,0.000000000000000000e+00_rk,-4.360606463715894360e-02_rk,-2.517597315656390847e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115265734084704141e-01_rk, 3.095484241390789429e-18_rk,-6.190968482781581170e-18_rk,-6.438989717917695255e-02_rk,-5.361535980117653440e-18_rk,6.438989717917695255e-02_rk,-3.717552446949008715e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.023764502790677267e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.168420980462607332e-02_rk,0.000000000000000000e+00_rk,1.168420980462607332e-02_rk,6.745881675968915837e-03_rk, &
                                        0.000000000000000000e+00_rk, 1.115265734084703864e-01_rk, 3.095484241390788659e-18_rk,-6.190968482781580399e-18_rk,-6.438989717917695255e-02_rk,-5.361535980117653440e-18_rk,6.438989717917695255e-02_rk,-3.717552446949008715e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.023764502790677267e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.168420980462607332e-02_rk,0.000000000000000000e+00_rk,1.168420980462607332e-02_rk,6.745881675968918439e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.538013056153504365e-01_rk,-9.980647366582074656e-17_rk,-1.305569848358255246e-17_rk,-3.774723597935513153e-01_rk,-3.774723597935514263e-01_rk,2.179337685384498680e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.533949646070574282e-17_rk, 1.186389784734523528e-01_rk,6.585786275961759262e-18_rk,-2.147205370960473856e-17_rk,6.849624615802996086e-02_rk,-6.849624615802994698e-02_rk,-3.954632615781740468e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 6.538013056153507696e-01_rk,1.088797894536227167e-16_rk,4.519202752000600484e-17_rk,-3.774723597935517594e-01_rk,3.774723597935516484e-01_rk,-2.179337685384500345e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.186389784734526442e-01_rk,0.000000000000000000e+00_rk,2.208718528794108926e-18_rk,6.849624615803012739e-02_rk,6.849624615803012739e-02_rk,3.954632615781750182e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.413579858428229713e-16_rk, 1.751855318500467606e-01_rk,-2.674306401815477679e-17_rk,1.544011520983706125e-17_rk,-1.011434139717522912e-01_rk,-1.011434139717522773e-01_rk,5.839517728334885777e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 3.178921847281482999e-02_rk,1.764656114167919779e-18_rk,-1.018824682541967906e-18_rk,1.835351384260747523e-02_rk,-1.835351384260747523e-02_rk,-1.059640615760494044e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.751855318500469272e-01_rk,2.917425165616889391e-17_rk,3.451351027744786720e-17_rk,-1.011434139717523745e-01_rk,1.011434139717523745e-01_rk,-5.839517728334889940e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 3.178921847281500346e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.835351384260757238e-02_rk,1.835351384260757238e-02_rk,1.059640615760498901e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.140606263908275908e-01_rk, -1.186624570596775550e-16_rk,1.751855318500468162e-01_rk,-3.529048062107060374e-02_rk,-1.011434139717522357e-01_rk,6.585293335068180542e-02_rk,2.037496848640641539e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.952277841578875517e-01_rk, 0.000000000000000000e+00_rk,4.427666954209955041e-01_rk,-3.683462845263635321e-01_rk,-2.556314707895129268e-01_rk,1.127148137368505498e-01_rk,2.126648265262941484e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 1.427663435940977770e-18_rk,1.751855318500467329e-01_rk,1.187886542822876867e-01_rk,-1.011434139717522912e-01_rk,1.764524031053539208e-02_rk,-6.858266152655211056e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 7.902943531154132685e-17_rk,4.427666954209956707e-01_rk,2.254296274736999062e-01_rk,-2.556314707895129823e-01_rk,3.020184331581315940e-02_rk,-1.301518561052574241e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, -1.297012232824815538e-16_rk,4.694082178483672402e-02_rk,-9.456055782922271821e-03_rk,2.710129609345781829e-02_rk,-1.764524031053538514e-02_rk,-5.459456351742388372e-03_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522296122e-02_rk, 0.000000000000000000e+00_rk,1.186389784734526720e-01_rk,-9.869808947384335618e-02_rk,6.849624615803014127e-02_rk,-3.020184331581322879e-02_rk,-5.698336852622513937e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.189184527613342299e-03_rk, -1.530165058895308148e-18_rk,4.694082178483673790e-02_rk,3.182932398491881282e-02_rk,2.710129609345774196e-02_rk,-4.728027891461078665e-03_rk,1.837666877081667316e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300629160e-02_rk, 9.878679413942666780e-17_rk,1.186389784734526720e-01_rk,6.040368663162669349e-02_rk,6.849624615803019678e-02_rk,-8.092559526403388798e-03_rk,3.487408473681544163e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.115265734084704419e-01_rk, -7.738710603476976462e-19_rk,-4.643226362086187611e-18_rk,-6.438989717917699418e-02_rk,3.127562655068632265e-18_rk,-6.438989717917699418e-02_rk,3.717552446949010797e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.818740328508603787e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.627400487440097132e-01_rk,0.000000000000000000e+00_rk,-1.627400487440097132e-01_rk,-9.395801095028669114e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115265734084704141e-01_rk, -7.738710603476975499e-19_rk,-4.643226362086186070e-18_rk,-6.438989717917699418e-02_rk,3.127562655068632265e-18_rk,-6.438989717917699418e-02_rk,3.717552446949010103e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.818740328508603787e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.627400487440097410e-01_rk,0.000000000000000000e+00_rk,-1.627400487440097410e-01_rk,-9.395801095028670502e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.988345527940996019e-02_rk, 8.294325026639284039e-19_rk,-1.658865005327856808e-18_rk,-1.725322094988348751e-02_rk,-1.436619236062932814e-18_rk,1.725322094988348751e-02_rk,-9.961151759803308497e-03_rk, &
                                        0.000000000000000000e+00_rk, 7.552791946969178438e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.360606463715895054e-02_rk,0.000000000000000000e+00_rk,4.360606463715895054e-02_rk,2.517597315656389806e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.988345527940994978e-02_rk, 8.294325026639280187e-19_rk,-1.658865005327856423e-18_rk,-1.725322094988347710e-02_rk,-1.436619236062932429e-18_rk,1.725322094988347710e-02_rk,-9.961151759803305028e-03_rk, &
                                        0.000000000000000000e+00_rk, 7.552791946969179826e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.360606463715894360e-02_rk,0.000000000000000000e+00_rk,4.360606463715894360e-02_rk,2.517597315656390847e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 1.751855318500468717e-01_rk,-2.674306401815479836e-17_rk,-2.229633020515797069e-18_rk,-1.011434139717523328e-01_rk,-1.011434139717523606e-01_rk,5.839517728334888552e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 4.427666954209956707e-01_rk,2.457848898967916927e-17_rk,-4.952989369517127181e-17_rk,2.556314707895129268e-01_rk,-2.556314707895128713e-01_rk,-1.475888984736650200e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 1.751855318500466774e-01_rk,2.917425165616885077e-17_rk,1.242632498950675714e-17_rk,-1.011434139717522773e-01_rk,1.011434139717522634e-01_rk,-5.839517728334885083e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 4.427666954209957262e-01_rk,0.000000000000000000e+00_rk,-8.834874115176435705e-18_rk,2.556314707895129823e-01_rk,2.556314707895129823e-01_rk,1.475888984736650755e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.694082178483691137e-02_rk,-7.165782406798412986e-18_rk,2.180691463187222019e-17_rk,-2.710129609345785645e-02_rk,-2.710129609345787033e-02_rk,1.564694059494562209e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 1.186389784734526165e-01_rk,6.585786275961774669e-18_rk,-3.802305479251874080e-18_rk,6.849624615803012739e-02_rk,-6.849624615803012739e-02_rk,-3.954632615781753652e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 4.694082178483677259e-02_rk,7.817217171052789655e-18_rk,8.930709495609311678e-18_rk,-2.710129609345775931e-02_rk,2.710129609345775931e-02_rk,-1.564694059494556658e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.186389784734525471e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.849624615803007188e-02_rk,6.849624615803007188e-02_rk,3.954632615781747407e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.140606263908268830e-01_rk, 1.162728673908075650e-16_rk,-6.538013056153503255e-01_rk,4.433252931442326905e-01_rk,3.774723597935513708e-01_rk,6.585293335068113929e-02_rk,-2.559539773353920467e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 0.000000000000000000e+00_rk,-1.186389784734526165e-01_rk,6.040368663162651308e-02_rk,6.849624615803011352e-02_rk,8.092559526403600434e-03_rk,-3.487408473681531673e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.256800528336969758e-01_rk, -1.582909170278294293e-18_rk,-6.538013056153503255e-01_rk,-1.317058667013623618e-01_rk,3.774723597935514263e-01_rk,2.457664930921890922e-01_rk,7.604041759388438515e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522204529e-02_rk, -7.902943531154132685e-17_rk,-1.186389784734526720e-01_rk,-9.869808947384296760e-02_rk,6.849624615803009964e-02_rk,3.020184331581284021e-02_rk,5.698336852622484100e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272961000473e-02_rk, 1.317387235135328595e-16_rk,-1.751855318500467606e-01_rk,1.187886542822878255e-01_rk,-1.011434139717523467e-01_rk,-1.764524031053562800e-02_rk,6.858266152655220771e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.755769946802327893e-03_rk, 0.000000000000000000e+00_rk,-3.178921847281496182e-02_rk,1.618511905280691984e-02_rk,-1.835351384260754809e-02_rk,-2.168394789800627814e-03_rk,9.344482842004196710e-03_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268136e-01_rk, 1.696556935471542617e-18_rk,-1.751855318500466774e-01_rk,-3.529048062107104089e-02_rk,-1.011434139717522357e-01_rk,-6.585293335068120868e-02_rk,-2.037496848640664437e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, -7.902943531154132685e-17_rk,-3.178921847281496182e-02_rk,-2.644607336901111383e-02_rk,-1.835351384260759319e-02_rk,-8.092559526403600434e-03_rk,-1.526864757860717410e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.162228383544717691e-01_rk, 2.888126115724808652e-18_rk,1.732875669434886039e-17_rk,2.403063677668244857e-01_rk,-1.167222273257115162e-17_rk,2.403063677668244857e-01_rk,-1.387409461181570713e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.552791946969178438e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.360606463715893666e-02_rk,0.000000000000000000e+00_rk,4.360606463715893666e-02_rk,2.517597315656390153e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.162228383544717691e-01_rk, 2.888126115724808652e-18_rk,1.732875669434886039e-17_rk,2.403063677668244857e-01_rk,-1.167222273257115162e-17_rk,2.403063677668244857e-01_rk,-1.387409461181570713e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.552791946969179826e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.360606463715894360e-02_rk,0.000000000000000000e+00_rk,4.360606463715894360e-02_rk,2.517597315656390847e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115265734084703864e-01_rk, -3.095484241390788659e-18_rk,6.190968482781578859e-18_rk,6.438989717917695255e-02_rk,5.361535980117651899e-18_rk,-6.438989717917695255e-02_rk,3.717552446949008715e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.023764502790677267e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.168420980462607332e-02_rk,0.000000000000000000e+00_rk,-1.168420980462607332e-02_rk,-6.745881675968915837e-03_rk, &
                                        0.000000000000000000e+00_rk, -1.115265734084703725e-01_rk, -3.095484241390788659e-18_rk,6.190968482781580399e-18_rk,6.438989717917693867e-02_rk,5.361535980117653440e-18_rk,-6.438989717917693867e-02_rk,3.717552446949008715e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.023764502790677267e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.168420980462607332e-02_rk,0.000000000000000000e+00_rk,-1.168420980462607332e-02_rk,-6.745881675968918439e-03_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.538013056153508806e-01_rk,9.980647366582082052e-17_rk,-5.762329443782897324e-17_rk,3.774723597935516484e-01_rk,3.774723597935517594e-01_rk,-2.179337685384500345e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.186389784734526026e-01_rk,-6.585786275961773129e-18_rk,3.802305479251874080e-18_rk,-6.849624615803009964e-02_rk,6.849624615803009964e-02_rk,3.954632615781748795e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.538013056153504365e-01_rk,-1.088797894536226674e-16_rk,-1.335407686717703218e-16_rk,3.774723597935514263e-01_rk,-3.774723597935514263e-01_rk,2.179337685384499235e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, -1.186389784734524083e-01_rk,0.000000000000000000e+00_rk,-8.834874115176435705e-18_rk,-6.849624615802998862e-02_rk,-6.849624615802997474e-02_rk,-3.954632615781742550e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.751855318500469272e-01_rk,2.674306401815481993e-17_rk,2.229633020515784358e-18_rk,1.011434139717524161e-01_rk,1.011434139717523745e-01_rk,-5.839517728334892022e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.178921847281500346e-02_rk,-1.764656114167929409e-18_rk,1.018824682541973299e-18_rk,-1.835351384260757238e-02_rk,1.835351384260757238e-02_rk,1.059640615760498901e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.413579858428229713e-16_rk, -1.751855318500466496e-01_rk,-2.917425165616884461e-17_rk,-1.684376204709497422e-17_rk,1.011434139717522218e-01_rk,-1.011434139717522357e-01_rk,5.839517728334881613e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, -3.178921847281482999e-02_rk,0.000000000000000000e+00_rk,-8.834874115176435705e-18_rk,-1.835351384260747523e-02_rk,-1.835351384260748217e-02_rk,-1.059640615760493176e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 1.427663435940977770e-18_rk,-1.751855318500467884e-01_rk,1.187886542822876590e-01_rk,1.011434139717522773e-01_rk,1.764524031053538861e-02_rk,-6.858266152655209669e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, -8.149910516502697136e-17_rk,-4.427666954209955041e-01_rk,2.254296274736997119e-01_rk,2.556314707895128713e-01_rk,3.020184331581322879e-02_rk,-1.301518561052573408e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908275908e-01_rk, 1.183783376466944206e-16_rk,-1.751855318500466774e-01_rk,-3.529048062107062456e-02_rk,1.011434139717522079e-01_rk,6.585293335068168052e-02_rk,2.037496848640641539e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.952277841578872741e-01_rk, 0.000000000000000000e+00_rk,-4.427666954209956707e-01_rk,-3.683462845263634211e-01_rk,2.556314707895130378e-01_rk,1.127148137368504111e-01_rk,2.126648265262941762e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.189184527613342299e-03_rk, -1.530165058895308148e-18_rk,-4.694082178483671014e-02_rk,3.182932398491881282e-02_rk,-2.710129609345773502e-02_rk,-4.728027891461075195e-03_rk,1.837666877081667316e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300629160e-02_rk, -8.643844487199832200e-17_rk,-1.186389784734526720e-01_rk,6.040368663162668655e-02_rk,-6.849624615803019678e-02_rk,-8.092559526403397471e-03_rk,3.487408473681544857e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 1.146331343379326130e-16_rk,-4.694082178483671708e-02_rk,-9.456055782922282230e-03_rk,-2.710129609345780094e-02_rk,-1.764524031053539554e-02_rk,-5.459456351742350208e-03_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522296122e-02_rk, 0.000000000000000000e+00_rk,-1.186389784734526720e-01_rk,-9.869808947384332842e-02_rk,-6.849624615803014127e-02_rk,-3.020184331581319409e-02_rk,-5.698336852622516019e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.115265734084704141e-01_rk, 7.738710603476975499e-19_rk,4.643226362086186070e-18_rk,6.438989717917699418e-02_rk,-3.127562655068632265e-18_rk,6.438989717917699418e-02_rk,-3.717552446949010103e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.818740328508603787e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.627400487440097132e-01_rk,0.000000000000000000e+00_rk,1.627400487440097132e-01_rk,9.395801095028669114e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115265734084704141e-01_rk, 7.738710603476975499e-19_rk,4.643226362086186070e-18_rk,6.438989717917696642e-02_rk,-3.127562655068631109e-18_rk,6.438989717917696642e-02_rk,-3.717552446949008715e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.818740328508603787e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.627400487440097410e-01_rk,0.000000000000000000e+00_rk,1.627400487440097410e-01_rk,9.395801095028670502e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.988345527940994978e-02_rk, -8.294325026639280187e-19_rk,1.658865005327856037e-18_rk,1.725322094988347710e-02_rk,1.436619236062932044e-18_rk,-1.725322094988347710e-02_rk,9.961151759803305028e-03_rk, &
                                        0.000000000000000000e+00_rk, -7.552791946969178438e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.360606463715895054e-02_rk,0.000000000000000000e+00_rk,-4.360606463715895054e-02_rk,-2.517597315656389806e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.988345527940992549e-02_rk, -8.294325026639277298e-19_rk,1.658865005327855460e-18_rk,1.725322094988347016e-02_rk,1.436619236062931851e-18_rk,-1.725322094988347016e-02_rk,9.961151759803299824e-03_rk, &
                                        0.000000000000000000e+00_rk, -7.552791946969179826e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.360606463715894360e-02_rk,0.000000000000000000e+00_rk,-4.360606463715894360e-02_rk,-2.517597315656390847e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, -1.751855318500467329e-01_rk,2.674306401815477679e-17_rk,-1.544011520983706125e-17_rk,1.011434139717522634e-01_rk,1.011434139717522773e-01_rk,-5.839517728334883695e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, -4.427666954209956152e-01_rk,-2.457848898967916619e-17_rk,5.355523119289090206e-18_rk,-2.556314707895128713e-01_rk,2.556314707895128713e-01_rk,1.475888984736650200e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.751855318500468717e-01_rk,-2.917425165616887542e-17_rk,-1.684376204709498963e-17_rk,1.011434139717523606e-01_rk,-1.011434139717523467e-01_rk,5.839517728334889246e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, -4.427666954209957262e-01_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-2.556314707895129823e-01_rk,-2.556314707895129268e-01_rk,-1.475888984736650478e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, -4.694082178483677259e-02_rk,7.165782406798391416e-18_rk,2.802706560688795675e-19_rk,2.710129609345776971e-02_rk,2.710129609345775931e-02_rk,-1.564694059494557352e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, -1.186389784734525471e-01_rk,-6.585786275961769277e-18_rk,3.802305479251871769e-18_rk,-6.849624615803007188e-02_rk,6.849624615803007188e-02_rk,3.954632615781746713e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.694082178483689749e-02_rk,-7.817217171052811226e-18_rk,1.315647579233176141e-17_rk,2.710129609345783563e-02_rk,-2.710129609345785645e-02_rk,1.564694059494561168e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, -1.186389784734526442e-01_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-6.849624615803012739e-02_rk,-6.849624615803016903e-02_rk,-3.954632615781752264e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.140606263908268830e-01_rk, -4.241392338678871468e-19_rk,1.751855318500467606e-01_rk,-3.529048062107106171e-02_rk,-1.011434139717522773e-01_rk,6.585293335068120868e-02_rk,2.037496848640662703e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 2.469669853485665694e-18_rk,3.178921847281495489e-02_rk,-2.644607336901114852e-02_rk,-1.835351384260754115e-02_rk,8.092559526403600434e-03_rk,1.526864757860713594e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960997003e-02_rk, -3.760429222214364107e-18_rk,1.751855318500467606e-01_rk,1.187886542822878116e-01_rk,-1.011434139717522773e-01_rk,1.764524031053553085e-02_rk,-6.858266152655217995e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.755769946802327893e-03_rk, 0.000000000000000000e+00_rk,3.178921847281496182e-02_rk,1.618511905280691984e-02_rk,-1.835351384260754809e-02_rk,2.168394789800627814e-03_rk,-9.344482842004205383e-03_rk, &
                                        0.000000000000000000e+00_rk, -4.256800528336969758e-01_rk, 6.331636681113173319e-18_rk,6.538013056153504365e-01_rk,-1.317058667013620288e-01_rk,3.774723597935514263e-01_rk,-2.457664930921893698e-01_rk,-7.604041759388435739e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522246856e-02_rk, 3.951471765577066342e-17_rk,1.186389784734526720e-01_rk,-9.869808947384296760e-02_rk,6.849624615803016903e-02_rk,-3.020184331581284021e-02_rk,-5.698336852622505611e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268136e-01_rk, -5.665194637686616451e-17_rk,6.538013056153503255e-01_rk,4.433252931442325240e-01_rk,3.774723597935513708e-01_rk,-6.585293335068120868e-02_rk,2.559539773353921022e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 0.000000000000000000e+00_rk,1.186389784734526720e-01_rk,6.040368663162657553e-02_rk,6.849624615803014127e-02_rk,-8.092559526403565739e-03_rk,3.487408473681533061e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.115265734084704141e-01_rk, -7.738710603476975499e-19_rk,-4.643226362086186070e-18_rk,-6.438989717917699418e-02_rk,3.127562655068632265e-18_rk,-6.438989717917699418e-02_rk,3.717552446949010103e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.023764502790677267e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.168420980462606812e-02_rk,0.000000000000000000e+00_rk,-1.168420980462606812e-02_rk,-6.745881675968917572e-03_rk, &
                                        0.000000000000000000e+00_rk, 1.115265734084704141e-01_rk, -7.738710603476975499e-19_rk,-4.643226362086186070e-18_rk,-6.438989717917699418e-02_rk,3.127562655068632265e-18_rk,-6.438989717917699418e-02_rk,3.717552446949010103e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.023764502790677267e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.168420980462606985e-02_rk,0.000000000000000000e+00_rk,-1.168420980462606985e-02_rk,-6.745881675968917572e-03_rk, &
                                        0.000000000000000000e+00_rk, 4.162228383544717136e-01_rk, 1.155250446289923153e-17_rk,-2.310500892579846922e-17_rk,-2.403063677668244025e-01_rk,-2.000952468440768672e-17_rk,2.403063677668244025e-01_rk,-1.387409461181570991e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.552791946969178438e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.360606463715895054e-02_rk,0.000000000000000000e+00_rk,4.360606463715895054e-02_rk,2.517597315656389806e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.162228383544717136e-01_rk, 1.155250446289923153e-17_rk,-2.310500892579847846e-17_rk,-2.403063677668244025e-01_rk,-2.000952468440768980e-17_rk,2.403063677668244025e-01_rk,-1.387409461181570991e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.552791946969179826e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.360606463715894360e-02_rk,0.000000000000000000e+00_rk,4.360606463715894360e-02_rk,2.517597315656390847e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.413579858428229713e-16_rk, 1.751855318500467329e-01_rk,-2.674306401815478604e-17_rk,1.544011520983706741e-17_rk,-1.011434139717522634e-01_rk,-1.011434139717522773e-01_rk,5.839517728334887858e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 3.178921847281482999e-02_rk,1.764656114167919394e-18_rk,7.816049432634466836e-18_rk,1.835351384260747523e-02_rk,-1.835351384260748217e-02_rk,-1.059640615760493697e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.751855318500470104e-01_rk,2.917425165616890007e-17_rk,3.451351027744787953e-17_rk,-1.011434139717524300e-01_rk,1.011434139717524300e-01_rk,-5.839517728334895491e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.178921847281499652e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.835351384260757238e-02_rk,1.835351384260757238e-02_rk,1.059640615760498901e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.538013056153504365e-01_rk,-9.980647366582078354e-17_rk,1.283022873592404342e-16_rk,-3.774723597935515373e-01_rk,-3.774723597935515373e-01_rk,2.179337685384499235e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 1.186389784734523944e-01_rk,6.585786275961760803e-18_rk,-3.802305479251866377e-18_rk,6.849624615802997474e-02_rk,-6.849624615802997474e-02_rk,-3.954632615781740468e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 6.538013056153507696e-01_rk,1.088797894536227290e-16_rk,4.519202752000601101e-17_rk,-3.774723597935515929e-01_rk,3.774723597935516484e-01_rk,-2.179337685384500067e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 1.186389784734526442e-01_rk,0.000000000000000000e+00_rk,-2.208718528794108926e-18_rk,6.849624615803012739e-02_rk,6.849624615803012739e-02_rk,3.954632615781750182e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, -3.957272925695767510e-19_rk,4.694082178483673790e-02_rk,-9.456055782922273556e-03_rk,-2.710129609345774196e-02_rk,1.764524031053545799e-02_rk,5.459456351742351943e-03_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk,1.186389784734526165e-01_rk,-9.869808947384330067e-02_rk,-6.849624615803011352e-02_rk,3.020184331581319409e-02_rk,5.698336852622513937e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.189184527613378728e-03_rk, 3.825412647238274223e-19_rk,4.694082178483671708e-02_rk,3.182932398491884751e-02_rk,-2.710129609345774196e-02_rk,4.728027891461112492e-03_rk,-1.837666877081667663e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300629160e-02_rk, 0.000000000000000000e+00_rk,1.186389784734526720e-01_rk,6.040368663162668655e-02_rk,-6.849624615803014127e-02_rk,8.092559526403451248e-03_rk,-3.487408473681541388e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908270357e-01_rk, -5.048670157232923548e-17_rk,1.751855318500467606e-01_rk,-3.529048062107073558e-02_rk,1.011434139717523467e-01_rk,-6.585293335068150011e-02_rk,-2.037496848640642233e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.952277841578875517e-01_rk, 0.000000000000000000e+00_rk,4.427666954209956152e-01_rk,-3.683462845263635321e-01_rk,2.556314707895129823e-01_rk,-1.127148137368505498e-01_rk,-2.126648265262941762e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, -5.710653743763904148e-18_rk,1.751855318500467606e-01_rk,1.187886542822877423e-01_rk,1.011434139717522912e-01_rk,-1.764524031053546840e-02_rk,6.858266152655209669e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk,4.427666954209956707e-01_rk,2.254296274736999062e-01_rk,2.556314707895130378e-01_rk,-3.020184331581312123e-02_rk,1.301518561052574519e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.988345527940996019e-02_rk, -2.073581256659821010e-19_rk,-1.244148753995893328e-18_rk,-1.725322094988348751e-02_rk,8.380278877033774428e-19_rk,-1.725322094988348751e-02_rk,9.961151759803308497e-03_rk, &
                                        0.000000000000000000e+00_rk, 7.552791946969178438e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.360606463715893666e-02_rk,0.000000000000000000e+00_rk,-4.360606463715893666e-02_rk,-2.517597315656390153e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.988345527940995325e-02_rk, -2.073581256659820528e-19_rk,-1.244148753995892943e-18_rk,-1.725322094988348404e-02_rk,8.380278877033774428e-19_rk,-1.725322094988348404e-02_rk,9.961151759803306763e-03_rk, &
                                        0.000000000000000000e+00_rk, 7.552791946969179826e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.360606463715894360e-02_rk,0.000000000000000000e+00_rk,-4.360606463715894360e-02_rk,-2.517597315656390847e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115265734084704141e-01_rk, 3.095484241390790200e-18_rk,-6.190968482781581170e-18_rk,-6.438989717917698030e-02_rk,-5.361535980117653440e-18_rk,6.438989717917698030e-02_rk,-3.717552446949010797e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.818740328508603787e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.627400487440097687e-01_rk,0.000000000000000000e+00_rk,1.627400487440097687e-01_rk,9.395801095028670502e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115265734084703864e-01_rk, 3.095484241390788659e-18_rk,-6.190968482781580399e-18_rk,-6.438989717917695255e-02_rk,-5.361535980117653440e-18_rk,6.438989717917695255e-02_rk,-3.717552446949008715e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.818740328508603787e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.627400487440097410e-01_rk,0.000000000000000000e+00_rk,1.627400487440097410e-01_rk,9.395801095028670502e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.694082178483689749e-02_rk,-7.165782406798409905e-18_rk,4.137166401519348011e-18_rk,-2.710129609345783910e-02_rk,-2.710129609345784604e-02_rk,1.564694059494561515e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.067899292141148564e-17_rk, 1.186389784734526026e-01_rk,6.585786275961773129e-18_rk,3.153719098145386643e-17_rk,6.849624615803009964e-02_rk,-6.849624615803014127e-02_rk,-3.954632615781750876e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 4.694082178483677259e-02_rk,7.817217171052789655e-18_rk,8.930709495609313218e-18_rk,-2.710129609345776971e-02_rk,2.710129609345776971e-02_rk,-1.564694059494557352e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 1.186389784734525193e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.849624615803005800e-02_rk,6.849624615803005800e-02_rk,3.954632615781746019e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.751855318500468717e-01_rk,-2.674306401815480452e-17_rk,-2.229633020515792061e-18_rk,-1.011434139717523606e-01_rk,-1.011434139717523328e-01_rk,5.839517728334889246e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.067899292141148564e-17_rk, 4.427666954209957817e-01_rk,2.457848898967917851e-17_rk,2.114909922624020767e-17_rk,2.556314707895130378e-01_rk,-2.556314707895130378e-01_rk,-1.475888984736650755e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 1.751855318500466774e-01_rk,2.917425165616885077e-17_rk,1.242632498950675714e-17_rk,-1.011434139717522357e-01_rk,1.011434139717522634e-01_rk,-5.839517728334882307e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 4.427666954209957262e-01_rk,0.000000000000000000e+00_rk,8.834874115176435705e-18_rk,2.556314707895129823e-01_rk,2.556314707895129823e-01_rk,1.475888984736650755e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.056245272960998738e-02_rk, 1.709742963317297531e-18_rk,-1.751855318500467606e-01_rk,1.187886542822878116e-01_rk,1.011434139717522773e-01_rk,1.764524031053554126e-02_rk,-6.858266152655217995e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.755769946802310112e-03_rk, 0.000000000000000000e+00_rk,-3.178921847281495489e-02_rk,1.618511905280691637e-02_rk,1.835351384260754462e-02_rk,2.168394789800627814e-03_rk,-9.344482842004201914e-03_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268830e-01_rk, -4.241392338678871468e-19_rk,-1.751855318500467606e-01_rk,-3.529048062107106865e-02_rk,1.011434139717522773e-01_rk,6.585293335068120868e-02_rk,2.037496848640663744e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300648588e-02_rk, 0.000000000000000000e+00_rk,-3.178921847281496182e-02_rk,-2.644607336901111383e-02_rk,1.835351384260754809e-02_rk,8.092559526403565739e-03_rk,1.526864757860715675e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908268136e-01_rk, 3.087080859164040629e-17_rk,-6.538013056153503255e-01_rk,4.433252931442325240e-01_rk,-3.774723597935513708e-01_rk,-6.585293335068120868e-02_rk,2.559539773353921022e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300641476e-02_rk, 0.000000000000000000e+00_rk,-1.186389784734526720e-01_rk,6.040368663162657553e-02_rk,-6.849624615803014127e-02_rk,-8.092559526403565739e-03_rk,3.487408473681535143e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.256800528336969758e-01_rk, 6.331636681113173319e-18_rk,-6.538013056153502145e-01_rk,-1.317058667013620288e-01_rk,-3.774723597935513708e-01_rk,-2.457664930921893698e-01_rk,-7.604041759388430188e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522232978e-02_rk, 0.000000000000000000e+00_rk,-1.186389784734526720e-01_rk,-9.869808947384296760e-02_rk,-6.849624615803014127e-02_rk,-3.020184331581284021e-02_rk,-5.698336852622498672e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.115265734084704141e-01_rk, 7.738710603476975499e-19_rk,4.643226362086186070e-18_rk,6.438989717917699418e-02_rk,-3.127562655068632265e-18_rk,6.438989717917699418e-02_rk,-3.717552446949010103e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.023764502790677267e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.168420980462606812e-02_rk,0.000000000000000000e+00_rk,1.168420980462606812e-02_rk,6.745881675968917572e-03_rk, &
                                        0.000000000000000000e+00_rk, -1.115265734084704141e-01_rk, 7.738710603476975499e-19_rk,4.643226362086186070e-18_rk,6.438989717917699418e-02_rk,-3.127562655068632265e-18_rk,6.438989717917699418e-02_rk,-3.717552446949010103e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.023764502790677267e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.168420980462606985e-02_rk,0.000000000000000000e+00_rk,1.168420980462606985e-02_rk,6.745881675968917572e-03_rk, &
                                        0.000000000000000000e+00_rk, -4.162228383544717136e-01_rk, -1.155250446289923153e-17_rk,2.310500892579847538e-17_rk,2.403063677668244025e-01_rk,2.000952468440768980e-17_rk,-2.403063677668244025e-01_rk,1.387409461181570991e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.552791946969178438e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.360606463715895054e-02_rk,0.000000000000000000e+00_rk,-4.360606463715895054e-02_rk,-2.517597315656389806e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.162228383544717136e-01_rk, -1.155250446289923153e-17_rk,2.310500892579847846e-17_rk,2.403063677668244025e-01_rk,2.000952468440768980e-17_rk,-2.403063677668244025e-01_rk,1.387409461181570991e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.552791946969179826e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.360606463715894360e-02_rk,0.000000000000000000e+00_rk,-4.360606463715894360e-02_rk,-2.517597315656390847e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.751855318500470104e-01_rk,2.674306401815482610e-17_rk,2.229633020515785898e-18_rk,1.011434139717524022e-01_rk,1.011434139717524300e-01_rk,-5.839517728334893409e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.178921847281499652e-02_rk,-1.764656114167928639e-18_rk,3.227543211336081647e-18_rk,-1.835351384260756544e-02_rk,1.835351384260756544e-02_rk,1.059640615760498727e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.413579858428229713e-16_rk, -1.751855318500466774e-01_rk,-2.917425165616884461e-17_rk,-1.684376204709496806e-17_rk,1.011434139717522773e-01_rk,-1.011434139717522634e-01_rk,5.839517728334888552e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, -3.178921847281483692e-02_rk,0.000000000000000000e+00_rk,8.834874115176435705e-18_rk,-1.835351384260747523e-02_rk,-1.835351384260748564e-02_rk,-1.059640615760493523e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.538013056153507696e-01_rk,9.980647366582084517e-17_rk,-7.529304266818184773e-17_rk,3.774723597935517594e-01_rk,3.774723597935516484e-01_rk,-2.179337685384500900e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, -1.186389784734526165e-01_rk,-6.585786275961774669e-18_rk,3.802305479251874080e-18_rk,-6.849624615803012739e-02_rk,6.849624615803012739e-02_rk,3.954632615781750182e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.538013056153504365e-01_rk,-1.088797894536226674e-16_rk,7.817217171052638662e-18_rk,3.774723597935513708e-01_rk,-3.774723597935515373e-01_rk,2.179337685384498680e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, -1.186389784734524638e-01_rk,0.000000000000000000e+00_rk,1.766974823035287141e-17_rk,-6.849624615803003025e-02_rk,-6.849624615803001637e-02_rk,-3.954632615781743937e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.189184527613378728e-03_rk, 3.825412647238274223e-19_rk,-4.694082178483672402e-02_rk,3.182932398491884751e-02_rk,2.710129609345773502e-02_rk,4.728027891461111624e-03_rk,-1.837666877081667316e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.401672426300627425e-02_rk, -1.234834926742832847e-18_rk,-1.186389784734526165e-01_rk,6.040368663162667962e-02_rk,6.849624615803011352e-02_rk,8.092559526403433900e-03_rk,-3.487408473681540694e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, 1.427663435940976807e-18_rk,-4.694082178483671014e-02_rk,-9.456055782922282230e-03_rk,2.710129609345773502e-02_rk,1.764524031053546493e-02_rk,5.459456351742353677e-03_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, 0.000000000000000000e+00_rk,-1.186389784734526720e-01_rk,-9.869808947384325903e-02_rk,6.849624615803014127e-02_rk,3.020184331581312123e-02_rk,5.698336852622513937e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.056245272960975840e-02_rk, -5.710653743763904148e-18_rk,-1.751855318500467329e-01_rk,1.187886542822877561e-01_rk,-1.011434139717522773e-01_rk,-1.764524031053545453e-02_rk,6.858266152655206893e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.231112710522289183e-02_rk, -1.975735882788533171e-17_rk,-4.427666954209956152e-01_rk,2.254296274736997951e-01_rk,-2.556314707895129823e-01_rk,-3.020184331581319409e-02_rk,1.301518561052574519e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.140606263908270357e-01_rk, -2.131244991616037547e-17_rk,-1.751855318500467329e-01_rk,-3.529048062107077027e-02_rk,-1.011434139717522357e-01_rk,-6.585293335068155562e-02_rk,-2.037496848640641539e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.952277841578872741e-01_rk, 0.000000000000000000e+00_rk,-4.427666954209956707e-01_rk,-3.683462845263634211e-01_rk,-2.556314707895130378e-01_rk,-1.127148137368504111e-01_rk,-2.126648265262941762e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.988345527940995325e-02_rk, 2.073581256659820528e-19_rk,1.244148753995892943e-18_rk,1.725322094988348404e-02_rk,-8.380278877033774428e-19_rk,1.725322094988348404e-02_rk,-9.961151759803306763e-03_rk, &
                                        0.000000000000000000e+00_rk, -7.552791946969178438e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.360606463715893666e-02_rk,0.000000000000000000e+00_rk,4.360606463715893666e-02_rk,2.517597315656390153e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.988345527940995325e-02_rk, 2.073581256659820528e-19_rk,1.244148753995892365e-18_rk,1.725322094988348057e-02_rk,-8.380278877033773465e-19_rk,1.725322094988348057e-02_rk,-9.961151759803306763e-03_rk, &
                                        0.000000000000000000e+00_rk, -7.552791946969179826e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.360606463715894360e-02_rk,0.000000000000000000e+00_rk,4.360606463715894360e-02_rk,2.517597315656390847e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115265734084703864e-01_rk, -3.095484241390788659e-18_rk,6.190968482781578859e-18_rk,6.438989717917695255e-02_rk,5.361535980117651899e-18_rk,-6.438989717917695255e-02_rk,3.717552446949008715e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.818740328508603787e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.627400487440097687e-01_rk,0.000000000000000000e+00_rk,-1.627400487440097687e-01_rk,-9.395801095028670502e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115265734084703309e-01_rk, -3.095484241390788274e-18_rk,6.190968482781577318e-18_rk,6.438989717917692479e-02_rk,5.361535980117651129e-18_rk,-6.438989717917692479e-02_rk,3.717552446949008715e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.818740328508603787e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.627400487440097410e-01_rk,0.000000000000000000e+00_rk,-1.627400487440097410e-01_rk,-9.395801095028670502e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, -4.694082178483677259e-02_rk,7.165782406798391416e-18_rk,2.802706560688800971e-19_rk,2.710129609345775931e-02_rk,2.710129609345776971e-02_rk,-1.564694059494557005e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, -1.186389784734525193e-01_rk,-6.585786275961768506e-18_rk,1.263717959442830593e-17_rk,-6.849624615803004413e-02_rk,6.849624615803004413e-02_rk,3.954632615781746713e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.694082178483689749e-02_rk,-7.817217171052811226e-18_rk,-2.218302066837397833e-17_rk,2.710129609345784604e-02_rk,-2.710129609345785645e-02_rk,1.564694059494562209e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.067899292141148564e-17_rk, -1.186389784734526442e-01_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,-6.849624615803012739e-02_rk,-6.849624615803016903e-02_rk,-3.954632615781752264e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, -1.751855318500467329e-01_rk,2.674306401815478604e-17_rk,-1.544011520983706741e-17_rk,1.011434139717522773e-01_rk,1.011434139717522634e-01_rk,-5.839517728334885083e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, -4.427666954209956707e-01_rk,-2.457848898967916927e-17_rk,1.419039723446552591e-17_rk,-2.556314707895129268e-01_rk,2.556314707895129268e-01_rk,1.475888984736650755e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.751855318500467884e-01_rk,-2.917425165616887542e-17_rk,-3.451351027744785488e-17_rk,1.011434139717522912e-01_rk,-1.011434139717522912e-01_rk,5.839517728334885083e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.427666954209957817e-01_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,-2.556314707895130378e-01_rk,-2.556314707895130378e-01_rk,-1.475888984736651033e-01_rk  &
                                        /),(/8,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%elem%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad2_dx
    !*******************************************************************************************







    !> Test cartesian dgrad3_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad3_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_ie(),self%elem%nterms_s,self%elem%nnodes_r,3) :: test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad3_dx
        ! 
        
        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.622231866529366047e-33_rk, 4.440892098500626162e-16_rk,1.244016935856292694e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930843388e-01_rk,-1.110223024625156540e-16_rk,4.146723119520981937e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,3.333333333333334814e-01_rk,-1.924500897298754287e-01_rk,-1.924500897298750957e-01_rk,-2.220446049250313081e-16_rk,1.111111111111096061e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,3.333333333333335369e-01_rk,1.924500897298754565e-01_rk,-1.924500897298754842e-01_rk,4.830583536238946849e-17_rk,-1.111111111111107858e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.330669073875469621e-16_rk,8.931639747704088472e-02_rk,5.156684612641718179e-02_rk,-5.156684612641698751e-02_rk,1.665334536937734811e-16_rk,-2.977213249234708647e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.466673899897024536e-33_rk, -5.551115123125782702e-16_rk,1.244016935856293138e+00_rk,-7.182335127930844498e-01_rk,7.182335127930846719e-01_rk,2.220446049250313081e-16_rk,-4.146723119520976941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk,3.333333333333335369e-01_rk,-1.924500897298754565e-01_rk,1.924500897298754010e-01_rk,5.551115123125782702e-17_rk,-1.111111111111107580e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.622231866529366047e-33_rk, -1.804112415015879378e-16_rk,3.333333333333334259e-01_rk,1.924500897298753732e-01_rk,1.924500897298755397e-01_rk,-1.526556658859590243e-16_rk,1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.387778780781445676e-16_rk,8.931639747704088472e-02_rk,5.156684612641718179e-02_rk,5.156684612641718179e-02_rk,0.000000000000000000e+00_rk,2.977213249234690953e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,-3.297219907631359643e-17_rk,-4.572416554211016226e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016781e-01_rk,2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, -3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,1.766974823035287141e-17_rk,-1.225175323159538865e-01_rk,-7.073553026306453329e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,-8.834874115176418757e-18_rk,-1.225175323159538865e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538587e-01_rk,7.073553026306447777e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052617862e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.282847384271379843e-02_rk,0.000000000000000000e+00_rk,-3.282847384271379843e-02_rk,-1.895352821017538478e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262492755e-01_rk, -3.533949646070574282e-17_rk,-4.396293210175147834e-17_rk,-4.572416554211017337e-01_rk,0.000000000000000000e+00_rk,4.572416554211017337e-01_rk,-2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,-4.904340331166843040e-34_rk,1.225175323159538865e-01_rk,-4.417437057588217853e-18_rk,1.225175323159538865e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, -7.067899292141148564e-17_rk,-1.177983215356859327e-17_rk,-1.225175323159538587e-01_rk,1.766974823035287141e-17_rk,1.225175323159538171e-01_rk,-7.073553026306451941e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052618556e-02_rk, 1.766974823035287141e-17_rk,0.000000000000000000e+00_rk,3.282847384271380536e-02_rk,0.000000000000000000e+00_rk,3.282847384271380536e-02_rk,1.895352821017537784e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.632101532570585087e-18_rk, 1.244016935856293138e+00_rk,-1.899062337165529150e-16_rk,1.146261613005416544e-16_rk,-7.182335127930844498e-01_rk,-7.182335127930845609e-01_rk,4.146723119520973055e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333328152e-01_rk,1.850371707708592282e-17_rk,-1.068312603546423675e-17_rk,1.924500897298750679e-01_rk,-1.924500897298750679e-01_rk,-1.111111111111108413e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.251858538542975279e-18_rk, 3.333333333333333148e-01_rk,5.551115123125786400e-17_rk,2.670781508866062808e-17_rk,-1.924500897298753732e-01_rk,1.924500897298753455e-01_rk,-1.111111111111110078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704052390e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641697363e-02_rk,5.156684612641697363e-02_rk,2.977213249234681239e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.632101532570588168e-18_rk, 1.244016935856293582e+00_rk,-1.899062337165529643e-16_rk,1.146261613005416791e-16_rk,-7.182335127930847829e-01_rk,-7.182335127930846719e-01_rk,4.146723119520975276e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595364e-17_rk,-1.068312603546425216e-17_rk,1.924500897298753455e-01_rk,-1.924500897298753455e-01_rk,-1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.251858538542989146e-18_rk, 3.333333333333338699e-01_rk,5.551115123125793795e-17_rk,2.670781508866066814e-17_rk,-1.924500897298755953e-01_rk,1.924500897298756230e-01_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704100962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641725118e-02_rk,5.156684612641725118e-02_rk,2.977213249234697198e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.081487911019577365e-33_rk, -4.440892098500626162e-16_rk,3.333333333333335924e-01_rk,-1.924500897298754842e-01_rk,-1.924500897298753177e-01_rk,2.220446049250313081e-16_rk,1.111111111111100502e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk,1.244016935856292694e+00_rk,-7.182335127930843388e-01_rk,-7.182335127930845609e-01_rk,2.220446049250313081e-16_rk,4.146723119520981937e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.081487911019577365e-33_rk, -3.330669073875469621e-16_rk,8.931639747704081533e-02_rk,5.156684612641714710e-02_rk,-5.156684612641698751e-02_rk,-1.549184512327411223e-16_rk,-2.977213249234712117e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333334814e-01_rk,1.924500897298754287e-01_rk,-1.924500897298754287e-01_rk,0.000000000000000000e+00_rk,-1.111111111111108274e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, 2.220446049250313081e-16_rk,3.333333333333334814e-01_rk,-1.924500897298754010e-01_rk,1.924500897298753455e-01_rk,-5.551115123125782702e-17_rk,-1.111111111111107164e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-16_rk,1.244016935856293360e+00_rk,-7.182335127930845609e-01_rk,7.182335127930847829e-01_rk,-3.330669073875469621e-16_rk,-4.146723119520976941e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -1.110223024625156540e-16_rk,8.931639747704085697e-02_rk,5.156684612641716098e-02_rk,5.156684612641709159e-02_rk,6.938893903907228378e-17_rk,2.977213249234689219e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,3.333333333333334814e-01_rk,1.924500897298754287e-01_rk,1.924500897298755397e-01_rk,1.110223024625156540e-16_rk,1.111111111111111466e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.122065907891939607e-01_rk, 0.000000000000000000e+00_rk,-8.834874115176443409e-18_rk,-1.225175323159539004e-01_rk,1.766974823035287141e-17_rk,-1.225175323159538587e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262492755e-01_rk, 0.000000000000000000e+00_rk,-7.846944529866948863e-33_rk,4.572416554211016781e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016781e-01_rk,-2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052613698e-02_rk, -3.533949646070574282e-17_rk,-2.367297384392152556e-18_rk,-3.282847384271377067e-02_rk,0.000000000000000000e+00_rk,-3.282847384271377067e-02_rk,1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,1.413579858428229713e-16_rk,-1.225175323159537477e-01_rk,-7.073553026306451941e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938497e-01_rk, -8.834874115176435705e-18_rk,-1.177983215356859018e-17_rk,-1.225175323159538449e-01_rk,-4.417437057588217853e-18_rk,1.225175323159538449e-01_rk,-7.073553026306454716e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262494976e-01_rk, -3.533949646070574282e-17_rk,-1.961736132466737216e-33_rk,4.572416554211017337e-01_rk,-1.766974823035287141e-17_rk,4.572416554211017337e-01_rk,2.639885928420828698e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, -8.834874115176435705e-18_rk,-3.156396512522873926e-18_rk,-3.282847384271379149e-02_rk,-4.417437057588217853e-18_rk,3.282847384271378455e-02_rk,-1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,7.073553026306456104e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.312964634635745360e-18_rk, 3.333333333333335369e-01_rk,-5.088522196198639485e-17_rk,3.071398735195974401e-17_rk,-1.924500897298754287e-01_rk,-1.924500897298754565e-01_rk,1.111111111111110633e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293138e+00_rk,6.905681226056468069e-17_rk,-3.986996914801448876e-17_rk,7.182335127930844498e-01_rk,-7.182335127930844498e-01_rk,-4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.479028023889587347e-18_rk, 8.931639747704125942e-02_rk,1.487416814333752177e-17_rk,7.156337484606396708e-18_rk,-5.156684612641741078e-02_rk,5.156684612641740384e-02_rk,-2.977213249234705525e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298754010e-01_rk,1.924500897298754010e-01_rk,1.111111111111110356e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.312964634635743820e-18_rk, 3.333333333333333148e-01_rk,-5.088522196198636403e-17_rk,3.071398735195972552e-17_rk,-1.924500897298753455e-01_rk,-1.924500897298753177e-01_rk,1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292694e+00_rk,6.905681226056465604e-17_rk,-3.986996914801447028e-17_rk,7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk,-4.146723119520970835e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.479028023889578488e-18_rk, 8.931639747704095411e-02_rk,1.487416814333747247e-17_rk,7.156337484606372056e-18_rk,-5.156684612641722343e-02_rk,5.156684612641723037e-02_rk,-2.977213249234694770e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333332038e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,1.111111111111109523e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk,3.333333333333334259e-01_rk,-1.924500897298753732e-01_rk,-1.924500897298754287e-01_rk,-5.551115123125782702e-17_rk,1.111111111111107441e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,8.931639747704091248e-02_rk,-5.156684612641718873e-02_rk,-5.156684612641704302e-02_rk,-1.110223024625156540e-16_rk,2.977213249234716974e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.848892746611746419e-32_rk, 4.440892098500626162e-16_rk,1.244016935856293138e+00_rk,7.182335127930844498e-01_rk,-7.182335127930845609e-01_rk,8.413169755531664089e-17_rk,-4.146723119520983047e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.332267629550187849e-15_rk,3.333333333333334814e-01_rk,1.924500897298754287e-01_rk,-1.924500897298748736e-01_rk,4.440892098500626162e-16_rk,-1.111111111111096061e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.155557966632341512e-33_rk, -1.804112415015879378e-16_rk,3.333333333333334259e-01_rk,-1.924500897298753732e-01_rk,1.924500897298755397e-01_rk,1.526556658859590243e-16_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,8.931639747704089860e-02_rk,-5.156684612641718873e-02_rk,5.156684612641716098e-02_rk,2.775557561562891351e-17_rk,-2.977213249234689219e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-32_rk, -5.551115123125782702e-16_rk,1.244016935856293138e+00_rk,7.182335127930844498e-01_rk,7.182335127930845609e-01_rk,-2.220446049250313081e-16_rk,4.146723119520976941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,3.333333333333334814e-01_rk,1.924500897298754287e-01_rk,1.924500897298754842e-01_rk,5.551115123125782702e-17_rk,1.111111111111108274e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.122065907891937664e-01_rk, 0.000000000000000000e+00_rk,-8.834874115176435705e-18_rk,-1.225175323159538310e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,7.073553026306445002e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052618556e-02_rk, 3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.282847384271379843e-02_rk,-1.766974823035287141e-17_rk,-3.282847384271378455e-02_rk,-1.895352821017537784e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262492755e-01_rk, 0.000000000000000000e+00_rk,-3.297219907631362724e-17_rk,-4.572416554211016781e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016781e-01_rk,2.639885928420829253e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,-7.073553026306454716e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 7.067899292141148564e-17_rk,-1.177983215356859327e-17_rk,-1.225175323159538449e-01_rk,-3.533949646070574282e-17_rk,1.225175323159538171e-01_rk,-7.073553026306450553e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052618556e-02_rk, 0.000000000000000000e+00_rk,4.904340331166843040e-34_rk,3.282847384271380536e-02_rk,4.417437057588217853e-18_rk,3.282847384271379843e-02_rk,1.895352821017537437e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262492755e-01_rk, 7.067899292141148564e-17_rk,-4.396293210175147218e-17_rk,-4.572416554211017337e-01_rk,-5.300924469105861115e-17_rk,4.572416554211017337e-01_rk,-2.639885928420828698e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, -1.766974823035287141e-17_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,7.073553026306456104e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.312964634635744205e-18_rk, 3.333333333333334259e-01_rk,-5.088522196198637020e-17_rk,3.071398735195972552e-17_rk,-1.924500897298753177e-01_rk,-1.924500897298753455e-01_rk,1.111111111111110078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704042676e-02_rk,4.958056047779128472e-18_rk,-2.862534993842532953e-18_rk,5.156684612641691812e-02_rk,-5.156684612641691812e-02_rk,-2.977213249234677422e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.452840613028234035e-17_rk, 1.244016935856293138e+00_rk,2.071704367816940914e-16_rk,9.967492287003621267e-17_rk,-7.182335127930846719e-01_rk,7.182335127930845609e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333328152e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298750401e-01_rk,1.924500897298750401e-01_rk,1.111111111111108135e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.312964634635747286e-18_rk, 3.333333333333338699e-01_rk,-5.088522196198643799e-17_rk,3.071398735195977483e-17_rk,-1.924500897298756508e-01_rk,-1.924500897298756230e-01_rk,1.111111111111111882e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704098187e-02_rk,4.958056047779159287e-18_rk,-2.862534993842550286e-18_rk,5.156684612641723037e-02_rk,-5.156684612641723037e-02_rk,-2.977213249234696157e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.452840613028235267e-17_rk, 1.244016935856293582e+00_rk,2.071704367816941160e-16_rk,9.967492287003623732e-17_rk,-7.182335127930845609e-01_rk,7.182335127930846719e-01_rk,-4.146723119520974166e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,1.111111111111110217e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.703719777548943412e-34_rk, -3.330669073875469621e-16_rk,8.931639747704091248e-02_rk,-5.156684612641719567e-02_rk,-5.156684612641704302e-02_rk,1.665334536937734811e-16_rk,2.977213249234716974e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,3.333333333333333703e-01_rk,-1.924500897298753732e-01_rk,-1.924500897298754287e-01_rk,0.000000000000000000e+00_rk,1.111111111111107719e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.232595164407830946e-32_rk, -4.440892098500626162e-16_rk,3.333333333333332038e-01_rk,1.924500897298752344e-01_rk,-1.924500897298750957e-01_rk,-1.786968256104209180e-16_rk,-1.111111111111098559e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.332267629550187849e-15_rk,1.244016935856293360e+00_rk,7.182335127930845609e-01_rk,-7.182335127930845609e-01_rk,0.000000000000000000e+00_rk,-4.146723119520984158e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.925929944387235853e-34_rk, -1.110223024625156540e-16_rk,8.931639747704087084e-02_rk,-5.156684612641717486e-02_rk,5.156684612641710547e-02_rk,-6.938893903907228378e-17_rk,-2.977213249234689912e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.387778780781445676e-16_rk,3.333333333333334814e-01_rk,-1.924500897298754287e-01_rk,1.924500897298755675e-01_rk,-1.387778780781445676e-16_rk,-1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.244463733058732095e-33_rk, 3.330669073875469621e-16_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298752067e-01_rk,1.110223024625156540e-16_rk,1.111111111111106609e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk,1.244016935856293360e+00_rk,7.182335127930845609e-01_rk,7.182335127930846719e-01_rk,1.665334536937734811e-16_rk,4.146723119520975831e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.686058463052619250e-02_rk, 3.533949646070574282e-17_rk,-2.367297384392164111e-18_rk,-3.282847384271381230e-02_rk,0.000000000000000000e+00_rk,-3.282847384271379843e-02_rk,1.895352821017538478e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938497e-01_rk, 0.000000000000000000e+00_rk,7.846944529866948863e-33_rk,1.225175323159538449e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891936554e-01_rk, 0.000000000000000000e+00_rk,-8.834874115176431083e-18_rk,-1.225175323159537616e-01_rk,0.000000000000000000e+00_rk,-1.225175323159537616e-01_rk,7.073553026306447777e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262494976e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.572416554211017337e-01_rk,-1.413579858428229713e-16_rk,-4.572416554211019002e-01_rk,-2.639885928420829253e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052617862e-02_rk, 8.834874115176435705e-18_rk,-3.156396512522877007e-18_rk,-3.282847384271379149e-02_rk,-4.417437057588217853e-18_rk,3.282847384271379843e-02_rk,-1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891938774e-01_rk, 3.533949646070574282e-17_rk,1.961736132466737216e-33_rk,1.225175323159538865e-01_rk,1.766974823035287141e-17_rk,1.225175323159538449e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937664e-01_rk, 1.766974823035287141e-17_rk,-1.177983215356858094e-17_rk,-1.225175323159538310e-01_rk,-1.325231117276465279e-17_rk,1.225175323159538310e-01_rk,-7.073553026306453329e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262494976e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.572416554211017337e-01_rk,0.000000000000000000e+00_rk,4.572416554211017337e-01_rk,2.639885928420828698e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.197570059723965479e-19_rk, 8.931639747704124555e-02_rk,-1.363465413139272444e-17_rk,8.229788107297355521e-18_rk,-5.156684612641737608e-02_rk,-5.156684612641738302e-02_rk,2.977213249234704484e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595364e-17_rk,-1.068312603546425524e-17_rk,1.924500897298753732e-01_rk,-1.924500897298753732e-01_rk,-1.111111111111110217e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.251858538542984523e-18_rk, 3.333333333333337034e-01_rk,5.551115123125791330e-17_rk,2.670781508866065889e-17_rk,-1.924500897298755675e-01_rk,1.924500897298755397e-01_rk,-1.111111111111111188e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293360e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930846719e-01_rk,7.182335127930846719e-01_rk,4.146723119520973611e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.197570059723946219e-19_rk, 8.931639747704095411e-02_rk,-1.363465413139268284e-17_rk,8.229788107297329328e-18_rk,-5.156684612641723731e-02_rk,-5.156684612641723037e-02_rk,2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333330928e-01_rk,1.850371707708593823e-17_rk,-1.068312603546424445e-17_rk,1.924500897298752344e-01_rk,-1.924500897298752344e-01_rk,-1.111111111111109107e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.251858538542975279e-18_rk, 3.333333333333333148e-01_rk,5.551115123125785167e-17_rk,2.670781508866062808e-17_rk,-1.924500897298752899e-01_rk,1.924500897298753177e-01_rk,-1.111111111111109662e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293360e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930846719e-01_rk,7.182335127930846719e-01_rk,4.146723119520973611e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,7.182335127930843388e-01_rk,7.182335127930843388e-01_rk,-5.551115123125782702e-17_rk,-4.146723119520975276e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk,-3.333333333333333703e-01_rk,1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,0.000000000000000000e+00_rk,-1.111111111111107025e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.696301922142130194e-33_rk, 9.714451465470119729e-17_rk,-3.333333333333334259e-01_rk,-1.924500897298753732e-01_rk,1.924500897298754010e-01_rk,-1.580844637608889005e-17_rk,1.111111111111110772e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.387778780781445676e-16_rk,-8.931639747704088472e-02_rk,-5.156684612641718179e-02_rk,5.156684612641719567e-02_rk,1.387778780781445676e-17_rk,2.977213249234690953e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, 2.220446049250313081e-16_rk,-1.244016935856293360e+00_rk,7.182335127930845609e-01_rk,-7.182335127930843388e-01_rk,3.330669073875469621e-16_rk,4.146723119520985268e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298753732e-01_rk,-1.924500897298757618e-01_rk,2.220446049250313081e-16_rk,1.111111111111100502e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.162975822039154730e-33_rk, -2.775557561562891351e-16_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298752067e-01_rk,-1.110223024625156540e-16_rk,-1.111111111111106609e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-8.931639747704088472e-02_rk,-5.156684612641718179e-02_rk,-5.156684612641709853e-02_rk,5.551115123125782702e-17_rk,-2.977213249234714199e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.919657785262490535e-01_rk, -3.533949646070574282e-17_rk,3.297219907631362108e-17_rk,4.572416554211016781e-01_rk,-1.766974823035287141e-17_rk,4.572416554211016781e-01_rk,-2.639885928420827588e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938497e-01_rk, 8.834874115176435705e-18_rk,0.000000000000000000e+00_rk,-1.225175323159538449e-01_rk,-4.417437057588217853e-18_rk,1.225175323159538449e-01_rk,7.073553026306453329e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, -3.533949646070574282e-17_rk,8.834874115176446491e-18_rk,1.225175323159538449e-01_rk,0.000000000000000000e+00_rk,1.225175323159538449e-01_rk,-7.073553026306451941e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052617862e-02_rk, 1.766974823035287141e-17_rk,0.000000000000000000e+00_rk,-3.282847384271379843e-02_rk,0.000000000000000000e+00_rk,3.282847384271379843e-02_rk,1.895352821017537437e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262493865e-01_rk, -1.413579858428229713e-16_rk,4.396293210175155230e-17_rk,4.572416554211018447e-01_rk,1.413579858428229713e-16_rk,-4.572416554211016226e-01_rk,2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938497e-01_rk, -3.533949646070574282e-17_rk,-1.961736132466737216e-33_rk,-1.225175323159538587e-01_rk,-1.766974823035287141e-17_rk,-1.225175323159538449e-01_rk,-7.073553026306451941e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937386e-01_rk, -1.413579858428229713e-16_rk,1.177983215356858556e-17_rk,1.225175323159538310e-01_rk,1.413579858428229713e-16_rk,-1.225175323159539698e-01_rk,7.073553026306451941e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052618556e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.282847384271380536e-02_rk,0.000000000000000000e+00_rk,-3.282847384271379843e-02_rk,-1.895352821017538478e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.632101532570588168e-18_rk, -1.244016935856293582e+00_rk,1.899062337165529397e-16_rk,-1.146261613005416791e-16_rk,7.182335127930846719e-01_rk,7.182335127930847829e-01_rk,-4.146723119520974721e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,-1.850371707708595364e-17_rk,1.068312603546425524e-17_rk,-1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,1.111111111111110217e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.251858538542989146e-18_rk, -3.333333333333338699e-01_rk,-5.551115123125793795e-17_rk,-2.670781508866067122e-17_rk,1.924500897298756785e-01_rk,-1.924500897298756508e-01_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704099574e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641724424e-02_rk,-5.156684612641724424e-02_rk,-2.977213249234696851e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.632101532570583546e-18_rk, -1.244016935856292916e+00_rk,1.899062337165528657e-16_rk,-1.146261613005416298e-16_rk,7.182335127930845609e-01_rk,7.182335127930844498e-01_rk,-4.146723119520973055e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333328152e-01_rk,-1.850371707708592282e-17_rk,1.068312603546423521e-17_rk,-1.924500897298750401e-01_rk,1.924500897298750401e-01_rk,1.111111111111108135e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.251858538542972197e-18_rk, -3.333333333333332593e-01_rk,-5.551115123125785167e-17_rk,-2.670781508866062500e-17_rk,1.924500897298752622e-01_rk,-1.924500897298752899e-01_rk,1.111111111111109662e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704045451e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641693893e-02_rk,-5.156684612641693893e-02_rk,-2.977213249234679157e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753455e-01_rk,1.924500897298754010e-01_rk,5.551115123125782702e-17_rk,-1.111111111111107719e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-1.244016935856292916e+00_rk,7.182335127930844498e-01_rk,7.182335127930843388e-01_rk,0.000000000000000000e+00_rk,-4.146723119520973611e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-33_rk, -1.665334536937734811e-16_rk,-8.931639747704085697e-02_rk,-5.156684612641717486e-02_rk,5.156684612641714710e-02_rk,3.086780614514803854e-17_rk,2.977213249234689565e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.942890293094023946e-16_rk,-3.333333333333334814e-01_rk,-1.924500897298754287e-01_rk,1.924500897298754010e-01_rk,-2.775557561562891351e-17_rk,1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.081487911019577365e-33_rk, 0.000000000000000000e+00_rk,-3.333333333333332593e-01_rk,1.924500897298752344e-01_rk,-1.924500897298755397e-01_rk,-2.220446049250313081e-16_rk,1.111111111111101613e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk,-1.244016935856293582e+00_rk,7.182335127930846719e-01_rk,-7.182335127930838947e-01_rk,-6.661338147750939243e-16_rk,4.146723119520983047e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.244463733058732095e-33_rk, 3.330669073875469621e-16_rk,-8.931639747704091248e-02_rk,-5.156684612641719567e-02_rk,-5.156684612641732057e-02_rk,1.110223024625156540e-16_rk,-2.977213249234733627e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,-1.924500897298754287e-01_rk,-1.924500897298754287e-01_rk,0.000000000000000000e+00_rk,-1.111111111111108274e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.122065907891937664e-01_rk, -8.834874115176435705e-18_rk,8.834874115176438787e-18_rk,1.225175323159538310e-01_rk,-8.834874115176435705e-18_rk,1.225175323159538310e-01_rk,-7.073553026306451941e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262492755e-01_rk, -3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-4.572416554211016781e-01_rk,1.766974823035287141e-17_rk,4.572416554211016781e-01_rk,2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052617862e-02_rk, 0.000000000000000000e+00_rk,2.367297384392155637e-18_rk,3.282847384271379149e-02_rk,0.000000000000000000e+00_rk,3.282847384271379149e-02_rk,-1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,7.073553026306454716e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937109e-01_rk, -7.067899292141148564e-17_rk,1.177983215356859327e-17_rk,1.225175323159537616e-01_rk,3.533949646070574282e-17_rk,-1.225175323159537200e-01_rk,7.073553026306445002e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262494976e-01_rk, -2.827159716856459426e-16_rk,-7.846944529866948863e-33_rk,-4.572416554211017337e-01_rk,0.000000000000000000e+00_rk,-4.572416554211017337e-01_rk,-2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052619250e-02_rk, -7.067899292141148564e-17_rk,3.156396512522870074e-18_rk,3.282847384271381230e-02_rk,3.533949646070574282e-17_rk,-3.282847384271383312e-02_rk,1.895352821017541253e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,1.413579858428229713e-16_rk,-1.225175323159537616e-01_rk,-7.073553026306451941e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.312964634635744205e-18_rk, -3.333333333333334259e-01_rk,5.088522196198637020e-17_rk,-3.071398735195972552e-17_rk,1.924500897298753177e-01_rk,1.924500897298753455e-01_rk,-1.111111111111110078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293138e+00_rk,-6.905681226056468069e-17_rk,3.986996914801448876e-17_rk,-7.182335127930844498e-01_rk,7.182335127930844498e-01_rk,4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.479028023889579258e-18_rk, -8.931639747704096799e-02_rk,-1.487416814333747863e-17_rk,-7.156337484606375138e-18_rk,5.156684612641725118e-02_rk,-5.156684612641724424e-02_rk,2.977213249234696504e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333148e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298753455e-01_rk,-1.924500897298753455e-01_rk,-1.111111111111109662e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.312964634635747286e-18_rk, -3.333333333333338699e-01_rk,5.088522196198643799e-17_rk,-3.071398735195977483e-17_rk,1.924500897298756508e-01_rk,1.924500897298756230e-01_rk,-1.111111111111111882e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293138e+00_rk,-6.905681226056469302e-17_rk,3.986996914801448260e-17_rk,-7.182335127930845609e-01_rk,7.182335127930845609e-01_rk,4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.479028023889585421e-18_rk, -8.931639747704119003e-02_rk,-1.487416814333751253e-17_rk,-7.156337484606393627e-18_rk,5.156684612641736221e-02_rk,-5.156684612641736914e-02_rk,2.977213249234703443e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298753732e-01_rk,-1.924500897298753732e-01_rk,-1.111111111111110217e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.666684749742561339e-34_rk, 1.387778780781445676e-16_rk,-3.333333333333334259e-01_rk,1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,-1.387778780781445676e-17_rk,-1.111111111111110772e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-8.931639747704087084e-02_rk,5.156684612641717486e-02_rk,5.156684612641718873e-02_rk,-1.387778780781445676e-17_rk,-2.977213249234690606e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,-7.182335127930843388e-01_rk,7.182335127930843388e-01_rk,4.830583536238946849e-17_rk,4.146723119520975276e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-3.333333333333334814e-01_rk,-1.924500897298754287e-01_rk,1.924500897298754842e-01_rk,5.551115123125782702e-17_rk,1.111111111111108274e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.703719777548943412e-34_rk, -1.665334536937734811e-16_rk,-3.333333333333334259e-01_rk,1.924500897298753732e-01_rk,-1.924500897298753177e-01_rk,5.551115123125782702e-17_rk,1.111111111111107441e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk,-8.931639747704085697e-02_rk,5.156684612641717486e-02_rk,-5.156684612641726506e-02_rk,5.551115123125782702e-17_rk,2.977213249234725301e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.162975822039154730e-33_rk, 2.220446049250313081e-16_rk,-1.244016935856293138e+00_rk,-7.182335127930844498e-01_rk,-7.182335127930841168e-01_rk,-3.330669073875469621e-16_rk,-4.146723119520984158e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.881784197001252323e-16_rk,-3.333333333333334814e-01_rk,-1.924500897298754287e-01_rk,-1.924500897298750957e-01_rk,2.220446049250313081e-16_rk,-1.111111111111097172e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 3.533949646070574282e-17_rk,8.834874115176431083e-18_rk,1.225175323159538449e-01_rk,0.000000000000000000e+00_rk,1.225175323159538449e-01_rk,-7.073553026306450553e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052617862e-02_rk, -8.834874115176435705e-18_rk,0.000000000000000000e+00_rk,-3.282847384271379843e-02_rk,4.417437057588217853e-18_rk,3.282847384271378455e-02_rk,1.895352821017537437e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262490535e-01_rk, 3.533949646070574282e-17_rk,3.297219907631359643e-17_rk,4.572416554211016781e-01_rk,-1.766974823035287141e-17_rk,4.572416554211016781e-01_rk,-2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, -1.766974823035287141e-17_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,0.000000000000000000e+00_rk,1.225175323159538865e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938497e-01_rk, 1.413579858428229713e-16_rk,1.177983215356855475e-17_rk,1.225175323159538310e-01_rk,-1.413579858428229713e-16_rk,-1.225175323159539698e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052617862e-02_rk, 3.533949646070574282e-17_rk,1.961736132466737216e-33_rk,-3.282847384271379843e-02_rk,1.766974823035287141e-17_rk,-3.282847384271381924e-02_rk,-1.895352821017538478e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262490535e-01_rk, 1.413579858428229713e-16_rk,4.396293210175149067e-17_rk,4.572416554211016781e-01_rk,-1.413579858428229713e-16_rk,-4.572416554211014561e-01_rk,2.639885928420828143e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538865e-01_rk,-7.073553026306456104e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.312964634635747286e-18_rk, -3.333333333333338699e-01_rk,5.088522196198643799e-17_rk,-3.071398735195977483e-17_rk,1.924500897298756230e-01_rk,1.924500897298756508e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704096799e-02_rk,-4.958056047779157746e-18_rk,2.862534993842550286e-18_rk,-5.156684612641723037e-02_rk,5.156684612641723037e-02_rk,2.977213249234695810e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.452840613028235267e-17_rk, -1.244016935856293582e+00_rk,-2.071704367816941653e-16_rk,-9.967492287003623732e-17_rk,7.182335127930848939e-01_rk,-7.182335127930847829e-01_rk,4.146723119520975831e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298754010e-01_rk,-1.924500897298754010e-01_rk,-1.111111111111110356e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.312964634635743820e-18_rk, -3.333333333333333148e-01_rk,5.088522196198636403e-17_rk,-3.071398735195972552e-17_rk,1.924500897298753455e-01_rk,1.924500897298753177e-01_rk,-1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704057941e-02_rk,-4.958056047779136946e-18_rk,2.862534993842537190e-18_rk,-5.156684612641699444e-02_rk,5.156684612641699444e-02_rk,2.977213249234682280e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.452840613028233418e-17_rk, -1.244016935856292916e+00_rk,-2.071704367816940174e-16_rk,-9.967492287003617569e-17_rk,7.182335127930843388e-01_rk,-7.182335127930844498e-01_rk,4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333330928e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298751789e-01_rk,-1.924500897298751789e-01_rk,-1.111111111111108968e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 9.629649721936179265e-34_rk, -1.665334536937734811e-16_rk,-8.931639747704084309e-02_rk,5.156684612641716098e-02_rk,5.156684612641713322e-02_rk,-2.775557561562891351e-17_rk,-2.977213249234688525e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk,-3.333333333333334259e-01_rk,1.924500897298754010e-01_rk,1.924500897298754287e-01_rk,0.000000000000000000e+00_rk,-1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,-1.924500897298754287e-01_rk,1.924500897298754842e-01_rk,-4.389614877022546211e-17_rk,1.111111111111107719e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856293360e+00_rk,-7.182335127930845609e-01_rk,7.182335127930845609e-01_rk,0.000000000000000000e+00_rk,4.146723119520975276e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, 2.220446049250313081e-16_rk,-8.931639747704080146e-02_rk,5.156684612641714016e-02_rk,-5.156684612641720955e-02_rk,-5.551115123125782702e-17_rk,2.977213249234722525e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk,-3.333333333333335369e-01_rk,1.924500897298754565e-01_rk,-1.924500897298752622e-01_rk,-1.665334536937734811e-16_rk,1.111111111111107441e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.232595164407830946e-32_rk, 0.000000000000000000e+00_rk,-3.333333333333336479e-01_rk,-1.924500897298754842e-01_rk,-1.924500897298757618e-01_rk,2.220446049250313081e-16_rk,-1.111111111111103833e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.332267629550187849e-15_rk,-1.244016935856293360e+00_rk,-7.182335127930845609e-01_rk,-7.182335127930845609e-01_rk,0.000000000000000000e+00_rk,-4.146723119520984158e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,2.367297384392155637e-18_rk,3.282847384271378455e-02_rk,0.000000000000000000e+00_rk,3.282847384271379149e-02_rk,-1.895352821017536743e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938497e-01_rk, 3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-1.225175323159538449e-01_rk,-1.766974823035287141e-17_rk,1.225175323159538865e-01_rk,7.073553026306453329e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938497e-01_rk, 0.000000000000000000e+00_rk,8.834874115176440328e-18_rk,1.225175323159538587e-01_rk,-4.417437057588217853e-18_rk,1.225175323159538587e-01_rk,-7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262494976e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.572416554211017337e-01_rk,0.000000000000000000e+00_rk,4.572416554211017337e-01_rk,2.639885928420828698e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052613698e-02_rk, 7.067899292141148564e-17_rk,3.156396512522862370e-18_rk,3.282847384271377067e-02_rk,-3.533949646070574282e-17_rk,-3.282847384271379843e-02_rk,1.895352821017538478e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891938774e-01_rk, 2.827159716856459426e-16_rk,7.846944529866948863e-33_rk,-1.225175323159538865e-01_rk,0.000000000000000000e+00_rk,-1.225175323159539004e-01_rk,-7.073553026306463043e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891939607e-01_rk, 7.067899292141148564e-17_rk,1.177983215356860867e-17_rk,1.225175323159539559e-01_rk,0.000000000000000000e+00_rk,-1.225175323159539142e-01_rk,7.073553026306456104e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262494976e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.572416554211017337e-01_rk,-1.413579858428229713e-16_rk,-4.572416554211019002e-01_rk,-2.639885928420828698e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.197570059723948145e-19_rk, -8.931639747704096799e-02_rk,1.363465413139268746e-17_rk,-8.229788107297333951e-18_rk,5.156684612641723731e-02_rk,5.156684612641724424e-02_rk,-2.977213249234695810e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333332593e-01_rk,-1.850371707708594439e-17_rk,1.068312603546424907e-17_rk,-1.924500897298752622e-01_rk,1.924500897298752622e-01_rk,1.111111111111109662e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.251858538542973738e-18_rk, -3.333333333333333148e-01_rk,-5.551115123125785167e-17_rk,-2.670781508866062191e-17_rk,1.924500897298753455e-01_rk,-1.924500897298753177e-01_rk,1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293360e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930846719e-01_rk,-7.182335127930846719e-01_rk,-4.146723119520973611e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.197570059723965479e-19_rk, -8.931639747704121779e-02_rk,1.363465413139272444e-17_rk,-8.229788107297353980e-18_rk,5.156684612641738996e-02_rk,5.156684612641738302e-02_rk,-2.977213249234704137e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,-1.850371707708595364e-17_rk,1.068312603546425216e-17_rk,-1.924500897298753455e-01_rk,1.924500897298753455e-01_rk,1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.251858538542981442e-18_rk, -3.333333333333335369e-01_rk,-5.551115123125788865e-17_rk,-2.670781508866064348e-17_rk,1.924500897298754287e-01_rk,-1.924500897298754565e-01_rk,1.111111111111110633e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293582e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930847829e-01_rk,-7.182335127930847829e-01_rk,-4.146723119520974166e-01_rk  &
                                        /),(/8,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%elem%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad3_dx
    !*******************************************************************************************








    !> Test cartesian dinvmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dinvmass_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nnodes_r,3) :: test_dinvmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dinvmass_dx
        ! 
        test_dinvmass_dx(:,:,1,1) = reshape((/                                                                                 &
                                        6.215518487612483461e-02_rk, -6.215518487612482768e-02_rk, -6.215518487612482074e-02_rk,2.825235676187493050e-02_rk,-2.825235676187490622e-02_rk,-2.825235676187491315e-02_rk,6.215518487612482768e-02_rk,2.825235676187492356e-02_rk, &
                                        -6.215518487612481380e-02_rk, 1.864655546283745247e-01_rk, 6.215518487612483461e-02_rk,-2.825235676187492356e-02_rk,8.475707028562476375e-02_rk,2.825235676187491662e-02_rk,-1.864655546283743859e-01_rk,-8.475707028562477763e-02_rk, &
                                        -6.215518487612481380e-02_rk, 6.215518487612485543e-02_rk, 1.864655546283745247e-01_rk,-2.825235676187492356e-02_rk,2.825235676187491662e-02_rk,8.475707028562476375e-02_rk,-1.864655546283743859e-01_rk,-8.475707028562477763e-02_rk, &
                                        2.825235676187492009e-02_rk, -2.825235676187491662e-02_rk, -2.825235676187490969e-02_rk,1.864655546283744969e-01_rk,-1.864655546283743859e-01_rk,-1.864655546283743859e-01_rk,2.825235676187491662e-02_rk,1.864655546283743859e-01_rk, &
                                        -2.825235676187492356e-02_rk, 8.475707028562476375e-02_rk, 2.825235676187493050e-02_rk,-1.864655546283744136e-01_rk,5.593966638851233242e-01_rk,1.864655546283743581e-01_rk,-8.475707028562477763e-02_rk,-5.593966638851233242e-01_rk, &
                                        -2.825235676187492009e-02_rk, 2.825235676187490969e-02_rk, 8.475707028562477763e-02_rk,-1.864655546283744414e-01_rk,1.864655546283743581e-01_rk,5.593966638851233242e-01_rk,-8.475707028562479151e-02_rk,-5.593966638851233242e-01_rk, &
                                        6.215518487612481380e-02_rk, -1.864655546283744414e-01_rk, -1.864655546283744136e-01_rk,2.825235676187489581e-02_rk,-8.475707028562469436e-02_rk,-8.475707028562472212e-02_rk,5.593966638851233242e-01_rk,2.542712108568743190e-01_rk, &
                                        2.825235676187491662e-02_rk, -8.475707028562468048e-02_rk, -8.475707028562479151e-02_rk,1.864655546283743859e-01_rk,-5.593966638851233242e-01_rk,-5.593966638851233242e-01_rk,2.542712108568742080e-01_rk,1.678189991655370417e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,1,2) = reshape((/                                                                                 &
                                        7.793937203256751101e-02_rk, 2.602085213965210642e-18_rk, -7.793937203256751101e-02_rk,-9.352724643908100211e-02_rk,-1.734723475976807094e-18_rk,9.352724643908098823e-02_rk,-1.561251128379126385e-17_rk,1.040834085586084257e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.338181160977025608e-01_rk, -2.081668171172168513e-17_rk,1.734723475976807094e-18_rk,-2.805817393172429508e-01_rk,-6.938893903907228378e-18_rk,-2.338181160977025053e-01_rk,2.805817393172430063e-01_rk, &
                                        -7.793937203256752488e-02_rk, 0.000000000000000000e+00_rk, 2.338181160977025608e-01_rk,9.352724643908097435e-02_rk,-6.938893903907228378e-18_rk,-2.805817393172429508e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        -9.352724643908101598e-02_rk, -1.734723475976807094e-18_rk, 9.352724643908102986e-02_rk,2.338181160977025330e-01_rk,-6.938893903907228378e-18_rk,-2.338181160977025053e-01_rk,-6.938893903907228378e-18_rk,1.387778780781445676e-17_rk, &
                                        1.734723475976807094e-18_rk, -2.805817393172429508e-01_rk, -1.040834085586084257e-17_rk,0.000000000000000000e+00_rk,7.014543482931077101e-01_rk,0.000000000000000000e+00_rk,2.805817393172430063e-01_rk,-7.014543482931075991e-01_rk, &
                                        9.352724643908100211e-02_rk, 6.938893903907228378e-18_rk, -2.805817393172429508e-01_rk,-2.338181160977025330e-01_rk,0.000000000000000000e+00_rk,7.014543482931077101e-01_rk,-2.081668171172168513e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.338181160977025053e-01_rk, -2.775557561562891351e-17_rk,3.469446951953614189e-18_rk,2.805817393172429508e-01_rk,6.938893903907228378e-18_rk,7.014543482931074880e-01_rk,-8.417452179517288524e-01_rk, &
                                        -6.938893903907228378e-18_rk, 2.805817393172430618e-01_rk, -4.857225732735059864e-17_rk,1.387778780781445676e-17_rk,-7.014543482931074880e-01_rk,0.000000000000000000e+00_rk,-8.417452179517288524e-01_rk,2.104363044879322686e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.224268793014579720e-01_rk, -1.224268793014579582e-01_rk, 1.040834085586084257e-17_rk,-1.469122551617495220e-01_rk,1.469122551617495498e-01_rk,-1.040834085586084257e-17_rk,-3.122502256758252770e-17_rk,4.163336342344337027e-17_rk, &
                                        -1.224268793014579582e-01_rk, 3.672806379043738745e-01_rk, -1.040834085586084257e-17_rk,1.469122551617495498e-01_rk,-4.407367654852485384e-01_rk,-3.469446951953614189e-18_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, 1.734723475976807094e-17_rk, 3.672806379043738745e-01_rk,1.040834085586084257e-17_rk,-3.469446951953614189e-18_rk,-4.407367654852485384e-01_rk,-3.672806379043737635e-01_rk,4.407367654852484828e-01_rk, &
                                        -1.469122551617495498e-01_rk, 1.469122551617495498e-01_rk, 1.040834085586084257e-17_rk,3.672806379043739300e-01_rk,-3.672806379043737635e-01_rk,1.387778780781445676e-17_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk, &
                                        1.469122551617495498e-01_rk, -4.407367654852485384e-01_rk, 3.469446951953614189e-18_rk,-3.672806379043738190e-01_rk,1.101841913713121679e+00_rk,-1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 1.734723475976807094e-17_rk, -4.407367654852484828e-01_rk,-1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk,1.101841913713121679e+00_rk,4.407367654852484828e-01_rk,-1.101841913713121457e+00_rk, &
                                        3.469446951953614189e-18_rk, -1.387778780781445676e-17_rk, -3.672806379043737635e-01_rk,3.469446951953614189e-18_rk,3.469446951953614189e-17_rk,4.407367654852484273e-01_rk,1.101841913713121457e+00_rk,-1.322210296455745615e+00_rk, &
                                        -3.469446951953614189e-18_rk, 2.775557561562891351e-17_rk, 4.407367654852485939e-01_rk,0.000000000000000000e+00_rk,8.326672684688674053e-17_rk,-1.101841913713121457e+00_rk,-1.322210296455745837e+00_rk,3.305525741139364815e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.412617838093745970e-01_rk, 1.412617838093745692e-01_rk, 1.412617838093745692e-01_rk,2.260188540949986669e-02_rk,-2.260188540949991179e-02_rk,-2.260188540949990485e-02_rk,-1.412617838093745970e-01_rk,2.260188540949985975e-02_rk, &
                                        1.412617838093745415e-01_rk, -4.237853514281237910e-01_rk, -1.412617838093745970e-01_rk,-2.260188540949987362e-02_rk,6.780565622849968332e-02_rk,2.260188540949990138e-02_rk,4.237853514281236245e-01_rk,-6.780565622849966945e-02_rk, &
                                        1.412617838093745415e-01_rk, -1.412617838093746248e-01_rk, -4.237853514281237910e-01_rk,-2.260188540949987362e-02_rk,2.260188540949990138e-02_rk,6.780565622849968332e-02_rk,4.237853514281236245e-01_rk,-6.780565622849966945e-02_rk, &
                                        2.260188540949989097e-02_rk, -2.260188540949990138e-02_rk, -2.260188540949990832e-02_rk,-4.237853514281237355e-01_rk,4.237853514281236245e-01_rk,4.237853514281236245e-01_rk,2.260188540949990138e-02_rk,-4.237853514281236245e-01_rk, &
                                        -2.260188540949989444e-02_rk, 6.780565622849965557e-02_rk, 2.260188540949985975e-02_rk,4.237853514281236800e-01_rk,-1.271356054284371151e+00_rk,-4.237853514281235690e-01_rk,-6.780565622849964169e-02_rk,1.271356054284371151e+00_rk, &
                                        -2.260188540949989791e-02_rk, 2.260188540949989444e-02_rk, 6.780565622849966945e-02_rk,4.237853514281236800e-01_rk,-4.237853514281235690e-01_rk,-1.271356054284371151e+00_rk,-6.780565622849965557e-02_rk,1.271356054284371151e+00_rk, &
                                        -1.412617838093745415e-01_rk, 4.237853514281236800e-01_rk, 4.237853514281236245e-01_rk,2.260188540949990832e-02_rk,-6.780565622849966945e-02_rk,-6.780565622849964169e-02_rk,-1.271356054284371151e+00_rk,2.034169686854988834e-01_rk, &
                                        2.260188540949990138e-02_rk, -6.780565622849982210e-02_rk, -6.780565622849968332e-02_rk,-4.237853514281236245e-01_rk,1.271356054284370929e+00_rk,1.271356054284371151e+00_rk,2.034169686854991332e-01_rk,-3.814068162853113453e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,2) = reshape((/                                                                                 &
                                        6.235149762605401991e-02_rk, 4.336808689942017736e-18_rk, -6.235149762605404072e-02_rk,4.676362321954055656e-02_rk,1.734723475976807094e-18_rk,-4.676362321954052881e-02_rk,1.561251128379126385e-17_rk,1.734723475976807094e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.870544928781621430e-01_rk, -6.938893903907228378e-18_rk,-1.734723475976807094e-18_rk,1.402908696586215864e-01_rk,6.938893903907228378e-18_rk,-1.870544928781620597e-01_rk,-1.402908696586216419e-01_rk, &
                                        -6.235149762605403378e-02_rk, 0.000000000000000000e+00_rk, 1.870544928781621430e-01_rk,-4.676362321954057738e-02_rk,6.938893903907228378e-18_rk,1.402908696586215864e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        4.676362321954054269e-02_rk, 1.734723475976807094e-18_rk, -4.676362321954054269e-02_rk,1.870544928781620597e-01_rk,-6.938893903907228378e-18_rk,-1.870544928781620597e-01_rk,6.938893903907228378e-18_rk,1.387778780781445676e-17_rk, &
                                        -1.734723475976807094e-18_rk, 1.402908696586216142e-01_rk, 3.816391647148975608e-17_rk,0.000000000000000000e+00_rk,5.611634786344861237e-01_rk,0.000000000000000000e+00_rk,-1.402908696586215864e-01_rk,-5.611634786344862347e-01_rk, &
                                        -4.676362321954053575e-02_rk, -6.938893903907228378e-18_rk, 1.402908696586215864e-01_rk,-1.870544928781620597e-01_rk,0.000000000000000000e+00_rk,5.611634786344861237e-01_rk,-3.469446951953614189e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.870544928781620875e-01_rk, -2.775557561562891351e-17_rk,-3.469446951953614189e-18_rk,-1.402908696586215864e-01_rk,-6.938893903907228378e-18_rk,5.611634786344861237e-01_rk,4.208726089758649258e-01_rk, &
                                        6.938893903907228378e-18_rk, -1.402908696586215309e-01_rk, -3.469446951953614189e-17_rk,1.387778780781445676e-17_rk,-5.611634786344861237e-01_rk,0.000000000000000000e+00_rk,4.208726089758647593e-01_rk,1.683490435903458593e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,3) = reshape((/                                                                                 &
                                        9.794150344116638041e-02_rk, -9.794150344116638041e-02_rk, 3.469446951953614189e-18_rk,7.345612758087483041e-02_rk,-7.345612758087480265e-02_rk,1.734723475976807094e-17_rk,1.040834085586084257e-17_rk,1.387778780781445676e-17_rk, &
                                        -9.794150344116639428e-02_rk, 2.938245103234991551e-01_rk, 3.469446951953614189e-18_rk,-7.345612758087484429e-02_rk,2.203683827426242969e-01_rk,1.734723475976807094e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 1.734723475976807094e-17_rk, 2.938245103234991551e-01_rk,-1.040834085586084257e-17_rk,1.734723475976807094e-17_rk,2.203683827426242969e-01_rk,-2.938245103234990441e-01_rk,-2.203683827426243247e-01_rk, &
                                        7.345612758087480265e-02_rk, -7.345612758087480265e-02_rk, 3.469446951953614189e-18_rk,2.938245103234992106e-01_rk,-2.938245103234990441e-01_rk,0.000000000000000000e+00_rk,1.734723475976807094e-17_rk,0.000000000000000000e+00_rk, &
                                        -7.345612758087480265e-02_rk, 2.203683827426244080e-01_rk, 3.816391647148975608e-17_rk,-2.938245103234990996e-01_rk,8.814735309704974098e-01_rk,-1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        6.938893903907228378e-18_rk, -3.122502256758252770e-17_rk, 2.203683827426243247e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,8.814735309704974098e-01_rk,-2.203683827426243247e-01_rk,-8.814735309704974098e-01_rk, &
                                        3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, -2.938245103234990441e-01_rk,-4.510281037539698445e-17_rk,2.081668171172168513e-17_rk,-2.203683827426243524e-01_rk,8.814735309704972988e-01_rk,6.611051482278733626e-01_rk, &
                                        1.734723475976807094e-17_rk, 2.775557561562891351e-17_rk, -2.203683827426243247e-01_rk,0.000000000000000000e+00_rk,1.387778780781445676e-16_rk,-8.814735309704974098e-01_rk,6.611051482278731406e-01_rk,2.644420592911492118e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,1) = reshape((/                                                                                 &
                                        6.215518487612483461e-02_rk, 6.215518487612484155e-02_rk, -6.215518487612482074e-02_rk,2.825235676187493744e-02_rk,2.825235676187492703e-02_rk,-2.825235676187492703e-02_rk,-6.215518487612480686e-02_rk,-2.825235676187489581e-02_rk, &
                                        6.215518487612482768e-02_rk, 1.864655546283745247e-01_rk, -6.215518487612484155e-02_rk,2.825235676187492356e-02_rk,8.475707028562476375e-02_rk,-2.825235676187491662e-02_rk,-1.864655546283743581e-01_rk,-8.475707028562477763e-02_rk, &
                                        -6.215518487612481380e-02_rk, -6.215518487612483461e-02_rk, 1.864655546283745247e-01_rk,-2.825235676187492356e-02_rk,-2.825235676187491662e-02_rk,8.475707028562476375e-02_rk,1.864655546283743859e-01_rk,8.475707028562477763e-02_rk, &
                                        2.825235676187492009e-02_rk, 2.825235676187491662e-02_rk, -2.825235676187490969e-02_rk,1.864655546283744969e-01_rk,1.864655546283743859e-01_rk,-1.864655546283743581e-01_rk,-2.825235676187491662e-02_rk,-1.864655546283743859e-01_rk, &
                                        2.825235676187492356e-02_rk, 8.475707028562476375e-02_rk, -2.825235676187489234e-02_rk,1.864655546283744136e-01_rk,5.593966638851233242e-01_rk,-1.864655546283743859e-01_rk,-8.475707028562476375e-02_rk,-5.593966638851233242e-01_rk, &
                                        -2.825235676187492009e-02_rk, -2.825235676187490969e-02_rk, 8.475707028562474987e-02_rk,-1.864655546283744691e-01_rk,-1.864655546283743859e-01_rk,5.593966638851233242e-01_rk,8.475707028562476375e-02_rk,5.593966638851233242e-01_rk, &
                                        -6.215518487612480686e-02_rk, -1.864655546283744691e-01_rk, 1.864655546283743581e-01_rk,-2.825235676187492356e-02_rk,-8.475707028562472212e-02_rk,8.475707028562474987e-02_rk,5.593966638851233242e-01_rk,2.542712108568743190e-01_rk, &
                                        -2.825235676187491662e-02_rk, -8.475707028562468048e-02_rk, 8.475707028562473599e-02_rk,-1.864655546283743859e-01_rk,-5.593966638851235462e-01_rk,5.593966638851233242e-01_rk,2.542712108568742080e-01_rk,1.678189991655370417e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -7.793937203256751101e-02_rk, -2.602085213965210642e-18_rk, 7.793937203256751101e-02_rk,9.352724643908100211e-02_rk,1.734723475976807094e-18_rk,-9.352724643908098823e-02_rk,1.561251128379126385e-17_rk,-1.040834085586084257e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.338181160977025608e-01_rk, 2.081668171172168513e-17_rk,-1.734723475976807094e-18_rk,2.805817393172429508e-01_rk,6.938893903907228378e-18_rk,2.338181160977025053e-01_rk,-2.805817393172430063e-01_rk, &
                                        7.793937203256752488e-02_rk, 0.000000000000000000e+00_rk, -2.338181160977025608e-01_rk,-9.352724643908097435e-02_rk,6.938893903907228378e-18_rk,2.805817393172429508e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        9.352724643908101598e-02_rk, 1.734723475976807094e-18_rk, -9.352724643908102986e-02_rk,-2.338181160977025330e-01_rk,6.938893903907228378e-18_rk,2.338181160977025053e-01_rk,6.938893903907228378e-18_rk,-1.387778780781445676e-17_rk, &
                                        -1.734723475976807094e-18_rk, 2.805817393172429508e-01_rk, 1.040834085586084257e-17_rk,0.000000000000000000e+00_rk,-7.014543482931077101e-01_rk,0.000000000000000000e+00_rk,-2.805817393172430063e-01_rk,7.014543482931075991e-01_rk, &
                                        -9.352724643908100211e-02_rk, -6.938893903907228378e-18_rk, 2.805817393172429508e-01_rk,2.338181160977025330e-01_rk,0.000000000000000000e+00_rk,-7.014543482931077101e-01_rk,2.081668171172168513e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.338181160977025053e-01_rk, 2.775557561562891351e-17_rk,-3.469446951953614189e-18_rk,-2.805817393172429508e-01_rk,-6.938893903907228378e-18_rk,-7.014543482931074880e-01_rk,8.417452179517288524e-01_rk, &
                                        6.938893903907228378e-18_rk, -2.805817393172430618e-01_rk, 4.857225732735059864e-17_rk,-1.387778780781445676e-17_rk,7.014543482931074880e-01_rk,0.000000000000000000e+00_rk,8.417452179517288524e-01_rk,-2.104363044879322686e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.224268793014579720e-01_rk, 1.224268793014579582e-01_rk, 3.469446951953614189e-18_rk,-1.469122551617495220e-01_rk,-1.469122551617495498e-01_rk,-1.040834085586084257e-17_rk,-1.040834085586084257e-17_rk,4.163336342344337027e-17_rk, &
                                        1.224268793014579582e-01_rk, 3.672806379043738745e-01_rk, -1.734723475976807094e-17_rk,-1.469122551617495498e-01_rk,-4.407367654852485384e-01_rk,-1.040834085586084257e-17_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        1.734723475976807094e-17_rk, -3.469446951953614189e-18_rk, 3.672806379043738745e-01_rk,1.040834085586084257e-17_rk,-1.040834085586084257e-17_rk,-4.407367654852485384e-01_rk,3.672806379043737635e-01_rk,-4.407367654852484828e-01_rk, &
                                        -1.469122551617495498e-01_rk, -1.469122551617495498e-01_rk, 1.040834085586084257e-17_rk,3.672806379043739300e-01_rk,3.672806379043737635e-01_rk,2.775557561562891351e-17_rk,-1.040834085586084257e-17_rk,0.000000000000000000e+00_rk, &
                                        -1.469122551617495498e-01_rk, -4.407367654852485384e-01_rk, 1.040834085586084257e-17_rk,3.672806379043738190e-01_rk,1.101841913713121679e+00_rk,1.387778780781445676e-17_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, -3.469446951953614189e-18_rk, -4.407367654852484828e-01_rk,-2.775557561562891351e-17_rk,1.387778780781445676e-17_rk,1.101841913713121679e+00_rk,-4.407367654852484828e-01_rk,1.101841913713121457e+00_rk, &
                                        -3.469446951953614189e-18_rk, -2.775557561562891351e-17_rk, 3.672806379043737635e-01_rk,-1.734723475976807094e-17_rk,2.081668171172168513e-17_rk,-4.407367654852484273e-01_rk,1.101841913713121457e+00_rk,-1.322210296455745615e+00_rk, &
                                        -1.040834085586084257e-17_rk, 2.775557561562891351e-17_rk, -4.407367654852485939e-01_rk,0.000000000000000000e+00_rk,-8.326672684688674053e-17_rk,1.101841913713121457e+00_rk,-1.322210296455745837e+00_rk,3.305525741139364815e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.412617838093745970e-01_rk, -1.412617838093745970e-01_rk, 1.412617838093745692e-01_rk,2.260188540949985975e-02_rk,2.260188540949989097e-02_rk,-2.260188540949989097e-02_rk,1.412617838093745692e-01_rk,-2.260188540949994301e-02_rk, &
                                        -1.412617838093745692e-01_rk, -4.237853514281237910e-01_rk, 1.412617838093745970e-01_rk,2.260188540949987362e-02_rk,6.780565622849968332e-02_rk,-2.260188540949990138e-02_rk,4.237853514281235690e-01_rk,-6.780565622849966945e-02_rk, &
                                        1.412617838093745415e-01_rk, 1.412617838093745970e-01_rk, -4.237853514281237910e-01_rk,-2.260188540949987362e-02_rk,-2.260188540949990138e-02_rk,6.780565622849968332e-02_rk,-4.237853514281236245e-01_rk,6.780565622849966945e-02_rk, &
                                        2.260188540949989097e-02_rk, 2.260188540949990138e-02_rk, -2.260188540949990832e-02_rk,-4.237853514281237355e-01_rk,-4.237853514281236245e-01_rk,4.237853514281235690e-01_rk,-2.260188540949990138e-02_rk,4.237853514281236245e-01_rk, &
                                        2.260188540949989444e-02_rk, 6.780565622849965557e-02_rk, -2.260188540949993261e-02_rk,-4.237853514281236800e-01_rk,-1.271356054284371151e+00_rk,4.237853514281236245e-01_rk,-6.780565622849968332e-02_rk,1.271356054284371151e+00_rk, &
                                        -2.260188540949989791e-02_rk, -2.260188540949989444e-02_rk, 6.780565622849969720e-02_rk,4.237853514281236800e-01_rk,4.237853514281236245e-01_rk,-1.271356054284371151e+00_rk,6.780565622849968332e-02_rk,-1.271356054284371151e+00_rk, &
                                        1.412617838093745415e-01_rk, 4.237853514281236800e-01_rk, -4.237853514281236245e-01_rk,-2.260188540949988056e-02_rk,-6.780565622849969720e-02_rk,6.780565622849966945e-02_rk,-1.271356054284371151e+00_rk,2.034169686854988834e-01_rk, &
                                        -2.260188540949990138e-02_rk, -6.780565622849982210e-02_rk, 6.780565622849979435e-02_rk,4.237853514281236245e-01_rk,1.271356054284371151e+00_rk,-1.271356054284371151e+00_rk,2.034169686854990777e-01_rk,-3.814068162853113453e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -6.235149762605401991e-02_rk, -4.336808689942017736e-18_rk, 6.235149762605404072e-02_rk,-4.676362321954055656e-02_rk,-1.734723475976807094e-18_rk,4.676362321954052881e-02_rk,-1.561251128379126385e-17_rk,-1.734723475976807094e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.870544928781621430e-01_rk, 6.938893903907228378e-18_rk,1.734723475976807094e-18_rk,-1.402908696586215864e-01_rk,-6.938893903907228378e-18_rk,1.870544928781620597e-01_rk,1.402908696586216419e-01_rk, &
                                        6.235149762605403378e-02_rk, 0.000000000000000000e+00_rk, -1.870544928781621430e-01_rk,4.676362321954057738e-02_rk,-6.938893903907228378e-18_rk,-1.402908696586215864e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        -4.676362321954054269e-02_rk, -1.734723475976807094e-18_rk, 4.676362321954054269e-02_rk,-1.870544928781620597e-01_rk,6.938893903907228378e-18_rk,1.870544928781620597e-01_rk,-6.938893903907228378e-18_rk,-1.387778780781445676e-17_rk, &
                                        1.734723475976807094e-18_rk, -1.402908696586216142e-01_rk, -3.816391647148975608e-17_rk,0.000000000000000000e+00_rk,-5.611634786344861237e-01_rk,0.000000000000000000e+00_rk,1.402908696586215864e-01_rk,5.611634786344862347e-01_rk, &
                                        4.676362321954053575e-02_rk, 6.938893903907228378e-18_rk, -1.402908696586215864e-01_rk,1.870544928781620597e-01_rk,0.000000000000000000e+00_rk,-5.611634786344861237e-01_rk,3.469446951953614189e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.870544928781620875e-01_rk, 2.775557561562891351e-17_rk,3.469446951953614189e-18_rk,1.402908696586215864e-01_rk,6.938893903907228378e-18_rk,-5.611634786344861237e-01_rk,-4.208726089758649258e-01_rk, &
                                        -6.938893903907228378e-18_rk, 1.402908696586215309e-01_rk, 3.469446951953614189e-17_rk,-1.387778780781445676e-17_rk,5.611634786344861237e-01_rk,0.000000000000000000e+00_rk,-4.208726089758647593e-01_rk,-1.683490435903458593e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,3) = reshape((/                                                                                 &
                                        9.794150344116638041e-02_rk, 9.794150344116640816e-02_rk, 1.040834085586084257e-17_rk,7.345612758087483041e-02_rk,7.345612758087483041e-02_rk,3.469446951953614189e-18_rk,3.122502256758252770e-17_rk,1.387778780781445676e-17_rk, &
                                        9.794150344116639428e-02_rk, 2.938245103234991551e-01_rk, -3.469446951953614189e-18_rk,7.345612758087484429e-02_rk,2.203683827426242969e-01_rk,-3.469446951953614189e-18_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -3.469446951953614189e-18_rk, 2.938245103234991551e-01_rk,-1.040834085586084257e-17_rk,-3.469446951953614189e-18_rk,2.203683827426242969e-01_rk,2.938245103234990441e-01_rk,2.203683827426243247e-01_rk, &
                                        7.345612758087480265e-02_rk, 7.345612758087480265e-02_rk, 3.469446951953614189e-18_rk,2.938245103234992106e-01_rk,2.938245103234990441e-01_rk,1.387778780781445676e-17_rk,-3.469446951953614189e-18_rk,0.000000000000000000e+00_rk, &
                                        7.345612758087480265e-02_rk, 2.203683827426244080e-01_rk, 5.898059818321144121e-17_rk,2.938245103234990996e-01_rk,8.814735309704974098e-01_rk,1.387778780781445676e-17_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, 1.734723475976807094e-17_rk, 2.203683827426243247e-01_rk,-1.387778780781445676e-17_rk,1.387778780781445676e-17_rk,8.814735309704974098e-01_rk,2.203683827426243247e-01_rk,8.814735309704974098e-01_rk, &
                                        -3.469446951953614189e-18_rk, -1.387778780781445676e-17_rk, 2.938245103234990441e-01_rk,3.469446951953614189e-18_rk,3.469446951953614189e-17_rk,2.203683827426243524e-01_rk,8.814735309704972988e-01_rk,6.611051482278733626e-01_rk, &
                                        -3.469446951953614189e-18_rk, 2.775557561562891351e-17_rk, 2.203683827426243247e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-16_rk,8.814735309704974098e-01_rk,6.611051482278731406e-01_rk,2.644420592911492118e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,1) = reshape((/                                                                                 &
                                        6.215518487612482074e-02_rk, -6.215518487612482768e-02_rk, 6.215518487612483461e-02_rk,2.825235676187493744e-02_rk,-2.825235676187492009e-02_rk,2.825235676187492009e-02_rk,-6.215518487612482074e-02_rk,-2.825235676187488887e-02_rk, &
                                        -6.215518487612481380e-02_rk, 1.864655546283745247e-01_rk, -6.215518487612484155e-02_rk,-2.825235676187492356e-02_rk,8.475707028562473599e-02_rk,-2.825235676187490275e-02_rk,1.864655546283743859e-01_rk,8.475707028562477763e-02_rk, &
                                        6.215518487612482768e-02_rk, -6.215518487612482074e-02_rk, 1.864655546283745247e-01_rk,2.825235676187492356e-02_rk,-2.825235676187490275e-02_rk,8.475707028562473599e-02_rk,-1.864655546283743859e-01_rk,-8.475707028562477763e-02_rk, &
                                        2.825235676187491315e-02_rk, -2.825235676187491662e-02_rk, 2.825235676187492356e-02_rk,1.864655546283744969e-01_rk,-1.864655546283743859e-01_rk,1.864655546283743859e-01_rk,-2.825235676187490275e-02_rk,-1.864655546283743859e-01_rk, &
                                        -2.825235676187491662e-02_rk, 8.475707028562476375e-02_rk, -2.825235676187490622e-02_rk,-1.864655546283744691e-01_rk,5.593966638851233242e-01_rk,-1.864655546283743859e-01_rk,8.475707028562477763e-02_rk,5.593966638851233242e-01_rk, &
                                        2.825235676187492009e-02_rk, -2.825235676187492356e-02_rk, 8.475707028562477763e-02_rk,1.864655546283744414e-01_rk,-1.864655546283743859e-01_rk,5.593966638851233242e-01_rk,-8.475707028562476375e-02_rk,-5.593966638851233242e-01_rk, &
                                        -6.215518487612480686e-02_rk, 1.864655546283744414e-01_rk, -1.864655546283743581e-01_rk,-2.825235676187493744e-02_rk,8.475707028562477763e-02_rk,-8.475707028562474987e-02_rk,5.593966638851233242e-01_rk,2.542712108568743190e-01_rk, &
                                        -2.825235676187490275e-02_rk, 8.475707028562473599e-02_rk, -8.475707028562473599e-02_rk,-1.864655546283743859e-01_rk,5.593966638851235462e-01_rk,-5.593966638851233242e-01_rk,2.542712108568742080e-01_rk,1.678189991655370417e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,2) = reshape((/                                                                                 &
                                        7.793937203256751101e-02_rk, -2.602085213965210642e-18_rk, 7.793937203256751101e-02_rk,-9.352724643908100211e-02_rk,1.734723475976807094e-18_rk,-9.352724643908098823e-02_rk,-1.214306433183764966e-17_rk,3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 2.338181160977025608e-01_rk, -2.081668171172168513e-17_rk,-1.734723475976807094e-18_rk,-2.805817393172429508e-01_rk,-6.938893903907228378e-18_rk,2.338181160977025053e-01_rk,-2.805817393172429508e-01_rk, &
                                        7.793937203256752488e-02_rk, 0.000000000000000000e+00_rk, 2.338181160977025608e-01_rk,-9.352724643908097435e-02_rk,-6.938893903907228378e-18_rk,-2.805817393172429508e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        -9.352724643908101598e-02_rk, 1.734723475976807094e-18_rk, -9.352724643908100211e-02_rk,2.338181160977025330e-01_rk,6.938893903907228378e-18_rk,2.338181160977025053e-01_rk,-6.938893903907228378e-18_rk,1.387778780781445676e-17_rk, &
                                        -1.734723475976807094e-18_rk, -2.805817393172429508e-01_rk, -3.469446951953614189e-18_rk,-1.387778780781445676e-17_rk,7.014543482931077101e-01_rk,0.000000000000000000e+00_rk,-2.805817393172430063e-01_rk,7.014543482931075991e-01_rk, &
                                        -9.352724643908100211e-02_rk, 6.938893903907228378e-18_rk, -2.805817393172429508e-01_rk,2.338181160977024775e-01_rk,0.000000000000000000e+00_rk,7.014543482931077101e-01_rk,2.081668171172168513e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.338181160977025608e-01_rk, 1.387778780781445676e-17_rk,-3.469446951953614189e-18_rk,-2.805817393172429508e-01_rk,-6.938893903907228378e-18_rk,7.014543482931074880e-01_rk,-8.417452179517288524e-01_rk, &
                                        -6.938893903907228378e-18_rk, -2.805817393172430618e-01_rk, 4.857225732735059864e-17_rk,1.387778780781445676e-17_rk,7.014543482931074880e-01_rk,0.000000000000000000e+00_rk,-8.417452179517288524e-01_rk,2.104363044879322686e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.224268793014579720e-01_rk, 1.224268793014579582e-01_rk, -1.040834085586084257e-17_rk,1.469122551617495220e-01_rk,-1.469122551617495498e-01_rk,1.040834085586084257e-17_rk,3.122502256758252770e-17_rk,-4.163336342344337027e-17_rk, &
                                        1.224268793014579582e-01_rk, -3.672806379043738745e-01_rk, 1.040834085586084257e-17_rk,-1.469122551617495498e-01_rk,4.407367654852485384e-01_rk,3.469446951953614189e-18_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.734723475976807094e-17_rk, -3.672806379043738745e-01_rk,-1.040834085586084257e-17_rk,3.469446951953614189e-18_rk,4.407367654852485384e-01_rk,3.672806379043737635e-01_rk,-4.407367654852484828e-01_rk, &
                                        1.469122551617495498e-01_rk, -1.469122551617495498e-01_rk, -1.040834085586084257e-17_rk,-3.672806379043739300e-01_rk,3.672806379043737635e-01_rk,-1.387778780781445676e-17_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk, &
                                        -1.469122551617495498e-01_rk, 4.407367654852485384e-01_rk, -3.469446951953614189e-18_rk,3.672806379043738190e-01_rk,-1.101841913713121679e+00_rk,1.387778780781445676e-17_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        6.938893903907228378e-18_rk, -1.734723475976807094e-17_rk, 4.407367654852484828e-01_rk,1.387778780781445676e-17_rk,1.387778780781445676e-17_rk,-1.101841913713121679e+00_rk,-4.407367654852484828e-01_rk,1.101841913713121457e+00_rk, &
                                        -3.469446951953614189e-18_rk, 1.387778780781445676e-17_rk, 3.672806379043737635e-01_rk,-3.469446951953614189e-18_rk,-3.469446951953614189e-17_rk,-4.407367654852484273e-01_rk,-1.101841913713121457e+00_rk,1.322210296455745615e+00_rk, &
                                        3.469446951953614189e-18_rk, -2.775557561562891351e-17_rk, -4.407367654852485939e-01_rk,0.000000000000000000e+00_rk,-8.326672684688674053e-17_rk,1.101841913713121457e+00_rk,1.322210296455745837e+00_rk,-3.305525741139364815e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.412617838093745970e-01_rk, 1.412617838093745692e-01_rk, -1.412617838093745970e-01_rk,2.260188540949985975e-02_rk,-2.260188540949989791e-02_rk,2.260188540949989791e-02_rk,1.412617838093745692e-01_rk,-2.260188540949993607e-02_rk, &
                                        1.412617838093745415e-01_rk, -4.237853514281237910e-01_rk, 1.412617838093745970e-01_rk,-2.260188540949987362e-02_rk,6.780565622849971108e-02_rk,-2.260188540949991526e-02_rk,-4.237853514281236245e-01_rk,6.780565622849966945e-02_rk, &
                                        -1.412617838093745692e-01_rk, 1.412617838093745970e-01_rk, -4.237853514281237910e-01_rk,2.260188540949987362e-02_rk,-2.260188540949991526e-02_rk,6.780565622849971108e-02_rk,4.237853514281236245e-01_rk,-6.780565622849966945e-02_rk, &
                                        2.260188540949989791e-02_rk, -2.260188540949990138e-02_rk, 2.260188540949989444e-02_rk,-4.237853514281237355e-01_rk,4.237853514281236245e-01_rk,-4.237853514281236245e-01_rk,-2.260188540949991526e-02_rk,4.237853514281236245e-01_rk, &
                                        -2.260188540949990138e-02_rk, 6.780565622849965557e-02_rk, -2.260188540949991873e-02_rk,4.237853514281236800e-01_rk,-1.271356054284371151e+00_rk,4.237853514281236245e-01_rk,6.780565622849969720e-02_rk,-1.271356054284371151e+00_rk, &
                                        2.260188540949989791e-02_rk, -2.260188540949988056e-02_rk, 6.780565622849966945e-02_rk,-4.237853514281236800e-01_rk,4.237853514281236245e-01_rk,-1.271356054284371151e+00_rk,-6.780565622849968332e-02_rk,1.271356054284371151e+00_rk, &
                                        1.412617838093745415e-01_rk, -4.237853514281236800e-01_rk, 4.237853514281236245e-01_rk,-2.260188540949986669e-02_rk,6.780565622849964169e-02_rk,-6.780565622849966945e-02_rk,-1.271356054284371151e+00_rk,2.034169686854988834e-01_rk, &
                                        -2.260188540949991526e-02_rk, 6.780565622849976659e-02_rk, -6.780565622849979435e-02_rk,4.237853514281236245e-01_rk,-1.271356054284371151e+00_rk,1.271356054284371151e+00_rk,2.034169686854990777e-01_rk,-3.814068162853113453e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,2) = reshape((/                                                                                 &
                                        6.235149762605401991e-02_rk, -4.336808689942017736e-18_rk, 6.235149762605404072e-02_rk,4.676362321954055656e-02_rk,-1.734723475976807094e-18_rk,4.676362321954055656e-02_rk,1.214306433183764966e-17_rk,2.428612866367529932e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.870544928781621430e-01_rk, -6.938893903907228378e-18_rk,1.734723475976807094e-18_rk,1.402908696586215864e-01_rk,6.938893903907228378e-18_rk,1.870544928781620042e-01_rk,1.402908696586215864e-01_rk, &
                                        6.235149762605403378e-02_rk, 0.000000000000000000e+00_rk, 1.870544928781621430e-01_rk,4.676362321954057738e-02_rk,6.938893903907228378e-18_rk,1.402908696586215864e-01_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        4.676362321954054269e-02_rk, -1.734723475976807094e-18_rk, 4.676362321954054269e-02_rk,1.870544928781620597e-01_rk,6.938893903907228378e-18_rk,1.870544928781620042e-01_rk,6.938893903907228378e-18_rk,1.387778780781445676e-17_rk, &
                                        1.734723475976807094e-18_rk, 1.402908696586216142e-01_rk, 3.122502256758252770e-17_rk,-1.387778780781445676e-17_rk,5.611634786344861237e-01_rk,0.000000000000000000e+00_rk,1.402908696586215864e-01_rk,5.611634786344862347e-01_rk, &
                                        4.676362321954053575e-02_rk, -6.938893903907228378e-18_rk, 1.402908696586215864e-01_rk,1.870544928781620597e-01_rk,0.000000000000000000e+00_rk,5.611634786344861237e-01_rk,3.469446951953614189e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.870544928781621430e-01_rk, 1.387778780781445676e-17_rk,-2.428612866367529932e-17_rk,1.402908696586215864e-01_rk,6.938893903907228378e-18_rk,5.611634786344861237e-01_rk,4.208726089758649258e-01_rk, &
                                        6.938893903907228378e-18_rk, 1.402908696586215309e-01_rk, 3.469446951953614189e-17_rk,1.387778780781445676e-17_rk,5.611634786344861237e-01_rk,0.000000000000000000e+00_rk,4.208726089758647593e-01_rk,1.683490435903458593e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -9.794150344116638041e-02_rk, 9.794150344116638041e-02_rk, -3.469446951953614189e-18_rk,-7.345612758087483041e-02_rk,7.345612758087480265e-02_rk,-1.734723475976807094e-17_rk,-1.040834085586084257e-17_rk,-1.387778780781445676e-17_rk, &
                                        9.794150344116639428e-02_rk, -2.938245103234991551e-01_rk, -3.469446951953614189e-18_rk,7.345612758087484429e-02_rk,-2.203683827426242969e-01_rk,-1.734723475976807094e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, -1.734723475976807094e-17_rk, -2.938245103234991551e-01_rk,1.040834085586084257e-17_rk,-1.734723475976807094e-17_rk,-2.203683827426242969e-01_rk,2.938245103234990441e-01_rk,2.203683827426243247e-01_rk, &
                                        -7.345612758087480265e-02_rk, 7.345612758087480265e-02_rk, -3.469446951953614189e-18_rk,-2.938245103234992106e-01_rk,2.938245103234990441e-01_rk,0.000000000000000000e+00_rk,-1.734723475976807094e-17_rk,0.000000000000000000e+00_rk, &
                                        7.345612758087480265e-02_rk, -2.203683827426244080e-01_rk, -3.816391647148975608e-17_rk,2.938245103234990996e-01_rk,-8.814735309704974098e-01_rk,1.387778780781445676e-17_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 3.122502256758252770e-17_rk, -2.203683827426243247e-01_rk,0.000000000000000000e+00_rk,1.387778780781445676e-17_rk,-8.814735309704974098e-01_rk,2.203683827426243247e-01_rk,8.814735309704974098e-01_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 2.938245103234990441e-01_rk,4.510281037539698445e-17_rk,-2.081668171172168513e-17_rk,2.203683827426243524e-01_rk,-8.814735309704972988e-01_rk,-6.611051482278733626e-01_rk, &
                                        -1.734723475976807094e-17_rk, -2.775557561562891351e-17_rk, 2.203683827426243247e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-16_rk,8.814735309704974098e-01_rk,-6.611051482278731406e-01_rk,-2.644420592911492118e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,1) = reshape((/                                                                                 &
                                        6.215518487612482074e-02_rk, 6.215518487612484155e-02_rk, 6.215518487612483461e-02_rk,2.825235676187494438e-02_rk,2.825235676187492703e-02_rk,2.825235676187492009e-02_rk,6.215518487612485543e-02_rk,2.825235676187491662e-02_rk, &
                                        6.215518487612482768e-02_rk, 1.864655546283745247e-01_rk, 6.215518487612482074e-02_rk,2.825235676187492356e-02_rk,8.475707028562473599e-02_rk,2.825235676187490275e-02_rk,1.864655546283744136e-01_rk,8.475707028562477763e-02_rk, &
                                        6.215518487612482768e-02_rk, 6.215518487612482768e-02_rk, 1.864655546283745247e-01_rk,2.825235676187492356e-02_rk,2.825235676187490275e-02_rk,8.475707028562473599e-02_rk,1.864655546283743859e-01_rk,8.475707028562477763e-02_rk, &
                                        2.825235676187491315e-02_rk, 2.825235676187491662e-02_rk, 2.825235676187492356e-02_rk,1.864655546283744969e-01_rk,1.864655546283743859e-01_rk,1.864655546283744136e-01_rk,2.825235676187490275e-02_rk,1.864655546283743859e-01_rk, &
                                        2.825235676187491662e-02_rk, 8.475707028562476375e-02_rk, 2.825235676187495132e-02_rk,1.864655546283744691e-01_rk,5.593966638851233242e-01_rk,1.864655546283744136e-01_rk,8.475707028562479151e-02_rk,5.593966638851233242e-01_rk, &
                                        2.825235676187492009e-02_rk, 2.825235676187492356e-02_rk, 8.475707028562480538e-02_rk,1.864655546283744136e-01_rk,1.864655546283744136e-01_rk,5.593966638851233242e-01_rk,8.475707028562479151e-02_rk,5.593966638851233242e-01_rk, &
                                        6.215518487612479992e-02_rk, 1.864655546283744136e-01_rk, 1.864655546283744136e-01_rk,2.825235676187490969e-02_rk,8.475707028562474987e-02_rk,8.475707028562472212e-02_rk,5.593966638851233242e-01_rk,2.542712108568743190e-01_rk, &
                                        2.825235676187490275e-02_rk, 8.475707028562473599e-02_rk, 8.475707028562479151e-02_rk,1.864655546283743859e-01_rk,5.593966638851233242e-01_rk,5.593966638851233242e-01_rk,2.542712108568742080e-01_rk,1.678189991655370417e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -7.793937203256751101e-02_rk, 2.602085213965210642e-18_rk, -7.793937203256751101e-02_rk,9.352724643908100211e-02_rk,-1.734723475976807094e-18_rk,9.352724643908098823e-02_rk,1.214306433183764966e-17_rk,-3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, -2.338181160977025608e-01_rk, 2.081668171172168513e-17_rk,1.734723475976807094e-18_rk,2.805817393172429508e-01_rk,6.938893903907228378e-18_rk,-2.338181160977025053e-01_rk,2.805817393172429508e-01_rk, &
                                        -7.793937203256752488e-02_rk, 0.000000000000000000e+00_rk, -2.338181160977025608e-01_rk,9.352724643908097435e-02_rk,6.938893903907228378e-18_rk,2.805817393172429508e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        9.352724643908101598e-02_rk, -1.734723475976807094e-18_rk, 9.352724643908100211e-02_rk,-2.338181160977025330e-01_rk,-6.938893903907228378e-18_rk,-2.338181160977025053e-01_rk,6.938893903907228378e-18_rk,-1.387778780781445676e-17_rk, &
                                        1.734723475976807094e-18_rk, 2.805817393172429508e-01_rk, 3.469446951953614189e-18_rk,1.387778780781445676e-17_rk,-7.014543482931077101e-01_rk,0.000000000000000000e+00_rk,2.805817393172430063e-01_rk,-7.014543482931075991e-01_rk, &
                                        9.352724643908100211e-02_rk, -6.938893903907228378e-18_rk, 2.805817393172429508e-01_rk,-2.338181160977024775e-01_rk,0.000000000000000000e+00_rk,-7.014543482931077101e-01_rk,-2.081668171172168513e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.338181160977025608e-01_rk, -1.387778780781445676e-17_rk,3.469446951953614189e-18_rk,2.805817393172429508e-01_rk,6.938893903907228378e-18_rk,-7.014543482931074880e-01_rk,8.417452179517288524e-01_rk, &
                                        6.938893903907228378e-18_rk, 2.805817393172430618e-01_rk, -4.857225732735059864e-17_rk,-1.387778780781445676e-17_rk,-7.014543482931074880e-01_rk,0.000000000000000000e+00_rk,8.417452179517288524e-01_rk,-2.104363044879322686e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.224268793014579720e-01_rk, -1.224268793014579582e-01_rk, -3.469446951953614189e-18_rk,1.469122551617495220e-01_rk,1.469122551617495498e-01_rk,1.040834085586084257e-17_rk,1.040834085586084257e-17_rk,-4.163336342344337027e-17_rk, &
                                        -1.224268793014579582e-01_rk, -3.672806379043738745e-01_rk, 1.734723475976807094e-17_rk,1.469122551617495498e-01_rk,4.407367654852485384e-01_rk,1.040834085586084257e-17_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        -1.734723475976807094e-17_rk, 3.469446951953614189e-18_rk, -3.672806379043738745e-01_rk,-1.040834085586084257e-17_rk,1.040834085586084257e-17_rk,4.407367654852485384e-01_rk,-3.672806379043737635e-01_rk,4.407367654852484828e-01_rk, &
                                        1.469122551617495498e-01_rk, 1.469122551617495498e-01_rk, -1.040834085586084257e-17_rk,-3.672806379043739300e-01_rk,-3.672806379043737635e-01_rk,-2.775557561562891351e-17_rk,1.040834085586084257e-17_rk,0.000000000000000000e+00_rk, &
                                        1.469122551617495498e-01_rk, 4.407367654852485384e-01_rk, -1.040834085586084257e-17_rk,-3.672806379043738190e-01_rk,-1.101841913713121679e+00_rk,-1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, 3.469446951953614189e-18_rk, 4.407367654852484828e-01_rk,2.775557561562891351e-17_rk,-1.387778780781445676e-17_rk,-1.101841913713121679e+00_rk,4.407367654852484828e-01_rk,-1.101841913713121457e+00_rk, &
                                        3.469446951953614189e-18_rk, 2.775557561562891351e-17_rk, -3.672806379043737635e-01_rk,1.734723475976807094e-17_rk,-2.081668171172168513e-17_rk,4.407367654852484273e-01_rk,-1.101841913713121457e+00_rk,1.322210296455745615e+00_rk, &
                                        1.040834085586084257e-17_rk, -2.775557561562891351e-17_rk, 4.407367654852485939e-01_rk,0.000000000000000000e+00_rk,8.326672684688674053e-17_rk,-1.101841913713121457e+00_rk,1.322210296455745837e+00_rk,-3.305525741139364815e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.412617838093745970e-01_rk, -1.412617838093745970e-01_rk, -1.412617838093745970e-01_rk,2.260188540949985281e-02_rk,2.260188540949989097e-02_rk,2.260188540949989791e-02_rk,-1.412617838093745970e-01_rk,2.260188540949985281e-02_rk, &
                                        -1.412617838093745692e-01_rk, -4.237853514281237910e-01_rk, -1.412617838093745970e-01_rk,2.260188540949987362e-02_rk,6.780565622849971108e-02_rk,2.260188540949991526e-02_rk,-4.237853514281236800e-01_rk,6.780565622849966945e-02_rk, &
                                        -1.412617838093745692e-01_rk, -1.412617838093745970e-01_rk, -4.237853514281237910e-01_rk,2.260188540949987362e-02_rk,2.260188540949991526e-02_rk,6.780565622849971108e-02_rk,-4.237853514281236245e-01_rk,6.780565622849966945e-02_rk, &
                                        2.260188540949989791e-02_rk, 2.260188540949990138e-02_rk, 2.260188540949989444e-02_rk,-4.237853514281237355e-01_rk,-4.237853514281236245e-01_rk,-4.237853514281236800e-01_rk,2.260188540949991526e-02_rk,-4.237853514281236245e-01_rk, &
                                        2.260188540949990138e-02_rk, 6.780565622849965557e-02_rk, 2.260188540949985281e-02_rk,-4.237853514281236800e-01_rk,-1.271356054284371151e+00_rk,-4.237853514281236800e-01_rk,6.780565622849965557e-02_rk,-1.271356054284371151e+00_rk, &
                                        2.260188540949989791e-02_rk, 2.260188540949988056e-02_rk, 6.780565622849964169e-02_rk,-4.237853514281236800e-01_rk,-4.237853514281236800e-01_rk,-1.271356054284371151e+00_rk,6.780565622849965557e-02_rk,-1.271356054284371151e+00_rk, &
                                        -1.412617838093745415e-01_rk, -4.237853514281236800e-01_rk, -4.237853514281236245e-01_rk,2.260188540949989444e-02_rk,6.780565622849961394e-02_rk,6.780565622849964169e-02_rk,-1.271356054284371151e+00_rk,2.034169686854988834e-01_rk, &
                                        2.260188540949991526e-02_rk, 6.780565622849976659e-02_rk, 6.780565622849968332e-02_rk,-4.237853514281236245e-01_rk,-1.271356054284370929e+00_rk,-1.271356054284371151e+00_rk,2.034169686854991332e-01_rk,-3.814068162853113453e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -6.235149762605401991e-02_rk, 4.336808689942017736e-18_rk, -6.235149762605404072e-02_rk,-4.676362321954055656e-02_rk,1.734723475976807094e-18_rk,-4.676362321954055656e-02_rk,-1.214306433183764966e-17_rk,-2.428612866367529932e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.870544928781621430e-01_rk, 6.938893903907228378e-18_rk,-1.734723475976807094e-18_rk,-1.402908696586215864e-01_rk,-6.938893903907228378e-18_rk,-1.870544928781620042e-01_rk,-1.402908696586215864e-01_rk, &
                                        -6.235149762605403378e-02_rk, 0.000000000000000000e+00_rk, -1.870544928781621430e-01_rk,-4.676362321954057738e-02_rk,-6.938893903907228378e-18_rk,-1.402908696586215864e-01_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        -4.676362321954054269e-02_rk, 1.734723475976807094e-18_rk, -4.676362321954054269e-02_rk,-1.870544928781620597e-01_rk,-6.938893903907228378e-18_rk,-1.870544928781620042e-01_rk,-6.938893903907228378e-18_rk,-1.387778780781445676e-17_rk, &
                                        -1.734723475976807094e-18_rk, -1.402908696586216142e-01_rk, -3.122502256758252770e-17_rk,1.387778780781445676e-17_rk,-5.611634786344861237e-01_rk,0.000000000000000000e+00_rk,-1.402908696586215864e-01_rk,-5.611634786344862347e-01_rk, &
                                        -4.676362321954053575e-02_rk, 6.938893903907228378e-18_rk, -1.402908696586215864e-01_rk,-1.870544928781620597e-01_rk,0.000000000000000000e+00_rk,-5.611634786344861237e-01_rk,-3.469446951953614189e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.870544928781621430e-01_rk, -1.387778780781445676e-17_rk,2.428612866367529932e-17_rk,-1.402908696586215864e-01_rk,-6.938893903907228378e-18_rk,-5.611634786344861237e-01_rk,-4.208726089758649258e-01_rk, &
                                        -6.938893903907228378e-18_rk, -1.402908696586215309e-01_rk, -3.469446951953614189e-17_rk,-1.387778780781445676e-17_rk,-5.611634786344861237e-01_rk,0.000000000000000000e+00_rk,-4.208726089758647593e-01_rk,-1.683490435903458593e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -9.794150344116638041e-02_rk, -9.794150344116640816e-02_rk, -1.040834085586084257e-17_rk,-7.345612758087483041e-02_rk,-7.345612758087483041e-02_rk,-3.469446951953614189e-18_rk,-3.122502256758252770e-17_rk,-1.387778780781445676e-17_rk, &
                                        -9.794150344116639428e-02_rk, -2.938245103234991551e-01_rk, 3.469446951953614189e-18_rk,-7.345612758087484429e-02_rk,-2.203683827426242969e-01_rk,3.469446951953614189e-18_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, 3.469446951953614189e-18_rk, -2.938245103234991551e-01_rk,1.040834085586084257e-17_rk,3.469446951953614189e-18_rk,-2.203683827426242969e-01_rk,-2.938245103234990441e-01_rk,-2.203683827426243247e-01_rk, &
                                        -7.345612758087480265e-02_rk, -7.345612758087480265e-02_rk, -3.469446951953614189e-18_rk,-2.938245103234992106e-01_rk,-2.938245103234990441e-01_rk,-1.387778780781445676e-17_rk,3.469446951953614189e-18_rk,0.000000000000000000e+00_rk, &
                                        -7.345612758087480265e-02_rk, -2.203683827426244080e-01_rk, -5.898059818321144121e-17_rk,-2.938245103234990996e-01_rk,-8.814735309704974098e-01_rk,-1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, -1.734723475976807094e-17_rk, -2.203683827426243247e-01_rk,1.387778780781445676e-17_rk,-1.387778780781445676e-17_rk,-8.814735309704974098e-01_rk,-2.203683827426243247e-01_rk,-8.814735309704974098e-01_rk, &
                                        3.469446951953614189e-18_rk, 1.387778780781445676e-17_rk, -2.938245103234990441e-01_rk,-3.469446951953614189e-18_rk,-3.469446951953614189e-17_rk,-2.203683827426243524e-01_rk,-8.814735309704972988e-01_rk,-6.611051482278733626e-01_rk, &
                                        3.469446951953614189e-18_rk, -2.775557561562891351e-17_rk, -2.203683827426243247e-01_rk,0.000000000000000000e+00_rk,1.387778780781445676e-16_rk,-8.814735309704974098e-01_rk,-6.611051482278731406e-01_rk,-2.644420592911492118e+00_rk  &
                                        /),(/8,8/))
        
        
        
        
        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dinvmass_dx(:,:,inode_diff,idir)),self%elem%dinvmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dinvmass_dx
    !*******************************************************************************************








    !> Test cartesian dmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmass_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nnodes_r,3) :: test_dmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dmass_dx
        ! 
        test_dmass_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -3.926990816987241395e-01_rk, 1.308996938995746762e-01_rk, 1.308996938995746762e-01_rk,-1.308996938995746484e-01_rk,4.363323129985821613e-02_rk,4.363323129985821613e-02_rk,-4.363323129985823695e-02_rk,-1.454441043328607783e-02_rk, &
                                        1.308996938995746762e-01_rk, -1.308996938995747317e-01_rk, -4.363323129985823695e-02_rk,4.363323129985821613e-02_rk,-4.363323129985821613e-02_rk,-1.454441043328607783e-02_rk,4.363323129985824389e-02_rk,1.454441043328607783e-02_rk, &
                                        1.308996938995746762e-01_rk, -4.363323129985823695e-02_rk, -1.308996938995747317e-01_rk,4.363323129985821613e-02_rk,-1.454441043328607783e-02_rk,-4.363323129985821613e-02_rk,4.363323129985823001e-02_rk,1.454441043328607783e-02_rk, &
                                        -1.308996938995746484e-01_rk, 4.363323129985821613e-02_rk, 4.363323129985821613e-02_rk,-1.308996938995747317e-01_rk,4.363323129985823001e-02_rk,4.363323129985824389e-02_rk,-1.454441043328607783e-02_rk,-1.454441043328607436e-02_rk, &
                                        4.363323129985821613e-02_rk, -4.363323129985821613e-02_rk, -1.454441043328607783e-02_rk,4.363323129985823001e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328608477e-02_rk,1.454441043328607956e-02_rk,1.454441043328608130e-02_rk, &
                                        4.363323129985821613e-02_rk, -1.454441043328607783e-02_rk, -4.363323129985821613e-02_rk,4.363323129985824389e-02_rk,-1.454441043328608477e-02_rk,-4.363323129985823001e-02_rk,1.454441043328608130e-02_rk,1.454441043328608130e-02_rk, &
                                        -4.363323129985823695e-02_rk, 4.363323129985824389e-02_rk, 4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk,1.454441043328607956e-02_rk,1.454441043328608130e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        -1.454441043328607783e-02_rk, 1.454441043328607783e-02_rk, 1.454441043328607783e-02_rk,-1.454441043328607436e-02_rk,1.454441043328608130e-02_rk,1.454441043328608130e-02_rk,-1.454441043328607783e-02_rk,-1.454441043328607783e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -3.333333333333333148e-01_rk, 3.469446951953614189e-18_rk, 1.111111111111111049e-01_rk,8.333333333333331483e-02_rk,2.602085213965210642e-18_rk,-2.777777777777776930e-02_rk,1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk, &
                                        3.469446951953614189e-18_rk, -1.111111111111111049e-01_rk, 1.734723475976807094e-18_rk,2.602085213965210642e-18_rk,2.777777777777776930e-02_rk,-4.336808689942017736e-19_rk,3.703703703703702804e-02_rk,-9.259259259259257011e-03_rk, &
                                        1.111111111111111049e-01_rk, 1.734723475976807094e-18_rk, -1.111111111111111049e-01_rk,-2.777777777777776930e-02_rk,-4.336808689942017736e-19_rk,2.777777777777776930e-02_rk,-1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk, &
                                        8.333333333333331483e-02_rk, 2.602085213965210642e-18_rk, -2.777777777777776930e-02_rk,-1.111111111111111049e-01_rk,-1.734723475976807094e-18_rk,3.703703703703702804e-02_rk,-4.336808689942017736e-19_rk,4.336808689942017736e-19_rk, &
                                        2.602085213965210642e-18_rk, 2.777777777777776930e-02_rk, -4.336808689942017736e-19_rk,-1.734723475976807094e-18_rk,-3.703703703703703498e-02_rk,-4.336808689942017736e-19_rk,-9.259259259259263949e-03_rk,1.234567901234567486e-02_rk, &
                                        -2.777777777777776930e-02_rk, -4.336808689942017736e-19_rk, 2.777777777777776930e-02_rk,3.703703703703702804e-02_rk,-4.336808689942017736e-19_rk,-3.703703703703703498e-02_rk,2.168404344971008868e-19_rk,0.000000000000000000e+00_rk, &
                                        1.734723475976807094e-18_rk, 3.703703703703702804e-02_rk, -1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk,-9.259259259259263949e-03_rk,2.168404344971008868e-19_rk,-3.703703703703703498e-02_rk,9.259259259259255276e-03_rk, &
                                        -4.336808689942017736e-19_rk, -9.259259259259257011e-03_rk, -4.336808689942017736e-19_rk,4.336808689942017736e-19_rk,1.234567901234567486e-02_rk,0.000000000000000000e+00_rk,9.259259259259255276e-03_rk,-1.234567901234567486e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -5.235987755982989267e-01_rk, 1.745329251994329200e-01_rk, 3.469446951953614189e-18_rk,1.308996938995747039e-01_rk,-4.363323129985824389e-02_rk,-4.336808689942017736e-18_rk,-4.336808689942017736e-18_rk,4.336808689942017736e-18_rk, &
                                        1.745329251994329200e-01_rk, -1.745329251994329756e-01_rk, -4.336808689942017736e-18_rk,-4.363323129985824389e-02_rk,4.363323129985824389e-02_rk,4.336808689942017736e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, -4.336808689942017736e-18_rk, -1.745329251994329756e-01_rk,-4.336808689942017736e-18_rk,4.336808689942017736e-18_rk,4.363323129985824389e-02_rk,5.817764173314431825e-02_rk,-1.454441043328607783e-02_rk, &
                                        1.308996938995747039e-01_rk, -4.363323129985824389e-02_rk, -4.336808689942017736e-18_rk,-1.745329251994329756e-01_rk,5.817764173314431825e-02_rk,6.938893903907228378e-18_rk,4.336808689942017736e-18_rk,1.734723475976807094e-18_rk, &
                                        -4.363323129985824389e-02_rk, 4.363323129985824389e-02_rk, 4.336808689942017736e-18_rk,5.817764173314431825e-02_rk,-5.817764173314431825e-02_rk,-1.734723475976807094e-18_rk,-1.734723475976807094e-18_rk,4.336808689942017736e-19_rk, &
                                        -4.336808689942017736e-18_rk, 4.336808689942017736e-18_rk, 4.363323129985824389e-02_rk,6.938893903907228378e-18_rk,-1.734723475976807094e-18_rk,-5.817764173314431825e-02_rk,-1.454441043328608650e-02_rk,1.939254724438143826e-02_rk, &
                                        -4.336808689942017736e-18_rk, 6.938893903907228378e-18_rk, 5.817764173314431825e-02_rk,4.336808689942017736e-18_rk,-1.734723475976807094e-18_rk,-1.454441043328608650e-02_rk,-5.817764173314431825e-02_rk,1.454441043328608130e-02_rk, &
                                        4.336808689942017736e-18_rk, 0.000000000000000000e+00_rk, -1.454441043328607783e-02_rk,1.734723475976807094e-18_rk,4.336808689942017736e-19_rk,1.939254724438143826e-02_rk,1.454441043328608130e-02_rk,-1.939254724438143479e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,1) = reshape((/                                                                                 &
                                        7.853981633974482790e-01_rk, -2.617993877991494078e-01_rk, -2.617993877991494078e-01_rk,1.308996938995746484e-01_rk,-4.363323129985821613e-02_rk,-4.363323129985821613e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk, &
                                        -2.617993877991494078e-01_rk, 2.617993877991494078e-01_rk, 8.726646259971647390e-02_rk,-4.363323129985821613e-02_rk,4.363323129985821613e-02_rk,1.454441043328607783e-02_rk,-8.726646259971647390e-02_rk,-1.454441043328607783e-02_rk, &
                                        -2.617993877991494078e-01_rk, 8.726646259971647390e-02_rk, 2.617993877991494078e-01_rk,-4.363323129985821613e-02_rk,1.454441043328607783e-02_rk,4.363323129985821613e-02_rk,-8.726646259971647390e-02_rk,-1.454441043328607783e-02_rk, &
                                        1.308996938995746484e-01_rk, -4.363323129985821613e-02_rk, -4.363323129985821613e-02_rk,2.617993877991494078e-01_rk,-8.726646259971647390e-02_rk,-8.726646259971647390e-02_rk,1.454441043328607783e-02_rk,2.908882086657214872e-02_rk, &
                                        -4.363323129985821613e-02_rk, 4.363323129985821613e-02_rk, 1.454441043328607783e-02_rk,-8.726646259971647390e-02_rk,8.726646259971647390e-02_rk,2.908882086657216606e-02_rk,-1.454441043328608130e-02_rk,-2.908882086657215565e-02_rk, &
                                        -4.363323129985821613e-02_rk, 1.454441043328607783e-02_rk, 4.363323129985821613e-02_rk,-8.726646259971647390e-02_rk,2.908882086657216606e-02_rk,8.726646259971647390e-02_rk,-1.454441043328608130e-02_rk,-2.908882086657215565e-02_rk, &
                                        8.726646259971647390e-02_rk, -8.726646259971647390e-02_rk, -8.726646259971647390e-02_rk,1.454441043328607783e-02_rk,-1.454441043328608130e-02_rk,-1.454441043328608130e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk, &
                                        1.454441043328607783e-02_rk, -1.454441043328607783e-02_rk, -1.454441043328607783e-02_rk,2.908882086657214872e-02_rk,-2.908882086657215565e-02_rk,-2.908882086657215565e-02_rk,1.454441043328607783e-02_rk,2.908882086657215219e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -4.166666666666666852e-01_rk, 3.469446951953614189e-18_rk, 1.388888888888888951e-01_rk,-1.666666666666666852e-01_rk,-2.602085213965210642e-18_rk,5.555555555555554553e-02_rk,1.734723475976807094e-18_rk,4.336808689942017736e-19_rk, &
                                        3.469446951953614189e-18_rk, -1.388888888888888951e-01_rk, 1.734723475976807094e-18_rk,-2.602085213965210642e-18_rk,-5.555555555555554553e-02_rk,4.336808689942017736e-19_rk,4.629629629629628679e-02_rk,1.851851851851851055e-02_rk, &
                                        1.388888888888888951e-01_rk, 1.734723475976807094e-18_rk, -1.388888888888888951e-01_rk,5.555555555555554553e-02_rk,4.336808689942017736e-19_rk,-5.555555555555554553e-02_rk,-1.734723475976807094e-18_rk,4.336808689942017736e-19_rk, &
                                        -1.666666666666666852e-01_rk, -2.602085213965210642e-18_rk, 5.555555555555554553e-02_rk,-1.388888888888888951e-01_rk,-1.734723475976807094e-18_rk,4.629629629629628679e-02_rk,4.336808689942017736e-19_rk,4.336808689942017736e-19_rk, &
                                        -2.602085213965210642e-18_rk, -5.555555555555554553e-02_rk, 4.336808689942017736e-19_rk,-1.734723475976807094e-18_rk,-4.629629629629629373e-02_rk,-4.336808689942017736e-19_rk,1.851851851851851749e-02_rk,1.543209876543209444e-02_rk, &
                                        5.555555555555554553e-02_rk, 4.336808689942017736e-19_rk, -5.555555555555554553e-02_rk,4.629629629629628679e-02_rk,-4.336808689942017736e-19_rk,-4.629629629629629373e-02_rk,-2.168404344971008868e-19_rk,0.000000000000000000e+00_rk, &
                                        1.734723475976807094e-18_rk, 4.629629629629628679e-02_rk, -1.734723475976807094e-18_rk,4.336808689942017736e-19_rk,1.851851851851851749e-02_rk,-2.168404344971008868e-19_rk,-4.629629629629629373e-02_rk,-1.851851851851851402e-02_rk, &
                                        4.336808689942017736e-19_rk, 1.851851851851851055e-02_rk, 4.336808689942017736e-19_rk,4.336808689942017736e-19_rk,1.543209876543209444e-02_rk,0.000000000000000000e+00_rk,-1.851851851851851402e-02_rk,-1.543209876543209444e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -6.544984694978734918e-01_rk, 2.181661564992911639e-01_rk, -3.469446951953614189e-18_rk,-2.617993877991493523e-01_rk,8.726646259971646002e-02_rk,4.336808689942017736e-18_rk,-2.602085213965210642e-18_rk,-2.602085213965210642e-18_rk, &
                                        2.181661564992911639e-01_rk, -2.181661564992911639e-01_rk, -2.602085213965210642e-18_rk,8.726646259971646002e-02_rk,-8.726646259971646002e-02_rk,-2.602085213965210642e-18_rk,5.204170427930421283e-18_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, -2.602085213965210642e-18_rk, -2.181661564992911639e-01_rk,4.336808689942017736e-18_rk,-2.602085213965210642e-18_rk,-8.726646259971646002e-02_rk,7.272205216643039261e-02_rk,2.908882086657215219e-02_rk, &
                                        -2.617993877991493523e-01_rk, 8.726646259971646002e-02_rk, 4.336808689942017736e-18_rk,-2.181661564992911639e-01_rk,7.272205216643039261e-02_rk,5.204170427930421283e-18_rk,-2.602085213965210642e-18_rk,2.602085213965210642e-18_rk, &
                                        8.726646259971646002e-02_rk, -8.726646259971646002e-02_rk, -2.602085213965210642e-18_rk,7.272205216643039261e-02_rk,-7.272205216643039261e-02_rk,-1.734723475976807094e-18_rk,0.000000000000000000e+00_rk,1.301042606982605321e-18_rk, &
                                        4.336808689942017736e-18_rk, -2.602085213965210642e-18_rk, -8.726646259971646002e-02_rk,5.204170427930421283e-18_rk,-1.734723475976807094e-18_rk,-7.272205216643039261e-02_rk,2.908882086657215912e-02_rk,2.424068405547679869e-02_rk, &
                                        -2.602085213965210642e-18_rk, 5.204170427930421283e-18_rk, 7.272205216643039261e-02_rk,-2.602085213965210642e-18_rk,0.000000000000000000e+00_rk,2.908882086657215912e-02_rk,-7.272205216643039261e-02_rk,-2.908882086657215565e-02_rk, &
                                        -2.602085213965210642e-18_rk, 0.000000000000000000e+00_rk, 2.908882086657215219e-02_rk,2.602085213965210642e-18_rk,1.301042606982605321e-18_rk,2.424068405547679869e-02_rk,-2.908882086657215565e-02_rk,-2.424068405547679522e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -3.926990816987241395e-01_rk, -1.308996938995746762e-01_rk, 1.308996938995746762e-01_rk,-1.308996938995746484e-01_rk,-4.363323129985821613e-02_rk,4.363323129985821613e-02_rk,4.363323129985823695e-02_rk,1.454441043328607783e-02_rk, &
                                        -1.308996938995746762e-01_rk, -1.308996938995747317e-01_rk, 4.363323129985823695e-02_rk,-4.363323129985821613e-02_rk,-4.363323129985821613e-02_rk,1.454441043328607783e-02_rk,4.363323129985823001e-02_rk,1.454441043328607783e-02_rk, &
                                        1.308996938995746762e-01_rk, 4.363323129985823695e-02_rk, -1.308996938995747317e-01_rk,4.363323129985821613e-02_rk,1.454441043328607783e-02_rk,-4.363323129985821613e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        -1.308996938995746484e-01_rk, -4.363323129985821613e-02_rk, 4.363323129985821613e-02_rk,-1.308996938995747317e-01_rk,-4.363323129985823001e-02_rk,4.363323129985823001e-02_rk,1.454441043328607783e-02_rk,1.454441043328607783e-02_rk, &
                                        -4.363323129985821613e-02_rk, -4.363323129985821613e-02_rk, 1.454441043328607783e-02_rk,-4.363323129985823001e-02_rk,-4.363323129985823001e-02_rk,1.454441043328608130e-02_rk,1.454441043328608130e-02_rk,1.454441043328608130e-02_rk, &
                                        4.363323129985821613e-02_rk, 1.454441043328607783e-02_rk, -4.363323129985821613e-02_rk,4.363323129985823001e-02_rk,1.454441043328608130e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328608130e-02_rk,-1.454441043328607956e-02_rk, &
                                        4.363323129985823695e-02_rk, 4.363323129985823001e-02_rk, -4.363323129985823001e-02_rk,1.454441043328607783e-02_rk,1.454441043328608130e-02_rk,-1.454441043328608130e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        1.454441043328607783e-02_rk, 1.454441043328607783e-02_rk, -1.454441043328607783e-02_rk,1.454441043328607783e-02_rk,1.454441043328608130e-02_rk,-1.454441043328607956e-02_rk,-1.454441043328607783e-02_rk,-1.454441043328607783e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,2) = reshape((/                                                                                 &
                                        3.333333333333333148e-01_rk, -3.469446951953614189e-18_rk, -1.111111111111111049e-01_rk,-8.333333333333331483e-02_rk,-2.602085213965210642e-18_rk,2.777777777777776930e-02_rk,-1.734723475976807094e-18_rk,4.336808689942017736e-19_rk, &
                                        -3.469446951953614189e-18_rk, 1.111111111111111049e-01_rk, -1.734723475976807094e-18_rk,-2.602085213965210642e-18_rk,-2.777777777777776930e-02_rk,4.336808689942017736e-19_rk,-3.703703703703702804e-02_rk,9.259259259259257011e-03_rk, &
                                        -1.111111111111111049e-01_rk, -1.734723475976807094e-18_rk, 1.111111111111111049e-01_rk,2.777777777777776930e-02_rk,4.336808689942017736e-19_rk,-2.777777777777776930e-02_rk,1.734723475976807094e-18_rk,4.336808689942017736e-19_rk, &
                                        -8.333333333333331483e-02_rk, -2.602085213965210642e-18_rk, 2.777777777777776930e-02_rk,1.111111111111111049e-01_rk,1.734723475976807094e-18_rk,-3.703703703703702804e-02_rk,4.336808689942017736e-19_rk,-4.336808689942017736e-19_rk, &
                                        -2.602085213965210642e-18_rk, -2.777777777777776930e-02_rk, 4.336808689942017736e-19_rk,1.734723475976807094e-18_rk,3.703703703703703498e-02_rk,4.336808689942017736e-19_rk,9.259259259259263949e-03_rk,-1.234567901234567486e-02_rk, &
                                        2.777777777777776930e-02_rk, 4.336808689942017736e-19_rk, -2.777777777777776930e-02_rk,-3.703703703703702804e-02_rk,4.336808689942017736e-19_rk,3.703703703703703498e-02_rk,-2.168404344971008868e-19_rk,0.000000000000000000e+00_rk, &
                                        -1.734723475976807094e-18_rk, -3.703703703703702804e-02_rk, 1.734723475976807094e-18_rk,4.336808689942017736e-19_rk,9.259259259259263949e-03_rk,-2.168404344971008868e-19_rk,3.703703703703703498e-02_rk,-9.259259259259255276e-03_rk, &
                                        4.336808689942017736e-19_rk, 9.259259259259257011e-03_rk, 4.336808689942017736e-19_rk,-4.336808689942017736e-19_rk,-1.234567901234567486e-02_rk,0.000000000000000000e+00_rk,-9.259259259259255276e-03_rk,1.234567901234567486e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -5.235987755982989267e-01_rk, -1.745329251994329200e-01_rk, 3.469446951953614189e-18_rk,1.308996938995747039e-01_rk,4.363323129985824389e-02_rk,-2.602085213965210642e-18_rk,4.336808689942017736e-18_rk,8.673617379884035472e-19_rk, &
                                        -1.745329251994329200e-01_rk, -1.745329251994329756e-01_rk, 4.336808689942017736e-18_rk,4.363323129985824389e-02_rk,4.363323129985824389e-02_rk,8.673617379884035472e-19_rk,1.734723475976807094e-18_rk,8.673617379884035472e-19_rk, &
                                        3.469446951953614189e-18_rk, 4.336808689942017736e-18_rk, -1.745329251994329756e-01_rk,-2.602085213965210642e-18_rk,8.673617379884035472e-19_rk,4.363323129985824389e-02_rk,-5.817764173314431825e-02_rk,1.454441043328607783e-02_rk, &
                                        1.308996938995747039e-01_rk, 4.363323129985824389e-02_rk, -2.602085213965210642e-18_rk,-1.745329251994329756e-01_rk,-5.817764173314431825e-02_rk,1.734723475976807094e-18_rk,8.673617379884035472e-19_rk,1.734723475976807094e-18_rk, &
                                        4.363323129985824389e-02_rk, 4.363323129985824389e-02_rk, 8.673617379884035472e-19_rk,-5.817764173314431825e-02_rk,-5.817764173314431825e-02_rk,0.000000000000000000e+00_rk,-1.734723475976807094e-18_rk,4.336808689942017736e-19_rk, &
                                        -2.602085213965210642e-18_rk, 8.673617379884035472e-19_rk, 4.363323129985824389e-02_rk,1.734723475976807094e-18_rk,0.000000000000000000e+00_rk,-5.817764173314431825e-02_rk,1.454441043328608477e-02_rk,-1.939254724438143826e-02_rk, &
                                        4.336808689942017736e-18_rk, 1.734723475976807094e-18_rk, -5.817764173314431825e-02_rk,8.673617379884035472e-19_rk,-1.734723475976807094e-18_rk,1.454441043328608477e-02_rk,-5.817764173314431825e-02_rk,1.454441043328608130e-02_rk, &
                                        8.673617379884035472e-19_rk, 8.673617379884035472e-19_rk, 1.454441043328607783e-02_rk,1.734723475976807094e-18_rk,4.336808689942017736e-19_rk,-1.939254724438143826e-02_rk,1.454441043328608130e-02_rk,-1.939254724438143479e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,1) = reshape((/                                                                                 &
                                        7.853981633974482790e-01_rk, 2.617993877991494078e-01_rk, -2.617993877991494078e-01_rk,1.308996938995746484e-01_rk,4.363323129985821613e-02_rk,-4.363323129985821613e-02_rk,-8.726646259971647390e-02_rk,-1.454441043328607783e-02_rk, &
                                        2.617993877991494078e-01_rk, 2.617993877991494078e-01_rk, -8.726646259971647390e-02_rk,4.363323129985821613e-02_rk,4.363323129985821613e-02_rk,-1.454441043328607783e-02_rk,-8.726646259971647390e-02_rk,-1.454441043328607783e-02_rk, &
                                        -2.617993877991494078e-01_rk, -8.726646259971647390e-02_rk, 2.617993877991494078e-01_rk,-4.363323129985821613e-02_rk,-1.454441043328607783e-02_rk,4.363323129985821613e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk, &
                                        1.308996938995746484e-01_rk, 4.363323129985821613e-02_rk, -4.363323129985821613e-02_rk,2.617993877991494078e-01_rk,8.726646259971647390e-02_rk,-8.726646259971647390e-02_rk,-1.454441043328607783e-02_rk,-2.908882086657215565e-02_rk, &
                                        4.363323129985821613e-02_rk, 4.363323129985821613e-02_rk, -1.454441043328607783e-02_rk,8.726646259971647390e-02_rk,8.726646259971647390e-02_rk,-2.908882086657216259e-02_rk,-1.454441043328607956e-02_rk,-2.908882086657215565e-02_rk, &
                                        -4.363323129985821613e-02_rk, -1.454441043328607783e-02_rk, 4.363323129985821613e-02_rk,-8.726646259971647390e-02_rk,-2.908882086657216259e-02_rk,8.726646259971647390e-02_rk,1.454441043328608130e-02_rk,2.908882086657215565e-02_rk, &
                                        -8.726646259971647390e-02_rk, -8.726646259971647390e-02_rk, 8.726646259971647390e-02_rk,-1.454441043328607783e-02_rk,-1.454441043328607956e-02_rk,1.454441043328608130e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk, &
                                        -1.454441043328607783e-02_rk, -1.454441043328607783e-02_rk, 1.454441043328607783e-02_rk,-2.908882086657215565e-02_rk,-2.908882086657215565e-02_rk,2.908882086657215565e-02_rk,1.454441043328607783e-02_rk,2.908882086657215219e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,2) = reshape((/                                                                                 &
                                        4.166666666666666852e-01_rk, -3.469446951953614189e-18_rk, -1.388888888888888951e-01_rk,1.666666666666666852e-01_rk,2.602085213965210642e-18_rk,-5.555555555555554553e-02_rk,-1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk, &
                                        -3.469446951953614189e-18_rk, 1.388888888888888951e-01_rk, -1.734723475976807094e-18_rk,2.602085213965210642e-18_rk,5.555555555555554553e-02_rk,-4.336808689942017736e-19_rk,-4.629629629629628679e-02_rk,-1.851851851851851055e-02_rk, &
                                        -1.388888888888888951e-01_rk, -1.734723475976807094e-18_rk, 1.388888888888888951e-01_rk,-5.555555555555554553e-02_rk,-4.336808689942017736e-19_rk,5.555555555555554553e-02_rk,1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk, &
                                        1.666666666666666852e-01_rk, 2.602085213965210642e-18_rk, -5.555555555555554553e-02_rk,1.388888888888888951e-01_rk,1.734723475976807094e-18_rk,-4.629629629629628679e-02_rk,-4.336808689942017736e-19_rk,-4.336808689942017736e-19_rk, &
                                        2.602085213965210642e-18_rk, 5.555555555555554553e-02_rk, -4.336808689942017736e-19_rk,1.734723475976807094e-18_rk,4.629629629629629373e-02_rk,4.336808689942017736e-19_rk,-1.851851851851851749e-02_rk,-1.543209876543209444e-02_rk, &
                                        -5.555555555555554553e-02_rk, -4.336808689942017736e-19_rk, 5.555555555555554553e-02_rk,-4.629629629629628679e-02_rk,4.336808689942017736e-19_rk,4.629629629629629373e-02_rk,2.168404344971008868e-19_rk,0.000000000000000000e+00_rk, &
                                        -1.734723475976807094e-18_rk, -4.629629629629628679e-02_rk, 1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk,-1.851851851851851749e-02_rk,2.168404344971008868e-19_rk,4.629629629629629373e-02_rk,1.851851851851851402e-02_rk, &
                                        -4.336808689942017736e-19_rk, -1.851851851851851055e-02_rk, -4.336808689942017736e-19_rk,-4.336808689942017736e-19_rk,-1.543209876543209444e-02_rk,0.000000000000000000e+00_rk,1.851851851851851402e-02_rk,1.543209876543209444e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -6.544984694978734918e-01_rk, -2.181661564992911639e-01_rk, -3.469446951953614189e-18_rk,-2.617993877991493523e-01_rk,-8.726646259971646002e-02_rk,2.602085213965210642e-18_rk,2.602085213965210642e-18_rk,-2.602085213965210642e-18_rk, &
                                        -2.181661564992911639e-01_rk, -2.181661564992911639e-01_rk, 2.602085213965210642e-18_rk,-8.726646259971646002e-02_rk,-8.726646259971646002e-02_rk,-2.602085213965210642e-18_rk,0.000000000000000000e+00_rk,-8.673617379884035472e-19_rk, &
                                        -3.469446951953614189e-18_rk, 2.602085213965210642e-18_rk, -2.181661564992911639e-01_rk,2.602085213965210642e-18_rk,-2.602085213965210642e-18_rk,-8.726646259971646002e-02_rk,-7.272205216643039261e-02_rk,-2.908882086657215219e-02_rk, &
                                        -2.617993877991493523e-01_rk, -8.726646259971646002e-02_rk, 2.602085213965210642e-18_rk,-2.181661564992911639e-01_rk,-7.272205216643039261e-02_rk,0.000000000000000000e+00_rk,-2.602085213965210642e-18_rk,8.673617379884035472e-19_rk, &
                                        -8.726646259971646002e-02_rk, -8.726646259971646002e-02_rk, -2.602085213965210642e-18_rk,-7.272205216643039261e-02_rk,-7.272205216643039261e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.301042606982605321e-18_rk, &
                                        2.602085213965210642e-18_rk, -2.602085213965210642e-18_rk, -8.726646259971646002e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.272205216643039261e-02_rk,-2.908882086657215565e-02_rk,-2.424068405547679869e-02_rk, &
                                        2.602085213965210642e-18_rk, 0.000000000000000000e+00_rk, -7.272205216643039261e-02_rk,-2.602085213965210642e-18_rk,0.000000000000000000e+00_rk,-2.908882086657215565e-02_rk,-7.272205216643039261e-02_rk,-2.908882086657215565e-02_rk, &
                                        -2.602085213965210642e-18_rk, -8.673617379884035472e-19_rk, -2.908882086657215219e-02_rk,8.673617379884035472e-19_rk,1.301042606982605321e-18_rk,-2.424068405547679869e-02_rk,-2.908882086657215565e-02_rk,-2.424068405547679522e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -3.926990816987241395e-01_rk, 1.308996938995746762e-01_rk, -1.308996938995746762e-01_rk,-1.308996938995746484e-01_rk,4.363323129985821613e-02_rk,-4.363323129985821613e-02_rk,4.363323129985823001e-02_rk,1.454441043328607783e-02_rk, &
                                        1.308996938995746762e-01_rk, -1.308996938995747317e-01_rk, 4.363323129985823001e-02_rk,4.363323129985821613e-02_rk,-4.363323129985821613e-02_rk,1.454441043328607783e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        -1.308996938995746762e-01_rk, 4.363323129985823001e-02_rk, -1.308996938995747317e-01_rk,-4.363323129985821613e-02_rk,1.454441043328607783e-02_rk,-4.363323129985821613e-02_rk,4.363323129985823001e-02_rk,1.454441043328607783e-02_rk, &
                                        -1.308996938995746484e-01_rk, 4.363323129985821613e-02_rk, -4.363323129985821613e-02_rk,-1.308996938995747317e-01_rk,4.363323129985823001e-02_rk,-4.363323129985823001e-02_rk,1.454441043328607783e-02_rk,1.454441043328607783e-02_rk, &
                                        4.363323129985821613e-02_rk, -4.363323129985821613e-02_rk, 1.454441043328607783e-02_rk,4.363323129985823001e-02_rk,-4.363323129985823001e-02_rk,1.454441043328608130e-02_rk,-1.454441043328608303e-02_rk,-1.454441043328607956e-02_rk, &
                                        -4.363323129985821613e-02_rk, 1.454441043328607783e-02_rk, -4.363323129985821613e-02_rk,-4.363323129985823001e-02_rk,1.454441043328608130e-02_rk,-4.363323129985823001e-02_rk,1.454441043328608130e-02_rk,1.454441043328608130e-02_rk, &
                                        4.363323129985823001e-02_rk, -4.363323129985823001e-02_rk, 4.363323129985823001e-02_rk,1.454441043328607783e-02_rk,-1.454441043328608303e-02_rk,1.454441043328608130e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        1.454441043328607783e-02_rk, -1.454441043328607783e-02_rk, 1.454441043328607783e-02_rk,1.454441043328607783e-02_rk,-1.454441043328607956e-02_rk,1.454441043328608130e-02_rk,-1.454441043328607783e-02_rk,-1.454441043328607783e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -3.333333333333333148e-01_rk, 3.469446951953614189e-18_rk, -1.111111111111111049e-01_rk,8.333333333333331483e-02_rk,8.673617379884035472e-19_rk,2.777777777777776930e-02_rk,-1.734723475976807094e-18_rk,-1.301042606982605321e-18_rk, &
                                        3.469446951953614189e-18_rk, -1.111111111111111049e-01_rk, -1.734723475976807094e-18_rk,8.673617379884035472e-19_rk,2.777777777777776930e-02_rk,-1.301042606982605321e-18_rk,-3.703703703703702804e-02_rk,9.259259259259257011e-03_rk, &
                                        -1.111111111111111049e-01_rk, -1.734723475976807094e-18_rk, -1.111111111111111049e-01_rk,2.777777777777776930e-02_rk,-1.301042606982605321e-18_rk,2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,-4.336808689942017736e-19_rk, &
                                        8.333333333333331483e-02_rk, 8.673617379884035472e-19_rk, 2.777777777777776930e-02_rk,-1.111111111111111049e-01_rk,0.000000000000000000e+00_rk,-3.703703703703702804e-02_rk,-1.301042606982605321e-18_rk,1.301042606982605321e-18_rk, &
                                        8.673617379884035472e-19_rk, 2.777777777777776930e-02_rk, -1.301042606982605321e-18_rk,0.000000000000000000e+00_rk,-3.703703703703703498e-02_rk,-1.301042606982605321e-18_rk,9.259259259259263949e-03_rk,-1.234567901234567486e-02_rk, &
                                        2.777777777777776930e-02_rk, -1.301042606982605321e-18_rk, 2.777777777777776930e-02_rk,-3.703703703703702804e-02_rk,-1.301042606982605321e-18_rk,-3.703703703703703498e-02_rk,6.505213034913026604e-19_rk,0.000000000000000000e+00_rk, &
                                        -1.734723475976807094e-18_rk, -3.703703703703702804e-02_rk, 0.000000000000000000e+00_rk,-1.301042606982605321e-18_rk,9.259259259259263949e-03_rk,6.505213034913026604e-19_rk,-3.703703703703703498e-02_rk,9.259259259259255276e-03_rk, &
                                        -1.301042606982605321e-18_rk, 9.259259259259257011e-03_rk, -4.336808689942017736e-19_rk,1.301042606982605321e-18_rk,-1.234567901234567486e-02_rk,0.000000000000000000e+00_rk,9.259259259259255276e-03_rk,-1.234567901234567486e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,3) = reshape((/                                                                                 &
                                        5.235987755982989267e-01_rk, -1.745329251994329200e-01_rk, -3.469446951953614189e-18_rk,-1.308996938995747039e-01_rk,4.363323129985824389e-02_rk,4.336808689942017736e-18_rk,4.336808689942017736e-18_rk,-4.336808689942017736e-18_rk, &
                                        -1.745329251994329200e-01_rk, 1.745329251994329756e-01_rk, 4.336808689942017736e-18_rk,4.363323129985824389e-02_rk,-4.363323129985824389e-02_rk,-4.336808689942017736e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 4.336808689942017736e-18_rk, 1.745329251994329756e-01_rk,4.336808689942017736e-18_rk,-4.336808689942017736e-18_rk,-4.363323129985824389e-02_rk,-5.817764173314431825e-02_rk,1.454441043328607783e-02_rk, &
                                        -1.308996938995747039e-01_rk, 4.363323129985824389e-02_rk, 4.336808689942017736e-18_rk,1.745329251994329756e-01_rk,-5.817764173314431825e-02_rk,-6.938893903907228378e-18_rk,-4.336808689942017736e-18_rk,-1.734723475976807094e-18_rk, &
                                        4.363323129985824389e-02_rk, -4.363323129985824389e-02_rk, -4.336808689942017736e-18_rk,-5.817764173314431825e-02_rk,5.817764173314431825e-02_rk,1.734723475976807094e-18_rk,1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk, &
                                        4.336808689942017736e-18_rk, -4.336808689942017736e-18_rk, -4.363323129985824389e-02_rk,-6.938893903907228378e-18_rk,1.734723475976807094e-18_rk,5.817764173314431825e-02_rk,1.454441043328608650e-02_rk,-1.939254724438143826e-02_rk, &
                                        4.336808689942017736e-18_rk, -6.938893903907228378e-18_rk, -5.817764173314431825e-02_rk,-4.336808689942017736e-18_rk,1.734723475976807094e-18_rk,1.454441043328608650e-02_rk,5.817764173314431825e-02_rk,-1.454441043328608130e-02_rk, &
                                        -4.336808689942017736e-18_rk, 0.000000000000000000e+00_rk, 1.454441043328607783e-02_rk,-1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk,-1.939254724438143826e-02_rk,-1.454441043328608130e-02_rk,1.939254724438143479e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,1) = reshape((/                                                                                 &
                                        7.853981633974482790e-01_rk, -2.617993877991494078e-01_rk, 2.617993877991494078e-01_rk,1.308996938995746484e-01_rk,-4.363323129985821613e-02_rk,4.363323129985821613e-02_rk,-8.726646259971646002e-02_rk,-1.454441043328607783e-02_rk, &
                                        -2.617993877991494078e-01_rk, 2.617993877991494078e-01_rk, -8.726646259971646002e-02_rk,-4.363323129985821613e-02_rk,4.363323129985821613e-02_rk,-1.454441043328607783e-02_rk,8.726646259971646002e-02_rk,1.454441043328607783e-02_rk, &
                                        2.617993877991494078e-01_rk, -8.726646259971646002e-02_rk, 2.617993877991494078e-01_rk,4.363323129985821613e-02_rk,-1.454441043328607783e-02_rk,4.363323129985821613e-02_rk,-8.726646259971647390e-02_rk,-1.454441043328607783e-02_rk, &
                                        1.308996938995746484e-01_rk, -4.363323129985821613e-02_rk, 4.363323129985821613e-02_rk,2.617993877991494078e-01_rk,-8.726646259971647390e-02_rk,8.726646259971646002e-02_rk,-1.454441043328607783e-02_rk,-2.908882086657215565e-02_rk, &
                                        -4.363323129985821613e-02_rk, 4.363323129985821613e-02_rk, -1.454441043328607783e-02_rk,-8.726646259971647390e-02_rk,8.726646259971647390e-02_rk,-2.908882086657216259e-02_rk,1.454441043328608130e-02_rk,2.908882086657215565e-02_rk, &
                                        4.363323129985821613e-02_rk, -1.454441043328607783e-02_rk, 4.363323129985821613e-02_rk,8.726646259971646002e-02_rk,-2.908882086657216259e-02_rk,8.726646259971647390e-02_rk,-1.454441043328608130e-02_rk,-2.908882086657215565e-02_rk, &
                                        -8.726646259971646002e-02_rk, 8.726646259971646002e-02_rk, -8.726646259971647390e-02_rk,-1.454441043328607783e-02_rk,1.454441043328608130e-02_rk,-1.454441043328608130e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk, &
                                        -1.454441043328607783e-02_rk, 1.454441043328607783e-02_rk, -1.454441043328607783e-02_rk,-2.908882086657215565e-02_rk,2.908882086657215565e-02_rk,-2.908882086657215565e-02_rk,1.454441043328607783e-02_rk,2.908882086657215219e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -4.166666666666666852e-01_rk, 3.469446951953614189e-18_rk, -1.388888888888888951e-01_rk,-1.666666666666666852e-01_rk,-8.673617379884035472e-19_rk,-5.555555555555554553e-02_rk,-1.734723475976807094e-18_rk,1.301042606982605321e-18_rk, &
                                        3.469446951953614189e-18_rk, -1.388888888888888951e-01_rk, -1.734723475976807094e-18_rk,-8.673617379884035472e-19_rk,-5.555555555555554553e-02_rk,1.301042606982605321e-18_rk,-4.629629629629628679e-02_rk,-1.851851851851851402e-02_rk, &
                                        -1.388888888888888951e-01_rk, -1.734723475976807094e-18_rk, -1.388888888888888951e-01_rk,-5.555555555555554553e-02_rk,1.301042606982605321e-18_rk,-5.555555555555554553e-02_rk,0.000000000000000000e+00_rk,4.336808689942017736e-19_rk, &
                                        -1.666666666666666852e-01_rk, -8.673617379884035472e-19_rk, -5.555555555555554553e-02_rk,-1.388888888888888951e-01_rk,0.000000000000000000e+00_rk,-4.629629629629628679e-02_rk,1.301042606982605321e-18_rk,1.301042606982605321e-18_rk, &
                                        -8.673617379884035472e-19_rk, -5.555555555555554553e-02_rk, 1.301042606982605321e-18_rk,0.000000000000000000e+00_rk,-4.629629629629629373e-02_rk,-1.301042606982605321e-18_rk,-1.851851851851851749e-02_rk,-1.543209876543209444e-02_rk, &
                                        -5.555555555555554553e-02_rk, 1.301042606982605321e-18_rk, -5.555555555555554553e-02_rk,-4.629629629629628679e-02_rk,-1.301042606982605321e-18_rk,-4.629629629629629373e-02_rk,-6.505213034913026604e-19_rk,0.000000000000000000e+00_rk, &
                                        -1.734723475976807094e-18_rk, -4.629629629629628679e-02_rk, 0.000000000000000000e+00_rk,1.301042606982605321e-18_rk,-1.851851851851851749e-02_rk,-6.505213034913026604e-19_rk,-4.629629629629629373e-02_rk,-1.851851851851851402e-02_rk, &
                                        1.301042606982605321e-18_rk, -1.851851851851851402e-02_rk, 4.336808689942017736e-19_rk,1.301042606982605321e-18_rk,-1.543209876543209444e-02_rk,0.000000000000000000e+00_rk,-1.851851851851851402e-02_rk,-1.543209876543209444e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,3) = reshape((/                                                                                 &
                                        6.544984694978734918e-01_rk, -2.181661564992911639e-01_rk, 3.469446951953614189e-18_rk,2.617993877991493523e-01_rk,-8.726646259971646002e-02_rk,-4.336808689942017736e-18_rk,2.602085213965210642e-18_rk,2.602085213965210642e-18_rk, &
                                        -2.181661564992911639e-01_rk, 2.181661564992911639e-01_rk, 2.602085213965210642e-18_rk,-8.726646259971646002e-02_rk,8.726646259971646002e-02_rk,2.602085213965210642e-18_rk,-5.204170427930421283e-18_rk,0.000000000000000000e+00_rk, &
                                        3.469446951953614189e-18_rk, 2.602085213965210642e-18_rk, 2.181661564992911639e-01_rk,-4.336808689942017736e-18_rk,2.602085213965210642e-18_rk,8.726646259971646002e-02_rk,-7.272205216643039261e-02_rk,-2.908882086657215219e-02_rk, &
                                        2.617993877991493523e-01_rk, -8.726646259971646002e-02_rk, -4.336808689942017736e-18_rk,2.181661564992911639e-01_rk,-7.272205216643039261e-02_rk,-5.204170427930421283e-18_rk,2.602085213965210642e-18_rk,-2.602085213965210642e-18_rk, &
                                        -8.726646259971646002e-02_rk, 8.726646259971646002e-02_rk, 2.602085213965210642e-18_rk,-7.272205216643039261e-02_rk,7.272205216643039261e-02_rk,1.734723475976807094e-18_rk,0.000000000000000000e+00_rk,-1.301042606982605321e-18_rk, &
                                        -4.336808689942017736e-18_rk, 2.602085213965210642e-18_rk, 8.726646259971646002e-02_rk,-5.204170427930421283e-18_rk,1.734723475976807094e-18_rk,7.272205216643039261e-02_rk,-2.908882086657215912e-02_rk,-2.424068405547679869e-02_rk, &
                                        2.602085213965210642e-18_rk, -5.204170427930421283e-18_rk, -7.272205216643039261e-02_rk,2.602085213965210642e-18_rk,0.000000000000000000e+00_rk,-2.908882086657215912e-02_rk,7.272205216643039261e-02_rk,2.908882086657215565e-02_rk, &
                                        2.602085213965210642e-18_rk, 0.000000000000000000e+00_rk, -2.908882086657215219e-02_rk,-2.602085213965210642e-18_rk,-1.301042606982605321e-18_rk,-2.424068405547679869e-02_rk,2.908882086657215565e-02_rk,2.424068405547679522e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -3.926990816987241395e-01_rk, -1.308996938995746762e-01_rk, -1.308996938995746762e-01_rk,-1.308996938995746484e-01_rk,-4.363323129985821613e-02_rk,-4.363323129985821613e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        -1.308996938995746762e-01_rk, -1.308996938995747317e-01_rk, -4.363323129985823001e-02_rk,-4.363323129985821613e-02_rk,-4.363323129985821613e-02_rk,-1.454441043328607783e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        -1.308996938995746762e-01_rk, -4.363323129985823001e-02_rk, -1.308996938995747317e-01_rk,-4.363323129985821613e-02_rk,-1.454441043328607783e-02_rk,-4.363323129985821613e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        -1.308996938995746484e-01_rk, -4.363323129985821613e-02_rk, -4.363323129985821613e-02_rk,-1.308996938995747317e-01_rk,-4.363323129985823001e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk,-1.454441043328607609e-02_rk, &
                                        -4.363323129985821613e-02_rk, -4.363323129985821613e-02_rk, -1.454441043328607783e-02_rk,-4.363323129985823001e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328608130e-02_rk,-1.454441043328608130e-02_rk,-1.454441043328607956e-02_rk, &
                                        -4.363323129985821613e-02_rk, -1.454441043328607783e-02_rk, -4.363323129985821613e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328608130e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328608130e-02_rk,-1.454441043328607956e-02_rk, &
                                        -4.363323129985823001e-02_rk, -4.363323129985823001e-02_rk, -4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk,-1.454441043328608130e-02_rk,-1.454441043328608130e-02_rk,-4.363323129985823001e-02_rk,-1.454441043328607783e-02_rk, &
                                        -1.454441043328607783e-02_rk, -1.454441043328607783e-02_rk, -1.454441043328607783e-02_rk,-1.454441043328607609e-02_rk,-1.454441043328607956e-02_rk,-1.454441043328607956e-02_rk,-1.454441043328607783e-02_rk,-1.454441043328607783e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,2) = reshape((/                                                                                 &
                                        3.333333333333333148e-01_rk, -3.469446951953614189e-18_rk, 1.111111111111111049e-01_rk,-8.333333333333331483e-02_rk,-8.673617379884035472e-19_rk,-2.777777777777776930e-02_rk,1.734723475976807094e-18_rk,1.301042606982605321e-18_rk, &
                                        -3.469446951953614189e-18_rk, 1.111111111111111049e-01_rk, 1.734723475976807094e-18_rk,-8.673617379884035472e-19_rk,-2.777777777777776930e-02_rk,1.301042606982605321e-18_rk,3.703703703703702804e-02_rk,-9.259259259259257011e-03_rk, &
                                        1.111111111111111049e-01_rk, 1.734723475976807094e-18_rk, 1.111111111111111049e-01_rk,-2.777777777777776930e-02_rk,1.301042606982605321e-18_rk,-2.777777777777776930e-02_rk,0.000000000000000000e+00_rk,4.336808689942017736e-19_rk, &
                                        -8.333333333333331483e-02_rk, -8.673617379884035472e-19_rk, -2.777777777777776930e-02_rk,1.111111111111111049e-01_rk,0.000000000000000000e+00_rk,3.703703703703702804e-02_rk,1.301042606982605321e-18_rk,-1.301042606982605321e-18_rk, &
                                        -8.673617379884035472e-19_rk, -2.777777777777776930e-02_rk, 1.301042606982605321e-18_rk,0.000000000000000000e+00_rk,3.703703703703703498e-02_rk,1.301042606982605321e-18_rk,-9.259259259259263949e-03_rk,1.234567901234567486e-02_rk, &
                                        -2.777777777777776930e-02_rk, 1.301042606982605321e-18_rk, -2.777777777777776930e-02_rk,3.703703703703702804e-02_rk,1.301042606982605321e-18_rk,3.703703703703703498e-02_rk,-6.505213034913026604e-19_rk,0.000000000000000000e+00_rk, &
                                        1.734723475976807094e-18_rk, 3.703703703703702804e-02_rk, 0.000000000000000000e+00_rk,1.301042606982605321e-18_rk,-9.259259259259263949e-03_rk,-6.505213034913026604e-19_rk,3.703703703703703498e-02_rk,-9.259259259259255276e-03_rk, &
                                        1.301042606982605321e-18_rk, -9.259259259259257011e-03_rk, 4.336808689942017736e-19_rk,-1.301042606982605321e-18_rk,1.234567901234567486e-02_rk,0.000000000000000000e+00_rk,-9.259259259259255276e-03_rk,1.234567901234567486e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,3) = reshape((/                                                                                 &
                                        5.235987755982989267e-01_rk, 1.745329251994329200e-01_rk, -3.469446951953614189e-18_rk,-1.308996938995747039e-01_rk,-4.363323129985824389e-02_rk,2.602085213965210642e-18_rk,-4.336808689942017736e-18_rk,-8.673617379884035472e-19_rk, &
                                        1.745329251994329200e-01_rk, 1.745329251994329756e-01_rk, -4.336808689942017736e-18_rk,-4.363323129985824389e-02_rk,-4.363323129985824389e-02_rk,-8.673617379884035472e-19_rk,-1.734723475976807094e-18_rk,-8.673617379884035472e-19_rk, &
                                        -3.469446951953614189e-18_rk, -4.336808689942017736e-18_rk, 1.745329251994329756e-01_rk,2.602085213965210642e-18_rk,-8.673617379884035472e-19_rk,-4.363323129985824389e-02_rk,5.817764173314431825e-02_rk,-1.454441043328607783e-02_rk, &
                                        -1.308996938995747039e-01_rk, -4.363323129985824389e-02_rk, 2.602085213965210642e-18_rk,1.745329251994329756e-01_rk,5.817764173314431825e-02_rk,-1.734723475976807094e-18_rk,-8.673617379884035472e-19_rk,-1.734723475976807094e-18_rk, &
                                        -4.363323129985824389e-02_rk, -4.363323129985824389e-02_rk, -8.673617379884035472e-19_rk,5.817764173314431825e-02_rk,5.817764173314431825e-02_rk,0.000000000000000000e+00_rk,1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk, &
                                        2.602085213965210642e-18_rk, -8.673617379884035472e-19_rk, -4.363323129985824389e-02_rk,-1.734723475976807094e-18_rk,0.000000000000000000e+00_rk,5.817764173314431825e-02_rk,-1.454441043328608477e-02_rk,1.939254724438143826e-02_rk, &
                                        -4.336808689942017736e-18_rk, -1.734723475976807094e-18_rk, 5.817764173314431825e-02_rk,-8.673617379884035472e-19_rk,1.734723475976807094e-18_rk,-1.454441043328608477e-02_rk,5.817764173314431825e-02_rk,-1.454441043328608130e-02_rk, &
                                        -8.673617379884035472e-19_rk, -8.673617379884035472e-19_rk, -1.454441043328607783e-02_rk,-1.734723475976807094e-18_rk,-4.336808689942017736e-19_rk,1.939254724438143826e-02_rk,-1.454441043328608130e-02_rk,1.939254724438143479e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,1) = reshape((/                                                                                 &
                                        7.853981633974482790e-01_rk, 2.617993877991494078e-01_rk, 2.617993877991494078e-01_rk,1.308996938995746484e-01_rk,4.363323129985821613e-02_rk,4.363323129985821613e-02_rk,8.726646259971646002e-02_rk,1.454441043328607783e-02_rk, &
                                        2.617993877991494078e-01_rk, 2.617993877991494078e-01_rk, 8.726646259971646002e-02_rk,4.363323129985821613e-02_rk,4.363323129985821613e-02_rk,1.454441043328607783e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk, &
                                        2.617993877991494078e-01_rk, 8.726646259971646002e-02_rk, 2.617993877991494078e-01_rk,4.363323129985821613e-02_rk,1.454441043328607783e-02_rk,4.363323129985821613e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk, &
                                        1.308996938995746484e-01_rk, 4.363323129985821613e-02_rk, 4.363323129985821613e-02_rk,2.617993877991494078e-01_rk,8.726646259971647390e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk,2.908882086657215219e-02_rk, &
                                        4.363323129985821613e-02_rk, 4.363323129985821613e-02_rk, 1.454441043328607783e-02_rk,8.726646259971647390e-02_rk,8.726646259971647390e-02_rk,2.908882086657216259e-02_rk,1.454441043328608303e-02_rk,2.908882086657215565e-02_rk, &
                                        4.363323129985821613e-02_rk, 1.454441043328607783e-02_rk, 4.363323129985821613e-02_rk,8.726646259971647390e-02_rk,2.908882086657216259e-02_rk,8.726646259971647390e-02_rk,1.454441043328608130e-02_rk,2.908882086657215565e-02_rk, &
                                        8.726646259971646002e-02_rk, 8.726646259971647390e-02_rk, 8.726646259971647390e-02_rk,1.454441043328607783e-02_rk,1.454441043328608303e-02_rk,1.454441043328608130e-02_rk,8.726646259971647390e-02_rk,1.454441043328607783e-02_rk, &
                                        1.454441043328607783e-02_rk, 1.454441043328607783e-02_rk, 1.454441043328607783e-02_rk,2.908882086657215219e-02_rk,2.908882086657215565e-02_rk,2.908882086657215565e-02_rk,1.454441043328607783e-02_rk,2.908882086657215219e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,2) = reshape((/                                                                                 &
                                        4.166666666666666852e-01_rk, -3.469446951953614189e-18_rk, 1.388888888888888951e-01_rk,1.666666666666666852e-01_rk,8.673617379884035472e-19_rk,5.555555555555554553e-02_rk,1.734723475976807094e-18_rk,-1.301042606982605321e-18_rk, &
                                        -3.469446951953614189e-18_rk, 1.388888888888888951e-01_rk, 1.734723475976807094e-18_rk,8.673617379884035472e-19_rk,5.555555555555554553e-02_rk,-1.301042606982605321e-18_rk,4.629629629629628679e-02_rk,1.851851851851851402e-02_rk, &
                                        1.388888888888888951e-01_rk, 1.734723475976807094e-18_rk, 1.388888888888888951e-01_rk,5.555555555555554553e-02_rk,-1.301042606982605321e-18_rk,5.555555555555554553e-02_rk,0.000000000000000000e+00_rk,-4.336808689942017736e-19_rk, &
                                        1.666666666666666852e-01_rk, 8.673617379884035472e-19_rk, 5.555555555555554553e-02_rk,1.388888888888888951e-01_rk,0.000000000000000000e+00_rk,4.629629629629628679e-02_rk,-1.301042606982605321e-18_rk,-1.301042606982605321e-18_rk, &
                                        8.673617379884035472e-19_rk, 5.555555555555554553e-02_rk, -1.301042606982605321e-18_rk,0.000000000000000000e+00_rk,4.629629629629629373e-02_rk,1.301042606982605321e-18_rk,1.851851851851851749e-02_rk,1.543209876543209444e-02_rk, &
                                        5.555555555555554553e-02_rk, -1.301042606982605321e-18_rk, 5.555555555555554553e-02_rk,4.629629629629628679e-02_rk,1.301042606982605321e-18_rk,4.629629629629629373e-02_rk,6.505213034913026604e-19_rk,0.000000000000000000e+00_rk, &
                                        1.734723475976807094e-18_rk, 4.629629629629628679e-02_rk, 0.000000000000000000e+00_rk,-1.301042606982605321e-18_rk,1.851851851851851749e-02_rk,6.505213034913026604e-19_rk,4.629629629629629373e-02_rk,1.851851851851851402e-02_rk, &
                                        -1.301042606982605321e-18_rk, 1.851851851851851402e-02_rk, -4.336808689942017736e-19_rk,-1.301042606982605321e-18_rk,1.543209876543209444e-02_rk,0.000000000000000000e+00_rk,1.851851851851851402e-02_rk,1.543209876543209444e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,3) = reshape((/                                                                                 &
                                        6.544984694978734918e-01_rk, 2.181661564992911639e-01_rk, 3.469446951953614189e-18_rk,2.617993877991493523e-01_rk,8.726646259971646002e-02_rk,-2.602085213965210642e-18_rk,-2.602085213965210642e-18_rk,2.602085213965210642e-18_rk, &
                                        2.181661564992911639e-01_rk, 2.181661564992911639e-01_rk, -2.602085213965210642e-18_rk,8.726646259971646002e-02_rk,8.726646259971646002e-02_rk,2.602085213965210642e-18_rk,0.000000000000000000e+00_rk,8.673617379884035472e-19_rk, &
                                        3.469446951953614189e-18_rk, -2.602085213965210642e-18_rk, 2.181661564992911639e-01_rk,-2.602085213965210642e-18_rk,2.602085213965210642e-18_rk,8.726646259971646002e-02_rk,7.272205216643039261e-02_rk,2.908882086657215219e-02_rk, &
                                        2.617993877991493523e-01_rk, 8.726646259971646002e-02_rk, -2.602085213965210642e-18_rk,2.181661564992911639e-01_rk,7.272205216643039261e-02_rk,0.000000000000000000e+00_rk,2.602085213965210642e-18_rk,-8.673617379884035472e-19_rk, &
                                        8.726646259971646002e-02_rk, 8.726646259971646002e-02_rk, 2.602085213965210642e-18_rk,7.272205216643039261e-02_rk,7.272205216643039261e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.301042606982605321e-18_rk, &
                                        -2.602085213965210642e-18_rk, 2.602085213965210642e-18_rk, 8.726646259971646002e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.272205216643039261e-02_rk,2.908882086657215565e-02_rk,2.424068405547679869e-02_rk, &
                                        -2.602085213965210642e-18_rk, 0.000000000000000000e+00_rk, 7.272205216643039261e-02_rk,2.602085213965210642e-18_rk,0.000000000000000000e+00_rk,2.908882086657215565e-02_rk,7.272205216643039261e-02_rk,2.908882086657215565e-02_rk, &
                                        2.602085213965210642e-18_rk, 8.673617379884035472e-19_rk, 2.908882086657215219e-02_rk,-8.673617379884035472e-19_rk,-1.301042606982605321e-18_rk,2.424068405547679869e-02_rk,2.908882086657215565e-02_rk,2.424068405547679522e-02_rk  &
                                        /),(/8,8/))
        
        


        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dmass_dx(:,:,inode_diff,idir)),self%elem%dmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dmass_dx
    !*******************************************************************************************









    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_vol_dcoords_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nnodes_r*3,self%elem%basis_s%nnodes_ie()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_ie(),self%elem%nnodes_r*3) :: dcoords_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,8/))
        
        
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_ie()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','1',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,8/))
        
        
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_ie()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','2',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk  &
                                        /),(/24,8/))
        
        
        
        
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_ie()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','3',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_vol_dcoords_dx
    !*******************************************************************************************



!------------------------------------------------------------------------------
!                                Face tests
!------------------------------------------------------------------------------






    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_zetamin_dcoords_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nnodes_r*3,self%elem%basis_s%nnodes_if()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_if(),self%elem%nnodes_r*3) :: dcoords_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        6.220084679281462359e-01_rk, 1.666666666666666852e-01_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.666666666666666852e-01_rk, 6.220084679281462359e-01_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.666666666666666574e-01_rk, 4.465819873852045624e-02_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        4.465819873852045624e-02_rk, 1.666666666666666574e-01_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_if()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','1',inode,5)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281462359e-01_rk, 1.666666666666666852e-01_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 6.220084679281462359e-01_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666574e-01_rk, 4.465819873852045624e-02_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852045624e-02_rk, 1.666666666666666574e-01_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_if()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','2',inode,5)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.220084679281462359e-01_rk, 1.666666666666666852e-01_rk, 1.666666666666666574e-01_rk,4.465819873852045624e-02_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk, 6.220084679281462359e-01_rk, 4.465819873852045624e-02_rk,1.666666666666666574e-01_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.666666666666666574e-01_rk, 4.465819873852045624e-02_rk, 6.220084679281462359e-01_rk,1.666666666666666852e-01_rk,6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.465819873852045624e-02_rk, 1.666666666666666574e-01_rk, 1.666666666666666852e-01_rk,6.220084679281462359e-01_rk,-6.938893903907228378e-18_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_if()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','3',inode,5)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_zetamin_dcoords_dx
    !*******************************************************************************************








    !> Test cartesian dbr2_vol_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_vol_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_if(),  self%elem%basis_s%nnodes_ie(),self%elem%nnodes_r,3)   :: test_dbr2_vol_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_if(),  self%elem%basis_s%nnodes_ie(),self%elem%nnodes_r,3)   :: test_dbr2_vol_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_if(), self%elem%basis_s%nnodes_ie(),self%elem%nnodes_r,3)  :: test_dbr2_vol_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_if(), self%elem%basis_s%nnodes_ie(),self%elem%nnodes_r,3)  :: test_dbr2_vol_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_if(),self%elem%basis_s%nnodes_ie(),self%elem%nnodes_r,3) :: test_dbr2_vol_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_if(),self%elem%basis_s%nnodes_ie(),self%elem%nnodes_r,3) :: test_dbr2_vol_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dbr2_vol_face1_dx
        ! 
        test_dbr2_vol_face1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.246477705771478650e+00_rk, 6.957985479862924187e-17_rk, -4.367269456473151681e-17_rk,-1.537198849932121424e-17_rk, &
                                        -5.716666282106516173e-01_rk, -1.619974201783053337e-16_rk, 4.571509517940709084e-18_rk,-2.450685866947987428e-16_rk, &
                                        6.576168311825966461e-17_rk, 3.339926946448664169e-01_rk, 2.702995499965005454e-17_rk,6.287099064854251158e-17_rk, &
                                        -7.446931614954752963e-17_rk, -1.531776113688668728e-01_rk, -5.459481093535522863e-17_rk,-2.171552530276202654e-17_rk, &
                                        -7.509575403046596377e-17_rk, -2.955008494720444009e-17_rk, 3.339926946448664724e-01_rk,7.947279381063278839e-18_rk, &
                                        -3.935772261574939145e-17_rk, -5.015730008632377046e-17_rk, -1.531776113688670116e-01_rk,-5.755683467154373064e-17_rk, &
                                        1.269074674217879297e-16_rk, 2.115685838610068308e-17_rk, 5.875434471458620465e-17_rk,8.949307280798662889e-02_rk, &
                                        -1.329337431164738820e-16_rk, 5.633794516470231880e-17_rk, 1.262295065071218569e-17_rk,-4.104381726481634574e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        2.274283883309887067e+00_rk, 6.757782078989949353e-17_rk, -8.829127777271616570e-19_rk,-8.576110275605963837e-17_rk, &
                                        -1.105805488835698153e-01_rk, -1.694398505699542972e-16_rk, -2.456452379698604783e-17_rk,-1.163527117618515476e-16_rk, &
                                        5.364306800533425994e-17_rk, 2.274283883309887067e+00_rk, -4.604489600550249538e-17_rk,2.697649972829522503e-17_rk, &
                                        -6.271872338098680064e-17_rk, -1.105805488835698291e-01_rk, -4.626628885334571571e-17_rk,-1.456043014326053537e-17_rk, &
                                        -4.343731433307771252e-17_rk, -6.727909905071090044e-17_rk, 6.093925298920019884e-01_rk,-3.055981834155326965e-17_rk, &
                                        -1.046511963713501808e-16_rk, -4.763400219303687038e-17_rk, -2.962996877194291889e-02_rk,-2.362143358872962126e-17_rk, &
                                        -8.701143358281936686e-19_rk, -1.186169184476457981e-17_rk, 1.550808743843713228e-17_rk,6.093925298920019884e-01_rk, &
                                        -1.696541753405876324e-16_rk, 1.796051539572258489e-17_rk, 3.123770011372523087e-17_rk,-2.962996877194283563e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        3.572436769992004102e+00_rk, 1.306600560507125365e-16_rk, -2.959195250636966686e-18_rk,-7.536130327722079963e-17_rk, &
                                        -1.736995200012749763e-01_rk, -1.449651206165775617e-16_rk, -2.097176758669351922e-16_rk,-2.214019838496749875e-16_rk, &
                                        -3.599598129955923924e-18_rk, 9.572315475306059085e-01_rk, -5.520041695252635417e-17_rk,-4.513682224442267211e-17_rk, &
                                        -9.795505626292194435e-17_rk, -4.654264611001529550e-02_rk, -1.268943969546031150e-16_rk,-1.582801190627586069e-19_rk, &
                                        4.616899457794768985e-17_rk, -8.422830497174854855e-17_rk, 3.572436769992004102e+00_rk,6.674744136308174856e-17_rk, &
                                        -2.004496084080997010e-16_rk, -9.844013242584462597e-17_rk, -1.736995200012750318e-01_rk,-4.552517882498928041e-17_rk, &
                                        -8.192683146824064793e-17_rk, -3.176205487448241264e-18_rk, -9.275482771096821511e-18_rk,9.572315475306059085e-01_rk, &
                                        -2.084003521636499540e-16_rk, 1.254422286302332551e-16_rk, -3.045752620442308183e-17_rk,-4.654264611001530938e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -4.195675622877743649e+00_rk, -1.760130188530211649e-16_rk, 5.778217137569500390e-17_rk,7.285358943256574171e-17_rk, &
                                        9.340887480004107513e-01_rk, 3.224682379526776874e-16_rk, 4.833207265568825460e-17_rk,4.655706507309136201e-16_rk, &
                                        -1.113679044198868569e-16_rk, -1.124227894853039089e+00_rk, -2.982701448188502025e-19_rk,-8.258899949460379664e-17_rk, &
                                        1.641167035015539962e-16_rk, 2.502883256857085792e-01_rk, 9.845866364988661949e-17_rk,3.996143120670998478e-18_rk, &
                                        1.177910911889654253e-16_rk, 8.678939480036289593e-17_rk, -1.124227894853039089e+00_rk,1.570154278041195562e-18_rk, &
                                        1.796326636847392242e-16_rk, 9.705217925326510157e-17_rk, 2.502883256857085792e-01_rk,9.409124336743277236e-17_rk, &
                                        -1.888399964918761709e-16_rk, -2.307490924430571782e-17_rk, -7.075279560643796035e-17_rk,-3.012359565344129853e-01_rk, &
                                        3.379465652840843192e-16_rk, -1.289862037150697516e-16_rk, -5.816860966416709228e-17_rk,6.706455474242342674e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        6.093925298920019884e-01_rk, 2.642045149707517216e-17_rk, -1.307113741035254548e-17_rk,-5.084638610735552592e-18_rk, &
                                        -4.126922267623367446e-01_rk, -1.060946765754666895e-16_rk, 1.001247623824747870e-17_rk,-1.476937264322410039e-16_rk, &
                                        6.660045497736043593e-17_rk, 6.093925298920019884e-01_rk, 4.233668948017313242e-18_rk,2.044833914289994689e-17_rk, &
                                        -7.481385795906186105e-17_rk, -4.126922267623367446e-01_rk, -1.064362706007840813e-16_rk,-5.641311280558034162e-17_rk, &
                                        -5.488834472087494747e-17_rk, 2.573809553606893780e-17_rk, 1.632862362581208870e-01_rk,3.975835607481274498e-17_rk, &
                                        -1.977339265540804934e-17_rk, -4.049888190929931746e-17_rk, -1.105805488835698708e-01_rk,-5.205251913535023129e-17_rk, &
                                        8.782449656430125952e-17_rk, 6.248358797037753091e-18_rk, 8.446506268210565222e-17_rk,1.632862362581209981e-01_rk, &
                                        -1.223093676784688590e-16_rk, 4.379534865020971525e-17_rk, -4.096514589775068137e-17_rk,-1.105805488835698708e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        9.572315475306059085e-01_rk, 1.190864405588106290e-16_rk, -7.549169545435381644e-17_rk,8.656624406452900482e-18_rk, &
                                        -6.482554338950851092e-01_rk, -2.366555688426334640e-16_rk, 2.330320417533203888e-17_rk,-3.046644801385613832e-16_rk, &
                                        1.145860611198994063e-16_rk, 2.564894201304197541e-01_rk, 6.957127227617448090e-17_rk,5.356881564025961887e-17_rk, &
                                        -9.594424418989001638e-17_rk, -1.736995200012750040e-01_rk, -8.657154456636285223e-17_rk,-5.130548517351521449e-17_rk, &
                                        -9.706298132106216718e-17_rk, -4.511382202312525359e-17_rk, 9.572315475306059085e-01_rk,6.308603717900303541e-17_rk, &
                                        -9.414609364596676148e-17_rk, -2.200225244464182034e-16_rk, -6.482554338950851092e-01_rk,-1.086139287592392858e-16_rk, &
                                        9.025581084106693245e-17_rk, 6.849464680940150100e-17_rk, 6.912649803291370576e-17_rk,2.564894201304198096e-01_rk, &
                                        -1.125424831482043900e-16_rk, 9.085540479770340036e-17_rk, 2.231185478819338407e-17_rk,-1.736995200012751428e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        3.339926946448663059e-01_rk, -8.555388672989731776e-18_rk, 2.134784247755827370e-17_rk,-1.395443407927240957e-17_rk, &
                                        -1.531776113688669838e-01_rk, -5.842217869686535953e-17_rk, 6.429577025190173471e-18_rk,-3.289199069613099818e-17_rk, &
                                        5.986486833865334871e-17_rk, 1.246477705771478650e+00_rk, -3.099542147445281532e-17_rk,-2.176086468145723889e-17_rk, &
                                        -6.724447973295489616e-17_rk, -5.716666282106515062e-01_rk, -1.366363947365650735e-16_rk,-7.723309667140552349e-17_rk, &
                                        -2.825194530800340443e-17_rk, 5.683060492079610259e-17_rk, 8.949307280798657338e-02_rk,5.192390636872206283e-17_rk, &
                                        -1.938158857110064853e-17_rk, -2.986297380173101508e-17_rk, -4.104381726481631104e-02_rk,-3.620498103959637353e-17_rk, &
                                        2.144853316868860965e-17_rk, -1.345347510166143698e-17_rk, 8.787671962522561580e-17_rk,3.339926946448664169e-01_rk, &
                                        -1.149668559333769412e-16_rk, 2.208779654977509534e-17_rk, -7.437175685432242011e-17_rk,-1.531776113688669838e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -2.274283883309887067e+00_rk, -6.757782078989949353e-17_rk, 8.829127777271616570e-19_rk,8.576110275605963837e-17_rk, &
                                        1.105805488835698153e-01_rk, 1.694398505699542972e-16_rk, 2.456452379698604783e-17_rk,1.163527117618515476e-16_rk, &
                                        -5.364306800533425994e-17_rk, -2.274283883309887067e+00_rk, 4.604489600550249538e-17_rk,-2.697649972829522503e-17_rk, &
                                        6.271872338098680064e-17_rk, 1.105805488835698291e-01_rk, 4.626628885334571571e-17_rk,1.456043014326053537e-17_rk, &
                                        4.343731433307771252e-17_rk, 6.727909905071090044e-17_rk, -6.093925298920019884e-01_rk,3.055981834155326965e-17_rk, &
                                        1.046511963713501808e-16_rk, 4.763400219303687038e-17_rk, 2.962996877194291889e-02_rk,2.362143358872962126e-17_rk, &
                                        8.701143358281936686e-19_rk, 1.186169184476457981e-17_rk, -1.550808743843713228e-17_rk,-6.093925298920019884e-01_rk, &
                                        1.696541753405876324e-16_rk, -1.796051539572258489e-17_rk, -3.123770011372523087e-17_rk,2.962996877194283563e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        9.572315475306061305e-01_rk, 3.398918203393799222e-17_rk, -2.857429206902946595e-17_rk,-6.463395984631549056e-17_rk, &
                                        -4.654264611001525387e-02_rk, -2.023846852834157008e-16_rk, 1.105412976203447303e-17_rk,-2.172341404518480149e-16_rk, &
                                        5.315141834088945170e-17_rk, 3.572436769992004102e+00_rk, -6.246587650150442215e-17_rk,4.194191467032886224e-17_rk, &
                                        -3.759140328065849407e-17_rk, -1.736995200012750040e-01_rk, -8.925124488395310628e-17_rk,-2.070351669694728630e-16_rk, &
                                        -6.047414202519832082e-17_rk, -1.099493669587872167e-16_rk, 9.572315475306059085e-01_rk,-1.432528601166284881e-17_rk, &
                                        -1.361222809050526370e-17_rk, -3.604710277074247928e-17_rk, -4.654264611001539265e-02_rk,-9.266751373953127496e-17_rk, &
                                        -7.877039750976789608e-17_rk, -2.249603270729907950e-17_rk, 1.050244160469207365e-16_rk,3.572436769992004102e+00_rk, &
                                        -2.211828052486193402e-16_rk, -3.052412408375795664e-17_rk, -5.687265931458247653e-17_rk,-1.736995200012750318e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.124227894853039089e+00_rk, -2.151355043244921472e-18_rk, -2.470077455276114171e-17_rk,8.450977870065214739e-17_rk, &
                                        2.502883256857085792e-01_rk, 2.205501846301036349e-16_rk, -3.097431307464253493e-17_rk,8.817281318310757790e-17_rk, &
                                        -1.403234555306641913e-16_rk, -4.195675622877743649e+00_rk, 6.795792526290535293e-17_rk,-1.246082618665206177e-17_rk, &
                                        1.227758680232660075e-16_rk, 9.340887480004107513e-01_rk, 2.370215586687999529e-16_rk,1.569631484300717807e-16_rk, &
                                        8.833234255190546478e-17_rk, -3.517719905498524754e-17_rk, -3.012359565344129297e-01_rk,-4.595477643622208858e-17_rk, &
                                        4.518267931488222910e-17_rk, 8.139676830855231957e-17_rk, 6.706455474242351000e-02_rk,7.165803146117259095e-17_rk, &
                                        -2.192562800656700980e-17_rk, 2.804062053453179919e-17_rk, -1.596001935509313545e-16_rk,-1.124227894853039089e+00_rk, &
                                        2.446189951731988516e-16_rk, -7.232551543564465360e-18_rk, 1.043228488726158719e-16_rk,2.502883256857085792e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -6.093925298920019884e-01_rk, -2.642045149707517216e-17_rk, 1.307113741035254548e-17_rk,5.084638610735552592e-18_rk, &
                                        4.126922267623367446e-01_rk, 1.060946765754666895e-16_rk, -1.001247623824747870e-17_rk,1.476937264322410039e-16_rk, &
                                        -6.660045497736043593e-17_rk, -6.093925298920019884e-01_rk, -4.233668948017313242e-18_rk,-2.044833914289994689e-17_rk, &
                                        7.481385795906186105e-17_rk, 4.126922267623367446e-01_rk, 1.064362706007840813e-16_rk,5.641311280558034162e-17_rk, &
                                        5.488834472087494747e-17_rk, -2.573809553606893780e-17_rk, -1.632862362581208870e-01_rk,-3.975835607481274498e-17_rk, &
                                        1.977339265540804934e-17_rk, 4.049888190929931746e-17_rk, 1.105805488835698708e-01_rk,5.205251913535023129e-17_rk, &
                                        -8.782449656430125952e-17_rk, -6.248358797037753091e-18_rk, -8.446506268210565222e-17_rk,-1.632862362581209981e-01_rk, &
                                        1.223093676784688590e-16_rk, -4.379534865020971525e-17_rk, 4.096514589775068137e-17_rk,1.105805488835698708e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        2.564894201304199206e-01_rk, 4.025566497114479085e-17_rk, 1.657681009409072272e-18_rk,1.168625011141008444e-16_rk, &
                                        -1.736995200012750873e-01_rk, -6.034246115548542710e-17_rk, 6.744425076980712017e-18_rk,-1.097272724711838683e-16_rk, &
                                        7.940539677244137260e-17_rk, 9.572315475306059085e-01_rk, -4.384270859047357730e-17_rk,-9.015291875019341898e-17_rk, &
                                        -9.210229317007600665e-17_rk, -6.482554338950849981e-01_rk, -1.620889121403563023e-16_rk,-9.761031234197857879e-17_rk, &
                                        6.338956725960985878e-17_rk, 9.791433578930222945e-17_rk, 2.564894201304197541e-01_rk,9.724298855299903098e-17_rk, &
                                        -6.651910472469600716e-17_rk, -6.129592733475405087e-17_rk, -1.736995200012751428e-01_rk,-1.031922620729197836e-16_rk, &
                                        -1.422991892720367534e-17_rk, 1.278073024761433476e-18_rk, 1.471876867576398111e-16_rk,9.572315475306059085e-01_rk, &
                                        -3.059943223003640841e-16_rk, 3.688643552126050863e-17_rk, -1.544916131788844036e-16_rk,-6.482554338950851092e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        3.339926946448663059e-01_rk, 7.876862827250721136e-17_rk, -3.808131519390137391e-17_rk,1.310046043285191376e-17_rk, &
                                        -1.531776113688669283e-01_rk, -1.151647494393887396e-16_rk, -1.174000900095778746e-17_rk,-1.170934663543711913e-16_rk, &
                                        5.708490606779261754e-17_rk, 8.949307280798673991e-02_rk, 3.940058176661071182e-17_rk,-1.212562338125104819e-17_rk, &
                                        -4.392526317232203592e-17_rk, -4.104381726481617920e-02_rk, -5.815829812912833408e-17_rk,-3.356088644087930280e-17_rk, &
                                        -2.233068822637824360e-17_rk, -3.199223184258408642e-17_rk, 1.246477705771478872e+00_rk,7.026036702141410238e-17_rk, &
                                        -9.286877952730704267e-17_rk, -2.019346696907180417e-16_rk, -5.716666282106516173e-01_rk,-6.641588534994306474e-17_rk, &
                                        -4.231302981882979823e-17_rk, 5.211796041057041790e-17_rk, 1.426257889453670423e-17_rk,3.339926946448663059e-01_rk, &
                                        -2.032744676061550714e-17_rk, 6.080514132978341557e-17_rk, 6.719427397430945690e-18_rk,-1.531776113688669838e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        6.093925298920019884e-01_rk, 3.724113968004643574e-17_rk, -1.919192874167489949e-17_rk,-3.362649786185639925e-18_rk, &
                                        -2.962996877194275236e-02_rk, -5.168990379402295633e-17_rk, -1.019086177020523767e-16_rk,-1.628917178431820858e-16_rk, &
                                        -2.209739950225042318e-17_rk, 6.093925298920019884e-01_rk, -2.886379294853961489e-17_rk,-2.901044106085029366e-17_rk, &
                                        -2.357283283887894333e-17_rk, -2.962996877194283563e-02_rk, -9.133630045216069559e-17_rk,-1.173430149782975482e-16_rk, &
                                        3.433037462152433488e-17_rk, -5.633824625257366080e-17_rk, 2.274283883309887067e+00_rk,6.393279894839155299e-17_rk, &
                                        -3.162480125297814213e-17_rk, -3.798323086415975616e-17_rk, -1.105805488835698985e-01_rk,-6.435476689455857854e-17_rk, &
                                        -1.014329189962526893e-16_rk, -4.481762590941785005e-18_rk, 4.544757666805662989e-17_rk,2.274283883309887067e+00_rk, &
                                        -1.038269565441581050e-16_rk, 4.246622671421680272e-17_rk, -8.683382293965321048e-17_rk,-1.105805488835698430e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -3.572436769992004102e+00_rk, -1.306600560507125365e-16_rk, 2.959195250636966686e-18_rk,7.536130327722079963e-17_rk, &
                                        1.736995200012749763e-01_rk, 1.449651206165775617e-16_rk, 2.097176758669351922e-16_rk,2.214019838496749875e-16_rk, &
                                        3.599598129955923924e-18_rk, -9.572315475306059085e-01_rk, 5.520041695252635417e-17_rk,4.513682224442267211e-17_rk, &
                                        9.795505626292194435e-17_rk, 4.654264611001529550e-02_rk, 1.268943969546031150e-16_rk,1.582801190627586069e-19_rk, &
                                        -4.616899457794768985e-17_rk, 8.422830497174854855e-17_rk, -3.572436769992004102e+00_rk,-6.674744136308174856e-17_rk, &
                                        2.004496084080997010e-16_rk, 9.844013242584462597e-17_rk, 1.736995200012750318e-01_rk,4.552517882498928041e-17_rk, &
                                        8.192683146824064793e-17_rk, 3.176205487448241264e-18_rk, 9.275482771096821511e-18_rk,-9.572315475306059085e-01_rk, &
                                        2.084003521636499540e-16_rk, -1.254422286302332551e-16_rk, 3.045752620442308183e-17_rk,4.654264611001530938e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.124227894853039311e+00_rk, -1.479077192920701964e-16_rk, 6.154572420861224000e-17_rk,-5.013146528563229297e-18_rk, &
                                        2.502883256857084127e-01_rk, 1.977335363153803379e-16_rk, 1.416666487774234472e-16_rk,2.415768397819077670e-16_rk, &
                                        -6.104185316308274191e-17_rk, -3.012359565344130963e-01_rk, -4.728785356195966202e-17_rk,4.878432246512111202e-17_rk, &
                                        8.897988661219276578e-17_rk, 6.706455474242337123e-02_rk, 1.713838324033211137e-16_rk,7.510582804372763082e-17_rk, &
                                        -1.818388331742885969e-17_rk, 7.332389058940516946e-17_rk, -4.195675622877743649e+00_rk,-1.705074560213646393e-16_rk, &
                                        1.810762894408554677e-16_rk, 3.474564625075186092e-16_rk, 9.340887480004107513e-01_rk,1.220342242275392039e-16_rk, &
                                        1.382137983175707960e-16_rk, -7.888094147598307545e-17_rk, -2.560668145994037679e-17_rk,-1.124227894853039089e+00_rk, &
                                        5.962686496631474402e-17_rk, -1.458829729601097772e-16_rk, 5.664309205632525516e-17_rk,2.502883256857085792e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        1.632862362581208870e-01_rk, 7.501988345397617896e-17_rk, -3.393305605857288834e-17_rk,8.499259572740835990e-17_rk, &
                                        -1.105805488835698430e-01_rk, -8.298014167555586546e-17_rk, 9.116438656545341293e-18_rk,-1.161162567851780885e-16_rk, &
                                        5.689834278731679911e-17_rk, 1.632862362581208870e-01_rk, 1.214564340891842867e-17_rk,-4.373850253701811908e-17_rk, &
                                        -4.490028584955160871e-17_rk, -1.105805488835698291e-01_rk, -5.186589274466628109e-17_rk,-3.838962831067017203e-17_rk, &
                                        3.345118352623387521e-17_rk, 7.875755518645989627e-18_rk, 6.093925298920019884e-01_rk,6.231027179061050386e-17_rk, &
                                        -8.250924935871556476e-17_rk, -1.385940068264309614e-16_rk, -4.126922267623368001e-01_rk,-8.278748985826333336e-17_rk, &
                                        -3.942491056005527421e-17_rk, 3.817033422125409815e-17_rk, 5.324482439913546192e-17_rk,6.093925298920020994e-01_rk, &
                                        -1.441394381336535220e-16_rk, 3.752763265546501949e-17_rk, -4.318310180053294404e-17_rk,-4.126922267623366891e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -9.572315475306059085e-01_rk, -1.190864405588106290e-16_rk, 7.549169545435381644e-17_rk,-8.656624406452900482e-18_rk, &
                                        6.482554338950851092e-01_rk, 2.366555688426334640e-16_rk, -2.330320417533203888e-17_rk,3.046644801385613832e-16_rk, &
                                        -1.145860611198994063e-16_rk, -2.564894201304197541e-01_rk, -6.957127227617448090e-17_rk,-5.356881564025961887e-17_rk, &
                                        9.594424418989001638e-17_rk, 1.736995200012750040e-01_rk, 8.657154456636285223e-17_rk,5.130548517351521449e-17_rk, &
                                        9.706298132106216718e-17_rk, 4.511382202312525359e-17_rk, -9.572315475306059085e-01_rk,-6.308603717900303541e-17_rk, &
                                        9.414609364596676148e-17_rk, 2.200225244464182034e-16_rk, 6.482554338950851092e-01_rk,1.086139287592392858e-16_rk, &
                                        -9.025581084106693245e-17_rk, -6.849464680940150100e-17_rk, -6.912649803291370576e-17_rk,-2.564894201304198096e-01_rk, &
                                        1.125424831482043900e-16_rk, -9.085540479770340036e-17_rk, -2.231185478819338407e-17_rk,1.736995200012751428e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        8.949307280798685094e-02_rk, 5.713674818559767803e-17_rk, -2.395869247804534163e-17_rk,1.298626722257940359e-16_rk, &
                                        -4.104381726481624859e-02_rk, -3.769811566802902974e-17_rk, 2.534285328794342634e-18_rk,-1.186964781885052051e-16_rk, &
                                        3.382577716103573981e-17_rk, 3.339926946448661949e-01_rk, -2.582993800782710092e-17_rk,-6.887429171562353646e-17_rk, &
                                        -3.772589803184365993e-17_rk, -1.531776113688669838e-01_rk, -5.165185601211909605e-17_rk,-5.973726538449028486e-17_rk, &
                                        8.721391896832193999e-17_rk, 3.170031562786979684e-17_rk, 3.339926946448663614e-01_rk,5.059542191732877583e-17_rk, &
                                        -5.434855930018815286e-17_rk, -4.169373298504144342e-17_rk, -1.531776113688670116e-01_rk,-8.918168792193743429e-17_rk, &
                                        -4.889158393794915763e-17_rk, 1.136893332720467123e-17_rk, 8.679069935175888668e-17_rk,1.246477705771478872e+00_rk, &
                                        -2.485936150437258721e-16_rk, 1.294003799869654798e-17_rk, -1.007534664636427393e-16_rk,-5.716666282106515062e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -6.093925298920019884e-01_rk, -3.724113968004643574e-17_rk, 1.919192874167489949e-17_rk,3.362649786185639925e-18_rk, &
                                        2.962996877194275236e-02_rk, 5.168990379402295633e-17_rk, 1.019086177020523767e-16_rk,1.628917178431820858e-16_rk, &
                                        2.209739950225042318e-17_rk, -6.093925298920019884e-01_rk, 2.886379294853961489e-17_rk,2.901044106085029366e-17_rk, &
                                        2.357283283887894333e-17_rk, 2.962996877194283563e-02_rk, 9.133630045216069559e-17_rk,1.173430149782975482e-16_rk, &
                                        -3.433037462152433488e-17_rk, 5.633824625257366080e-17_rk, -2.274283883309887067e+00_rk,-6.393279894839155299e-17_rk, &
                                        3.162480125297814213e-17_rk, 3.798323086415975616e-17_rk, 1.105805488835698985e-01_rk,6.435476689455857854e-17_rk, &
                                        1.014329189962526893e-16_rk, 4.481762590941785005e-18_rk, -4.544757666805662989e-17_rk,-2.274283883309887067e+00_rk, &
                                        1.038269565441581050e-16_rk, -4.246622671421680272e-17_rk, 8.683382293965321048e-17_rk,1.105805488835698430e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -9.572315475306061305e-01_rk, -3.398918203393799222e-17_rk, 2.857429206902946595e-17_rk,6.463395984631549056e-17_rk, &
                                        4.654264611001525387e-02_rk, 2.023846852834157008e-16_rk, -1.105412976203447303e-17_rk,2.172341404518480149e-16_rk, &
                                        -5.315141834088945170e-17_rk, -3.572436769992004102e+00_rk, 6.246587650150442215e-17_rk,-4.194191467032886224e-17_rk, &
                                        3.759140328065849407e-17_rk, 1.736995200012750040e-01_rk, 8.925124488395310628e-17_rk,2.070351669694728630e-16_rk, &
                                        6.047414202519832082e-17_rk, 1.099493669587872167e-16_rk, -9.572315475306059085e-01_rk,1.432528601166284881e-17_rk, &
                                        1.361222809050526370e-17_rk, 3.604710277074247928e-17_rk, 4.654264611001539265e-02_rk,9.266751373953127496e-17_rk, &
                                        7.877039750976789608e-17_rk, 2.249603270729907950e-17_rk, -1.050244160469207365e-16_rk,-3.572436769992004102e+00_rk, &
                                        2.211828052486193402e-16_rk, 3.052412408375795664e-17_rk, 5.687265931458247653e-17_rk,1.736995200012750318e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -3.012359565344132073e-01_rk, -9.638417171814185090e-17_rk, 5.292281061262506935e-17_rk,-1.946924390416983482e-16_rk, &
                                        6.706455474242332959e-02_rk, 9.023710899124467529e-17_rk, 8.693827058635087981e-18_rk,3.145828341822422898e-16_rk, &
                                        -3.907868233251116803e-17_rk, -1.124227894853039089e+00_rk, 6.676333957021259385e-17_rk,1.059894084650569877e-16_rk, &
                                        5.940301730986780824e-17_rk, 2.502883256857084682e-01_rk, 1.084627237298515251e-16_rk,2.161675119093274790e-16_rk, &
                                        -1.207287546164762582e-16_rk, 2.946769950137274300e-18_rk, -1.124227894853039089e+00_rk,-8.822259024813950984e-17_rk, &
                                        7.181372743596347327e-17_rk, 5.172461519033043059e-17_rk, 2.502883256857085792e-01_rk,1.868950788320453438e-16_rk, &
                                        1.286474698281688552e-16_rk, -5.780389964765779527e-18_rk, -1.799456187421214689e-16_rk,-4.195675622877743649e+00_rk, &
                                        4.643383678643359670e-16_rk, -1.664367716817392601e-17_rk, 1.946040352798335756e-16_rk,9.340887480004106402e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.632862362581208870e-01_rk, -7.501988345397617896e-17_rk, 3.393305605857288834e-17_rk,-8.499259572740835990e-17_rk, &
                                        1.105805488835698430e-01_rk, 8.298014167555586546e-17_rk, -9.116438656545341293e-18_rk,1.161162567851780885e-16_rk, &
                                        -5.689834278731679911e-17_rk, -1.632862362581208870e-01_rk, -1.214564340891842867e-17_rk,4.373850253701811908e-17_rk, &
                                        4.490028584955160871e-17_rk, 1.105805488835698291e-01_rk, 5.186589274466628109e-17_rk,3.838962831067017203e-17_rk, &
                                        -3.345118352623387521e-17_rk, -7.875755518645989627e-18_rk, -6.093925298920019884e-01_rk,-6.231027179061050386e-17_rk, &
                                        8.250924935871556476e-17_rk, 1.385940068264309614e-16_rk, 4.126922267623368001e-01_rk,8.278748985826333336e-17_rk, &
                                        3.942491056005527421e-17_rk, -3.817033422125409815e-17_rk, -5.324482439913546192e-17_rk,-6.093925298920020994e-01_rk, &
                                        1.441394381336535220e-16_rk, -3.752763265546501949e-17_rk, 4.318310180053294404e-17_rk,4.126922267623366891e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.564894201304199206e-01_rk, -4.025566497114479085e-17_rk, -1.657681009409072272e-18_rk,-1.168625011141008444e-16_rk, &
                                        1.736995200012750873e-01_rk, 6.034246115548542710e-17_rk, -6.744425076980712017e-18_rk,1.097272724711838683e-16_rk, &
                                        -7.940539677244137260e-17_rk, -9.572315475306059085e-01_rk, 4.384270859047357730e-17_rk,9.015291875019341898e-17_rk, &
                                        9.210229317007600665e-17_rk, 6.482554338950849981e-01_rk, 1.620889121403563023e-16_rk,9.761031234197857879e-17_rk, &
                                        -6.338956725960985878e-17_rk, -9.791433578930222945e-17_rk, -2.564894201304197541e-01_rk,-9.724298855299903098e-17_rk, &
                                        6.651910472469600716e-17_rk, 6.129592733475405087e-17_rk, 1.736995200012751428e-01_rk,1.031922620729197836e-16_rk, &
                                        1.422991892720367534e-17_rk, -1.278073024761433476e-18_rk, -1.471876867576398111e-16_rk,-9.572315475306059085e-01_rk, &
                                        3.059943223003640841e-16_rk, -3.688643552126050863e-17_rk, 1.544916131788844036e-16_rk,6.482554338950851092e-01_rk  &
                                        /),(/4,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        !
        ! dbr2_vol_face2_dx
        ! 
        test_dbr2_vol_face2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -3.339926946448663614e-01_rk, -1.128512628333812933e-17_rk, 6.319715648186580912e-17_rk,2.345418391025390606e-17_rk, &
                                        2.133488901473740373e+00_rk, 1.359861519577245591e-16_rk, 8.725038984163922180e-17_rk,1.494472862190877096e-16_rk, &
                                        9.298386970530636819e-17_rk, -8.949307280798651787e-02_rk, -1.490856483957536459e-17_rk,-2.490661211313774073e-17_rk, &
                                        5.017355770807933014e-17_rk, 5.716666282106519503e-01_rk, 5.353145925970460154e-17_rk,-1.519218552193667958e-17_rk, &
                                        -1.691988252626253862e-16_rk, 6.404211793758395659e-17_rk, -8.949307280798658726e-02_rk,3.649646553518740008e-17_rk, &
                                        5.578296807008586324e-17_rk, 2.749937665462070651e-17_rk, 5.716666282106519503e-01_rk,3.759400177707535403e-17_rk, &
                                        2.210920056195800257e-16_rk, -4.635890523926700661e-18_rk, -2.232695459816239032e-17_rk,-2.397959658707983499e-02_rk, &
                                        -3.809627982822997232e-17_rk, 6.543167065093125589e-17_rk, 7.712673606850527163e-17_rk,1.531776113688671503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -6.093925298920016553e-01_rk, -5.196151501755316205e-17_rk, 2.424311916644778827e-18_rk,1.264275171567423256e-17_rk, &
                                        4.126922267623369667e-01_rk, 8.804604695931371756e-17_rk, 3.558056589970896505e-17_rk,5.580475324463504243e-17_rk, &
                                        2.679201858113996614e-17_rk, -6.093925298920018774e-01_rk, -1.629984125386228342e-17_rk,-1.695706976286641787e-17_rk, &
                                        -1.948460642838266127e-18_rk, 4.126922267623370777e-01_rk, 3.878169426774987495e-17_rk,1.129716421629169733e-17_rk, &
                                        -3.395284040282448328e-17_rk, 9.074564042797386997e-17_rk, -1.632862362581207205e-01_rk,2.119224670970315021e-17_rk, &
                                        6.796696275310014459e-17_rk, 3.378912645939550971e-17_rk, 1.105805488835700512e-01_rk,6.759305243930387157e-18_rk, &
                                        8.961500068569613161e-17_rk, 6.509895902721813101e-18_rk, -2.253433652094172429e-17_rk,-1.632862362581206095e-01_rk, &
                                        4.391687990744578019e-17_rk, 6.729089979901636349e-17_rk, 5.993504777665736317e-17_rk,1.105805488835700512e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -9.572315475306057975e-01_rk, -8.875796420940959930e-17_rk, 5.993216984821996781e-17_rk,-2.039933099408430822e-17_rk, &
                                        6.482554338950854422e-01_rk, 8.602786991637443668e-17_rk, 6.670246068953857667e-17_rk,7.284139127906545659e-17_rk, &
                                        4.091919223884831691e-17_rk, -2.564894201304196431e-01_rk, 2.840357544162722429e-17_rk,-1.136492692459505502e-17_rk, &
                                        -2.243334156120756629e-17_rk, 1.736995200012753648e-01_rk, 9.424830494029251102e-17_rk,3.743354250657571845e-17_rk, &
                                        -6.715555408822236532e-17_rk, 1.074383108208419895e-17_rk, -9.572315475306057975e-01_rk,4.074719609965771370e-17_rk, &
                                        7.963784616140203739e-17_rk, 4.834750804161696275e-17_rk, 6.482554338950854422e-01_rk,2.739804957002662927e-17_rk, &
                                        1.691137799925421194e-16_rk, -3.354770223950076045e-18_rk, -2.040241208373023466e-17_rk,-2.564894201304196986e-01_rk, &
                                        8.752501377419607707e-17_rk, 5.342576099489181151e-17_rk, 1.119639323051716015e-16_rk,1.736995200012752538e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        1.124227894853038645e+00_rk, 4.446909750229015624e-17_rk, -1.157052529986460065e-16_rk,-1.819254088121295135e-17_rk, &
                                        -3.486066666315936313e+00_rk, -2.516484553945531096e-16_rk, -1.512128984935545494e-16_rk,-2.584439509031188715e-16_rk, &
                                        -1.550469368123335891e-16_rk, 3.012359565344128742e-01_rk, 1.629020265402963629e-17_rk,3.615883383107927699e-17_rk, &
                                        -7.378714959507740876e-17_rk, -9.340887480004114174e-01_rk, -1.009596322047243562e-16_rk,1.812270786488182936e-17_rk, &
                                        2.864798047785872626e-16_rk, -1.248870743614027282e-16_rk, 3.012359565344129297e-01_rk,-7.031687101903730224e-17_rk, &
                                        -1.204329968511636747e-16_rk, -4.956180937282057979e-17_rk, -9.340887480004114174e-01_rk,-6.691667926124379677e-17_rk, &
                                        -4.252165446931521549e-16_rk, 1.246304527884547141e-17_rk, 4.506425232729014370e-17_rk,8.071593128461283795e-02_rk, &
                                        5.162547941593383898e-18_rk, -1.268270235392744464e-16_rk, -1.571705560242745482e-16_rk,-2.502883256857088567e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.632862362581206095e-01_rk, -1.920647509950390869e-17_rk, -2.945796319725353180e-18_rk,4.829910934089216012e-17_rk, &
                                        1.540188358165777593e+00_rk, 1.671326943216977525e-16_rk, 8.267121007284030923e-17_rk,1.206038653091327439e-16_rk, &
                                        9.193880892651517207e-17_rk, -1.632862362581204985e-01_rk, 7.772026123530284812e-18_rk,-1.843794262383682818e-17_rk, &
                                        5.080371387421155229e-17_rk, 1.540188358165778038e+00_rk, 8.169974726236486957e-17_rk,9.102541823542784260e-18_rk, &
                                        -1.256610150541097143e-16_rk, 1.011448317796460145e-16_rk, -4.375241514048106017e-02_rk,2.606849164866109018e-17_rk, &
                                        6.463930590371602388e-17_rk, 4.924602818697989466e-18_rk, 4.126922267623369667e-01_rk,4.213705090367808184e-17_rk, &
                                        1.728126369240541422e-16_rk, 7.595704186085797859e-18_rk, -2.936342774329558712e-18_rk,-4.375241514048096303e-02_rk, &
                                        -1.791453049065205627e-17_rk, 1.244759852447839445e-16_rk, 8.684666197504171857e-17_rk,4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -2.564894201304194765e-01_rk, -4.391816731786046404e-17_rk, 2.048306332158789474e-16_rk,7.569057966443491255e-17_rk, &
                                        2.419322215579066349e+00_rk, 1.657005490645654699e-16_rk, 1.040158040526799298e-16_rk,1.673065282610185872e-16_rk, &
                                        8.519773609466364622e-17_rk, -6.872613299107291351e-02_rk, -8.109188963831859726e-17_rk,-7.164486221793438072e-17_rk, &
                                        6.093760208718542548e-17_rk, 6.482554338950854422e-01_rk, 1.112395141340055304e-16_rk,2.147670999467464696e-17_rk, &
                                        -1.576024889433733580e-16_rk, 8.680920600023891589e-17_rk, -2.564894201304197541e-01_rk,8.758193683240887619e-17_rk, &
                                        1.307107955495970880e-16_rk, 1.235573931596133490e-16_rk, 2.419322215579066349e+00_rk,1.117189682330775998e-16_rk, &
                                        2.512234533437941587e-16_rk, -3.543928749072699686e-18_rk, -8.004986100219535997e-17_rk,-6.872613299107299678e-02_rk, &
                                        -1.867326873751474784e-17_rk, 9.869554713339069385e-17_rk, 1.783709554627789667e-16_rk,6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -8.949307280798646236e-02_rk, -3.376213228329554320e-17_rk, -6.759448294585091979e-17_rk,6.130514420305846294e-17_rk, &
                                        5.716666282106519503e-01_rk, 1.680172885726601358e-16_rk, 6.119688000748297003e-17_rk,6.805527713296364488e-17_rk, &
                                        6.901686996182446376e-17_rk, -3.339926946448661393e-01_rk, 2.411689712223085553e-17_rk,-1.038136799870239730e-17_rk, &
                                        3.529650000997885946e-17_rk, 2.133488901473740373e+00_rk, 9.404604584817591574e-17_rk,3.332037304202517458e-17_rk, &
                                        -5.157779367079092744e-17_rk, 1.289868713382932054e-16_rk, -2.397959658707982111e-02_rk,1.272303289184870918e-17_rk, &
                                        6.998757737558748610e-17_rk, -1.100327329188703668e-17_rk, 1.531776113688671503e-01_rk,3.531962365663559397e-17_rk, &
                                        9.289893300059291101e-17_rk, 1.905817517258545801e-17_rk, 1.191408873004721106e-17_rk,-8.949307280798651787e-02_rk, &
                                        1.840457564455434540e-17_rk, 1.613968279656525365e-16_rk, 8.426936797263395871e-17_rk,5.716666282106519503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        6.093925298920016553e-01_rk, 5.196151501755316205e-17_rk, -2.424311916644778827e-18_rk,-1.264275171567423256e-17_rk, &
                                        -4.126922267623369667e-01_rk, -8.804604695931371756e-17_rk, -3.558056589970896505e-17_rk,-5.580475324463504243e-17_rk, &
                                        -2.679201858113996614e-17_rk, 6.093925298920018774e-01_rk, 1.629984125386228342e-17_rk,1.695706976286641787e-17_rk, &
                                        1.948460642838266127e-18_rk, -4.126922267623370777e-01_rk, -3.878169426774987495e-17_rk,-1.129716421629169733e-17_rk, &
                                        3.395284040282448328e-17_rk, -9.074564042797386997e-17_rk, 1.632862362581207205e-01_rk,-2.119224670970315021e-17_rk, &
                                        -6.796696275310014459e-17_rk, -3.378912645939550971e-17_rk, -1.105805488835700512e-01_rk,-6.759305243930387157e-18_rk, &
                                        -8.961500068569613161e-17_rk, -6.509895902721813101e-18_rk, 2.253433652094172429e-17_rk,1.632862362581206095e-01_rk, &
                                        -4.391687990744578019e-17_rk, -6.729089979901636349e-17_rk, -5.993504777665736317e-17_rk,-1.105805488835700512e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -2.564894201304196986e-01_rk, -8.663072377272758303e-17_rk, -3.965396920373038534e-17_rk,1.172443525373440474e-16_rk, &
                                        1.736995200012752538e-01_rk, 9.364592641242174895e-17_rk, 5.051337185812663200e-17_rk,1.133200631880104362e-16_rk, &
                                        1.757782191730489212e-17_rk, -9.572315475306057975e-01_rk, -2.054963154746788041e-17_rk,-1.157021782717567629e-16_rk, &
                                        -3.033755052858008370e-17_rk, 6.482554338950854422e-01_rk, 5.801279222300593429e-17_rk,4.813603351420157174e-17_rk, &
                                        1.903901383812214409e-17_rk, 1.277835621815682613e-16_rk, -2.564894201304196431e-01_rk,1.437123069496546971e-17_rk, &
                                        4.892094909344810131e-17_rk, 5.852761824962239336e-17_rk, 1.736995200012752538e-01_rk,-2.862516072055338889e-17_rk, &
                                        2.015725067521299288e-17_rk, 4.672080086203701893e-17_rk, -4.576123709673627950e-18_rk,-9.572315475306054644e-01_rk, &
                                        5.283693430027587451e-17_rk, 9.884059172402588865e-17_rk, 1.007300138163047421e-16_rk,6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        3.012359565344128187e-01_rk, 8.984494924227542748e-17_rk, 1.187230620154784028e-16_rk,-1.199143746711426597e-16_rk, &
                                        -9.340887480004114174e-01_rk, -3.011870943509973290e-16_rk, -1.087601917656599403e-16_rk,-1.274093408121273509e-16_rk, &
                                        -1.124553807475749830e-16_rk, 1.124227894853038423e+00_rk, -7.498908113045920295e-18_rk,3.708351166873409174e-17_rk, &
                                        -4.568953158442733864e-17_rk, -3.486066666315936313e+00_rk, -1.620809261516742752e-16_rk,-5.923058493999375078e-17_rk, &
                                        7.462936254544464549e-17_rk, -2.730482691672033244e-16_rk, 8.071593128461287958e-02_rk,-2.852987240941398963e-17_rk, &
                                        -1.507497155877770668e-16_rk, -1.949762605510755466e-17_rk, -2.502883256857088567e-01_rk,-4.634635008593012682e-17_rk, &
                                        -1.439992938237923682e-16_rk, -4.183121240991160754e-17_rk, 1.514300847504006495e-19_rk,3.012359565344127632e-01_rk, &
                                        -3.616109080169257179e-17_rk, -2.878139443967180966e-16_rk, -1.540916665149386648e-16_rk,-9.340887480004114174e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.632862362581206095e-01_rk, 1.920647509950390869e-17_rk, 2.945796319725353180e-18_rk,-4.829910934089216012e-17_rk, &
                                        -1.540188358165777593e+00_rk, -1.671326943216977525e-16_rk, -8.267121007284030923e-17_rk,-1.206038653091327439e-16_rk, &
                                        -9.193880892651517207e-17_rk, 1.632862362581204985e-01_rk, -7.772026123530284812e-18_rk,1.843794262383682818e-17_rk, &
                                        -5.080371387421155229e-17_rk, -1.540188358165778038e+00_rk, -8.169974726236486957e-17_rk,-9.102541823542784260e-18_rk, &
                                        1.256610150541097143e-16_rk, -1.011448317796460145e-16_rk, 4.375241514048106017e-02_rk,-2.606849164866109018e-17_rk, &
                                        -6.463930590371602388e-17_rk, -4.924602818697989466e-18_rk, -4.126922267623369667e-01_rk,-4.213705090367808184e-17_rk, &
                                        -1.728126369240541422e-16_rk, -7.595704186085797859e-18_rk, 2.936342774329558712e-18_rk,4.375241514048096303e-02_rk, &
                                        1.791453049065205627e-17_rk, -1.244759852447839445e-16_rk, -8.684666197504171857e-17_rk,-4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -6.872613299107294127e-02_rk, -8.652314862832868128e-17_rk, -4.897107411554283605e-17_rk,2.181708178008920882e-16_rk, &
                                        6.482554338950854422e-01_rk, 1.951149500579163438e-16_rk, 7.098697041697975716e-17_rk,9.191763066328042979e-17_rk, &
                                        6.898744490681494707e-17_rk, -2.564894201304194210e-01_rk, 1.344278764876627664e-17_rk,-1.626928319525496318e-16_rk, &
                                        2.874450054517190144e-17_rk, 2.419322215579066349e+00_rk, 1.364627644597419756e-16_rk,5.350414218801284002e-17_rk, &
                                        -4.910119771492832062e-17_rk, 1.386945537055314029e-16_rk, -6.872613299107302454e-02_rk,8.571319684708097524e-17_rk, &
                                        4.375961110900645638e-17_rk, 5.143491929484079280e-18_rk, 6.482554338950854422e-01_rk,8.526456632277497763e-17_rk, &
                                        1.609862051105642515e-16_rk, 6.433769256438492648e-17_rk, 4.147950119104914104e-17_rk,-2.564894201304194765e-01_rk, &
                                        1.048954535979623138e-16_rk, 2.291498776943172062e-16_rk, 1.987701086735328318e-16_rk,2.419322215579066349e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -8.949307280798649011e-02_rk, -4.966643301426691336e-17_rk, 1.666100131118837647e-16_rk,5.492038942158610500e-17_rk, &
                                        5.716666282106519503e-01_rk, 5.569565009894200844e-17_rk, 3.502854693656046376e-17_rk,4.193534287417318003e-17_rk, &
                                        5.062798741077309058e-18_rk, -2.397959658707976560e-02_rk, -6.805138162605585001e-17_rk,-5.399784364842160058e-17_rk, &
                                        1.200026891485765752e-17_rk, 1.531776113688671503e-01_rk, 8.076467979850021161e-17_rk,4.407995667105948920e-17_rk, &
                                        -1.085855576688783852e-17_rk, 3.109761638299395546e-17_rk, -3.339926946448664724e-01_rk,6.409134276120025400e-17_rk, &
                                        9.723448039277285741e-17_rk, 1.130005095236732070e-16_rk, 2.133488901473740373e+00_rk,8.693381779239692007e-17_rk, &
                                        7.547383336489704778e-17_rk, 3.032333750868584127e-19_rk, -6.701942064785265523e-17_rk,-8.949307280798651787e-02_rk, &
                                        3.145199253770576101e-17_rk, 4.907518949193444609e-17_rk, 1.321902824768215733e-16_rk,5.716666282106519503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -1.632862362581206650e-01_rk, -5.969439160148379292e-17_rk, 1.048519156167433558e-17_rk,4.901070385412926047e-17_rk, &
                                        1.105805488835700512e-01_rk, 2.633784435994367739e-17_rk, 3.904135073466218502e-17_rk,6.270930952181262374e-17_rk, &
                                        1.044833725513345458e-17_rk, -1.632862362581207205e-01_rk, 2.129981722794978092e-17_rk,-6.393636182264257342e-17_rk, &
                                        -3.164653266699654945e-17_rk, 1.105805488835702177e-01_rk, 5.815073074878736037e-17_rk,4.317811979164597075e-17_rk, &
                                        3.320899501690126823e-18_rk, -2.556362861793007774e-18_rk, -6.093925298920017664e-01_rk,1.389723360954905701e-17_rk, &
                                        1.387610821789304597e-17_rk, 3.424969211188982261e-17_rk, 4.126922267623369667e-01_rk,-7.540508465248445111e-18_rk, &
                                        3.087867977378762671e-17_rk, 2.109777665058264936e-17_rk, 6.632506750069473039e-18_rk,-6.093925298920015443e-01_rk, &
                                        4.544031152479481942e-17_rk, 2.964487100814289227e-17_rk, 7.547012378715951388e-17_rk,4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        9.572315475306057975e-01_rk, 8.875796420940959930e-17_rk, -5.993216984821996781e-17_rk,2.039933099408430822e-17_rk, &
                                        -6.482554338950854422e-01_rk, -8.602786991637443668e-17_rk, -6.670246068953857667e-17_rk,-7.284139127906545659e-17_rk, &
                                        -4.091919223884831691e-17_rk, 2.564894201304196431e-01_rk, -2.840357544162722429e-17_rk,1.136492692459505502e-17_rk, &
                                        2.243334156120756629e-17_rk, -1.736995200012753648e-01_rk, -9.424830494029251102e-17_rk,-3.743354250657571845e-17_rk, &
                                        6.715555408822236532e-17_rk, -1.074383108208419895e-17_rk, 9.572315475306057975e-01_rk,-4.074719609965771370e-17_rk, &
                                        -7.963784616140203739e-17_rk, -4.834750804161696275e-17_rk, -6.482554338950854422e-01_rk,-2.739804957002662927e-17_rk, &
                                        -1.691137799925421194e-16_rk, 3.354770223950076045e-18_rk, 2.040241208373023466e-17_rk,2.564894201304196986e-01_rk, &
                                        -8.752501377419607707e-17_rk, -5.342576099489181151e-17_rk, -1.119639323051716015e-16_rk,-1.736995200012752538e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        3.012359565344129297e-01_rk, 1.186828136737824770e-16_rk, -2.639611348623276463e-16_rk,-7.628599445505763232e-17_rk, &
                                        -9.340887480004114174e-01_rk, -9.592086461472006835e-17_rk, -8.064483463776375675e-17_rk,-7.739528318359562334e-17_rk, &
                                        -2.009332574437018798e-17_rk, 8.071593128461290734e-02_rk, 7.787808477547735014e-17_rk,8.630318319222981861e-17_rk, &
                                        4.195975757631057280e-18_rk, -2.502883256857088567e-01_rk, -1.716762563986760918e-16_rk,-9.147684594069359033e-17_rk, &
                                        2.830692876776505763e-17_rk, -2.023582988120929027e-17_rk, 1.124227894853038867e+00_rk,-1.083061660612231239e-16_rk, &
                                        -1.664243690912648048e-16_rk, -1.925930349175566995e-16_rk, -3.486066666315936313e+00_rk,-1.344642483265965540e-16_rk, &
                                        -1.434036081354226909e-16_rk, -3.398017731402761455e-18_rk, 1.000612083816429876e-16_rk,3.012359565344127632e-01_rk, &
                                        -7.069214933301258589e-17_rk, -8.254771466044089760e-17_rk, -2.378228410163395165e-16_rk,-9.340887480004114174e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -4.375241514048101854e-02_rk, -6.383504576548681875e-17_rk, 1.021690733554929399e-16_rk,1.387788666211036541e-16_rk, &
                                        4.126922267623369667e-01_rk, 6.256958659635189456e-17_rk, 2.873901637372962007e-17_rk,4.442335973743222828e-17_rk, &
                                        6.218525905100459211e-18_rk, -4.375241514048096303e-02_rk, -5.083878203299038854e-17_rk,-1.307460668961206145e-16_rk, &
                                        6.289685889045851279e-18_rk, 4.126922267623370777e-01_rk, 7.599242095091789409e-17_rk,3.863175122492697202e-17_rk, &
                                        -5.930638893838177090e-18_rk, 4.241532039227522202e-17_rk, -1.632862362581207205e-01_rk,8.425461690678535835e-17_rk, &
                                        4.643200466816352145e-17_rk, 7.700892535022948087e-17_rk, 1.540188358165777593e+00_rk,8.326656202543039847e-17_rk, &
                                        8.960818200887798864e-17_rk, 3.110680789538677715e-17_rk, -2.161831090877806395e-17_rk,-1.632862362581205540e-01_rk, &
                                        7.280527818954571448e-17_rk, 8.423689448078452788e-17_rk, 1.532487964258844966e-16_rk,1.540188358165777593e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        2.564894201304194765e-01_rk, 4.391816731786046404e-17_rk, -2.048306332158789474e-16_rk,-7.569057966443491255e-17_rk, &
                                        -2.419322215579066349e+00_rk, -1.657005490645654699e-16_rk, -1.040158040526799298e-16_rk,-1.673065282610185872e-16_rk, &
                                        -8.519773609466364622e-17_rk, 6.872613299107291351e-02_rk, 8.109188963831859726e-17_rk,7.164486221793438072e-17_rk, &
                                        -6.093760208718542548e-17_rk, -6.482554338950854422e-01_rk, -1.112395141340055304e-16_rk,-2.147670999467464696e-17_rk, &
                                        1.576024889433733580e-16_rk, -8.680920600023891589e-17_rk, 2.564894201304197541e-01_rk,-8.758193683240887619e-17_rk, &
                                        -1.307107955495970880e-16_rk, -1.235573931596133490e-16_rk, -2.419322215579066349e+00_rk,-1.117189682330775998e-16_rk, &
                                        -2.512234533437941587e-16_rk, 3.543928749072699686e-18_rk, 8.004986100219535997e-17_rk,6.872613299107299678e-02_rk, &
                                        1.867326873751474784e-17_rk, -9.869554713339069385e-17_rk, -1.783709554627789667e-16_rk,-6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -2.397959658707968233e-02_rk, -7.274444681993956749e-17_rk, 8.755792482384762807e-18_rk,1.916856368959551891e-16_rk, &
                                        1.531776113688671503e-01_rk, 5.651356939931464406e-17_rk, 2.302191457359164344e-17_rk,4.836679637949381765e-17_rk, &
                                        7.981581771253914225e-18_rk, -8.949307280798646236e-02_rk, -1.280153066163147556e-17_rk,-1.826266322996982680e-16_rk, &
                                        -9.008199504190676230e-18_rk, 5.716666282106519503e-01_rk, 6.183889929662407914e-17_rk,3.170501600878888452e-17_rk, &
                                        1.628659799040768124e-18_rk, 4.003550375713568002e-17_rk, -8.949307280798664277e-02_rk,8.179444535807935478e-17_rk, &
                                        -1.533554247458852981e-17_rk, 2.554666740819645032e-17_rk, 5.716666282106519503e-01_rk,5.209988458011385725e-17_rk, &
                                        8.357194183773988381e-17_rk, 5.741638618321941298e-17_rk, 3.205212428959437865e-17_rk,-3.339926946448661393e-01_rk, &
                                        1.026885181225244251e-16_rk, 1.005862082780776732e-16_rk, 1.452876742629098318e-16_rk,2.133488901473740373e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.632862362581206650e-01_rk, 5.969439160148379292e-17_rk, -1.048519156167433558e-17_rk,-4.901070385412926047e-17_rk, &
                                        -1.105805488835700512e-01_rk, -2.633784435994367739e-17_rk, -3.904135073466218502e-17_rk,-6.270930952181262374e-17_rk, &
                                        -1.044833725513345458e-17_rk, 1.632862362581207205e-01_rk, -2.129981722794978092e-17_rk,6.393636182264257342e-17_rk, &
                                        3.164653266699654945e-17_rk, -1.105805488835702177e-01_rk, -5.815073074878736037e-17_rk,-4.317811979164597075e-17_rk, &
                                        -3.320899501690126823e-18_rk, 2.556362861793007774e-18_rk, 6.093925298920017664e-01_rk,-1.389723360954905701e-17_rk, &
                                        -1.387610821789304597e-17_rk, -3.424969211188982261e-17_rk, -4.126922267623369667e-01_rk,7.540508465248445111e-18_rk, &
                                        -3.087867977378762671e-17_rk, -2.109777665058264936e-17_rk, -6.632506750069473039e-18_rk,6.093925298920015443e-01_rk, &
                                        -4.544031152479481942e-17_rk, -2.964487100814289227e-17_rk, -7.547012378715951388e-17_rk,-4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        2.564894201304196986e-01_rk, 8.663072377272758303e-17_rk, 3.965396920373038534e-17_rk,-1.172443525373440474e-16_rk, &
                                        -1.736995200012752538e-01_rk, -9.364592641242174895e-17_rk, -5.051337185812663200e-17_rk,-1.133200631880104362e-16_rk, &
                                        -1.757782191730489212e-17_rk, 9.572315475306057975e-01_rk, 2.054963154746788041e-17_rk,1.157021782717567629e-16_rk, &
                                        3.033755052858008370e-17_rk, -6.482554338950854422e-01_rk, -5.801279222300593429e-17_rk,-4.813603351420157174e-17_rk, &
                                        -1.903901383812214409e-17_rk, -1.277835621815682613e-16_rk, 2.564894201304196431e-01_rk,-1.437123069496546971e-17_rk, &
                                        -4.892094909344810131e-17_rk, -5.852761824962239336e-17_rk, -1.736995200012752538e-01_rk,2.862516072055338889e-17_rk, &
                                        -2.015725067521299288e-17_rk, -4.672080086203701893e-17_rk, 4.576123709673627950e-18_rk,9.572315475306054644e-01_rk, &
                                        -5.283693430027587451e-17_rk, -9.884059172402588865e-17_rk, -1.007300138163047421e-16_rk,-6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        8.071593128461282407e-02_rk, 1.365622127103984137e-16_rk, -6.786734644721167983e-19_rk,-3.419961862166002032e-16_rk, &
                                        -2.502883256857088567e-01_rk, -9.983921110532819067e-17_rk, -5.484954779998374939e-17_rk,-1.360393897953922587e-16_rk, &
                                        -1.260911194308403901e-17_rk, 3.012359565344129853e-01_rk, 8.948068781447824837e-18_rk,3.378154987047726881e-16_rk, &
                                        3.413843131494141234e-17_rk, -9.340887480004114174e-01_rk, -1.103371031034736136e-16_rk,-7.492228528762768437e-17_rk, &
                                        -1.959261173276341704e-17_rk, -7.794103426761077640e-17_rk, 3.012359565344130408e-01_rk,-1.188132942575965189e-16_rk, &
                                        3.074313793482301247e-17_rk, -5.144518118215369260e-17_rk, -9.340887480004114174e-01_rk,-5.400280963466620910e-17_rk, &
                                        -1.253795993811513660e-16_rk, -1.074645616944127703e-16_rk, -5.903791407594670089e-17_rk,1.124227894853038201e+00_rk, &
                                        -1.821178439800849725e-16_rk, -1.711680431434901216e-16_rk, -2.601869770926708290e-16_rk,-3.486066666315936313e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        4.375241514048101854e-02_rk, 6.383504576548681875e-17_rk, -1.021690733554929399e-16_rk,-1.387788666211036541e-16_rk, &
                                        -4.126922267623369667e-01_rk, -6.256958659635189456e-17_rk, -2.873901637372962007e-17_rk,-4.442335973743222828e-17_rk, &
                                        -6.218525905100459211e-18_rk, 4.375241514048096303e-02_rk, 5.083878203299038854e-17_rk,1.307460668961206145e-16_rk, &
                                        -6.289685889045851279e-18_rk, -4.126922267623370777e-01_rk, -7.599242095091789409e-17_rk,-3.863175122492697202e-17_rk, &
                                        5.930638893838177090e-18_rk, -4.241532039227522202e-17_rk, 1.632862362581207205e-01_rk,-8.425461690678535835e-17_rk, &
                                        -4.643200466816352145e-17_rk, -7.700892535022948087e-17_rk, -1.540188358165777593e+00_rk,-8.326656202543039847e-17_rk, &
                                        -8.960818200887798864e-17_rk, -3.110680789538677715e-17_rk, 2.161831090877806395e-17_rk,1.632862362581205540e-01_rk, &
                                        -7.280527818954571448e-17_rk, -8.423689448078452788e-17_rk, -1.532487964258844966e-16_rk,-1.540188358165777593e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        6.872613299107294127e-02_rk, 8.652314862832868128e-17_rk, 4.897107411554283605e-17_rk,-2.181708178008920882e-16_rk, &
                                        -6.482554338950854422e-01_rk, -1.951149500579163438e-16_rk, -7.098697041697975716e-17_rk,-9.191763066328042979e-17_rk, &
                                        -6.898744490681494707e-17_rk, 2.564894201304194210e-01_rk, -1.344278764876627664e-17_rk,1.626928319525496318e-16_rk, &
                                        -2.874450054517190144e-17_rk, -2.419322215579066349e+00_rk, -1.364627644597419756e-16_rk,-5.350414218801284002e-17_rk, &
                                        4.910119771492832062e-17_rk, -1.386945537055314029e-16_rk, 6.872613299107302454e-02_rk,-8.571319684708097524e-17_rk, &
                                        -4.375961110900645638e-17_rk, -5.143491929484079280e-18_rk, -6.482554338950854422e-01_rk,-8.526456632277497763e-17_rk, &
                                        -1.609862051105642515e-16_rk, -6.433769256438492648e-17_rk, -4.147950119104914104e-17_rk,2.564894201304194765e-01_rk, &
                                        -1.048954535979623138e-16_rk, -2.291498776943172062e-16_rk, -1.987701086735328318e-16_rk,-2.419322215579066349e+00_rk  &
                                        /),(/4,8/))
        
        



        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face3_dx
        ! 
        test_dbr2_vol_face3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.246477705771479094e+00_rk, -1.217457060517563113e-16_rk, 5.933208125627451551e-17_rk,6.534345033607923760e-17_rk, &
                                        9.810843355635495276e-17_rk, 2.133488901473740373e+00_rk, 1.223303548376606526e-17_rk,3.773166335075821198e-17_rk, &
                                        -8.949307280798653175e-02_rk, -2.692627076403997979e-17_rk, -4.857588650355048899e-17_rk,1.824364289260964973e-18_rk, &
                                        -3.965590929902850714e-17_rk, -1.531776113688669838e-01_rk, -2.631286988091700326e-17_rk,-2.903256483557565772e-17_rk, &
                                        2.150119587290858523e-17_rk, 1.366459878832237042e-17_rk, 3.339926946448663614e-01_rk,3.286386176830400531e-17_rk, &
                                        -7.040092675955309166e-17_rk, -3.385342625416153437e-17_rk, 1.235903493395748342e-16_rk,5.716666282106519503e-01_rk, &
                                        -1.433791299384356024e-16_rk, 8.112600237390327819e-18_rk, -2.397959658707966846e-02_rk,-9.614820231841044805e-19_rk, &
                                        -2.193140612632463590e-17_rk, -6.953468166780984985e-17_rk, -1.230293050269935950e-17_rk,-4.104381726481631798e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        2.274283883309887067e+00_rk, 5.085103346460702505e-17_rk, 1.563028264449831489e-16_rk,5.370970670703874245e-17_rk, &
                                        -2.074386932885202103e-17_rk, 4.126922267623369667e-01_rk, -2.322570057265838664e-17_rk,2.306515488133170792e-17_rk, &
                                        -6.093925298920017664e-01_rk, -6.565176803173033151e-17_rk, -7.659025796951541055e-17_rk,-2.532539078898692993e-17_rk, &
                                        -4.179487890435770150e-17_rk, -1.105805488835699402e-01_rk, -7.730110773362194999e-18_rk,-6.189855260372285592e-18_rk, &
                                        1.498949864490036251e-17_rk, 4.236815859484974351e-18_rk, 6.093925298920019884e-01_rk,7.521869158188342812e-17_rk, &
                                        -1.344693971091903242e-16_rk, -1.310824557718077145e-17_rk, 1.565562681750686186e-17_rk,1.105805488835700512e-01_rk, &
                                        -6.912974586713271739e-17_rk, 1.014615827672184190e-17_rk, -1.632862362581206095e-01_rk,-2.039539942216761615e-17_rk, &
                                        -8.853150321010988892e-17_rk, -2.556212571980019655e-17_rk, -2.958589220143538015e-18_rk,-2.962996877194295359e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        3.572436769992004102e+00_rk, 4.115785050255813020e-17_rk, 2.269160869158077370e-16_rk,6.340897651534934320e-17_rk, &
                                        1.640773147808599427e-17_rk, 6.482554338950854422e-01_rk, -1.835404488637835108e-16_rk,3.582036714966276491e-17_rk, &
                                        -2.564894201304195875e-01_rk, -1.972030687729014338e-17_rk, -1.674686664758963537e-17_rk,-1.911851781308825476e-17_rk, &
                                        -3.165938257347872607e-17_rk, -4.654264611001533714e-02_rk, -6.500450558431585316e-17_rk,1.766920696694941473e-17_rk, &
                                        9.452524773149756568e-17_rk, 1.126046187260188310e-17_rk, 3.572436769992004102e+00_rk,9.676281772810259834e-17_rk, &
                                        -2.779191672347031586e-16_rk, -5.898722855049110300e-17_rk, 1.032321123598949431e-16_rk,6.482554338950854422e-01_rk, &
                                        -8.651683039610560124e-17_rk, -2.495414623457871198e-17_rk, -2.564894201304195320e-01_rk,-4.029814064440734506e-17_rk, &
                                        -1.237334648522066957e-16_rk, -5.499491049263732263e-17_rk, -1.162711918866108457e-16_rk,-4.654264611001537877e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -4.195675622877743649e+00_rk, 1.374528072685132367e-16_rk, -2.316729799449308839e-16_rk,-1.442592445192258016e-16_rk, &
                                        -1.472287643414178006e-16_rk, -3.486066666315936313e+00_rk, -1.179722206917147719e-18_rk,-6.026983308205396528e-17_rk, &
                                        3.012359565344129297e-01_rk, 5.406499447780299530e-17_rk, 7.008484848967384189e-17_rk,1.203857651971743960e-17_rk, &
                                        9.639469902950396133e-17_rk, 2.502883256857085792e-01_rk, 3.758199893315530547e-17_rk,3.439754072247310881e-17_rk, &
                                        -4.631975126805026703e-17_rk, -1.662861016742539412e-17_rk, -1.124227894853039089e+00_rk,-7.927004339269821900e-17_rk, &
                                        2.727730401356605951e-16_rk, 7.588315601563370082e-17_rk, -2.345211966031143993e-16_rk,-9.340887480004114174e-01_rk, &
                                        2.432169696435316929e-16_rk, -8.615928939945484750e-18_rk, 8.071593128461278244e-02_rk,-1.433987712900000710e-18_rk, &
                                        1.192016770536098069e-16_rk, 1.325550327173616841e-16_rk, 1.715884147531135507e-17_rk,6.706455474242353776e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        6.093925298920019884e-01_rk, -7.281249971918564589e-17_rk, 6.361720788071188660e-17_rk,9.756920628266435932e-17_rk, &
                                        9.184929902528103127e-17_rk, 1.540188358165777593e+00_rk, -1.465568514529095414e-18_rk,2.653532917547608770e-17_rk, &
                                        -1.632862362581206650e-01_rk, -6.956025390053422835e-17_rk, -1.052311500268726834e-16_rk,-1.471721797770255786e-17_rk, &
                                        -4.741394157970362219e-17_rk, -4.126922267623368001e-01_rk, -8.925445560503470181e-17_rk,-5.555984942648479701e-17_rk, &
                                        4.163348464714182606e-17_rk, 4.811476692280543820e-17_rk, 1.632862362581208870e-01_rk,1.151712075297308959e-16_rk, &
                                        -4.315477129585094998e-18_rk, 8.493507741341917973e-19_rk, 1.040865516712984249e-16_rk,4.126922267623369667e-01_rk, &
                                        -1.199460171976602167e-16_rk, 2.512639869598265943e-17_rk, -4.375241514048096303e-02_rk,-3.831098721814062226e-17_rk, &
                                        4.429142981161656062e-18_rk, -6.191223751400338614e-17_rk, -8.065196217971186545e-17_rk,-1.105805488835700234e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        9.572315475306059085e-01_rk, -1.310913508266853358e-16_rk, 1.415694988537420794e-16_rk,8.506465827979093535e-17_rk, &
                                        1.743960907487952493e-16_rk, 2.419322215579066349e+00_rk, -4.387227845414778273e-17_rk,1.512398567313575695e-16_rk, &
                                        -6.872613299107294127e-02_rk, -3.878241832501154794e-17_rk, -1.045727909982790769e-16_rk,1.034051361475657747e-17_rk, &
                                        -6.398098302859407477e-17_rk, -1.736995200012751428e-01_rk, -5.121766521466237506e-17_rk,-7.333219227296366219e-17_rk, &
                                        7.179863403880459310e-17_rk, 3.700350820859798796e-18_rk, 9.572315475306059085e-01_rk,-8.685937941355530179e-17_rk, &
                                        -2.495660799382348499e-17_rk, -3.855375618784377794e-18_rk, 1.323690641865878354e-16_rk,2.419322215579066349e+00_rk, &
                                        -1.733082936699323551e-16_rk, 1.922464224339030544e-17_rk, -6.872613299107291351e-02_rk,-2.688326467905883037e-17_rk, &
                                        -5.243686394267642168e-18_rk, -8.896716448018390215e-17_rk, -1.064331059079877706e-16_rk,-1.736995200012750595e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        3.339926946448664724e-01_rk, 1.086283941396717217e-17_rk, 8.605678656945269845e-17_rk,1.126867751821309750e-16_rk, &
                                        5.225331982024633786e-17_rk, 5.716666282106519503e-01_rk, -2.032497588711835115e-17_rk,1.273015876592960844e-17_rk, &
                                        -3.339926946448664169e-01_rk, -1.066091900508814852e-16_rk, -1.479448247846170733e-16_rk,-3.284056342865957287e-17_rk, &
                                        -5.065097672676634665e-17_rk, -5.716666282106516173e-01_rk, -1.265404265359724846e-16_rk,-6.644981265383729034e-17_rk, &
                                        5.254949992704854927e-17_rk, 6.875150410674423348e-17_rk, 8.949307280798646236e-02_rk,1.801402632508927652e-16_rk, &
                                        3.060474454261796929e-17_rk, 3.212245941259717805e-17_rk, 5.626860640454374781e-17_rk,1.531776113688670948e-01_rk, &
                                        -7.623073059613241149e-17_rk, 3.684382000765425017e-17_rk, -8.949307280798651787e-02_rk,-6.877518328186919158e-17_rk, &
                                        8.029253915791646975e-18_rk, -4.137508757531010105e-17_rk, -1.248450668302763673e-16_rk,-1.531776113688669838e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -2.274283883309887067e+00_rk, -5.085103346460702505e-17_rk, -1.563028264449831489e-16_rk,-5.370970670703874245e-17_rk, &
                                        2.074386932885202103e-17_rk, -4.126922267623369667e-01_rk, 2.322570057265838664e-17_rk,-2.306515488133170792e-17_rk, &
                                        6.093925298920017664e-01_rk, 6.565176803173033151e-17_rk, 7.659025796951541055e-17_rk,2.532539078898692993e-17_rk, &
                                        4.179487890435770150e-17_rk, 1.105805488835699402e-01_rk, 7.730110773362194999e-18_rk,6.189855260372285592e-18_rk, &
                                        -1.498949864490036251e-17_rk, -4.236815859484974351e-18_rk, -6.093925298920019884e-01_rk,-7.521869158188342812e-17_rk, &
                                        1.344693971091903242e-16_rk, 1.310824557718077145e-17_rk, -1.565562681750686186e-17_rk,-1.105805488835700512e-01_rk, &
                                        6.912974586713271739e-17_rk, -1.014615827672184190e-17_rk, 1.632862362581206095e-01_rk,2.039539942216761615e-17_rk, &
                                        8.853150321010988892e-17_rk, 2.556212571980019655e-17_rk, 2.958589220143538015e-18_rk,2.962996877194295359e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        9.572315475306059085e-01_rk, 6.904106060677319873e-17_rk, 6.288092817578716458e-17_rk,5.279325876965077997e-17_rk, &
                                        -6.560894682550272524e-17_rk, 1.736995200012752538e-01_rk, -8.369848466205997383e-17_rk,1.034613470911204879e-16_rk, &
                                        -9.572315475306056864e-01_rk, -1.296410318654935939e-16_rk, -1.518924366692059301e-16_rk,1.193210860483599465e-18_rk, &
                                        -2.347070923952079171e-18_rk, -1.736995200012751428e-01_rk, -9.140380582157682466e-17_rk,-1.590103994986450070e-18_rk, &
                                        3.055875646745098732e-17_rk, -5.976523614897529815e-18_rk, 9.572315475306059085e-01_rk,1.335445088300383928e-16_rk, &
                                        -1.735604098952578142e-17_rk, 2.178059419820823204e-17_rk, -1.432306590495539711e-16_rk,1.736995200012752538e-01_rk, &
                                        -2.149130291587777346e-16_rk, -1.120571824461768636e-17_rk, -9.572315475306054644e-01_rk,-1.391020395035818228e-16_rk, &
                                        -2.096177715444519957e-17_rk, -1.308248512262808328e-17_rk, -9.014737457121290453e-17_rk,-1.736995200012751706e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.124227894853039311e+00_rk, -4.751438342589650351e-17_rk, -1.864710360753419915e-16_rk,-1.823842290856296929e-16_rk, &
                                        -3.964426012920630016e-17_rk, -9.340887480004114174e-01_rk, 4.401064719465173267e-17_rk,-4.287333613997259386e-17_rk, &
                                        1.124227894853038645e+00_rk, 2.250932833193699290e-16_rk, 3.137799069678126012e-16_rk,6.636830581598282191e-17_rk, &
                                        8.888763151746233667e-17_rk, 9.340887480004109733e-01_rk, 1.911876498982711459e-16_rk,1.103398573250181135e-16_rk, &
                                        -7.964877079923696243e-17_rk, -1.068131152164286341e-16_rk, -3.012359565344128187e-01_rk,-3.262957733002748537e-16_rk, &
                                        -3.487217835823296595e-17_rk, -5.576144566766091136e-17_rk, -4.349885540157907403e-17_rk,-2.502883256857088012e-01_rk, &
                                        1.635874747318712298e-16_rk, -6.926828411196476160e-17_rk, 3.012359565344129297e-01_rk,1.285180968594238313e-16_rk, &
                                        1.985707757406978950e-17_rk, 6.030426036057952976e-17_rk, 1.827503042113651831e-16_rk,2.502883256857088012e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -6.093925298920019884e-01_rk, 7.281249971918564589e-17_rk, -6.361720788071188660e-17_rk,-9.756920628266435932e-17_rk, &
                                        -9.184929902528103127e-17_rk, -1.540188358165777593e+00_rk, 1.465568514529095414e-18_rk,-2.653532917547608770e-17_rk, &
                                        1.632862362581206650e-01_rk, 6.956025390053422835e-17_rk, 1.052311500268726834e-16_rk,1.471721797770255786e-17_rk, &
                                        4.741394157970362219e-17_rk, 4.126922267623368001e-01_rk, 8.925445560503470181e-17_rk,5.555984942648479701e-17_rk, &
                                        -4.163348464714182606e-17_rk, -4.811476692280543820e-17_rk, -1.632862362581208870e-01_rk,-1.151712075297308959e-16_rk, &
                                        4.315477129585094998e-18_rk, -8.493507741341917973e-19_rk, -1.040865516712984249e-16_rk,-4.126922267623369667e-01_rk, &
                                        1.199460171976602167e-16_rk, -2.512639869598265943e-17_rk, 4.375241514048096303e-02_rk,3.831098721814062226e-17_rk, &
                                        -4.429142981161656062e-18_rk, 6.191223751400338614e-17_rk, 8.065196217971186545e-17_rk,1.105805488835700234e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        2.564894201304197541e-01_rk, 6.400091854257216749e-17_rk, 2.217314080416121995e-16_rk,2.162136973737452692e-16_rk, &
                                        1.117701897499520522e-16_rk, 6.482554338950854422e-01_rk, 8.419314350330458335e-18_rk,6.244264067140602741e-17_rk, &
                                        -2.564894201304196431e-01_rk, -1.535784695688639995e-16_rk, -1.122715769242035080e-16_rk,-1.004471434343488402e-17_rk, &
                                        -4.433209451215935910e-17_rk, -6.482554338950852202e-01_rk, -1.775087497631415327e-16_rk,-1.028485311325968913e-16_rk, &
                                        9.157174301577516580e-17_rk, 3.498516783532823917e-17_rk, 2.564894201304197541e-01_rk,1.706487997640671267e-16_rk, &
                                        5.891646481196541302e-17_rk, 6.529839567416300871e-17_rk, 7.335167725373095461e-17_rk,6.482554338950854422e-01_rk, &
                                        -1.226038552170839272e-16_rk, 5.966178757518071545e-17_rk, -2.564894201304196431e-01_rk,-1.492927119543738639e-16_rk, &
                                        -1.688377673982984925e-17_rk, -2.662821882666436035e-17_rk, -3.272677619868396698e-16_rk,-6.482554338950851092e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        3.339926946448665834e-01_rk, -1.309761783812665823e-17_rk, 1.280375462655719703e-16_rk,3.601987035221089090e-17_rk, &
                                        9.222700747743778257e-17_rk, 5.716666282106519503e-01_rk, -8.771709672112268762e-17_rk,1.306528542291134302e-16_rk, &
                                        -2.397959658707969621e-02_rk, -1.787330387478629314e-17_rk, -6.661740636345620332e-17_rk,6.370263016924849203e-18_rk, &
                                        -3.411736205076184035e-17_rk, -4.104381726481630410e-02_rk, -3.884530890169108578e-17_rk,-4.722222577116224370e-17_rk, &
                                        7.036275581988061249e-17_rk, -7.947226846996139047e-18_rk, 1.246477705771479094e+00_rk,-1.115181445631939604e-16_rk, &
                                        7.677847300965193608e-19_rk, 2.062652504154894538e-17_rk, 3.484281399365745363e-17_rk,2.133488901473740373e+00_rk, &
                                        -5.657085253627703293e-17_rk, 8.751761219402503643e-18_rk, -8.949307280798651787e-02_rk,-3.418944003801882756e-17_rk, &
                                        -2.751558429380015724e-18_rk, -3.473686630971701275e-17_rk, -1.202052130730737574e-16_rk,-1.531776113688668728e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        6.093925298920019884e-01_rk, 1.930377224097081571e-17_rk, 2.818768333543255977e-17_rk,2.026693386870216653e-17_rk, &
                                        -1.057859718582874330e-17_rk, 1.105805488835700512e-01_rk, -1.469038884563193328e-16_rk,6.560433833360219084e-17_rk, &
                                        -1.632862362581206650e-01_rk, -2.943461343921783054e-17_rk, -3.076885692025046793e-17_rk,1.391378595720072884e-17_rk, &
                                        2.014569821979455166e-17_rk, -2.962996877194288420e-02_rk, -9.184251283025498668e-17_rk,1.642613013425824348e-17_rk, &
                                        6.464145163505986847e-17_rk, -8.729562886608712576e-19_rk, 2.274283883309887067e+00_rk,7.139950622614652427e-17_rk, &
                                        -5.350863873630847892e-17_rk, -1.057823351473338207e-17_rk, -4.111949250611165255e-17_rk,4.126922267623369667e-01_rk, &
                                        -1.227664627074890963e-16_rk, -3.316624297031043769e-17_rk, -6.093925298920016553e-01_rk,-9.381430242634833864e-17_rk, &
                                        -3.584348818836927760e-18_rk, -1.777729038016783861e-17_rk, -1.284515515706786766e-16_rk,-1.105805488835699124e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -3.572436769992004102e+00_rk, -4.115785050255813020e-17_rk, -2.269160869158077370e-16_rk,-6.340897651534934320e-17_rk, &
                                        -1.640773147808599427e-17_rk, -6.482554338950854422e-01_rk, 1.835404488637835108e-16_rk,-3.582036714966276491e-17_rk, &
                                        2.564894201304195875e-01_rk, 1.972030687729014338e-17_rk, 1.674686664758963537e-17_rk,1.911851781308825476e-17_rk, &
                                        3.165938257347872607e-17_rk, 4.654264611001533714e-02_rk, 6.500450558431585316e-17_rk,-1.766920696694941473e-17_rk, &
                                        -9.452524773149756568e-17_rk, -1.126046187260188310e-17_rk, -3.572436769992004102e+00_rk,-9.676281772810259834e-17_rk, &
                                        2.779191672347031586e-16_rk, 5.898722855049110300e-17_rk, -1.032321123598949431e-16_rk,-6.482554338950854422e-01_rk, &
                                        8.651683039610560124e-17_rk, 2.495414623457871198e-17_rk, 2.564894201304195320e-01_rk,4.029814064440734506e-17_rk, &
                                        1.237334648522066957e-16_rk, 5.499491049263732263e-17_rk, 1.162711918866108457e-16_rk,4.654264611001537877e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.124227894853039311e+00_rk, 1.990235500055545527e-17_rk, -2.304974195855421631e-16_rk,-5.489605062005955967e-17_rk, &
                                        -1.387427784023598508e-16_rk, -9.340887480004114174e-01_rk, 2.663344801435267462e-16_rk,-2.109826495889021933e-16_rk, &
                                        8.071593128461283795e-02_rk, 2.683751804391180630e-17_rk, 1.088314555896981980e-16_rk,-7.357885974478664774e-18_rk, &
                                        3.613230224746402866e-17_rk, 6.706455474242352388e-02_rk, 1.112192612571270089e-16_rk,5.939283988691010476e-17_rk, &
                                        -1.659361063486464906e-16_rk, -1.190888496699398833e-18_rk, -4.195675622877743649e+00_rk,1.086937464755958908e-16_rk, &
                                        6.491930610759427913e-17_rk, -6.427101240051910893e-18_rk, -8.029656160998449222e-17_rk,-3.486066666315936313e+00_rk, &
                                        1.165831456598625626e-16_rk, 5.913252202737472478e-18_rk, 3.012359565344128742e-01_rk,8.619085406696758591e-17_rk, &
                                        2.211695647071687068e-17_rk, 6.354281624422296586e-17_rk, 2.717995281071737010e-16_rk,2.502883256857084682e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        1.632862362581208870e-01_rk, 3.010140399043086790e-17_rk, 1.676673327679444290e-16_rk,9.423055191276906175e-17_rk, &
                                        9.032981332510893046e-17_rk, 4.126922267623369667e-01_rk, -2.110448942299915009e-17_rk,1.094991736800075079e-16_rk, &
                                        -4.375241514048096303e-02_rk, -5.290049076289065366e-17_rk, -3.281626211913021795e-17_rk,1.490552964247786753e-17_rk, &
                                        -2.154030518872300149e-17_rk, -1.105805488835699124e-01_rk, -5.635730263258775746e-17_rk,-5.660028260351898337e-17_rk, &
                                        6.237132760495068188e-17_rk, -2.348680084198118743e-17_rk, 6.093925298920019884e-01_rk,-6.182920581937646688e-17_rk, &
                                        2.593499344678626481e-17_rk, 3.826649066709767994e-17_rk, 2.687933991572738894e-17_rk,1.540188358165777593e+00_rk, &
                                        -6.843750766759395675e-17_rk, 2.509426229800720828e-17_rk, -1.632862362581206650e-01_rk,-7.384612292287162700e-17_rk, &
                                        -1.851592352466285673e-17_rk, -1.167806909354564142e-17_rk, -1.954505856151156408e-16_rk,-4.126922267623367446e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -9.572315475306059085e-01_rk, 1.310913508266853358e-16_rk, -1.415694988537420794e-16_rk,-8.506465827979093535e-17_rk, &
                                        -1.743960907487952493e-16_rk, -2.419322215579066349e+00_rk, 4.387227845414778273e-17_rk,-1.512398567313575695e-16_rk, &
                                        6.872613299107294127e-02_rk, 3.878241832501154794e-17_rk, 1.045727909982790769e-16_rk,-1.034051361475657747e-17_rk, &
                                        6.398098302859407477e-17_rk, 1.736995200012751428e-01_rk, 5.121766521466237506e-17_rk,7.333219227296366219e-17_rk, &
                                        -7.179863403880459310e-17_rk, -3.700350820859798796e-18_rk, -9.572315475306059085e-01_rk,8.685937941355530179e-17_rk, &
                                        2.495660799382348499e-17_rk, 3.855375618784377794e-18_rk, -1.323690641865878354e-16_rk,-2.419322215579066349e+00_rk, &
                                        1.733082936699323551e-16_rk, -1.922464224339030544e-17_rk, 6.872613299107291351e-02_rk,2.688326467905883037e-17_rk, &
                                        5.243686394267642168e-18_rk, 8.896716448018390215e-17_rk, 1.064331059079877706e-16_rk,1.736995200012750595e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        8.949307280798668440e-02_rk, 6.868292834061412910e-17_rk, 1.624048725793277013e-16_rk,1.282807848772331692e-16_rk, &
                                        5.802089270654776256e-17_rk, 1.531776113688671503e-01_rk, 1.651523985484955826e-17_rk,7.043289227883388621e-17_rk, &
                                        -8.949307280798655950e-02_rk, -7.872778207950955623e-17_rk, 3.668905532520029877e-18_rk,2.220674965272717247e-17_rk, &
                                        2.547633263832876048e-18_rk, -1.531776113688669283e-01_rk, -7.868496641226866039e-17_rk,-4.455477533434193858e-17_rk, &
                                        5.076757046954796680e-17_rk, -3.199463468637496793e-17_rk, 3.339926946448664724e-01_rk,2.418067631503163532e-17_rk, &
                                        3.017359587187925750e-17_rk, 4.154975042084115244e-17_rk, 6.900215533889679250e-19_rk,5.716666282106519503e-01_rk, &
                                        -8.886773335438535994e-17_rk, 2.568337918952225424e-17_rk, -3.339926946448663059e-01_rk,-1.134018972080075558e-16_rk, &
                                        -2.943667150552305936e-17_rk, 1.068585420465185851e-17_rk, -2.414659652434297489e-16_rk,-5.716666282106516173e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -6.093925298920019884e-01_rk, -1.930377224097081571e-17_rk, -2.818768333543255977e-17_rk,-2.026693386870216653e-17_rk, &
                                        1.057859718582874330e-17_rk, -1.105805488835700512e-01_rk, 1.469038884563193328e-16_rk,-6.560433833360219084e-17_rk, &
                                        1.632862362581206650e-01_rk, 2.943461343921783054e-17_rk, 3.076885692025046793e-17_rk,-1.391378595720072884e-17_rk, &
                                        -2.014569821979455166e-17_rk, 2.962996877194288420e-02_rk, 9.184251283025498668e-17_rk,-1.642613013425824348e-17_rk, &
                                        -6.464145163505986847e-17_rk, 8.729562886608712576e-19_rk, -2.274283883309887067e+00_rk,-7.139950622614652427e-17_rk, &
                                        5.350863873630847892e-17_rk, 1.057823351473338207e-17_rk, 4.111949250611165255e-17_rk,-4.126922267623369667e-01_rk, &
                                        1.227664627074890963e-16_rk, 3.316624297031043769e-17_rk, 6.093925298920016553e-01_rk,9.381430242634833864e-17_rk, &
                                        3.584348818836927760e-18_rk, 1.777729038016783861e-17_rk, 1.284515515706786766e-16_rk,1.105805488835699124e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -9.572315475306059085e-01_rk, -6.904106060677319873e-17_rk, -6.288092817578716458e-17_rk,-5.279325876965077997e-17_rk, &
                                        6.560894682550272524e-17_rk, -1.736995200012752538e-01_rk, 8.369848466205997383e-17_rk,-1.034613470911204879e-16_rk, &
                                        9.572315475306056864e-01_rk, 1.296410318654935939e-16_rk, 1.518924366692059301e-16_rk,-1.193210860483599465e-18_rk, &
                                        2.347070923952079171e-18_rk, 1.736995200012751428e-01_rk, 9.140380582157682466e-17_rk,1.590103994986450070e-18_rk, &
                                        -3.055875646745098732e-17_rk, 5.976523614897529815e-18_rk, -9.572315475306059085e-01_rk,-1.335445088300383928e-16_rk, &
                                        1.735604098952578142e-17_rk, -2.178059419820823204e-17_rk, 1.432306590495539711e-16_rk,-1.736995200012752538e-01_rk, &
                                        2.149130291587777346e-16_rk, 1.120571824461768636e-17_rk, 9.572315475306054644e-01_rk,1.391020395035818228e-16_rk, &
                                        2.096177715444519957e-17_rk, 1.308248512262808328e-17_rk, 9.014737457121290453e-17_rk,1.736995200012751706e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -3.012359565344134849e-01_rk, -1.253004796007394972e-16_rk, -2.223721297164475601e-16_rk,-2.071065070874483914e-16_rk, &
                                        -6.165408905864010785e-17_rk, -2.502883256857088567e-01_rk, 3.317339113321218544e-17_rk,-1.646121771449356580e-16_rk, &
                                        3.012359565344129297e-01_rk, 1.507947041801832036e-16_rk, 2.252206625164530928e-17_rk,-5.219989544506534178e-17_rk, &
                                        -1.815679434988416002e-17_rk, 2.502883256857084682e-01_rk, 1.803376021605677716e-16_rk,4.960107179665488232e-17_rk, &
                                        -9.414026388228745182e-17_rk, 5.942603628581328428e-17_rk, -1.124227894853039089e+00_rk,-8.005800507679282597e-17_rk, &
                                        -3.707741567145529138e-17_rk, -6.815364912142950388e-17_rk, 8.489852321843572145e-17_rk,-9.340887480004114174e-01_rk, &
                                        2.564786416192492992e-16_rk, -1.045138481718653357e-17_rk, 1.124227894853038645e+00_rk,2.509651948434702660e-16_rk, &
                                        2.869218511507096012e-17_rk, -5.248939725957962555e-18_rk, 4.178203483835404247e-16_rk,9.340887480004109733e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.632862362581208870e-01_rk, -3.010140399043086790e-17_rk, -1.676673327679444290e-16_rk,-9.423055191276906175e-17_rk, &
                                        -9.032981332510893046e-17_rk, -4.126922267623369667e-01_rk, 2.110448942299915009e-17_rk,-1.094991736800075079e-16_rk, &
                                        4.375241514048096303e-02_rk, 5.290049076289065366e-17_rk, 3.281626211913021795e-17_rk,-1.490552964247786753e-17_rk, &
                                        2.154030518872300149e-17_rk, 1.105805488835699124e-01_rk, 5.635730263258775746e-17_rk,5.660028260351898337e-17_rk, &
                                        -6.237132760495068188e-17_rk, 2.348680084198118743e-17_rk, -6.093925298920019884e-01_rk,6.182920581937646688e-17_rk, &
                                        -2.593499344678626481e-17_rk, -3.826649066709767994e-17_rk, -2.687933991572738894e-17_rk,-1.540188358165777593e+00_rk, &
                                        6.843750766759395675e-17_rk, -2.509426229800720828e-17_rk, 1.632862362581206650e-01_rk,7.384612292287162700e-17_rk, &
                                        1.851592352466285673e-17_rk, 1.167806909354564142e-17_rk, 1.954505856151156408e-16_rk,4.126922267623367446e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.564894201304197541e-01_rk, -6.400091854257216749e-17_rk, -2.217314080416121995e-16_rk,-2.162136973737452692e-16_rk, &
                                        -1.117701897499520522e-16_rk, -6.482554338950854422e-01_rk, -8.419314350330458335e-18_rk,-6.244264067140602741e-17_rk, &
                                        2.564894201304196431e-01_rk, 1.535784695688639995e-16_rk, 1.122715769242035080e-16_rk,1.004471434343488402e-17_rk, &
                                        4.433209451215935910e-17_rk, 6.482554338950852202e-01_rk, 1.775087497631415327e-16_rk,1.028485311325968913e-16_rk, &
                                        -9.157174301577516580e-17_rk, -3.498516783532823917e-17_rk, -2.564894201304197541e-01_rk,-1.706487997640671267e-16_rk, &
                                        -5.891646481196541302e-17_rk, -6.529839567416300871e-17_rk, -7.335167725373095461e-17_rk,-6.482554338950854422e-01_rk, &
                                        1.226038552170839272e-16_rk, -5.966178757518071545e-17_rk, 2.564894201304196431e-01_rk,1.492927119543738639e-16_rk, &
                                        1.688377673982984925e-17_rk, 2.662821882666436035e-17_rk, 3.272677619868396698e-16_rk,6.482554338950851092e-01_rk  &
                                        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face4_dx
        ! 
        test_dbr2_vol_face4_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -3.339926946448663059e-01_rk, -1.187686242054684236e-16_rk, -6.979113014211640042e-17_rk,2.682018368463900813e-17_rk, &
                                        -2.337456831107041050e-16_rk, -5.716666282106516173e-01_rk, -5.075581925516628340e-17_rk,-1.297908256704134308e-17_rk, &
                                        3.339926946448663614e-01_rk, 8.953899925113888266e-17_rk, 1.120325648537292567e-17_rk,-5.838991247156797551e-17_rk, &
                                        2.280982061883110724e-17_rk, 5.716666282106519503e-01_rk, 3.956271594045080202e-17_rk,1.317077828296278508e-19_rk, &
                                        -8.974822877065622654e-18_rk, 4.420919330442667036e-17_rk, -8.949307280798669828e-02_rk,-8.574601265354352037e-17_rk, &
                                        -6.262049460031369211e-17_rk, -5.678032349581424842e-17_rk, -4.044650948872947689e-18_rk,-1.531776113688669838e-01_rk, &
                                        1.440409296336905649e-16_rk, 8.212238454750915627e-17_rk, 8.949307280798657338e-02_rk,1.092546614008605262e-16_rk, &
                                        2.423552198757524531e-17_rk, -2.335790651693090123e-17_rk, 3.823731441709760190e-17_rk,1.531776113688671503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -6.093925298920015443e-01_rk, -1.094348034386802550e-16_rk, -1.579236091401943449e-16_rk,-2.264249157445029464e-17_rk, &
                                        -1.272286793944218193e-16_rk, -1.105805488835699540e-01_rk, 1.672847132170549702e-17_rk,-2.099896700545380803e-17_rk, &
                                        2.274283883309887067e+00_rk, 1.257779343601037639e-16_rk, 7.275865620059680271e-17_rk,-2.766307572975764684e-17_rk, &
                                        -3.485932937527533553e-17_rk, 4.126922267623369667e-01_rk, -4.089779972458418300e-17_rk,-1.038289320753510697e-17_rk, &
                                        -3.349004883097416858e-17_rk, 5.215524890718231502e-17_rk, -1.632862362581206650e-01_rk,-4.633828515211826605e-17_rk, &
                                        -8.998143216033085218e-17_rk, -2.639501214205918622e-17_rk, 5.751688687733351085e-18_rk,-2.962996877194293277e-02_rk, &
                                        3.688032583971166596e-17_rk, 3.572764031022036738e-17_rk, 6.093925298920019884e-01_rk,6.598563949866074797e-17_rk, &
                                        -1.456810162800624755e-16_rk, -1.136466002845191442e-17_rk, 1.253597452945076094e-17_rk,1.105805488835700512e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -9.572315475306054644e-01_rk, -1.699566462646342248e-16_rk, -3.189027867494904612e-16_rk,-2.899425450044266626e-17_rk, &
                                        -8.731094647831212072e-17_rk, -1.736995200012751983e-01_rk, -1.884331368214624281e-17_rk,-1.868003989096687017e-17_rk, &
                                        9.572315475306059085e-01_rk, 1.488771328609658774e-16_rk, 2.609942749159161136e-17_rk,-3.511521288077523051e-17_rk, &
                                        -1.295061516747379077e-16_rk, 1.736995200012752538e-01_rk, -1.557282963012310350e-17_rk,1.308751068567706105e-17_rk, &
                                        -1.856651177564740720e-16_rk, 9.733889405246038614e-18_rk, -9.572315475306056864e-01_rk,-1.198517255344831661e-16_rk, &
                                        -8.870931338396520323e-17_rk, -4.019061359219317684e-17_rk, -3.611638918555388753e-17_rk,-1.736995200012750873e-01_rk, &
                                        7.874886009992920746e-17_rk, 5.629176534872766179e-17_rk, 9.572315475306059085e-01_rk,1.283015194130733676e-16_rk, &
                                        -8.086205656915919002e-17_rk, 2.569799167407975425e-17_rk, -4.706579835132553561e-17_rk,1.736995200012752538e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,1) = reshape((/                                                                                 &
                                        1.124227894853038423e+00_rk, 2.815150937135446007e-16_rk, 2.759253050584206092e-16_rk,-1.296642099664687543e-19_rk, &
                                        4.052056035030498389e-16_rk, 9.340887480004109733e-01_rk, 5.117892302176912897e-17_rk,2.883555573910149112e-17_rk, &
                                        -1.124227894853039089e+00_rk, -1.962250514123063210e-16_rk, -4.518682982954090622e-17_rk,1.028111778902371128e-16_rk, &
                                        3.985296941778243968e-17_rk, -9.340887480004114174e-01_rk, -5.200754474753827879e-17_rk,8.730591162567138150e-19_rk, &
                                        4.727644916820536396e-17_rk, -1.018385669281718932e-16_rk, 3.012359565344132073e-01_rk,1.594471039715174042e-16_rk, &
                                        1.551123762916744726e-16_rk, 8.476582599600370659e-17_rk, 1.594957815745705442e-17_rk,2.502883256857085792e-01_rk, &
                                        -2.117429606680835640e-16_rk, -1.583000716039410727e-16_rk, -3.012359565344129297e-01_rk,-2.035169627753601883e-16_rk, &
                                        2.055864625272153805e-17_rk, 1.473443923241194597e-17_rk, -4.433611696422730453e-17_rk,-2.502883256857088567e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.632862362581206650e-01_rk, -7.817658594162826311e-17_rk, -1.493613131763538631e-17_rk,5.883298628165248048e-17_rk, &
                                        -1.908867645221627389e-16_rk, -4.126922267623368556e-01_rk, -3.469588301865559382e-17_rk,-3.017189804817758425e-17_rk, &
                                        6.093925298920019884e-01_rk, 1.557973002238175195e-16_rk, 4.778760161246474524e-18_rk,-8.581287207190607535e-17_rk, &
                                        2.796267866087231388e-17_rk, 1.540188358165777593e+00_rk, 5.071937724180728878e-17_rk,5.175742075875209163e-18_rk, &
                                        -2.802921352183193879e-17_rk, 1.135562975000722955e-16_rk, -4.375241514048099079e-02_rk,-8.953684306376126820e-17_rk, &
                                        -3.546994937930664732e-17_rk, -8.863434363143688503e-17_rk, -1.388915439297211317e-17_rk,-1.105805488835699540e-01_rk, &
                                        1.388724950270039127e-16_rk, 5.217159203535906135e-17_rk, 1.632862362581208870e-01_rk,1.373466755448075414e-16_rk, &
                                        -1.654066833004619583e-17_rk, -7.300705642407889945e-17_rk, 7.490058090295961501e-17_rk,4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -2.564894201304197541e-01_rk, -6.774053178726626266e-17_rk, -5.395237216480959778e-17_rk,8.233938018024116921e-17_rk, &
                                        -3.166820682321182123e-16_rk, -6.482554338950853312e-01_rk, -7.975811865974480355e-17_rk,-5.582213460056623213e-17_rk, &
                                        2.564894201304197541e-01_rk, 2.080665167909901176e-16_rk, 2.662383421456641952e-17_rk,-5.225540074401059446e-17_rk, &
                                        8.957503824476735161e-17_rk, 6.482554338950854422e-01_rk, 6.792997885964452199e-17_rk,-4.524751009513947584e-18_rk, &
                                        -1.507146186396914045e-16_rk, -2.270312493530828655e-17_rk, -2.564894201304198651e-01_rk,-1.612365207513117606e-16_rk, &
                                        -1.455531870828605952e-16_rk, -1.245612788888069178e-16_rk, -3.660494733264046183e-17_rk,-6.482554338950851092e-01_rk, &
                                        1.773214109572847128e-16_rk, 9.847655225495361442e-17_rk, 2.564894201304197541e-01_rk,1.695103325315677055e-16_rk, &
                                        1.900500810505190044e-17_rk, -4.133996832355372906e-17_rk, 5.329682891222591946e-17_rk,6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -8.949307280798650399e-02_rk, -3.992310587673571956e-17_rk, 6.360796815426332106e-18_rk,6.723146687298080406e-17_rk, &
                                        -1.199096925926731764e-16_rk, -1.531776113688670116e-01_rk, -3.894048113947354641e-18_rk,-4.313513999052888963e-17_rk, &
                                        1.246477705771478872e+00_rk, 2.044075093177288779e-16_rk, 1.446355001583760638e-17_rk,-9.345852867305434730e-17_rk, &
                                        1.606845691312182238e-17_rk, 2.133488901473740373e+00_rk, 3.635214047492133103e-17_rk,6.114576213579309896e-18_rk, &
                                        -4.653338407511591560e-17_rk, 1.604895726016148729e-16_rk, -2.397959658707980724e-02_rk,-7.691506696007079824e-17_rk, &
                                        -1.912642332176360868e-17_rk, -9.953455311148068010e-17_rk, -1.806065635202169521e-17_rk,-4.104381726481624859e-02_rk, &
                                        9.979204204766935589e-17_rk, 1.476645577397249105e-17_rk, 3.339926946448664724e-01_rk,1.390308115604666764e-16_rk, &
                                        -8.742157624072206961e-17_rk, -1.028891825069646861e-16_rk, 9.149597238965107300e-17_rk,5.716666282106519503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,2) = reshape((/                                                                                 &
                                        6.093925298920015443e-01_rk, 1.094348034386802550e-16_rk, 1.579236091401943449e-16_rk,2.264249157445029464e-17_rk, &
                                        1.272286793944218193e-16_rk, 1.105805488835699540e-01_rk, -1.672847132170549702e-17_rk,2.099896700545380803e-17_rk, &
                                        -2.274283883309887067e+00_rk, -1.257779343601037639e-16_rk, -7.275865620059680271e-17_rk,2.766307572975764684e-17_rk, &
                                        3.485932937527533553e-17_rk, -4.126922267623369667e-01_rk, 4.089779972458418300e-17_rk,1.038289320753510697e-17_rk, &
                                        3.349004883097416858e-17_rk, -5.215524890718231502e-17_rk, 1.632862362581206650e-01_rk,4.633828515211826605e-17_rk, &
                                        8.998143216033085218e-17_rk, 2.639501214205918622e-17_rk, -5.751688687733351085e-18_rk,2.962996877194293277e-02_rk, &
                                        -3.688032583971166596e-17_rk, -3.572764031022036738e-17_rk, -6.093925298920019884e-01_rk,-6.598563949866074797e-17_rk, &
                                        1.456810162800624755e-16_rk, 1.136466002845191442e-17_rk, -1.253597452945076094e-17_rk,-1.105805488835700512e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -2.564894201304196431e-01_rk, -4.428340323772761231e-17_rk, -8.370123888360447378e-17_rk,5.963346367248732835e-17_rk, &
                                        -1.143503087640068594e-16_rk, -4.654264611001536489e-02_rk, -1.054713450938825784e-16_rk,-4.858429356771631671e-17_rk, &
                                        3.572436769992004102e+00_rk, 1.641804061986964442e-16_rk, 9.700392439371981169e-17_rk,-8.846546616818214605e-17_rk, &
                                        7.597162994484080658e-17_rk, 6.482554338950854422e-01_rk, -2.593733155612612288e-16_rk,-4.297418856313372533e-17_rk, &
                                        -1.186585520249005547e-17_rk, 2.295118502089953042e-17_rk, -2.564894201304196986e-01_rk,-8.488739427955458325e-17_rk, &
                                        -8.303139428421358344e-17_rk, -4.876355011853614209e-17_rk, -2.089850574228514223e-17_rk,-4.654264611001536489e-02_rk, &
                                        1.975323569054257209e-16_rk, 5.746816208087953032e-17_rk, 3.572436769992004102e+00_rk,1.997753196291815778e-16_rk, &
                                        -1.816195657411795492e-16_rk, -6.171956211457436992e-17_rk, 3.907083231859893004e-17_rk,6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,1) = reshape((/                                                                                 &
                                        3.012359565344128742e-01_rk, 9.253005263103319802e-17_rk, 2.731730696680253899e-17_rk,-1.037440572198067578e-16_rk, &
                                        2.713166551495378535e-16_rk, 2.502883256857085792e-01_rk, 4.369154958368557751e-18_rk,7.960056240484520540e-17_rk, &
                                        -4.195675622877743649e+00_rk, -3.930455470729623368e-16_rk, -8.944206223141428752e-17_rk,1.513606446684967998e-16_rk, &
                                        -4.845887457438726417e-17_rk, -3.486066666315936313e+00_rk, -1.377581347533161293e-18_rk,4.183172756216077589e-18_rk, &
                                        7.711188563880472357e-17_rk, -2.608099044288665379e-16_rk, 8.071593128461293509e-02_rk,1.353155881395788925e-16_rk, &
                                        8.281965198317190707e-17_rk, 1.740793018302347203e-16_rk, 7.885376732198743376e-18_rk,6.706455474242346837e-02_rk, &
                                        -1.862454106138746277e-16_rk, -2.821613985332710205e-17_rk, -1.124227894853039089e+00_rk,-2.400194272942860377e-16_rk, &
                                        2.658516071858907508e-16_rk, 1.809198875685518005e-16_rk, -1.578755465399756070e-16_rk,-9.340887480004114174e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.632862362581206650e-01_rk, 7.817658594162826311e-17_rk, 1.493613131763538631e-17_rk,-5.883298628165248048e-17_rk, &
                                        1.908867645221627389e-16_rk, 4.126922267623368556e-01_rk, 3.469588301865559382e-17_rk,3.017189804817758425e-17_rk, &
                                        -6.093925298920019884e-01_rk, -1.557973002238175195e-16_rk, -4.778760161246474524e-18_rk,8.581287207190607535e-17_rk, &
                                        -2.796267866087231388e-17_rk, -1.540188358165777593e+00_rk, -5.071937724180728878e-17_rk,-5.175742075875209163e-18_rk, &
                                        2.802921352183193879e-17_rk, -1.135562975000722955e-16_rk, 4.375241514048099079e-02_rk,8.953684306376126820e-17_rk, &
                                        3.546994937930664732e-17_rk, 8.863434363143688503e-17_rk, 1.388915439297211317e-17_rk,1.105805488835699540e-01_rk, &
                                        -1.388724950270039127e-16_rk, -5.217159203535906135e-17_rk, -1.632862362581208870e-01_rk,-1.373466755448075414e-16_rk, &
                                        1.654066833004619583e-17_rk, 7.300705642407889945e-17_rk, -7.490058090295961501e-17_rk,-4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -6.872613299107299678e-02_rk, -4.086498219914252955e-17_rk, -4.041549605814997338e-17_rk,2.222955837479837105e-16_rk, &
                                        -9.926427249902823883e-17_rk, -1.736995200012751983e-01_rk, -4.952041500294228552e-17_rk,-9.467004465696257549e-17_rk, &
                                        9.572315475306059085e-01_rk, 2.374783292640455998e-16_rk, 7.123987840234114457e-18_rk,-2.414853805264668838e-16_rk, &
                                        9.711645833353240738e-17_rk, 2.419322215579066349e+00_rk, -2.475694672036438116e-18_rk,-2.942495263797059008e-17_rk, &
                                        -6.288470918783507199e-17_rk, 1.477915697727063897e-16_rk, -6.872613299107310780e-02_rk,-1.725967248874624416e-16_rk, &
                                        -3.676458451130434123e-17_rk, -1.156136374079931607e-16_rk, -3.534614269621259824e-17_rk,-1.736995200012750318e-01_rk, &
                                        7.455606807537541354e-17_rk, 1.469309588481340224e-17_rk, 9.572315475306059085e-01_rk,3.238994024977691572e-16_rk, &
                                        -3.670344504518825097e-17_rk, -1.374201497760016593e-16_rk, 1.312986014669977516e-16_rk,2.419322215579066349e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -8.949307280798655950e-02_rk, 1.967010593231491617e-17_rk, -3.737339168913859924e-17_rk,5.739234043247564076e-17_rk, &
                                        -1.207289975205480512e-16_rk, -1.531776113688670671e-01_rk, -3.803651063719679781e-17_rk,-5.001091467833259797e-17_rk, &
                                        8.949307280798657338e-02_rk, 1.574368085023836942e-16_rk, 2.148386151363577165e-17_rk,-3.287474926716490828e-18_rk, &
                                        5.373158184865095968e-17_rk, 1.531776113688671503e-01_rk, 3.119682596530131821e-17_rk,-2.991053379894333849e-18_rk, &
                                        -1.818970922359057263e-16_rk, -6.716119101856696875e-17_rk, -3.339926946448664169e-01_rk,-1.063320443916358029e-16_rk, &
                                        -1.077766781633769536e-16_rk, -8.354576355246907676e-17_rk, -4.093242913020968841e-17_rk,-5.716666282106517283e-01_rk, &
                                        5.903579910491285850e-17_rk, 3.258955870378360628e-17_rk, 3.339926946448663614e-01_rk,9.303362277360836216e-17_rk, &
                                        -1.620890657738999193e-17_rk, -1.720852218934547345e-17_rk, 1.191837851124949873e-17_rk,5.716666282106519503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -1.632862362581206372e-01_rk, -2.695464810753266016e-17_rk, -9.838207401261844352e-17_rk,4.214801794308008179e-17_rk, &
                                        -1.152863013303990680e-18_rk, -2.962996877194290501e-02_rk, -9.586964109365454374e-17_rk,-2.182283764947016893e-17_rk, &
                                        6.093925298920019884e-01_rk, 7.352068489401368708e-17_rk, 5.611371654316426491e-18_rk,-5.101082803542076519e-17_rk, &
                                        7.781943377809066262e-19_rk, 1.105805488835700512e-01_rk, -1.341383526404988609e-16_rk,-8.643556859634581968e-18_rk, &
                                        -9.226207420970848613e-17_rk, -3.134728426619207262e-17_rk, -6.093925298920017664e-01_rk,-8.400268669863342438e-17_rk, &
                                        -1.935209806163246826e-17_rk, -3.023496731061386632e-17_rk, -4.204849811825581824e-17_rk,-1.105805488835699540e-01_rk, &
                                        1.390057596396757404e-16_rk, 3.669417879456870980e-17_rk, 2.274283883309887067e+00_rk,1.428745630914952868e-16_rk, &
                                        -2.141997436581888861e-17_rk, -1.156738394569855996e-17_rk, -1.762572798529172110e-17_rk,4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,3) = reshape((/                                                                                 &
                                        9.572315475306054644e-01_rk, 1.699566462646342248e-16_rk, 3.189027867494904612e-16_rk,2.899425450044266626e-17_rk, &
                                        8.731094647831212072e-17_rk, 1.736995200012751983e-01_rk, 1.884331368214624281e-17_rk,1.868003989096687017e-17_rk, &
                                        -9.572315475306059085e-01_rk, -1.488771328609658774e-16_rk, -2.609942749159161136e-17_rk,3.511521288077523051e-17_rk, &
                                        1.295061516747379077e-16_rk, -1.736995200012752538e-01_rk, 1.557282963012310350e-17_rk,-1.308751068567706105e-17_rk, &
                                        1.856651177564740720e-16_rk, -9.733889405246038614e-18_rk, 9.572315475306056864e-01_rk,1.198517255344831661e-16_rk, &
                                        8.870931338396520323e-17_rk, 4.019061359219317684e-17_rk, 3.611638918555388753e-17_rk,1.736995200012750873e-01_rk, &
                                        -7.874886009992920746e-17_rk, -5.629176534872766179e-17_rk, -9.572315475306059085e-01_rk,-1.283015194130733676e-16_rk, &
                                        8.086205656915919002e-17_rk, -2.569799167407975425e-17_rk, 4.706579835132553561e-17_rk,-1.736995200012752538e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,1) = reshape((/                                                                                 &
                                        3.012359565344129853e-01_rk, 5.731343474932646688e-18_rk, 1.505121147715069496e-16_rk,-9.532172352838934785e-17_rk, &
                                        1.760247515230066215e-16_rk, 2.502883256857088012e-01_rk, 9.181867426630351962e-17_rk,7.716161737511859557e-17_rk, &
                                        -3.012359565344129297e-01_rk, -2.842065021164109378e-16_rk, -2.387999087612146715e-17_rk,1.539812943369090530e-17_rk, &
                                        -3.819255722155296175e-17_rk, -2.502883256857088567e-01_rk, -3.572937543485928301e-17_rk,-8.006145993887472742e-18_rk, &
                                        3.845392447844457994e-16_rk, 1.262838013153043057e-16_rk, 1.124227894853038645e+00_rk,2.176801708368670978e-16_rk, &
                                        1.643487105569966980e-16_rk, 1.501491100091380630e-16_rk, 7.926029840027862185e-17_rk,9.340887480004109733e-01_rk, &
                                        -1.458656747584321110e-16_rk, -5.382421762538657864e-17_rk, -1.124227894853039089e+00_rk,-1.954390312565154029e-16_rk, &
                                        3.728509450629308478e-17_rk, 2.119075177020020385e-17_rk, 1.302723993915334187e-17_rk,-9.340887480004114174e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -4.375241514048106017e-02_rk, 9.036168349736527239e-18_rk, -4.514031946927900669e-17_rk,1.351036551095404354e-16_rk, &
                                        -7.391290023122813269e-17_rk, -1.105805488835699540e-01_rk, -4.760538765369899955e-17_rk,-6.563439885385164280e-17_rk, &
                                        1.632862362581208870e-01_rk, 1.278453582512883916e-16_rk, 1.670577063318228873e-17_rk,-1.011883172355808067e-16_rk, &
                                        9.088881939376797402e-17_rk, 4.126922267623369667e-01_rk, -9.049885741809214382e-18_rk,-2.678879468388365950e-17_rk, &
                                        -1.079523419375963902e-16_rk, -3.392252022187317606e-17_rk, -1.632862362581206650e-01_rk,-1.229880017835260487e-16_rk, &
                                        -8.059714887153531429e-17_rk, -6.426575690983485938e-17_rk, -3.191633216279567807e-17_rk,-4.126922267623368556e-01_rk, &
                                        2.147768833928848428e-17_rk, 1.987444360229868630e-17_rk, 6.093925298920019884e-01_rk,1.767677176535176596e-16_rk, &
                                        5.273493433954597288e-18_rk, -4.079516926886200626e-17_rk, 4.261651996515749364e-17_rk,1.540188358165777593e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,3) = reshape((/                                                                                 &
                                        2.564894201304197541e-01_rk, 6.774053178726626266e-17_rk, 5.395237216480959778e-17_rk,-8.233938018024116921e-17_rk, &
                                        3.166820682321182123e-16_rk, 6.482554338950853312e-01_rk, 7.975811865974480355e-17_rk,5.582213460056623213e-17_rk, &
                                        -2.564894201304197541e-01_rk, -2.080665167909901176e-16_rk, -2.662383421456641952e-17_rk,5.225540074401059446e-17_rk, &
                                        -8.957503824476735161e-17_rk, -6.482554338950854422e-01_rk, -6.792997885964452199e-17_rk,4.524751009513947584e-18_rk, &
                                        1.507146186396914045e-16_rk, 2.270312493530828655e-17_rk, 2.564894201304198651e-01_rk,1.612365207513117606e-16_rk, &
                                        1.455531870828605952e-16_rk, 1.245612788888069178e-16_rk, 3.660494733264046183e-17_rk,6.482554338950851092e-01_rk, &
                                        -1.773214109572847128e-16_rk, -9.847655225495361442e-17_rk, -2.564894201304197541e-01_rk,-1.695103325315677055e-16_rk, &
                                        -1.900500810505190044e-17_rk, 4.133996832355372906e-17_rk, -5.329682891222591946e-17_rk,-6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -2.397959658707976560e-02_rk, -1.089816775891432954e-17_rk, -6.276229086014234220e-17_rk,1.813381561898458957e-16_rk, &
                                        -4.582648369973712516e-18_rk, -4.104381726481633880e-02_rk, -6.566199036520319567e-17_rk,-6.629172249661793033e-17_rk, &
                                        3.339926946448664724e-01_rk, 7.659690776642733501e-17_rk, 8.132117564986798921e-18_rk,-1.802127220736302472e-16_rk, &
                                        1.002064412837347542e-16_rk, 5.716666282106521724e-01_rk, -7.892186020807766239e-17_rk,-4.441440037187591472e-17_rk, &
                                        -2.301412661985880339e-17_rk, 2.201531002976532894e-18_rk, -8.949307280798658726e-02_rk,-1.220179281925125031e-16_rk, &
                                        -3.324026681105854655e-17_rk, -3.247452565382515548e-17_rk, -2.321957512732804263e-17_rk,-1.531776113688669283e-01_rk, &
                                        1.088870155741584634e-17_rk, 9.898133960577267997e-18_rk, 1.246477705771478872e+00_rk,2.405185941493126814e-16_rk, &
                                        1.995331761649171532e-17_rk, -5.459706526943316866e-17_rk, 5.591341877766945020e-17_rk,2.133488901473740373e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.632862362581206372e-01_rk, 2.695464810753266016e-17_rk, 9.838207401261844352e-17_rk,-4.214801794308008179e-17_rk, &
                                        1.152863013303990680e-18_rk, 2.962996877194290501e-02_rk, 9.586964109365454374e-17_rk,2.182283764947016893e-17_rk, &
                                        -6.093925298920019884e-01_rk, -7.352068489401368708e-17_rk, -5.611371654316426491e-18_rk,5.101082803542076519e-17_rk, &
                                        -7.781943377809066262e-19_rk, -1.105805488835700512e-01_rk, 1.341383526404988609e-16_rk,8.643556859634581968e-18_rk, &
                                        9.226207420970848613e-17_rk, 3.134728426619207262e-17_rk, 6.093925298920017664e-01_rk,8.400268669863342438e-17_rk, &
                                        1.935209806163246826e-17_rk, 3.023496731061386632e-17_rk, 4.204849811825581824e-17_rk,1.105805488835699540e-01_rk, &
                                        -1.390057596396757404e-16_rk, -3.669417879456870980e-17_rk, -2.274283883309887067e+00_rk,-1.428745630914952868e-16_rk, &
                                        2.141997436581888861e-17_rk, 1.156738394569855996e-17_rk, 1.762572798529172110e-17_rk,-4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,3) = reshape((/                                                                                 &
                                        2.564894201304196431e-01_rk, 4.428340323772761231e-17_rk, 8.370123888360447378e-17_rk,-5.963346367248732835e-17_rk, &
                                        1.143503087640068594e-16_rk, 4.654264611001536489e-02_rk, 1.054713450938825784e-16_rk,4.858429356771631671e-17_rk, &
                                        -3.572436769992004102e+00_rk, -1.641804061986964442e-16_rk, -9.700392439371981169e-17_rk,8.846546616818214605e-17_rk, &
                                        -7.597162994484080658e-17_rk, -6.482554338950854422e-01_rk, 2.593733155612612288e-16_rk,4.297418856313372533e-17_rk, &
                                        1.186585520249005547e-17_rk, -2.295118502089953042e-17_rk, 2.564894201304196986e-01_rk,8.488739427955458325e-17_rk, &
                                        8.303139428421358344e-17_rk, 4.876355011853614209e-17_rk, 2.089850574228514223e-17_rk,4.654264611001536489e-02_rk, &
                                        -1.975323569054257209e-16_rk, -5.746816208087953032e-17_rk, -3.572436769992004102e+00_rk,-1.997753196291815778e-16_rk, &
                                        1.816195657411795492e-16_rk, 6.171956211457436992e-17_rk, -3.907083231859893004e-17_rk,-6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,1) = reshape((/                                                                                 &
                                        8.071593128461287958e-02_rk, 1.802896962366195607e-17_rk, 1.250001749973099132e-16_rk,-3.024698017320776803e-16_rk, &
                                        4.544096594820775479e-18_rk, 6.706455474242353776e-02_rk, 1.854006243780315936e-16_rk,1.183672070634071245e-16_rk, &
                                        -1.124227894853039089e+00_rk, -1.491153969318577274e-16_rk, -2.598368379295184436e-17_rk,3.154258273994945273e-16_rk, &
                                        -1.827666628024142350e-16_rk, -9.340887480004114174e-01_rk, 2.845114514474089877e-16_rk,8.736588052403654485e-17_rk, &
                                        3.241243409900780344e-17_rk, 8.721597832964874851e-18_rk, 3.012359565344129853e-01_rk,2.216350286037297768e-16_rk, &
                                        6.315967187875708290e-17_rk, 5.630242507894750334e-17_rk, 6.899938744597386139e-17_rk,2.502883256857085792e-01_rk, &
                                        -1.411833861694690755e-16_rk, -5.627741297964070233e-17_rk, -4.195675622877743649e+00_rk,-4.734299976875545241e-16_rk, &
                                        -1.379446708740775196e-17_rk, 9.696294821022319605e-17_rk, -8.619858282928134853e-17_rk,-3.486066666315936313e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,2) = reshape((/                                                                                 &
                                        4.375241514048106017e-02_rk, -9.036168349736527239e-18_rk, 4.514031946927900669e-17_rk,-1.351036551095404354e-16_rk, &
                                        7.391290023122813269e-17_rk, 1.105805488835699540e-01_rk, 4.760538765369899955e-17_rk,6.563439885385164280e-17_rk, &
                                        -1.632862362581208870e-01_rk, -1.278453582512883916e-16_rk, -1.670577063318228873e-17_rk,1.011883172355808067e-16_rk, &
                                        -9.088881939376797402e-17_rk, -4.126922267623369667e-01_rk, 9.049885741809214382e-18_rk,2.678879468388365950e-17_rk, &
                                        1.079523419375963902e-16_rk, 3.392252022187317606e-17_rk, 1.632862362581206650e-01_rk,1.229880017835260487e-16_rk, &
                                        8.059714887153531429e-17_rk, 6.426575690983485938e-17_rk, 3.191633216279567807e-17_rk,4.126922267623368556e-01_rk, &
                                        -2.147768833928848428e-17_rk, -1.987444360229868630e-17_rk, -6.093925298920019884e-01_rk,-1.767677176535176596e-16_rk, &
                                        -5.273493433954597288e-18_rk, 4.079516926886200626e-17_rk, -4.261651996515749364e-17_rk,-1.540188358165777593e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,3) = reshape((/                                                                                 &
                                        6.872613299107299678e-02_rk, 4.086498219914252955e-17_rk, 4.041549605814997338e-17_rk,-2.222955837479837105e-16_rk, &
                                        9.926427249902823883e-17_rk, 1.736995200012751983e-01_rk, 4.952041500294228552e-17_rk,9.467004465696257549e-17_rk, &
                                        -9.572315475306059085e-01_rk, -2.374783292640455998e-16_rk, -7.123987840234114457e-18_rk,2.414853805264668838e-16_rk, &
                                        -9.711645833353240738e-17_rk, -2.419322215579066349e+00_rk, 2.475694672036438116e-18_rk,2.942495263797059008e-17_rk, &
                                        6.288470918783507199e-17_rk, -1.477915697727063897e-16_rk, 6.872613299107310780e-02_rk,1.725967248874624416e-16_rk, &
                                        3.676458451130434123e-17_rk, 1.156136374079931607e-16_rk, 3.534614269621259824e-17_rk,1.736995200012750318e-01_rk, &
                                        -7.455606807537541354e-17_rk, -1.469309588481340224e-17_rk, -9.572315475306059085e-01_rk,-3.238994024977691572e-16_rk, &
                                        3.670344504518825097e-17_rk, 1.374201497760016593e-16_rk, -1.312986014669977516e-16_rk,-2.419322215579066349e+00_rk  &
                                        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face5_dx
        ! 
        test_dbr2_vol_face5_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.246477705771478650e+00_rk, 2.205013454942593585e-16_rk, -1.704991180118505699e-17_rk,-3.239444011333337490e-17_rk, &
                                        1.110766659754361791e-16_rk, 2.133488901473740373e+00_rk, 1.117389212079751504e-18_rk,-5.254155706747216255e-18_rk, &
                                        7.997871855816318190e-17_rk, 1.851842883717012480e-17_rk, 3.339926946448663614e-01_rk,1.805989468106063156e-18_rk, &
                                        2.314351203890421982e-17_rk, 5.440839353939454898e-17_rk, 3.098803196677918147e-18_rk,5.716666282106519503e-01_rk, &
                                        -8.949307280798651787e-02_rk, -3.124910783404077428e-17_rk, -2.288474120081339928e-17_rk,1.643917676642576627e-17_rk, &
                                        8.355988252655754957e-19_rk, -1.531776113688669838e-01_rk, -1.224524223543040153e-17_rk,-4.645728363579097063e-17_rk, &
                                        -1.102993129992816909e-16_rk, -1.448666814219771562e-16_rk, -2.397959658707966846e-02_rk,-1.428358281633647405e-17_rk, &
                                        4.176442368978893239e-17_rk, -1.116948883324893301e-17_rk, -1.924301706454519801e-17_rk,-4.104381726481627635e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,1,2) = reshape((/                                                                                 &
                                        2.274283883309887067e+00_rk, 1.081589276062538567e-16_rk, 8.129548710917142084e-17_rk,-1.526045455488505108e-17_rk, &
                                        5.496140338823830226e-17_rk, 4.126922267623369667e-01_rk, 9.597072812308881340e-18_rk,-6.503021878069080971e-18_rk, &
                                        1.095136746743852073e-16_rk, 2.806298208800160822e-17_rk, 2.274283883309887067e+00_rk,2.747361679158195440e-17_rk, &
                                        4.109222650230911392e-18_rk, -5.184837892554186748e-19_rk, 8.715618121991330610e-18_rk,4.126922267623369667e-01_rk, &
                                        -1.632862362581206928e-01_rk, -5.235206767708425422e-17_rk, -3.956792666807834422e-17_rk,1.795981812129689775e-17_rk, &
                                        4.684956281513799830e-17_rk, -2.962996877194286338e-02_rk, -7.823547967029034301e-18_rk,2.511786781253388774e-17_rk, &
                                        -4.912635181657477985e-17_rk, -4.685794869656617203e-17_rk, -1.632862362581206095e-01_rk,-1.708933386324951918e-17_rk, &
                                        1.442572599882701452e-17_rk, -2.035156524973122109e-17_rk, -1.237191300942742036e-16_rk,-2.962996877194287726e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,1,3) = reshape((/                                                                                 &
                                        3.572436769992004102e+00_rk, 1.960387393969530441e-16_rk, 1.088562399203637219e-16_rk,-2.429757619149148135e-18_rk, &
                                        5.901173909430736857e-17_rk, 6.482554338950854422e-01_rk, 1.189275780782082867e-17_rk,-6.278343857829226189e-17_rk, &
                                        6.626429966034613150e-17_rk, 2.475632444486374044e-17_rk, 9.572315475306059085e-01_rk,6.233620510335370722e-17_rk, &
                                        5.981082971728313839e-17_rk, -2.342072739588015827e-17_rk, -6.130074091551000417e-17_rk,1.736995200012752538e-01_rk, &
                                        -9.572315475306056864e-01_rk, -1.201771306104003405e-16_rk, -1.956526640635810823e-16_rk,-1.099378552583574099e-17_rk, &
                                        8.189571862415971653e-17_rk, -1.736995200012751428e-01_rk, -3.558643666858901280e-17_rk,1.500265759655072561e-17_rk, &
                                        -4.700963342597870186e-17_rk, -2.029245278599537184e-17_rk, -2.564894201304197541e-01_rk,2.887083306176892108e-17_rk, &
                                        -2.080521033914797918e-17_rk, -5.279072731267576005e-17_rk, -2.973839740631530036e-17_rk,-4.654264611001532326e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -4.195675622877743649e+00_rk, -4.295000309661377433e-16_rk, -7.387169436053598476e-17_rk,5.062161236219080968e-17_rk, &
                                        -2.142718382752810280e-16_rk, -3.486066666315936313e+00_rk, -1.383111468515812232e-17_rk,2.401951579444565019e-17_rk, &
                                        -1.521993648794087602e-16_rk, -4.492185357105846269e-17_rk, -1.124227894853039089e+00_rk,-2.139302786974336005e-17_rk, &
                                        -4.071987413592726872e-17_rk, -7.018956529399188548e-17_rk, 2.974993596053966456e-19_rk,-9.340887480004114174e-01_rk, &
                                        3.012359565344128742e-01_rk, 8.047050013545558979e-17_rk, 6.725334391526259795e-17_rk,-3.779933805046672192e-17_rk, &
                                        -4.924639072934294806e-17_rk, 2.502883256857085792e-01_rk, 1.134342735872001208e-17_rk,6.075308687517045556e-17_rk, &
                                        1.857820549838351142e-16_rk, 2.323522907458203098e-16_rk, 8.071593128461279631e-02_rk,9.238517233645921432e-18_rk, &
                                        -6.080843910727651518e-17_rk, 4.321063182573196401e-17_rk, 4.510095705503909501e-17_rk,6.706455474242346837e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,2) = reshape((/                                                                                 &
                                        6.093925298920019884e-01_rk, 1.567568750293271148e-16_rk, -1.809608721602034731e-17_rk,-1.544496943183375199e-17_rk, &
                                        1.015635032876897826e-16_rk, 1.540188358165777593e+00_rk, -7.992325834293283261e-18_rk,2.450181885248174274e-17_rk, &
                                        8.917088275549970033e-17_rk, 1.167601699414178131e-17_rk, 6.093925298920019884e-01_rk,-8.249399394691875625e-17_rk, &
                                        5.533561965075963801e-17_rk, 7.938700922291128103e-17_rk, -4.239885305120814453e-18_rk,1.540188358165777593e+00_rk, &
                                        -4.375241514048094915e-02_rk, -3.922006287988623681e-17_rk, -4.581030068982635228e-17_rk,5.973922624168921339e-18_rk, &
                                        -2.836641428873499473e-17_rk, -1.105805488835699540e-01_rk, 1.023196941294340380e-17_rk,-4.843513966673791229e-17_rk, &
                                        -5.464706571881897733e-17_rk, -9.936305723123022635e-17_rk, -4.375241514048093527e-02_rk,-3.084990147905772385e-17_rk, &
                                        7.552537071206534491e-17_rk, 2.652208797472725597e-18_rk, -7.237725759016195044e-17_rk,-1.105805488835699957e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,3) = reshape((/                                                                                 &
                                        9.572315475306059085e-01_rk, 2.803934406093769335e-16_rk, -8.915798683171697294e-17_rk,-4.363354517459451285e-17_rk, &
                                        1.335383034096467329e-16_rk, 2.419322215579066349e+00_rk, -3.187107385224066731e-17_rk,3.040669400270011680e-19_rk, &
                                        1.510491090816266197e-16_rk, 4.569726501890927441e-17_rk, 2.564894201304197541e-01_rk,7.354362343625507521e-17_rk, &
                                        6.988144355506778639e-17_rk, 7.122589820142799967e-17_rk, 4.610417693268089264e-17_rk,6.482554338950854422e-01_rk, &
                                        -2.564894201304195875e-01_rk, -6.307812769000158476e-17_rk, -1.151655912398137456e-16_rk,2.050407937109905742e-18_rk, &
                                        -6.584982572247858750e-17_rk, -6.482554338950852202e-01_rk, -1.103776337578313678e-16_rk,-5.349827364307775277e-17_rk, &
                                        -1.092310842702950630e-16_rk, -1.084097357695569798e-16_rk, -6.872613299107291351e-02_rk,-4.621636738791401704e-17_rk, &
                                        7.404008709201700343e-17_rk, -7.289811763839074253e-18_rk, -5.474860652168141589e-17_rk,-1.736995200012751150e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,1) = reshape((/                                                                                 &
                                        3.339926946448664169e-01_rk, 7.081057922349052906e-17_rk, 6.084031991661132330e-18_rk,2.579459387653167548e-18_rk, &
                                        7.401290569576518715e-17_rk, 5.716666282106519503e-01_rk, -1.231818393820789491e-17_rk,4.513056285963460221e-17_rk, &
                                        9.733031890923945018e-17_rk, 8.014762151244159809e-18_rk, 1.246477705771478650e+00_rk,-1.347157406036807389e-16_rk, &
                                        7.145674464775647362e-17_rk, 7.975950260620639390e-17_rk, -8.164882106129763867e-18_rk,2.133488901473740373e+00_rk, &
                                        -2.397959658707968233e-02_rk, -4.774805379149970890e-17_rk, -6.417121545145582064e-17_rk,-1.993341945341465231e-18_rk, &
                                        -3.749927488705712052e-17_rk, -4.104381726481623471e-02_rk, 2.766326983219833903e-17_rk,-2.940688895456593004e-17_rk, &
                                        5.984949354513901664e-18_rk, -3.454226795020785631e-17_rk, -8.949307280798653175e-02_rk,-4.203276277393769098e-17_rk, &
                                        8.948245349031150476e-17_rk, 1.073785728247022221e-17_rk, -1.330903779614773830e-16_rk,-1.531776113688670948e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -2.274283883309887067e+00_rk, -1.081589276062538567e-16_rk, -8.129548710917142084e-17_rk,1.526045455488505108e-17_rk, &
                                        -5.496140338823830226e-17_rk, -4.126922267623369667e-01_rk, -9.597072812308881340e-18_rk,6.503021878069080971e-18_rk, &
                                        -1.095136746743852073e-16_rk, -2.806298208800160822e-17_rk, -2.274283883309887067e+00_rk,-2.747361679158195440e-17_rk, &
                                        -4.109222650230911392e-18_rk, 5.184837892554186748e-19_rk, -8.715618121991330610e-18_rk,-4.126922267623369667e-01_rk, &
                                        1.632862362581206928e-01_rk, 5.235206767708425422e-17_rk, 3.956792666807834422e-17_rk,-1.795981812129689775e-17_rk, &
                                        -4.684956281513799830e-17_rk, 2.962996877194286338e-02_rk, 7.823547967029034301e-18_rk,-2.511786781253388774e-17_rk, &
                                        4.912635181657477985e-17_rk, 4.685794869656617203e-17_rk, 1.632862362581206095e-01_rk,1.708933386324951918e-17_rk, &
                                        -1.442572599882701452e-17_rk, 2.035156524973122109e-17_rk, 1.237191300942742036e-16_rk,2.962996877194287726e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,3) = reshape((/                                                                                 &
                                        9.572315475306059085e-01_rk, 6.552809961404988718e-17_rk, -3.378446965255091665e-17_rk,3.777974602106809434e-18_rk, &
                                        4.443694704870297171e-18_rk, 1.736995200012753648e-01_rk, 1.249440747656214029e-17_rk,1.119479839892733816e-17_rk, &
                                        1.721434950853230570e-16_rk, 1.512410516009155552e-18_rk, 3.572436769992004102e+00_rk,6.977081379265780052e-17_rk, &
                                        3.172009018183456786e-17_rk, 3.078842305643679911e-17_rk, -5.564237649425592063e-17_rk,6.482554338950854422e-01_rk, &
                                        -2.564894201304195875e-01_rk, -7.765865228410132770e-17_rk, -4.822149789853824160e-17_rk,3.077916594812906895e-17_rk, &
                                        3.721492069643871973e-17_rk, -4.654264611001530938e-02_rk, -1.381199113177383325e-16_rk,3.847739929628321721e-17_rk, &
                                        -1.747382079084847076e-16_rk, -1.282974969610054530e-16_rk, -9.572315475306054644e-01_rk,-8.366325836167225436e-17_rk, &
                                        2.957174211401903618e-17_rk, -1.098879230961595730e-17_rk, -2.856325843206355491e-16_rk,-1.736995200012751706e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.124227894853039089e+00_rk, -1.322847010826294953e-16_rk, -1.991875094250557075e-17_rk,1.251784521166710352e-17_rk, &
                                        -1.241416960187814884e-16_rk, -9.340887480004114174e-01_rk, 1.691078138972008655e-17_rk,-7.223016354502382439e-17_rk, &
                                        -2.485481268560254377e-16_rk, -3.076661571188527370e-17_rk, -4.195675622877743649e+00_rk,1.742737097720036355e-16_rk, &
                                        -9.995599414070093538e-17_rk, -1.207807728297250699e-16_rk, -4.794924573335073721e-18_rk,-3.486066666315936313e+00_rk, &
                                        8.071593128461282407e-02_rk, 1.028692469929865933e-16_rk, 1.103864403329282853e-16_rk,-7.018611409514469772e-18_rk, &
                                        3.854496694736040432e-17_rk, 6.706455474242345449e-02_rk, -2.283558071772031269e-17_rk,1.380568439946970893e-17_rk, &
                                        2.938202992209835908e-17_rk, 8.703560295190955333e-17_rk, 3.012359565344127632e-01_rk,9.422243034654347666e-17_rk, &
                                        -1.461098517874159279e-16_rk, -1.519273194850140119e-17_rk, 3.390932259304324618e-16_rk,2.502883256857088012e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -6.093925298920019884e-01_rk, -1.567568750293271148e-16_rk, 1.809608721602034731e-17_rk,1.544496943183375199e-17_rk, &
                                        -1.015635032876897826e-16_rk, -1.540188358165777593e+00_rk, 7.992325834293283261e-18_rk,-2.450181885248174274e-17_rk, &
                                        -8.917088275549970033e-17_rk, -1.167601699414178131e-17_rk, -6.093925298920019884e-01_rk,8.249399394691875625e-17_rk, &
                                        -5.533561965075963801e-17_rk, -7.938700922291128103e-17_rk, 4.239885305120814453e-18_rk,-1.540188358165777593e+00_rk, &
                                        4.375241514048094915e-02_rk, 3.922006287988623681e-17_rk, 4.581030068982635228e-17_rk,-5.973922624168921339e-18_rk, &
                                        2.836641428873499473e-17_rk, 1.105805488835699540e-01_rk, -1.023196941294340380e-17_rk,4.843513966673791229e-17_rk, &
                                        5.464706571881897733e-17_rk, 9.936305723123022635e-17_rk, 4.375241514048093527e-02_rk,3.084990147905772385e-17_rk, &
                                        -7.552537071206534491e-17_rk, -2.652208797472725597e-18_rk, 7.237725759016195044e-17_rk,1.105805488835699957e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,3) = reshape((/                                                                                 &
                                        2.564894201304197541e-01_rk, 1.661123672379017965e-16_rk, 1.108510031630677486e-16_rk,7.307742521149027223e-17_rk, &
                                        8.722077246082124704e-17_rk, 6.482554338950854422e-01_rk, 2.619717720455698064e-17_rk,7.027544307256558624e-17_rk, &
                                        8.613236677783656848e-17_rk, -9.773151829080304172e-18_rk, 9.572315475306059085e-01_rk,-1.332390392680992864e-16_rk, &
                                        1.374133544269386867e-16_rk, 1.025308921698945215e-16_rk, 2.442946072068281760e-17_rk,2.419322215579066349e+00_rk, &
                                        -6.872613299107288576e-02_rk, -5.805892425075968013e-17_rk, -6.798271626566663093e-17_rk,-3.220514610779427167e-17_rk, &
                                        -6.494981297861138693e-17_rk, -1.736995200012751428e-01_rk, 1.865804212867508501e-17_rk,-2.599753460654829305e-17_rk, &
                                        -1.083565801771534818e-17_rk, -2.875892139745683976e-17_rk, -2.564894201304195320e-01_rk,-1.204562177979497363e-16_rk, &
                                        8.517514864674035963e-17_rk, 2.264034140726009928e-17_rk, -2.587501696857185873e-16_rk,-6.482554338950853312e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,1) = reshape((/                                                                                 &
                                        3.339926946448661949e-01_rk, 1.116206273769085729e-16_rk, -6.221926787599264043e-17_rk,-1.496934047763750859e-17_rk, &
                                        4.181254371099990609e-17_rk, 5.716666282106519503e-01_rk, -3.361042908252033034e-17_rk,-4.077378139114825148e-18_rk, &
                                        9.288406040056488277e-17_rk, 3.450267571317273859e-17_rk, 8.949307280798679542e-02_rk,8.698502117145382819e-17_rk, &
                                        6.131509328459698828e-17_rk, 1.869323107816171622e-17_rk, 3.712096566689996328e-17_rk,1.531776113688671503e-01_rk, &
                                        -3.339926946448663614e-01_rk, -5.516997284909947001e-17_rk, -1.312401515287677762e-16_rk,-1.592239676120521349e-17_rk, &
                                        -5.915145443037180520e-17_rk, -5.716666282106517283e-01_rk, -1.120978151450939894e-16_rk,-8.848140657284957168e-18_rk, &
                                        -1.456641366503276603e-17_rk, 2.499581939537804624e-17_rk, -8.949307280798655950e-02_rk,-3.104622313037573826e-17_rk, &
                                        3.477025312636045818e-17_rk, -4.802728037450968169e-18_rk, -4.429215879054479472e-17_rk,-1.531776113688669838e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,2) = reshape((/                                                                                 &
                                        6.093925298920019884e-01_rk, 5.835969390383865593e-17_rk, -3.350331381004511860e-17_rk,1.611875614367766256e-17_rk, &
                                        -1.456441956751968476e-17_rk, 1.105805488835700512e-01_rk, 5.928278799725586242e-18_rk,-2.633932648967128075e-17_rk, &
                                        4.226144134725972818e-17_rk, -1.133978601682638253e-17_rk, 6.093925298920019884e-01_rk,5.662832350615667361e-17_rk, &
                                        5.416117074054075309e-17_rk, 5.208904523552608853e-18_rk, -8.316391890735185513e-17_rk,1.105805488835700512e-01_rk, &
                                        -6.093925298920017664e-01_rk, -7.359410339537563324e-17_rk, -1.156871868065807389e-16_rk,-5.364053740650514220e-18_rk, &
                                        2.897862527569847944e-17_rk, -1.105805488835699263e-01_rk, -1.027613477468305554e-16_rk,8.928593832787363587e-18_rk, &
                                        -9.204270845677388666e-17_rk, -4.773735128747982568e-17_rk, -6.093925298920016553e-01_rk,-1.779260745864267646e-17_rk, &
                                        -8.844778535855433571e-18_rk, -2.025173801392581221e-17_rk, -7.705227250407794227e-17_rk,-1.105805488835699124e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -3.572436769992004102e+00_rk, -1.960387393969530441e-16_rk, -1.088562399203637219e-16_rk,2.429757619149148135e-18_rk, &
                                        -5.901173909430736857e-17_rk, -6.482554338950854422e-01_rk, -1.189275780782082867e-17_rk,6.278343857829226189e-17_rk, &
                                        -6.626429966034613150e-17_rk, -2.475632444486374044e-17_rk, -9.572315475306059085e-01_rk,-6.233620510335370722e-17_rk, &
                                        -5.981082971728313839e-17_rk, 2.342072739588015827e-17_rk, 6.130074091551000417e-17_rk,-1.736995200012752538e-01_rk, &
                                        9.572315475306056864e-01_rk, 1.201771306104003405e-16_rk, 1.956526640635810823e-16_rk,1.099378552583574099e-17_rk, &
                                        -8.189571862415971653e-17_rk, 1.736995200012751428e-01_rk, 3.558643666858901280e-17_rk,-1.500265759655072561e-17_rk, &
                                        4.700963342597870186e-17_rk, 2.029245278599537184e-17_rk, 2.564894201304197541e-01_rk,-2.887083306176892108e-17_rk, &
                                        2.080521033914797918e-17_rk, 5.279072731267576005e-17_rk, 2.973839740631530036e-17_rk,4.654264611001532326e-02_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.124227894853039089e+00_rk, -2.129931354757761754e-16_rk, 9.380803111047809069e-17_rk,1.912358072703830384e-17_rk, &
                                        -5.472280907189114683e-17_rk, -9.340887480004114174e-01_rk, 5.005595066479826270e-17_rk,4.312562276675063740e-17_rk, &
                                        -1.515454333419280233e-16_rk, -5.204228816788597768e-17_rk, -3.012359565344131518e-01_rk,-1.588823059896453665e-16_rk, &
                                        -1.312017017981742724e-16_rk, -1.416641782033408390e-17_rk, -5.210819808565244711e-18_rk,-2.502883256857088567e-01_rk, &
                                        1.124227894853038645e+00_rk, 1.459942985065164761e-16_rk, 3.206273577529229348e-16_rk,4.648432563658228078e-17_rk, &
                                        6.235842563021492927e-17_rk, 9.340887480004109733e-01_rk, 1.967921717579625671e-16_rk,5.395241317894537817e-18_rk, &
                                        3.289152604459585449e-17_rk, -4.371467117696843713e-17_rk, 3.012359565344129853e-01_rk,3.077192006585530842e-17_rk, &
                                        -3.069377605366721668e-17_rk, 2.485601568613282936e-17_rk, 7.115363480050264226e-17_rk,2.502883256857086347e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,2) = reshape((/                                                                                 &
                                        1.632862362581208870e-01_rk, 1.274975507232105186e-16_rk, 3.190629033485112850e-17_rk,3.418952563854070477e-17_rk, &
                                        3.897608934104517923e-17_rk, 4.126922267623369667e-01_rk, 4.380211042007708357e-18_rk,2.043049274555040782e-17_rk, &
                                        6.182353441595872208e-17_rk, 1.119398376727436107e-17_rk, 1.632862362581208870e-01_rk,4.449071190866197467e-17_rk, &
                                        7.663234745352910008e-17_rk, 3.122999911060163610e-17_rk, 4.914299365226269681e-17_rk,4.126922267623369667e-01_rk, &
                                        -1.632862362581206650e-01_rk, -3.789817955192108134e-17_rk, -7.078553314382038770e-17_rk,-2.517102517419402608e-17_rk, &
                                        -5.490322192691478350e-17_rk, -4.126922267623368556e-01_rk, -6.862247495754437322e-17_rk,-2.173463685315925281e-18_rk, &
                                        -2.178979642549124660e-17_rk, 1.203877792959908167e-17_rk, -1.632862362581206095e-01_rk,-7.525716176188319598e-17_rk, &
                                        2.583419642139317258e-17_rk, 7.120241889843778635e-18_rk, -1.272022619565083757e-16_rk,-4.126922267623367446e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -9.572315475306059085e-01_rk, -2.803934406093769335e-16_rk, 8.915798683171697294e-17_rk,4.363354517459451285e-17_rk, &
                                        -1.335383034096467329e-16_rk, -2.419322215579066349e+00_rk, 3.187107385224066731e-17_rk,-3.040669400270011680e-19_rk, &
                                        -1.510491090816266197e-16_rk, -4.569726501890927441e-17_rk, -2.564894201304197541e-01_rk,-7.354362343625507521e-17_rk, &
                                        -6.988144355506778639e-17_rk, -7.122589820142799967e-17_rk, -4.610417693268089264e-17_rk,-6.482554338950854422e-01_rk, &
                                        2.564894201304195875e-01_rk, 6.307812769000158476e-17_rk, 1.151655912398137456e-16_rk,-2.050407937109905742e-18_rk, &
                                        6.584982572247858750e-17_rk, 6.482554338950852202e-01_rk, 1.103776337578313678e-16_rk,5.349827364307775277e-17_rk, &
                                        1.092310842702950630e-16_rk, 1.084097357695569798e-16_rk, 6.872613299107291351e-02_rk,4.621636738791401704e-17_rk, &
                                        -7.404008709201700343e-17_rk, 7.289811763839074253e-18_rk, 5.474860652168141589e-17_rk,1.736995200012751150e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,1) = reshape((/                                                                                 &
                                        8.949307280798673991e-02_rk, 1.181609085117960198e-16_rk, 1.080963606989424455e-16_rk,7.670053308658355523e-17_rk, &
                                        2.060080229356084358e-17_rk, 1.531776113688671503e-01_rk, 4.245274515489420404e-17_rk,3.227296020296332472e-17_rk, &
                                        2.191122917232658527e-17_rk, -1.830701634932923896e-17_rk, 3.339926946448663614e-01_rk,1.961515821521195302e-18_rk, &
                                        8.140688168615208066e-17_rk, 3.539506173928568378e-17_rk, 2.591316649851802957e-17_rk,5.716666282106519503e-01_rk, &
                                        -8.949307280798643460e-02_rk, -2.672442652225709055e-17_rk, -1.645963251134488462e-17_rk,-2.795386679410942334e-17_rk, &
                                        -2.672130513661073647e-17_rk, -1.531776113688669283e-01_rk, -2.881921081943108304e-17_rk,7.329143885403646803e-18_rk, &
                                        -4.453692074412807163e-17_rk, -1.616695462566957453e-17_rk, -3.339926946448663614e-01_rk,-1.005605884487269636e-16_rk, &
                                        6.794128454488733778e-18_rk, 1.195346541617666122e-17_rk, -1.895071254417019531e-16_rk,-5.716666282106517283e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -6.093925298920019884e-01_rk, -5.835969390383865593e-17_rk, 3.350331381004511860e-17_rk,-1.611875614367766256e-17_rk, &
                                        1.456441956751968476e-17_rk, -1.105805488835700512e-01_rk, -5.928278799725586242e-18_rk,2.633932648967128075e-17_rk, &
                                        -4.226144134725972818e-17_rk, 1.133978601682638253e-17_rk, -6.093925298920019884e-01_rk,-5.662832350615667361e-17_rk, &
                                        -5.416117074054075309e-17_rk, -5.208904523552608853e-18_rk, 8.316391890735185513e-17_rk,-1.105805488835700512e-01_rk, &
                                        6.093925298920017664e-01_rk, 7.359410339537563324e-17_rk, 1.156871868065807389e-16_rk,5.364053740650514220e-18_rk, &
                                        -2.897862527569847944e-17_rk, 1.105805488835699263e-01_rk, 1.027613477468305554e-16_rk,-8.928593832787363587e-18_rk, &
                                        9.204270845677388666e-17_rk, 4.773735128747982568e-17_rk, 6.093925298920016553e-01_rk,1.779260745864267646e-17_rk, &
                                        8.844778535855433571e-18_rk, 2.025173801392581221e-17_rk, 7.705227250407794227e-17_rk,1.105805488835699124e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -9.572315475306059085e-01_rk, -6.552809961404988718e-17_rk, 3.378446965255091665e-17_rk,-3.777974602106809434e-18_rk, &
                                        -4.443694704870297171e-18_rk, -1.736995200012753648e-01_rk, -1.249440747656214029e-17_rk,-1.119479839892733816e-17_rk, &
                                        -1.721434950853230570e-16_rk, -1.512410516009155552e-18_rk, -3.572436769992004102e+00_rk,-6.977081379265780052e-17_rk, &
                                        -3.172009018183456786e-17_rk, -3.078842305643679911e-17_rk, 5.564237649425592063e-17_rk,-6.482554338950854422e-01_rk, &
                                        2.564894201304195875e-01_rk, 7.765865228410132770e-17_rk, 4.822149789853824160e-17_rk,-3.077916594812906895e-17_rk, &
                                        -3.721492069643871973e-17_rk, 4.654264611001530938e-02_rk, 1.381199113177383325e-16_rk,-3.847739929628321721e-17_rk, &
                                        1.747382079084847076e-16_rk, 1.282974969610054530e-16_rk, 9.572315475306054644e-01_rk,8.366325836167225436e-17_rk, &
                                        -2.957174211401903618e-17_rk, 1.098879230961595730e-17_rk, 2.856325843206355491e-16_rk,1.736995200012751706e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -3.012359565344130963e-01_rk, -1.938415096369655059e-16_rk, -1.142379789133130686e-16_rk,-1.290132412623825358e-16_rk, &
                                        -1.482962514157309046e-17_rk, -2.502883256857088567e-01_rk, -7.066964667918235126e-17_rk,-4.794183945776807272e-17_rk, &
                                        -6.934850904791712226e-17_rk, 4.417348412399896729e-17_rk, -1.124227894853039311e+00_rk,-4.442837190548236701e-17_rk, &
                                        -1.456092636350266518e-16_rk, -7.011582456935229565e-17_rk, 2.713369815071403003e-17_rk,-9.340887480004114174e-01_rk, &
                                        3.012359565344127632e-01_rk, 7.008456969875279265e-17_rk, 4.613319781267697680e-17_rk,2.341819593890512602e-17_rk, &
                                        2.130021534664617443e-17_rk, 2.502883256857085792e-01_rk, 1.428754204003999137e-16_rk,-1.524667655462349686e-17_rk, &
                                        1.754678216989087847e-16_rk, 9.537542669449143632e-17_rk, 1.124227894853038423e+00_rk,1.811937214244108721e-16_rk, &
                                        -1.677532994574359640e-17_rk, -7.804478498466180971e-18_rk, 3.665882797775114166e-16_rk,9.340887480004109733e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.632862362581208870e-01_rk, -1.274975507232105186e-16_rk, -3.190629033485112850e-17_rk,-3.418952563854070477e-17_rk, &
                                        -3.897608934104517923e-17_rk, -4.126922267623369667e-01_rk, -4.380211042007708357e-18_rk,-2.043049274555040782e-17_rk, &
                                        -6.182353441595872208e-17_rk, -1.119398376727436107e-17_rk, -1.632862362581208870e-01_rk,-4.449071190866197467e-17_rk, &
                                        -7.663234745352910008e-17_rk, -3.122999911060163610e-17_rk, -4.914299365226269681e-17_rk,-4.126922267623369667e-01_rk, &
                                        1.632862362581206650e-01_rk, 3.789817955192108134e-17_rk, 7.078553314382038770e-17_rk,2.517102517419402608e-17_rk, &
                                        5.490322192691478350e-17_rk, 4.126922267623368556e-01_rk, 6.862247495754437322e-17_rk,2.173463685315925281e-18_rk, &
                                        2.178979642549124660e-17_rk, -1.203877792959908167e-17_rk, 1.632862362581206095e-01_rk,7.525716176188319598e-17_rk, &
                                        -2.583419642139317258e-17_rk, -7.120241889843778635e-18_rk, 1.272022619565083757e-16_rk,4.126922267623367446e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.564894201304197541e-01_rk, -1.661123672379017965e-16_rk, -1.108510031630677486e-16_rk,-7.307742521149027223e-17_rk, &
                                        -8.722077246082124704e-17_rk, -6.482554338950854422e-01_rk, -2.619717720455698064e-17_rk,-7.027544307256558624e-17_rk, &
                                        -8.613236677783656848e-17_rk, 9.773151829080304172e-18_rk, -9.572315475306059085e-01_rk,1.332390392680992864e-16_rk, &
                                        -1.374133544269386867e-16_rk, -1.025308921698945215e-16_rk, -2.442946072068281760e-17_rk,-2.419322215579066349e+00_rk, &
                                        6.872613299107288576e-02_rk, 5.805892425075968013e-17_rk, 6.798271626566663093e-17_rk,3.220514610779427167e-17_rk, &
                                        6.494981297861138693e-17_rk, 1.736995200012751428e-01_rk, -1.865804212867508501e-17_rk,2.599753460654829305e-17_rk, &
                                        1.083565801771534818e-17_rk, 2.875892139745683976e-17_rk, 2.564894201304195320e-01_rk,1.204562177979497363e-16_rk, &
                                        -8.517514864674035963e-17_rk, -2.264034140726009928e-17_rk, 2.587501696857185873e-16_rk,6.482554338950853312e-01_rk  &
                                        /),(/4,8/))
        
        
        


        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face6_dx
        ! 
        test_dbr2_vol_face6_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -3.339926946448663614e-01_rk, -4.585511373610861489e-17_rk, -3.970042505455316473e-17_rk,2.349699957749482656e-17_rk, &
                                        -1.902565353506435861e-16_rk, -5.716666282106517283e-01_rk, -2.659816248885802820e-17_rk,-1.315724763369927114e-17_rk, &
                                        -1.720904242028650525e-17_rk, -1.234044181597020522e-17_rk, -8.949307280798644848e-02_rk,-4.156826463745660044e-17_rk, &
                                        -3.063580899547723720e-17_rk, -8.236922742485673600e-18_rk, -1.857279162967379742e-17_rk,-1.531776113688669838e-01_rk, &
                                        3.339926946448664724e-01_rk, 3.104726359225783266e-17_rk, -2.694852864180227469e-17_rk,-2.598486365029451269e-17_rk, &
                                        -5.768613348183529880e-18_rk, 5.716666282106519503e-01_rk, 6.823756669624894548e-17_rk,2.210620836731624273e-17_rk, &
                                        1.207323229953132811e-16_rk, 7.736971805957287683e-17_rk, 8.949307280798657338e-02_rk,1.018415489183576949e-16_rk, &
                                        4.170333524595258342e-17_rk, 5.478764117687437967e-17_rk, -1.432705810997898177e-17_rk,1.531776113688671503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -6.093925298920016553e-01_rk, -4.368041365469772144e-17_rk, -1.458273683879924460e-16_rk,-4.145295274530239881e-17_rk, &
                                        -7.855734595177871337e-17_rk, -1.105805488835699263e-01_rk, -2.254299552794817941e-17_rk,-2.171985222612256561e-18_rk, &
                                        -1.171922602542814977e-16_rk, -4.973079174407233220e-17_rk, -6.093925298920016553e-01_rk,-9.364787536599910808e-17_rk, &
                                        -9.728206094999343546e-17_rk, -3.738262020628092946e-18_rk, -6.031556900643483803e-17_rk,-1.105805488835699263e-01_rk, &
                                        6.093925298920019884e-01_rk, 7.730909109078032960e-17_rk, 5.325510826431670112e-17_rk,-2.342173574025529813e-17_rk, &
                                        -1.004767227223436693e-16_rk, 1.105805488835700512e-01_rk, 2.207133531832857313e-17_rk,-2.296346173340513156e-17_rk, &
                                        -3.691493426830062520e-17_rk, 1.943407992823528757e-17_rk, 6.093925298920019884e-01_rk,8.525877758268191880e-17_rk, &
                                        4.423205352024828233e-18_rk, 2.605169626220656451e-17_rk, -3.871891578671739305e-17_rk,1.105805488835700512e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -9.572315475306054644e-01_rk, -7.074030336907668142e-17_rk, -2.122734707668905989e-16_rk,-1.102769157260588283e-16_rk, &
                                        -2.879967481638404439e-16_rk, -1.736995200012752261e-01_rk, 4.327100962088699678e-17_rk,1.068720580428423938e-17_rk, &
                                        -5.058566174174315487e-17_rk, -1.717797796742728048e-17_rk, -2.564894201304195320e-01_rk,-1.077432913467335143e-16_rk, &
                                        -1.273777901431801422e-16_rk, 2.727802586751771544e-17_rk, -2.926793528946255707e-17_rk,-4.654264611001530938e-02_rk, &
                                        3.572436769992004102e+00_rk, 1.290351183046643666e-16_rk, 1.930550712947929770e-16_rk,-8.683260155074598888e-19_rk, &
                                        -8.497254273399640982e-17_rk, 6.482554338950854422e-01_rk, -9.318742169598245113e-18_rk,7.549293250611187877e-18_rk, &
                                        -2.311182531054442521e-17_rk, 2.713628929727551466e-18_rk, 9.572315475306059085e-01_rk,7.749875999403882812e-17_rk, &
                                        1.013024363335727016e-17_rk, 7.035856162552294681e-17_rk, 1.374198112954941391e-17_rk,1.736995200012752538e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,1) = reshape((/                                                                                 &
                                        1.124227894853038423e+00_rk, 1.219384649275212307e-16_rk, 2.034304950681151256e-16_rk,4.491096607219728856e-17_rk, &
                                        3.680870995953945346e-16_rk, 9.340887480004109733e-01_rk, 2.209677951671878307e-17_rk,1.475613952833210541e-17_rk, &
                                        4.763201763056021805e-17_rk, 3.365958956561342309e-17_rk, 3.012359565344128187e-01_rk,9.819139904247315724e-17_rk, &
                                        1.369413316172627679e-16_rk, -4.917951505149655613e-18_rk, 4.322639182080293056e-17_rk,2.502883256857085792e-01_rk, &
                                        -1.124227894853039089e+00_rk, -9.542961274063348990e-17_rk, -1.538856118763294260e-17_rk,5.702502075573914641e-17_rk, &
                                        9.670564969177473071e-17_rk, -9.340887480004114174e-01_rk, -1.109211396220210593e-16_rk,-3.244587193793097168e-17_rk, &
                                        -1.324676129214152857e-16_rk, -1.302830354422310746e-16_rk, -3.012359565344129297e-01_rk,-1.850628458122322645e-16_rk, &
                                        -6.917082686129911001e-17_rk, -1.215740762186908030e-16_rk, 2.921125013317465455e-17_rk,-2.502883256857088567e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.632862362581206095e-01_rk, -2.496781636215352038e-17_rk, -1.209099798346365046e-17_rk,6.984625195980472939e-17_rk, &
                                        -1.290836037661343365e-16_rk, -4.126922267623368556e-01_rk, -2.760747881927609879e-17_rk,-1.200685149722844527e-17_rk, &
                                        -7.266687495344632385e-17_rk, -2.470068972178754204e-17_rk, -1.632862362581206095e-01_rk,-7.421699481056806954e-17_rk, &
                                        -7.045340636531269833e-17_rk, -4.672767349109378931e-17_rk, -6.823203679054477774e-17_rk,-4.126922267623368556e-01_rk, &
                                        1.632862362581208870e-01_rk, 7.859605857917536817e-17_rk, 3.494471187681728551e-17_rk,-8.314322042950053311e-18_rk, &
                                        2.909054643885231033e-17_rk, 4.126922267623369667e-01_rk, 5.986573714112708572e-17_rk,-3.307370577102994838e-20_rk, &
                                        5.209332691814643112e-17_rk, 3.930786115192741429e-17_rk, 1.632862362581208870e-01_rk,1.378327480068984373e-16_rk, &
                                        2.498869232381765275e-18_rk, 1.940522294150049589e-17_rk, -1.726733747436119779e-17_rk,4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -2.564894201304194765e-01_rk, 8.570603958102790164e-17_rk, 4.478716379804299922e-17_rk,7.985838115423470254e-17_rk, &
                                        -2.617053744897246442e-16_rk, -6.482554338950853312e-01_rk, 3.411035760850809319e-17_rk,-1.274553292144811664e-17_rk, &
                                        -7.093792106967274942e-17_rk, -5.141584416033546170e-18_rk, -6.872613299107302454e-02_rk,-1.156927011620533433e-16_rk, &
                                        -2.964215468221939569e-19_rk, -5.199765169235136580e-17_rk, -1.693203615650133832e-17_rk,-1.736995200012751428e-01_rk, &
                                        9.572315475306059085e-01_rk, -9.004839397862513796e-17_rk, -1.220044768898470702e-17_rk,-3.987692738382844702e-17_rk, &
                                        9.009593640170633788e-18_rk, 2.419322215579066349e+00_rk, 1.404571725556124109e-16_rk,9.592075336697485006e-17_rk, &
                                        1.468563817507311308e-16_rk, 1.351746082362258042e-17_rk, 2.564894201304197541e-01_rk,1.492019666836622849e-16_rk, &
                                        2.324197240055088372e-17_rk, 6.141977774208583009e-17_rk, 3.497674209571184113e-17_rk,6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -8.949307280798637909e-02_rk, -6.936965176199527567e-18_rk, -1.599381512206061347e-17_rk,8.463923214940385679e-17_rk, &
                                        -4.708899464641052244e-17_rk, -1.531776113688670671e-01_rk, -2.555115117575157303e-17_rk,-7.678748367386855835e-18_rk, &
                                        -1.340369873846334361e-16_rk, -4.146189876713457338e-17_rk, -3.339926946448663614e-01_rk,-1.066102305127636104e-16_rk, &
                                        -1.120543398514515002e-16_rk, -7.171225470474034458e-17_rk, -1.114262704574193928e-16_rk,-5.716666282106517283e-01_rk, &
                                        8.949307280798657338e-02_rk, 1.205905267354846310e-16_rk, 9.893162154083726687e-17_rk,6.260014089995395157e-18_rk, &
                                        3.069765911027463133e-17_rk, 1.531776113688670948e-01_rk, 3.836669983614298751e-17_rk,-2.771152924886982503e-17_rk, &
                                        -4.153075332418574548e-17_rk, -6.179027483082020151e-18_rk, 3.339926946448664724e-01_rk,1.519237425620851559e-16_rk, &
                                        -3.640726493838603340e-17_rk, -1.566556745141811877e-17_rk, -2.423968383510374001e-17_rk,5.716666282106519503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,2) = reshape((/                                                                                 &
                                        6.093925298920016553e-01_rk, 4.368041365469772144e-17_rk, 1.458273683879924460e-16_rk,4.145295274530239881e-17_rk, &
                                        7.855734595177871337e-17_rk, 1.105805488835699263e-01_rk, 2.254299552794817941e-17_rk,2.171985222612256561e-18_rk, &
                                        1.171922602542814977e-16_rk, 4.973079174407233220e-17_rk, 6.093925298920016553e-01_rk,9.364787536599910808e-17_rk, &
                                        9.728206094999343546e-17_rk, 3.738262020628092946e-18_rk, 6.031556900643483803e-17_rk,1.105805488835699263e-01_rk, &
                                        -6.093925298920019884e-01_rk, -7.730909109078032960e-17_rk, -5.325510826431670112e-17_rk,2.342173574025529813e-17_rk, &
                                        1.004767227223436693e-16_rk, -1.105805488835700512e-01_rk, -2.207133531832857313e-17_rk,2.296346173340513156e-17_rk, &
                                        3.691493426830062520e-17_rk, -1.943407992823528757e-17_rk, -6.093925298920019884e-01_rk,-8.525877758268191880e-17_rk, &
                                        -4.423205352024828233e-18_rk, -2.605169626220656451e-17_rk, 3.871891578671739305e-17_rk,-1.105805488835700512e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -2.564894201304195875e-01_rk, 1.240708606194075731e-18_rk, -8.779562156879128037e-17_rk,7.610886985028181715e-17_rk, &
                                        -3.856157698657323018e-17_rk, -4.654264611001540652e-02_rk, -1.099553937067490808e-16_rk,-1.751302098713272617e-17_rk, &
                                        -2.044758436438390244e-16_rk, -6.092589656557866307e-17_rk, -9.572315475306056864e-01_rk,-2.012227586447469882e-16_rk, &
                                        -2.763726829328915410e-17_rk, -5.601014670420321527e-17_rk, -1.849956539925637258e-16_rk,-1.736995200012751428e-01_rk, &
                                        9.572315475306059085e-01_rk, 9.641449514802149246e-17_rk, 6.532857773605120936e-17_rk,-2.473794962370883246e-17_rk, &
                                        -5.170887553873399138e-17_rk, 1.736995200012752538e-01_rk, -2.385645109645705524e-17_rk,-6.727875552550042714e-17_rk, &
                                        1.186713063502633336e-16_rk, 1.973143581617126002e-17_rk, 3.572436769992004102e+00_rk,2.404395490707030692e-16_rk, &
                                        3.069578227562929676e-18_rk, -7.763687728637898558e-18_rk, -4.656312927517197207e-17_rk,6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,1) = reshape((/                                                                                 &
                                        3.012359565344127077e-01_rk, 1.228996208007395033e-17_rk, 7.247421484992578511e-17_rk,-1.435791720473753121e-16_rk, &
                                        7.674730651223403607e-17_rk, 2.502883256857086902e-01_rk, 8.275405820722760442e-17_rk,1.793392310996133311e-17_rk, &
                                        3.262210294646542546e-16_rk, 1.101582784104140675e-16_rk, 1.124227894853038645e+00_rk,2.395793700038909135e-16_rk, &
                                        1.978819987383099520e-16_rk, 1.241642463588435071e-16_rk, 2.236952462269176186e-16_rk,9.340887480004109733e-01_rk, &
                                        -3.012359565344129297e-01_rk, -2.252845188532126965e-16_rk, -1.591469387635483326e-16_rk,2.688287017219961469e-18_rk, &
                                        2.962970917220910810e-18_rk, -2.502883256857088012e-01_rk, -7.108744609181514979e-17_rk,7.137140577557431334e-17_rk, &
                                        6.902466466482308017e-17_rk, 2.416064876463775899e-18_rk, -1.124227894853039089e+00_rk,-2.922511488631717172e-16_rk, &
                                        5.564962237652965651e-17_rk, 3.060947764336724325e-17_rk, 7.801512181287775773e-17_rk,-9.340887480004114174e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.632862362581206095e-01_rk, 2.496781636215352038e-17_rk, 1.209099798346365046e-17_rk,-6.984625195980472939e-17_rk, &
                                        1.290836037661343365e-16_rk, 4.126922267623368556e-01_rk, 2.760747881927609879e-17_rk,1.200685149722844527e-17_rk, &
                                        7.266687495344632385e-17_rk, 2.470068972178754204e-17_rk, 1.632862362581206095e-01_rk,7.421699481056806954e-17_rk, &
                                        7.045340636531269833e-17_rk, 4.672767349109378931e-17_rk, 6.823203679054477774e-17_rk,4.126922267623368556e-01_rk, &
                                        -1.632862362581208870e-01_rk, -7.859605857917536817e-17_rk, -3.494471187681728551e-17_rk,8.314322042950053311e-18_rk, &
                                        -2.909054643885231033e-17_rk, -4.126922267623369667e-01_rk, -5.986573714112708572e-17_rk,3.307370577102994838e-20_rk, &
                                        -5.209332691814643112e-17_rk, -3.930786115192741429e-17_rk, -1.632862362581208870e-01_rk,-1.378327480068984373e-16_rk, &
                                        -2.498869232381765275e-18_rk, -1.940522294150049589e-17_rk, 1.726733747436119779e-17_rk,-4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -6.872613299107288576e-02_rk, 1.015566024766726316e-18_rk, -5.057179225269618517e-17_rk,2.377688752036769552e-16_rk, &
                                        -6.577758099700377577e-17_rk, -1.736995200012752816e-01_rk, -2.199609883584732563e-17_rk,-8.875061938066268335e-18_rk, &
                                        -1.261945657151361363e-16_rk, -1.833572108750318254e-17_rk, -2.564894201304196431e-01_rk,-2.652416711729935103e-16_rk, &
                                        -1.039721817914198843e-16_rk, -1.193688339013965757e-16_rk, -1.375644401419042934e-16_rk,-6.482554338950852202e-01_rk, &
                                        2.564894201304197541e-01_rk, 1.066169561640962405e-16_rk, 1.531089458693339173e-16_rk,-5.904228331622555538e-17_rk, &
                                        3.867785458753266044e-17_rk, 6.482554338950854422e-01_rk, 6.354418651930586312e-17_rk,1.758036587364043942e-17_rk, &
                                        -6.680451740067163517e-17_rk, -2.496205174325406282e-17_rk, 9.572315475306059085e-01_rk,3.286911409917995780e-16_rk, &
                                        -4.290004832756303952e-17_rk, 8.163042622385613083e-19_rk, 3.310113639959354530e-17_rk,2.419322215579066349e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -8.949307280798637909e-02_rk, 1.272708019973576008e-16_rk, 5.527529825753934721e-17_rk,4.553865463074888877e-17_rk, &
                                        -1.358872138173431169e-16_rk, -1.531776113688671226e-01_rk, 6.998947216277241608e-17_rk,1.075474611260413891e-18_rk, &
                                        -6.696805130732151754e-17_rk, 4.160585065252961343e-18_rk, -2.397959658707972397e-02_rk,-9.959976605194443860e-17_rk, &
                                        1.072000269225636451e-17_rk, -4.356392894658231407e-17_rk, -4.164468121860349802e-18_rk,-4.104381726481626941e-02_rk, &
                                        1.246477705771478872e+00_rk, -1.081709004454442150e-16_rk, 4.351036517594080569e-17_rk,-1.709310830390650315e-17_rk, &
                                        2.398553770829392585e-18_rk, 2.133488901473740373e+00_rk, 8.159035110678005576e-17_rk,8.235449422028918000e-17_rk, &
                                        3.386503807308265001e-17_rk, -6.239497118340583552e-17_rk, 3.339926946448663614e-01_rk,7.076037827851537272e-17_rk, &
                                        -1.511501979407358873e-17_rk, 2.218112894929851937e-17_rk, 5.410846977144547220e-17_rk,5.716666282106519503e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -1.632862362581206372e-01_rk, -5.644025428877722165e-19_rk, -4.520254886929602360e-17_rk,1.970089915762018529e-17_rk, &
                                        -1.293361406702162765e-16_rk, -2.962996877194294665e-02_rk, -1.990960188926570555e-17_rk,-2.173463685315929903e-18_rk, &
                                        -4.518493724402042330e-17_rk, 8.320917843965412049e-21_rk, -1.632862362581206650e-01_rk,-1.030460210488879681e-16_rk, &
                                        -1.403590265378975592e-18_rk, -1.455317420606048722e-17_rk, -7.608886842894966136e-17_rk,-2.962996877194286338e-02_rk, &
                                        2.274283883309887067e+00_rk, 6.621659050582773631e-17_rk, 1.112370315652043395e-16_rk,7.120274371635873933e-18_rk, &
                                        1.346262933467987278e-17_rk, 4.126922267623369667e-01_rk, -4.319131930361524509e-17_rk,-1.506149494367288512e-17_rk, &
                                        9.774998933537061124e-17_rk, -5.145107918925567359e-18_rk, 2.274283883309887067e+00_rk,1.171470363610478082e-16_rk, &
                                        3.980062236366803809e-18_rk, 1.379743810940584956e-17_rk, 1.782432392540848578e-17_rk,4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,3) = reshape((/                                                                                 &
                                        9.572315475306054644e-01_rk, 7.074030336907668142e-17_rk, 2.122734707668905989e-16_rk,1.102769157260588283e-16_rk, &
                                        2.879967481638404439e-16_rk, 1.736995200012752261e-01_rk, -4.327100962088699678e-17_rk,-1.068720580428423938e-17_rk, &
                                        5.058566174174315487e-17_rk, 1.717797796742728048e-17_rk, 2.564894201304195320e-01_rk,1.077432913467335143e-16_rk, &
                                        1.273777901431801422e-16_rk, -2.727802586751771544e-17_rk, 2.926793528946255707e-17_rk,4.654264611001530938e-02_rk, &
                                        -3.572436769992004102e+00_rk, -1.290351183046643666e-16_rk, -1.930550712947929770e-16_rk,8.683260155074598888e-19_rk, &
                                        8.497254273399640982e-17_rk, -6.482554338950854422e-01_rk, 9.318742169598245113e-18_rk,-7.549293250611187877e-18_rk, &
                                        2.311182531054442521e-17_rk, -2.713628929727551466e-18_rk, -9.572315475306059085e-01_rk,-7.749875999403882812e-17_rk, &
                                        -1.013024363335727016e-17_rk, -7.035856162552294681e-17_rk, -1.374198112954941391e-17_rk,-1.736995200012752538e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,1) = reshape((/                                                                                 &
                                        3.012359565344125967e-01_rk, -1.776120452700969192e-16_rk, -4.373162470076067882e-17_rk,-4.901025860449500355e-17_rk, &
                                        3.446868976421639789e-16_rk, 2.502883256857088012e-01_rk, -1.211738015830710377e-16_rk,-6.656925899948799905e-18_rk, &
                                        1.159801120446596668e-16_rk, -7.250098806793986826e-18_rk, 8.071593128461286570e-02_rk,1.958286088110143215e-16_rk, &
                                        6.907832243500508357e-19_rk, 5.553800317451730520e-17_rk, 1.434220950092808082e-17_rk,6.706455474242348225e-02_rk, &
                                        -4.195675622877743649e+00_rk, 9.500470684118748011e-17_rk, -1.737469806852445574e-16_rk,5.259218620697282285e-18_rk, &
                                        -1.905767080927190067e-17_rk, -3.486066666315936313e+00_rk, -9.513124966550759478e-17_rk,-1.232545259734577884e-16_rk, &
                                        -6.857562405296936079e-17_rk, 1.065645722507974005e-16_rk, -1.124227894853039089e+00_rk,-1.279388444639053885e-16_rk, &
                                        2.250445310145146495e-17_rk, -4.868864821200440496e-17_rk, -9.782067918916913940e-17_rk,-9.340887480004114174e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -4.375241514048089364e-02_rk, 8.017650518226566272e-17_rk, 8.408389133431338409e-18_rk,1.323615396805083643e-16_rk, &
                                        -7.939852081008957239e-17_rk, -1.105805488835700651e-01_rk, 3.531965548152937453e-17_rk,-1.757246680687302091e-18_rk, &
                                        -5.283156390975393726e-17_rk, 9.754572836321834383e-18_rk, -4.375241514048096303e-02_rk,-1.682933585923569515e-16_rk, &
                                        4.073951843035395646e-18_rk, -6.236761955903043977e-17_rk, -3.012347478213963656e-17_rk,-1.105805488835699540e-01_rk, &
                                        6.093925298920019884e-01_rk, -6.804818429220263642e-17_rk, 5.476042415941439614e-17_rk,-5.465960335569916175e-17_rk, &
                                        1.268225996658989504e-18_rk, 1.540188358165777593e+00_rk, 7.000556163582460937e-17_rk,7.229013040019726102e-17_rk, &
                                        -1.130727258011035667e-18_rk, -4.659371401802331280e-17_rk, 6.093925298920019884e-01_rk,1.664034534174901453e-16_rk, &
                                        -1.501358905422087748e-17_rk, 2.021549741714262545e-17_rk, 6.060706098531038136e-17_rk,1.540188358165777593e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,3) = reshape((/                                                                                 &
                                        2.564894201304194765e-01_rk, -8.570603958102790164e-17_rk, -4.478716379804299922e-17_rk,-7.985838115423470254e-17_rk, &
                                        2.617053744897246442e-16_rk, 6.482554338950853312e-01_rk, -3.411035760850809319e-17_rk,1.274553292144811664e-17_rk, &
                                        7.093792106967274942e-17_rk, 5.141584416033546170e-18_rk, 6.872613299107302454e-02_rk,1.156927011620533433e-16_rk, &
                                        2.964215468221939569e-19_rk, 5.199765169235136580e-17_rk, 1.693203615650133832e-17_rk,1.736995200012751428e-01_rk, &
                                        -9.572315475306059085e-01_rk, 9.004839397862513796e-17_rk, 1.220044768898470702e-17_rk,3.987692738382844702e-17_rk, &
                                        -9.009593640170633788e-18_rk, -2.419322215579066349e+00_rk, -1.404571725556124109e-16_rk,-9.592075336697485006e-17_rk, &
                                        -1.468563817507311308e-16_rk, -1.351746082362258042e-17_rk, -2.564894201304197541e-01_rk,-1.492019666836622849e-16_rk, &
                                        -2.324197240055088372e-17_rk, -6.141977774208583009e-17_rk, -3.497674209571184113e-17_rk,-6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -2.397959658707955743e-02_rk, 8.221529911516587377e-18_rk, -5.197513369911854884e-17_rk,1.831286134315223157e-16_rk, &
                                        -2.968095057906640815e-17_rk, -4.104381726481638737e-02_rk, -1.505316967927617920e-17_rk,-4.573321563935697698e-18_rk, &
                                        -3.332267471533454163e-17_rk, 1.234252273973444333e-17_rk, -8.949307280798650399e-02_rk,-2.099919936188828100e-16_rk, &
                                        -4.167589507506730076e-18_rk, -6.545574283587185074e-17_rk, -6.518091954041037678e-17_rk,-1.531776113688669838e-01_rk, &
                                        3.339926946448663614e-01_rk, 9.060733002468537529e-18_rk, 7.600548597014561647e-17_rk,-7.364984991111658998e-17_rk, &
                                        3.000203439570691878e-18_rk, 5.716666282106519503e-01_rk, 2.639527778519299525e-17_rk,3.629365318579025197e-17_rk, &
                                        -1.215544905342007816e-17_rk, -1.766757657639599233e-17_rk, 1.246477705771478872e+00_rk,2.390420322091918645e-16_rk, &
                                        -9.320544302441403167e-18_rk, 1.535025085249995730e-17_rk, 5.272350314617801343e-17_rk,2.133488901473740373e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.632862362581206372e-01_rk, 5.644025428877722165e-19_rk, 4.520254886929602360e-17_rk,-1.970089915762018529e-17_rk, &
                                        1.293361406702162765e-16_rk, 2.962996877194294665e-02_rk, 1.990960188926570555e-17_rk,2.173463685315929903e-18_rk, &
                                        4.518493724402042330e-17_rk, -8.320917843965412049e-21_rk, 1.632862362581206650e-01_rk,1.030460210488879681e-16_rk, &
                                        1.403590265378975592e-18_rk, 1.455317420606048722e-17_rk, 7.608886842894966136e-17_rk,2.962996877194286338e-02_rk, &
                                        -2.274283883309887067e+00_rk, -6.621659050582773631e-17_rk, -1.112370315652043395e-16_rk,-7.120274371635873933e-18_rk, &
                                        -1.346262933467987278e-17_rk, -4.126922267623369667e-01_rk, 4.319131930361524509e-17_rk,1.506149494367288512e-17_rk, &
                                        -9.774998933537061124e-17_rk, 5.145107918925567359e-18_rk, -2.274283883309887067e+00_rk,-1.171470363610478082e-16_rk, &
                                        -3.980062236366803809e-18_rk, -1.379743810940584956e-17_rk, -1.782432392540848578e-17_rk,-4.126922267623369667e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,3) = reshape((/                                                                                 &
                                        2.564894201304195875e-01_rk, -1.240708606194075731e-18_rk, 8.779562156879128037e-17_rk,-7.610886985028181715e-17_rk, &
                                        3.856157698657323018e-17_rk, 4.654264611001540652e-02_rk, 1.099553937067490808e-16_rk,1.751302098713272617e-17_rk, &
                                        2.044758436438390244e-16_rk, 6.092589656557866307e-17_rk, 9.572315475306056864e-01_rk,2.012227586447469882e-16_rk, &
                                        2.763726829328915410e-17_rk, 5.601014670420321527e-17_rk, 1.849956539925637258e-16_rk,1.736995200012751428e-01_rk, &
                                        -9.572315475306059085e-01_rk, -9.641449514802149246e-17_rk, -6.532857773605120936e-17_rk,2.473794962370883246e-17_rk, &
                                        5.170887553873399138e-17_rk, -1.736995200012752538e-01_rk, 2.385645109645705524e-17_rk,6.727875552550042714e-17_rk, &
                                        -1.186713063502633336e-16_rk, -1.973143581617126002e-17_rk, -3.572436769992004102e+00_rk,-2.404395490707030692e-16_rk, &
                                        -3.069578227562929676e-18_rk, 7.763687728637898558e-18_rk, 4.656312927517197207e-17_rk,-6.482554338950854422e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,1) = reshape((/                                                                                 &
                                        8.071593128461267141e-02_rk, -1.518851907869323298e-17_rk, 9.987767338215123385e-17_rk,-3.041824957970465095e-16_rk, &
                                        6.597682408408142900e-17_rk, 6.706455474242360715e-02_rk, 6.949959476288265499e-17_rk,1.458019478089894008e-17_rk, &
                                        8.812921094430487031e-17_rk, -1.633697274363219076e-17_rk, 3.012359565344129297e-01_rk,3.851861718796727707e-16_rk, &
                                        -8.161583974121781501e-18_rk, 1.197987330170623815e-16_rk, 1.871684429064652916e-16_rk,2.502883256857085792e-01_rk, &
                                        -1.124227894853039089e+00_rk, -4.257256232788164545e-17_rk, -1.467591385973282481e-16_rk,1.147868638332750269e-16_rk, &
                                        -6.780881240942259963e-18_rk, -9.340887480004114174e-01_rk, -9.812781417016263631e-19_rk,-2.596407809217457915e-17_rk, &
                                        -9.404835242561182982e-17_rk, 1.473785308035802081e-17_rk, -4.195675622877743649e+00_rk,-4.723624285849694156e-16_rk, &
                                        7.044752343884180863e-18_rk, -2.350443587750882527e-17_rk, -7.879503859283646150e-17_rk,-3.486066666315936313e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,2) = reshape((/                                                                                 &
                                        4.375241514048089364e-02_rk, -8.017650518226566272e-17_rk, -8.408389133431338409e-18_rk,-1.323615396805083643e-16_rk, &
                                        7.939852081008957239e-17_rk, 1.105805488835700651e-01_rk, -3.531965548152937453e-17_rk,1.757246680687302091e-18_rk, &
                                        5.283156390975393726e-17_rk, -9.754572836321834383e-18_rk, 4.375241514048096303e-02_rk,1.682933585923569515e-16_rk, &
                                        -4.073951843035395646e-18_rk, 6.236761955903043977e-17_rk, 3.012347478213963656e-17_rk,1.105805488835699540e-01_rk, &
                                        -6.093925298920019884e-01_rk, 6.804818429220263642e-17_rk, -5.476042415941439614e-17_rk,5.465960335569916175e-17_rk, &
                                        -1.268225996658989504e-18_rk, -1.540188358165777593e+00_rk, -7.000556163582460937e-17_rk,-7.229013040019726102e-17_rk, &
                                        1.130727258011035667e-18_rk, 4.659371401802331280e-17_rk, -6.093925298920019884e-01_rk,-1.664034534174901453e-16_rk, &
                                        1.501358905422087748e-17_rk, -2.021549741714262545e-17_rk, -6.060706098531038136e-17_rk,-1.540188358165777593e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,3) = reshape((/                                                                                 &
                                        6.872613299107288576e-02_rk, -1.015566024766726316e-18_rk, 5.057179225269618517e-17_rk,-2.377688752036769552e-16_rk, &
                                        6.577758099700377577e-17_rk, 1.736995200012752816e-01_rk, 2.199609883584732563e-17_rk,8.875061938066268335e-18_rk, &
                                        1.261945657151361363e-16_rk, 1.833572108750318254e-17_rk, 2.564894201304196431e-01_rk,2.652416711729935103e-16_rk, &
                                        1.039721817914198843e-16_rk, 1.193688339013965757e-16_rk, 1.375644401419042934e-16_rk,6.482554338950852202e-01_rk, &
                                        -2.564894201304197541e-01_rk, -1.066169561640962405e-16_rk, -1.531089458693339173e-16_rk,5.904228331622555538e-17_rk, &
                                        -3.867785458753266044e-17_rk, -6.482554338950854422e-01_rk, -6.354418651930586312e-17_rk,-1.758036587364043942e-17_rk, &
                                        6.680451740067163517e-17_rk, 2.496205174325406282e-17_rk, -9.572315475306059085e-01_rk,-3.286911409917995780e-16_rk, &
                                        4.290004832756303952e-17_rk, -8.163042622385613083e-19_rk, -3.310113639959354530e-17_rk,-2.419322215579066349e+00_rk  &
                                        /),(/4,8/))
        
        
        



        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do


    end subroutine testElement_dbr2_vol_dx
    !*******************************************************************************************





    !> Test cartesian dbr2_face_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_face_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_if(),  self%faces(XI_MIN)%basis_s%nnodes_if(),  self%elem%nnodes_r,3) :: test_dbr2_face_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_if(),  self%faces(XI_MAX)%basis_s%nnodes_if(),  self%elem%nnodes_r,3) :: test_dbr2_face_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_if(), self%faces(ETA_MIN)%basis_s%nnodes_if(), self%elem%nnodes_r,3) :: test_dbr2_face_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_if(), self%faces(ETA_MAX)%basis_s%nnodes_if(), self%elem%nnodes_r,3) :: test_dbr2_face_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_if(),self%faces(ZETA_MIN)%basis_s%nnodes_if(),self%elem%nnodes_r,3) :: test_dbr2_face_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_if(),self%faces(ZETA_MAX)%basis_s%nnodes_if(),self%elem%nnodes_r,3) :: test_dbr2_face_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       

        !
        ! dbr2_face_face1_dx
        ! 
        test_dbr2_face_face1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.911964719755678388e+00_rk, 6.667485515161250384e-17_rk, 4.678186590077502645e-17_rk,1.053495465995337865e-16_rk, &
                                        -1.146432955939848966e-16_rk, 5.123094026153318659e-01_rk, 8.554735782711324120e-17_rk,-4.008209295209129918e-17_rk, &
                                        -5.790346846719410458e-18_rk, 2.360715557411719948e-17_rk, 5.123094026153317548e-01_rk,-1.841955309976619409e-17_rk, &
                                        4.904269455351548776e-17_rk, -4.332632602790693748e-17_rk, 1.241793635068731129e-17_rk,1.372728907056486869e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        3.147204850074643012e+00_rk, 1.245775130075368846e-16_rk, -4.020771703101906930e-17_rk,6.302137552513233965e-17_rk, &
                                        -8.435352855808983685e-17_rk, 3.147204850074643012e+00_rk, 3.656846690084013174e-17_rk,4.155156680788044150e-17_rk, &
                                        1.430860005853678788e-16_rk, 1.414685907635822684e-16_rk, 8.432909979928133737e-01_rk,6.490801061006899051e-18_rk, &
                                        1.712802749204017104e-16_rk, 8.823450376762232295e-17_rk, 5.465093185411594580e-17_rk,8.432909979928131516e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        4.943617818168332789e+00_rk, 5.770209958612213904e-17_rk, 1.166912532769272642e-16_rk,7.505525264281855612e-17_rk, &
                                        -1.528571136718507893e-16_rk, 1.324638402066313336e+00_rk, 2.538287775059540243e-16_rk,1.256790127265364672e-17_rk, &
                                        2.774601113770059706e-16_rk, 2.681245684839347167e-17_rk, 4.943617818168332789e+00_rk,3.055062732520094298e-17_rk, &
                                        3.094647287043510749e-16_rk, -1.365729947912285621e-17_rk, 1.816158936598833460e-16_rk,1.324638402066313336e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -6.073299698047447848e+00_rk, -1.671870100263917429e-16_rk, -6.999901787638132289e-17_rk,-1.350030867926287329e-16_rk, &
                                        3.130489860496102138e-16_rk, -1.627335749483994398e+00_rk, -1.617741713517850731e-16_rk,7.583850569796492630e-17_rk, &
                                        -1.550277569062359201e-16_rk, -4.644936901286323066e-17_rk, -1.627335749483994398e+00_rk,3.582691951235188903e-17_rk, &
                                        -2.487313174857324252e-16_rk, 3.018223340346620753e-17_rk, -8.006575882686459682e-17_rk,-4.360432998885319100e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        9.835015156483259968e-01_rk, 3.079484327949352140e-17_rk, 1.784892940393397118e-17_rk,1.083378119364947899e-16_rk, &
                                        -4.852938668502271663e-17_rk, 9.835015156483259968e-01_rk, 1.292832990944551283e-16_rk,1.243934435906862684e-17_rk, &
                                        -5.607893924202565883e-17_rk, 6.549755489625495562e-17_rk, 2.635284368727543458e-01_rk,2.139716050220180677e-17_rk, &
                                        1.834956890519472829e-17_rk, -2.611331458236816357e-18_rk, -2.138193532985771174e-18_rk,2.635284368727542348e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.544880568177604108e+00_rk, 6.214443182817944207e-17_rk, 1.298550045327131063e-16_rk,1.664753190519227558e-16_rk, &
                                        -3.244677403301264806e-17_rk, 4.139495006457231119e-01_rk, 1.479281395275136435e-16_rk,-8.961791846082843617e-17_rk, &
                                        2.106900311586214685e-17_rk, 1.616950903322540543e-16_rk, 1.544880568177604330e+00_rk,-1.017242719273075293e-17_rk, &
                                        9.402823964918374927e-17_rk, -4.359344623315882925e-17_rk, -2.294844549939378087e-17_rk,4.139495006457228898e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        5.123094026153318659e-01_rk, 1.552405050793408794e-17_rk, -2.630477436334229408e-17_rk,9.314740793651782702e-17_rk, &
                                        1.216472801916400123e-17_rk, 1.911964719755678388e+00_rk, 1.419889087603995189e-16_rk,7.116621349103345408e-17_rk, &
                                        -5.449598827146954775e-17_rk, 1.213777018480175371e-16_rk, 1.372728907056491865e-01_rk,5.618413683968654539e-17_rk, &
                                        2.338968617559769377e-17_rk, 6.023176377810007346e-17_rk, -2.827964476959758310e-18_rk,5.123094026153316438e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.147204850074643012e+00_rk, -1.245775130075368846e-16_rk, 4.020771703101906930e-17_rk,-6.302137552513233965e-17_rk, &
                                        8.435352855808983685e-17_rk, -3.147204850074643012e+00_rk, -3.656846690084013174e-17_rk,-4.155156680788044150e-17_rk, &
                                        -1.430860005853678788e-16_rk, -1.414685907635822684e-16_rk, -8.432909979928133737e-01_rk,-6.490801061006899051e-18_rk, &
                                        -1.712802749204017104e-16_rk, -8.823450376762232295e-17_rk, -5.465093185411594580e-17_rk,-8.432909979928131516e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.324638402066313336e+00_rk, 1.376452942395493655e-16_rk, -4.940817112078339513e-17_rk,4.337145927262977299e-16_rk, &
                                        3.055062732520094298e-17_rk, 4.943617818168332789e+00_rk, 6.028819615789836318e-17_rk,2.774601113770059706e-16_rk, &
                                        1.256790127265365904e-17_rk, 2.867577128192612450e-16_rk, 1.324638402066313558e+00_rk,-1.528571136718507647e-16_rk, &
                                        6.304007650730506237e-17_rk, 8.051727786866388586e-17_rk, 6.659527622987278096e-17_rk,4.943617818168332789e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.627335749483994398e+00_rk, -1.179707693445168433e-16_rk, 9.488157358387741878e-17_rk,-2.334157727026790508e-16_rk, &
                                        -5.307770710452098264e-17_rk, -6.073299698047447848e+00_rk, -2.125133067598277348e-16_rk,-1.761892909087891992e-16_rk, &
                                        4.850055210199027429e-17_rk, -3.511447210715739222e-16_rk, -4.360432998885320766e-01_rk,-9.851551896759758234e-17_rk, &
                                        -8.535473501076103101e-17_rk, -1.731315168306720450e-16_rk, -7.216043574772022507e-18_rk,-1.627335749483994620e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -9.835015156483259968e-01_rk, -3.079484327949352140e-17_rk, -1.784892940393397118e-17_rk,-1.083378119364947899e-16_rk, &
                                        4.852938668502271663e-17_rk, -9.835015156483259968e-01_rk, -1.292832990944551283e-16_rk,-1.243934435906862684e-17_rk, &
                                        5.607893924202565883e-17_rk, -6.549755489625495562e-17_rk, -2.635284368727543458e-01_rk,-2.139716050220180677e-17_rk, &
                                        -1.834956890519472829e-17_rk, 2.611331458236816357e-18_rk, 2.138193532985771174e-18_rk,-2.635284368727542348e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        4.139495006457231119e-01_rk, -2.026119894405593846e-17_rk, -1.109302108498391134e-17_rk,1.377686709250413087e-16_rk, &
                                        -1.017242719273074677e-17_rk, 1.544880568177604108e+00_rk, 1.324397052790353295e-16_rk,2.106900311586217150e-17_rk, &
                                        -8.961791846082843617e-17_rk, 1.713039006346583501e-16_rk, 4.139495006457230009e-01_rk,-3.244677403301263573e-17_rk, &
                                        1.122001566372799712e-16_rk, 9.122395071358820193e-17_rk, -1.536246596985017931e-18_rk,1.544880568177604108e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        5.123094026153318659e-01_rk, 9.127163676599508613e-18_rk, 1.110144856385971116e-16_rk,8.547852817066278638e-17_rk, &
                                        5.618413683968652074e-17_rk, 1.372728907056490755e-01_rk, 1.128104505111251384e-16_rk,-5.449598827146954775e-17_rk, &
                                        7.116621349103345408e-17_rk, 1.546510119911400208e-16_rk, 1.911964719755678832e+00_rk,1.216472801916400123e-17_rk, &
                                        9.982844486935186046e-17_rk, -5.721585219975313312e-18_rk, -9.190740171590855183e-18_rk,5.123094026153316438e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        8.432909979928133737e-01_rk, -2.154996176375971088e-19_rk, 8.304145747745265266e-17_rk,2.608715676212441254e-16_rk, &
                                        6.490801061006897511e-18_rk, 8.432909979928133737e-01_rk, 1.634046093698351660e-16_rk,1.430860005853678788e-16_rk, &
                                        4.155156680788044150e-17_rk, 5.815637927150399181e-17_rk, 3.147204850074643012e+00_rk,-8.435352855808982453e-17_rk, &
                                        6.586364937927309483e-17_rk, -4.567011954477132984e-17_rk, 1.033652066201916700e-16_rk,3.147204850074642568e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -4.943617818168332789e+00_rk, -5.770209958612213904e-17_rk, -1.166912532769272642e-16_rk,-7.505525264281855612e-17_rk, &
                                        1.528571136718507893e-16_rk, -1.324638402066313336e+00_rk, -2.538287775059540243e-16_rk,-1.256790127265364672e-17_rk, &
                                        -2.774601113770059706e-16_rk, -2.681245684839347167e-17_rk, -4.943617818168332789e+00_rk,-3.055062732520094298e-17_rk, &
                                        -3.094647287043510749e-16_rk, 1.365729947912285621e-17_rk, -1.816158936598833460e-16_rk,-1.324638402066313336e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.627335749483994398e+00_rk, 9.439469197984172552e-18_rk, -2.554454157029450549e-16_rk,-2.019415222872109395e-16_rk, &
                                        -9.851551896759755769e-17_rk, -4.360432998885324096e-01_rk, -3.391616498508017230e-16_rk,4.850055210199027429e-17_rk, &
                                        -1.761892909087891992e-16_rk, -2.311872619504129979e-16_rk, -6.073299698047447848e+00_rk,-5.307770710452098264e-17_rk, &
                                        -2.291972205792361223e-16_rk, 5.159246793275659100e-17_rk, -8.021528742317314247e-17_rk,-1.627335749483994620e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        2.635284368727543458e-01_rk, -4.131149094784420611e-18_rk, 5.775729746448185254e-17_rk,8.534992770684488560e-17_rk, &
                                        2.139716050220181294e-17_rk, 2.635284368727543458e-01_rk, 4.920441444547948682e-17_rk,-5.607893924202565883e-17_rk, &
                                        1.243934435906862684e-17_rk, 1.464961869317352070e-16_rk, 9.835015156483259968e-01_rk,-4.852938668502271046e-17_rk, &
                                        1.129395057944251677e-16_rk, 3.293385237832083326e-17_rk, -1.344924557590122669e-17_rk,9.835015156483259968e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.544880568177604108e+00_rk, -6.214443182817944207e-17_rk, -1.298550045327131063e-16_rk,-1.664753190519227558e-16_rk, &
                                        3.244677403301264806e-17_rk, -4.139495006457231119e-01_rk, -1.479281395275136435e-16_rk,8.961791846082843617e-17_rk, &
                                        -2.106900311586214685e-17_rk, -1.616950903322540543e-16_rk, -1.544880568177604330e+00_rk,1.017242719273075293e-17_rk, &
                                        -9.402823964918374927e-17_rk, 4.359344623315882925e-17_rk, 2.294844549939378087e-17_rk,-4.139495006457228898e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.372728907056492975e-01_rk, -1.616760410314056944e-17_rk, 6.757186868623690270e-18_rk,1.219441750175725207e-16_rk, &
                                        -1.841955309976620641e-17_rk, 5.123094026153318659e-01_rk, 9.913573256699854723e-18_rk,-5.790346846719413539e-18_rk, &
                                        -4.008209295209129918e-17_rk, 1.072199931153470750e-16_rk, 5.123094026153317548e-01_rk,-1.146432955939848719e-16_rk, &
                                        1.071397250502891942e-16_rk, 5.039668743171245452e-17_rk, 1.141897217711016518e-17_rk,1.911964719755677722e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -8.432909979928133737e-01_rk, 2.154996176375971088e-19_rk, -8.304145747745265266e-17_rk,-2.608715676212441254e-16_rk, &
                                        -6.490801061006897511e-18_rk, -8.432909979928133737e-01_rk, -1.634046093698351660e-16_rk,-1.430860005853678788e-16_rk, &
                                        -4.155156680788044150e-17_rk, -5.815637927150399181e-17_rk, -3.147204850074643012e+00_rk,8.435352855808982453e-17_rk, &
                                        -6.586364937927309483e-17_rk, 4.567011954477132984e-17_rk, -1.033652066201916700e-16_rk,-3.147204850074642568e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.324638402066313336e+00_rk, -1.376452942395493655e-16_rk, 4.940817112078339513e-17_rk,-4.337145927262977299e-16_rk, &
                                        -3.055062732520094298e-17_rk, -4.943617818168332789e+00_rk, -6.028819615789836318e-17_rk,-2.774601113770059706e-16_rk, &
                                        -1.256790127265365904e-17_rk, -2.867577128192612450e-16_rk, -1.324638402066313558e+00_rk,1.528571136718507647e-16_rk, &
                                        -6.304007650730506237e-17_rk, -8.051727786866388586e-17_rk, -6.659527622987278096e-17_rk,-4.943617818168332789e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -4.360432998885321876e-01_rk, 9.084508466266478225e-19_rk, -2.460658763075084046e-17_rk,-4.456132824257052355e-16_rk, &
                                        3.582691951235191368e-17_rk, -1.627335749483994398e+00_rk, -5.616583568565563231e-17_rk,-1.550277569062359201e-16_rk, &
                                        7.583850569796492630e-17_rk, -2.212157398640280160e-16_rk, -1.627335749483994398e+00_rk,3.130489860496102138e-16_rk, &
                                        -1.551502037467675236e-16_rk, -5.392393735648629134e-17_rk, -6.213848990819092393e-17_rk,-6.073299698047446959e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -2.635284368727543458e-01_rk, 4.131149094784420611e-18_rk, -5.775729746448185254e-17_rk,-8.534992770684488560e-17_rk, &
                                        -2.139716050220181294e-17_rk, -2.635284368727543458e-01_rk, -4.920441444547948682e-17_rk,5.607893924202565883e-17_rk, &
                                        -1.243934435906862684e-17_rk, -1.464961869317352070e-16_rk, -9.835015156483259968e-01_rk,4.852938668502271046e-17_rk, &
                                        -1.129395057944251677e-16_rk, -3.293385237832083326e-17_rk, 1.344924557590122669e-17_rk,-9.835015156483259968e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -4.139495006457231119e-01_rk, 2.026119894405593846e-17_rk, 1.109302108498391134e-17_rk,-1.377686709250413087e-16_rk, &
                                        1.017242719273074677e-17_rk, -1.544880568177604108e+00_rk, -1.324397052790353295e-16_rk,-2.106900311586217150e-17_rk, &
                                        8.961791846082843617e-17_rk, -1.713039006346583501e-16_rk, -4.139495006457230009e-01_rk,3.244677403301263573e-17_rk, &
                                        -1.122001566372799712e-16_rk, -9.122395071358820193e-17_rk, 1.536246596985017931e-18_rk,-1.544880568177604108e+00_rk  &
                                        /),(/4,4/))
        
        
        


        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face2_dx
        ! 
        test_dbr2_face_face2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        3.036649849023724368e+00_rk, 1.233779451300017828e-16_rk, 5.050257960879304122e-17_rk,2.694975496429847588e-17_rk, &
                                        8.674608685452170733e-17_rk, 8.136678747419973101e-01_rk, 1.672689711875839617e-17_rk,-8.097237002243262328e-18_rk, &
                                        8.200135792135703968e-17_rk, -3.110655901750348975e-17_rk, 8.136678747419979763e-01_rk,-3.481893488124040377e-18_rk, &
                                        1.009999180830141645e-16_rk, -1.030396735586526081e-17_rk, 9.666183840335987858e-17_rk,2.180216499442663158e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        7.868012125186610861e-01_rk, 9.839451354081318893e-17_rk, -3.353873229063195126e-17_rk,4.595503402943084541e-18_rk, &
                                        4.730807280376265721e-17_rk, 7.868012125186610861e-01_rk, -4.982578699006874397e-17_rk,5.929929951077162705e-18_rk, &
                                        2.129481151305742744e-17_rk, -4.653693567736553345e-18_rk, 2.108227494982035100e-01_rk,1.188581537799737134e-17_rk, &
                                        3.229834571545121474e-17_rk, 3.810379416476949326e-17_rk, 5.767309211610463065e-17_rk,2.108227494982034544e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.235904454542083419e+00_rk, 6.877913999835522495e-17_rk, 2.531422950424077827e-17_rk,-2.293448275636954904e-17_rk, &
                                        1.210702992656575760e-16_rk, 3.311596005165785561e-01_rk, 1.278368589065991103e-17_rk,-1.052827503812738660e-17_rk, &
                                        7.487952409076163990e-17_rk, -1.043717057963991827e-16_rk, 1.235904454542083641e+00_rk,-1.607569230445234216e-18_rk, &
                                        6.810244243441522970e-17_rk, -2.029127491762859942e-17_rk, 1.594898646740611667e-16_rk,3.311596005165786116e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -5.173551594633012840e+00_rk, -2.163239195630344553e-16_rk, -7.565812496694159863e-17_rk,-2.665217846073436169e-17_rk, &
                                        -1.729519484791132255e-16_rk, -1.386248971782662487e+00_rk, -1.574907473303012131e-17_rk,3.618857571504341246e-17_rk, &
                                        -1.414482912366200049e-16_rk, 7.610047812551854711e-17_rk, -1.386248971782662931e+00_rk,1.904588363011374324e-17_rk, &
                                        -1.877616237064845556e-16_rk, 6.873129753038155800e-18_rk, -1.760724107512107233e-16_rk,-3.714442924976389948e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        2.163703334426318570e+00_rk, 2.279035375347560475e-16_rk, 1.661907543862566944e-17_rk,4.298337807093614481e-17_rk, &
                                        5.847459346391083170e-17_rk, 2.163703334426318126e+00_rk, -2.849121845530348550e-17_rk,4.587978656438291313e-17_rk, &
                                        9.166762156518659191e-17_rk, 1.285245136519676432e-17_rk, 5.797625611200594165e-01_rk,5.421569109448011736e-17_rk, &
                                        8.168379571093536140e-17_rk, -5.689913694656350666e-17_rk, 1.091654962774278721e-16_rk,5.797625611200596385e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        3.398737249990730014e+00_rk, 1.799194601969512995e-16_rk, -2.568287735908369198e-17_rk,5.364018677078011438e-17_rk, &
                                        1.815030830801790710e-16_rk, 9.106889014205908905e-01_rk, 5.465178662787466274e-17_rk,9.181030224311093612e-17_rk, &
                                        1.507047486450836407e-16_rk, -8.082797540627107604e-17_rk, 3.398737249990730014e+00_rk,4.366526563032485874e-17_rk, &
                                        1.065927888468152603e-16_rk, -3.816440403502914168e-17_rk, 2.791047400711796825e-16_rk,9.106889014205907795e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        8.136678747419975322e-01_rk, 2.859279037636572792e-16_rk, -3.049430867209131848e-17_rk,4.687263373947937328e-17_rk, &
                                        2.360361827708567059e-17_rk, 3.036649849023724368e+00_rk, -7.696435438832404772e-17_rk,8.714174679479228694e-17_rk, &
                                        7.821217352307962064e-17_rk, 5.172349424844168150e-17_rk, 2.180216499442667044e-01_rk,9.806694796777227231e-17_rk, &
                                        4.498383063101605054e-17_rk, -7.673993838002137757e-17_rk, 1.019427777825109756e-16_rk,8.136678747419975322e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -7.868012125186610861e-01_rk, -9.839451354081318893e-17_rk, 3.353873229063195126e-17_rk,-4.595503402943084541e-18_rk, &
                                        -4.730807280376265721e-17_rk, -7.868012125186610861e-01_rk, 4.982578699006874397e-17_rk,-5.929929951077162705e-18_rk, &
                                        -2.129481151305742744e-17_rk, 4.653693567736553345e-18_rk, -2.108227494982035100e-01_rk,-1.188581537799737134e-17_rk, &
                                        -3.229834571545121474e-17_rk, -3.810379416476949326e-17_rk, -5.767309211610463065e-17_rk,-2.108227494982034544e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        3.311596005165786116e-01_rk, 1.466046997856575411e-16_rk, -6.463231540034542224e-17_rk,9.311417489170343555e-17_rk, &
                                        3.425459180002688242e-17_rk, 1.235904454542083641e+00_rk, -1.107649883620473781e-16_rk,8.724468554373892844e-17_rk, &
                                        3.556686966631973249e-18_rk, 2.199217913332873291e-17_rk, 3.311596005165785561e-01_rk,6.870530922111916398e-17_rk, &
                                        -6.918790592027181747e-18_rk, 7.183492394765235551e-17_rk, 1.041075674998145055e-16_rk,1.235904454542083419e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.386248971782662931e+00_rk, -5.008767849536327803e-16_rk, 9.223132433235232321e-17_rk,-8.499574814333380736e-17_rk, &
                                        -4.838592769852233996e-17_rk, -5.173551594633011952e+00_rk, 1.688878678469795654e-16_rk,-1.570933430060874466e-16_rk, &
                                        -1.160994494307183341e-16_rk, -9.928752437351915690e-17_rk, -3.714442924976390503e-01_rk,-1.701704144325145781e-16_rk, &
                                        -6.427297972331501287e-17_rk, 6.617247851739817035e-17_rk, -1.852993391579312590e-16_rk,-1.386248971782662931e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -2.163703334426318570e+00_rk, -2.279035375347560475e-16_rk, -1.661907543862566944e-17_rk,-4.298337807093614481e-17_rk, &
                                        -5.847459346391083170e-17_rk, -2.163703334426318126e+00_rk, 2.849121845530348550e-17_rk,-4.587978656438291313e-17_rk, &
                                        -9.166762156518659191e-17_rk, -1.285245136519676432e-17_rk, -5.797625611200594165e-01_rk,-5.421569109448011736e-17_rk, &
                                        -8.168379571093536140e-17_rk, 5.689913694656350666e-17_rk, -1.091654962774278721e-16_rk,-5.797625611200596385e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        9.106889014205907795e-01_rk, 3.233914766768466657e-16_rk, -1.623053614945977591e-17_rk,1.359518581356441061e-16_rk, &
                                        5.450196410992231981e-17_rk, 3.398737249990730014e+00_rk, -9.944948776810353671e-17_rk,2.218437149346771829e-16_rk, &
                                        1.093647872978521542e-16_rk, 6.461297212514479644e-17_rk, 9.106889014205908905e-01_rk,9.562484241286489408e-17_rk, &
                                        8.941555817398051417e-17_rk, -6.584950063840162887e-17_rk, 2.106663387057728319e-16_rk,3.398737249990730014e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        8.136678747419975322e-01_rk, 8.096287969723122773e-17_rk, -7.426656607176921559e-17_rk,2.728821805710016187e-17_rk, &
                                        1.273449717342338424e-16_rk, 2.180216499442662603e-01_rk, 4.409559400213123832e-17_rk,1.053501355658815694e-16_rk, &
                                        9.181599047961943156e-17_rk, -7.199613846561912351e-17_rk, 3.036649849023724368e+00_rk,5.025870736225156846e-17_rk, &
                                        2.426961489577384164e-17_rk, -3.391789466918591133e-17_rk, 2.284493993154583608e-16_rk,8.136678747419975322e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        2.108227494982034544e-01_rk, 3.872309751414064037e-17_rk, 8.508061397524821894e-18_rk,4.008227622908011075e-17_rk, &
                                        5.157482398949277164e-17_rk, 2.108227494982035100e-01_rk, -1.255104748554508342e-17_rk,4.290925384186319370e-17_rk, &
                                        2.863923131567607682e-17_rk, -4.779074194425643889e-17_rk, 7.868012125186610861e-01_rk,3.082993258124464275e-17_rk, &
                                        6.652376793067212779e-18_rk, -5.290088052281240880e-18_rk, 1.101382451511070547e-16_rk,7.868012125186610861e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.235904454542083419e+00_rk, -6.877913999835522495e-17_rk, -2.531422950424077827e-17_rk,2.293448275636954904e-17_rk, &
                                        -1.210702992656575760e-16_rk, -3.311596005165785561e-01_rk, -1.278368589065991103e-17_rk,1.052827503812738660e-17_rk, &
                                        -7.487952409076163990e-17_rk, 1.043717057963991827e-16_rk, -1.235904454542083641e+00_rk,1.607569230445234216e-18_rk, &
                                        -6.810244243441522970e-17_rk, 2.029127491762859942e-17_rk, -1.594898646740611667e-16_rk,-3.311596005165786116e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.386248971782662931e+00_rk, -1.345450930458885005e-16_rk, 8.790876605327260569e-17_rk,-3.117251206437552714e-17_rk, &
                                        -2.366669631611012949e-16_rk, -3.714442924976386062e-01_rk, -8.209764334594930052e-17_rk,-1.660970522018460916e-16_rk, &
                                        -1.710446556997135237e-16_rk, 1.606505518187129813e-16_rk, -5.173551594633012840e+00_rk,-8.449198696705716416e-17_rk, &
                                        -4.956837406413995601e-17_rk, 7.369348021214516829e-17_rk, -4.250778128534392641e-16_rk,-1.386248971782662931e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        5.797625611200596385e-01_rk, 9.251415652795531458e-17_rk, -4.330198320558292682e-17_rk,7.771466640009590632e-17_rk, &
                                        9.177088595585184908e-17_rk, 5.797625611200594165e-01_rk, -2.788384717996163311e-20_rk,1.537985624535179902e-16_rk, &
                                        7.389778720654774352e-17_rk, -2.317524306296696869e-17_rk, 2.163703334426318126e+00_rk,3.445914578103117400e-17_rk, &
                                        4.309899355158952267e-17_rk, -9.318171369699309381e-18_rk, 2.026324564057803838e-16_rk,2.163703334426318570e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -3.398737249990730014e+00_rk, -1.799194601969512995e-16_rk, 2.568287735908369198e-17_rk,-5.364018677078011438e-17_rk, &
                                        -1.815030830801790710e-16_rk, -9.106889014205908905e-01_rk, -5.465178662787466274e-17_rk,-9.181030224311093612e-17_rk, &
                                        -1.507047486450836407e-16_rk, 8.082797540627107604e-17_rk, -3.398737249990730014e+00_rk,-4.366526563032485874e-17_rk, &
                                        -1.065927888468152603e-16_rk, 3.816440403502914168e-17_rk, -2.791047400711796825e-16_rk,-9.106889014205907795e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.180216499442663158e-01_rk, 8.489440954766341448e-17_rk, 3.071836603389171035e-18_rk,1.138623173130147881e-16_rk, &
                                        4.036074181052714382e-17_rk, 8.136678747419970881e-01_rk, -4.717586141764091369e-17_rk,1.651891286031275961e-16_rk, &
                                        4.011247233101224305e-17_rk, 2.124311867607254154e-17_rk, 8.136678747419977542e-01_rk,1.548369912625438912e-17_rk, &
                                        5.024541808065106785e-17_rk, 1.687661829984309542e-17_rk, 1.409452127467542878e-16_rk,3.036649849023724368e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -2.108227494982034544e-01_rk, -3.872309751414064037e-17_rk, -8.508061397524821894e-18_rk,-4.008227622908011075e-17_rk, &
                                        -5.157482398949277164e-17_rk, -2.108227494982035100e-01_rk, 1.255104748554508342e-17_rk,-4.290925384186319370e-17_rk, &
                                        -2.863923131567607682e-17_rk, 4.779074194425643889e-17_rk, -7.868012125186610861e-01_rk,-3.082993258124464275e-17_rk, &
                                        -6.652376793067212779e-18_rk, 5.290088052281240880e-18_rk, -1.101382451511070547e-16_rk,-7.868012125186610861e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -3.311596005165786116e-01_rk, -1.466046997856575411e-16_rk, 6.463231540034542224e-17_rk,-9.311417489170343555e-17_rk, &
                                        -3.425459180002688242e-17_rk, -1.235904454542083641e+00_rk, 1.107649883620473781e-16_rk,-8.724468554373892844e-17_rk, &
                                        -3.556686966631973249e-18_rk, -2.199217913332873291e-17_rk, -3.311596005165785561e-01_rk,-6.870530922111916398e-17_rk, &
                                        6.918790592027181747e-18_rk, -7.183492394765235551e-17_rk, -1.041075674998145055e-16_rk,-1.235904454542083419e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -3.714442924976389948e-01_rk, -1.545305481645318349e-16_rk, 2.342763251803942502e-18_rk,-2.244377604102607842e-16_rk, &
                                        -7.235280825523328796e-17_rk, -1.386248971782662487e+00_rk, 1.033967161861538641e-16_rk,-2.781604951712886001e-16_rk, &
                                        -5.598434776081176830e-17_rk, -2.380093334721147164e-17_rk, -1.386248971782662931e+00_rk,-5.093506074848284768e-17_rk, &
                                        -6.583841221447187258e-17_rk, -4.222624178655975283e-17_rk, -2.509185623122886793e-16_rk,-5.173551594633012840e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -5.797625611200596385e-01_rk, -9.251415652795531458e-17_rk, 4.330198320558292682e-17_rk,-7.771466640009590632e-17_rk, &
                                        -9.177088595585184908e-17_rk, -5.797625611200594165e-01_rk, 2.788384717996163311e-20_rk,-1.537985624535179902e-16_rk, &
                                        -7.389778720654774352e-17_rk, 2.317524306296696869e-17_rk, -2.163703334426318126e+00_rk,-3.445914578103117400e-17_rk, &
                                        -4.309899355158952267e-17_rk, 9.318171369699309381e-18_rk, -2.026324564057803838e-16_rk,-2.163703334426318570e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -9.106889014205907795e-01_rk, -3.233914766768466657e-16_rk, 1.623053614945977591e-17_rk,-1.359518581356441061e-16_rk, &
                                        -5.450196410992231981e-17_rk, -3.398737249990730014e+00_rk, 9.944948776810353671e-17_rk,-2.218437149346771829e-16_rk, &
                                        -1.093647872978521542e-16_rk, -6.461297212514479644e-17_rk, -9.106889014205908905e-01_rk,-9.562484241286489408e-17_rk, &
                                        -8.941555817398051417e-17_rk, 6.584950063840162887e-17_rk, -2.106663387057728319e-16_rk,-3.398737249990730014e+00_rk  &
                                        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face3_dx
        ! 
        test_dbr2_face_face3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.735476949445238670e+00_rk, 1.291135411077734768e-16_rk, 1.972973025933609375e-16_rk,8.450842543299583262e-17_rk, &
                                        3.107325492671109028e-16_rk, 2.970466935157309862e+00_rk, 2.413085620553689987e-17_rk,2.357746595346710506e-17_rk, &
                                        9.929013464247691763e-17_rk, -9.277533481555753138e-17_rk, 4.650196470866799769e-01_rk,3.800146108317068197e-17_rk, &
                                        4.628844537517102889e-17_rk, 2.277841714912952590e-16_rk, 2.220128549438469196e-16_rk,7.959342164187530599e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        3.329782706835769712e+00_rk, 1.100769299438725999e-16_rk, 3.112786955736056525e-16_rk,1.470974840750948530e-16_rk, &
                                        2.928535185429214223e-16_rk, 6.042233557575340530e-01_rk, -4.956278877564321482e-18_rk,-3.242308569579805754e-17_rk, &
                                        1.523967801250005663e-16_rk, 2.287487985905891713e-17_rk, 8.922125872677625358e-01_rk,3.580750511383514524e-17_rk, &
                                        5.950969743711161163e-17_rk, 1.233170718591622526e-17_rk, 9.405314571667970898e-17_rk,1.619011602232542368e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        4.973921024792375079e+00_rk, 1.305343563089291694e-16_rk, 6.121694132642480043e-16_rk,1.327999714173065893e-16_rk, &
                                        5.157870740532474799e-16_rk, 9.025691816776050258e-01_rk, -2.767129369293144811e-16_rk,3.575581383560058131e-17_rk, &
                                        3.000441822809345855e-16_rk, 6.961774919848743831e-17_rk, 4.973921024792376855e+00_rk,1.379128510951661888e-16_rk, &
                                        4.078877971525811433e-17_rk, 1.447781901581563201e-17_rk, 8.205148641759484355e-17_rk,9.025691816776051368e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -5.841659499514995524e+00_rk, -2.743838089687569844e-16_rk, -5.673296241128861332e-16_rk,-2.125160871030512711e-16_rk, &
                                        -7.014995638313500379e-16_rk, -4.853667510945340879e+00_rk, 1.541029883445425501e-17_rk,-1.777683606372303780e-17_rk, &
                                        -2.688749695696453259e-16_rk, 1.364752354370574105e-16_rk, -1.565267945352639467e+00_rk,-8.210404707725532422e-17_rk, &
                                        -8.579777429134190768e-17_rk, -3.440828745873586314e-16_rk, -3.775337038421162414e-16_rk,-1.300536289886981667e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        8.922125872677624248e-01_rk, 1.128177206156915333e-16_rk, 9.564160582663279203e-17_rk,8.783338364154855795e-17_rk, &
                                        2.543417620615616455e-16_rk, 2.254992262806881698e+00_rk, 1.010706208522506568e-16_rk,1.151522885541820334e-17_rk, &
                                        9.250032008501750290e-17_rk, -1.085756057273541563e-16_rk, 2.390676422352798758e-01_rk,4.076456759370447208e-17_rk, &
                                        9.525051398449658394e-17_rk, 1.891573162967161862e-16_rk, 2.032558595782625398e-16_rk,6.042233557575340530e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.332758121809299201e+00_rk, 1.193639664092586482e-16_rk, 1.360322708582786179e-16_rk,1.779861106144537067e-17_rk, &
                                        4.751214233143633561e-16_rk, 3.368434043366686836e+00_rk, -6.310303774474894016e-17_rk,1.985567992030195963e-16_rk, &
                                        2.487245408121199244e-16_rk, -5.165863724285770056e-17_rk, 1.332758121809299645e+00_rk,1.307112904959647372e-16_rk, &
                                        5.975631385794026347e-17_rk, 3.144209397803981512e-16_rk, 1.992351018888560988e-16_rk,3.368434043366686836e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        5.784923164817463714e-01_rk, 8.833323815441147716e-17_rk, 3.971651486282489716e-17_rk,9.962060263234414425e-17_rk, &
                                        1.902900615627475746e-16_rk, 9.901556450524362507e-01_rk, 1.456451769045732276e-16_rk,-1.193339050673805004e-17_rk, &
                                        9.401424128890846754e-17_rk, -8.536610538966209014e-17_rk, 1.550065490288933256e-01_rk,3.961025103706231570e-17_rk, &
                                        1.292210494845371240e-16_rk, 9.517950908217913624e-17_rk, 1.445491818547352987e-16_rk,2.653114054729178162e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.329782706835769712e+00_rk, -1.100769299438725999e-16_rk, -3.112786955736056525e-16_rk,-1.470974840750948530e-16_rk, &
                                        -2.928535185429214223e-16_rk, -6.042233557575340530e-01_rk, 4.956278877564321482e-18_rk,3.242308569579805754e-17_rk, &
                                        -1.523967801250005663e-16_rk, -2.287487985905891713e-17_rk, -8.922125872677625358e-01_rk,-3.580750511383514524e-17_rk, &
                                        -5.950969743711161163e-17_rk, -1.233170718591622526e-17_rk, -9.405314571667970898e-17_rk,-1.619011602232542368e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.657973674930791841e+00_rk, 1.138565856584106887e-16_rk, 3.378232923551234600e-16_rk,1.771263807400153941e-16_rk, &
                                        2.574854894420999097e-16_rk, 3.008563938925351566e-01_rk, 3.539240956230069108e-17_rk,-5.578841797072195919e-17_rk, &
                                        1.236051709173231643e-16_rk, 1.431739228709863211e-16_rk, 1.657973674930792285e+00_rk,6.322958056906901785e-17_rk, &
                                        1.389383662014713665e-16_rk, 1.780526835588471096e-18_rk, 1.209310832023509938e-16_rk,3.008563938925351011e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.947219833171665471e+00_rk, -1.844616790235308995e-16_rk, -1.903661993529736664e-16_rk,-2.485769709896599183e-16_rk, &
                                        -4.085440783966036596e-16_rk, -1.617889170315113700e+00_rk, -2.512743707156551464e-16_rk,4.479678306638072787e-17_rk, &
                                        -2.124606838486655256e-16_rk, 8.721387006312696397e-17_rk, -5.217559817842133407e-01_rk,-7.698093952693616245e-17_rk, &
                                        -2.450537447735759408e-16_rk, -1.338971836753882593e-16_rk, -2.727592079975147168e-16_rk,-4.335120966289939815e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -8.922125872677624248e-01_rk, -1.128177206156915333e-16_rk, -9.564160582663279203e-17_rk,-8.783338364154855795e-17_rk, &
                                        -2.543417620615616455e-16_rk, -2.254992262806881698e+00_rk, -1.010706208522506568e-16_rk,-1.151522885541820334e-17_rk, &
                                        -9.250032008501750290e-17_rk, 1.085756057273541563e-16_rk, -2.390676422352798758e-01_rk,-4.076456759370447208e-17_rk, &
                                        -9.525051398449658394e-17_rk, -1.891573162967161862e-16_rk, -2.032558595782625398e-16_rk,-6.042233557575340530e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        4.442527072697662893e-01_rk, 9.756554996766576328e-17_rk, 7.144447320243370296e-17_rk,9.899432169977654496e-17_rk, &
                                        3.163858744539373201e-16_rk, 1.122811347788895464e+00_rk, 1.928009588556493525e-16_rk,-1.741754261567185167e-17_rk, &
                                        1.574864381941380836e-16_rk, -4.208604775365818094e-17_rk, 4.442527072697665114e-01_rk,6.884783252234694571e-17_rk, &
                                        2.594502286938268554e-16_rk, 1.355979684550643287e-16_rk, 1.583999532629504029e-16_rk,1.122811347788895464e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        4.650196470866800880e-01_rk, 1.951447753434036307e-17_rk, 4.337889883313115115e-17_rk,-4.490992561031519415e-17_rk, &
                                        2.802885333873185192e-16_rk, 7.959342164187530599e-01_rk, -1.346591948428534103e-16_rk,1.957538276244925079e-16_rk, &
                                        2.147277065830269094e-16_rk, 4.785337919993962308e-17_rk, 1.735476949445239336e+00_rk,1.239819057732784837e-16_rk, &
                                        2.433970488957358866e-17_rk, 1.130503511977206533e-16_rk, 5.171329616089636538e-18_rk,2.970466935157309862e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        8.922125872677626468e-01_rk, 4.550717590007408645e-17_rk, 2.935054444286613189e-16_rk,5.020775968601429432e-17_rk, &
                                        1.994270848075828235e-16_rk, 1.619011602232541258e-01_rk, -1.486731403224486794e-16_rk,1.966993381136722825e-17_rk, &
                                        1.173067746717472770e-16_rk, 1.125925059755264866e-16_rk, 3.329782706835769712e+00_rk,9.224374394571205181e-17_rk, &
                                        5.490815728467182499e-17_rk, -1.981322750921911532e-18_rk, 3.516957154935692728e-17_rk,6.042233557575340530e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -4.973921024792375079e+00_rk, -1.305343563089291694e-16_rk, -6.121694132642480043e-16_rk,-1.327999714173065893e-16_rk, &
                                        -5.157870740532474799e-16_rk, -9.025691816776050258e-01_rk, 2.767129369293144811e-16_rk,-3.575581383560058131e-17_rk, &
                                        -3.000441822809345855e-16_rk, -6.961774919848743831e-17_rk, -4.973921024792376855e+00_rk,-1.379128510951661888e-16_rk, &
                                        -4.078877971525811433e-17_rk, -1.447781901581563201e-17_rk, -8.205148641759484355e-17_rk,-9.025691816776051368e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.565267945352639245e+00_rk, -4.982852307048779012e-17_rk, -3.012101607228865827e-16_rk,4.211825471295899502e-17_rk, &
                                        -5.849194748634755337e-16_rk, -1.300536289886981667e+00_rk, 3.796698451582674307e-16_rk,-3.262014237638769463e-16_rk, &
                                        -4.369026741361610421e-16_rk, -1.319733695848781818e-16_rk, -5.841659499514995524e+00_rk,-2.675117779421001907e-16_rk, &
                                        -5.006139441422882820e-17_rk, -1.552331455533632066e-16_rk, -1.734497674430303446e-17_rk,-4.853667510945340879e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        2.390676422352797648e-01_rk, 2.528389871999560323e-17_rk, 3.644219174886482675e-17_rk,-1.348069337295722407e-17_rk, &
                                        2.495474336709734438e-16_rk, 6.042233557575338310e-01_rk, -1.850235983808072069e-17_rk,1.038016034400520022e-16_rk, &
                                        1.661016209031588694e-16_rk, 4.889588570420159005e-17_rk, 8.922125872677625358e-01_rk,8.627871587608729266e-17_rk, &
                                        1.079626824730520981e-16_rk, 9.733361862525144466e-17_rk, 2.442168782314792345e-17_rk,2.254992262806881698e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.332758121809299201e+00_rk, -1.193639664092586482e-16_rk, -1.360322708582786179e-16_rk,-1.779861106144537067e-17_rk, &
                                        -4.751214233143633561e-16_rk, -3.368434043366686836e+00_rk, 6.310303774474894016e-17_rk,-1.985567992030195963e-16_rk, &
                                        -2.487245408121199244e-16_rk, 5.165863724285770056e-17_rk, -1.332758121809299645e+00_rk,-1.307112904959647372e-16_rk, &
                                        -5.975631385794026347e-17_rk, -3.144209397803981512e-16_rk, -1.992351018888560988e-16_rk,-3.368434043366686836e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.550065490288931591e-01_rk, 3.425375191206102244e-17_rk, 8.919650125596888027e-17_rk,3.423887931203298187e-17_rk, &
                                        1.900463400710463613e-16_rk, 2.653114054729177607e-01_rk, 6.743161102648003324e-17_rk,-1.540679661332732904e-17_rk, &
                                        9.460271844590542640e-17_rk, 6.206942671202813645e-17_rk, 5.784923164817465935e-01_rk,4.426119638224500940e-17_rk, &
                                        1.715620223705797529e-16_rk, 5.112299953644230243e-17_rk, 4.464016522880380933e-17_rk,9.901556450524364728e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -8.922125872677626468e-01_rk, -4.550717590007408645e-17_rk, -2.935054444286613189e-16_rk,-5.020775968601429432e-17_rk, &
                                        -1.994270848075828235e-16_rk, -1.619011602232541258e-01_rk, 1.486731403224486794e-16_rk,-1.966993381136722825e-17_rk, &
                                        -1.173067746717472770e-16_rk, -1.125925059755264866e-16_rk, -3.329782706835769712e+00_rk,-9.224374394571205181e-17_rk, &
                                        -5.490815728467182499e-17_rk, 1.981322750921911532e-18_rk, -3.516957154935692728e-17_rk,-6.042233557575340530e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.657973674930791841e+00_rk, -1.138565856584106887e-16_rk, -3.378232923551234600e-16_rk,-1.771263807400153941e-16_rk, &
                                        -2.574854894420999097e-16_rk, -3.008563938925351566e-01_rk, -3.539240956230069108e-17_rk,5.578841797072195919e-17_rk, &
                                        -1.236051709173231643e-16_rk, -1.431739228709863211e-16_rk, -1.657973674930792285e+00_rk,-6.322958056906901785e-17_rk, &
                                        -1.389383662014713665e-16_rk, -1.780526835588471096e-18_rk, -1.209310832023509938e-16_rk,-3.008563938925351011e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -5.217559817842130077e-01_rk, -8.825395163578183309e-17_rk, -2.833580742639804346e-16_rk,-9.447347242232053458e-17_rk, &
                                        -3.554954863163305136e-16_rk, -4.335120966289939259e-01_rk, -8.345739166782144125e-17_rk,4.207927108004576637e-17_rk, &
                                        -1.629394051302026754e-16_rk, -1.766534058416381150e-16_rk, -1.947219833171664805e+00_rk,-9.703219727413347599e-17_rk, &
                                        -3.037263860492808181e-16_rk, -7.663256592457534609e-17_rk, -1.011665020095562525e-16_rk,-1.617889170315113700e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -2.390676422352797648e-01_rk, -2.528389871999560323e-17_rk, -3.644219174886482675e-17_rk,1.348069337295722407e-17_rk, &
                                        -2.495474336709734438e-16_rk, -6.042233557575338310e-01_rk, 1.850235983808072069e-17_rk,-1.038016034400520022e-16_rk, &
                                        -1.661016209031588694e-16_rk, -4.889588570420159005e-17_rk, -8.922125872677625358e-01_rk,-8.627871587608729266e-17_rk, &
                                        -1.079626824730520981e-16_rk, -9.733361862525144466e-17_rk, -2.442168782314792345e-17_rk,-2.254992262806881698e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -4.442527072697662893e-01_rk, -9.756554996766576328e-17_rk, -7.144447320243370296e-17_rk,-9.899432169977654496e-17_rk, &
                                        -3.163858744539373201e-16_rk, -1.122811347788895464e+00_rk, -1.928009588556493525e-16_rk,1.741754261567185167e-17_rk, &
                                        -1.574864381941380836e-16_rk, 4.208604775365818094e-17_rk, -4.442527072697665114e-01_rk,-6.884783252234694571e-17_rk, &
                                        -2.594502286938268554e-16_rk, -1.355979684550643287e-16_rk, -1.583999532629504029e-16_rk,-1.122811347788895464e+00_rk  &
                                        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face4_dx
        ! 
        test_dbr2_face_face4_dx(:,:,1,1) = reshape((/                                                                                 &
                                        5.784923164817463714e-01_rk, 9.931589474136603989e-17_rk, 9.327287628410271314e-17_rk,9.283462112655072846e-17_rk, &
                                        4.044491144500523316e-17_rk, 9.901556450524364728e-01_rk, 1.694643954786804956e-16_rk,4.652794032568530080e-17_rk, &
                                        9.297177265881092489e-17_rk, -9.512178346400910850e-17_rk, 1.550065490288931591e-01_rk,3.110058592287940163e-17_rk, &
                                        6.153853577774058211e-17_rk, 7.533550197529417686e-17_rk, 1.849210495524035405e-16_rk,2.653114054729178162e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,1,2) = reshape((/                                                                                 &
                                        3.329782706835769712e+00_rk, 1.119434395698175799e-16_rk, 1.395722705420816503e-16_rk,1.103434591692162554e-16_rk, &
                                        3.388953525800850045e-17_rk, 6.042233557575340530e-01_rk, 6.513017361157701506e-17_rk,4.349347180425347121e-19_rk, &
                                        2.869493301525162778e-16_rk, 3.682098840151777433e-17_rk, 8.922125872677622027e-01_rk,7.031248321340347473e-17_rk, &
                                        -1.561008211664572511e-16_rk, -8.213356237214199389e-18_rk, 1.988552661728545609e-16_rk,1.619011602232541258e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.657973674930792285e+00_rk, 1.063761793116798732e-16_rk, 1.742366303164930537e-16_rk,1.725541506602414790e-16_rk, &
                                        1.161737719868461868e-16_rk, 3.008563938925351011e-01_rk, 1.385820360681554857e-16_rk,1.805551006896267532e-17_rk, &
                                        3.316449244984430271e-16_rk, 1.151693859232403954e-16_rk, 1.657973674930791841e+00_rk,1.425198892889461139e-16_rk, &
                                        2.166505959275930127e-17_rk, -4.058625717162310143e-17_rk, 2.422342191821876266e-16_rk,3.008563938925351566e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.947219833171665249e+00_rk, -2.111924503616401315e-16_rk, -1.806186308764208809e-16_rk,-2.392075076441453494e-16_rk, &
                                        -9.431156390215217582e-17_rk, -1.617889170315113700e+00_rk, -3.029586013191842372e-16_rk,-7.109155691706386623e-17_rk, &
                                        -2.878809534429209849e-16_rk, 1.057295957010323548e-16_rk, -5.217559817842130077e-01_rk,-9.241065364442741060e-17_rk, &
                                        -6.390217939000437115e-17_rk, -1.014499414623743596e-16_rk, -3.383189296462658840e-16_rk,-4.335120966289939815e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,2) = reshape((/                                                                                 &
                                        8.922125872677623137e-01_rk, 1.119459116004310664e-16_rk, 1.461362446195989256e-16_rk,6.228175216269465427e-17_rk, &
                                        1.964452734830359347e-17_rk, 2.254992262806881698e+00_rk, 1.098901530019152226e-16_rk,8.015244725473723689e-17_rk, &
                                        3.438845276796071381e-17_rk, -1.103018870617885614e-16_rk, 2.390676422352795427e-01_rk,5.231913897333380683e-17_rk, &
                                        -1.000122837138118553e-17_rk, 1.380977662877463273e-16_rk, 2.530168806229270086e-16_rk,6.042233557575338310e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,3) = reshape((/                                                                                 &
                                        4.442527072697665114e-01_rk, 1.187784712424475034e-16_rk, 1.493493971106617788e-16_rk,-9.296725731855923524e-18_rk, &
                                        1.406454260992694259e-16_rk, 1.122811347788895464e+00_rk, 2.428749408570230118e-16_rk,1.339268081554342506e-16_rk, &
                                        8.359433911096270949e-17_rk, -1.435752006175871326e-16_rk, 4.442527072697662893e-01_rk,1.127498051542710375e-16_rk, &
                                        1.984665691591771226e-16_rk, 7.930549245765540001e-17_rk, 3.099206532964926375e-16_rk,1.122811347788895464e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,1) = reshape((/                                                                                 &
                                        1.735476949445239336e+00_rk, 1.171071715473568883e-16_rk, 1.876642842867266562e-16_rk,3.918856856782212717e-17_rk, &
                                        9.760758322910603655e-19_rk, 2.970466935157309862e+00_rk, 3.216815502546447931e-17_rk,8.916519536308961748e-17_rk, &
                                        3.454511054493316423e-17_rk, -8.256965036927694971e-17_rk, 4.650196470866798659e-01_rk,7.439565555437186985e-17_rk, &
                                        -1.161803582427183663e-16_rk, 1.562895346947873308e-16_rk, 2.911446471499531152e-16_rk,7.959342164187529489e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.329782706835769712e+00_rk, -1.119434395698175799e-16_rk, -1.395722705420816503e-16_rk,-1.103434591692162554e-16_rk, &
                                        -3.388953525800850045e-17_rk, -6.042233557575340530e-01_rk, -6.513017361157701506e-17_rk,-4.349347180425347121e-19_rk, &
                                        -2.869493301525162778e-16_rk, -3.682098840151777433e-17_rk, -8.922125872677622027e-01_rk,-7.031248321340347473e-17_rk, &
                                        1.561008211664572511e-16_rk, 8.213356237214199389e-18_rk, -1.988552661728545609e-16_rk,-1.619011602232541258e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,3) = reshape((/                                                                                 &
                                        4.973921024792376855e+00_rk, 9.928757083867266511e-17_rk, 3.225082814743899091e-16_rk,4.456007968831197329e-17_rk, &
                                        7.729417520209008581e-17_rk, 9.025691816776051368e-01_rk, 5.245615350163165725e-17_rk,2.012079060610062470e-17_rk, &
                                        5.631169986189136182e-16_rk, 1.461202700776157992e-16_rk, 4.973921024792375079e+00_rk,1.894760983397437766e-16_rk, &
                                        -2.742966306128305932e-16_rk, -2.313009308306799803e-17_rk, 5.278166025578481426e-16_rk,9.025691816776050258e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -5.841659499514995524e+00_rk, -2.487036532094405206e-16_rk, -4.086398355589856049e-16_rk,-9.796313507539943218e-17_rk, &
                                        -1.049003863689895781e-17_rk, -4.853667510945340879e+00_rk, -7.277896009180493150e-17_rk,-1.233413745161833213e-16_rk, &
                                        -2.806336972308523553e-16_rk, 9.853964692075204347e-17_rk, -1.565267945352639245e+00_rk,-1.529667687740247231e-16_rk, &
                                        3.521355799096339085e-16_rk, -2.183845310879643791e-16_rk, -6.095130270726503475e-16_rk,-1.300536289886981667e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -8.922125872677623137e-01_rk, -1.119459116004310664e-16_rk, -1.461362446195989256e-16_rk,-6.228175216269465427e-17_rk, &
                                        -1.964452734830359347e-17_rk, -2.254992262806881698e+00_rk, -1.098901530019152226e-16_rk,-8.015244725473723689e-17_rk, &
                                        -3.438845276796071381e-17_rk, 1.103018870617885614e-16_rk, -2.390676422352795427e-01_rk,-5.231913897333380683e-17_rk, &
                                        1.000122837138118553e-17_rk, -1.380977662877463273e-16_rk, -2.530168806229270086e-16_rk,-6.042233557575338310e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,3) = reshape((/                                                                                 &
                                        1.332758121809299645e+00_rk, 7.757638377528583260e-17_rk, 2.187681446620915957e-16_rk,-5.542898512721023612e-17_rk, &
                                        1.814805747251750725e-16_rk, 3.368434043366686836e+00_rk, 4.640276777644813269e-17_rk,2.864559440474075773e-16_rk, &
                                        8.436364718298131918e-17_rk, -5.576570955974888249e-17_rk, 1.332758121809299201e+00_rk,1.891568986842182128e-16_rk, &
                                        -3.883981412998076666e-17_rk, 1.666401181110924419e-16_rk, 4.807233813702506356e-16_rk,3.368434043366686836e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.550065490288933256e-01_rk, 4.496494802922045092e-17_rk, 9.437057142222434831e-17_rk,-7.629968719774303537e-17_rk, &
                                        1.288922815829535544e-16_rk, 2.653114054729178717e-01_rk, 1.134135463778297627e-16_rk,1.004787007753919756e-16_rk, &
                                        4.807519630660166865e-17_rk, -4.177929628981696062e-17_rk, 5.784923164817461494e-01_rk,1.122484179800196063e-16_rk, &
                                        1.555277786387208555e-16_rk, 3.826373414238850860e-18_rk, 1.861064569487713410e-16_rk,9.901556450524361397e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,2) = reshape((/                                                                                 &
                                        8.922125872677625358e-01_rk, 1.898617023516300493e-17_rk, 1.766653621269845237e-16_rk,2.787575273304248762e-17_rk, &
                                        8.927598524183539441e-17_rk, 1.619011602232542368e-01_rk, 5.648851514585572515e-17_rk,2.386885312755262459e-17_rk, &
                                        2.826738016656346610e-16_rk, 1.295211729237509267e-16_rk, 3.329782706835769268e+00_rk,1.410427268577234751e-16_rk, &
                                        -4.729432069205031008e-18_rk, -3.234973215802033279e-17_rk, 2.913743126747559639e-16_rk,6.042233557575340530e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.657973674930792285e+00_rk, -1.063761793116798732e-16_rk, -1.742366303164930537e-16_rk,-1.725541506602414790e-16_rk, &
                                        -1.161737719868461868e-16_rk, -3.008563938925351011e-01_rk, -1.385820360681554857e-16_rk,-1.805551006896267532e-17_rk, &
                                        -3.316449244984430271e-16_rk, -1.151693859232403954e-16_rk, -1.657973674930791841e+00_rk,-1.425198892889461139e-16_rk, &
                                        -2.166505959275930127e-17_rk, 4.058625717162310143e-17_rk, -2.422342191821876266e-16_rk,-3.008563938925351566e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -5.217559817842133407e-01_rk, -8.610262157778048735e-17_rk, -2.367891204038974330e-16_rk,6.768261575135598750e-17_rk, &
                                        -2.471762306979428060e-16_rk, -4.335120966289940370e-01_rk, -2.199373465342494511e-16_rk,-1.543940818578717934e-16_rk, &
                                        -1.978817946491909868e-16_rk, -8.873241129772549205e-18_rk, -1.947219833171665027e+00_rk,-2.345335427502392910e-16_rk, &
                                        -2.647626065701627592e-16_rk, 2.314976848157554712e-17_rk, -3.993496960830018701e-16_rk,-1.617889170315113478e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,2) = reshape((/                                                                                 &
                                        2.390676422352796537e-01_rk, 1.305747150422779457e-17_rk, 8.821466102828497909e-17_rk,-1.034874194761232561e-16_rk, &
                                        1.854272539702336344e-16_rk, 6.042233557575340530e-01_rk, 7.426975601934074828e-17_rk,1.874715247598933352e-16_rk, &
                                        7.253692223380721078e-17_rk, -1.660247779885357398e-17_rk, 8.922125872677622027e-01_rk,1.398806381005720598e-16_rk, &
                                        1.116227768218438852e-16_rk, 1.847607232733574457e-17_rk, 2.503227447504011967e-16_rk,2.254992262806881698e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -4.442527072697665114e-01_rk, -1.187784712424475034e-16_rk, -1.493493971106617788e-16_rk,9.296725731855923524e-18_rk, &
                                        -1.406454260992694259e-16_rk, -1.122811347788895464e+00_rk, -2.428749408570230118e-16_rk,-1.339268081554342506e-16_rk, &
                                        -8.359433911096270949e-17_rk, 1.435752006175871326e-16_rk, -4.442527072697662893e-01_rk,-1.127498051542710375e-16_rk, &
                                        -1.984665691591771226e-16_rk, -7.930549245765540001e-17_rk, -3.099206532964926375e-16_rk,-1.122811347788895464e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,1) = reshape((/                                                                                 &
                                        4.650196470866801990e-01_rk, -1.828836273725324784e-17_rk, 9.754883788389352879e-17_rk,-9.202592490661592308e-17_rk, &
                                        2.063559546720652000e-16_rk, 7.959342164187530599e-01_rk, 2.587423388788454530e-17_rk,2.224213275504416702e-16_rk, &
                                        1.429414323627257779e-16_rk, 4.499431239379598789e-17_rk, 1.735476949445238226e+00_rk,1.584619427732083524e-16_rk, &
                                        3.215338446999588436e-17_rk, 1.961057818130173654e-17_rk, 3.077600101038320355e-16_rk,2.970466935157309862e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -8.922125872677625358e-01_rk, -1.898617023516300493e-17_rk, -1.766653621269845237e-16_rk,-2.787575273304248762e-17_rk, &
                                        -8.927598524183539441e-17_rk, -1.619011602232542368e-01_rk, -5.648851514585572515e-17_rk,-2.386885312755262459e-17_rk, &
                                        -2.826738016656346610e-16_rk, -1.295211729237509267e-16_rk, -3.329782706835769268e+00_rk,-1.410427268577234751e-16_rk, &
                                        4.729432069205031008e-18_rk, 3.234973215802033279e-17_rk, -2.913743126747559639e-16_rk,-6.042233557575340530e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -4.973921024792376855e+00_rk, -9.928757083867266511e-17_rk, -3.225082814743899091e-16_rk,-4.456007968831197329e-17_rk, &
                                        -7.729417520209008581e-17_rk, -9.025691816776051368e-01_rk, -5.245615350163165725e-17_rk,-2.012079060610062470e-17_rk, &
                                        -5.631169986189136182e-16_rk, -1.461202700776157992e-16_rk, -4.973921024792375079e+00_rk,-1.894760983397437766e-16_rk, &
                                        2.742966306128305932e-16_rk, 2.313009308306799803e-17_rk, -5.278166025578481426e-16_rk,-9.025691816776050258e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.565267945352639467e+00_rk, 2.243029419043021807e-17_rk, -2.752431516628059678e-16_rk,1.352507186836945621e-16_rk, &
                                        -3.519507265425443307e-16_rk, -1.300536289886981667e+00_rk, -5.510115564294940773e-17_rk,-3.390286215940905862e-16_rk, &
                                        -4.555902200248721270e-16_rk, -1.701065384508784886e-16_rk, -5.841659499514994636e+00_rk,-3.420950274137274452e-16_rk, &
                                        3.014351719538766290e-18_rk, -1.307555037810460151e-17_rk, -6.984792854823409074e-16_rk,-4.853667510945340879e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -2.390676422352796537e-01_rk, -1.305747150422779457e-17_rk, -8.821466102828497909e-17_rk,1.034874194761232561e-16_rk, &
                                        -1.854272539702336344e-16_rk, -6.042233557575340530e-01_rk, -7.426975601934074828e-17_rk,-1.874715247598933352e-16_rk, &
                                        -7.253692223380721078e-17_rk, 1.660247779885357398e-17_rk, -8.922125872677622027e-01_rk,-1.398806381005720598e-16_rk, &
                                        -1.116227768218438852e-16_rk, -1.847607232733574457e-17_rk, -2.503227447504011967e-16_rk,-2.254992262806881698e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -1.332758121809299645e+00_rk, -7.757638377528583260e-17_rk, -2.187681446620915957e-16_rk,5.542898512721023612e-17_rk, &
                                        -1.814805747251750725e-16_rk, -3.368434043366686836e+00_rk, -4.640276777644813269e-17_rk,-2.864559440474075773e-16_rk, &
                                        -8.436364718298131918e-17_rk, 5.576570955974888249e-17_rk, -1.332758121809299201e+00_rk,-1.891568986842182128e-16_rk, &
                                        3.883981412998076666e-17_rk, -1.666401181110924419e-16_rk, -4.807233813702506356e-16_rk,-3.368434043366686836e+00_rk  &
                                        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face5_dx
        ! 
        test_dbr2_face_face5_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.735476949445239336e+00_rk, 1.882334482052460860e-16_rk, 1.515759402129451435e-16_rk,-3.159871231602395712e-17_rk, &
                                        3.449633836750080432e-16_rk, 2.970466935157308974e+00_rk, 4.897076841201933144e-17_rk,5.507681684142280077e-17_rk, &
                                        3.140755148398344017e-18_rk, -5.408309050803683247e-17_rk, 4.650196470866800880e-01_rk,6.950791845793963208e-17_rk, &
                                        6.044330239886371688e-17_rk, 2.608117065617095912e-16_rk, 7.724449448805591196e-17_rk,7.959342164187535040e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,1,2) = reshape((/                                                                                 &
                                        3.166496470577649269e+00_rk, 5.121445677867087882e-17_rk, 1.132669550659769444e-16_rk,-2.717815054106712136e-18_rk, &
                                        3.047281877372941472e-16_rk, 5.745933869855912590e-01_rk, -1.170104471125786892e-17_rk,7.524717619405288079e-17_rk, &
                                        9.688312438133714202e-17_rk, 4.215073242109049839e-17_rk, 3.166496470577649269e+00_rk,1.690590129611700736e-17_rk, &
                                        8.127558093709503652e-17_rk, 1.229108512904875750e-18_rk, 4.294288659834103765e-17_rk,5.745933869855912590e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,1,3) = reshape((/                                                                                 &
                                        5.230410444922796387e+00_rk, 5.348910490795084907e-17_rk, 2.885001789109550588e-16_rk,6.998701040352769545e-17_rk, &
                                        5.431861803202043159e-16_rk, 9.491118277876203768e-01_rk, 9.926195013524401817e-17_rk,-1.248507066238025932e-18_rk, &
                                        1.010477252984509178e-16_rk, 7.807555063031251331e-17_rk, 1.401484254800372975e+00_rk,-5.573076571351707694e-18_rk, &
                                        5.269261543968039846e-17_rk, 3.210807469668104761e-17_rk, 7.042436449465801790e-17_rk,2.543137477825196946e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -5.841659499514995524e+00_rk, -3.384342688299028134e-16_rk, -4.113560282925173919e-16_rk,2.526235634668364677e-17_rk, &
                                        -7.874366726232760230e-16_rk, -4.853667510945341768e+00_rk, -9.141744754198245560e-17_rk,-1.047200820298180584e-16_rk, &
                                        1.473747224487745817e-17_rk, 6.383214497561059235e-17_rk, -1.565267945352639467e+00_rk,-1.110913344863453531e-16_rk, &
                                        -1.372755806191780005e-16_rk, -3.979578133886614351e-16_rk, -1.323320594328793622e-16_rk,-1.300536289886981667e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,2) = reshape((/                                                                                 &
                                        8.484601721272816421e-01_rk, 9.517857394583830496e-17_rk, 1.622343869880370864e-17_rk,-1.076008588453903611e-16_rk, &
                                        2.810327491272516763e-16_rk, 2.144411713923311869e+00_rk, 2.789848590335782511e-17_rk,1.115083186644923279e-16_rk, &
                                        1.056555342438547124e-16_rk, -1.325809576542627257e-17_rk, 8.484601721272814201e-01_rk,1.359972924691127532e-16_rk, &
                                        9.511737059552323660e-17_rk, 2.129350029990806195e-16_rk, 1.056590584345798929e-17_rk,2.144411713923311869e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.401484254800372309e+00_rk, 2.230959562728616374e-16_rk, 7.390005561413048786e-17_rk,-2.192714223423669867e-17_rk, &
                                        4.556299143064667089e-16_rk, 3.542133563367961369e+00_rk, 2.008972141733692029e-16_rk,7.782362616356441278e-17_rk, &
                                        4.473307979646044056e-17_rk, -3.087138353848306474e-17_rk, 3.755265742786935146e-01_rk,4.927627532485954148e-17_rk, &
                                        8.082957081893728972e-17_rk, 3.103815421632155532e-16_rk, 1.247126994210451614e-16_rk,9.491118277876203768e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,1) = reshape((/                                                                                 &
                                        4.650196470866801990e-01_rk, -1.485028497561116166e-17_rk, -9.675973369335730170e-17_rk,-1.510785754907615777e-16_rk, &
                                        2.040800606689485197e-16_rk, 7.959342164187530599e-01_rk, -4.604627456814941226e-18_rk,1.517379507776729109e-16_rk, &
                                        1.990018497096344919e-16_rk, 4.184152724009490507e-17_rk, 1.735476949445239336e+00_rk,1.646342446049577116e-16_rk, &
                                        1.201009281265159931e-16_rk, 9.969188159773893948e-17_rk, -4.899330508070273104e-17_rk,2.970466935157309862e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.166496470577649269e+00_rk, -5.121445677867087882e-17_rk, -1.132669550659769444e-16_rk,2.717815054106712136e-18_rk, &
                                        -3.047281877372941472e-16_rk, -5.745933869855912590e-01_rk, 1.170104471125786892e-17_rk,-7.524717619405288079e-17_rk, &
                                        -9.688312438133714202e-17_rk, -4.215073242109049839e-17_rk, -3.166496470577649269e+00_rk,-1.690590129611700736e-17_rk, &
                                        -8.127558093709503652e-17_rk, -1.229108512904875750e-18_rk, -4.294288659834103765e-17_rk,-5.745933869855912590e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.401484254800372753e+00_rk, -3.040224067443347742e-17_rk, -2.528475361990651560e-17_rk,2.194059353690208835e-17_rk, &
                                        1.670764504157911724e-16_rk, 2.543137477825198056e-01_rk, -2.869433073249357099e-17_rk,8.912647184564692939e-17_rk, &
                                        2.906213455825187372e-16_rk, 1.365945697300047944e-16_rk, 5.230410444922796387e+00_rk,-3.347598074952488639e-17_rk, &
                                        1.354223348453814514e-16_rk, -4.087827543089677499e-17_rk, 8.939460183660492570e-17_rk,9.491118277876203768e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.565267945352639467e+00_rk, 2.178905228465384111e-17_rk, 1.805448901517812048e-16_rk,2.393644552949231386e-16_rk, &
                                        -4.071961775554682005e-16_rk, -1.300536289886981667e+00_rk, 4.379149593635332359e-17_rk,-2.920421471122957860e-16_rk, &
                                        -4.339557556763108463e-16_rk, -1.030958108717765751e-16_rk, -5.841659499514995524e+00_rk,-2.461595221667345952e-16_rk, &
                                        -2.300739349834589090e-16_rk, -1.187021803853823295e-16_rk, 3.415505011039430511e-17_rk,-4.853667510945341768e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -8.484601721272816421e-01_rk, -9.517857394583830496e-17_rk, -1.622343869880370864e-17_rk,1.076008588453903611e-16_rk, &
                                        -2.810327491272516763e-16_rk, -2.144411713923311869e+00_rk, -2.789848590335782511e-17_rk,-1.115083186644923279e-16_rk, &
                                        -1.056555342438547124e-16_rk, 1.325809576542627257e-17_rk, -8.484601721272814201e-01_rk,-1.359972924691127532e-16_rk, &
                                        -9.511737059552323660e-17_rk, -2.129350029990806195e-16_rk, -1.056590584345798929e-17_rk,-2.144411713923311869e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,3) = reshape((/                                                                                 &
                                        3.755265742786936256e-01_rk, -8.684616955090996245e-17_rk, -9.900383892355479102e-17_rk,-1.094990425189632836e-16_rk, &
                                        2.770584405941926588e-16_rk, 9.491118277876203768e-01_rk, 1.115384609126525234e-16_rk,1.493015882272010376e-16_rk, &
                                        2.383389401886179609e-16_rk, 7.726116922092710441e-17_rk, 1.401484254800372531e+00_rk,1.717982938908882528e-16_rk, &
                                        2.702458626167468374e-16_rk, 1.015154655405883814e-16_rk, -7.306491232614751901e-17_rk,3.542133563367961369e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,1) = reshape((/                                                                                 &
                                        5.784923164817463714e-01_rk, 6.025282853598193915e-17_rk, -2.760662202681147238e-17_rk,1.875209920277331787e-17_rk, &
                                        2.292820902427568750e-16_rk, 9.901556450524364728e-01_rk, 1.826511468724157759e-16_rk,2.854116409376378166e-17_rk, &
                                        6.057913467832073885e-17_rk, 3.284860833279543908e-17_rk, 1.550065490288934367e-01_rk,-1.729855681137575472e-17_rk, &
                                        3.471048393532727751e-17_rk, 7.838504264431952198e-17_rk, 6.789600711840164735e-17_rk,2.653114054729180382e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,2) = reshape((/                                                                                 &
                                        1.055498823525883090e+00_rk, -3.651690252564779986e-17_rk, 5.430118906644650860e-17_rk,6.124074534896027499e-17_rk, &
                                        1.474390465630547760e-16_rk, 1.915311289951971419e-01_rk, 5.662578651195896567e-17_rk,-1.930232626005925307e-17_rk, &
                                        1.524611503663278562e-16_rk, 9.451251073681601469e-17_rk, 1.055498823525883090e+00_rk,-4.176530327890207272e-17_rk, &
                                        3.848211589231990811e-17_rk, -6.812391707939290689e-18_rk, 5.880102736748972260e-17_rk,1.915311289951971419e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -5.230410444922796387e+00_rk, -5.348910490795084907e-17_rk, -2.885001789109550588e-16_rk,-6.998701040352769545e-17_rk, &
                                        -5.431861803202043159e-16_rk, -9.491118277876203768e-01_rk, -9.926195013524401817e-17_rk,1.248507066238025932e-18_rk, &
                                        -1.010477252984509178e-16_rk, -7.807555063031251331e-17_rk, -1.401484254800372975e+00_rk,5.573076571351707694e-18_rk, &
                                        -5.269261543968039846e-17_rk, -3.210807469668104761e-17_rk, -7.042436449465801790e-17_rk,-2.543137477825196946e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.947219833171665249e+00_rk, -6.239393072152371031e-17_rk, -1.302886532563492248e-17_rk,-6.689891795934927771e-17_rk, &
                                        -4.985021589622774609e-16_rk, -1.617889170315113700e+00_rk, -3.245526744088483253e-16_rk,-1.366402753510160350e-17_rk, &
                                        -1.923782222531484196e-16_rk, -1.004190709798193627e-16_rk, -5.217559817842134517e-01_rk,4.128345490955554678e-17_rk, &
                                        -4.382349880653522181e-17_rk, -1.141301780742497531e-16_rk, -1.353752552860526091e-16_rk,-4.335120966289942035e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,2) = reshape((/                                                                                 &
                                        2.828200573757606584e-01_rk, -8.439265737777917997e-18_rk, -3.220500351481451647e-17_rk,2.393235102466849546e-17_rk, &
                                        1.854111445859838866e-16_rk, 7.148039046411041042e-01_rk, 1.710042424494169995e-16_rk,3.308408361989488815e-17_rk, &
                                        7.455371068267732694e-17_rk, 4.279075056676471181e-17_rk, 2.828200573757605474e-01_rk,4.743149461277718151e-18_rk, &
                                        1.283841919221519786e-16_rk, 4.928677628420293498e-17_rk, 2.231409662018501420e-17_rk,7.148039046411041042e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.401484254800372309e+00_rk, -2.230959562728616374e-16_rk, -7.390005561413048786e-17_rk,2.192714223423669867e-17_rk, &
                                        -4.556299143064667089e-16_rk, -3.542133563367961369e+00_rk, -2.008972141733692029e-16_rk,-7.782362616356441278e-17_rk, &
                                        -4.473307979646044056e-17_rk, 3.087138353848306474e-17_rk, -3.755265742786935146e-01_rk,-4.927627532485954148e-17_rk, &
                                        -8.082957081893728972e-17_rk, -3.103815421632155532e-16_rk, -1.247126994210451614e-16_rk,-9.491118277876203768e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.550065490288934367e-01_rk, -8.335362695220468409e-17_rk, -1.374974724276421548e-17_rk,3.653200562986300235e-17_rk, &
                                        1.199946369579960131e-16_rk, 2.653114054729178162e-01_rk, 1.203084575577494088e-16_rk,2.276013990479700426e-17_rk, &
                                        1.023818313523415899e-16_rk, 6.237735803321198811e-17_rk, 5.784923164817463714e-01_rk,1.522915177761040196e-17_rk, &
                                        1.917672831292701575e-16_rk, 3.343500456602790714e-18_rk, -1.593896944951696034e-17_rk,9.901556450524369168e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -1.055498823525883090e+00_rk, 3.651690252564779986e-17_rk, -5.430118906644650860e-17_rk,-6.124074534896027499e-17_rk, &
                                        -1.474390465630547760e-16_rk, -1.915311289951971419e-01_rk, -5.662578651195896567e-17_rk,1.930232626005925307e-17_rk, &
                                        -1.524611503663278562e-16_rk, -9.451251073681601469e-17_rk, -1.055498823525883090e+00_rk,4.176530327890207272e-17_rk, &
                                        -3.848211589231990811e-17_rk, 6.812391707939290689e-18_rk, -5.880102736748972260e-17_rk,-1.915311289951971419e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.401484254800372753e+00_rk, 3.040224067443347742e-17_rk, 2.528475361990651560e-17_rk,-2.194059353690208835e-17_rk, &
                                        -1.670764504157911724e-16_rk, -2.543137477825198056e-01_rk, 2.869433073249357099e-17_rk,-8.912647184564692939e-17_rk, &
                                        -2.906213455825187372e-16_rk, -1.365945697300047944e-16_rk, -5.230410444922796387e+00_rk,3.347598074952488639e-17_rk, &
                                        -1.354223348453814514e-16_rk, 4.087827543089677499e-17_rk, -8.939460183660492570e-17_rk,-9.491118277876203768e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -5.217559817842134517e-01_rk, 1.445613139045974954e-16_rk, -1.001557140259231991e-18_rk,-9.453272138241265265e-17_rk, &
                                        -1.989760622679879218e-16_rk, -4.335120966289939815e-01_rk, -1.844875411669795044e-16_rk,-3.363495830178716007e-17_rk, &
                                        -2.456963706258139482e-16_rk, -1.628693707158088473e-16_rk, -1.947219833171664360e+00_rk,1.790551083408711646e-17_rk, &
                                        -3.315283681065625291e-16_rk, 6.547299248519850224e-18_rk, -1.801860235574185070e-17_rk,-1.617889170315113700e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -2.828200573757606584e-01_rk, 8.439265737777917997e-18_rk, 3.220500351481451647e-17_rk,-2.393235102466849546e-17_rk, &
                                        -1.854111445859838866e-16_rk, -7.148039046411041042e-01_rk, -1.710042424494169995e-16_rk,-3.308408361989488815e-17_rk, &
                                        -7.455371068267732694e-17_rk, -4.279075056676471181e-17_rk, -2.828200573757605474e-01_rk,-4.743149461277718151e-18_rk, &
                                        -1.283841919221519786e-16_rk, -4.928677628420293498e-17_rk, -2.231409662018501420e-17_rk,-7.148039046411041042e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -3.755265742786936256e-01_rk, 8.684616955090996245e-17_rk, 9.900383892355479102e-17_rk,1.094990425189632836e-16_rk, &
                                        -2.770584405941926588e-16_rk, -9.491118277876203768e-01_rk, -1.115384609126525234e-16_rk,-1.493015882272010376e-16_rk, &
                                        -2.383389401886179609e-16_rk, -7.726116922092710441e-17_rk, -1.401484254800372531e+00_rk,-1.717982938908882528e-16_rk, &
                                        -2.702458626167468374e-16_rk, -1.015154655405883814e-16_rk, 7.306491232614751901e-17_rk,-3.542133563367961369e+00_rk  &
                                        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face6_dx
        ! 
        test_dbr2_face_face6_dx(:,:,1,1) = reshape((/                                                                                 &
                                        5.784923164817463714e-01_rk, 1.074176074798952044e-16_rk, 1.187513918907550834e-16_rk,2.903166376915406945e-17_rk, &
                                        -2.017769852695800725e-17_rk, 9.901556450524364728e-01_rk, 1.745864625671176307e-16_rk,4.057159366478586013e-17_rk, &
                                        -1.407425125225981399e-17_rk, 2.515045469051560957e-18_rk, 1.550065490288932146e-01_rk,-5.135614967110437742e-17_rk, &
                                        1.203084575577493842e-16_rk, 3.899747242943984739e-17_rk, 1.377895180296732146e-16_rk,2.653114054729178717e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.055498823525883090e+00_rk, -1.783584421605672411e-17_rk, 8.403892729541658032e-17_rk,4.209158117017930246e-17_rk, &
                                        6.008106365883814943e-17_rk, 1.915311289951971419e-01_rk, 8.177944250827430921e-17_rk,-5.174538542360576608e-18_rk, &
                                        6.543257976260848384e-17_rk, 7.375389796618938571e-17_rk, 1.055498823525883090e+00_rk,2.397172603067170984e-17_rk, &
                                        5.662578651195895335e-17_rk, -3.268975992316232340e-17_rk, 1.147114225783850007e-16_rk,1.915311289951971419e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,1,3) = reshape((/                                                                                 &
                                        5.230410444922796387e+00_rk, 7.540317667500271762e-17_rk, 2.494433181259625687e-16_rk,1.128426823710266760e-16_rk, &
                                        9.209193686894182424e-17_rk, 9.491118277876202658e-01_rk, 1.090731335085362646e-16_rk,-4.272968172094911174e-17_rk, &
                                        -2.031006593618923774e-17_rk, 3.910796279638928399e-17_rk, 1.401484254800372753e+00_rk,-1.842485464311183239e-17_rk, &
                                        -2.869433073249358331e-17_rk, 4.266336362494485526e-17_rk, 2.290084468046379769e-16_rk,2.543137477825198611e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.947219833171664360e+00_rk, -1.433699425278581407e-16_rk, -2.466147581908360228e-16_rk,-8.627312257578310567e-17_rk, &
                                        -1.109262672296295674e-17_rk, -1.617889170315113700e+00_rk, -3.109911160160828198e-16_rk,-4.409372839670798957e-17_rk, &
                                        -3.953919349539987086e-18_rk, -3.267290502538229329e-17_rk, -5.217559817842132297e-01_rk,6.765893657623098009e-17_rk, &
                                        -1.844875411669795290e-16_rk, -4.725608179646705359e-17_rk, -2.451409094581236142e-16_rk,-4.335120966289940370e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,2) = reshape((/                                                                                 &
                                        2.828200573757605474e-01_rk, 3.056070404698298302e-17_rk, 1.255807606225763950e-16_rk,1.495413039232854238e-17_rk, &
                                        2.709125709502936883e-17_rk, 7.148039046411041042e-01_rk, 1.564087038301538621e-16_rk,7.861315282786507156e-17_rk, &
                                        -3.809070793573259232e-17_rk, -9.566261171546517001e-18_rk, 2.828200573757605474e-01_rk,4.066772976509848978e-17_rk, &
                                        1.710042424494169749e-16_rk, 3.141698601816382662e-17_rk, 1.353959219872510471e-16_rk,7.148039046411041042e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.401484254800372309e+00_rk, 2.783447327605507371e-16_rk, 2.762253308709290699e-16_rk,3.105541054095319379e-17_rk, &
                                        -6.299832094043085959e-17_rk, 3.542133563367961369e+00_rk, 2.291220585572338385e-16_rk,1.811688810673937605e-16_rk, &
                                        -1.068439382292679071e-16_rk, -1.312975610051156387e-16_rk, 3.755265742786936256e-01_rk,-5.223248323984663222e-17_rk, &
                                        1.115384609126525480e-16_rk, 1.327054638099975499e-16_rk, 3.387295852211844293e-16_rk,9.491118277876202658e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,1) = reshape((/                                                                                 &
                                        1.550065490288933812e-01_rk, -6.003052854927990382e-17_rk, 1.139933190042892620e-16_rk,6.437036650211770876e-18_rk, &
                                        8.052524376343974184e-17_rk, 2.653114054729178717e-01_rk, 1.097615943691020485e-16_rk,9.116203952955801792e-17_rk, &
                                        -3.454851072150052749e-17_rk, -8.741506004185217769e-19_rk, 5.784923164817464825e-01_rk,1.259438024302801893e-16_rk, &
                                        1.826511468724157759e-16_rk, 6.248504315633738994e-18_rk, 1.189711280736529278e-16_rk,9.901556450524364728e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.055498823525883090e+00_rk, 1.783584421605672411e-17_rk, -8.403892729541658032e-17_rk,-4.209158117017930246e-17_rk, &
                                        -6.008106365883814943e-17_rk, -1.915311289951971419e-01_rk, -8.177944250827430921e-17_rk,5.174538542360576608e-18_rk, &
                                        -6.543257976260848384e-17_rk, -7.375389796618938571e-17_rk, -1.055498823525883090e+00_rk,-2.397172603067170984e-17_rk, &
                                        -5.662578651195895335e-17_rk, 3.268975992316232340e-17_rk, -1.147114225783850007e-16_rk,-1.915311289951971419e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.401484254800372753e+00_rk, -1.421795168949113553e-17_rk, 8.927845362296225945e-18_rk,4.440192483743434375e-18_rk, &
                                        7.724165189333063485e-17_rk, 2.543137477825198611e-01_rk, 1.358314670783778693e-16_rk,5.728438152250124257e-17_rk, &
                                        3.005673581242870703e-16_rk, 1.493772518046938815e-16_rk, 5.230410444922796387e+00_rk,1.390728655567465579e-16_rk, &
                                        9.926195013524396887e-17_rk, -4.443294693532055219e-17_rk, 3.983396758522252103e-16_rk,9.491118277876202658e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -5.217559817842134517e-01_rk, 9.968823998115156902e-17_rk, -1.990274330621620722e-16_rk,-2.106842181568829436e-17_rk, &
                                        -1.560111071336395284e-16_rk, -4.335120966289940370e-01_rk, -2.053279778065152277e-16_rk,-1.371301937650415919e-16_rk, &
                                        -1.468321149693332053e-17_rk, -6.897324651160418265e-17_rk, -1.947219833171665471e+00_rk,-2.064881826858358689e-16_rk, &
                                        -3.245526744088482760e-16_rk, 2.663236199874226625e-17_rk, -2.761071117416659817e-16_rk,-1.617889170315113700e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -2.828200573757605474e-01_rk, -3.056070404698298302e-17_rk, -1.255807606225763950e-16_rk,-1.495413039232854238e-17_rk, &
                                        -2.709125709502936883e-17_rk, -7.148039046411041042e-01_rk, -1.564087038301538621e-16_rk,-7.861315282786507156e-17_rk, &
                                        3.809070793573259232e-17_rk, 9.566261171546517001e-18_rk, -2.828200573757605474e-01_rk,-4.066772976509848978e-17_rk, &
                                        -1.710042424494169749e-16_rk, -3.141698601816382662e-17_rk, -1.353959219872510471e-16_rk,-7.148039046411041042e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,3) = reshape((/                                                                                 &
                                        3.755265742786936256e-01_rk, -5.419902462441684073e-17_rk, 1.747608466217275281e-16_rk,-6.127740522496448655e-17_rk, &
                                        1.501551623626904436e-16_rk, 9.491118277876202658e-01_rk, 1.951910085218252750e-16_rk,3.386035066014537341e-16_rk, &
                                        2.038727153105470533e-17_rk, -2.119184325436204263e-17_rk, 1.401484254800372309e+00_rk,2.962339496972471775e-16_rk, &
                                        2.008972141733691782e-16_rk, 5.077791906201752650e-17_rk, 2.921423212336048339e-16_rk,3.542133563367961369e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.735476949445239336e+00_rk, 2.039387472891598347e-16_rk, 2.170979364511628286e-16_rk,2.177303717818424514e-17_rk, &
                                        -3.349865681366881062e-17_rk, 2.970466935157309418e+00_rk, 8.894085180352446003e-17_rk,1.479595579891844536e-16_rk, &
                                        -1.041130769848269584e-16_rk, -1.378958091981930960e-16_rk, 4.650196470866803100e-01_rk,-7.728809916901478309e-18_rk, &
                                        -4.604627456814941997e-18_rk, 1.104796983851644187e-16_rk, 2.622282578707774360e-16_rk,7.959342164187530599e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,2) = reshape((/                                                                                 &
                                        3.166496470577649269e+00_rk, 5.678756821859234451e-17_rk, 8.044526399082588090e-17_rk,3.257301592247996910e-17_rk, &
                                        4.772004707318537687e-17_rk, 5.745933869855912590e-01_rk, 7.413166856914037859e-17_rk,1.444034821690315743e-17_rk, &
                                        1.129847537945330922e-16_rk, 4.623951644780686711e-17_rk, 3.166496470577649269e+00_rk,5.283518321376782811e-17_rk, &
                                        -1.170104471125787508e-17_rk, 3.156320819892546525e-17_rk, 2.846707964626567877e-16_rk,5.745933869855912590e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -5.230410444922796387e+00_rk, -7.540317667500271762e-17_rk, -2.494433181259625687e-16_rk,-1.128426823710266760e-16_rk, &
                                        -9.209193686894182424e-17_rk, -9.491118277876202658e-01_rk, -1.090731335085362646e-16_rk,4.272968172094911174e-17_rk, &
                                        2.031006593618923774e-17_rk, -3.910796279638928399e-17_rk, -1.401484254800372753e+00_rk,1.842485464311183239e-17_rk, &
                                        2.869433073249358331e-17_rk, -4.266336362494485526e-17_rk, -2.290084468046379769e-16_rk,-2.543137477825198611e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -5.841659499514995524e+00_rk, -3.660561442922228335e-16_rk, -4.469785549770146458e-16_rk,-8.302732080986590904e-17_rk, &
                                        8.837188464765425677e-18_rk, -4.853667510945341768e+00_rk, -1.589677332350083163e-16_rk,-1.886110467767217668e-16_rk, &
                                        1.902015876335404689e-16_rk, 1.925528850986794155e-16_rk, -1.565267945352639245e+00_rk,3.254088110073045398e-17_rk, &
                                        4.379149593635335441e-17_rk, -2.028513310457775093e-16_rk, -5.226060105179240187e-16_rk,-1.300536289886981667e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,2) = reshape((/                                                                                 &
                                        8.484601721272814201e-01_rk, 1.121348856438129203e-16_rk, 1.615259570337244072e-16_rk,-3.419404976855806372e-17_rk, &
                                        2.839451145148692551e-17_rk, 2.144411713923311869e+00_rk, 1.137173843463070626e-16_rk,2.522842262928309145e-16_rk, &
                                        -1.694931553734372669e-17_rk, -8.751150865659025603e-17_rk, 8.484601721272814201e-01_rk,1.146684282683678369e-16_rk, &
                                        2.789848590335781278e-17_rk, 8.539216341905216540e-17_rk, 2.662296074930991048e-16_rk,2.144411713923311869e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.401484254800372309e+00_rk, -2.783447327605507371e-16_rk, -2.762253308709290699e-16_rk,-3.105541054095319379e-17_rk, &
                                        6.299832094043085959e-17_rk, -3.542133563367961369e+00_rk, -2.291220585572338385e-16_rk,-1.811688810673937605e-16_rk, &
                                        1.068439382292679071e-16_rk, 1.312975610051156387e-16_rk, -3.755265742786936256e-01_rk,5.223248323984663222e-17_rk, &
                                        -1.115384609126525480e-16_rk, -1.327054638099975499e-16_rk, -3.387295852211844293e-16_rk,-9.491118277876202658e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,1) = reshape((/                                                                                 &
                                        4.650196470866801435e-01_rk, -5.250289984753625937e-19_rk, 7.558418433638591046e-17_rk,-7.174498189498223976e-17_rk, &
                                        9.306364676458544322e-17_rk, 7.959342164187530599e-01_rk, 1.213412558972294754e-16_rk,2.823008724293154623e-16_rk, &
                                        1.027451659279112732e-16_rk, 1.033281219520019334e-18_rk, 1.735476949445239114e+00_rk,2.144731996370239491e-16_rk, &
                                        4.897076841201927597e-17_rk, 4.159957053033584474e-17_rk, 2.569267064628792106e-16_rk,2.970466935157309418e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -3.166496470577649269e+00_rk, -5.678756821859234451e-17_rk, -8.044526399082588090e-17_rk,-3.257301592247996910e-17_rk, &
                                        -4.772004707318537687e-17_rk, -5.745933869855912590e-01_rk, -7.413166856914037859e-17_rk,-1.444034821690315743e-17_rk, &
                                        -1.129847537945330922e-16_rk, -4.623951644780686711e-17_rk, -3.166496470577649269e+00_rk,-5.283518321376782811e-17_rk, &
                                        1.170104471125787508e-17_rk, -3.156320819892546525e-17_rk, -2.846707964626567877e-16_rk,-5.745933869855912590e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.401484254800372753e+00_rk, 1.421795168949113553e-17_rk, -8.927845362296225945e-18_rk,-4.440192483743434375e-18_rk, &
                                        -7.724165189333063485e-17_rk, -2.543137477825198611e-01_rk, -1.358314670783778693e-16_rk,-5.728438152250124257e-17_rk, &
                                        -3.005673581242870703e-16_rk, -1.493772518046938815e-16_rk, -5.230410444922796387e+00_rk,-1.390728655567465579e-16_rk, &
                                        -9.926195013524396887e-17_rk, 4.443294693532055219e-17_rk, -3.983396758522252103e-16_rk,-9.491118277876202658e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.565267945352639467e+00_rk, -9.934848933659641751e-19_rk, -7.945001059219931128e-17_rk,1.105596071792945771e-16_rk, &
                                        -1.581801523863941795e-16_rk, -1.300536289886981667e+00_rk, -2.412459229268536416e-16_rk,-4.454891503383501557e-16_rk, &
                                        -3.403697457616137417e-16_rk, -5.929172734827836496e-17_rk, -5.841659499514995524e+00_rk,-3.990271336018099357e-16_rk, &
                                        -9.141744754198239397e-17_rk, -5.690137154842404398e-17_rk, -6.023238026124302304e-16_rk,-4.853667510945341768e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -8.484601721272814201e-01_rk, -1.121348856438129203e-16_rk, -1.615259570337244072e-16_rk,3.419404976855806372e-17_rk, &
                                        -2.839451145148692551e-17_rk, -2.144411713923311869e+00_rk, -1.137173843463070626e-16_rk,-2.522842262928309145e-16_rk, &
                                        1.694931553734372669e-17_rk, 8.751150865659025603e-17_rk, -8.484601721272814201e-01_rk,-1.146684282683678369e-16_rk, &
                                        -2.789848590335781278e-17_rk, -8.539216341905216540e-17_rk, -2.662296074930991048e-16_rk,-2.144411713923311869e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -3.755265742786936256e-01_rk, 5.419902462441684073e-17_rk, -1.747608466217275281e-16_rk,6.127740522496448655e-17_rk, &
                                        -1.501551623626904436e-16_rk, -9.491118277876202658e-01_rk, -1.951910085218252750e-16_rk,-3.386035066014537341e-16_rk, &
                                        -2.038727153105470533e-17_rk, 2.119184325436204263e-17_rk, -1.401484254800372309e+00_rk,-2.962339496972471775e-16_rk, &
                                        -2.008972141733691782e-16_rk, -5.077791906201752650e-17_rk, -2.921423212336048339e-16_rk,-3.542133563367961369e+00_rk  &
                                        /),(/4,4/))
        
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do
    
    
    
    
    
    
    
    
    
    end subroutine testElement_dbr2_face_dx
    !*******************************************************************************************


    !>
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dmetrics_dx_zetamax(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        real(rk)    :: test_dmetric_dx_zetamax(3,3,self%faces(ZETA_MAX)%basis_s%nnodes_if(),self%elem%nnodes_r,3)
        real(rk)    :: tol
        
        integer(ik)     :: inode_diff, idir, inode, irow
        
        tol = 1.e-14_rk
        
        
        test_dmetric_dx_zetamax(:,:,1,1,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 1.814663157560373372e-17_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.412928223397790205e-34_rk, 4.396293210175144752e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.155250446289920996e-17_rk, 7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.206464111698897241e-34_rk, 2.198146605087573609e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,1,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, -1.899062337165527671e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.632101532570580464e-18_rk, &
                                        0.000000000000000000e+00_rk, 1.814663157560373372e-17_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.862375276028130239e-18_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.718338938578192433e-34_rk, 1.177983215356857940e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.095484241390784422e-18_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.591694692890965372e-35_rk, 5.889916076784292781e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.961736132466737216e-33_rk, -5.088522196198633938e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, -2.312964634635742664e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.862375276028131010e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,1) = reshape((/                                                                                 &
                                        -3.081487911019577365e-33_rk, 4.862375276028130239e-18_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.718338938578192433e-34_rk, 1.177983215356857940e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.095484241390784422e-18_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.591694692890965372e-35_rk, 5.889916076784292781e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.961736132466737216e-33_rk, -5.088522196198633938e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, -2.312964634635742664e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.862375276028131010e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 1.302869528508794360e-18_rk, 8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,2) = reshape((/                                                                                 &
                                        -2.452170165583421520e-34_rk, 4.604275309149788320e-35_rk, 3.156396512522872000e-18_rk, &
                                        0.000000000000000000e+00_rk, 8.294325026639264780e-19_rk, 5.686058463052615780e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.302137654574895496e-35_rk, 1.578198256261436770e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 4.904340331166843040e-34_rk, -1.363465413139267668e-17_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, -6.197570059723943330e-19_rk, &
                                        0.000000000000000000e+00_rk, 1.302869528508795708e-18_rk, 8.931639747704094023e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,1) = reshape((/                                                                                 &
                                        1.577350269189629728e+00_rk, 8.289868374653944771e-01_rk, -1.244016935856292694e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.397406792245191820e-01_rk, -8.011868568650901149e-32_rk, &
                                        0.000000000000000000e+00_rk, 8.028193616584889848e-18_rk, 6.661338147750939243e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 2.929597740857995717e-17_rk, -4.396293210175149067e-17_rk, &
                                        1.004172369315441626e+00_rk, 5.277494117629406567e-01_rk, -7.919657785262490535e-01_rk, &
                                        2.787138212765998958e-17_rk, 1.464798870428998475e-17_rk, 2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,3) = reshape((/                                                                                 &
                                        -4.440892098500626162e-16_rk, -1.265495376839751228e-16_rk, 1.899062337165541723e-16_rk, &
                                        -1.094506616720631042e-17_rk, 0.000000000000000000e+00_rk, 8.632101532570643635e-18_rk, &
                                        1.577350269189624399e+00_rk, 8.289868374653949212e-01_rk, -1.244016935856302020e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,1) = reshape((/                                                                                 &
                                        -1.577350269189629950e+00_rk, 2.221263536348839773e-01_rk, -3.333333333333330928e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.446230791204398958e-01_rk, 8.320017359752858885e-32_rk, &
                                        0.000000000000000000e+00_rk, 8.482044460251395826e-16_rk, -7.105427357601001859e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 7.849833488109454348e-18_rk, -1.177983215356857016e-17_rk, &
                                        -1.004172369315441626e+00_rk, 1.414100286878807455e-01_rk, -2.122065907891936276e-01_rk, &
                                        -2.787138212765998958e-17_rk, 3.924916744054727944e-18_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, -3.390884642495298948e-17_rk, 5.088522196198564297e-17_rk, &
                                        1.094506616720631042e-17_rk, 0.000000000000000000e+00_rk, 2.312964634635711079e-18_rk, &
                                        -1.577350269189624399e+00_rk, 2.221263536348823953e-01_rk, -3.333333333333287629e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,1) = reshape((/                                                                                 &
                                        4.226497308103744910e-01_rk, -8.289868374653945882e-01_rk, -3.333333333333334259e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.446230791204374255e-01_rk, 1.155557966632341512e-32_rk, &
                                        0.000000000000000000e+00_rk, -8.730764016888194944e-16_rk, -1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, -2.929597740857996334e-17_rk, -1.177983215356853780e-17_rk, &
                                        2.690671754197210830e-01_rk, -5.277494117629406567e-01_rk, -2.122065907891937941e-01_rk, &
                                        7.468114333045759404e-18_rk, -1.464798870428998475e-17_rk, -2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, 1.265495376839748762e-16_rk, 5.088522196198647497e-17_rk, &
                                        -2.932721640608149419e-18_rk, 0.000000000000000000e+00_rk, 2.312964634635748827e-18_rk, &
                                        4.226497308103761008e-01_rk, -8.289868374653931449e-01_rk, -3.333333333333342030e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,1) = reshape((/                                                                                 &
                                        -4.226497308103746020e-01_rk, -2.221263536348840606e-01_rk, -8.931639747704077370e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.875163725722260283e-02_rk, -1.001483571081362644e-32_rk, &
                                        0.000000000000000000e+00_rk, -7.240818802659196119e-18_rk, 1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, -7.849833488109455889e-18_rk, -3.156396512522870074e-18_rk, &
                                        -2.690671754197210830e-01_rk, -1.414100286878807178e-01_rk, -5.686058463052611617e-02_rk, &
                                        -7.468114333045759404e-18_rk, -3.924916744054728715e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 3.390884642495312507e-17_rk, 1.363465413139261042e-17_rk, &
                                        2.932721640608149419e-18_rk, 0.000000000000000000e+00_rk, 6.197570059723913479e-19_rk, &
                                        -4.226497308103761008e-01_rk, -2.221263536348832834e-01_rk, -8.931639747704051002e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 1.850371707708594131e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,1) = reshape((/                                                                                 &
                                        -3.081487911019577365e-33_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.761451541109629564e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.905681226056464371e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,1) = reshape((/                                                                                 &
                                        -3.081487911019577365e-33_rk, 0.000000000000000000e+00_rk, 8.931639747704082921e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.761451541109629564e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.686058463052615086e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 4.958056047779155435e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.761451541109629564e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 1.850371707708594131e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,1) = reshape((/                                                                                 &
                                        1.577350269189629062e+00_rk, 1.504281969462680779e-01_rk, -3.333333333333332038e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.632785136822774708e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.322354824923294315e-16_rk, 6.217248937900876626e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, 1.961736132466737216e-33_rk, &
                                        1.004172369315441848e+00_rk, 9.576556449759883460e-02_rk, -2.122065907891937386e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 8.350442390129762627e-18_rk, -1.850371707708644668e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.577350269189624621e+00_rk, 1.504281969462687440e-01_rk, -3.333333333333424187e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,1) = reshape((/                                                                                 &
                                        -1.577350269189629284e+00_rk, 5.614056738944469549e-01_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.475389112631104505e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.217248937900876626e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,2) = reshape((/                                                                                 &
                                        -5.654319433712918851e-16_rk, 0.000000000000000000e+00_rk, 7.846944529866948863e-33_rk, &
                                        -1.004172369315441848e+00_rk, 3.574019523205512749e-01_rk, -7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.413579858428229713e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.116427526564086536e-17_rk, -6.905681226056439720e-17_rk, &
                                        0.000000000000000000e+00_rk, 7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.577350269189624621e+00_rk, 5.614056738944470659e-01_rk, -1.244016935856288475e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,1) = reshape((/                                                                                 &
                                        4.226497308103743800e-01_rk, -1.504281969462680779e-01_rk, -8.931639747704080146e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.777249420980925657e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.443289932012703503e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, -1.961736132466737216e-33_rk, &
                                        2.690671754197211385e-01_rk, -9.576556449759883460e-02_rk, -5.686058463052613005e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.533949646070574282e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, -8.350442390129693293e-18_rk, -4.958056047779207050e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 0.000000000000000000e+00_rk, &
                                        4.226497308103761563e-01_rk, -1.504281969462675228e-01_rk, -8.931639747704188392e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,1) = reshape((/                                                                                 &
                                        -4.226497308103741579e-01_rk, -5.614056738944469549e-01_rk, -3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.632785136822895444e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.927207648365589221e-16_rk, 1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,2) = reshape((/                                                                                 &
                                        5.654319433712918851e-16_rk, 0.000000000000000000e+00_rk, -7.846944529866948863e-33_rk, &
                                        -2.690671754197211385e-01_rk, -3.574019523205512749e-01_rk, -2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.413579858428229713e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, -3.116427526564090234e-17_rk, -1.850371707708591666e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -4.226497308103761563e-01_rk, -5.614056738944476210e-01_rk, -3.333333333333328707e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,1) = reshape((/                                                                                 &
                                        -3.081487911019577365e-33_rk, 4.862375276028130239e-18_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.718338938578192433e-34_rk, 1.177983215356858094e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.095484241390784422e-18_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.591694692890965372e-35_rk, 5.889916076784292781e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.961736132466737216e-33_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 9.251858538542970657e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.862375276028131010e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 1.302869528508794360e-18_rk, 8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,2) = reshape((/                                                                                 &
                                        -2.452170165583421520e-34_rk, 4.604275309149788320e-35_rk, 3.156396512522872385e-18_rk, &
                                        0.000000000000000000e+00_rk, 8.294325026639264780e-19_rk, 5.686058463052615780e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.302137654574895496e-35_rk, 1.578198256261436770e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 4.904340331166843040e-34_rk, 1.487416814333746939e-17_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 2.479028023889577717e-18_rk, &
                                        0.000000000000000000e+00_rk, 1.302869528508796093e-18_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,1) = reshape((/                                                                                 &
                                        3.081487911019577365e-33_rk, 1.814663157560373372e-17_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.021145212438530645e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.671203512365198051e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.412928223397790205e-34_rk, 4.396293210175144752e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.155250446289920996e-17_rk, 7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.206464111698897241e-34_rk, 2.198146605087573609e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, 7.846944529866948863e-33_rk, 2.071704367816939928e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.413579858428229713e-16_rk, 3.452840613028232186e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.814663157560373989e-17_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.862375276028130239e-18_rk, 3.333333333333333148e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.718338938578192433e-34_rk, 1.177983215356858094e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.095484241390784422e-18_rk, 2.122065907891937664e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.591694692890965372e-35_rk, 5.889916076784292781e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 1.961736132466737216e-33_rk, 5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 9.251858538542970657e-18_rk, &
                                        0.000000000000000000e+00_rk, 4.862375276028131010e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,1) = reshape((/                                                                                 &
                                        4.226497308103744910e-01_rk, 8.289868374653945882e-01_rk, -3.333333333333332038e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.446230791204374255e-01_rk, -4.622231866529366047e-32_rk, &
                                        0.000000000000000000e+00_rk, 9.357272009936460733e-16_rk, -1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 2.929597740857995717e-17_rk, -1.177983215356853780e-17_rk, &
                                        2.690671754197210830e-01_rk, 5.277494117629406567e-01_rk, -2.122065907891936554e-01_rk, &
                                        7.468114333045759404e-18_rk, 1.464798870428998475e-17_rk, 2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.380540411097907786e-16_rk, -5.551115123125796261e-17_rk, &
                                        1.173088656243259768e-17_rk, 3.533949646070574282e-17_rk, -9.251858538542993768e-18_rk, &
                                        4.226497308103761008e-01_rk, 8.289868374653931449e-01_rk, -3.333333333333341475e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,1) = reshape((/                                                                                 &
                                        -4.226497308103746020e-01_rk, 2.221263536348840051e-01_rk, -8.931639747704089860e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.875163725722260283e-02_rk, 4.005934284325450574e-32_rk, &
                                        0.000000000000000000e+00_rk, -7.240818802659196119e-18_rk, 1.332267629550187849e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 7.849833488109455889e-18_rk, -3.156396512522870074e-18_rk, &
                                        -2.690671754197210830e-01_rk, 1.414100286878807178e-01_rk, -5.686058463052618556e-02_rk, &
                                        -7.468114333045759404e-18_rk, 3.924916744054728715e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,3) = reshape((/                                                                                 &
                                        -8.326672684688674053e-17_rk, 3.699146882722158650e-17_rk, -1.487416814333739235e-17_rk, &
                                        -1.173088656243259768e-17_rk, 0.000000000000000000e+00_rk, -2.479028023889565391e-18_rk, &
                                        -4.226497308103761008e-01_rk, 2.221263536348832834e-01_rk, -8.931639747704051002e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,1) = reshape((/                                                                                 &
                                        1.577350269189629728e+00_rk, -8.289868374653945882e-01_rk, -1.244016935856292250e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.397406792245191820e-01_rk, 3.204747427460360459e-31_rk, &
                                        0.000000000000000000e+00_rk, 8.028193616584889848e-18_rk, 6.661338147750939243e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, -2.929597740857995717e-17_rk, -4.396293210175147218e-17_rk, &
                                        1.004172369315441626e+00_rk, -5.277494117629406567e-01_rk, -7.919657785262488314e-01_rk, &
                                        2.787138212765998958e-17_rk, -1.464798870428998475e-17_rk, -2.827159716856459426e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, -1.380540411097910744e-16_rk, -2.071704367816954226e-16_rk, &
                                        4.378026466882524167e-17_rk, 0.000000000000000000e+00_rk, -3.452840613028256838e-17_rk, &
                                        1.577350269189624399e+00_rk, -8.289868374653949212e-01_rk, -1.244016935856301798e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,1) = reshape((/                                                                                 &
                                        -1.577350269189629950e+00_rk, -2.221263536348841161e-01_rk, -3.333333333333335369e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.446230791204398958e-01_rk, -3.328006943901143554e-31_rk, &
                                        0.000000000000000000e+00_rk, -9.605991566573259851e-16_rk, -7.105427357601001859e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, -7.849833488109455889e-18_rk, -1.177983215356859789e-17_rk, &
                                        -1.004172369315441626e+00_rk, -1.414100286878807455e-01_rk, -2.122065907891939607e-01_rk, &
                                        -2.787138212765998958e-17_rk, -3.924916744054730255e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, -3.699146882722143859e-17_rk, -5.551115123125711828e-17_rk, &
                                        -4.378026466882524167e-17_rk, 3.533949646070574282e-17_rk, -9.251858538542853560e-18_rk, &
                                        -1.577350269189624399e+00_rk, -2.221263536348823953e-01_rk, -3.333333333333290960e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.761451541109630335e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.417437057588217853e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704098187e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.761451541109630335e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.761451541109630335e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,1) = reshape((/                                                                                 &
                                        4.226497308103746020e-01_rk, 1.504281969462680502e-01_rk, -8.931639747704084309e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.777249420980918371e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.443289932012703503e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,2) = reshape((/                                                                                 &
                                        7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.690671754197210830e-01_rk, 9.576556449759886236e-02_rk, -5.686058463052615780e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        4.226497308103762118e-01_rk, 1.504281969462675228e-01_rk, -8.931639747704188392e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,1) = reshape((/                                                                                 &
                                        -4.226497308103747130e-01_rk, 5.614056738944467329e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.632785136822895444e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.322354824923294315e-16_rk, 1.110223024625156540e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,2) = reshape((/                                                                                 &
                                        1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.690671754197210830e-01_rk, 3.574019523205513305e-01_rk, -2.122065907891937941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        -4.226497308103762118e-01_rk, 5.614056738944476210e-01_rk, -3.333333333333329818e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,1) = reshape((/                                                                                 &
                                        1.577350269189630616e+00_rk, -1.504281969462680502e-01_rk, -3.333333333333333703e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.632785136822719196e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.322354824923294315e-16_rk, 7.549516567451064475e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,2) = reshape((/                                                                                 &
                                        -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.004172369315441626e+00_rk, -9.576556449759886236e-02_rk, -2.122065907891937941e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.766974823035287141e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.577350269189624843e+00_rk, -1.504281969462687440e-01_rk, -3.333333333333426962e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,1) = reshape((/                                                                                 &
                                        -1.577350269189630172e+00_rk, -5.614056738944467329e-01_rk, -1.244016935856292472e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.475389112631110056e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.105427357601001859e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,2) = reshape((/                                                                                 &
                                        -1.413579858428229713e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.004172369315441626e+00_rk, -3.574019523205513305e-01_rk, -7.919657785262489424e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.577350269189624843e+00_rk, -5.614056738944470659e-01_rk, -1.244016935856288919e+00_rk  &
                                        /),(/3,3/))
        
       
        
        do inode = 1,self%elem%basis_s%nnodes_if()
            do inode_diff = 1,self%elem%nnodes_r
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx_zetamax(:,:,inode,inode_diff,idir)),self%faces(ZETA_MAX)%dmetric_dx(:,:,inode,inode_diff,idir),tol)
                end do
            end do
        end do

    end subroutine testElement_face_dmetrics_dx_zetamax
    !*******************************************************************************************








    !> Test cartesian face dgrad_dx  
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dgrad_dx_ximax(self)
        class(test_element_linearD_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%basis_s%nnodes_if(),self%elem%nnodes_r,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode, irow
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,-7.182335127930851160e-01_rk,-7.182335127930851160e-01_rk,0.000000000000000000e+00_rk,4.146723119520953627e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298752067e-01_rk,-1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,-1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,5.156684612641734833e-02_rk,5.156684612641734833e-02_rk,0.000000000000000000e+00_rk,2.977213249234704484e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.919657785262489424e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016226e-01_rk,-4.572416554211016226e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,3.282847384271378455e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,6.905681226056465604e-17_rk,-3.986996914801447028e-17_rk,1.244016935856292472e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595672e-17_rk,-1.068312603546425370e-17_rk,3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753455e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.931639747704084309e-02_rk,5.156684612641715404e-02_rk,5.156684612641715404e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,7.182335127930847829e-01_rk,7.182335127930847829e-01_rk,0.000000000000000000e+00_rk,-4.146723119520960843e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,0.000000000000000000e+00_rk,1.111111111111111605e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,1.111111111111112160e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704092636e-02_rk,-5.156684612641726506e-02_rk,-5.156684612641726506e-02_rk,0.000000000000000000e+00_rk,-2.977213249234699627e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.919657785262488314e-01_rk,0.000000000000000000e+00_rk,4.572416554211016226e-01_rk,4.572416554211015116e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891938774e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,-3.282847384271378455e-02_rk,-3.282847384271378455e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.244016935856292472e+00_rk,7.182335127930842278e-01_rk,7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.931639747704084309e-02_rk,-5.156684612641715404e-02_rk,-5.156684612641715404e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,-1.924500897298752067e-01_rk,-1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,7.182335127930851160e-01_rk,-7.182335127930851160e-01_rk,0.000000000000000000e+00_rk,-4.146723119520953627e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,-5.156684612641734833e-02_rk,5.156684612641734833e-02_rk,0.000000000000000000e+00_rk,-2.977213249234704484e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111115768e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.919657785262489424e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016226e-01_rk,-4.572416554211016226e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595672e-17_rk,-1.068312603546425370e-17_rk,3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298752899e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.244016935856292472e+00_rk,7.182335127930842278e-01_rk,7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk,4.958056047779150813e-18_rk,-2.862534993842546434e-18_rk,8.931639747704084309e-02_rk,-5.156684612641715404e-02_rk,-5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298754287e-01_rk,1.924500897298754287e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112160e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,-7.182335127930847829e-01_rk,7.182335127930847829e-01_rk,0.000000000000000000e+00_rk,4.146723119520960843e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704092636e-02_rk,5.156684612641726506e-02_rk,-5.156684612641726506e-02_rk,0.000000000000000000e+00_rk,2.977213249234699627e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333335924e-01_rk,-1.924500897298753732e-01_rk,-1.924500897298753732e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112715e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891938774e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.919657785262488314e-01_rk,0.000000000000000000e+00_rk,4.572416554211016226e-01_rk,4.572416554211015116e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,-3.282847384271378455e-02_rk,-3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.244016935856292472e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.931639747704084309e-02_rk,5.156684612641715404e-02_rk,5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,-1.924500897298752067e-01_rk,-1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,5.156684612641734833e-02_rk,-5.156684612641734833e-02_rk,0.000000000000000000e+00_rk,-2.977213249234704484e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,-7.182335127930851160e-01_rk,7.182335127930851160e-01_rk,0.000000000000000000e+00_rk,-4.146723119520953627e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,1.111111111111115768e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,-3.282847384271378455e-02_rk,-3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.919657785262489424e-01_rk,0.000000000000000000e+00_rk,4.572416554211016226e-01_rk,4.572416554211016226e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595672e-17_rk,-1.068312603546425370e-17_rk,3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298752899e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.931639747704084309e-02_rk,5.156684612641715404e-02_rk,5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,6.905681226056465604e-17_rk,-3.986996914801447028e-17_rk,1.244016935856292472e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112715e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704089860e-02_rk,-5.156684612641726506e-02_rk,5.156684612641726506e-02_rk,0.000000000000000000e+00_rk,2.977213249234698239e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,7.182335127930847829e-01_rk,-7.182335127930847829e-01_rk,0.000000000000000000e+00_rk,4.146723119520960843e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,-1.111111111111112715e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.919657785262488314e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016226e-01_rk,-4.572416554211015116e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891938774e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.931639747704081533e-02_rk,-5.156684612641715404e-02_rk,-5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.244016935856292472e+00_rk,7.182335127930842278e-01_rk,7.182335127930842278e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,8.931639747704094023e-02_rk,-5.156684612641734833e-02_rk,-5.156684612641734833e-02_rk,0.000000000000000000e+00_rk,2.977213249234704484e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298752067e-01_rk,-1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,-1.924500897298752067e-01_rk,1.924500897298752067e-01_rk,0.000000000000000000e+00_rk,-1.111111111111115768e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.244016935856293582e+00_rk,7.182335127930851160e-01_rk,7.182335127930851160e-01_rk,0.000000000000000000e+00_rk,4.146723119520953627e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,-3.282847384271378455e-02_rk,-3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.919657785262489424e-01_rk,0.000000000000000000e+00_rk,4.572416554211016226e-01_rk,4.572416554211016226e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704084309e-02_rk,4.958056047779150813e-18_rk,-2.862534993842546434e-18_rk,8.931639747704084309e-02_rk,-5.156684612641715404e-02_rk,-5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk,1.850371707708595672e-17_rk,-1.068312603546425370e-17_rk,3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753455e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.244016935856292472e+00_rk,7.182335127930842278e-01_rk,7.182335127930842278e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.931639747704089860e-02_rk,5.156684612641726506e-02_rk,5.156684612641726506e-02_rk,0.000000000000000000e+00_rk,-2.977213249234698239e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,1.111111111111112715e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,0.000000000000000000e+00_rk,1.111111111111112715e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,-7.182335127930847829e-01_rk,-7.182335127930847829e-01_rk,0.000000000000000000e+00_rk,-4.146723119520960843e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.686058463052615780e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.686058463052615780e-02_rk,0.000000000000000000e+00_rk,3.282847384271378455e-02_rk,3.282847384271378455e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891937941e-01_rk,0.000000000000000000e+00_rk,1.225175323159538310e-01_rk,1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.122065907891937941e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.122065907891938774e-01_rk,0.000000000000000000e+00_rk,-1.225175323159538310e-01_rk,-1.225175323159538310e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.919657785262489424e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.919657785262488314e-01_rk,0.000000000000000000e+00_rk,-4.572416554211016226e-01_rk,-4.572416554211015116e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704084309e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.931639747704081533e-02_rk,5.156684612641715404e-02_rk,5.156684612641715404e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333334814e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856292472e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.244016935856292472e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930842278e-01_rk  &
                                        /),(/8,4/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad2
        !

        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,0.000000000000000000e+00_rk,1.413579858428229713e-16_rk,1.413579858428229713e-16_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.650462234552930558e-17_rk,2.650462234552930558e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.979914446315619303e-01_rk, -1.766974823035286956e-16_rk,5.020861846577208132e-01_rk,-4.878710385000892269e-01_rk,-2.898795938685275186e-01_rk,1.143104138552752391e-01_rk,2.816724754078486770e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, -1.766974823035286956e-16_rk,5.020861846577208132e-01_rk,2.368279461712288481e-01_rk,-2.898795938685275186e-01_rk,3.062938307898831550e-02_rk,-1.367326784735851120e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729853874e-02_rk, -1.766974823035286956e-16_rk,1.345335877098605692e-01_rk,-1.307246507766327004e-01_rk,7.767300307933397430e-02_rk,-3.062938307898831550e-02_rk,-7.547391231560846014e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.421514615763156547e-02_rk, -1.766974823035286956e-16_rk,1.345335877098605692e-01_rk,6.345785692170258230e-02_rk,7.767300307933397430e-02_rk,-8.207118460678569302e-03_rk,3.663741077594157708e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,-1.845430810625886819e-01_rk,-1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,-1.845430810625886819e-01_rk,-1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,4.944816953947211297e-02_rk,4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,4.944816953947211297e-02_rk,4.944816953947211297e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.020861846577240328e-01_rk,2.787138212766017447e-17_rk,-1.609154997409153190e-17_rk,5.020861846577240328e-01_rk,-2.898795938685291285e-01_rk,-2.898795938685291285e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.020861846577240328e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.020861846577240328e-01_rk,2.898795938685291840e-01_rk,2.898795938685291840e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.345335877098601807e-01_rk,7.468114333045742455e-18_rk,-4.311717820522863137e-18_rk,1.345335877098601807e-01_rk,-7.767300307933400205e-02_rk,-7.767300307933400205e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.345335877098601807e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.345335877098601807e-01_rk,7.767300307933391879e-02_rk,7.767300307933391879e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,0.000000000000000000e+00_rk,1.413579858428229713e-16_rk,1.413579858428229713e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.650462234552930558e-17_rk,2.650462234552930558e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-3.533949646070574282e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.305164769729853874e-02_rk, 1.722800452459404801e-16_rk,-5.020861846577208132e-01_rk,2.368279461712287925e-01_rk,2.898795938685275186e-01_rk,3.062938307898835019e-02_rk,-1.367326784735850842e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.979914446315619303e-01_rk, 1.766974823035286956e-16_rk,-5.020861846577208132e-01_rk,-4.878710385000892269e-01_rk,2.898795938685275186e-01_rk,1.143104138552752391e-01_rk,2.816724754078486770e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.421514615763156547e-02_rk, 1.722800452459404801e-16_rk,-1.345335877098605692e-01_rk,6.345785692170258230e-02_rk,-7.767300307933398817e-02_rk,-8.207118460678560629e-03_rk,3.663741077594158402e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, 1.766974823035286956e-16_rk,-1.345335877098605692e-01_rk,-1.307246507766326171e-01_rk,-7.767300307933397430e-02_rk,-3.062938307898831550e-02_rk,-7.547391231560846014e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,1.845430810625886819e-01_rk,1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,1.845430810625886819e-01_rk,1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,-4.944816953947211297e-02_rk,-4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,-4.944816953947211297e-02_rk,-4.944816953947211297e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.020861846577240328e-01_rk,-2.787138212766017447e-17_rk,1.609154997409153190e-17_rk,-5.020861846577240328e-01_rk,2.898795938685291840e-01_rk,2.898795938685291840e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.020861846577240328e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.020861846577240328e-01_rk,-2.898795938685291285e-01_rk,-2.898795938685291285e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.345335877098601807e-01_rk,-7.468114333045742455e-18_rk,4.311717820522863137e-18_rk,-1.345335877098601807e-01_rk,7.767300307933393266e-02_rk,7.767300307933393266e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.345335877098601807e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.345335877098601807e-01_rk,-7.767300307933400205e-02_rk,-7.767300307933400205e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.650462234552930558e-17_rk,-2.650462234552930558e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,0.000000000000000000e+00_rk,-1.413579858428229713e-16_rk,-1.413579858428229713e-16_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-3.533949646070574282e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, 2.650462234552930558e-17_rk,1.345335877098605692e-01_rk,-1.307246507766326171e-01_rk,-7.767300307933412695e-02_rk,3.062938307898838836e-02_rk,7.547391231560852953e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.421514615763154812e-02_rk, 2.650462234552930558e-17_rk,1.345335877098605692e-01_rk,6.345785692170259618e-02_rk,-7.767300307933412695e-02_rk,8.207118460678472158e-03_rk,-3.663741077594167422e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.979914446315619303e-01_rk, -1.272221872585406668e-15_rk,5.020861846577208132e-01_rk,-4.878710385000892269e-01_rk,2.898795938685260754e-01_rk,-1.143104138552743926e-01_rk,-2.816724754078478443e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, -1.272221872585406668e-15_rk,5.020861846577208132e-01_rk,2.368279461712288481e-01_rk,2.898795938685260754e-01_rk,-3.062938307898912735e-02_rk,1.367326784735843070e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,-4.944816953947211297e-02_rk,-4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,-4.944816953947211297e-02_rk,-4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,1.845430810625886819e-01_rk,1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,1.845430810625886819e-01_rk,1.845430810625886819e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.345335877098601807e-01_rk,7.468114333045742455e-18_rk,-4.311717820522863137e-18_rk,1.345335877098601807e-01_rk,-7.767300307933400205e-02_rk,-7.767300307933400205e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.345335877098602084e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.345335877098602084e-01_rk,7.767300307933393266e-02_rk,7.767300307933393266e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.020861846577240328e-01_rk,2.787138212766017447e-17_rk,-1.609154997409153190e-17_rk,5.020861846577240328e-01_rk,-2.898795938685291840e-01_rk,-2.898795938685291840e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.020861846577240328e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.020861846577240328e-01_rk,2.898795938685291840e-01_rk,2.898795938685291840e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.650462234552930558e-17_rk,-2.650462234552930558e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-3.533949646070574282e-17_rk,-3.533949646070574282e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.827159716856459426e-16_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.827159716856459426e-16_rk,0.000000000000000000e+00_rk,-1.413579858428229713e-16_rk,-1.413579858428229713e-16_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.421514615763154812e-02_rk, -2.540026308113225169e-17_rk,-1.345335877098605692e-01_rk,6.345785692170259618e-02_rk,7.767300307933412695e-02_rk,8.207118460678472158e-03_rk,-3.663741077594167422e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, -2.650462234552930558e-17_rk,-1.345335877098605692e-01_rk,-1.307246507766326171e-01_rk,7.767300307933412695e-02_rk,3.062938307898838836e-02_rk,7.547391231560852953e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.305164769729846935e-02_rk, 1.289891620815759530e-15_rk,-5.020861846577208132e-01_rk,2.368279461712288481e-01_rk,-2.898795938685260754e-01_rk,-3.062938307898912735e-02_rk,1.367326784735843070e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.979914446315619303e-01_rk, 1.272221872585406668e-15_rk,-5.020861846577208132e-01_rk,-4.878710385000892269e-01_rk,-2.898795938685260754e-01_rk,-1.143104138552743926e-01_rk,-2.816724754078478443e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,4.944816953947211297e-02_rk,4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.564674198364541358e-02_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.564674198364541358e-02_rk,0.000000000000000000e+00_rk,4.944816953947211297e-02_rk,4.944816953947211297e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,-1.845430810625886819e-01_rk,-1.845430810625886819e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.196379925857054660e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.196379925857054660e-01_rk,0.000000000000000000e+00_rk,-1.845430810625886819e-01_rk,-1.845430810625886819e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.345335877098602084e-01_rk,-7.468114333045743996e-18_rk,4.311717820522863907e-18_rk,-1.345335877098602084e-01_rk,7.767300307933393266e-02_rk,7.767300307933393266e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.345335877098601807e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.345335877098601807e-01_rk,-7.767300307933400205e-02_rk,-7.767300307933400205e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.020861846577240328e-01_rk,-2.787138212766017447e-17_rk,1.609154997409153190e-17_rk,-5.020861846577240328e-01_rk,2.898795938685291840e-01_rk,2.898795938685292395e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.020861846577241439e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.020861846577241439e-01_rk,-2.898795938685291840e-01_rk,-2.898795938685291840e-01_rk  &
                                        /),(/8,4/))
        
        

        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad3
        !

        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,6.905681226056466837e-17_rk,-3.986996914801447644e-17_rk,4.440892098500626162e-16_rk,2.220446049250313081e-16_rk,2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,1.850371707708594131e-17_rk,-1.068312603546424753e-17_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.326672684688674053e-17_rk,-6.938893903907228378e-17_rk,-6.938893903907228378e-17_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.396293210175144752e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.396293210175144752e-17_rk,0.000000000000000000e+00_rk,-2.538201068331145550e-17_rk,-2.538201068331145550e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.177983215356858094e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.177983215356858094e-17_rk,0.000000000000000000e+00_rk,6.801089264871430346e-18_rk,6.801089264871430346e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625157033e-16_rk,6.162975822039160204e-33_rk,-3.558195749863465697e-33_rk,1.110223024625157033e-16_rk,-6.409875621278552218e-17_rk,-6.409875621278552218e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562892584e-17_rk,-1.540743955509790051e-33_rk,8.895489374658664243e-34_rk,-2.775557561562892584e-17_rk,1.602468905319638054e-17_rk,1.602468905319638054e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.884981308350688778e-15_rk,1.577350269189624399e+00_rk,-9.106836025229586573e-01_rk,-9.106836025229636533e-01_rk,2.442490654175344389e-15_rk,5.257834230632101313e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.330669073875469621e-16_rk,4.226497308103761563e-01_rk,2.440169358562936375e-01_rk,-2.440169358562939150e-01_rk,-2.220446049250313081e-16_rk,-1.408832436034588298e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-15_rk,1.577350269189624621e+00_rk,-9.106836025229587683e-01_rk,9.106836025229543274e-01_rk,2.609024107869117870e-15_rk,-5.257834230632050243e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.273559366969493567e-16_rk,4.226497308103761563e-01_rk,2.440169358562936375e-01_rk,2.440169358562931379e-01_rk,-2.498001805406602216e-16_rk,1.408832436034583302e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.004172369315441626e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.004172369315441626e+00_rk,0.000000000000000000e+00_rk,-5.797591877370547042e-01_rk,-5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.690671754197210830e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.690671754197210830e-01_rk,0.000000000000000000e+00_rk,-1.553460061586682817e-01_rk,-1.553460061586682817e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.004172369315441626e+00_rk, 3.533949646070574282e-17_rk,1.961736132466737216e-33_rk,1.004172369315441626e+00_rk,3.533949646070574282e-17_rk,5.797591877370547042e-01_rk,5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.690671754197210830e-01_rk, 3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,2.690671754197210830e-01_rk,3.533949646070574282e-17_rk,1.553460061586682817e-01_rk,1.553460061586682817e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189634835e+00_rk,8.756052933765109964e-17_rk,-5.055309518347900131e-17_rk,1.577350269189634835e+00_rk,-9.106836025229645415e-01_rk,-9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103751016e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103751016e-01_rk,2.440169358562929991e-01_rk,2.440169358562929991e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189634835e+00_rk,8.756052933765109964e-17_rk,-5.055309518347900131e-17_rk,1.577350269189634835e+00_rk,-9.106836025229645415e-01_rk,-9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103750461e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.226497308103750461e-01_rk,2.440169358562929713e-01_rk,2.440169358562929713e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,1.850371707708594131e-17_rk,-1.068312603546424753e-17_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.440892098500626162e-16_rk,-2.220446049250313081e-16_rk,-2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,4.958056047779156205e-18_rk,-2.862534993842549131e-18_rk,8.326672684688674053e-17_rk,6.938893903907228378e-17_rk,6.938893903907228378e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.177983215356858094e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.177983215356858094e-17_rk,0.000000000000000000e+00_rk,-6.801089264871430346e-18_rk,-6.801089264871430346e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.156396512522872000e-18_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.156396512522872000e-18_rk,0.000000000000000000e+00_rk,1.822346376174278980e-18_rk,1.822346376174278980e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562892584e-17_rk,-1.540743955509790051e-33_rk,8.895489374658664243e-34_rk,-2.775557561562892584e-17_rk,1.602468905319638054e-17_rk,1.602468905319638054e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.938893903907231459e-18_rk,3.851859888774475127e-34_rk,-2.223872343664666061e-34_rk,6.938893903907231459e-18_rk,-4.006172263299095136e-18_rk,-4.006172263299095136e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk,4.226497308103761563e-01_rk,-2.440169358562936375e-01_rk,-2.440169358562941371e-01_rk,3.330669073875469621e-16_rk,1.408832436034589408e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.884981308350688778e-15_rk,1.577350269189624621e+00_rk,9.106836025229587683e-01_rk,-9.106836025229636533e-01_rk,-2.442490654175344389e-15_rk,-5.257834230632101313e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.273559366969493567e-16_rk,4.226497308103761563e-01_rk,-2.440169358562936375e-01_rk,2.440169358562931379e-01_rk,2.498001805406602216e-16_rk,-1.408832436034583302e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.551914400963141816e-15_rk,1.577350269189624621e+00_rk,9.106836025229587683e-01_rk,9.106836025229542164e-01_rk,-2.664535259100375697e-15_rk,5.257834230632049133e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.690671754197210830e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.690671754197210830e-01_rk,0.000000000000000000e+00_rk,-1.553460061586683094e-01_rk,-1.553460061586683094e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.004172369315441626e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.004172369315441626e+00_rk,0.000000000000000000e+00_rk,-5.797591877370547042e-01_rk,-5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.690671754197210830e-01_rk, -3.533949646070574282e-17_rk,-1.961736132466737216e-33_rk,2.690671754197210830e-01_rk,-3.533949646070574282e-17_rk,1.553460061586682817e-01_rk,1.553460061586682817e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.004172369315441626e+00_rk, -3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,1.004172369315441626e+00_rk,-3.533949646070574282e-17_rk,5.797591877370547042e-01_rk,5.797591877370547042e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103751016e-01_rk,2.346177312486515221e-17_rk,-1.354566102930682748e-17_rk,4.226497308103751016e-01_rk,-2.440169358562929991e-01_rk,-2.440169358562929991e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189634835e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189634835e+00_rk,9.106836025229645415e-01_rk,9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103750461e-01_rk,2.346177312486514913e-17_rk,-1.354566102930682594e-17_rk,4.226497308103750461e-01_rk,-2.440169358562929713e-01_rk,-2.440169358562929713e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189634835e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.577350269189634835e+00_rk,9.106836025229645415e-01_rk,9.106836025229645415e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,1.850371707708594131e-17_rk,-1.068312603546424753e-17_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,8.326672684688674053e-17_rk,-6.938893903907228378e-17_rk,-6.938893903907228378e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,6.905681226056466837e-17_rk,-3.986996914801447644e-17_rk,4.440892098500626162e-16_rk,2.220446049250313081e-16_rk,2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.177983215356858094e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.177983215356858094e-17_rk,0.000000000000000000e+00_rk,-6.801089264871430346e-18_rk,-6.801089264871430346e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.396293210175144752e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.396293210175144752e-17_rk,0.000000000000000000e+00_rk,2.538201068331145550e-17_rk,2.538201068331145550e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562892584e-17_rk,-1.540743955509790051e-33_rk,8.895489374658664243e-34_rk,-2.775557561562892584e-17_rk,1.602468905319638054e-17_rk,1.602468905319638054e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625157033e-16_rk,6.162975822039160204e-33_rk,-3.558195749863465697e-33_rk,1.110223024625157033e-16_rk,-6.409875621278552218e-17_rk,-6.409875621278552218e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-1.577350269189624621e+00_rk,9.106836025229587683e-01_rk,9.106836025229588794e-01_rk,0.000000000000000000e+00_rk,-5.257834230632075778e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk,-4.226497308103761563e-01_rk,-2.440169358562936375e-01_rk,2.440169358562936097e-01_rk,2.775557561562891351e-17_rk,1.408832436034586078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk,-1.577350269189624843e+00_rk,9.106836025229588794e-01_rk,-9.106836025229592124e-01_rk,-2.220446049250313081e-16_rk,5.257834230632074668e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-4.226497308103761563e-01_rk,-2.440169358562936375e-01_rk,-2.440169358562934709e-01_rk,0.000000000000000000e+00_rk,-1.408832436034586078e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.004172369315441626e+00_rk, 3.533949646070574282e-17_rk,1.961736132466737216e-33_rk,-1.004172369315441626e+00_rk,3.533949646070574282e-17_rk,5.797591877370547042e-01_rk,5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.690671754197210830e-01_rk, 3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-2.690671754197210830e-01_rk,3.533949646070574282e-17_rk,1.553460061586682817e-01_rk,1.553460061586682817e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.004172369315441626e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.004172369315441626e+00_rk,0.000000000000000000e+00_rk,-5.797591877370547042e-01_rk,-5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.690671754197210830e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.690671754197210830e-01_rk,0.000000000000000000e+00_rk,-1.553460061586683094e-01_rk,-1.553460061586683094e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189634835e+00_rk,-8.756052933765109964e-17_rk,5.055309518347900131e-17_rk,-1.577350269189634835e+00_rk,9.106836025229645415e-01_rk,9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103751016e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103751016e-01_rk,-2.440169358562929991e-01_rk,-2.440169358562929991e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189635057e+00_rk,-8.756052933765111196e-17_rk,5.055309518347901363e-17_rk,-1.577350269189635057e+00_rk,9.106836025229647635e-01_rk,9.106836025229647635e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103749906e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.226497308103749906e-01_rk,-2.440169358562929158e-01_rk,-2.440169358562929158e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.326672684688674053e-17_rk,4.958056047779156205e-18_rk,-2.862534993842549131e-18_rk,8.326672684688674053e-17_rk,6.938893903907228378e-17_rk,6.938893903907228378e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk,1.850371707708594131e-17_rk,-1.068312603546424753e-17_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.440892098500626162e-16_rk,-2.220446049250313081e-16_rk,-2.220446049250313081e-16_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.156396512522872000e-18_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.156396512522872000e-18_rk,0.000000000000000000e+00_rk,-1.822346376174278980e-18_rk,-1.822346376174278980e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.177983215356858094e-17_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.177983215356858094e-17_rk,0.000000000000000000e+00_rk,6.801089264871430346e-18_rk,6.801089264871430346e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.938893903907231459e-18_rk,3.851859888774475127e-34_rk,-2.223872343664666061e-34_rk,6.938893903907231459e-18_rk,-4.006172263299095136e-18_rk,-4.006172263299095136e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562892584e-17_rk,-1.540743955509790051e-33_rk,8.895489374658664243e-34_rk,-2.775557561562892584e-17_rk,1.602468905319638054e-17_rk,1.602468905319638054e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk,-4.226497308103761563e-01_rk,2.440169358562936375e-01_rk,2.440169358562936097e-01_rk,-2.775557561562891351e-17_rk,-1.408832436034586078e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-1.577350269189624621e+00_rk,-9.106836025229587683e-01_rk,9.106836025229588794e-01_rk,0.000000000000000000e+00_rk,5.257834230632075778e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,-4.226497308103761563e-01_rk,2.440169358562936375e-01_rk,-2.440169358562934709e-01_rk,0.000000000000000000e+00_rk,1.408832436034585522e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk,-1.577350269189624621e+00_rk,-9.106836025229587683e-01_rk,-9.106836025229592124e-01_rk,2.220446049250313081e-16_rk,-5.257834230632074668e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.690671754197210830e-01_rk, -3.533949646070574282e-17_rk,-1.961736132466737216e-33_rk,-2.690671754197210830e-01_rk,-3.533949646070574282e-17_rk,1.553460061586682817e-01_rk,1.553460061586682817e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.004172369315441626e+00_rk, -3.533949646070574282e-17_rk,0.000000000000000000e+00_rk,-1.004172369315441626e+00_rk,-3.533949646070574282e-17_rk,5.797591877370547042e-01_rk,5.797591877370547042e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.690671754197210830e-01_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.690671754197210830e-01_rk,0.000000000000000000e+00_rk,-1.553460061586683094e-01_rk,-1.553460061586683094e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.004172369315441626e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.004172369315441626e+00_rk,0.000000000000000000e+00_rk,-5.797591877370547042e-01_rk,-5.797591877370547042e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103751016e-01_rk,-2.346177312486515221e-17_rk,1.354566102930682748e-17_rk,-4.226497308103751016e-01_rk,2.440169358562929991e-01_rk,2.440169358562929991e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189634835e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189634835e+00_rk,-9.106836025229645415e-01_rk,-9.106836025229645415e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103750461e-01_rk,-2.346177312486514913e-17_rk,1.354566102930682594e-17_rk,-4.226497308103750461e-01_rk,2.440169358562929713e-01_rk,2.440169358562929713e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189634613e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.577350269189634613e+00_rk,-9.106836025229644305e-01_rk,-9.106836025229644305e-01_rk  &
                                        /),(/8,4/))
        
        
        

        
        do inode_diff = 1,self%elem%nnodes_r 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_face_dgrad_dx_ximax
    !*******************************************************************************************








    !>  Test that the derivatives of the scaled normal vectors have been computed correctly. These are really
    !!  unit vectors scaled by the inverse jacobian of the face metric terms. Essentially,
    !!  an area scaling.
    !!
    !!  @author Matteo Ugolotti
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testelement_face_dnormals_dx(self)
        class(test_element_linearD_dx),    intent(inout)   :: self

        real(rk), dimension(3,self%faces(XI_MAX)%basis_s%nnodes_if(),self%elem%nnodes_r,3) :: test_dnorm_dx
        integer(ik) :: inode_diff, idir, irow, inode
        real(rk)    :: tol,mat(4,8)
        
        tol = 1.e-14_rk
        
        ! xi_min
         
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -2.442621541642132910e-01_rk, -1.971687836487029943e-01_rk, -3.097120011140004903e-01_rk, &
                                        -6.544984694978747686e-02_rk, -1.971687836487029943e-01_rk, -8.298708058472384352e-02_rk, &
                                        -6.544984694978747686e-02_rk, -5.283121635129700566e-02_rk, -3.097120011140004903e-01_rk, &
                                        -1.753723363493612034e-02_rk, -5.283121635129700566e-02_rk, -8.298708058472384352e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 5.472533083603155979e-18_rk, &
                                        1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 1.466360820304074902e-18_rk, &
                                        5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        3.097120011140004903e-01_rk, -5.472533083603144423e-18_rk, 1.452116967507729352e-32_rk, &
                                        8.298708058472384352e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.097120011140004348e-01_rk, -1.466360820304066236e-18_rk, 1.573126714800040268e-32_rk, &
                                        8.298708058472384352e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        8.719671245021579409e-17_rk, 0.000000000000000000e+00_rk, 2.420194945846215586e-33_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, -1.210097472923107793e-33_rk, &
                                        1.089958905627697426e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.143516494366212258e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.050487364615538966e-34_rk, 0.000000000000000000e+00_rk, -1.260518200961571544e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -6.544984694978747686e-02_rk, 1.971687836487029943e-01_rk, -8.298708058472384352e-02_rk, &
                                        -2.442621541642132910e-01_rk, 1.971687836487029943e-01_rk, -3.097120011140004903e-01_rk, &
                                        -1.753723363493612034e-02_rk, 5.283121635129700566e-02_rk, -8.298708058472384352e-02_rk, &
                                        -6.544984694978747686e-02_rk, 5.283121635129700566e-02_rk, -3.097120011140004903e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, -5.472533083603155979e-18_rk, &
                                        -1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, -1.466360820304074902e-18_rk, &
                                        -5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        8.298708058472385740e-02_rk, 5.472533083603143653e-18_rk, 1.270602346569263251e-32_rk, &
                                        3.097120011140004348e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.298708058472384352e-02_rk, 1.466360820304066621e-18_rk, 1.240349909746185659e-32_rk, &
                                        3.097120011140004348e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, -1.210097472923107793e-33_rk, &
                                        8.719671245021579409e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.089958905627697426e-17_rk, 0.000000000000000000e+00_rk, 4.537865523461654225e-34_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        6.050487364615538966e-34_rk, 0.000000000000000000e+00_rk, -1.260518200961571544e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.397579654728199623e-36_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -6.544984694978747686e-02_rk, -5.283121635129700566e-02_rk, 3.097120011140004903e-01_rk, &
                                        -1.753723363493612034e-02_rk, -5.283121635129700566e-02_rk, 8.298708058472384352e-02_rk, &
                                        -2.442621541642132910e-01_rk, -1.971687836487029943e-01_rk, 3.097120011140004903e-01_rk, &
                                        -6.544984694978747686e-02_rk, -1.971687836487029943e-01_rk, 8.298708058472384352e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 1.466360820304074902e-18_rk, &
                                        5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 5.472533083603155979e-18_rk, &
                                        1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -3.097120011140004903e-01_rk, -1.466360820304066428e-18_rk, -1.452116967507729352e-32_rk, &
                                        -8.298708058472384352e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.097120011140004348e-01_rk, -5.472533083603143653e-18_rk, -1.573126714800040268e-32_rk, &
                                        -8.298708058472384352e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, -1.210097472923107793e-33_rk, &
                                        1.089958905627697426e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        8.719671245021579409e-17_rk, 0.000000000000000000e+00_rk, 2.420194945846215586e-33_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        6.050487364615538966e-34_rk, 0.000000000000000000e+00_rk, -1.260518200961571544e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.143516494366212258e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -1.753723363493612034e-02_rk, 5.283121635129700566e-02_rk, 8.298708058472384352e-02_rk, &
                                        -6.544984694978747686e-02_rk, 5.283121635129700566e-02_rk, 3.097120011140004903e-01_rk, &
                                        -6.544984694978747686e-02_rk, 1.971687836487029943e-01_rk, 8.298708058472384352e-02_rk, &
                                        -2.442621541642132910e-01_rk, 1.971687836487029943e-01_rk, 3.097120011140004903e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, -1.466360820304074902e-18_rk, &
                                        -5.283121635129702648e-02_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, -5.472533083603155979e-18_rk, &
                                        -1.971687836487030776e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -8.298708058472385740e-02_rk, 1.466360820304066428e-18_rk, -1.270602346569263251e-32_rk, &
                                        -3.097120011140004348e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -8.298708058472384352e-02_rk, 5.472533083603143653e-18_rk, -1.240349909746185659e-32_rk, &
                                        -3.097120011140004348e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        1.089958905627697426e-17_rk, 0.000000000000000000e+00_rk, 4.537865523461654225e-34_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, -1.210097472923107793e-33_rk, &
                                        8.719671245021579409e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.397579654728199623e-36_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.050487364615538966e-34_rk, 0.000000000000000000e+00_rk, -1.260518200961571544e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        
       
        
        do inode_diff = 1,self%elem%nnodes_r
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        ! xi_max
       
        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.743934249004315882e-16_rk, 0.000000000000000000e+00_rk, 9.680779783384862346e-33_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, -4.840389891692431173e-33_rk, &
                                        2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.148131954929698064e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.420194945846215586e-33_rk, 0.000000000000000000e+00_rk, -1.008414560769257236e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        2.442621541642132910e-01_rk, 1.971687836487029943e-01_rk, 6.194240022280008695e-01_rk, &
                                        6.544984694978739359e-02_rk, 1.971687836487029943e-01_rk, 1.659741611694476870e-01_rk, &
                                        6.544984694978733808e-02_rk, 5.283121635129700566e-02_rk, 6.194240022280009805e-01_rk, &
                                        1.753723363493612381e-02_rk, 5.283121635129700566e-02_rk, 1.659741611694476870e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, -2.189013233441262392e-17_rk, &
                                        -3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, -5.865443281216299609e-18_rk, &
                                        -1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -6.194240022280009805e-01_rk, 1.094506616720638283e-17_rk, 2.371791046929291548e-31_rk, &
                                        -1.659741611694476870e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.194240022280009805e-01_rk, 2.932721640608142871e-18_rk, 2.371791046929291548e-31_rk, &
                                        -1.659741611694476870e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, -4.840389891692431173e-33_rk, &
                                        1.743934249004315882e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 1.815146209384661690e-33_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        2.420194945846215586e-33_rk, 0.000000000000000000e+00_rk, -1.008414560769257236e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.318063723782559699e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        6.544984694978733808e-02_rk, -1.971687836487029943e-01_rk, 1.659741611694476870e-01_rk, &
                                        2.442621541642132910e-01_rk, -1.971687836487029943e-01_rk, 6.194240022280009805e-01_rk, &
                                        1.753723363493612381e-02_rk, -5.283121635129700566e-02_rk, 1.659741611694476870e-01_rk, &
                                        6.544984694978729645e-02_rk, -5.283121635129700566e-02_rk, 6.194240022280009805e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 2.189013233441262392e-17_rk, &
                                        3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 5.865443281216299609e-18_rk, &
                                        1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.659741611694476870e-01_rk, -1.094506616720638283e-17_rk, -1.936155956676972469e-32_rk, &
                                        -6.194240022280009805e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.659741611694476870e-01_rk, -2.932721640608142871e-18_rk, -2.057165703969283385e-32_rk, &
                                        -6.194240022280009805e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, -4.840389891692431173e-33_rk, &
                                        2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.743934249004315882e-16_rk, 0.000000000000000000e+00_rk, 9.680779783384862346e-33_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        2.420194945846215586e-33_rk, 0.000000000000000000e+00_rk, -1.008414560769257236e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.148131954929698064e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        6.544984694978739359e-02_rk, 5.283121635129700566e-02_rk, -6.194240022280009805e-01_rk, &
                                        1.753723363493613421e-02_rk, 5.283121635129700566e-02_rk, -1.659741611694476870e-01_rk, &
                                        2.442621541642132910e-01_rk, 1.971687836487029943e-01_rk, -6.194240022280009805e-01_rk, &
                                        6.544984694978739359e-02_rk, 1.971687836487029943e-01_rk, -1.659741611694476870e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, -5.865443281216299609e-18_rk, &
                                        -1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, -2.189013233441262392e-17_rk, &
                                        -3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        6.194240022280009805e-01_rk, 2.932721640608142871e-18_rk, -2.371791046929291548e-31_rk, &
                                        1.659741611694476870e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        6.194240022280009805e-01_rk, 1.094506616720638283e-17_rk, -2.420194945846215696e-31_rk, &
                                        1.659741611694477148e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.179917811255394852e-17_rk, 0.000000000000000000e+00_rk, 1.815146209384661690e-33_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -4.359835622510789704e-17_rk, 0.000000000000000000e+00_rk, -4.840389891692431173e-33_rk, &
                                        1.743934249004315882e-16_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.318063723782559699e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.420194945846215586e-33_rk, 0.000000000000000000e+00_rk, -1.008414560769257236e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        1.753723363493613421e-02_rk, -5.283121635129700566e-02_rk, -1.659741611694476870e-01_rk, &
                                        6.544984694978739359e-02_rk, -5.283121635129700566e-02_rk, -6.194240022280009805e-01_rk, &
                                        6.544984694978739359e-02_rk, -1.971687836487029943e-01_rk, -1.659741611694476593e-01_rk, &
                                        2.442621541642132910e-01_rk, -1.971687836487029943e-01_rk, -6.194240022280009805e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 5.865443281216299609e-18_rk, &
                                        1.056624327025940530e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 2.189013233441262392e-17_rk, &
                                        3.943375672974061552e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        1.659741611694476870e-01_rk, -2.932721640608143256e-18_rk, 1.936155956676972469e-32_rk, &
                                        6.194240022280009805e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.659741611694476870e-01_rk, -1.094506616720638283e-17_rk, 2.057165703969283385e-32_rk, &
                                        6.194240022280009805e-01_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        


        do inode_diff = 1,self%elem%nnodes_r
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        ! eta_min

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487037160e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487033829e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -2.388354503153698183e-01_rk, 3.533949646070574282e-17_rk, -2.388354503153697628e-01_rk, &
                                        -3.526709006307395255e-01_rk, -8.834874115176435705e-18_rk, -9.449788301796385737e-02_rk, &
                                        -6.399576603592721513e-02_rk, 1.325231117276465279e-17_rk, -2.388354503153697628e-01_rk, &
                                        -9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, -9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487037160e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487036050e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129704730e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        2.388354503153698183e-01_rk, 8.834874115176435705e-18_rk, -6.399576603592718738e-02_rk, &
                                        3.526709006307395255e-01_rk, -3.533949646070574282e-17_rk, -3.526709006307394700e-01_rk, &
                                        6.399576603592721513e-02_rk, 3.313077793191163197e-18_rk, -6.399576603592720125e-02_rk, &
                                        9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, -3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.208718528794108926e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487037715e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487034939e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -6.399576603592721513e-02_rk, 1.766974823035287141e-17_rk, 2.388354503153697628e-01_rk, &
                                        -9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, 9.449788301796385737e-02_rk, &
                                        -2.388354503153698183e-01_rk, 3.533949646070574282e-17_rk, 2.388354503153697628e-01_rk, &
                                        -3.526709006307395255e-01_rk, 0.000000000000000000e+00_rk, 9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129704730e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129695015e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487037715e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487036050e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        6.399576603592721513e-02_rk, 4.417437057588217853e-18_rk, 6.399576603592720125e-02_rk, &
                                        9.449788301796387124e-02_rk, -8.834874115176435705e-18_rk, 3.526709006307394700e-01_rk, &
                                        2.388354503153698183e-01_rk, 8.834874115176435705e-18_rk, 6.399576603592720125e-02_rk, &
                                        3.526709006307395255e-01_rk, -3.533949646070574282e-17_rk, 3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129701260e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.208718528794108926e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.208718528794108926e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        

        do inode_diff = 1,self%elem%nnodes_r
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! eta_max
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -7.563109205769425846e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 7.563109205769425846e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk, -3.358695191199878008e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -2.519021393399908506e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.208718528794108926e-18_rk, 4.814824860968089633e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -2.519021393399908506e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.407412430484044816e-34_rk, 1.469429146149946629e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.971687836487037160e-01_rk, -1.962624980319193517e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487033829e-01_rk, -7.798329568905748780e-17_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699178e-02_rk, 5.117333987687811897e-18_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        2.388354503153698183e-01_rk, 3.533949646070574282e-17_rk, 2.388354503153697628e-01_rk, &
                                        3.526709006307395255e-01_rk, -8.834874115176435705e-18_rk, 9.449788301796385737e-02_rk, &
                                        6.399576603592721513e-02_rk, 1.325231117276465279e-17_rk, 2.388354503153697628e-01_rk, &
                                        9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, 9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.041283304203355185e-17_rk, -1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk, &
                                        2.790110204533015161e-18_rk, -1.971687836487030498e-01_rk, -2.057165703969283385e-32_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.971687836487037160e-01_rk, 2.822248466917933594e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487036050e-01_rk, 7.798329568905748780e-17_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129704730e-02_rk, -2.813979797398210674e-18_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129700566e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -2.388354503153698183e-01_rk, 8.834874115176435705e-18_rk, 6.399576603592718738e-02_rk, &
                                        -3.526709006307395255e-01_rk, -3.533949646070574282e-17_rk, 3.526709006307394700e-01_rk, &
                                        -6.399576603592721513e-02_rk, 1.104359264397054463e-18_rk, 6.399576603592720125e-02_rk, &
                                        -9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, 3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.041283304203355185e-17_rk, -5.283121635129699178e-02_rk, -2.057165703969283385e-32_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, &
                                        -2.790110204533015161e-18_rk, -5.283121635129700566e-02_rk, -1.028582851984641693e-32_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 7.563109205769425846e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -7.563109205769425846e-35_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.208718528794108926e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.067899292141148564e-17_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -2.519021393399908506e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -3.358695191199878008e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.208718528794108926e-18_rk, 4.814824860968089633e-35_rk, &
                                        0.000000000000000000e+00_rk, 8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.834874115176435705e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.533949646070574282e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.407412430484044816e-34_rk, 1.049592247249961878e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -2.519021393399908506e-50_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.283121635129700566e-02_rk, 5.117333987687799571e-18_rk, &
                                        0.000000000000000000e+00_rk, -5.283121635129699178e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487037715e-01_rk, -1.962624980319193517e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.971687836487034939e-01_rk, -7.798329568905750013e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        6.399576603592721513e-02_rk, 1.766974823035287141e-17_rk, -2.388354503153697628e-01_rk, &
                                        9.449788301796387124e-02_rk, 0.000000000000000000e+00_rk, -9.449788301796385737e-02_rk, &
                                        2.388354503153698183e-01_rk, 3.533949646070574282e-17_rk, -2.388354503153697628e-01_rk, &
                                        3.526709006307395255e-01_rk, 0.000000000000000000e+00_rk, -9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        2.790110204533015161e-18_rk, 1.971687836487030498e-01_rk, 2.057165703969283385e-32_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.041283304203355185e-17_rk, 1.971687836487030498e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129699872e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.283121635129704730e-02_rk, -2.813979797398210674e-18_rk, &
                                        0.000000000000000000e+00_rk, 5.283121635129695015e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487037715e-01_rk, 2.822248466917932362e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487036050e-01_rk, 7.798329568905750013e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -6.399576603592721513e-02_rk, 2.208718528794108926e-18_rk, -6.399576603592720125e-02_rk, &
                                        -9.449788301796387124e-02_rk, -8.834874115176435705e-18_rk, -3.526709006307394700e-01_rk, &
                                        -2.388354503153698183e-01_rk, 8.834874115176435705e-18_rk, -6.399576603592720125e-02_rk, &
                                        -3.526709006307395255e-01_rk, -3.533949646070574282e-17_rk, -3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.790110204533015161e-18_rk, 5.283121635129700566e-02_rk, 1.028582851984641693e-32_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.041283304203355185e-17_rk, 5.283121635129701260e-02_rk, 2.117670577615438843e-32_rk, &
                                        0.000000000000000000e+00_rk, 1.971687836487029943e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        
        
        

        do inode_diff = 1,self%elem%nnodes_r
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! zeta_min
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.308996938995754811e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.885243083284276366e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.507446726987261537e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.308996938995754811e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.449788301796385737e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -3.751618480637878283e-01_rk, -1.971687836487029943e-01_rk, -2.136319455030287202e-15_rk, &
                                        -5.539741552782135869e-01_rk, -5.283121635129722771e-02_rk, -3.182680004432876731e-15_rk, &
                                        -1.005243142196600437e-01_rk, -1.971687836487025780e-01_rk, -1.634938358441546262e-16_rk, &
                                        -1.484369275345114869e-01_rk, -5.283121635129679750e-02_rk, -3.487868498008631764e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.406116950135762211e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.982363094424282934e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.180615478545962438e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.138867744842990193e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.399576603592718738e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.526709006307394700e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.399576603592720125e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        3.751618480637878283e-01_rk, -5.283121635129658933e-02_rk, 1.188055207134190305e-15_rk, &
                                        5.539741552782135869e-01_rk, -1.971687836487029943e-01_rk, 1.656737536554100186e-15_rk, &
                                        1.005243142196600437e-01_rk, -5.283121635129679750e-02_rk, 7.629712339393881983e-17_rk, &
                                        1.484369275345114869e-01_rk, -1.971687836487032441e-01_rk, 2.397909592380934584e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.507446726987263619e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.308996938995754256e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.308996938995754811e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.885243083284271370e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.449788301796385737e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -1.005243142196600437e-01_rk, 1.971687836487025780e-01_rk, -1.852930139567085748e-16_rk, &
                                        -1.484369275345114592e-01_rk, 5.283121635129679750e-02_rk, -3.215378771601707345e-16_rk, &
                                        -3.751618480637878283e-01_rk, 1.971687836487029943e-01_rk, -2.267114523705610844e-15_rk, &
                                        -5.539741552782135869e-01_rk, 5.283121635129722771e-02_rk, -3.204479182545430605e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.180615478545962438e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.138867744842990193e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.406116950135762211e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.982363094424278493e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.399576603592720125e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.526709006307394700e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.399576603592718738e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        1.005243142196600437e-01_rk, 5.283121635129679750e-02_rk, 1.035460960346312616e-16_rk, &
                                        1.484369275345114592e-01_rk, 1.971687836487032441e-01_rk, 2.179917811255394852e-16_rk, &
                                        3.751618480637878283e-01_rk, 5.283121635129658933e-02_rk, 1.046360549402589529e-15_rk, &
                                        5.539741552782135869e-01_rk, 1.971687836487029943e-01_rk, 1.656737536554100186e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.814856169696940991e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.719671245021579409e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.907428084848470496e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.539753433766184557e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.539753433766184557e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.362448632034621783e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.719671245021579409e-17_rk  &
                                        /),(/3,4/))
        


        
        do inode_diff = 1,self%elem%nnodes_r
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! zeta_max
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.403069722661996477e-51_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.703719777548943412e-34_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.814856169696940991e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.403069722661996477e-51_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.719671245021579409e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.888894916580853780e-34_rk, 1.907428084848470496e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.539753433766184557e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.403069722661996477e-51_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 7.703719777548943412e-34_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.539753433766184557e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.724897264069244336e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.724897264069244336e-18_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.403069722661996477e-51_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.888894916580853780e-34_rk, 1.362448632034621783e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.359835622510789704e-17_rk, &
                                        0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk, -3.269876716883092278e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.719671245021579409e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.311115933264683024e-32_rk, -1.308996938995744264e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, -4.885243083284259158e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, -3.507446726987251129e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.308996938995752868e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        6.629015400921027889e-18_rk, 4.904340331166843040e-34_rk, -2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.449788301796385737e-02_rk, &
                                        1.776239323290274043e-18_rk, 4.904340331166843040e-34_rk, -2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        3.751618480637878283e-01_rk, 1.971687836487029943e-01_rk, -2.092721098805179058e-15_rk, &
                                        5.539741552782135869e-01_rk, 5.283121635129722771e-02_rk, -3.160880826320322856e-15_rk, &
                                        1.005243142196600437e-01_rk, 1.971687836487025780e-01_rk, -2.070921920692625233e-16_rk, &
                                        1.484369275345114869e-01_rk, 5.283121635129679750e-02_rk, -3.487868498008631764e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.081668171172168020e-16_rk, 4.406116950135749999e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.982363094424268501e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.622231866529366047e-33_rk, 1.180615478545961466e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 2.138867744842988250e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -6.629015400921027889e-18_rk, 1.226085082791710760e-34_rk, -6.399576603592718738e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.526709006307394700e-01_rk, &
                                        -1.776239323290274043e-18_rk, 1.226085082791710760e-34_rk, -6.399576603592720125e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -3.751618480637878283e-01_rk, 5.283121635129658933e-02_rk, 1.057260138458866466e-15_rk, &
                                        -5.539741552782135869e-01_rk, 1.971687836487029943e-01_rk, 1.656737536554100186e-15_rk, &
                                        -1.005243142196600437e-01_rk, 5.283121635129679750e-02_rk, 1.035460960346312616e-16_rk, &
                                        -1.484369275345114869e-01_rk, 1.971687836487032441e-01_rk, 1.961926030129855367e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.081668171172168267e-16_rk, -3.507446726987251129e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.308996938995752868e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.311115933264683024e-32_rk, -1.308996938995744264e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, -4.885243083284255272e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.776239323290274043e-18_rk, -4.904340331166843040e-34_rk, 2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.449788301796385737e-02_rk, &
                                        6.629015400921027889e-18_rk, -4.904340331166843040e-34_rk, 2.388354503153697628e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.449788301796387124e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        1.005243142196600437e-01_rk, -1.971687836487025780e-01_rk, -1.743934249004315882e-16_rk, &
                                        1.484369275345114592e-01_rk, -5.283121635129679750e-02_rk, -3.651362333852786316e-16_rk, &
                                        3.751618480637878283e-01_rk, -1.971687836487029943e-01_rk, -2.136319455030287202e-15_rk, &
                                        5.539741552782135869e-01_rk, -5.283121635129722771e-02_rk, -3.204479182545430605e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.622231866529366047e-33_rk, 1.180615478545961466e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.081668171172168513e-16_rk, 2.138867744842989083e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313574e-16_rk, 4.406116950135749999e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.982363094424261840e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.776239323290274043e-18_rk, -1.226085082791710760e-34_rk, 6.399576603592720125e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.526709006307394700e-01_rk, &
                                        -6.629015400921027889e-18_rk, -1.226085082791710760e-34_rk, 6.399576603592718738e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.526709006307395255e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -1.005243142196600437e-01_rk, -5.283121635129679750e-02_rk, 7.357222612986957318e-17_rk, &
                                        -1.484369275345114592e-01_rk, -1.971687836487032441e-01_rk, 2.179917811255394852e-16_rk, &
                                        -3.751618480637878283e-01_rk, -5.283121635129658933e-02_rk, 1.100858494683974413e-15_rk, &
                                        -5.539741552782135869e-01_rk, -1.971687836487029943e-01_rk, 1.482344111653668598e-15_rk  &
                                        /),(/3,4/))
        
        

        do inode_diff = 1,self%elem%nnodes_r
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do



    end subroutine testelement_face_dnormals_dx
    !*******************************************************************************************





!    !>  Test dmetric_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The dmetric_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_dmetric_dx_point(self)
!        class(test_element_linearD_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_dmetric_dx(:,:,:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [-1._rk/sqrt(3._rk),1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_dmetric_dx = self%elem%dmetric_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_dmetric_dx,self%elem%dmetric_dx(:,:,3,:,:),tol)
!
!
!    end subroutine testelement_dmetric_dx_point
!    !*******************************************************************************************







!    !>  Test djinv_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The djinv_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_djinv_dx_point(self)
!        class(test_element_linearD_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_djinv_dx(:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [1._rk/sqrt(3._rk),1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_djinv_dx = self%elem%djinv_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_djinv_dx,self%elem%djinv_dx(4,:,:),tol)
!
!
!    end subroutine testelement_djinv_dx_point
!    !*******************************************************************************************







    !>  Test h_index
    !!
    !!  Fortran search the minimum x, y and z coordinate among all the support nodes.
    !!  If multiple minimum are found, fortran returns the location of the first minimum starting 
    !!  from the first minimum found (ie. first location in connectivity vector).
    !!
    !!  In this case, for instance for x direction, there exists 4 minima. However, the one stored
    !!  for dX differentiation (needed for artificial viscosity) will be node 1, since it comes first
    !!
    !!
    !!  @author Matteo Ugolotti
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testelement_h_index(self)
        class(test_element_linearD_dx),    intent(inout)   :: self

        integer(ik) :: x_min, x_max, y_min, y_max, z_min, z_max
        
        x_min = 1
        x_max = 2
        y_min = 1
        y_max = 3
        z_min = 1
        z_max = 5


        ! Test
        @assertequal(x_min,self%elem%h_index(1,1))
        @assertequal(x_max,self%elem%h_index(1,2))
        @assertequal(y_min,self%elem%h_index(2,1))
        @assertequal(y_max,self%elem%h_index(2,2))
        @assertequal(z_min,self%elem%h_index(3,1))
        @assertequal(z_max,self%elem%h_index(3,2))


    end subroutine testelement_h_index
    !*******************************************************************************************









!####################################################
!
!   PYTHON SCRIPT FOR TESTING ELEMENT DX INITIALIZATION
!
!       This requires PyTORCH. For installation refer to
!       https://pytorch.org/get-started/locally/
!
!####################################################


!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!
!
!
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data  = [[ 1.0,   0.0,       0.0],
!                [ 2.0,   0.0,       0.0],
!                [ 1.0,   np.pi/2.0, 0.0],
!                [ 2.0,   np.pi/2.0, 0.0],
!                [ 1.0,   0.0,       1.0],
!                [ 2.0,   0.0,       1.0],
!                [ 1.0,   np.pi/2.0, 1.0],
!                [ 2.0,   np.pi/2.0, 1.0],
!                ]
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_ie  = 8 
!nnodes_if  = 4 
!nterms_s   = 8
!ndirs      = 3
!coord_sys  = 'CYLINDRICAL'
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              ] 
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              ]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                ]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_ie, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_ie, dtype=torch.float64) 
!for inode in range(0,nnodes_ie):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_ie-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_ie):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_ie, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_ie, dtype=torch.float64) 
!for inode in range(0,nnodes_ie):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_ie-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_ie, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_ie, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_ie, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_ie):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_ie))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_ie,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_ie,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_ie,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_ie):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_ie*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_ie):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_ie*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_ie):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_ie))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_ie,nterms_s])
!i = 1
!for inode in range (0,nnodes_ie):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_ie*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_ie,nterms_s])
!i = 1
!for inode in range (0,nnodes_ie):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_ie*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_ie,nterms_s])
!i = 1
!for inode in range (0,nnodes_ie):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_ie*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_ie):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            for irow in range(0,3):
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_ie*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    i += 1
!            np.savetxt(f,array)
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("xcoord interpolation, coord 1,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_ie,nnodes_r*ndirs])
!for inode in range (0,nnodes_ie):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_ie*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("ycoord interpolation, coord 2,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_ie,nnodes_r*ndirs])
!for inode in range (0,nnodes_ie):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_ie*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("zcoord interpolation, coord 3,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_ie,nnodes_r*ndirs])
!for inode in range (0,nnodes_ie):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_ie*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_ie):
!    array = np.zeros([nnodes_r,ndirs])
!    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_ie*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file           ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dinvmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file        ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_vol_dx
!#
!# 
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face1_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face2_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face3_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_face_dx
!#
!# 
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nterms_s])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_ie*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nterms_s])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_ie*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nterms_s])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_ie*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()












!####################################################
!
!   PYTHON SCRIPT FOR TESTING FACE DX INITIALIZATION
!
!       This requires PyTORCH. For installation refer to
!       https://pytorch.org/get-started/locally/
!
!####################################################




!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!
!
!
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data  = [[ 1.0,   0.0,       0.0],
!                [ 2.0,   0.0,       0.0],
!                [ 1.0,   np.pi/2.0, 0.0],
!                [ 2.0,   np.pi/2.0, 0.0],
!                [ 1.0,   0.0,       1.0],
!                [ 2.0,   0.0,       1.0],
!                [ 1.0,   np.pi/2.0, 1.0],
!                [ 2.0,   np.pi/2.0, 1.0],
!                ]
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_ie  = 8 
!nnodes_if  = 4 
!nterms_s   = 8
!ndirs      = 3
!coord_sys  = 'CYLINDRICAL'
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              ] 
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              ]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                ]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_ie, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_ie, dtype=torch.float64) 
!for inode in range(0,nnodes_ie):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_ie-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_ie):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_ie, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_ie, dtype=torch.float64) 
!for inode in range(0,nnodes_ie):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_ie-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_ie, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_ie, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_ie, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_ie):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_ie))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_ie,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_ie,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_ie,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_ie):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_ie*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_ie):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_ie*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_ie):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_ie))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_ie,nterms_s])
!i = 1
!for inode in range (0,nnodes_ie):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_ie*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_ie,nterms_s])
!i = 1
!for inode in range (0,nnodes_ie):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_ie*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_ie,nterms_s])
!i = 1
!for inode in range (0,nnodes_ie):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_ie*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_ie):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            for irow in range(0,3):
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_ie*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    i += 1
!            np.savetxt(f,array)
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("xcoord interpolation, coord 1,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_ie,nnodes_r*ndirs])
!for inode in range (0,nnodes_ie):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_ie*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("ycoord interpolation, coord 2,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_ie,nnodes_r*ndirs])
!for inode in range (0,nnodes_ie):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_ie*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("zcoord interpolation, coord 3,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_ie,nnodes_r*ndirs])
!for inode in range (0,nnodes_ie):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_ie*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_ie):
!    array = np.zeros([nnodes_r,ndirs])
!    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_ie*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file           ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dinvmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file        ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_vol_dx
!#
!# 
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face1_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face2_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face3_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nnodes_if])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nnodes_if):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file  ", i/(nnodes_ie*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_face_dx
!#
!# 
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_if,nnodes_if])
!        for irow in range(0,nnodes_if):
!            for icol in range(0,nnodes_if):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file ", i/(nnodes_if*nnodes_r*ndirs*nnodes_if))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nterms_s])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_ie*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nterms_s])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_ie*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_ie,nterms_s])
!        for irow in range(0,nnodes_ie):
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_ie*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()












end module test_element_linearD_cylindrical_dx_mod

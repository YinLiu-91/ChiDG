module test_element_linearB_dx_mod
    use pfunit_mod
    use mod_kinds,                  only: rk,ik
    use mod_constants,              only: ZERO, ONE, TWO, THREE, FIVE, SIX, EIGHT, NINE, TEN, &
                                          XI_MIN, XI_MAX, ETA_MIN, ETA_MAX, ZETA_MIN, ZETA_MAX
    use mod_chidg_mpi,              only: IRANK
    use type_chidg,                 only: chidg_t
    use type_element,               only: element_t
    use type_face,                  only: face_t
    use type_element_connectivity,  only: element_connectivity_t
    use mod_io,                     only: gq_rule
    use type_point,                 only: point_t


    use mod_inv,                    only: inv
    implicit none

    public  :: test_element_linearB_dx


    !>
    !!
    !!  @author Matteo Ugolotti
    !!  @date   10/4/2018
    !!
    !!  This test is build based on test_element_linearB test case.
    !!  The standard initialization is not tested here but the dx initialization 
    !!  is verified.
    !!
    !!  Symbolic pyhton solution is used to check ChiDG matrices.
    !!  The python script is available at the end of this module.
    !!  The input matrices used in the test herein are given by the
    !!  python script
    !!
    !!
    !--------------------------------------------------------------------------
    @TestCase
    type, extends(TestCase) ::  test_element_linearB_dx

        type(chidg_t)               :: chidg
        type(element_t)             :: elem
        type(face_t),   allocatable :: faces(:)
        real(rk),       allocatable :: nodes(:,:)

    contains

        procedure   ::  setUp
        procedure   ::  tearDown

    end type test_element_linearB_dx
    !***************************************************************************


contains

    !> NOTE: make sure to use 'this' instead of 'self' since these are over-writting a 
    !! derived type procedure. The argument names have to match
    !!
    !!  @author Matteo Ugolotti
    !!
    !!
    !-----------------------------------------------------------------------------------------
    subroutine setUp(this)
        class(test_element_linearB_dx),    intent(inout)   :: this
        
        integer(ik), parameter          :: npt = 8
        real(rk)                        :: nodes(npt,3)
        real(rk)                        :: sqrt_two, inv_sqrt_two
        integer(ik)                     :: ftype, ielem, idomain,                       &
                                           nfields, nterms_s, ntime,                      &
                                           dof_start, dof_local_start,                  &
                                           ineighbor_domain_g,  ineighbor_domain_l,     &
                                           ineighbor_element_g, ineighbor_element_l,    &
                                           ineighbor_face, ineighbor_proc,              &
                                           ineighbor_nfields, ineighbor_nterms_s,         &
                                           ineighbor_nterms_c, ineighbor_nnodes_r,      &
                                           ineighbor_ntime,                             &
                                           ineighbor_dof_start, ineighbor_dof_local_start
        
        
        call this%chidg%start_up('core')
        allocate(this%faces(6))
        
        
        !> Cube unit element rotated at 45-degrees along the 0,0,0 z-axis
        !!
        !!              *  (0, sqrt(2), 0)
        !!            /   \ 
        !!          /       \
        !!        /           \
        !!       *             *  (1/sqrt(2), 1/sqrt(2), 0)
        !!        \           /
        !!          \       /
        !!            \   /
        !!              *
        !!          (0,0,0)
        !!
        !!
        sqrt_two        = sqrt(2._rk)
        inv_sqrt_two    = 1._rk/sqrt_two
        nodes(1,:) = [0._rk, 0._rk, 0._rk]
        nodes(2,:) = [inv_sqrt_two,inv_sqrt_two, 0._rk]
        nodes(3,:) = [-inv_sqrt_two,inv_sqrt_two, 0._rk]
        nodes(4,:) = [0._rk, sqrt_two, 0._rk]
        nodes(5,:) = [0._rk, 0._rk, 1._rk]
        nodes(6,:) = [inv_sqrt_two,inv_sqrt_two, 1._rk]
        nodes(7,:) = [-inv_sqrt_two,inv_sqrt_two, 1._rk]
        nodes(8,:) = [0._rk, sqrt_two, 1._rk]

        
        
        ! Initialize Element geometry and Numerics
        idomain         = 1
        ielem           = 1
        nfields         = 2
        nterms_s        = 8
        ntime           = 1
        dof_start       = 1
        dof_local_start = 1
        call this%elem%init_geom(nodes        = nodes,                              &
                                 connectivity = [1, 2, 3, 4, 5, 6, 7, 8],           &
                                 etype        = 1,                                  &
                                 location     = [idomain,idomain,ielem,ielem,IRANK],&
                                 coord_system = 'Cartesian')
        call this%elem%init_sol('Quadrature',1,nterms_s,nfields,ntime,dof_start,dof_local_start)
        call this%elem%update_interpolations_dx()



        ! Initialize face geometries
        call this%faces(XI_MIN)%init_geom(XI_MIN,this%elem)
        call this%faces(XI_MAX)%init_geom(XI_MAX,this%elem)
        call this%faces(ETA_MIN)%init_geom(ETA_MIN,this%elem)
        call this%faces(ETA_MAX)%init_geom(ETA_MAX,this%elem)
        call this%faces(ZETA_MIN)%init_geom(ZETA_MIN,this%elem)
        call this%faces(ZETA_MAX)%init_geom(ZETA_MAX,this%elem)

        ! Initialize face neighbors
        ftype = 0
        ineighbor_domain_g        = 0
        ineighbor_domain_l        = 0
        ineighbor_element_g       = 0
        ineighbor_element_l       = 0
        ineighbor_proc            = 0
        ineighbor_nfields         = 2
        ineighbor_ntime           = 1
        ineighbor_nterms_s        = 8
        ineighbor_nterms_c        = 8
        ineighbor_dof_start       = 1
        ineighbor_dof_local_start = 1
        call this%faces(XI_MIN)%set_neighbor(  ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                 &
                                                     ineighbor_dof_start,ineighbor_dof_local_start)
        call this%faces(XI_MAX)%set_neighbor(  ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                 &
                                                     ineighbor_dof_start,ineighbor_dof_local_start)
        call this%faces(ETA_MIN)%set_neighbor( ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                 &
                                                     ineighbor_dof_start,ineighbor_dof_local_start)
        call this%faces(ETA_MAX)%set_neighbor( ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                 &
                                                     ineighbor_dof_start,ineighbor_dof_local_start)
        call this%faces(ZETA_MIN)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                 &
                                                     ineighbor_dof_start,ineighbor_dof_local_start)
        call this%faces(ZETA_MAX)%set_neighbor(ftype,ineighbor_domain_g,ineighbor_domain_l,             &
                                                     ineighbor_element_g,ineighbor_element_l,           &
                                                     ineighbor_face,ineighbor_nfields,ineighbor_ntime,  &
                                                     ineighbor_nterms_s,ineighbor_nterms_c,             &
                                                     ineighbor_proc,                 &
                                                     ineighbor_dof_start,ineighbor_dof_local_start)


        call this%faces(XI_MIN)%init_sol(this%elem)
        call this%faces(XI_MAX)%init_sol(this%elem)
        call this%faces(ETA_MIN)%init_sol(this%elem)
        call this%faces(ETA_MAX)%init_sol(this%elem)
        call this%faces(ZETA_MIN)%init_sol(this%elem)
        call this%faces(ZETA_MAX)%init_sol(this%elem)

        !
        ! Update dx interpolators
        !
        call this%faces(XI_MIN)%update_interpolations_dx(this%elem)
        call this%faces(XI_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ETA_MAX)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MIN)%update_interpolations_dx(this%elem)
        call this%faces(ZETA_MAX)%update_interpolations_dx(this%elem)


    end subroutine setUp
    !************************************************************************************
    

    !>
    !!
    !!
    !-------------------------------------------------------------------------------------
    subroutine tearDown(this)
        class(test_element_linearB_dx),    intent(inout)   :: this


        !
        ! Close ChiDG interface
        !
        call this%chidg%shut_down('core')

    end subroutine tearDown
    !**************************************************************************************



    
    
    !> Test element djinv_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_djinv_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self

        integer(ik) :: inode, inode_diff, idir, irow
        real(rk)    :: test_djinv_dx(8,3,8), test_djinv_dx_trans(8,3)


        
        test_djinv_dx(1,:,:) = reshape((/                                                                                 &
                                        -3.814885955982149970e-19_rk, -1.099566014068617120e-01_rk, -7.775105849101818234e-02_rk,  &
                                        6.970969197815057861e-02_rk, 4.024690942871113342e-02_rk, -2.083333333333330789e-02_rk,  &
                                        -6.970969197815057861e-02_rk, 4.024690942871113342e-02_rk, -2.083333333333330789e-02_rk,  &
                                        -2.738964885068442293e-20_rk, 2.946278254943944519e-02_rk, -5.582274842315044887e-03_rk,  &
                                        3.814885955982149970e-19_rk, -2.946278254943944519e-02_rk, 7.775105849101818234e-02_rk,  &
                                        1.867865567016775696e-02_rk, 1.078412687927168823e-02_rk, 2.083333333333330789e-02_rk,  &
                                        -1.867865567016775696e-02_rk, 1.078412687927168823e-02_rk, 2.083333333333330789e-02_rk,  &
                                        2.738964885068442293e-20_rk, 7.894528790896067003e-03_rk, 5.582274842315044887e-03_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(2,:,:) = reshape((/                                                                                 &
                                        -4.024690942871114729e-02_rk, -6.970969197815057861e-02_rk, -2.083333333333331136e-02_rk,  &
                                        1.099566014068617259e-01_rk, 0.000000000000000000e+00_rk, -7.775105849101818234e-02_rk,  &
                                        -2.946278254943944866e-02_rk, 0.000000000000000000e+00_rk, -5.582274842315045754e-03_rk,  &
                                        -4.024690942871113342e-02_rk, 6.970969197815057861e-02_rk, -2.083333333333331136e-02_rk,  &
                                        -1.078412687927169170e-02_rk, -1.867865567016775696e-02_rk, 2.083333333333330789e-02_rk,  &
                                        2.946278254943944866e-02_rk, 0.000000000000000000e+00_rk, 7.775105849101818234e-02_rk,  &
                                        -7.894528790896068737e-03_rk, 0.000000000000000000e+00_rk, 5.582274842315045754e-03_rk,  &
                                        -1.078412687927168823e-02_rk, 1.867865567016775696e-02_rk, 2.083333333333330789e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(3,:,:) = reshape((/                                                                                 &
                                        4.024690942871115423e-02_rk, -6.970969197815057861e-02_rk, -2.083333333333331136e-02_rk,  &
                                        2.946278254943945213e-02_rk, 0.000000000000000000e+00_rk, -5.582274842315045754e-03_rk,  &
                                        -1.099566014068617259e-01_rk, 0.000000000000000000e+00_rk, -7.775105849101819622e-02_rk,  &
                                        4.024690942871112648e-02_rk, 6.970969197815057861e-02_rk, -2.083333333333331483e-02_rk,  &
                                        1.078412687927169517e-02_rk, -1.867865567016775696e-02_rk, 2.083333333333331136e-02_rk,  &
                                        7.894528790896068737e-03_rk, 0.000000000000000000e+00_rk, 5.582274842315045754e-03_rk,  &
                                        -2.946278254943945213e-02_rk, 0.000000000000000000e+00_rk, 7.775105849101819622e-02_rk,  &
                                        1.078412687927168823e-02_rk, 1.867865567016775696e-02_rk, 2.083333333333331136e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(4,:,:) = reshape((/                                                                                 &
                                        1.734723475976807094e-18_rk, -2.946278254943944172e-02_rk, -5.582274842315045754e-03_rk,  &
                                        6.970969197815059248e-02_rk, -4.024690942871112648e-02_rk, -2.083333333333331483e-02_rk,  &
                                        -6.970969197815059248e-02_rk, -4.024690942871112648e-02_rk, -2.083333333333331483e-02_rk,  &
                                        -6.938893903907228378e-18_rk, 1.099566014068616981e-01_rk, -7.775105849101821009e-02_rk,  &
                                        8.673617379884035472e-19_rk, -7.894528790896067003e-03_rk, 5.582274842315045754e-03_rk,  &
                                        1.867865567016776043e-02_rk, -1.078412687927168823e-02_rk, 2.083333333333331483e-02_rk,  &
                                        -1.867865567016776043e-02_rk, -1.078412687927168823e-02_rk, 2.083333333333331483e-02_rk,  &
                                        -1.734723475976807094e-18_rk, 2.946278254943944172e-02_rk, 7.775105849101821009e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(5,:,:) = reshape((/                                                                                 &
                                        4.995401334346474947e-18_rk, -2.946278254943944519e-02_rk, -7.775105849101818234e-02_rk,  &
                                        1.867865567016775696e-02_rk, 1.078412687927168823e-02_rk, -2.083333333333330789e-02_rk,  &
                                        -1.867865567016776043e-02_rk, 1.078412687927168823e-02_rk, -2.083333333333330789e-02_rk,  &
                                        -7.578031425856658796e-19_rk, 7.894528790896067003e-03_rk, -5.582274842315045754e-03_rk,  &
                                        1.235183342542159600e-17_rk, -1.099566014068617120e-01_rk, 7.775105849101818234e-02_rk,  &
                                        6.970969197815057861e-02_rk, 4.024690942871113342e-02_rk, 2.083333333333330789e-02_rk,  &
                                        -6.970969197815059248e-02_rk, 4.024690942871113342e-02_rk, 2.083333333333330789e-02_rk,  &
                                        -3.579005547356352049e-18_rk, 2.946278254943944519e-02_rk, 5.582274842315045754e-03_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(6,:,:) = reshape((/                                                                                 &
                                        -1.078412687927169170e-02_rk, -1.867865567016775696e-02_rk, -2.083333333333331136e-02_rk,  &
                                        2.946278254943945213e-02_rk, 0.000000000000000000e+00_rk, -7.775105849101819622e-02_rk,  &
                                        -7.894528790896068737e-03_rk, 0.000000000000000000e+00_rk, -5.582274842315045754e-03_rk,  &
                                        -1.078412687927169170e-02_rk, 1.867865567016775696e-02_rk, -2.083333333333331136e-02_rk,  &
                                        -4.024690942871114729e-02_rk, -6.970969197815057861e-02_rk, 2.083333333333331136e-02_rk,  &
                                        1.099566014068617398e-01_rk, 0.000000000000000000e+00_rk, 7.775105849101819622e-02_rk,  &
                                        -2.946278254943945213e-02_rk, 0.000000000000000000e+00_rk, 5.582274842315045754e-03_rk,  &
                                        -4.024690942871114729e-02_rk, 6.970969197815057861e-02_rk, 2.083333333333331136e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(7,:,:) = reshape((/                                                                                 &
                                        1.078412687927169170e-02_rk, -1.867865567016775696e-02_rk, -2.083333333333330789e-02_rk,  &
                                        7.894528790896068737e-03_rk, -1.095585954027376917e-19_rk, -5.582274842315045754e-03_rk,  &
                                        -2.946278254943944866e-02_rk, -1.525954382392859988e-18_rk, -7.775105849101818234e-02_rk,  &
                                        1.078412687927168823e-02_rk, 1.867865567016775696e-02_rk, -2.083333333333330789e-02_rk,  &
                                        4.024690942871114729e-02_rk, -6.970969197815057861e-02_rk, 2.083333333333331136e-02_rk,  &
                                        2.946278254943944866e-02_rk, 1.095585954027376917e-19_rk, 5.582274842315045754e-03_rk,  &
                                        -1.099566014068617259e-01_rk, 1.525954382392859988e-18_rk, 7.775105849101818234e-02_rk,  &
                                        4.024690942871113342e-02_rk, 6.970969197815057861e-02_rk, 2.083333333333330789e-02_rk  &
                                        /),(/3,8/))
        
        test_djinv_dx(8,:,:) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.894528790896067003e-03_rk, -5.582274842315045754e-03_rk,  &
                                        1.867865567016775696e-02_rk, -1.078412687927168823e-02_rk, -2.083333333333331136e-02_rk,  &
                                        -1.867865567016775696e-02_rk, -1.078412687927168823e-02_rk, -2.083333333333331136e-02_rk,  &
                                        0.000000000000000000e+00_rk, 2.946278254943944172e-02_rk, -7.775105849101819622e-02_rk,  &
                                        0.000000000000000000e+00_rk, -2.946278254943944172e-02_rk, 5.582274842315045754e-03_rk,  &
                                        6.970969197815059248e-02_rk, -4.024690942871112648e-02_rk, 2.083333333333331136e-02_rk,  &
                                        -6.970969197815059248e-02_rk, -4.024690942871112648e-02_rk, 2.083333333333331136e-02_rk,  &
                                        0.000000000000000000e+00_rk, 1.099566014068616981e-01_rk, 7.775105849101819622e-02_rk  &
                                        /),(/3,8/))
        


        do inode = 1,self%elem%basis_s%nnodes_elem()
            @assertEqual(transpose(test_djinv_dx(inode,:,:)),self%elem%djinv_dx(inode,:,:), 1.e-14_rk)
        end do
        
    end subroutine testElement_djinv_dx
    !***************************************************************************************





    !> Test element dmetric_dx entries at quadrature points
    !!
    !!
    !!-------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmetric_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self

        real(rk)    :: test_metric(3,3,self%elem%basis_s%nnodes_elem())
        real(rk)    :: test_dmetric_dx(3,3,8,8,3), test_dmetric_dx_trans(3,3)
        integer(ik) :: inode, inode_diff, idir, irow
        


        
        test_dmetric_dx(:,:,1,1,1) = reshape((/                                                                                 &
                                        -1.332267629550187849e-15_rk, 1.244016935856292916e+00_rk, 8.796528112548945844e-01_rk, &
                                        2.220446049250313081e-16_rk, -1.244016935856293360e+00_rk, -8.796528112548952505e-01_rk, &
                                        8.632101532570588168e-18_rk, -4.622231866529366047e-33_rk, 6.661338147750939243e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,1,2) = reshape((/                                                                                 &
                                        -4.440892098500626162e-16_rk, 1.244016935856293360e+00_rk, 8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856293138e+00_rk, 8.796528112548952505e-01_rk, &
                                        4.622231866529366047e-33_rk, -8.632101532570588168e-18_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        -6.219331659439394741e-16_rk, 1.759305622509790501e+00_rk, 1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,1) = reshape((/                                                                                 &
                                        -7.886751345948130876e-01_rk, -4.553418012614800503e-01_rk, 2.357022603955157836e-01_rk, &
                                        7.886751345948130876e-01_rk, 4.553418012614800503e-01_rk, -2.357022603955160334e-01_rk, &
                                        2.218177581166722988e-16_rk, -2.304498596492429116e-16_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,2) = reshape((/                                                                                 &
                                        -7.886751345948137537e-01_rk, -4.553418012614799948e-01_rk, 2.357022603955157003e-01_rk, &
                                        -7.886751345948128655e-01_rk, -4.553418012614801058e-01_rk, 2.357022603955157003e-01_rk, &
                                        5.472533083603161372e-18_rk, 3.159568448967421404e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.115355071650410368e+00_rk, -6.439505508593794669e-01_rk, 3.333333333333330928e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,1) = reshape((/                                                                                 &
                                        7.886751345948133096e-01_rk, -4.553418012614791621e-01_rk, 2.357022603955158946e-01_rk, &
                                        -7.886751345948137537e-01_rk, 4.553418012614802723e-01_rk, -2.357022603955158946e-01_rk, &
                                        -2.142591072067926463e-16_rk, 2.165720718414284056e-16_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,2) = reshape((/                                                                                 &
                                        7.886751345948136427e-01_rk, -4.553418012614799948e-01_rk, 2.357022603955158668e-01_rk, &
                                        7.886751345948135317e-01_rk, -4.553418012614801058e-01_rk, 2.357022603955158668e-01_rk, &
                                        -5.472533083603165994e-18_rk, 3.159568448967421404e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.115355071650411256e+00_rk, -6.439505508593794669e-01_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,1) = reshape((/                                                                                 &
                                        4.440892098500626162e-16_rk, -3.333333333333334814e-01_rk, 6.315623032716853602e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, -6.315623032716873031e-02_rk, &
                                        -2.312964634635745360e-18_rk, 1.155557966632341512e-33_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,2) = reshape((/                                                                                 &
                                        5.551115123125782702e-16_rk, -3.333333333333334259e-01_rk, 6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk, 6.315623032716871643e-02_rk, &
                                        3.851859888774471706e-34_rk, 2.312964634635743820e-18_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,4,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -7.806638855257792091e-17_rk, -4.714045207910317337e-01_rk, 8.931639747704094023e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,1) = reshape((/                                                                                 &
                                        -5.551115123125782702e-16_rk, 3.333333333333334259e-01_rk, -8.796528112548941403e-01_rk, &
                                        -5.551115123125782702e-17_rk, -3.333333333333334259e-01_rk, 8.796528112548956946e-01_rk, &
                                        2.312964634635743820e-18_rk, 3.851859888774471706e-34_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,2) = reshape((/                                                                                 &
                                        -5.551115123125782702e-16_rk, 3.333333333333334259e-01_rk, -8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk, -8.796528112548952505e-01_rk, &
                                        -3.851859888774471706e-34_rk, -2.312964634635743820e-18_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        1.110223024625156540e-16_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        7.240080540461741391e-17_rk, 4.714045207910317337e-01_rk, -1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,1) = reshape((/                                                                                 &
                                        -2.113248654051870234e-01_rk, -1.220084679281465134e-01_rk, -2.357022603955158946e-01_rk, &
                                        2.113248654051873565e-01_rk, 1.220084679281460138e-01_rk, 2.357022603955158946e-01_rk, &
                                        -3.098785029861966369e-19_rk, -2.003086131649547953e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,2) = reshape((/                                                                                 &
                                        -2.113248654051874398e-01_rk, -1.220084679281463469e-01_rk, -2.357022603955158668e-01_rk, &
                                        -2.113248654051871345e-01_rk, -1.220084679281463191e-01_rk, -2.357022603955158668e-01_rk, &
                                        1.466360820304068932e-18_rk, 8.466038143316752730e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.988584907226845000e-01_rk, -1.725460300683473169e-01_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,1) = reshape((/                                                                                 &
                                        2.113248654051870234e-01_rk, -1.220084679281461248e-01_rk, -2.357022603955157836e-01_rk, &
                                        -2.113248654051872455e-01_rk, 1.220084679281464024e-01_rk, 2.357022603955160334e-01_rk, &
                                        -1.383329125677152753e-18_rk, 2.003086131649546798e-18_rk, 1.665334536937734811e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,2) = reshape((/                                                                                 &
                                        2.113248654051875230e-01_rk, -1.220084679281463469e-01_rk, -2.357022603955160334e-01_rk, &
                                        2.113248654051871900e-01_rk, -1.220084679281463191e-01_rk, -2.357022603955160334e-01_rk, &
                                        -1.466360820304069317e-18_rk, 8.466038143316752730e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        2.988584907226846110e-01_rk, -1.725460300683473169e-01_rk, -3.333333333333335924e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,1) = reshape((/                                                                                 &
                                        2.498001805406602216e-16_rk, -8.931639747704088472e-02_rk, -6.315623032716854990e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704087084e-02_rk, 6.315623032716871643e-02_rk, &
                                        -6.197570059723948145e-19_rk, 8.666684749742561339e-34_rk, -1.665334536937734811e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,2) = reshape((/                                                                                 &
                                        1.387778780781445676e-16_rk, -8.931639747704099574e-02_rk, -6.315623032716871643e-02_rk, &
                                        1.110223024625156540e-16_rk, -8.931639747704098187e-02_rk, -6.315623032716871643e-02_rk, &
                                        -8.666684749742561339e-34_rk, 6.197570059723948145e-19_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,1,8,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.761971672203140013e-16_rk, -1.263124606543374329e-01_rk, -8.931639747704094023e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,1) = reshape((/                                                                                 &
                                        4.553418012614796062e-01_rk, 7.886751345948133096e-01_rk, 2.357022603955162832e-01_rk, &
                                        -4.553418012614800503e-01_rk, -7.886751345948126435e-01_rk, -2.357022603955155060e-01_rk, &
                                        -2.220446049250315053e-16_rk, 2.220446049250315053e-16_rk, 8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,2) = reshape((/                                                                                 &
                                        4.553418012614791621e-01_rk, 7.886751345948131986e-01_rk, 2.357022603955157836e-01_rk, &
                                        4.553418012614796062e-01_rk, 7.886751345948130876e-01_rk, 2.357022603955157558e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.906538933386798937e-18_rk, &
                                        2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, -4.906538933386797396e-18_rk, &
                                        6.439505508593789118e-01_rk, 1.115355071650410812e+00_rk, 3.333333333333332038e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,1) = reshape((/                                                                                 &
                                        -1.244016935856291362e+00_rk, -8.881784197001252323e-16_rk, 8.796528112548946954e-01_rk, &
                                        1.244016935856293138e+00_rk, -8.881784197001252323e-16_rk, -8.796528112548951395e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,2) = reshape((/                                                                                 &
                                        -1.244016935856293582e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, &
                                        -1.244016935856292694e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,2,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 1.831145258871435375e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.831145258871434759e-17_rk, &
                                        -1.759305622509789613e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,1) = reshape((/                                                                                 &
                                        3.333333333333328152e-01_rk, 3.330669073875469621e-16_rk, 6.315623032716873031e-02_rk, &
                                        -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk, -6.315623032716853602e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,2) = reshape((/                                                                                 &
                                        3.333333333333338699e-01_rk, 0.000000000000000000e+00_rk, 6.315623032716853602e-02_rk, &
                                        3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk, 6.315623032716853602e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.314703144832852589e-18_rk, &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, -1.314703144832852204e-18_rk, &
                                        4.714045207910317337e-01_rk, 0.000000000000000000e+00_rk, 8.931639747704071819e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,1) = reshape((/                                                                                 &
                                        4.553418012614801613e-01_rk, -7.886751345948129766e-01_rk, 2.357022603955159779e-01_rk, &
                                        -4.553418012614798283e-01_rk, 7.886751345948131986e-01_rk, -2.357022603955158391e-01_rk, &
                                        2.289834988289387337e-16_rk, -2.289834988289387337e-16_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,2) = reshape((/                                                                                 &
                                        4.553418012614807164e-01_rk, -7.886751345948131986e-01_rk, 2.357022603955158391e-01_rk, &
                                        4.553418012614796062e-01_rk, -7.886751345948130876e-01_rk, 2.357022603955158668e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,4,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -5.551115123125782702e-17_rk, 4.906538933386800477e-18_rk, &
                                        2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, -4.906538933386798937e-18_rk, &
                                        6.439505508593791339e-01_rk, -1.115355071650410812e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,1) = reshape((/                                                                                 &
                                        1.220084679281461248e-01_rk, 2.113248654051873565e-01_rk, -2.357022603955159501e-01_rk, &
                                        -1.220084679281464024e-01_rk, -2.113248654051870234e-01_rk, 2.357022603955158391e-01_rk, &
                                        -6.938893903907234541e-18_rk, 6.938893903907234541e-18_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,2) = reshape((/                                                                                 &
                                        1.220084679281460138e-01_rk, 2.113248654051871345e-01_rk, -2.357022603955158391e-01_rk, &
                                        1.220084679281462914e-01_rk, 2.113248654051870790e-01_rk, -2.357022603955158391e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -4.906538933386799707e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.906538933386798166e-18_rk, &
                                        1.725460300683472337e-01_rk, 2.988584907226845555e-01_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,1) = reshape((/                                                                                 &
                                        -3.333333333333325932e-01_rk, -1.110223024625156540e-16_rk, -8.796528112548948064e-01_rk, &
                                        3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk, 8.796528112548949174e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,2) = reshape((/                                                                                 &
                                        -3.333333333333338699e-01_rk, 0.000000000000000000e+00_rk, -8.796528112548952505e-01_rk, &
                                        -3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk, -8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -1.831145258871435991e-17_rk, &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 1.831145258871435375e-17_rk, &
                                        -4.714045207910317337e-01_rk, 0.000000000000000000e+00_rk, -1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,1) = reshape((/                                                                                 &
                                        8.931639747704073207e-02_rk, 8.326672684688674053e-17_rk, -6.315623032716853602e-02_rk, &
                                        -8.931639747704098187e-02_rk, 1.110223024625156540e-16_rk, 6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,2) = reshape((/                                                                                 &
                                        8.931639747704110677e-02_rk, 0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, &
                                        8.931639747704085697e-02_rk, 0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.314703144832856056e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.314703144832855671e-18_rk, &
                                        1.263124606543372663e-01_rk, 0.000000000000000000e+00_rk, -8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,1) = reshape((/                                                                                 &
                                        1.220084679281464302e-01_rk, -2.113248654051872455e-01_rk, -2.357022603955159779e-01_rk, &
                                        -1.220084679281461665e-01_rk, 2.113248654051870234e-01_rk, 2.357022603955157836e-01_rk, &
                                        3.469446951953617270e-18_rk, -3.469446951953617270e-18_rk, -1.734723475976807094e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,2) = reshape((/                                                                                 &
                                        1.220084679281466244e-01_rk, -2.113248654051871345e-01_rk, -2.357022603955158668e-01_rk, &
                                        1.220084679281461804e-01_rk, -2.113248654051870790e-01_rk, -2.357022603955158668e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,2,8,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, -4.906538933386800477e-18_rk, &
                                        -2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, 4.906538933386798937e-18_rk, &
                                        1.725460300683472892e-01_rk, -2.988584907226845555e-01_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,1) = reshape((/                                                                                 &
                                        -4.553418012614806609e-01_rk, 7.886751345948125325e-01_rk, 2.357022603955159223e-01_rk, &
                                        4.553418012614803834e-01_rk, -7.886751345948136427e-01_rk, -2.357022603955158668e-01_rk, &
                                        2.211980011106999240e-16_rk, -2.188850364760640908e-16_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,2) = reshape((/                                                                                 &
                                        -4.553418012614804944e-01_rk, 7.886751345948131986e-01_rk, 2.357022603955158113e-01_rk, &
                                        -4.553418012614800503e-01_rk, 7.886751345948130876e-01_rk, 2.357022603955158113e-01_rk, &
                                        3.159568448967421404e-18_rk, -5.472533083603162912e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,1,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, -6.542051911182396785e-18_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -6.542051911182396785e-18_rk, &
                                        -6.439505508593795780e-01_rk, 1.115355071650410812e+00_rk, 3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,1) = reshape((/                                                                                 &
                                        -3.333333333333328152e-01_rk, -3.330669073875469621e-16_rk, 6.315623032716836949e-02_rk, &
                                        3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk, -6.315623032716889684e-02_rk, &
                                        -4.625929269271489951e-18_rk, 2.312964634635744590e-18_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,2) = reshape((/                                                                                 &
                                        -3.333333333333338699e-01_rk, -3.098785029861965406e-19_rk, 6.315623032716854990e-02_rk, &
                                        -3.333333333333334259e-01_rk, -3.098785029861965406e-19_rk, 6.315623032716854990e-02_rk, &
                                        2.312964634635743820e-18_rk, 2.150214055322817374e-36_rk, -4.382343816109507668e-19_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,2,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, -1.752937526443803067e-18_rk, &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, -1.752937526443803067e-18_rk, &
                                        -4.714045207910318447e-01_rk, -4.382343816109507668e-19_rk, 8.931639747704074594e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,1) = reshape((/                                                                                 &
                                        1.244016935856292250e+00_rk, 8.881784197001252323e-16_rk, 8.796528112548943623e-01_rk, &
                                        -1.244016935856294026e+00_rk, 8.881784197001252323e-16_rk, -8.796528112548955836e-01_rk, &
                                        1.726420306514117634e-17_rk, -8.632101532570588168e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,2) = reshape((/                                                                                 &
                                        1.244016935856293582e+00_rk, -4.316050766285291773e-18_rk, 8.796528112548951395e-01_rk, &
                                        1.244016935856292694e+00_rk, -4.316050766285291773e-18_rk, 8.796528112548951395e-01_rk, &
                                        -8.632101532570582005e-18_rk, 2.994861835113113812e-35_rk, -6.103817529571448425e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -2.441527011828579678e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.441527011828579370e-17_rk, &
                                        1.759305622509789835e+00_rk, -6.103817529571448425e-18_rk, 1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,1) = reshape((/                                                                                 &
                                        -4.553418012614791621e-01_rk, -7.886751345948135317e-01_rk, 2.357022603955159779e-01_rk, &
                                        4.553418012614800503e-01_rk, 7.886751345948130876e-01_rk, -2.357022603955158946e-01_rk, &
                                        -2.268973810026623535e-16_rk, 2.182652794700917160e-16_rk, -8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,2) = reshape((/                                                                                 &
                                        -4.553418012614791621e-01_rk, -7.886751345948131986e-01_rk, 2.357022603955158113e-01_rk, &
                                        -4.553418012614793842e-01_rk, -7.886751345948130876e-01_rk, 2.357022603955158113e-01_rk, &
                                        3.159568448967416782e-18_rk, 5.472533083603162912e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,4,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 5.551115123125782702e-17_rk, -6.542051911182396785e-18_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, -6.542051911182396785e-18_rk, &
                                        -6.439505508593785787e-01_rk, -1.115355071650410812e+00_rk, 3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,1) = reshape((/                                                                                 &
                                        -1.220084679281467355e-01_rk, 2.113248654051869679e-01_rk, -2.357022603955155060e-01_rk, &
                                        1.220084679281465134e-01_rk, -2.113248654051873288e-01_rk, 2.357022603955163109e-01_rk, &
                                        6.712047095547955623e-18_rk, -6.092290089575558497e-18_rk, 1.457167719820517959e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,2) = reshape((/                                                                                 &
                                        -1.220084679281466800e-01_rk, 2.113248654051871345e-01_rk, -2.357022603955158668e-01_rk, &
                                        -1.220084679281462914e-01_rk, 2.113248654051870790e-01_rk, -2.357022603955158668e-01_rk, &
                                        8.466038143316756581e-19_rk, -1.466360820304068932e-18_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 6.542051911182398326e-18_rk, &
                                        -2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, 6.542051911182399096e-18_rk, &
                                        -1.725460300683474002e-01_rk, 2.988584907226845555e-01_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,1) = reshape((/                                                                                 &
                                        -8.931639747704078758e-02_rk, -8.326672684688674053e-17_rk, -6.315623032716853602e-02_rk, &
                                        8.931639747704098187e-02_rk, -1.110223024625156540e-16_rk, 6.315623032716871643e-02_rk, &
                                        -1.239514011944789822e-18_rk, 6.197570059723955849e-19_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,2) = reshape((/                                                                                 &
                                        -8.931639747704110677e-02_rk, 3.098785029861973591e-19_rk, -6.315623032716871643e-02_rk, &
                                        -8.931639747704085697e-02_rk, 3.098785029861973110e-19_rk, -6.315623032716871643e-02_rk, &
                                        6.197570059723938516e-19_rk, -2.150214055322823054e-36_rk, 4.382343816109519224e-19_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.752937526443807304e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.752937526443807304e-18_rk, &
                                        -1.263124606543372663e-01_rk, 4.382343816109518261e-19_rk, -8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,1) = reshape((/                                                                                 &
                                        3.333333333333328152e-01_rk, 1.110223024625156540e-16_rk, -8.796528112548943623e-01_rk, &
                                        -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk, 8.796528112548955836e-01_rk, &
                                        4.625929269271488410e-18_rk, -2.312964634635743049e-18_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,2) = reshape((/                                                                                 &
                                        3.333333333333338699e-01_rk, 4.316050766285292543e-18_rk, -8.796528112548952505e-01_rk, &
                                        3.333333333333334259e-01_rk, 4.316050766285292543e-18_rk, -8.796528112548952505e-01_rk, &
                                        -2.312964634635743820e-18_rk, -2.994861835113114347e-35_rk, 6.103817529571449966e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,7,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, -1.110223024625156540e-16_rk, 2.441527011828580295e-17_rk, &
                                        1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 2.441527011828580295e-17_rk, &
                                        4.714045207910318447e-01_rk, 6.103817529571450737e-18_rk, -1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,1) = reshape((/                                                                                 &
                                        -1.220084679281457918e-01_rk, -2.113248654051870790e-01_rk, -2.357022603955159501e-01_rk, &
                                        1.220084679281462359e-01_rk, 2.113248654051872455e-01_rk, 2.357022603955158668e-01_rk, &
                                        -3.159568448967418707e-18_rk, 8.466038143316737322e-19_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,2) = reshape((/                                                                                 &
                                        -1.220084679281460138e-01_rk, -2.113248654051871345e-01_rk, -2.357022603955158391e-01_rk, &
                                        -1.220084679281462359e-01_rk, -2.113248654051870790e-01_rk, -2.357022603955158391e-01_rk, &
                                        8.466038143316743100e-19_rk, 1.466360820304068932e-18_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,3,8,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, 6.542051911182397555e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.542051911182397555e-18_rk, &
                                        -1.725460300683471504e-01_rk, -2.988584907226845555e-01_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,1) = reshape((/                                                                                 &
                                        -3.330669073875469621e-16_rk, 3.333333333333334814e-01_rk, 6.315623032716895235e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333335369e-01_rk, -6.315623032716834173e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.330669073875469621e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,2) = reshape((/                                                                                 &
                                        -5.551115123125782702e-16_rk, 3.333333333333333148e-01_rk, 6.315623032716873031e-02_rk, &
                                        1.110223024625156540e-16_rk, 3.333333333333332038e-01_rk, 6.315623032716873031e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        3.925231146709443463e-17_rk, 4.714045207910317337e-01_rk, 8.931639747704100962e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,1) = reshape((/                                                                                 &
                                        -7.886751345948128655e-01_rk, 4.553418012614798283e-01_rk, 2.357022603955159779e-01_rk, &
                                        7.886751345948133096e-01_rk, -4.553418012614796062e-01_rk, -2.357022603955159501e-01_rk, &
                                        -2.220446049250316039e-16_rk, 2.220446049250315546e-16_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,2) = reshape((/                                                                                 &
                                        -7.886751345948137537e-01_rk, 4.553418012614798283e-01_rk, 2.357022603955158668e-01_rk, &
                                        -7.886751345948134206e-01_rk, 4.553418012614797172e-01_rk, 2.357022603955158668e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.115355071650411700e+00_rk, 6.439505508593794669e-01_rk, 3.333333333333334814e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,1) = reshape((/                                                                                 &
                                        7.886751345948126435e-01_rk, 4.553418012614791621e-01_rk, 2.357022603955162277e-01_rk, &
                                        -7.886751345948130876e-01_rk, -4.553418012614804944e-01_rk, -2.357022603955157003e-01_rk, &
                                        2.220446049250316039e-16_rk, -2.220446049250315546e-16_rk, 8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,2) = reshape((/                                                                                 &
                                        7.886751345948136427e-01_rk, 4.553418012614798283e-01_rk, 2.357022603955157003e-01_rk, &
                                        7.886751345948127545e-01_rk, 4.553418012614797172e-01_rk, 2.357022603955157003e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.115355071650410590e+00_rk, 6.439505508593794669e-01_rk, 3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,1) = reshape((/                                                                                 &
                                        8.881784197001252323e-16_rk, -1.244016935856292916e+00_rk, 8.796528112548949174e-01_rk, &
                                        -2.220446049250313081e-16_rk, 1.244016935856292916e+00_rk, -8.796528112548954725e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,2) = reshape((/                                                                                 &
                                        4.440892098500626162e-16_rk, -1.244016935856292916e+00_rk, 8.796528112548952505e-01_rk, &
                                        4.440892098500626162e-16_rk, -1.244016935856292694e+00_rk, 8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        1.110223024625156540e-16_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        7.850462293418887420e-16_rk, -1.759305622509790501e+00_rk, 1.244016935856293804e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,1) = reshape((/                                                                                 &
                                        -2.498001805406602216e-16_rk, 8.931639747704085697e-02_rk, -6.315623032716856378e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704087084e-02_rk, 6.315623032716873031e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.942890293094023946e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,2) = reshape((/                                                                                 &
                                        -1.387778780781445676e-16_rk, 8.931639747704095411e-02_rk, -6.315623032716871643e-02_rk, &
                                        -1.110223024625156540e-16_rk, 8.931639747704094023e-02_rk, -6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,5,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.864484794686985614e-16_rk, 1.263124606543374329e-01_rk, -8.931639747704098187e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,1) = reshape((/                                                                                 &
                                        -2.113248654051868569e-01_rk, 1.220084679281464579e-01_rk, -2.357022603955161444e-01_rk, &
                                        2.113248654051871345e-01_rk, -1.220084679281461248e-01_rk, 2.357022603955157836e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,2) = reshape((/                                                                                 &
                                        -2.113248654051875230e-01_rk, 1.220084679281462636e-01_rk, -2.357022603955160334e-01_rk, &
                                        -2.113248654051871345e-01_rk, 1.220084679281462497e-01_rk, -2.357022603955160334e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,6,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.988584907226846665e-01_rk, 1.725460300683473169e-01_rk, -3.333333333333337034e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,1) = reshape((/                                                                                 &
                                        2.113248654051866904e-01_rk, 1.220084679281463469e-01_rk, -2.357022603955159779e-01_rk, &
                                        -2.113248654051870234e-01_rk, -1.220084679281465689e-01_rk, 2.357022603955159501e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,2) = reshape((/                                                                                 &
                                        2.113248654051874120e-01_rk, 1.220084679281462636e-01_rk, -2.357022603955158668e-01_rk, &
                                        2.113248654051871622e-01_rk, 1.220084679281462497e-01_rk, -2.357022603955158668e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        2.988584907226846110e-01_rk, 1.725460300683473169e-01_rk, -3.333333333333334814e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,1) = reshape((/                                                                                 &
                                        3.330669073875469621e-16_rk, -3.333333333333334259e-01_rk, -8.796528112548951395e-01_rk, &
                                        -5.551115123125782702e-17_rk, 3.333333333333334259e-01_rk, 8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,2) = reshape((/                                                                                 &
                                        5.551115123125782702e-16_rk, -3.333333333333333148e-01_rk, -8.796528112548952505e-01_rk, &
                                        -1.110223024625156540e-16_rk, -3.333333333333332038e-01_rk, -8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,4,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        -3.925231146709443463e-17_rk, -4.714045207910317337e-01_rk, -1.244016935856293804e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,1) = reshape((/                                                                                 &
                                        -4.440892098500626162e-16_rk, 3.333333333333334259e-01_rk, 8.796528112548941403e-01_rk, &
                                        -5.551115123125782702e-17_rk, -3.333333333333334259e-01_rk, -8.796528112548955836e-01_rk, &
                                        -9.251858538542966034e-18_rk, -1.078520768856852078e-32_rk, -6.106226635438360972e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,2) = reshape((/                                                                                 &
                                        -5.551115123125782702e-16_rk, 3.333333333333333148e-01_rk, 8.796528112548951395e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333332593e-01_rk, 8.796528112548951395e-01_rk, &
                                        1.540743955509788682e-33_rk, 9.251858538542972197e-18_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.483704134880862861e-17_rk, 4.714045207910316782e-01_rk, 1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,1) = reshape((/                                                                                 &
                                        -2.113248654051868014e-01_rk, -1.220084679281464579e-01_rk, 2.357022603955159501e-01_rk, &
                                        2.113248654051872455e-01_rk, 1.220084679281462359e-01_rk, -2.357022603955158391e-01_rk, &
                                        2.510396945526052670e-16_rk, -2.417878360140622794e-16_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,2) = reshape((/                                                                                 &
                                        -2.113248654051874120e-01_rk, -1.220084679281463053e-01_rk, 2.357022603955158391e-01_rk, &
                                        -2.113248654051871067e-01_rk, -1.220084679281462775e-01_rk, 2.357022603955158391e-01_rk, &
                                        -5.865443281216274187e-18_rk, -3.386415257326699936e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,2,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.988584907226844445e-01_rk, -1.725460300683472892e-01_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,1) = reshape((/                                                                                 &
                                        2.113248654051870234e-01_rk, -1.220084679281460138e-01_rk, 2.357022603955157836e-01_rk, &
                                        -2.113248654051872455e-01_rk, 1.220084679281464024e-01_rk, -2.357022603955159779e-01_rk, &
                                        -2.581446518457663339e-16_rk, 2.556656238218767361e-16_rk, -2.775557561562891351e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,2) = reshape((/                                                                                 &
                                        2.113248654051874675e-01_rk, -1.220084679281463053e-01_rk, 2.357022603955159779e-01_rk, &
                                        2.113248654051871622e-01_rk, -1.220084679281462775e-01_rk, 2.357022603955159779e-01_rk, &
                                        5.865443281216275728e-18_rk, -3.386415257326699936e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,3,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.988584907226845555e-01_rk, -1.725460300683472892e-01_rk, 3.333333333333335369e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,1) = reshape((/                                                                                 &
                                        2.498001805406602216e-16_rk, -8.931639747704087084e-02_rk, 6.315623032716853602e-02_rk, &
                                        -1.387778780781445676e-17_rk, 8.931639747704085697e-02_rk, -6.315623032716871643e-02_rk, &
                                        2.479028023889579258e-18_rk, -3.466673899897024536e-33_rk, -1.387778780781445676e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,2) = reshape((/                                                                                 &
                                        1.665334536937734811e-16_rk, -8.931639747704095411e-02_rk, 6.315623032716871643e-02_rk, &
                                        1.110223024625156540e-16_rk, -8.931639747704095411e-02_rk, 6.315623032716871643e-02_rk, &
                                        3.466673899897024536e-33_rk, -2.479028023889578488e-18_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.846955419422547187e-16_rk, -1.263124606543374329e-01_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,1) = reshape((/                                                                                 &
                                        -4.440892098500626162e-16_rk, 1.244016935856292916e+00_rk, -8.796528112548946954e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292694e+00_rk, 8.796528112548951395e-01_rk, &
                                        -3.452840613028234035e-17_rk, 1.232595164407830946e-32_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,2) = reshape((/                                                                                 &
                                        -8.881784197001252323e-16_rk, 1.244016935856293138e+00_rk, -8.796528112548951395e-01_rk, &
                                        -4.440892098500626162e-16_rk, 1.244016935856292916e+00_rk, -8.796528112548951395e-01_rk, &
                                        -6.162975822039154730e-33_rk, 3.452840613028232802e-17_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -7.606309592236027234e-16_rk, 1.759305622509790279e+00_rk, -1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,1) = reshape((/                                                                                 &
                                        -7.886751345948126435e-01_rk, -4.553418012614802723e-01_rk, -2.357022603955157558e-01_rk, &
                                        7.886751345948135317e-01_rk, 4.553418012614796062e-01_rk, 2.357022603955160334e-01_rk, &
                                        1.119296896959528745e-16_rk, -7.740128356567053414e-17_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,2) = reshape((/                                                                                 &
                                        -7.886751345948137537e-01_rk, -4.553418012614799948e-01_rk, -2.357022603955156725e-01_rk, &
                                        -7.886751345948128655e-01_rk, -4.553418012614797727e-01_rk, -2.357022603955156725e-01_rk, &
                                        -2.189013233441264549e-17_rk, -1.263827379586968099e-17_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.115355071650410368e+00_rk, -6.439505508593794669e-01_rk, -3.333333333333330373e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,1) = reshape((/                                                                                 &
                                        7.886751345948128655e-01_rk, -4.553418012614789401e-01_rk, -2.357022603955159501e-01_rk, &
                                        -7.886751345948135317e-01_rk, 4.553418012614798283e-01_rk, 2.357022603955158391e-01_rk, &
                                        -8.665314210421352174e-17_rk, 7.740128356567052181e-17_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,2) = reshape((/                                                                                 &
                                        7.886751345948137537e-01_rk, -4.553418012614799948e-01_rk, -2.357022603955158391e-01_rk, &
                                        7.886751345948133096e-01_rk, -4.553418012614797727e-01_rk, -2.357022603955158391e-01_rk, &
                                        2.189013233441265781e-17_rk, -1.263827379586968099e-17_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,7,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.115355071650411478e+00_rk, -6.439505508593794669e-01_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,1) = reshape((/                                                                                 &
                                        4.440892098500626162e-16_rk, -3.333333333333334814e-01_rk, -6.315623032716853602e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, 6.315623032716871643e-02_rk, &
                                        9.251858538542975279e-18_rk, 1.540743955509788682e-33_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,2) = reshape((/                                                                                 &
                                        5.551115123125782702e-16_rk, -3.333333333333333148e-01_rk, -6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333332593e-01_rk, -6.315623032716871643e-02_rk, &
                                        -1.540743955509788682e-33_rk, -9.251858538542972197e-18_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,5,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.749937394065062271e-17_rk, -4.714045207910316782e-01_rk, -8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,1) = reshape((/                                                                                 &
                                        1.220084679281462359e-01_rk, 2.113248654051873565e-01_rk, 2.357022603955159501e-01_rk, &
                                        -1.220084679281464024e-01_rk, -2.113248654051870234e-01_rk, -2.357022603955158668e-01_rk, &
                                        -2.220446049250315546e-16_rk, 2.220446049250315053e-16_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,2) = reshape((/                                                                                 &
                                        1.220084679281460138e-01_rk, 2.113248654051871067e-01_rk, 2.357022603955158391e-01_rk, &
                                        1.220084679281462359e-01_rk, 2.113248654051870512e-01_rk, 2.357022603955158391e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,1,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, 4.906538933386799707e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.906538933386798166e-18_rk, &
                                        1.725460300683472892e-01_rk, 2.988584907226845000e-01_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,1) = reshape((/                                                                                 &
                                        -3.333333333333330373e-01_rk, -2.220446049250313081e-16_rk, 8.796528112548949174e-01_rk, &
                                        3.333333333333334814e-01_rk, 1.110223024625156540e-16_rk, -8.796528112548949174e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,2) = reshape((/                                                                                 &
                                        -3.333333333333338144e-01_rk, 0.000000000000000000e+00_rk, 8.796528112548952505e-01_rk, &
                                        -3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk, 8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,2,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 1.831145258871435991e-17_rk, &
                                        -1.110223024625156540e-16_rk, -1.110223024625156540e-16_rk, -1.831145258871435375e-17_rk, &
                                        -4.714045207910318447e-01_rk, 0.000000000000000000e+00_rk, 1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,1) = reshape((/                                                                                 &
                                        8.931639747704073207e-02_rk, 8.326672684688674053e-17_rk, 6.315623032716854990e-02_rk, &
                                        -8.931639747704098187e-02_rk, 1.110223024625156540e-16_rk, -6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,2) = reshape((/                                                                                 &
                                        8.931639747704112064e-02_rk, 0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, &
                                        8.931639747704085697e-02_rk, 0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.314703144832856056e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.314703144832855671e-18_rk, &
                                        1.263124606543372663e-01_rk, 0.000000000000000000e+00_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,1) = reshape((/                                                                                 &
                                        1.220084679281464440e-01_rk, -2.113248654051871900e-01_rk, 2.357022603955159779e-01_rk, &
                                        -1.220084679281462220e-01_rk, 2.113248654051870234e-01_rk, -2.357022603955158391e-01_rk, &
                                        2.428612866367532397e-16_rk, -2.428612866367532397e-16_rk, 1.942890293094023946e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,2) = reshape((/                                                                                 &
                                        1.220084679281466800e-01_rk, -2.113248654051871067e-01_rk, 2.357022603955158391e-01_rk, &
                                        1.220084679281462359e-01_rk, -2.113248654051870512e-01_rk, 2.357022603955158391e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,4,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, 4.906538933386799707e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.906538933386798166e-18_rk, &
                                        1.725460300683472892e-01_rk, -2.988584907226845000e-01_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,1) = reshape((/                                                                                 &
                                        4.553418012614796062e-01_rk, 7.886751345948137537e-01_rk, -2.357022603955163664e-01_rk, &
                                        -4.553418012614804944e-01_rk, -7.886751345948126435e-01_rk, 2.357022603955154505e-01_rk, &
                                        -1.110223024625157773e-16_rk, 1.110223024625157526e-16_rk, 8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,2) = reshape((/                                                                                 &
                                        4.553418012614793842e-01_rk, 7.886751345948131986e-01_rk, -2.357022603955158113e-01_rk, &
                                        4.553418012614796062e-01_rk, 7.886751345948130876e-01_rk, -2.357022603955158113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,5,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, -4.906538933386798937e-18_rk, &
                                        2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, 4.906538933386798166e-18_rk, &
                                        6.439505508593789118e-01_rk, 1.115355071650410812e+00_rk, -3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,1) = reshape((/                                                                                 &
                                        -1.244016935856292250e+00_rk, -8.881784197001252323e-16_rk, -8.796528112548948064e-01_rk, &
                                        1.244016935856293582e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,2) = reshape((/                                                                                 &
                                        -1.244016935856293582e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548951395e-01_rk, &
                                        -1.244016935856292916e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548951395e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -1.831145258871435375e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.831145258871434759e-17_rk, &
                                        -1.759305622509789835e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,1) = reshape((/                                                                                 &
                                        3.333333333333328152e-01_rk, 1.110223024625156540e-16_rk, -6.315623032716870255e-02_rk, &
                                        -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk, 6.315623032716853602e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,2) = reshape((/                                                                                 &
                                        3.333333333333338144e-01_rk, 0.000000000000000000e+00_rk, -6.315623032716853602e-02_rk, &
                                        3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk, -6.315623032716853602e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.314703144832852589e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.314703144832852204e-18_rk, &
                                        4.714045207910318447e-01_rk, 0.000000000000000000e+00_rk, -8.931639747704071819e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,1) = reshape((/                                                                                 &
                                        4.553418012614801613e-01_rk, -7.886751345948129766e-01_rk, -2.357022603955159223e-01_rk, &
                                        -4.553418012614798838e-01_rk, 7.886751345948131986e-01_rk, 2.357022603955158668e-01_rk, &
                                        5.551115123125788865e-17_rk, -5.551115123125787632e-17_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,2) = reshape((/                                                                                 &
                                        4.553418012614802723e-01_rk, -7.886751345948131986e-01_rk, -2.357022603955158113e-01_rk, &
                                        4.553418012614800503e-01_rk, -7.886751345948130876e-01_rk, -2.357022603955158113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,6,8,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -5.551115123125782702e-17_rk, -4.906538933386798937e-18_rk, &
                                        2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, 4.906538933386798166e-18_rk, &
                                        6.439505508593791339e-01_rk, -1.115355071650410812e+00_rk, -3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,1) = reshape((/                                                                                 &
                                        -1.220084679281467077e-01_rk, 2.113248654051869402e-01_rk, 2.357022603955155060e-01_rk, &
                                        1.220084679281464857e-01_rk, -2.113248654051873010e-01_rk, -2.357022603955162554e-01_rk, &
                                        2.507075677740975899e-16_rk, -2.531865957979871877e-16_rk, -2.289834988289385365e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,2) = reshape((/                                                                                 &
                                        -1.220084679281466800e-01_rk, 2.113248654051871345e-01_rk, 2.357022603955158391e-01_rk, &
                                        -1.220084679281463469e-01_rk, 2.113248654051870790e-01_rk, 2.357022603955158391e-01_rk, &
                                        -3.386415257326701092e-18_rk, 5.865443281216275728e-18_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,1,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, -6.542051911182397555e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.542051911182397555e-18_rk, &
                                        -1.725460300683473447e-01_rk, 2.988584907226845555e-01_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,1) = reshape((/                                                                                 &
                                        -8.931639747704078758e-02_rk, -8.326672684688674053e-17_rk, 6.315623032716853602e-02_rk, &
                                        8.931639747704098187e-02_rk, -1.110223024625156540e-16_rk, -6.315623032716871643e-02_rk, &
                                        4.958056047779158516e-18_rk, -2.479028023889582340e-18_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,2) = reshape((/                                                                                 &
                                        -8.931639747704110677e-02_rk, 1.239514011944789436e-18_rk, 6.315623032716871643e-02_rk, &
                                        -8.931639747704085697e-02_rk, 1.239514011944789244e-18_rk, 6.315623032716871643e-02_rk, &
                                        -2.479028023889575406e-18_rk, 3.440342488516516886e-35_rk, 1.752937526443807690e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.752937526443807304e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.752937526443807304e-18_rk, &
                                        -1.263124606543372663e-01_rk, 1.752937526443807304e-18_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,1) = reshape((/                                                                                 &
                                        3.333333333333328152e-01_rk, 2.220446049250313081e-16_rk, 8.796528112548941403e-01_rk, &
                                        -3.333333333333334814e-01_rk, -1.110223024625156540e-16_rk, -8.796528112548955836e-01_rk, &
                                        -1.850371707708594131e-17_rk, 9.251858538542962953e-18_rk, -5.551115123125782702e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,2) = reshape((/                                                                                 &
                                        3.333333333333338144e-01_rk, 1.726420306514117017e-17_rk, 8.796528112548952505e-01_rk, &
                                        3.333333333333334259e-01_rk, 1.726420306514117017e-17_rk, 8.796528112548952505e-01_rk, &
                                        9.251858538542975279e-18_rk, 4.791778936180982955e-34_rk, 2.441527011828579986e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,3,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, -2.441527011828580295e-17_rk, &
                                        -1.110223024625156540e-16_rk, -1.110223024625156540e-16_rk, -2.441527011828580295e-17_rk, &
                                        4.714045207910317337e-01_rk, 2.441527011828580295e-17_rk, 1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,1) = reshape((/                                                                                 &
                                        -1.220084679281457918e-01_rk, -2.113248654051870790e-01_rk, 2.357022603955158668e-01_rk, &
                                        1.220084679281461804e-01_rk, 2.113248654051872455e-01_rk, -2.357022603955159223e-01_rk, &
                                        -2.163452250330691004e-16_rk, 2.255970835716120634e-16_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,2) = reshape((/                                                                                 &
                                        -1.220084679281460138e-01_rk, -2.113248654051871345e-01_rk, 2.357022603955158391e-01_rk, &
                                        -1.220084679281461248e-01_rk, -2.113248654051870790e-01_rk, 2.357022603955158391e-01_rk, &
                                        -3.386415257326698781e-18_rk, -5.865443281216275728e-18_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,4,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 2.775557561562891351e-17_rk, -6.542051911182397555e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.542051911182397555e-18_rk, &
                                        -1.725460300683471504e-01_rk, -2.988584907226845555e-01_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,1) = reshape((/                                                                                 &
                                        -4.553418012614808275e-01_rk, 7.886751345948125325e-01_rk, -2.357022603955159223e-01_rk, &
                                        4.553418012614803279e-01_rk, -7.886751345948137537e-01_rk, 2.357022603955159223e-01_rk, &
                                        1.144087177198424969e-16_rk, -1.236605762583854598e-16_rk, -1.387778780781445676e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,2) = reshape((/                                                                                 &
                                        -4.553418012614804944e-01_rk, 7.886751345948131986e-01_rk, -2.357022603955158668e-01_rk, &
                                        -4.553418012614800503e-01_rk, 7.886751345948130876e-01_rk, -2.357022603955158668e-01_rk, &
                                        -1.263827379586967945e-17_rk, 2.189013233441265165e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.542051911182398326e-18_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 6.542051911182399096e-18_rk, &
                                        -6.439505508593792449e-01_rk, 1.115355071650410812e+00_rk, -3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,1) = reshape((/                                                                                 &
                                        -3.333333333333328152e-01_rk, -1.110223024625156540e-16_rk, -6.315623032716832785e-02_rk, &
                                        3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk, 6.315623032716892460e-02_rk, &
                                        1.850371707708595056e-17_rk, -9.251858538542972197e-18_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,2) = reshape((/                                                                                 &
                                        -3.333333333333338144e-01_rk, -1.239514011944786162e-18_rk, -6.315623032716853602e-02_rk, &
                                        -3.333333333333334259e-01_rk, -1.239514011944785970e-18_rk, -6.315623032716853602e-02_rk, &
                                        -9.251858538542975279e-18_rk, -3.440342488516507799e-35_rk, -1.752937526443803067e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,6,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 1.752937526443802682e-18_rk, &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 1.752937526443802682e-18_rk, &
                                        -4.714045207910317337e-01_rk, -1.752937526443802682e-18_rk, -8.931639747704071819e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,1) = reshape((/                                                                                 &
                                        1.244016935856292250e+00_rk, 8.881784197001252323e-16_rk, -8.796528112548945844e-01_rk, &
                                        -1.244016935856293582e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, &
                                        -6.905681226056468069e-17_rk, 3.452840613028235267e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,2) = reshape((/                                                                                 &
                                        1.244016935856293582e+00_rk, -1.726420306514116709e-17_rk, -8.796528112548951395e-01_rk, &
                                        1.244016935856292916e+00_rk, -1.726420306514116709e-17_rk, -8.796528112548951395e-01_rk, &
                                        3.452840613028232802e-17_rk, -4.791778936180982099e-34_rk, -2.441527011828579370e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 2.441527011828579678e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.441527011828579370e-17_rk, &
                                        1.759305622509789613e+00_rk, -2.441527011828579370e-17_rk, -1.244016935856293138e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,1) = reshape((/                                                                                 &
                                        -4.553418012614791621e-01_rk, -7.886751345948133096e-01_rk, -2.357022603955158113e-01_rk, &
                                        4.553418012614800503e-01_rk, 7.886751345948135317e-01_rk, 2.357022603955159501e-01_rk, &
                                        4.716667992615202288e-17_rk, -1.263827379586968870e-17_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,2) = reshape((/                                                                                 &
                                        -4.553418012614791621e-01_rk, -7.886751345948131986e-01_rk, -2.357022603955157558e-01_rk, &
                                        -4.553418012614796062e-01_rk, -7.886751345948130876e-01_rk, -2.357022603955157558e-01_rk, &
                                        -1.263827379586967329e-17_rk, -2.189013233441265165e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,7,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 6.542051911182395244e-18_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 6.542051911182395244e-18_rk, &
                                        -6.439505508593786898e-01_rk, -1.115355071650410812e+00_rk, -3.333333333333332038e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,1) = reshape((/                                                                                 &
                                        -2.498001805406602216e-16_rk, 8.931639747704085697e-02_rk, 6.315623032716854990e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704085697e-02_rk, -6.315623032716873031e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.942890293094023946e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,2) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, 8.931639747704096799e-02_rk, 6.315623032716871643e-02_rk, &
                                        -1.387778780781445676e-16_rk, 8.931639747704096799e-02_rk, 6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,1,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.766354016019249620e-16_rk, 1.263124606543374329e-01_rk, 8.931639747704098187e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,1) = reshape((/                                                                                 &
                                        -2.113248654051869124e-01_rk, 1.220084679281464024e-01_rk, 2.357022603955161444e-01_rk, &
                                        2.113248654051870234e-01_rk, -1.220084679281461804e-01_rk, -2.357022603955157558e-01_rk, &
                                        -2.775557561562894802e-16_rk, 2.775557561562894309e-16_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,2) = reshape((/                                                                                 &
                                        -2.113248654051875230e-01_rk, 1.220084679281462775e-01_rk, 2.357022603955160334e-01_rk, &
                                        -2.113248654051871345e-01_rk, 1.220084679281462775e-01_rk, 2.357022603955160334e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.988584907226846110e-01_rk, 1.725460300683473169e-01_rk, 3.333333333333336479e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,1) = reshape((/                                                                                 &
                                        2.113248654051869124e-01_rk, 1.220084679281463469e-01_rk, 2.357022603955159779e-01_rk, &
                                        -2.113248654051870234e-01_rk, -1.220084679281462359e-01_rk, -2.357022603955158946e-01_rk, &
                                        2.220446049250316039e-16_rk, -2.220446049250315546e-16_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,2) = reshape((/                                                                                 &
                                        2.113248654051874120e-01_rk, 1.220084679281462775e-01_rk, 2.357022603955158668e-01_rk, &
                                        2.113248654051871345e-01_rk, 1.220084679281462775e-01_rk, 2.357022603955158668e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,3,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.988584907226845555e-01_rk, 1.725460300683473169e-01_rk, 3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,1) = reshape((/                                                                                 &
                                        3.330669073875469621e-16_rk, -3.333333333333335369e-01_rk, 8.796528112548948064e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk, -8.796528112548954725e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.885780586188047891e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,2) = reshape((/                                                                                 &
                                        3.330669073875469621e-16_rk, -3.333333333333333703e-01_rk, 8.796528112548952505e-01_rk, &
                                        1.110223024625156540e-16_rk, -3.333333333333333148e-01_rk, 8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,4,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        -7.850462293418886927e-17_rk, -4.714045207910317337e-01_rk, 1.244016935856293582e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,1) = reshape((/                                                                                 &
                                        -3.330669073875469621e-16_rk, 3.333333333333334814e-01_rk, -6.315623032716888297e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333148e-01_rk, 6.315623032716839724e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,2) = reshape((/                                                                                 &
                                        -3.330669073875469621e-16_rk, 3.333333333333333703e-01_rk, -6.315623032716871643e-02_rk, &
                                        -1.110223024625156540e-16_rk, 3.333333333333333148e-01_rk, -6.315623032716871643e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,5,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        7.850462293418886927e-17_rk, 4.714045207910317337e-01_rk, -8.931639747704098187e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,1) = reshape((/                                                                                 &
                                        -7.886751345948124214e-01_rk, 4.553418012614802723e-01_rk, -2.357022603955159779e-01_rk, &
                                        7.886751345948135317e-01_rk, -4.553418012614796062e-01_rk, 2.357022603955158946e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,2) = reshape((/                                                                                 &
                                        -7.886751345948137537e-01_rk, 4.553418012614798283e-01_rk, -2.357022603955158668e-01_rk, &
                                        -7.886751345948133096e-01_rk, 4.553418012614799393e-01_rk, -2.357022603955158668e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,6,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.115355071650411478e+00_rk, 6.439505508593794669e-01_rk, -3.333333333333334259e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,1) = reshape((/                                                                                 &
                                        7.886751345948117553e-01_rk, 4.553418012614791621e-01_rk, -2.357022603955161721e-01_rk, &
                                        -7.886751345948130876e-01_rk, -4.553418012614800503e-01_rk, 2.357022603955157003e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,2) = reshape((/                                                                                 &
                                        7.886751345948136427e-01_rk, 4.553418012614798283e-01_rk, -2.357022603955157003e-01_rk, &
                                        7.886751345948128655e-01_rk, 4.553418012614799393e-01_rk, -2.357022603955157003e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.115355071650410590e+00_rk, 6.439505508593794669e-01_rk, -3.333333333333331483e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,1) = reshape((/                                                                                 &
                                        4.440892098500626162e-16_rk, -1.244016935856292694e+00_rk, -8.796528112548945844e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk, 8.796528112548955836e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.661338147750939243e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,2) = reshape((/                                                                                 &
                                        4.440892098500626162e-16_rk, -1.244016935856292694e+00_rk, -8.796528112548952505e-01_rk, &
                                        4.440892098500626162e-16_rk, -1.244016935856292916e+00_rk, -8.796528112548952505e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx(:,:,8,8,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        6.280369834735109542e-16_rk, -1.759305622509790501e+00_rk, -1.244016935856293582e+00_rk  &
                                        /),(/3,3/))
        

        do inode = 1,self%elem%basis_s%nnodes_elem()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx(:,:,inode,inode_diff,idir)),self%elem%dmetric_dx(:,:,inode,inode_diff,idir), 1.e-14_rk)
                end do
            end do
        end do 


    end subroutine testElement_dmetric_dx
    !***************************************************************************************





    !> Test cartesian dgrad1_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad1_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 8.632101532570588168e-18_rk,-1.332267629550187849e-15_rk,2.220446049250313081e-16_rk,4.391054637065608105e-16_rk,-2.270283510685331138e-16_rk,-1.218367959910148632e-15_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614800503e-01_rk, -2.220446049250315053e-16_rk,4.553418012614796062e-01_rk,-5.257834230632094652e-01_rk,-2.628917115316047326e-01_rk,2.628917115316049546e-01_rk,3.035612008409852569e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614803834e-01_rk, 2.211980011106999240e-16_rk,-4.553418012614806609e-01_rk,-5.257834230632100203e-01_rk,2.628917115316049546e-01_rk,-2.628917115316047326e-01_rk,3.035612008409863671e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.330669073875469621e-16_rk,-3.330669073875469621e-16_rk,2.775557561562891351e-16_rk,2.775557561562891351e-17_rk,-1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, -9.251858538542966034e-18_rk,-4.440892098500626162e-16_rk,3.330669073875469621e-16_rk,-2.722141931385569929e-16_rk,-2.241401259789679283e-17_rk,-5.859510407743880645e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281464024e-01_rk, -2.220446049250315546e-16_rk,1.220084679281462359e-01_rk,-1.408832436034583302e-01_rk,7.044162180172891530e-02_rk,-7.044162180172913734e-02_rk,-8.133897861876432378e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281464857e-01_rk, 2.507075677740975899e-16_rk,-1.220084679281467077e-01_rk,-1.408832436034585245e-01_rk,-7.044162180172944265e-02_rk,7.044162180172935939e-02_rk,-8.133897861876435154e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.498001805406602216e-16_rk,-8.326672684688674053e-17_rk,-8.326672684688674053e-17_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.622231866529366047e-33_rk,-4.440892098500626162e-16_rk,0.000000000000000000e+00_rk,2.170608587815295024e-16_rk,-2.270283510685331138e-16_rk,-2.191672377475077705e-16_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,4.553418012614791621e-01_rk,0.000000000000000000e+00_rk,-2.628917115316042885e-01_rk,-2.628917115316042885e-01_rk,-2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614800503e-01_rk, 3.159568448967421404e-18_rk,-4.553418012614804944e-01_rk,-2.220446049250313081e-16_rk,2.628917115316046216e-01_rk,2.628917115316043995e-01_rk,2.202204272304969169e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,-5.551115123125782702e-16_rk,-2.775557561562891351e-16_rk,3.330669073875469621e-16_rk,-5.551115123125782702e-17_rk,1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.540743955509788682e-33_rk,-5.551115123125782702e-16_rk,2.220446049250313081e-16_rk,-2.167030419072991905e-16_rk,5.341563017732124537e-18_rk,1.912050764632214151e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462359e-01_rk, 0.000000000000000000e+00_rk,1.220084679281460138e-01_rk,5.551115123125782702e-17_rk,7.044162180172894305e-02_rk,7.044162180172908183e-02_rk,5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281463469e-01_rk, -3.386415257326701092e-18_rk,-1.220084679281466800e-01_rk,-2.220446049250313081e-16_rk,-7.044162180172935939e-02_rk,-7.044162180172913734e-02_rk,-1.368227303177391449e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-16_rk, 0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,-1.665334536937734811e-16_rk,-8.326672684688674053e-17_rk,-8.326672684688674053e-17_rk,-8.326672684688674053e-17_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -6.219331659439394741e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.590732807756897741e-16_rk,3.590732807756897741e-16_rk,-2.073110553146462859e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 6.439505508593789118e-01_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,3.717850238834702337e-01_rk,-3.717850238834703447e-01_rk,-2.146501836197927671e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.439505508593795780e-01_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,3.717850238834706778e-01_rk,-3.717850238834707888e-01_rk,2.146501836197929614e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.925231146709443463e-17_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,1.572343868793478421e-17_rk,2.266233259184201259e-17_rk,9.614656870411184003e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.483704134880862861e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-8.566169816712272369e-18_rk,-8.566169816712272369e-18_rk,4.945680449602873121e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.725460300683472892e-01_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,9.961949690756162490e-02_rk,-9.961949690756159714e-02_rk,-5.751534335611570986e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.725460300683473447e-01_rk,2.775557561562891351e-17_rk,5.551115123125782702e-17_rk,9.961949690756166653e-02_rk,-9.961949690756163878e-02_rk,5.751534335611575149e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, -1.766354016019249620e-16_rk,-1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,-1.019804966632890644e-16_rk,-1.019804966632890644e-16_rk,-5.887846720064159649e-17_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.886751345948130876e-01_rk, 2.218177581166722988e-16_rk,-7.886751345948130876e-01_rk,-2.220446049250313081e-16_rk,4.553418012614798283e-01_rk,-4.553418012614802723e-01_rk,1.327566084678129870e-15_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856293138e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856291362e+00_rk,1.436467025586169122e+00_rk,7.182335127930841168e-01_rk,-7.182335127930845609e-01_rk,-8.293446239041930568e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, -4.625929269271489951e-18_rk,-3.333333333333328152e-01_rk,-3.849001794597504134e-01_rk,1.924500897298749846e-01_rk,-1.924500897298753177e-01_rk,2.222222222222220989e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948133096e-01_rk, -2.220446049250316039e-16_rk,-7.886751345948128655e-01_rk,5.551115123125782702e-16_rk,4.553418012614792731e-01_rk,-4.553418012614801613e-01_rk,-5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051872455e-01_rk, 2.510396945526052670e-16_rk,-2.113248654051868014e-01_rk,-3.330669073875469621e-16_rk,-1.220084679281461387e-01_rk,1.220084679281462220e-01_rk,2.270837055316177102e-16_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk, 0.000000000000000000e+00_rk,-3.333333333333330373e-01_rk,3.849001794597504134e-01_rk,-1.924500897298750957e-01_rk,1.924500897298753732e-01_rk,2.222222222222222654e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704098187e-02_rk, 4.958056047779158516e-18_rk,-8.931639747704078758e-02_rk,-1.031336922528344469e-01_rk,-5.156684612641718179e-02_rk,5.156684612641725118e-02_rk,-5.954426498469389539e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051870234e-01_rk, -2.775557561562894802e-16_rk,-2.113248654051869124e-01_rk,5.551115123125782702e-17_rk,-1.220084679281463469e-01_rk,1.220084679281460693e-01_rk,-1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.886751345948128655e-01_rk, 5.472533083603161372e-18_rk,-7.886751345948137537e-01_rk,9.106836025229598786e-01_rk,4.553418012614802723e-01_rk,4.553418012614796062e-01_rk,-5.257834230632083550e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292694e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856293582e+00_rk,5.551115123125782702e-16_rk,7.182335127930847829e-01_rk,7.182335127930842278e-01_rk,-2.775557561562891351e-16_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk, 2.312964634635743820e-18_rk,-3.333333333333338699e-01_rk,-2.498001805406602216e-16_rk,1.924500897298756230e-01_rk,1.924500897298753732e-01_rk,1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948134206e-01_rk, 0.000000000000000000e+00_rk,-7.886751345948137537e-01_rk,-9.106836025229602116e-01_rk,4.553418012614801613e-01_rk,4.553418012614799948e-01_rk,5.257834230632083550e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051871067e-01_rk, -5.865443281216274187e-18_rk,-2.113248654051874120e-01_rk,2.440169358562926660e-01_rk,-1.220084679281464440e-01_rk,-1.220084679281462359e-01_rk,1.408832436034580249e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk,-3.333333333333338144e-01_rk,2.220446049250313081e-16_rk,-1.924500897298755953e-01_rk,-1.924500897298753732e-01_rk,1.526556658859590243e-16_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704085697e-02_rk, -2.479028023889575406e-18_rk,-8.931639747704110677e-02_rk,-1.387778780781445676e-16_rk,-5.156684612641730669e-02_rk,-5.156684612641716792e-02_rk,-7.979727989493312634e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051871345e-01_rk, 0.000000000000000000e+00_rk,-2.113248654051875230e-01_rk,-2.440169358562927215e-01_rk,-1.220084679281464579e-01_rk,-1.220084679281462636e-01_rk,-1.408832436034580804e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.115355071650410368e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,6.439505508593789118e-01_rk,6.439505508593789118e-01_rk,-3.717850238834697341e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.759305622509789613e+00_rk,-1.110223024625156540e-16_rk,1.110223024625156540e-16_rk,-1.015735574742849590e+00_rk,1.015735574742849590e+00_rk,5.864352075032626121e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, -4.714045207910318447e-01_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,2.721655269759088447e-01_rk,-2.721655269759088447e-01_rk,1.571348402636771058e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, -1.115355071650411700e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,-6.439505508593798000e-01_rk,-6.439505508593798000e-01_rk,-3.717850238834702337e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.988584907226844445e-01_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,1.725460300683472337e-01_rk,1.725460300683472059e-01_rk,-9.961949690756138898e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -4.714045207910318447e-01_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-2.721655269759088447e-01_rk,2.721655269759088447e-01_rk,1.571348402636769948e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.263124606543372663e-01_rk,0.000000000000000000e+00_rk,2.081668171172168513e-17_rk,7.292653316078565040e-02_rk,-7.292653316078565040e-02_rk,4.210415355144571381e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.988584907226846110e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.725460300683473169e-01_rk,-1.725460300683473169e-01_rk,-9.961949690756145837e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -7.886751345948137537e-01_rk, -2.142591072067926463e-16_rk,7.886751345948133096e-01_rk,3.330669073875469621e-16_rk,-4.553418012614794952e-01_rk,4.553418012614802723e-01_rk,2.595165906079633780e-18_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,3.333333333333328152e-01_rk,-3.849001794597504134e-01_rk,-1.924500897298750957e-01_rk,1.924500897298754287e-01_rk,2.222222222222220434e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856294026e+00_rk, 1.726420306514117634e-17_rk,1.244016935856292250e+00_rk,1.436467025586169566e+00_rk,-7.182335127930845609e-01_rk,7.182335127930847829e-01_rk,-8.293446239041932788e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948130876e-01_rk, 2.220446049250316039e-16_rk,7.886751345948126435e-01_rk,-6.661338147750939243e-16_rk,-4.553418012614796062e-01_rk,4.553418012614804944e-01_rk,1.776356839400250465e-15_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051872455e-01_rk, -2.581446518457663339e-16_rk,2.113248654051870234e-01_rk,8.326672684688674053e-17_rk,1.220084679281464302e-01_rk,-1.220084679281461804e-01_rk,2.497408518059363108e-17_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704098187e-02_rk, 0.000000000000000000e+00_rk,8.931639747704073207e-02_rk,-1.031336922528344191e-01_rk,5.156684612641715404e-02_rk,-5.156684612641725118e-02_rk,-5.954426498469393703e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk, -1.850371707708594131e-17_rk,3.333333333333328152e-01_rk,3.849001794597504134e-01_rk,1.924500897298750957e-01_rk,-1.924500897298753732e-01_rk,2.222222222222223209e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051870234e-01_rk, 2.220446049250316039e-16_rk,2.113248654051869124e-01_rk,-4.440892098500626162e-16_rk,1.220084679281460138e-01_rk,-1.220084679281461804e-01_rk,2.775557561562891351e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 7.886751345948135317e-01_rk, -5.472533083603165994e-18_rk,7.886751345948136427e-01_rk,-9.106836025229603226e-01_rk,-4.553418012614801613e-01_rk,-4.553418012614801058e-01_rk,5.257834230632085770e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk,3.333333333333338699e-01_rk,-2.498001805406602216e-16_rk,-1.924500897298756230e-01_rk,-1.924500897298753732e-01_rk,1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292694e+00_rk, -8.632101532570582005e-18_rk,1.244016935856293582e+00_rk,5.551115123125782702e-16_rk,-7.182335127930847829e-01_rk,-7.182335127930842278e-01_rk,-2.775557561562891351e-16_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948127545e-01_rk, 0.000000000000000000e+00_rk,7.886751345948136427e-01_rk,9.106836025229597675e-01_rk,-4.553418012614801613e-01_rk,-4.553418012614796062e-01_rk,-5.257834230632082440e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051871622e-01_rk, 5.865443281216275728e-18_rk,2.113248654051874675e-01_rk,-2.440169358562927215e-01_rk,1.220084679281464579e-01_rk,1.220084679281462775e-01_rk,-1.408832436034580804e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704085697e-02_rk, 0.000000000000000000e+00_rk,8.931639747704112064e-02_rk,-1.526556658859590243e-16_rk,5.156684612641732057e-02_rk,5.156684612641716792e-02_rk,-8.673617379884035472e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, 9.251858538542975279e-18_rk,3.333333333333338144e-01_rk,2.498001805406602216e-16_rk,1.924500897298755953e-01_rk,1.924500897298753732e-01_rk,1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051871345e-01_rk, 0.000000000000000000e+00_rk,2.113248654051874120e-01_rk,2.440169358562926383e-01_rk,1.220084679281464302e-01_rk,1.220084679281462359e-01_rk,1.408832436034580249e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.115355071650411256e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.439505508593794669e-01_rk,-6.439505508593794669e-01_rk,3.717850238834700116e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 4.714045207910317337e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,2.721655269759088447e-01_rk,-2.721655269759088447e-01_rk,-1.571348402636770780e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.759305622509789835e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.015735574742849590e+00_rk,1.015735574742849590e+00_rk,-5.864352075032626121e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.115355071650410590e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.439505508593791339e-01_rk,6.439505508593791339e-01_rk,3.717850238834697896e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 2.988584907226845555e-01_rk,2.775557561562891351e-17_rk,-5.551115123125782702e-17_rk,-1.725460300683472614e-01_rk,-1.725460300683472614e-01_rk,9.961949690756141673e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.263124606543372663e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,7.292653316078565040e-02_rk,-7.292653316078565040e-02_rk,-4.210415355144571381e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 4.714045207910317337e-01_rk,1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,-2.721655269759088447e-01_rk,2.721655269759088447e-01_rk,-1.571348402636769115e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.988584907226845555e-01_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,1.725460300683472337e-01_rk,1.725460300683472337e-01_rk,9.961949690756143061e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.312964634635745360e-18_rk,4.440892098500626162e-16_rk,-1.665334536937734811e-16_rk,-2.207092141705982848e-16_rk,5.684654198569086259e-17_rk,-1.117932906740608989e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614798283e-01_rk, 2.289834988289387337e-16_rk,4.553418012614801613e-01_rk,-5.257834230632092432e-01_rk,-2.628917115316046216e-01_rk,2.628917115316045106e-01_rk,3.035612008409859786e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614800503e-01_rk, -2.268973810026623535e-16_rk,-4.553418012614791621e-01_rk,-5.257834230632085770e-01_rk,2.628917115316042885e-01_rk,-2.628917115316045106e-01_rk,3.035612008409847018e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk,8.881784197001252323e-16_rk,4.440892098500626162e-16_rk,-4.440892098500626162e-16_rk,1.110223024625156540e-16_rk,-1.332267629550187849e-15_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 2.479028023889579258e-18_rk,2.498001805406602216e-16_rk,-8.326672684688674053e-17_rk,8.183545934996546828e-17_rk,-1.431267496921275143e-18_rk,-3.386812684490628214e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281462220e-01_rk, 2.428612866367532397e-16_rk,1.220084679281464440e-01_rk,-1.408832436034581914e-01_rk,7.044162180172927612e-02_rk,-7.044162180172920673e-02_rk,-8.133897861876417112e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281461804e-01_rk, -2.163452250330691004e-16_rk,-1.220084679281457918e-01_rk,-1.408832436034579416e-01_rk,-7.044162180172876264e-02_rk,7.044162180172892918e-02_rk,-8.133897861876415725e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.330669073875469621e-16_rk,3.885780586188047891e-16_rk,3.330669073875469621e-16_rk,2.775557561562891351e-17_rk,-1.387778780781445676e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.851859888774471706e-34_rk,5.551115123125782702e-16_rk,-1.665334536937734811e-16_rk,-2.207092141705982848e-16_rk,5.684654198569086259e-17_rk,1.657624654822282362e-16_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,4.553418012614807164e-01_rk,-2.220446049250313081e-16_rk,-2.628917115316047326e-01_rk,-2.628917115316045106e-01_rk,4.440892098500626162e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614793842e-01_rk, 3.159568448967416782e-18_rk,-4.553418012614791621e-01_rk,2.220446049250313081e-16_rk,2.628917115316042885e-01_rk,2.628917115316046216e-01_rk,-1.091981247679812628e-16_rk, &
                                        0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk, 0.000000000000000000e+00_rk,4.440892098500626162e-16_rk,4.440892098500626162e-16_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,-3.330669073875469621e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 3.466673899897024536e-33_rk,1.665334536937734811e-16_rk,-1.665334536937734811e-16_rk,9.571324715777992503e-17_rk,6.795767154215101152e-17_rk,-9.631817198007134370e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462359e-01_rk, 0.000000000000000000e+00_rk,1.220084679281466800e-01_rk,-2.220446049250313081e-16_rk,7.044162180172935939e-02_rk,7.044162180172908183e-02_rk,-1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281461248e-01_rk, -3.386415257326698781e-18_rk,-1.220084679281460138e-01_rk,5.551115123125782702e-17_rk,-7.044162180172894305e-02_rk,-7.044162180172902632e-02_rk,5.355600347085240435e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,3.330669073875469621e-16_rk,2.775557561562891351e-16_rk,2.775557561562891351e-16_rk,0.000000000000000000e+00_rk,1.387778780781445676e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, -7.806638855257792091e-17_rk,1.387778780781445676e-17_rk,-6.938893903907228378e-18_rk,3.813275654158556515e-17_rk,4.507165044549279352e-17_rk,-2.255268256557233274e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 6.439505508593791339e-01_rk,-2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,3.717850238834704557e-01_rk,-3.717850238834704557e-01_rk,-2.146501836197928226e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.439505508593785787e-01_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,3.717850238834701226e-01_rk,-3.717850238834701226e-01_rk,2.146501836197926005e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 7.850462293418887420e-16_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,4.532466518368402641e-16_rk,3.422243493743246101e-16_rk,2.061709252160381245e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.846955419422547187e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.969512695457740403e-17_rk,-1.135729147623918485e-16_rk,6.503462759937179623e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.725460300683472892e-01_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,9.961949690756162490e-02_rk,-9.961949690756159714e-02_rk,-5.751534335611570986e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.725460300683471504e-01_rk,2.775557561562891351e-17_rk,5.551115123125782702e-17_rk,9.961949690756154163e-02_rk,-9.961949690756151388e-02_rk,5.751534335611568211e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.850462293418886927e-17_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-4.532466518368402518e-17_rk,-4.532466518368402518e-17_rk,2.934294358652823064e-17_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 2.312964634635743820e-18_rk,-5.551115123125782702e-16_rk,2.220446049250313081e-16_rk,2.207092141705982848e-16_rk,-1.335390754433031712e-18_rk,1.395488662896898124e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281464024e-01_rk, -6.938893903907234541e-18_rk,1.220084679281461248e-01_rk,-1.408832436034581637e-01_rk,-7.044162180172897081e-02_rk,7.044162180172919285e-02_rk,8.133897861876426827e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281465134e-01_rk, 6.712047095547955623e-18_rk,-1.220084679281467355e-01_rk,-1.408832436034585522e-01_rk,7.044162180172930388e-02_rk,-7.044162180172922061e-02_rk,8.133897861876428215e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-2.498001805406602216e-16_rk,-8.326672684688674053e-17_rk,8.326672684688674053e-17_rk,0.000000000000000000e+00_rk,3.469446951953614189e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.452840613028234035e-17_rk,-4.440892098500626162e-16_rk,0.000000000000000000e+00_rk,1.993498457400724130e-17_rk,-9.108731788850840658e-17_rk,1.098713555915062489e-15_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614804944e-01_rk, -1.110223024625157773e-16_rk,4.553418012614796062e-01_rk,-5.257834230632094652e-01_rk,2.628917115316045106e-01_rk,-2.628917115316047326e-01_rk,-3.035612008409852569e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614803279e-01_rk, 1.144087177198424969e-16_rk,-4.553418012614808275e-01_rk,-5.257834230632099093e-01_rk,-2.628917115316051767e-01_rk,2.628917115316048991e-01_rk,-3.035612008409865892e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-3.330669073875469621e-16_rk,-2.775557561562891351e-16_rk,-2.775557561562891351e-16_rk,2.775557561562891351e-17_rk,1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.851859888774471706e-34_rk,-5.551115123125782702e-16_rk,1.665334536937734811e-16_rk,2.207092141705982848e-16_rk,-5.684654198569086259e-17_rk,-1.657624654822282362e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462914e-01_rk, 0.000000000000000000e+00_rk,1.220084679281460138e-01_rk,1.665334536937734811e-16_rk,-7.044162180172894305e-02_rk,-7.044162180172908183e-02_rk,-5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281462914e-01_rk, 8.466038143316756581e-19_rk,-1.220084679281466800e-01_rk,-2.498001805406602216e-16_rk,7.044162180172935939e-02_rk,7.044162180172910959e-02_rk,1.799224545614865698e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,-1.387778780781445676e-16_rk,-1.526556658859590243e-16_rk,9.714451465470119729e-17_rk,5.551115123125782702e-17_rk,8.326672684688674053e-17_rk, &
                                        0.000000000000000000e+00_rk, -4.440892098500626162e-16_rk, -6.162975822039154730e-33_rk,-8.881784197001252323e-16_rk,8.881784197001252323e-16_rk,-4.241542252760553934e-16_rk,-4.241542252760553934e-16_rk,5.436020436024842184e-16_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,4.553418012614793842e-01_rk,2.220446049250313081e-16_rk,2.628917115316043995e-01_rk,2.628917115316046216e-01_rk,-1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614800503e-01_rk, -1.263827379586967945e-17_rk,-4.553418012614804944e-01_rk,-1.110223024625156540e-16_rk,-2.628917115316046216e-01_rk,-2.628917115316045106e-01_rk,-1.037255916843781138e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,-3.330669073875469621e-16_rk,-2.775557561562891351e-16_rk,-2.775557561562891351e-16_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 7.240080540461741391e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-4.180062448990159167e-17_rk,-4.180062448990159167e-17_rk,2.413360180153911435e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.725460300683472337e-01_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,9.961949690756158327e-02_rk,-9.961949690756158327e-02_rk,-5.751534335611566823e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -1.725460300683474002e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.961949690756168041e-02_rk,-9.961949690756162490e-02_rk,5.751534335611571680e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.864484794686985614e-16_rk,1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,-1.076460798112495714e-16_rk,-1.145849737151567997e-16_rk,-6.561894010818640637e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.606309592236027234e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.391504890617105054e-16_rk,4.391504890617105054e-16_rk,-2.535436530745340110e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 6.439505508593789118e-01_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,3.717850238834702337e-01_rk,-3.717850238834702892e-01_rk,-2.146501836197927116e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.439505508593792449e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.717850238834704557e-01_rk,-3.717850238834705667e-01_rk,2.146501836197928503e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, 7.850462293418886927e-17_rk,1.387778780781445676e-17_rk,0.000000000000000000e+00_rk,4.532466518368402518e-17_rk,4.532466518368402518e-17_rk,2.616820764472959638e-17_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.113248654051873565e-01_rk, -3.098785029861966369e-19_rk,-2.113248654051870234e-01_rk,-2.220446049250313081e-16_rk,1.220084679281461248e-01_rk,-1.220084679281463469e-01_rk,-1.122820776141622669e-16_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,-3.333333333333325932e-01_rk,3.849001794597504134e-01_rk,1.924500897298750957e-01_rk,-1.924500897298753177e-01_rk,-2.222222222222219878e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704098187e-02_rk, -1.239514011944789822e-18_rk,-8.931639747704078758e-02_rk,-1.031336922528344469e-01_rk,5.156684612641718179e-02_rk,-5.156684612641725118e-02_rk,5.954426498469389539e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051871345e-01_rk, 0.000000000000000000e+00_rk,-2.113248654051868569e-01_rk,5.551115123125782702e-17_rk,1.220084679281461804e-01_rk,-1.220084679281462359e-01_rk,-5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948135317e-01_rk, 1.119296896959528745e-16_rk,-7.886751345948126435e-01_rk,-6.661338147750939243e-16_rk,-4.553418012614796617e-01_rk,4.553418012614802168e-01_rk,-1.313461450061956133e-15_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856293582e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292250e+00_rk,1.436467025586169566e+00_rk,-7.182335127930845609e-01_rk,7.182335127930850049e-01_rk,8.293446239041941670e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333703e-01_rk, 1.850371707708595056e-17_rk,-3.333333333333328152e-01_rk,-3.849001794597504134e-01_rk,-1.924500897298749846e-01_rk,1.924500897298754287e-01_rk,-2.222222222222223209e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948135317e-01_rk, 0.000000000000000000e+00_rk,-7.886751345948124214e-01_rk,0.000000000000000000e+00_rk,-4.553418012614798283e-01_rk,4.553418012614799393e-01_rk,-1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.113248654051871345e-01_rk, 1.466360820304068932e-18_rk,-2.113248654051874398e-01_rk,2.440169358562927493e-01_rk,1.220084679281464718e-01_rk,1.220084679281462636e-01_rk,-1.408832436034580249e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk,-3.333333333333338699e-01_rk,2.498001805406602216e-16_rk,1.924500897298756230e-01_rk,1.924500897298753732e-01_rk,-1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704085697e-02_rk, 6.197570059723938516e-19_rk,-8.931639747704110677e-02_rk,-1.387778780781445676e-16_rk,5.156684612641730669e-02_rk,5.156684612641716792e-02_rk,7.979727989493312634e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051871345e-01_rk, 0.000000000000000000e+00_rk,-2.113248654051875230e-01_rk,-2.440169358562927215e-01_rk,1.220084679281464579e-01_rk,1.220084679281462636e-01_rk,1.408832436034580804e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948128655e-01_rk, -2.189013233441264549e-17_rk,-7.886751345948137537e-01_rk,9.106836025229598786e-01_rk,-4.553418012614802168e-01_rk,-4.553418012614796062e-01_rk,5.257834230632082440e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292916e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856293582e+00_rk,5.551115123125782702e-16_rk,-7.182335127930847829e-01_rk,-7.182335127930842278e-01_rk,2.775557561562891351e-16_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk, -9.251858538542975279e-18_rk,-3.333333333333338144e-01_rk,-2.220446049250313081e-16_rk,-1.924500897298755953e-01_rk,-1.924500897298753732e-01_rk,-1.526556658859590243e-16_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948133096e-01_rk, 0.000000000000000000e+00_rk,-7.886751345948137537e-01_rk,-9.106836025229601006e-01_rk,-4.553418012614801613e-01_rk,-4.553418012614799948e-01_rk,-5.257834230632083550e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.988584907226845000e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.725460300683472337e-01_rk,1.725460300683472337e-01_rk,-9.961949690756140285e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -4.714045207910317337e-01_rk,0.000000000000000000e+00_rk,-3.330669073875469621e-16_rk,-2.721655269759089557e-01_rk,2.721655269759089557e-01_rk,1.571348402636771335e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.263124606543372663e-01_rk,0.000000000000000000e+00_rk,-1.387778780781445676e-17_rk,7.292653316078565040e-02_rk,-7.292653316078565040e-02_rk,4.210415355144570687e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -2.988584907226846665e-01_rk,-2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,-1.725460300683473169e-01_rk,-1.725460300683472892e-01_rk,-9.961949690756144449e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.115355071650410368e+00_rk,0.000000000000000000e+00_rk,5.551115123125782702e-17_rk,6.439505508593789118e-01_rk,6.439505508593789118e-01_rk,-3.717850238834697341e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.759305622509789835e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.015735574742849590e+00_rk,1.015735574742849590e+00_rk,5.864352075032626121e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, -4.714045207910317337e-01_rk,1.387778780781445676e-17_rk,-2.081668171172168513e-17_rk,2.721655269759088447e-01_rk,-2.721655269759088447e-01_rk,1.571348402636770780e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.115355071650411478e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,-6.439505508593796890e-01_rk,-6.439505508593796890e-01_rk,-3.717850238834701226e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.113248654051872455e-01_rk, -1.383329125677152753e-18_rk,2.113248654051870234e-01_rk,1.110223024625156540e-16_rk,-1.220084679281462636e-01_rk,1.220084679281463746e-01_rk,-2.706020300687009136e-17_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704098187e-02_rk, 0.000000000000000000e+00_rk,8.931639747704073207e-02_rk,-1.031336922528344191e-01_rk,-5.156684612641715404e-02_rk,5.156684612641725118e-02_rk,5.954426498469388152e-02_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 4.625929269271488410e-18_rk,3.333333333333328152e-01_rk,3.849001794597504134e-01_rk,-1.924500897298749846e-01_rk,1.924500897298754287e-01_rk,-2.222222222222222099e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051870234e-01_rk, 0.000000000000000000e+00_rk,2.113248654051866904e-01_rk,-3.330669073875469621e-16_rk,-1.220084679281459028e-01_rk,1.220084679281462359e-01_rk,-1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948135317e-01_rk, -8.665314210421352174e-17_rk,7.886751345948128655e-01_rk,3.330669073875469621e-16_rk,4.553418012614797172e-01_rk,-4.553418012614799393e-01_rk,-6.589181485557635906e-17_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333703e-01_rk, 0.000000000000000000e+00_rk,3.333333333333328152e-01_rk,-3.849001794597504134e-01_rk,1.924500897298752067e-01_rk,-1.924500897298754287e-01_rk,-2.222222222222223209e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856293582e+00_rk, -6.905681226056468069e-17_rk,1.244016935856292250e+00_rk,1.436467025586169566e+00_rk,7.182335127930845609e-01_rk,-7.182335127930850049e-01_rk,8.293446239041932788e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948130876e-01_rk, 0.000000000000000000e+00_rk,7.886751345948117553e-01_rk,0.000000000000000000e+00_rk,4.553418012614796062e-01_rk,-4.553418012614796062e-01_rk,-1.554312234475219157e-15_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.113248654051871900e-01_rk, -1.466360820304069317e-18_rk,2.113248654051875230e-01_rk,-2.440169358562927771e-01_rk,-1.220084679281464579e-01_rk,-1.220084679281462914e-01_rk,1.408832436034581082e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704085697e-02_rk, 0.000000000000000000e+00_rk,8.931639747704110677e-02_rk,-1.387778780781445676e-16_rk,-5.156684612641730669e-02_rk,-5.156684612641716792e-02_rk,7.979727989493312634e-17_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, -2.312964634635743820e-18_rk,3.333333333333338699e-01_rk,2.498001805406602216e-16_rk,-1.924500897298756230e-01_rk,-1.924500897298753732e-01_rk,-1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051871622e-01_rk, 0.000000000000000000e+00_rk,2.113248654051874120e-01_rk,2.440169358562926938e-01_rk,-1.220084679281464302e-01_rk,-1.220084679281462914e-01_rk,-1.408832436034580249e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948133096e-01_rk, 2.189013233441265781e-17_rk,7.886751345948137537e-01_rk,-9.106836025229601006e-01_rk,4.553418012614801613e-01_rk,4.553418012614799948e-01_rk,-5.257834230632085770e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk,3.333333333333338144e-01_rk,-2.220446049250313081e-16_rk,1.924500897298755953e-01_rk,1.924500897298753732e-01_rk,-1.526556658859590243e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk, 3.452840613028232802e-17_rk,1.244016935856293582e+00_rk,5.551115123125782702e-16_rk,7.182335127930847829e-01_rk,7.182335127930842278e-01_rk,2.775557561562891351e-16_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948128655e-01_rk, 0.000000000000000000e+00_rk,7.886751345948136427e-01_rk,9.106836025229597675e-01_rk,4.553418012614801613e-01_rk,4.553418012614796062e-01_rk,5.257834230632083550e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 2.988584907226846110e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.725460300683472614e-01_rk,-1.725460300683473169e-01_rk,9.961949690756141673e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.263124606543372663e-01_rk,0.000000000000000000e+00_rk,1.387778780781445676e-17_rk,7.292653316078565040e-02_rk,-7.292653316078565040e-02_rk,-4.210415355144571381e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 4.714045207910318447e-01_rk,-1.110223024625156540e-16_rk,1.110223024625156540e-16_rk,-2.721655269759088447e-01_rk,2.721655269759088447e-01_rk,-1.571348402636769948e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 2.988584907226846110e-01_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,1.725460300683472892e-01_rk,1.725460300683473169e-01_rk,9.961949690756144449e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.115355071650411478e+00_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,-6.439505508593795780e-01_rk,-6.439505508593795780e-01_rk,3.717850238834700671e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.714045207910318447e-01_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,2.721655269759088447e-01_rk,-2.721655269759088447e-01_rk,-1.571348402636771058e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.759305622509789613e+00_rk,0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,-1.015735574742849590e+00_rk,1.015735574742849590e+00_rk,-5.864352075032626121e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.115355071650410590e+00_rk,0.000000000000000000e+00_rk,5.551115123125782702e-17_rk,6.439505508593791339e-01_rk,6.439505508593791339e-01_rk,3.717850238834697896e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.197570059723948145e-19_rk,2.498001805406602216e-16_rk,-8.326672684688674053e-17_rk,-8.290890997265641631e-17_rk,3.578168742303187858e-19_rk,2.061009604306422174e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281461665e-01_rk, 3.469446951953617270e-18_rk,1.220084679281464302e-01_rk,-1.408832436034581637e-01_rk,-7.044162180172910959e-02_rk,7.044162180172904020e-02_rk,8.133897861876404622e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462359e-01_rk, -3.159568448967418707e-18_rk,-1.220084679281457918e-01_rk,-1.408832436034579416e-01_rk,7.044162180172885979e-02_rk,-7.044162180172902632e-02_rk,8.133897861876421276e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk,3.330669073875469621e-16_rk,2.775557561562891351e-16_rk,-2.775557561562891351e-16_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 9.251858538542975279e-18_rk,4.440892098500626162e-16_rk,-2.775557561562891351e-16_rk,2.722141931385569929e-16_rk,-5.341563017732126078e-18_rk,5.859510407743881878e-17_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614798838e-01_rk, 5.551115123125788865e-17_rk,4.553418012614801613e-01_rk,-5.257834230632092432e-01_rk,2.628917115316047326e-01_rk,-2.628917115316046216e-01_rk,-3.035612008409860896e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614800503e-01_rk, 4.716667992615202288e-17_rk,-4.553418012614791621e-01_rk,-5.257834230632087991e-01_rk,-2.628917115316042885e-01_rk,2.628917115316046216e-01_rk,-3.035612008409852569e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,4.440892098500626162e-16_rk,4.440892098500626162e-16_rk,2.220446049250313081e-16_rk,1.110223024625156540e-16_rk,1.221245327087672194e-15_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -8.666684749742561339e-34_rk,1.387778780781445676e-16_rk,-1.526556658859590243e-16_rk,-8.290890997265641631e-17_rk,-6.903112216484195955e-17_rk,9.693792898604373081e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281461804e-01_rk, 0.000000000000000000e+00_rk,1.220084679281466244e-01_rk,-2.775557561562891351e-16_rk,-7.044162180172933163e-02_rk,-7.044162180172908183e-02_rk,1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281462359e-01_rk, 8.466038143316743100e-19_rk,-1.220084679281460138e-01_rk,1.110223024625156540e-16_rk,7.044162180172894305e-02_rk,7.044162180172908183e-02_rk,-1.105335155224142984e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,5.551115123125782702e-16_rk,2.775557561562891351e-16_rk,-3.330669073875469621e-16_rk,5.551115123125782702e-17_rk,-1.665334536937734811e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.540743955509788682e-33_rk,5.551115123125782702e-16_rk,-2.220446049250313081e-16_rk,2.167030419072991905e-16_rk,-5.341563017732124537e-18_rk,-1.912050764632214151e-16_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614800503e-01_rk, 0.000000000000000000e+00_rk,4.553418012614802723e-01_rk,-1.110223024625156540e-16_rk,2.628917115316045106e-01_rk,2.628917115316045106e-01_rk,1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614796062e-01_rk, -1.263827379586967329e-17_rk,-4.553418012614791621e-01_rk,2.220446049250313081e-16_rk,-2.628917115316042885e-01_rk,-2.628917115316046216e-01_rk,1.037255916843781138e-16_rk, &
                                        0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk, 0.000000000000000000e+00_rk,4.440892098500626162e-16_rk,4.440892098500626162e-16_rk,2.220446049250313081e-16_rk,2.220446049250313081e-16_rk,2.220446049250313081e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 1.761971672203140013e-16_rk,-1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,-9.478858802119060433e-17_rk,-1.017274819250978327e-16_rk,5.526294212148433284e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 1.725460300683472892e-01_rk,2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,9.961949690756162490e-02_rk,-9.961949690756159714e-02_rk,-5.751534335611569598e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.725460300683471504e-01_rk,-2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,9.961949690756154163e-02_rk,-9.961949690756148612e-02_rk,5.751534335611566823e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -3.925231146709443463e-17_rk,0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,-2.266233259184201259e-17_rk,8.835996987067363837e-17_rk,4.242704740889303191e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.749937394065062271e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.471137973516985143e-17_rk,2.858916754298431126e-17_rk,-1.596923826550380841e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 6.439505508593791339e-01_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,3.717850238834704557e-01_rk,-3.717850238834705112e-01_rk,-2.146501836197928226e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.439505508593786898e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.717850238834701226e-01_rk,-3.717850238834702337e-01_rk,2.146501836197926560e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.280369834735109542e-16_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,3.625973214694722014e-16_rk,3.625973214694722014e-16_rk,1.538345099265789440e-16_rk  &
                                        /),(/8,8/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%elem%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad1_dx
    !*******************************************************************************************






    !> Test cartesian dgrad2_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad2_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad2_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad2_dx
        ! 
        
        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.244016935856293360e+00_rk, -4.622231866529366047e-33_rk,1.244016935856292916e+00_rk,2.220446049250313081e-16_rk,-7.182335127930845609e-01_rk,7.182335127930847829e-01_rk,-9.992007221626408864e-16_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948126435e-01_rk, 2.220446049250315053e-16_rk,7.886751345948133096e-01_rk,-9.106836025229594345e-01_rk,-4.553418012614799393e-01_rk,4.553418012614791621e-01_rk,5.257834230632071337e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948136427e-01_rk, -2.188850364760640908e-16_rk,7.886751345948125325e-01_rk,9.106836025229598786e-01_rk,-4.553418012614793842e-01_rk,4.553418012614800503e-01_rk,-5.257834230632083550e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333335369e-01_rk, 0.000000000000000000e+00_rk,3.333333333333334814e-01_rk,-5.551115123125782702e-17_rk,-1.924500897298753455e-01_rk,1.924500897298754010e-01_rk,-2.636779683484746784e-16_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk, -1.078520768856852078e-32_rk,3.333333333333334259e-01_rk,2.775557561562891351e-17_rk,1.924500897298753455e-01_rk,-1.924500897298753455e-01_rk,-2.498001805406602216e-16_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051870234e-01_rk, 2.220446049250315053e-16_rk,2.113248654051873565e-01_rk,-2.440169358562925273e-01_rk,1.220084679281465134e-01_rk,-1.220084679281462914e-01_rk,-1.408832436034583302e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051873010e-01_rk, -2.531865957979871877e-16_rk,2.113248654051869402e-01_rk,2.440169358562925550e-01_rk,1.220084679281463191e-01_rk,-1.220084679281465134e-01_rk,1.408832436034580804e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704085697e-02_rk, 0.000000000000000000e+00_rk,8.931639747704085697e-02_rk,4.857225732735059864e-17_rk,5.156684612641722343e-02_rk,-5.156684612641718179e-02_rk,4.510281037539698445e-17_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.244016935856293138e+00_rk, -8.632101532570588168e-18_rk,1.244016935856293360e+00_rk,-1.436467025586169122e+00_rk,-7.182335127930846719e-01_rk,-7.182335127930843388e-01_rk,8.293446239041948331e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948130876e-01_rk, 0.000000000000000000e+00_rk,7.886751345948131986e-01_rk,-1.110223024625156540e-16_rk,-4.553418012614799948e-01_rk,-4.553418012614798838e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948130876e-01_rk, -5.472533083603162912e-18_rk,7.886751345948131986e-01_rk,1.110223024625156540e-16_rk,-4.553418012614799948e-01_rk,-4.553418012614798838e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333332038e-01_rk, 0.000000000000000000e+00_rk,3.333333333333333148e-01_rk,3.849001794597505244e-01_rk,-1.924500897298752899e-01_rk,-1.924500897298752067e-01_rk,-2.222222222222219323e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333332593e-01_rk, 9.251858538542972197e-18_rk,3.333333333333333148e-01_rk,-3.849001794597506354e-01_rk,1.924500897298753455e-01_rk,1.924500897298752899e-01_rk,-2.222222222222219601e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051870512e-01_rk, 0.000000000000000000e+00_rk,2.113248654051871067e-01_rk,-1.387778780781445676e-17_rk,1.220084679281462497e-01_rk,1.220084679281462359e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051870790e-01_rk, 5.865443281216275728e-18_rk,2.113248654051871345e-01_rk,0.000000000000000000e+00_rk,1.220084679281462775e-01_rk,1.220084679281462636e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704096799e-02_rk, 0.000000000000000000e+00_rk,8.931639747704096799e-02_rk,1.031336922528344469e-01_rk,5.156684612641723037e-02_rk,5.156684612641722343e-02_rk,5.954426498469391621e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 1.759305622509790501e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-1.015735574742850034e+00_rk,-1.015735574742850034e+00_rk,5.864352075032630562e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 1.115355071650410812e+00_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,6.439505508593793559e-01_rk,-6.439505508593793559e-01_rk,-3.717850238834698451e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 1.115355071650410812e+00_rk,0.000000000000000000e+00_rk,5.551115123125782702e-17_rk,-6.439505508593793559e-01_rk,6.439505508593793559e-01_rk,-3.717850238834699006e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 4.714045207910317337e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.721655269759088447e-01_rk,2.721655269759088447e-01_rk,1.571348402636770780e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.714045207910316782e-01_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-2.721655269759087892e-01_rk,-2.721655269759087892e-01_rk,1.571348402636769670e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.988584907226845000e-01_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,1.725460300683472614e-01_rk,-1.725460300683472337e-01_rk,-9.961949690756141673e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.988584907226845555e-01_rk,2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,-1.725460300683472059e-01_rk,1.725460300683472614e-01_rk,-9.961949690756140285e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.263124606543374329e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.292653316078576142e-02_rk,7.292653316078576142e-02_rk,4.210415355144576932e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.553418012614800503e-01_rk, -2.304498596492429116e-16_rk,-4.553418012614800503e-01_rk,2.220446049250313081e-16_rk,2.628917115316045106e-01_rk,-2.628917115316040665e-01_rk,8.881784197001252323e-16_rk, &
                                        0.000000000000000000e+00_rk, -8.881784197001252323e-16_rk, 0.000000000000000000e+00_rk,-8.881784197001252323e-16_rk,4.440892098500626162e-16_rk,8.881784197001252323e-16_rk,4.440892098500626162e-16_rk,9.992007221626408864e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.312964634635744590e-18_rk,-3.330669073875469621e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.670781508866063039e-18_rk,3.330669073875469621e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614796062e-01_rk, 2.220446049250315546e-16_rk,4.553418012614798283e-01_rk,0.000000000000000000e+00_rk,-2.628917115316042885e-01_rk,2.628917115316048436e-01_rk,4.440892098500626162e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462359e-01_rk, -2.417878360140622794e-16_rk,-1.220084679281464579e-01_rk,2.220446049250313081e-16_rk,-7.044162180172908183e-02_rk,7.044162180172909571e-02_rk,2.775557561562891351e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,-2.220446049250313081e-16_rk,1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,3.330669073875469621e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -2.479028023889582340e-18_rk,-8.326672684688674053e-17_rk,-1.110223024625156540e-16_rk,-1.665334536937734811e-16_rk,-5.837368622510037153e-17_rk,-7.632783294297951215e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281461804e-01_rk, 2.775557561562894309e-16_rk,1.220084679281464024e-01_rk,8.326672684688674053e-17_rk,7.044162180172916510e-02_rk,-7.044162180172883203e-02_rk,6.938893903907228378e-17_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.553418012614801058e-01_rk, 3.159568448967421404e-18_rk,-4.553418012614799948e-01_rk,5.257834230632093542e-01_rk,2.628917115316046771e-01_rk,2.628917115316046771e-01_rk,-3.035612008409864226e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.098785029861965406e-19_rk, 2.150214055322817374e-36_rk,-3.098785029861965406e-19_rk,2.407412430484044816e-35_rk,1.789084371151588633e-19_rk,1.789084371151588873e-19_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614797172e-01_rk, 0.000000000000000000e+00_rk,4.553418012614798283e-01_rk,5.257834230632090211e-01_rk,-2.628917115316045106e-01_rk,-2.628917115316045106e-01_rk,-3.035612008409861451e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281462775e-01_rk, -3.386415257326699936e-18_rk,-1.220084679281463053e-01_rk,1.408832436034582192e-01_rk,-7.044162180172910959e-02_rk,-7.044162180172912346e-02_rk,8.133897861876411561e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.239514011944789244e-18_rk, 3.440342488516516886e-35_rk,1.239514011944789436e-18_rk,0.000000000000000000e+00_rk,7.156337484606373790e-19_rk,7.156337484606373790e-19_rk,4.814824860968089633e-35_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462775e-01_rk, 0.000000000000000000e+00_rk,1.220084679281462775e-01_rk,1.408832436034582469e-01_rk,7.044162180172912346e-02_rk,7.044162180172912346e-02_rk,8.133897861876410174e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.439505508593794669e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.717850238834707333e-01_rk,3.717850238834707333e-01_rk,-2.146501836197929336e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.382343816109507668e-19_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.530147381912317036e-19_rk,-6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 6.439505508593794669e-01_rk,-5.551115123125782702e-17_rk,-8.326672684688674053e-17_rk,3.717850238834708443e-01_rk,3.717850238834707888e-01_rk,2.146501836197929891e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.725460300683472892e-01_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,9.961949690756161102e-02_rk,9.961949690756159714e-02_rk,-5.751534335611571680e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.752937526443807304e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,7.950952856672158081e-18_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 1.725460300683473169e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.961949690756161102e-02_rk,9.961949690756161102e-02_rk,5.751534335611573762e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.553418012614802723e-01_rk, 2.165720718414284056e-16_rk,-4.553418012614791621e-01_rk,-3.330669073875469621e-16_rk,2.628917115316041775e-01_rk,-2.628917115316049546e-01_rk,6.106226635438360972e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,3.330669073875469621e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.330669073875469621e-16_rk, &
                                        0.000000000000000000e+00_rk, 8.881784197001252323e-16_rk, -8.632101532570588168e-18_rk,8.881784197001252323e-16_rk,4.440892098500626162e-16_rk,-8.881784197001252323e-16_rk,-4.540567021370662276e-16_rk,9.992007221626408864e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614804944e-01_rk, -2.220446049250315546e-16_rk,4.553418012614791621e-01_rk,0.000000000000000000e+00_rk,-2.628917115316045106e-01_rk,2.628917115316042885e-01_rk,1.221245327087672194e-15_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281464024e-01_rk, 2.556656238218767361e-16_rk,-1.220084679281460138e-01_rk,-3.053113317719180486e-16_rk,-7.044162180172905408e-02_rk,7.044162180172902632e-02_rk,-6.938893903907228378e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,8.326672684688674053e-17_rk,-1.110223024625156540e-16_rk,1.665334536937734811e-16_rk,5.551115123125782702e-17_rk,-7.632783294297951215e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 9.251858538542962953e-18_rk,2.220446049250313081e-16_rk,1.665334536937734811e-16_rk,5.551115123125782702e-17_rk,-1.003391764270514065e-16_rk,2.498001805406602216e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281462359e-01_rk, -2.220446049250315546e-16_rk,1.220084679281463469e-01_rk,5.551115123125782702e-17_rk,7.044162180172891530e-02_rk,-7.044162180172913734e-02_rk,1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.553418012614801058e-01_rk, 3.159568448967421404e-18_rk,-4.553418012614799948e-01_rk,5.257834230632093542e-01_rk,2.628917115316046771e-01_rk,2.628917115316046771e-01_rk,-3.035612008409864226e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -4.316050766285291773e-18_rk, 2.994861835113113812e-35_rk,-4.316050766285291773e-18_rk,3.851859888774471706e-34_rk,2.491873071750904392e-18_rk,2.491873071750904777e-18_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614797172e-01_rk, 0.000000000000000000e+00_rk,4.553418012614798283e-01_rk,5.257834230632090211e-01_rk,-2.628917115316045106e-01_rk,-2.628917115316045106e-01_rk,-3.035612008409861451e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281462775e-01_rk, -3.386415257326699936e-18_rk,-1.220084679281463053e-01_rk,1.408832436034582192e-01_rk,-7.044162180172910959e-02_rk,-7.044162180172912346e-02_rk,8.133897861876411561e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.726420306514117017e-17_rk, 4.791778936180982955e-34_rk,1.726420306514117017e-17_rk,-1.540743955509788682e-33_rk,9.967492287003619110e-18_rk,9.967492287003620650e-18_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462775e-01_rk, 0.000000000000000000e+00_rk,1.220084679281462775e-01_rk,1.408832436034582469e-01_rk,7.044162180172912346e-02_rk,7.044162180172912346e-02_rk,8.133897861876410174e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.439505508593794669e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.717850238834707333e-01_rk,3.717850238834707333e-01_rk,-2.146501836197929891e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.103817529571448425e-18_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.524040693782433514e-18_rk,-1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.439505508593794669e-01_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,3.717850238834706778e-01_rk,3.717850238834707888e-01_rk,2.146501836197929336e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.725460300683472892e-01_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,9.961949690756161102e-02_rk,9.961949690756159714e-02_rk,-5.751534335611571680e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 2.441527011828580295e-17_rk,1.110223024625156540e-16_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-9.692613968738591998e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.725460300683473169e-01_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,9.961949690756158327e-02_rk,9.961949690756161102e-02_rk,5.751534335611573762e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, 1.155557966632341512e-33_rk,-3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,1.924500897298753732e-01_rk,-1.924500897298754010e-01_rk,-2.636779683484746784e-16_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948131986e-01_rk, -2.289834988289387337e-16_rk,-7.886751345948129766e-01_rk,9.106836025229596565e-01_rk,4.553418012614796062e-01_rk,-4.553418012614798283e-01_rk,-5.257834230632082440e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948130876e-01_rk, 2.182652794700917160e-16_rk,-7.886751345948135317e-01_rk,-9.106836025229601006e-01_rk,4.553418012614801613e-01_rk,-4.553418012614793842e-01_rk,5.257834230632073558e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,-1.110223024625156540e-16_rk,7.182335127930845609e-01_rk,-7.182335127930844498e-01_rk,-9.436895709313830594e-16_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704085697e-02_rk, -3.466673899897024536e-33_rk,-8.931639747704087084e-02_rk,7.632783294297951215e-17_rk,-5.156684612641724424e-02_rk,5.156684612641716792e-02_rk,5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051870234e-01_rk, -2.428612866367532397e-16_rk,-2.113248654051871900e-01_rk,2.440169358562925550e-01_rk,-1.220084679281464857e-01_rk,1.220084679281463469e-01_rk,1.408832436034580526e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051872455e-01_rk, 2.255970835716120634e-16_rk,-2.113248654051870790e-01_rk,-2.440169358562925828e-01_rk,-1.220084679281464024e-01_rk,1.220084679281464440e-01_rk,-1.408832436034583580e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk, 0.000000000000000000e+00_rk,-3.333333333333335369e-01_rk,-2.775557561562891351e-17_rk,-1.924500897298753732e-01_rk,1.924500897298753177e-01_rk,-3.053113317719180486e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk, 2.312964634635743820e-18_rk,-3.333333333333334259e-01_rk,3.849001794597507464e-01_rk,1.924500897298754010e-01_rk,1.924500897298753455e-01_rk,-2.222222222222220711e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948130876e-01_rk, 0.000000000000000000e+00_rk,-7.886751345948131986e-01_rk,1.110223024625156540e-16_rk,4.553418012614799948e-01_rk,4.553418012614798838e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948130876e-01_rk, 5.472533083603162912e-18_rk,-7.886751345948131986e-01_rk,-1.110223024625156540e-16_rk,4.553418012614799948e-01_rk,4.553418012614798838e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292694e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292916e+00_rk,-1.436467025586168678e+00_rk,7.182335127930843388e-01_rk,7.182335127930843388e-01_rk,8.293446239041945001e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704095411e-02_rk, -2.479028023889578488e-18_rk,-8.931639747704095411e-02_rk,1.031336922528344469e-01_rk,-5.156684612641722343e-02_rk,-5.156684612641722343e-02_rk,5.954426498469390927e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051870512e-01_rk, 0.000000000000000000e+00_rk,-2.113248654051871067e-01_rk,1.387778780781445676e-17_rk,-1.220084679281462497e-01_rk,-1.220084679281462359e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051870790e-01_rk, -5.865443281216275728e-18_rk,-2.113248654051871345e-01_rk,0.000000000000000000e+00_rk,-1.220084679281462775e-01_rk,-1.220084679281462636e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333148e-01_rk, 0.000000000000000000e+00_rk,-3.333333333333333703e-01_rk,-3.849001794597505244e-01_rk,-1.924500897298753177e-01_rk,-1.924500897298752067e-01_rk,-2.222222222222219878e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, -4.714045207910317337e-01_rk,1.387778780781445676e-17_rk,-6.938893903907228378e-18_rk,2.721655269759087892e-01_rk,2.721655269759088447e-01_rk,-1.571348402636770780e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -1.115355071650410812e+00_rk,-5.551115123125782702e-17_rk,2.775557561562891351e-17_rk,-6.439505508593792449e-01_rk,6.439505508593793559e-01_rk,3.717850238834699006e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, -1.115355071650410812e+00_rk,5.551115123125782702e-17_rk,2.775557561562891351e-17_rk,6.439505508593793559e-01_rk,-6.439505508593793559e-01_rk,3.717850238834699006e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -1.759305622509790501e+00_rk,-1.110223024625156540e-16_rk,-2.220446049250313081e-16_rk,-1.015735574742850034e+00_rk,-1.015735574742850034e+00_rk,-5.864352075032629452e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.263124606543374329e-01_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,7.292653316078574754e-02_rk,7.292653316078576142e-02_rk,-4.210415355144576238e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.988584907226845000e-01_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,-1.725460300683472059e-01_rk,1.725460300683472337e-01_rk,9.961949690756140285e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.988584907226845555e-01_rk,2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,1.725460300683472892e-01_rk,-1.725460300683472614e-01_rk,9.961949690756143061e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -4.714045207910317337e-01_rk,1.110223024625156540e-16_rk,1.110223024625156540e-16_rk,-2.721655269759089002e-01_rk,-2.721655269759087337e-01_rk,-1.571348402636770225e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk, 3.851859888774471706e-34_rk,3.333333333333334259e-01_rk,-2.775557561562891351e-17_rk,-1.924500897298754010e-01_rk,1.924500897298754010e-01_rk,2.914335439641035919e-16_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051870234e-01_rk, 6.938893903907234541e-18_rk,2.113248654051873565e-01_rk,-2.440169358562925273e-01_rk,-1.220084679281463469e-01_rk,1.220084679281461804e-01_rk,1.408832436034582469e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051873288e-01_rk, -6.092290089575558497e-18_rk,2.113248654051869679e-01_rk,2.440169358562925273e-01_rk,-1.220084679281461804e-01_rk,1.220084679281463746e-01_rk,-1.408832436034579694e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.931639747704087084e-02_rk, 0.000000000000000000e+00_rk,8.931639747704085697e-02_rk,3.469446951953614189e-17_rk,-5.156684612641722343e-02_rk,5.156684612641718873e-02_rk,-3.816391647148975608e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292694e+00_rk, 1.232595164407830946e-32_rk,1.244016935856292916e+00_rk,-5.551115123125782702e-16_rk,7.182335127930845609e-01_rk,-7.182335127930841168e-01_rk,8.881784197001252323e-16_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948126435e-01_rk, 1.110223024625157526e-16_rk,7.886751345948137537e-01_rk,-9.106836025229601006e-01_rk,4.553418012614804944e-01_rk,-4.553418012614796062e-01_rk,-5.257834230632073558e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948137537e-01_rk, -1.236605762583854598e-16_rk,7.886751345948125325e-01_rk,9.106836025229598786e-01_rk,4.553418012614795507e-01_rk,-4.553418012614802723e-01_rk,5.257834230632083550e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333333148e-01_rk, 0.000000000000000000e+00_rk,3.333333333333334814e-01_rk,5.551115123125782702e-17_rk,1.924500897298754010e-01_rk,-1.924500897298753455e-01_rk,3.053113317719180486e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk, -2.312964634635743820e-18_rk,3.333333333333334259e-01_rk,-3.849001794597507464e-01_rk,-1.924500897298754010e-01_rk,-1.924500897298753455e-01_rk,2.222222222222220711e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051870790e-01_rk, 0.000000000000000000e+00_rk,2.113248654051871345e-01_rk,0.000000000000000000e+00_rk,-1.220084679281462775e-01_rk,-1.220084679281462636e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051870790e-01_rk, -1.466360820304068932e-18_rk,2.113248654051871345e-01_rk,0.000000000000000000e+00_rk,-1.220084679281462775e-01_rk,-1.220084679281462636e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.931639747704094023e-02_rk, 0.000000000000000000e+00_rk,8.931639747704095411e-02_rk,1.031336922528344330e-01_rk,-5.156684612641722343e-02_rk,-5.156684612641720955e-02_rk,-5.954426498469390927e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk, 3.452840613028232802e-17_rk,1.244016935856293138e+00_rk,-1.436467025586168900e+00_rk,7.182335127930844498e-01_rk,7.182335127930844498e-01_rk,-8.293446239041943890e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948130876e-01_rk, 0.000000000000000000e+00_rk,7.886751345948131986e-01_rk,-1.110223024625156540e-16_rk,4.553418012614799948e-01_rk,4.553418012614798838e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948130876e-01_rk, 2.189013233441265165e-17_rk,7.886751345948131986e-01_rk,1.110223024625156540e-16_rk,4.553418012614799948e-01_rk,4.553418012614798838e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk, 0.000000000000000000e+00_rk,3.333333333333333703e-01_rk,3.849001794597505244e-01_rk,1.924500897298753177e-01_rk,1.924500897298752067e-01_rk,2.222222222222219878e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 4.714045207910317337e-01_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-2.721655269759087892e-01_rk,-2.721655269759088447e-01_rk,1.571348402636770225e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.988584907226845555e-01_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,1.725460300683472892e-01_rk,-1.725460300683472614e-01_rk,-9.961949690756141673e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 2.988584907226845555e-01_rk,2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,-1.725460300683473169e-01_rk,1.725460300683472614e-01_rk,-9.961949690756138898e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, 1.263124606543374329e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.292653316078576142e-02_rk,7.292653316078576142e-02_rk,4.210415355144576932e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.759305622509790279e+00_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-1.015735574742849812e+00_rk,-1.015735574742849812e+00_rk,5.864352075032628342e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.115355071650410812e+00_rk,0.000000000000000000e+00_rk,5.551115123125782702e-17_rk,6.439505508593793559e-01_rk,-6.439505508593793559e-01_rk,-3.717850238834699006e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 1.115355071650410812e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,-6.439505508593793559e-01_rk,6.439505508593793559e-01_rk,-3.717850238834699006e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.714045207910317337e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.721655269759088447e-01_rk,2.721655269759088447e-01_rk,1.571348402636770780e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.220084679281460138e-01_rk, -2.003086131649547953e-18_rk,-1.220084679281465134e-01_rk,3.330669073875469621e-16_rk,7.044162180172927612e-02_rk,-7.044162180172897081e-02_rk,-4.163336342344337027e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,-5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,-2.498001805406602216e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, 6.197570059723955849e-19_rk,-8.326672684688674053e-17_rk,-1.110223024625156540e-16_rk,1.665334536937734811e-16_rk,5.622678497971846315e-17_rk,7.632783294297951215e-17_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,1.220084679281464579e-01_rk,1.665334536937734811e-16_rk,-7.044162180172913734e-02_rk,7.044162180172899856e-02_rk,-4.163336342344337027e-17_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614796062e-01_rk, -7.740128356567053414e-17_rk,-4.553418012614802723e-01_rk,8.881784197001252323e-16_rk,-2.628917115316051767e-01_rk,2.628917115316043440e-01_rk,-7.771561172376095783e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-8.881784197001252323e-16_rk,8.881784197001252323e-16_rk,-8.881784197001252323e-16_rk,0.000000000000000000e+00_rk,-9.992007221626408864e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.251858538542972197e-18_rk,-1.110223024625156540e-16_rk,5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,-1.068312603546425061e-17_rk,-2.498001805406602216e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614796062e-01_rk, 0.000000000000000000e+00_rk,4.553418012614802723e-01_rk,1.110223024625156540e-16_rk,2.628917115316046216e-01_rk,-2.628917115316043995e-01_rk,-3.885780586188047891e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.220084679281463191e-01_rk, 8.466038143316752730e-19_rk,-1.220084679281463469e-01_rk,1.408832436034582747e-01_rk,7.044162180172913734e-02_rk,7.044162180172912346e-02_rk,-8.133897861876412949e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 3.098785029861973110e-19_rk, -2.150214055322823054e-36_rk,3.098785029861973591e-19_rk,0.000000000000000000e+00_rk,-1.789084371151593447e-19_rk,-1.789084371151593447e-19_rk,-1.203706215242022408e-35_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462497e-01_rk, 0.000000000000000000e+00_rk,1.220084679281462636e-01_rk,1.408832436034582192e-01_rk,-7.044162180172910959e-02_rk,-7.044162180172909571e-02_rk,-8.133897861876410174e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614797727e-01_rk, -1.263827379586968099e-17_rk,-4.553418012614799948e-01_rk,5.257834230632092432e-01_rk,-2.628917115316046216e-01_rk,-2.628917115316045661e-01_rk,3.035612008409862561e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.239514011944785970e-18_rk, -3.440342488516507799e-35_rk,-1.239514011944786162e-18_rk,0.000000000000000000e+00_rk,-7.156337484606354530e-19_rk,-7.156337484606354530e-19_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614799393e-01_rk, 0.000000000000000000e+00_rk,4.553418012614798283e-01_rk,5.257834230632090211e-01_rk,2.628917115316045661e-01_rk,2.628917115316045106e-01_rk,3.035612008409862561e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.725460300683473169e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.961949690756161102e-02_rk,9.961949690756161102e-02_rk,-5.751534335611570986e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.382343816109518261e-19_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,7.191908642098460033e-18_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 1.725460300683473169e-01_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,9.961949690756161102e-02_rk,9.961949690756158327e-02_rk,5.751534335611570986e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, -6.439505508593794669e-01_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,3.717850238834707333e-01_rk,3.717850238834706778e-01_rk,-2.146501836197929336e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.752937526443802682e-18_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-7.950952856672154999e-18_rk,-3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.439505508593794669e-01_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,3.717850238834707888e-01_rk,3.717850238834707333e-01_rk,2.146501836197929336e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.220084679281464024e-01_rk, 2.003086131649546798e-18_rk,-1.220084679281461248e-01_rk,-2.775557561562891351e-16_rk,7.044162180172891530e-02_rk,-7.044162180172919285e-02_rk,1.804112415015879378e-16_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk,8.326672684688674053e-17_rk,-1.110223024625156540e-16_rk,-1.665334536937734811e-16_rk,-5.551115123125782702e-17_rk,7.632783294297951215e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.312964634635743049e-18_rk,1.110223024625156540e-16_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,-2.670781508866062654e-18_rk,-2.498001805406602216e-16_rk, &
                                        0.000000000000000000e+00_rk, -1.220084679281465689e-01_rk, 0.000000000000000000e+00_rk,1.220084679281463469e-01_rk,-1.665334536937734811e-16_rk,-7.044162180172899856e-02_rk,7.044162180172919285e-02_rk,-8.326672684688674053e-17_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614798283e-01_rk, 7.740128356567052181e-17_rk,-4.553418012614789401e-01_rk,-4.440892098500626162e-16_rk,-2.628917115316040665e-01_rk,2.628917115316045106e-01_rk,-5.551115123125782702e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,-2.498001805406602216e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.452840613028235267e-17_rk,8.881784197001252323e-16_rk,8.881784197001252323e-16_rk,8.881784197001252323e-16_rk,3.986996914801447028e-17_rk,-9.992007221626408864e-16_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614800503e-01_rk, 0.000000000000000000e+00_rk,4.553418012614791621e-01_rk,-6.661338147750939243e-16_rk,2.628917115316045106e-01_rk,-2.628917115316049546e-01_rk,-1.221245327087672194e-15_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.220084679281463191e-01_rk, 8.466038143316752730e-19_rk,-1.220084679281463469e-01_rk,1.408832436034582747e-01_rk,7.044162180172913734e-02_rk,7.044162180172912346e-02_rk,-8.133897861876412949e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.316050766285292543e-18_rk, -2.994861835113114347e-35_rk,4.316050766285292543e-18_rk,-3.851859888774471706e-34_rk,-2.491873071750904777e-18_rk,-2.491873071750905163e-18_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.220084679281462497e-01_rk, 0.000000000000000000e+00_rk,1.220084679281462636e-01_rk,1.408832436034582192e-01_rk,-7.044162180172910959e-02_rk,-7.044162180172909571e-02_rk,-8.133897861876410174e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.553418012614797727e-01_rk, -1.263827379586968099e-17_rk,-4.553418012614799948e-01_rk,5.257834230632092432e-01_rk,-2.628917115316046216e-01_rk,-2.628917115316045661e-01_rk,3.035612008409862561e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.726420306514116709e-17_rk, -4.791778936180982099e-34_rk,-1.726420306514116709e-17_rk,1.540743955509788682e-33_rk,-9.967492287003617569e-18_rk,-9.967492287003619110e-18_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 4.553418012614799393e-01_rk, 0.000000000000000000e+00_rk,4.553418012614798283e-01_rk,5.257834230632090211e-01_rk,2.628917115316045661e-01_rk,2.628917115316045106e-01_rk,3.035612008409862561e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -1.725460300683473169e-01_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,9.961949690756161102e-02_rk,9.961949690756163878e-02_rk,-5.751534335611572374e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 6.103817529571450737e-18_rk,-1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,-1.074982617687332144e-16_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 1.725460300683473169e-01_rk,5.551115123125782702e-17_rk,8.326672684688674053e-17_rk,9.961949690756155551e-02_rk,9.961949690756158327e-02_rk,5.751534335611569598e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.439505508593794669e-01_rk,-2.775557561562891351e-17_rk,2.775557561562891351e-17_rk,3.717850238834706778e-01_rk,3.717850238834706778e-01_rk,-2.146501836197928781e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,-6.938893903907228378e-18_rk,3.469446951953614189e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.441527011828579370e-17_rk,-1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.409616277512973406e-17_rk,-1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.439505508593794669e-01_rk,5.551115123125782702e-17_rk,2.775557561562891351e-17_rk,3.717850238834706778e-01_rk,3.717850238834707333e-01_rk,2.146501836197929336e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.931639747704087084e-02_rk, 8.666684749742561339e-34_rk,-8.931639747704088472e-02_rk,6.245004513516505540e-17_rk,5.156684612641723731e-02_rk,-5.156684612641716792e-02_rk,-6.591949208711866959e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051870234e-01_rk, -3.469446951953617270e-18_rk,-2.113248654051872455e-01_rk,2.440169358562925550e-01_rk,1.220084679281463746e-01_rk,-1.220084679281462081e-01_rk,-1.408832436034579694e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.113248654051872455e-01_rk, 8.466038143316737322e-19_rk,-2.113248654051870790e-01_rk,-2.440169358562925828e-01_rk,1.220084679281462359e-01_rk,-1.220084679281463469e-01_rk,1.408832436034582747e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, 0.000000000000000000e+00_rk,-3.333333333333334259e-01_rk,5.551115123125782702e-17_rk,1.924500897298753455e-01_rk,-1.924500897298754287e-01_rk,2.636779683484746784e-16_rk, &
                                        0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk, 1.540743955509788682e-33_rk,-3.333333333333334814e-01_rk,5.551115123125782702e-17_rk,-1.924500897298753732e-01_rk,1.924500897298753177e-01_rk,2.636779683484746784e-16_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948131986e-01_rk, -5.551115123125787632e-17_rk,-7.886751345948129766e-01_rk,9.106836025229596565e-01_rk,-4.553418012614796062e-01_rk,4.553418012614799948e-01_rk,5.257834230632083550e-01_rk, &
                                        0.000000000000000000e+00_rk, 7.886751345948135317e-01_rk, -1.263827379586968870e-17_rk,-7.886751345948133096e-01_rk,-9.106836025229601006e-01_rk,-4.553418012614803834e-01_rk,4.553418012614798283e-01_rk,-5.257834230632074668e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292694e+00_rk,1.110223024625156540e-16_rk,-7.182335127930843388e-01_rk,7.182335127930845609e-01_rk,1.110223024625156540e-15_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.931639747704098187e-02_rk, 6.197570059723948145e-19_rk,-8.931639747704099574e-02_rk,1.031336922528344746e-01_rk,5.156684612641723731e-02_rk,5.156684612641723731e-02_rk,-5.954426498469393009e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051870790e-01_rk, 0.000000000000000000e+00_rk,-2.113248654051871345e-01_rk,0.000000000000000000e+00_rk,1.220084679281462775e-01_rk,1.220084679281462636e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.113248654051870790e-01_rk, 1.466360820304068932e-18_rk,-2.113248654051871345e-01_rk,0.000000000000000000e+00_rk,1.220084679281462775e-01_rk,1.220084679281462636e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333332038e-01_rk, 0.000000000000000000e+00_rk,-3.333333333333333148e-01_rk,-3.849001794597505244e-01_rk,1.924500897298752899e-01_rk,1.924500897298752067e-01_rk,2.222222222222219323e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.333333333333332593e-01_rk, -9.251858538542972197e-18_rk,-3.333333333333333148e-01_rk,3.849001794597506354e-01_rk,-1.924500897298753455e-01_rk,-1.924500897298752899e-01_rk,2.222222222222219601e-01_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948130876e-01_rk, 0.000000000000000000e+00_rk,-7.886751345948131986e-01_rk,1.110223024625156540e-16_rk,-4.553418012614799948e-01_rk,-4.553418012614798838e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -7.886751345948130876e-01_rk, -2.189013233441265165e-17_rk,-7.886751345948131986e-01_rk,-1.110223024625156540e-16_rk,-4.553418012614799948e-01_rk,-4.553418012614798838e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.244016935856292916e+00_rk, 0.000000000000000000e+00_rk,-1.244016935856292694e+00_rk,-1.436467025586168678e+00_rk,-7.182335127930842278e-01_rk,-7.182335127930843388e-01_rk,-8.293446239041943890e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, -1.263124606543374329e-01_rk,-1.387778780781445676e-17_rk,6.938893903907228378e-18_rk,7.292653316078576142e-02_rk,7.292653316078576142e-02_rk,-4.210415355144576932e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, -2.988584907226845555e-01_rk,2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,-1.725460300683472892e-01_rk,1.725460300683472614e-01_rk,9.961949690756140285e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.988584907226845555e-01_rk,-2.775557561562891351e-17_rk,-2.775557561562891351e-17_rk,1.725460300683472892e-01_rk,-1.725460300683472614e-01_rk,9.961949690756143061e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -4.714045207910317337e-01_rk,1.110223024625156540e-16_rk,2.220446049250313081e-16_rk,-2.721655269759089002e-01_rk,-2.721655269759089557e-01_rk,-1.571348402636770780e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.714045207910316782e-01_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,2.721655269759087892e-01_rk,2.721655269759087892e-01_rk,-1.571348402636770503e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.115355071650410812e+00_rk,-5.551115123125782702e-17_rk,8.326672684688674053e-17_rk,-6.439505508593793559e-01_rk,6.439505508593793559e-01_rk,3.717850238834699006e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, -1.115355071650410812e+00_rk,2.775557561562891351e-17_rk,-8.326672684688674053e-17_rk,6.439505508593793559e-01_rk,-6.439505508593792449e-01_rk,3.717850238834699006e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk, -1.759305622509790501e+00_rk,-1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,-1.015735574742850034e+00_rk,-1.015735574742850034e+00_rk,-5.864352075032628342e-01_rk  &
                                        /),(/8,8/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%elem%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad2_dx
    !*******************************************************************************************







    !> Test cartesian dgrad3_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dgrad3_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_s,self%elem%nterms_c,3) :: test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dgrad3_dx
        ! 
        
        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.796528112548952505e-01_rk, 6.661338147750939243e-16_rk,8.796528112548945844e-01_rk,4.440892098500626162e-16_rk,-5.078677873714247948e-01_rk,5.078677873714247948e-01_rk,1.221245327087672194e-15_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955155060e-01_rk, 8.881784197001252323e-16_rk,2.357022603955162832e-01_rk,-2.721655269759087892e-01_rk,-1.360827634879542281e-01_rk,1.360827634879537840e-01_rk,1.571348402636755237e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, -5.551115123125782702e-17_rk,2.357022603955159223e-01_rk,2.721655269759087892e-01_rk,-1.360827634879543946e-01_rk,1.360827634879543668e-01_rk,-1.571348402636767172e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716834173e-02_rk, 3.330669073875469621e-16_rk,6.315623032716895235e-02_rk,3.538835890992686473e-16_rk,-3.646326658039272806e-02_rk,3.646326658039295010e-02_rk,-4.440892098500626162e-16_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548955836e-01_rk, -6.106226635438360972e-16_rk,8.796528112548941403e-01_rk,7.771561172376095783e-16_rk,5.078677873714245727e-01_rk,-5.078677873714247948e-01_rk,-1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, -2.220446049250313081e-16_rk,2.357022603955159501e-01_rk,-2.721655269759088447e-01_rk,1.360827634879544779e-01_rk,-1.360827634879544223e-01_rk,-1.571348402636767172e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955162554e-01_rk, -2.289834988289385365e-16_rk,2.357022603955155060e-01_rk,2.721655269759087892e-01_rk,1.360827634879544223e-01_rk,-1.360827634879548387e-01_rk,1.571348402636772168e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716873031e-02_rk, 1.942890293094023946e-16_rk,6.315623032716854990e-02_rk,-1.040834085586084257e-16_rk,3.646326658039279744e-02_rk,-3.646326658039286683e-02_rk,-8.326672684688674053e-17_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.796528112548952505e-01_rk, 4.440892098500626162e-16_rk,8.796528112548952505e-01_rk,-1.015735574742850034e+00_rk,-5.078677873714252389e-01_rk,-5.078677873714252389e-01_rk,5.864352075032628342e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955157558e-01_rk, 0.000000000000000000e+00_rk,2.357022603955157836e-01_rk,-1.895741069380452380e-17_rk,-1.360827634879544501e-01_rk,-1.360827634879542281e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158113e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158113e-01_rk,-2.775557561562891351e-17_rk,-1.360827634879542281e-01_rk,-1.360827634879544501e-01_rk,-7.296710778137543360e-18_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716873031e-02_rk, 0.000000000000000000e+00_rk,6.315623032716873031e-02_rk,7.292653316078577530e-02_rk,-3.646326658039289459e-02_rk,-3.646326658039289459e-02_rk,-4.210415355144572769e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, -5.551115123125782702e-17_rk,8.796528112548951395e-01_rk,-1.015735574742849812e+00_rk,5.078677873714250168e-01_rk,5.078677873714250168e-01_rk,-5.864352075032627232e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158391e-01_rk,2.267595272963886187e-17_rk,1.360827634879543668e-01_rk,1.360827634879543946e-01_rk,1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, -5.551115123125782702e-17_rk,2.357022603955158391e-01_rk,-2.775557561562891351e-17_rk,1.360827634879543668e-01_rk,1.360827634879543946e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 2.775557561562891351e-17_rk,6.315623032716871643e-02_rk,7.292653316078576142e-02_rk,3.646326658039288071e-02_rk,3.646326658039288071e-02_rk,4.210415355144576238e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293138e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930843388e-01_rk,-7.182335127930843388e-01_rk,4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.906538933386797396e-18_rk, 3.333333333333332038e-01_rk,4.906538933386798937e-18_rk,-5.665583147960495444e-18_rk,1.924500897298752344e-01_rk,-1.924500897298752344e-01_rk,-1.111111111111109523e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.542051911182396785e-18_rk, 3.333333333333332593e-01_rk,-6.542051911182396785e-18_rk,0.000000000000000000e+00_rk,-1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,-1.111111111111109523e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704100962e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641725118e-02_rk,5.156684612641725118e-02_rk,2.977213249234697545e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293138e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930844498e-01_rk,-7.182335127930844498e-01_rk,4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.906538933386798166e-18_rk, 3.333333333333333148e-01_rk,4.906538933386799707e-18_rk,-5.665583147960496214e-18_rk,1.924500897298752899e-01_rk,-1.924500897298752899e-01_rk,-1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.542051911182397555e-18_rk, 3.333333333333333148e-01_rk,-6.542051911182397555e-18_rk,-7.703719777548943412e-34_rk,-1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,-1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704098187e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641723731e-02_rk,5.156684612641723731e-02_rk,2.977213249234696504e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.357022603955160334e-01_rk, -4.440892098500626162e-16_rk,2.357022603955157836e-01_rk,1.387778780781445676e-16_rk,-1.360827634879535619e-01_rk,1.360827634879551162e-01_rk,-1.776356839400250465e-15_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548951395e-01_rk, 0.000000000000000000e+00_rk,8.796528112548946954e-01_rk,-1.015735574742849590e+00_rk,-5.078677873714245727e-01_rk,5.078677873714245727e-01_rk,5.864352075032639444e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716889684e-02_rk, -2.220446049250313081e-16_rk,6.315623032716836949e-02_rk,7.292653316078565040e-02_rk,-3.646326658039245050e-02_rk,3.646326658039276969e-02_rk,-4.210415355144602606e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955159501e-01_rk, 2.220446049250313081e-16_rk,2.357022603955159779e-01_rk,5.551115123125782702e-17_rk,-1.360827634879547832e-01_rk,1.360827634879542281e-01_rk,4.440892098500626162e-16_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, 2.220446049250313081e-16_rk,2.357022603955159501e-01_rk,-5.551115123125782702e-17_rk,1.360827634879545056e-01_rk,-1.360827634879543946e-01_rk,3.885780586188047891e-16_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548949174e-01_rk, 4.440892098500626162e-16_rk,8.796528112548949174e-01_rk,-1.015735574742849590e+00_rk,5.078677873714249058e-01_rk,-5.078677873714249058e-01_rk,-5.864352075032631673e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, -1.110223024625156540e-16_rk,6.315623032716853602e-02_rk,7.292653316078565040e-02_rk,3.646326658039276969e-02_rk,-3.646326658039288071e-02_rk,4.210415355144565830e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955157558e-01_rk, 2.220446049250313081e-16_rk,2.357022603955161444e-01_rk,2.220446049250313081e-16_rk,1.360827634879547554e-01_rk,-1.360827634879541725e-01_rk,2.775557561562891351e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955157003e-01_rk, 0.000000000000000000e+00_rk,2.357022603955157003e-01_rk,-2.721655269759085671e-01_rk,-1.360827634879543391e-01_rk,-1.360827634879543391e-01_rk,1.571348402636769948e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, 0.000000000000000000e+00_rk,8.796528112548951395e-01_rk,0.000000000000000000e+00_rk,-5.078677873714249058e-01_rk,-5.078677873714249058e-01_rk,5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716854990e-02_rk, -4.382343816109507668e-19_rk,6.315623032716854990e-02_rk,1.336382355046097823e-51_rk,-3.646326658039278357e-02_rk,-3.646326658039278357e-02_rk,-3.323368824749963965e-18_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158668e-01_rk,2.721655269759087892e-01_rk,-1.360827634879544501e-01_rk,-1.360827634879544501e-01_rk,-1.571348402636770503e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158391e-01_rk,-2.721655269759087892e-01_rk,1.360827634879543946e-01_rk,1.360827634879543946e-01_rk,-1.571348402636770503e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548952505e-01_rk, 0.000000000000000000e+00_rk,8.796528112548952505e-01_rk,1.110223024625156540e-16_rk,5.078677873714250168e-01_rk,5.078677873714251279e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 1.752937526443807690e-18_rk,6.315623032716871643e-02_rk,0.000000000000000000e+00_rk,3.646326658039287377e-02_rk,3.646326658039287377e-02_rk,-5.843125088146018570e-19_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955160334e-01_rk, 0.000000000000000000e+00_rk,2.357022603955160334e-01_rk,2.721655269759089557e-01_rk,1.360827634879545056e-01_rk,1.360827634879545056e-01_rk,1.571348402636771890e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333330928e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298751789e-01_rk,-1.924500897298751789e-01_rk,1.111111111111109245e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.831145258871434759e-17_rk, 1.244016935856293138e+00_rk,1.831145258871435375e-17_rk,-2.114424416269460417e-17_rk,7.182335127930844498e-01_rk,-7.182335127930844498e-01_rk,-4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.752937526443803067e-18_rk, 8.931639747704074594e-02_rk,-1.752937526443803067e-18_rk,0.000000000000000000e+00_rk,-5.156684612641709159e-02_rk,5.156684612641709159e-02_rk,-2.977213249234688178e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298754010e-01_rk,1.924500897298754010e-01_rk,1.111111111111110633e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752899e-01_rk,-1.924500897298752899e-01_rk,1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.831145258871435375e-17_rk, 1.244016935856293360e+00_rk,1.831145258871435991e-17_rk,-2.114424416269461033e-17_rk,7.182335127930845609e-01_rk,-7.182335127930845609e-01_rk,-4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.752937526443807304e-18_rk, 8.931639747704095411e-02_rk,-1.752937526443807304e-18_rk,0.000000000000000000e+00_rk,-5.156684612641722343e-02_rk,5.156684612641722343e-02_rk,-2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333336479e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298755120e-01_rk,1.924500897298755120e-01_rk,1.111111111111110911e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.357022603955158946e-01_rk, -2.220446049250313081e-16_rk,2.357022603955158946e-01_rk,0.000000000000000000e+00_rk,-1.360827634879544501e-01_rk,1.360827634879544501e-01_rk,-4.440892098500626162e-16_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716853602e-02_rk, 2.220446049250313081e-16_rk,6.315623032716873031e-02_rk,-7.292653316078567816e-02_rk,-3.646326658039267254e-02_rk,3.646326658039256152e-02_rk,4.210415355144608851e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548955836e-01_rk, 0.000000000000000000e+00_rk,8.796528112548943623e-01_rk,1.015735574742849590e+00_rk,-5.078677873714245727e-01_rk,5.078677873714250168e-01_rk,-5.864352075032639444e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955157003e-01_rk, 8.881784197001252323e-16_rk,2.357022603955162277e-01_rk,3.330669073875469621e-16_rk,-1.360827634879540060e-01_rk,1.360827634879548942e-01_rk,1.554312234475219157e-15_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955159779e-01_rk, -2.775557561562891351e-16_rk,2.357022603955157836e-01_rk,1.387778780781445676e-16_rk,1.360827634879545611e-01_rk,-1.360827634879542558e-01_rk,-8.326672684688674053e-17_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, 1.110223024625156540e-16_rk,6.315623032716854990e-02_rk,-7.292653316078565040e-02_rk,3.646326658039278357e-02_rk,-3.646326658039286683e-02_rk,-4.210415355144566524e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548955836e-01_rk, -5.551115123125782702e-16_rk,8.796528112548941403e-01_rk,1.015735574742849590e+00_rk,5.078677873714245727e-01_rk,-5.078677873714254609e-01_rk,5.864352075032632783e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158946e-01_rk, 1.110223024625156540e-16_rk,2.357022603955159779e-01_rk,5.551115123125782702e-17_rk,1.360827634879545056e-01_rk,-1.360827634879543946e-01_rk,-3.330669073875469621e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158668e-01_rk,-2.721655269759087892e-01_rk,-1.360827634879544501e-01_rk,-1.360827634879544501e-01_rk,1.571348402636770503e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716853602e-02_rk, 0.000000000000000000e+00_rk,6.315623032716853602e-02_rk,0.000000000000000000e+00_rk,-3.646326658039277663e-02_rk,-3.646326658039277663e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, -6.103817529571448425e-18_rk,8.796528112548951395e-01_rk,0.000000000000000000e+00_rk,-5.078677873714249058e-01_rk,-5.078677873714249058e-01_rk,-5.347654538806734806e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955157003e-01_rk, 0.000000000000000000e+00_rk,2.357022603955157003e-01_rk,2.721655269759085671e-01_rk,-1.360827634879543391e-01_rk,-1.360827634879543391e-01_rk,-1.571348402636769948e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955159779e-01_rk, 0.000000000000000000e+00_rk,2.357022603955159779e-01_rk,-2.721655269759089557e-01_rk,1.360827634879545056e-01_rk,1.360827634879545056e-01_rk,-1.571348402636771613e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 0.000000000000000000e+00_rk,6.315623032716871643e-02_rk,0.000000000000000000e+00_rk,3.646326658039287377e-02_rk,3.646326658039287377e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548952505e-01_rk, 2.441527011828579986e-17_rk,8.796528112548952505e-01_rk,-1.110223024625156540e-16_rk,5.078677873714250168e-01_rk,5.078677873714251279e-01_rk,-8.138423372761925071e-18_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158668e-01_rk,2.721655269759087892e-01_rk,1.360827634879543946e-01_rk,1.360827634879544501e-01_rk,1.571348402636770780e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.314703144832852204e-18_rk, 8.931639747704071819e-02_rk,1.314703144832852589e-18_rk,-1.518088429147389933e-18_rk,5.156684612641708465e-02_rk,-5.156684612641708465e-02_rk,-2.977213249234687831e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.441527011828579370e-17_rk, 1.244016935856293138e+00_rk,-2.441527011828579678e-17_rk,0.000000000000000000e+00_rk,-7.182335127930844498e-01_rk,7.182335127930844498e-01_rk,-4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333332593e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333335369e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298754287e-01_rk,-1.924500897298754287e-01_rk,1.111111111111110494e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.314703144832855671e-18_rk, 8.931639747704095411e-02_rk,1.314703144832856056e-18_rk,-1.518088429147394170e-18_rk,5.156684612641722343e-02_rk,-5.156684612641722343e-02_rk,-2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.441527011828580295e-17_rk, 1.244016935856293360e+00_rk,-2.441527011828580295e-17_rk,0.000000000000000000e+00_rk,-7.182335127930845609e-01_rk,7.182335127930845609e-01_rk,-4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298753732e-01_rk,1.924500897298753732e-01_rk,1.111111111111110217e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.315623032716873031e-02_rk, -2.220446049250313081e-16_rk,6.315623032716853602e-02_rk,1.179611963664228824e-16_rk,-3.646326658039267254e-02_rk,3.646326658039300561e-02_rk,2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, 5.551115123125782702e-17_rk,2.357022603955159779e-01_rk,-2.721655269759089002e-01_rk,-1.360827634879544501e-01_rk,1.360827634879543391e-01_rk,1.571348402636767172e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158946e-01_rk, -8.881784197001252323e-16_rk,2.357022603955159779e-01_rk,2.721655269759089002e-01_rk,-1.360827634879542281e-01_rk,1.360827634879542003e-01_rk,-1.571348402636756070e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548954725e-01_rk, -1.110223024625156540e-15_rk,8.796528112548949174e-01_rk,-3.330669073875469621e-16_rk,-5.078677873714250168e-01_rk,5.078677873714250168e-01_rk,-1.554312234475219157e-15_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, -1.387778780781445676e-16_rk,6.315623032716853602e-02_rk,1.110223024625156540e-16_rk,3.646326658039276969e-02_rk,-3.646326658039288071e-02_rk,1.040834085586084257e-16_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, 1.942890293094023946e-16_rk,2.357022603955159779e-01_rk,-2.721655269759089002e-01_rk,1.360827634879546721e-01_rk,-1.360827634879546166e-01_rk,-1.571348402636772168e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955159223e-01_rk, 2.220446049250313081e-16_rk,2.357022603955158668e-01_rk,2.721655269759088447e-01_rk,1.360827634879544223e-01_rk,-1.360827634879544223e-01_rk,1.571348402636766894e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548954725e-01_rk, 3.885780586188047891e-16_rk,8.796528112548948064e-01_rk,-3.330669073875469621e-16_rk,5.078677873714250168e-01_rk,-5.078677873714250168e-01_rk,2.775557561562891351e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 5.551115123125782702e-17_rk,6.315623032716871643e-02_rk,-7.292653316078576142e-02_rk,-3.646326658039289459e-02_rk,-3.646326658039289459e-02_rk,4.210415355144575544e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158391e-01_rk,-8.798164921824391251e-18_rk,-1.360827634879543391e-01_rk,-1.360827634879544501e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158113e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158113e-01_rk,0.000000000000000000e+00_rk,-1.360827634879544501e-01_rk,-1.360827634879542281e-01_rk,7.296710778137543360e-18_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548952505e-01_rk, -4.440892098500626162e-16_rk,8.796528112548952505e-01_rk,1.015735574742850034e+00_rk,-5.078677873714252389e-01_rk,-5.078677873714252389e-01_rk,-5.864352075032629452e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 2.775557561562891351e-17_rk,6.315623032716871643e-02_rk,-7.292653316078574754e-02_rk,3.646326658039285989e-02_rk,3.646326658039285989e-02_rk,-4.210415355144575544e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 0.000000000000000000e+00_rk,2.357022603955158391e-01_rk,3.283519850161896823e-17_rk,1.360827634879543391e-01_rk,1.360827634879543946e-01_rk,-1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, 5.551115123125782702e-17_rk,2.357022603955158391e-01_rk,-2.775557561562891351e-17_rk,1.360827634879543668e-01_rk,1.360827634879544223e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548952505e-01_rk, 5.551115123125782702e-17_rk,8.796528112548952505e-01_rk,1.015735574742850034e+00_rk,5.078677873714251279e-01_rk,5.078677873714251279e-01_rk,5.864352075032629452e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704094023e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641722343e-02_rk,-5.156684612641722343e-02_rk,2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.906538933386798937e-18_rk, 3.333333333333333148e-01_rk,4.906538933386800477e-18_rk,-5.665583147960497755e-18_rk,1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,-1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.542051911182396785e-18_rk, 3.333333333333332593e-01_rk,-6.542051911182396785e-18_rk,0.000000000000000000e+00_rk,-1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,-1.111111111111109523e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293804e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930846719e-01_rk,7.182335127930846719e-01_rk,4.146723119520974721e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704095411e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641722343e-02_rk,-5.156684612641722343e-02_rk,2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.906538933386798166e-18_rk, 3.333333333333333148e-01_rk,4.906538933386799707e-18_rk,-5.665583147960496214e-18_rk,1.924500897298752899e-01_rk,-1.924500897298752899e-01_rk,-1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.542051911182397555e-18_rk, 3.333333333333333148e-01_rk,-6.542051911182397555e-18_rk,-7.703719777548943412e-34_rk,-1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,-1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856293582e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930846719e-01_rk,7.182335127930846719e-01_rk,4.146723119520973055e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 8.796528112548956946e-01_rk, -1.110223024625156540e-16_rk,-8.796528112548941403e-01_rk,-8.881784197001252323e-16_rk,5.078677873714243507e-01_rk,-5.078677873714252389e-01_rk,1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, -2.220446049250313081e-16_rk,-2.357022603955159501e-01_rk,2.721655269759088447e-01_rk,1.360827634879544779e-01_rk,-1.360827634879544223e-01_rk,-1.571348402636766894e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955163109e-01_rk, 1.457167719820517959e-16_rk,-2.357022603955155060e-01_rk,-2.721655269759087892e-01_rk,1.360827634879542281e-01_rk,-1.360827634879546444e-01_rk,1.571348402636771058e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716873031e-02_rk, 1.942890293094023946e-16_rk,-6.315623032716856378e-02_rk,1.040834085586084257e-16_rk,3.646326658039279744e-02_rk,-3.646326658039286683e-02_rk,-8.326672684688674053e-17_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, 4.440892098500626162e-16_rk,-8.796528112548946954e-01_rk,-2.220446049250313081e-16_rk,-5.078677873714246838e-01_rk,5.078677873714250168e-01_rk,1.332267629550187849e-15_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955154505e-01_rk, 8.881784197001252323e-16_rk,-2.357022603955163664e-01_rk,2.721655269759089002e-01_rk,-1.360827634879544501e-01_rk,1.360827634879540060e-01_rk,1.571348402636756347e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955159223e-01_rk, -1.387778780781445676e-16_rk,-2.357022603955159223e-01_rk,-2.721655269759088447e-01_rk,-1.360827634879543946e-01_rk,1.360827634879543946e-01_rk,-1.571348402636767727e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716839724e-02_rk, -5.551115123125782702e-17_rk,-6.315623032716888297e-02_rk,-2.775557561562891351e-16_rk,-3.646326658039289459e-02_rk,3.646326658039275581e-02_rk,-5.551115123125782702e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -8.796528112548952505e-01_rk, -5.551115123125782702e-17_rk,-8.796528112548952505e-01_rk,1.015735574742850034e+00_rk,5.078677873714250168e-01_rk,5.078677873714250168e-01_rk,-5.864352075032629452e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, -5.551115123125782702e-17_rk,-2.357022603955158391e-01_rk,-3.283519850161896823e-17_rk,1.360827634879543668e-01_rk,1.360827634879544223e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, -5.551115123125782702e-17_rk,-2.357022603955158668e-01_rk,-2.775557561562891351e-17_rk,1.360827634879544223e-01_rk,1.360827634879543946e-01_rk,-1.583293556821987943e-17_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, 2.775557561562891351e-17_rk,-6.315623032716871643e-02_rk,-7.292653316078576142e-02_rk,3.646326658039288071e-02_rk,3.646326658039288071e-02_rk,4.210415355144576932e-02_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548951395e-01_rk, -2.220446049250313081e-16_rk,-8.796528112548951395e-01_rk,1.015735574742849812e+00_rk,-5.078677873714249058e-01_rk,-5.078677873714249058e-01_rk,5.864352075032628342e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158113e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955158113e-01_rk,8.798164921824391251e-18_rk,-1.360827634879544501e-01_rk,-1.360827634879542281e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955158668e-01_rk,2.775557561562891351e-17_rk,-1.360827634879542281e-01_rk,-1.360827634879544501e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, -5.551115123125782702e-17_rk,-6.315623032716871643e-02_rk,-7.292653316078576142e-02_rk,-3.646326658039295010e-02_rk,-3.646326658039295010e-02_rk,-4.210415355144575544e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293138e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930843388e-01_rk,7.182335127930843388e-01_rk,-4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.906538933386798166e-18_rk, -3.333333333333333148e-01_rk,-4.906538933386799707e-18_rk,5.665583147960496214e-18_rk,-1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.542051911182399096e-18_rk, -3.333333333333333148e-01_rk,6.542051911182398326e-18_rk,0.000000000000000000e+00_rk,1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704098187e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641724424e-02_rk,-5.156684612641724424e-02_rk,-2.977213249234697198e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293138e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,7.182335127930844498e-01_rk,7.182335127930844498e-01_rk,-4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.906538933386798166e-18_rk, -3.333333333333332593e-01_rk,-4.906538933386798937e-18_rk,5.665583147960496214e-18_rk,-1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,1.111111111111109523e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.542051911182399096e-18_rk, -3.333333333333333148e-01_rk,6.542051911182398326e-18_rk,0.000000000000000000e+00_rk,1.924500897298753177e-01_rk,-1.924500897298753177e-01_rk,1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704098187e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.156684612641723731e-02_rk,-5.156684612641723731e-02_rk,-2.977213249234696504e-02_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955158946e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955158946e-01_rk,0.000000000000000000e+00_rk,1.360827634879543946e-01_rk,-1.360827634879543946e-01_rk,3.885780586188047891e-16_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548949174e-01_rk, 1.110223024625156540e-16_rk,-8.796528112548948064e-01_rk,1.015735574742849590e+00_rk,5.078677873714247948e-01_rk,-5.078677873714247948e-01_rk,-5.864352075032630562e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, -1.110223024625156540e-16_rk,-6.315623032716853602e-02_rk,-7.292653316078565040e-02_rk,3.646326658039278357e-02_rk,-3.646326658039288071e-02_rk,4.210415355144565830e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955157836e-01_rk, -2.775557561562891351e-16_rk,-2.357022603955161444e-01_rk,-2.220446049250313081e-16_rk,1.360827634879545611e-01_rk,-1.360827634879543391e-01_rk,1.387778780781445676e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955160334e-01_rk, -4.440892098500626162e-16_rk,-2.357022603955157558e-01_rk,-1.387778780781445676e-16_rk,-1.360827634879544501e-01_rk,1.360827634879542281e-01_rk,-1.332267629550187849e-15_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, 0.000000000000000000e+00_rk,-8.796528112548948064e-01_rk,1.015735574742849590e+00_rk,-5.078677873714247948e-01_rk,5.078677873714250168e-01_rk,5.864352075032640554e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716892460e-02_rk, 1.110223024625156540e-16_rk,-6.315623032716832785e-02_rk,-7.292653316078565040e-02_rk,-3.646326658039267254e-02_rk,3.646326658039300561e-02_rk,-4.210415355144619953e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158946e-01_rk, -2.220446049250313081e-16_rk,-2.357022603955159779e-01_rk,-5.551115123125782702e-17_rk,-1.360827634879545611e-01_rk,1.360827634879544501e-01_rk,3.330669073875469621e-16_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955158668e-01_rk,2.721655269759087892e-01_rk,1.360827634879543946e-01_rk,1.360827634879544501e-01_rk,-1.571348402636770780e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548952505e-01_rk, 0.000000000000000000e+00_rk,-8.796528112548952505e-01_rk,-1.110223024625156540e-16_rk,5.078677873714250168e-01_rk,5.078677873714251279e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, 4.382343816109519224e-19_rk,-6.315623032716871643e-02_rk,0.000000000000000000e+00_rk,3.646326658039287377e-02_rk,3.646326658039287377e-02_rk,-1.460781272036504642e-19_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955160334e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955160334e-01_rk,-2.721655269759089557e-01_rk,1.360827634879545056e-01_rk,1.360827634879545056e-01_rk,1.571348402636771890e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955156725e-01_rk, 1.110223024625156540e-16_rk,-2.357022603955156725e-01_rk,2.721655269759085671e-01_rk,-1.360827634879543946e-01_rk,-1.360827634879543946e-01_rk,1.571348402636769948e-01_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548951395e-01_rk, 0.000000000000000000e+00_rk,-8.796528112548951395e-01_rk,0.000000000000000000e+00_rk,-5.078677873714249058e-01_rk,-5.078677873714249058e-01_rk,5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716853602e-02_rk, -1.752937526443803067e-18_rk,-6.315623032716853602e-02_rk,0.000000000000000000e+00_rk,-3.646326658039277663e-02_rk,-3.646326658039277663e-02_rk,5.843125088146003162e-19_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955158668e-01_rk,-2.721655269759087892e-01_rk,-1.360827634879544501e-01_rk,-1.360827634879544501e-01_rk,-1.571348402636771058e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333148e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,-1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.831145258871435375e-17_rk, -1.244016935856293360e+00_rk,-1.831145258871435991e-17_rk,2.114424416269461033e-17_rk,-7.182335127930845609e-01_rk,7.182335127930845609e-01_rk,4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.752937526443807304e-18_rk, -8.931639747704095411e-02_rk,1.752937526443807304e-18_rk,0.000000000000000000e+00_rk,5.156684612641722343e-02_rk,-5.156684612641722343e-02_rk,2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333337034e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298755120e-01_rk,-1.924500897298755120e-01_rk,-1.111111111111111327e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333330373e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298751789e-01_rk,1.924500897298751789e-01_rk,-1.111111111111108968e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.831145258871434759e-17_rk, -1.244016935856293138e+00_rk,-1.831145258871435375e-17_rk,2.114424416269460417e-17_rk,-7.182335127930844498e-01_rk,7.182335127930844498e-01_rk,4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.752937526443802682e-18_rk, -8.931639747704071819e-02_rk,1.752937526443802682e-18_rk,0.000000000000000000e+00_rk,5.156684612641708465e-02_rk,-5.156684612641708465e-02_rk,2.977213249234687831e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334259e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298753732e-01_rk,-1.924500897298753732e-01_rk,-1.111111111111110217e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.357022603955160334e-01_rk, 1.665334536937734811e-16_rk,-2.357022603955157836e-01_rk,-1.387778780781445676e-16_rk,1.360827634879542836e-01_rk,-1.360827634879545056e-01_rk,2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 1.110223024625156540e-16_rk,-6.315623032716853602e-02_rk,7.292653316078565040e-02_rk,3.646326658039276969e-02_rk,-3.646326658039288071e-02_rk,-4.210415355144565830e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548955836e-01_rk, -1.110223024625156540e-16_rk,-8.796528112548943623e-01_rk,-1.015735574742849590e+00_rk,5.078677873714243507e-01_rk,-5.078677873714252389e-01_rk,5.864352075032632783e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955159501e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955159779e-01_rk,-5.551115123125782702e-17_rk,1.360827634879545056e-01_rk,-1.360827634879543946e-01_rk,-3.330669073875469621e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158391e-01_rk, -2.220446049250313081e-16_rk,-2.357022603955159501e-01_rk,5.551115123125782702e-17_rk,-1.360827634879544501e-01_rk,1.360827634879543391e-01_rk,-4.440892098500626162e-16_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716853602e-02_rk, -1.110223024625156540e-16_rk,-6.315623032716870255e-02_rk,7.292653316078563652e-02_rk,-3.646326658039289459e-02_rk,3.646326658039278357e-02_rk,4.210415355144625504e-02_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548951395e-01_rk, 0.000000000000000000e+00_rk,-8.796528112548945844e-01_rk,-1.015735574742849590e+00_rk,-5.078677873714245727e-01_rk,5.078677873714250168e-01_rk,-5.864352075032639444e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955157003e-01_rk, 4.440892098500626162e-16_rk,-2.357022603955161721e-01_rk,-3.053113317719180486e-16_rk,-1.360827634879548942e-01_rk,1.360827634879540060e-01_rk,1.221245327087672194e-15_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.357022603955160334e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955160334e-01_rk,2.721655269759089557e-01_rk,1.360827634879545056e-01_rk,1.360827634879545056e-01_rk,-1.571348402636771890e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, 0.000000000000000000e+00_rk,-6.315623032716871643e-02_rk,0.000000000000000000e+00_rk,3.646326658039287377e-02_rk,3.646326658039287377e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548952505e-01_rk, 6.103817529571449966e-18_rk,-8.796528112548952505e-01_rk,1.110223024625156540e-16_rk,5.078677873714250168e-01_rk,5.078677873714251279e-01_rk,-2.034605843190481268e-18_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955158668e-01_rk,-2.721655269759087892e-01_rk,1.360827634879543946e-01_rk,1.360827634879544501e-01_rk,1.571348402636770780e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, 1.110223024625156540e-16_rk,-2.357022603955158391e-01_rk,2.721655269759087892e-01_rk,-1.360827634879543946e-01_rk,-1.360827634879543946e-01_rk,1.571348402636771058e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716853602e-02_rk, 0.000000000000000000e+00_rk,-6.315623032716853602e-02_rk,0.000000000000000000e+00_rk,-3.646326658039277663e-02_rk,-3.646326658039277663e-02_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548951395e-01_rk, -2.441527011828579370e-17_rk,-8.796528112548951395e-01_rk,0.000000000000000000e+00_rk,-5.078677873714249058e-01_rk,-5.078677873714249058e-01_rk,-4.737272785849590503e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955157003e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955157003e-01_rk,-2.721655269759085671e-01_rk,-1.360827634879543391e-01_rk,-1.360827634879543391e-01_rk,-1.571348402636769948e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333335924e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298754565e-01_rk,1.924500897298754565e-01_rk,-1.111111111111110772e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.314703144832855671e-18_rk, -8.931639747704095411e-02_rk,-1.314703144832856056e-18_rk,1.518088429147394170e-18_rk,-5.156684612641722343e-02_rk,5.156684612641722343e-02_rk,2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.441527011828580295e-17_rk, -1.244016935856293360e+00_rk,2.441527011828580295e-17_rk,0.000000000000000000e+00_rk,7.182335127930845609e-01_rk,-7.182335127930845609e-01_rk,4.146723119520972500e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333334814e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298754010e-01_rk,-1.924500897298754010e-01_rk,-1.111111111111110633e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333333148e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,-1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.314703144832852204e-18_rk, -8.931639747704071819e-02_rk,-1.314703144832852589e-18_rk,1.518088429147389933e-18_rk,-5.156684612641708465e-02_rk,5.156684612641708465e-02_rk,2.977213249234687831e-02_rk, &
                                        0.000000000000000000e+00_rk, 2.441527011828579370e-17_rk, -1.244016935856293138e+00_rk,2.441527011828579678e-17_rk,0.000000000000000000e+00_rk,7.182335127930844498e-01_rk,-7.182335127930844498e-01_rk,4.146723119520971945e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.333333333333331483e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.924500897298752622e-01_rk,-1.924500897298752622e-01_rk,-1.111111111111109384e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, -1.665334536937734811e-16_rk,-6.315623032716854990e-02_rk,-1.040834085586084257e-16_rk,3.646326658039277663e-02_rk,-3.646326658039288071e-02_rk,1.040834085586084257e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955157836e-01_rk, -1.734723475976807094e-16_rk,-2.357022603955159779e-01_rk,2.721655269759087892e-01_rk,1.360827634879544779e-01_rk,-1.360827634879543391e-01_rk,-1.571348402636771335e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 2.220446049250313081e-16_rk,-2.357022603955159501e-01_rk,-2.721655269759088447e-01_rk,1.360827634879544501e-01_rk,-1.360827634879543946e-01_rk,1.571348402636767172e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548952505e-01_rk, -5.551115123125782702e-17_rk,-8.796528112548951395e-01_rk,1.110223024625156540e-16_rk,5.078677873714247948e-01_rk,-5.078677873714251279e-01_rk,2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, 6.315623032716871643e-02_rk, 1.110223024625156540e-16_rk,-6.315623032716853602e-02_rk,-1.110223024625156540e-16_rk,-3.646326658039278357e-02_rk,3.646326658039289459e-02_rk,3.608224830031758756e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955158668e-01_rk, 5.551115123125782702e-17_rk,-2.357022603955159223e-01_rk,2.721655269759087892e-01_rk,-1.360827634879543946e-01_rk,1.360827634879543391e-01_rk,1.571348402636767172e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.357022603955159501e-01_rk, -4.440892098500626162e-16_rk,-2.357022603955158113e-01_rk,-2.721655269759087892e-01_rk,-1.360827634879542281e-01_rk,1.360827634879542281e-01_rk,-1.571348402636757458e-01_rk, &
                                        0.000000000000000000e+00_rk, 8.796528112548955836e-01_rk, -6.661338147750939243e-16_rk,-8.796528112548945844e-01_rk,5.551115123125782702e-16_rk,-5.078677873714247948e-01_rk,5.078677873714250168e-01_rk,-1.221245327087672194e-15_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, -2.775557561562891351e-17_rk,-6.315623032716871643e-02_rk,7.292653316078576142e-02_rk,3.646326658039288071e-02_rk,3.646326658039288071e-02_rk,-4.210415355144576238e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158668e-01_rk, 5.551115123125782702e-17_rk,-2.357022603955158668e-01_rk,3.283519850161896823e-17_rk,1.360827634879544223e-01_rk,1.360827634879543946e-01_rk,1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158391e-01_rk, 5.551115123125782702e-17_rk,-2.357022603955158391e-01_rk,2.775557561562891351e-17_rk,1.360827634879543668e-01_rk,1.360827634879544223e-01_rk,1.955147760405423445e-18_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548952505e-01_rk, 0.000000000000000000e+00_rk,-8.796528112548952505e-01_rk,-1.015735574742850034e+00_rk,5.078677873714250168e-01_rk,5.078677873714250168e-01_rk,5.864352075032629452e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.315623032716871643e-02_rk, 5.551115123125782702e-17_rk,-6.315623032716871643e-02_rk,7.292653316078574754e-02_rk,-3.646326658039295010e-02_rk,-3.646326658039295010e-02_rk,4.210415355144575544e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955158113e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955158113e-01_rk,-3.655374053745330322e-17_rk,-1.360827634879542281e-01_rk,-1.360827634879544501e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.357022603955157558e-01_rk, 0.000000000000000000e+00_rk,-2.357022603955157558e-01_rk,0.000000000000000000e+00_rk,-1.360827634879544501e-01_rk,-1.360827634879542281e-01_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -8.796528112548952505e-01_rk, 2.220446049250313081e-16_rk,-8.796528112548952505e-01_rk,-1.015735574742850034e+00_rk,-5.078677873714250168e-01_rk,-5.078677873714250168e-01_rk,-5.864352075032628342e-01_rk  &
                                        /),(/8,8/))
        
        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704094023e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641722343e-02_rk,5.156684612641722343e-02_rk,-2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.906538933386798937e-18_rk, -3.333333333333333148e-01_rk,-4.906538933386800477e-18_rk,5.665583147960497755e-18_rk,-1.924500897298753177e-01_rk,1.924500897298753177e-01_rk,1.111111111111109939e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.542051911182397555e-18_rk, -3.333333333333333148e-01_rk,6.542051911182397555e-18_rk,7.703719777548943412e-34_rk,1.924500897298752899e-01_rk,-1.924500897298752899e-01_rk,1.111111111111109800e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293804e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930846719e-01_rk,-7.182335127930846719e-01_rk,-4.146723119520974721e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.931639747704095411e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.156684612641722343e-02_rk,5.156684612641722343e-02_rk,-2.977213249234695464e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.906538933386798166e-18_rk, -3.333333333333332593e-01_rk,-4.906538933386798937e-18_rk,5.665583147960496214e-18_rk,-1.924500897298752899e-01_rk,1.924500897298752899e-01_rk,1.111111111111109523e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.542051911182395244e-18_rk, -3.333333333333332038e-01_rk,6.542051911182395244e-18_rk,0.000000000000000000e+00_rk,1.924500897298752344e-01_rk,-1.924500897298752344e-01_rk,1.111111111111109384e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293582e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-7.182335127930846719e-01_rk,-7.182335127930846719e-01_rk,-4.146723119520973055e-01_rk  &
                                        /),(/8,8/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%elem%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dgrad3_dx
    !*******************************************************************************************







    !> Test cartesian dinvmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dinvmass_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dinvmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dinvmass_dx
        ! 
        test_dinvmass_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.301042606982605321e-17_rk, -1.767766952966369209e-01_rk, 2.428612866367529932e-17_rk,1.767766952966369209e-01_rk,-6.591949208711866959e-17_rk,-1.767766952966369209e-01_rk,1.767766952966369209e-01_rk,7.632783294297951215e-17_rk, &
                                        -1.767766952966368654e-01_rk, -3.469446951953614189e-17_rk, 1.767766952966368654e-01_rk,-1.387778780781445676e-17_rk,5.303300858899108183e-01_rk,1.387778780781445676e-17_rk,-5.551115123125782702e-17_rk,-5.303300858899107073e-01_rk, &
                                        4.336808689942017736e-17_rk, 1.767766952966369209e-01_rk, 1.006139616066548115e-16_rk,-1.767766952966369487e-01_rk,5.551115123125782702e-17_rk,5.303300858899107073e-01_rk,-5.303300858899107073e-01_rk,-1.665334536937734811e-16_rk, &
                                        1.767766952966369765e-01_rk, -6.938893903907228378e-18_rk, -1.767766952966368099e-01_rk,4.857225732735059864e-17_rk,-5.303300858899107073e-01_rk,6.938893903907228378e-18_rk,-6.245004513516505540e-17_rk,5.303300858899108183e-01_rk, &
                                        -7.632783294297951215e-17_rk, 5.303300858899107073e-01_rk, -6.938893903907228378e-18_rk,-5.303300858899107073e-01_rk,-6.938893903907228378e-17_rk,5.303300858899108183e-01_rk,-5.303300858899105963e-01_rk,-6.245004513516505540e-16_rk, &
                                        -1.767766952966370042e-01_rk, -2.775557561562891351e-17_rk, 5.303300858899107073e-01_rk,-2.775557561562891351e-17_rk,5.303300858899105963e-01_rk,8.326672684688674053e-17_rk,6.938893903907228378e-17_rk,-1.590990257669732122e+00_rk, &
                                        1.767766952966369765e-01_rk, 2.081668171172168513e-17_rk, -5.303300858899104853e-01_rk,7.632783294297951215e-17_rk,-5.303300858899104853e-01_rk,-1.249000902703301108e-16_rk,-2.775557561562891351e-16_rk,1.590990257669731900e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.303300858899104853e-01_rk, -2.775557561562891351e-17_rk,5.303300858899107073e-01_rk,1.942890293094023946e-16_rk,-1.590990257669732122e+00_rk,1.590990257669732122e+00_rk,1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,1,2) = reshape((/                                                                                 &
                                        3.535533905932737309e-01_rk, -1.767766952966369209e-01_rk, -3.535533905932735088e-01_rk,-1.767766952966369487e-01_rk,2.359223927328457648e-16_rk,1.767766952966368377e-01_rk,1.767766952966369487e-01_rk,-9.714451465470119729e-17_rk, &
                                        -1.767766952966369209e-01_rk, 1.060660171779821193e+00_rk, 1.767766952966368932e-01_rk,1.110223024625156540e-16_rk,-5.303300858899104853e-01_rk,-1.804112415015879378e-16_rk,-1.060660171779820971e+00_rk,5.303300858899103742e-01_rk, &
                                        -3.535533905932737309e-01_rk, 1.767766952966369487e-01_rk, 1.060660171779820971e+00_rk,1.767766952966368654e-01_rk,-1.110223024625156540e-16_rk,-5.303300858899104853e-01_rk,-5.303300858899107073e-01_rk,2.220446049250313081e-16_rk, &
                                        -1.767766952966368654e-01_rk, 3.469446951953614189e-17_rk, 1.767766952966367267e-01_rk,1.060660171779821193e+00_rk,-5.303300858899109294e-01_rk,-1.060660171779820748e+00_rk,9.714451465470119729e-17_rk,5.303300858899107073e-01_rk, &
                                        8.326672684688674053e-17_rk, -5.303300858899104853e-01_rk, -1.526556658859590243e-16_rk,-5.303300858899109294e-01_rk,3.181980515339463356e+00_rk,5.303300858899107073e-01_rk,5.303300858899108183e-01_rk,-3.181980515339462912e+00_rk, &
                                        1.767766952966369209e-01_rk, -2.220446049250313081e-16_rk, -5.303300858899104853e-01_rk,-1.060660171779820971e+00_rk,5.303300858899108183e-01_rk,3.181980515339463800e+00_rk,7.077671781985372945e-16_rk,-1.590990257669731456e+00_rk, &
                                        1.767766952966370875e-01_rk, -1.060660171779820748e+00_rk, -5.303300858899109294e-01_rk,-9.714451465470119729e-17_rk,5.303300858899107073e-01_rk,2.775557561562891351e-16_rk,3.181980515339463356e+00_rk,-1.590990257669731012e+00_rk, &
                                        -8.326672684688674053e-17_rk, 5.303300858899107073e-01_rk, 7.771561172376095783e-16_rk,5.303300858899107073e-01_rk,-3.181980515339462023e+00_rk,-1.590990257669733010e+00_rk,-1.590990257669733010e+00_rk,9.545941546018386958e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,1,3) = reshape((/                                                                                 &
                                        2.500000000000000000e-01_rk, -2.500000000000000000e-01_rk, 1.171261199920871094e-16_rk,-2.500000000000000555e-01_rk,2.500000000000001665e-01_rk,-6.261382636065149489e-17_rk,-5.914437940869788070e-17_rk,7.382260381997215612e-17_rk, &
                                        -2.500000000000000000e-01_rk, 7.500000000000000000e-01_rk, -1.077166367360484670e-16_rk,2.500000000000000555e-01_rk,-7.499999999999998890e-01_rk,5.994481601215769936e-17_rk,2.403560575137456495e-16_rk,-1.843720321300008951e-16_rk, &
                                        -1.471286418215023902e-17_rk, -3.138880379306897951e-17_rk, 7.500000000000001110e-01_rk,-2.098046293720814003e-17_rk,5.994481601215768704e-17_rk,-7.500000000000000000e-01_rk,-7.499999999999998890e-01_rk,7.500000000000000000e-01_rk, &
                                        -2.499999999999999722e-01_rk, 2.500000000000000000e-01_rk, -8.689995502432679421e-17_rk,7.500000000000000000e-01_rk,-7.500000000000000000e-01_rk,1.293337550512299955e-16_rk,1.848449062824878225e-16_rk,-7.334972966748524108e-17_rk, &
                                        2.500000000000000000e-01_rk, -7.499999999999998890e-01_rk, 1.015781794356010696e-16_rk,-7.500000000000000000e-01_rk,2.250000000000000000e+00_rk,-7.334972966748524108e-17_rk,-1.011053052831141792e-16_rk,3.047345383068031966e-16_rk, &
                                        3.106124134209606972e-17_rk, -3.026080473863626955e-17_rk, -7.499999999999998890e-01_rk,3.912813430043601423e-17_rk,-1.783857843622741406e-17_rk,2.250000000000000444e+00_rk,7.500000000000003331e-01_rk,-2.249999999999999556e+00_rk, &
                                        3.800013524600330426e-17_rk, -2.505229123007356035e-18_rk, -7.500000000000000000e-01_rk,7.382260381997215612e-17_rk,-3.171636624404187082e-17_rk,7.500000000000001110e-01_rk,2.250000000000000444e+00_rk,-2.249999999999999556e+00_rk, &
                                        6.688370991606494007e-17_rk, -2.398831833612586975e-16_rk, 7.500000000000005551e-01_rk,9.916997179401548754e-18_rk,9.708683530818969729e-16_rk,-2.250000000000000000e+00_rk,-2.250000000000000444e+00_rk,6.749999999999999112e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -3.535533905932738419e-01_rk, 1.767766952966369209e-01_rk, 3.535533905932737864e-01_rk,-1.767766952966367822e-01_rk,-1.734723475976807094e-17_rk,1.767766952966368654e-01_rk,-1.767766952966368654e-01_rk,-1.595945597898662527e-16_rk, &
                                        1.767766952966368932e-01_rk, -1.060660171779821415e+00_rk, -1.767766952966368932e-01_rk,2.775557561562891351e-17_rk,-5.303300858899107073e-01_rk,-1.526556658859590243e-16_rk,1.060660171779820971e+00_rk,5.303300858899107073e-01_rk, &
                                        3.535533905932738419e-01_rk, -1.767766952966369487e-01_rk, -1.060660171779821193e+00_rk,1.767766952966368654e-01_rk,-8.326672684688674053e-17_rk,-5.303300858899107073e-01_rk,5.303300858899109294e-01_rk,8.326672684688674053e-17_rk, &
                                        -1.767766952966369765e-01_rk, 4.857225732735059864e-17_rk, 1.767766952966369209e-01_rk,-1.060660171779821193e+00_rk,5.303300858899109294e-01_rk,1.060660171779820971e+00_rk,-2.983724378680108202e-16_rk,-5.303300858899110404e-01_rk, &
                                        1.040834085586084257e-16_rk, -5.303300858899105963e-01_rk, 6.938893903907228378e-18_rk,5.303300858899109294e-01_rk,-3.181980515339463800e+00_rk,-5.303300858899110404e-01_rk,5.303300858899102632e-01_rk,3.181980515339464244e+00_rk, &
                                        1.767766952966369487e-01_rk, 5.551115123125782702e-17_rk, -5.303300858899105963e-01_rk,1.060660171779820971e+00_rk,-5.303300858899109294e-01_rk,-3.181980515339464244e+00_rk,-3.469446951953614189e-16_rk,1.590990257669732566e+00_rk, &
                                        -1.767766952966371430e-01_rk, 1.060660171779820971e+00_rk, 5.303300858899109294e-01_rk,-1.595945597898662527e-16_rk,5.303300858899102632e-01_rk,1.249000902703301108e-16_rk,-3.181980515339463800e+00_rk,-1.590990257669732344e+00_rk, &
                                        -8.326672684688674053e-17_rk, 5.303300858899100412e-01_rk, -2.775557561562891351e-17_rk,-5.303300858899109294e-01_rk,3.181980515339462023e+00_rk,1.590990257669732788e+00_rk,-1.590990257669730124e+00_rk,-9.545941546018390511e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.469446951953614189e-17_rk, 1.767766952966368099e-01_rk, -5.898059818321144121e-17_rk,1.767766952966368377e-01_rk,-1.110223024625156540e-16_rk,-1.767766952966368099e-01_rk,-1.767766952966367544e-01_rk,1.804112415015879378e-16_rk, &
                                        1.767766952966368099e-01_rk, -5.551115123125782702e-17_rk, -1.767766952966367822e-01_rk,-1.110223024625156540e-16_rk,5.303300858899104853e-01_rk,2.359223927328457648e-16_rk,1.249000902703301108e-16_rk,-5.303300858899104853e-01_rk, &
                                        -2.775557561562891351e-17_rk, -1.767766952966368099e-01_rk, -4.163336342344337027e-17_rk,-1.767766952966368377e-01_rk,2.220446049250313081e-16_rk,5.303300858899104853e-01_rk,5.303300858899102632e-01_rk,-2.220446049250313081e-16_rk, &
                                        1.767766952966368654e-01_rk, -9.020562075079396891e-17_rk, -1.767766952966368377e-01_rk,-2.081668171172168513e-17_rk,5.303300858899103742e-01_rk,1.804112415015879378e-16_rk,2.081668171172168513e-16_rk,-5.303300858899102632e-01_rk, &
                                        -9.714451465470119729e-17_rk, 5.303300858899104853e-01_rk, 1.804112415015879378e-16_rk,5.303300858899102632e-01_rk,-1.249000902703301108e-16_rk,-5.303300858899102632e-01_rk,-5.303300858899104853e-01_rk,1.665334536937734811e-16_rk, &
                                        -1.767766952966368654e-01_rk, 1.942890293094023946e-16_rk, 5.303300858899104853e-01_rk,8.326672684688674053e-17_rk,-5.303300858899103742e-01_rk,-2.498001805406602216e-16_rk,-4.024558464266192459e-16_rk,1.590990257669730568e+00_rk, &
                                        -1.767766952966368654e-01_rk, 8.326672684688674053e-17_rk, 5.303300858899102632e-01_rk,1.804112415015879378e-16_rk,-5.303300858899103742e-01_rk,-3.330669073875469621e-16_rk,-1.110223024625156540e-16_rk,1.590990257669731012e+00_rk, &
                                        2.220446049250313081e-16_rk, -5.303300858899101522e-01_rk, -5.551115123125782702e-16_rk,-5.303300858899100412e-01_rk,3.053113317719180486e-16_rk,1.590990257669731456e+00_rk,1.590990257669731234e+00_rk,-5.551115123125782702e-16_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,2,3) = reshape((/                                                                                 &
                                        2.500000000000000000e-01_rk, -2.500000000000000555e-01_rk, 3.939921114755544459e-17_rk,2.499999999999999167e-01_rk,-2.499999999999999445e-01_rk,4.002183017299062516e-19_rk,-1.694701645803816777e-17_rk,1.043198456348518893e-16_rk, &
                                        -2.500000000000000555e-01_rk, 7.500000000000000000e-01_rk, -6.551927378538876642e-17_rk,-2.500000000000000000e-01_rk,7.500000000000000000e-01_rk,-2.058024463547822145e-17_rk,2.105311878796513649e-17_rk,-1.688022457405373734e-16_rk, &
                                        -3.692862179542406140e-17_rk, -3.069228650223707937e-18_rk, 7.500000000000001110e-01_rk,1.427800610954436917e-17_rk,3.493090659577960557e-17_rk,7.499999999999998890e-01_rk,-7.500000000000000000e-01_rk,-7.500000000000000000e-01_rk, &
                                        2.500000000000000000e-01_rk, -2.500000000000000555e-01_rk, 3.856413477321965925e-17_rk,7.500000000000000000e-01_rk,-7.500000000000001110e-01_rk,2.430977237129964692e-16_rk,1.320754212504808152e-16_rk,5.324235918449393467e-17_rk, &
                                        -2.500000000000001110e-01_rk, 7.500000000000000000e-01_rk, -8.996918367455050523e-17_rk,-7.500000000000001110e-01_rk,2.250000000000000000e+00_rk,5.324235918449393467e-17_rk,1.920202372626385022e-16_rk,-2.699075510236515280e-16_rk, &
                                        4.550302867712689379e-17_rk, -4.139692634719990658e-17_rk, 7.499999999999997780e-01_rk,-1.662970166175300051e-16_rk,-5.777994327802171937e-17_rk,2.250000000000000444e+00_rk,-7.499999999999994449e-01_rk,-2.250000000000000000e+00_rk, &
                                        1.080855915759075652e-17_rk, 1.411422488405791427e-17_rk, -7.500000000000001110e-01_rk,1.043198456348518893e-16_rk,2.891647519173397242e-16_rk,-7.500000000000001110e-01_rk,2.249999999999999556e+00_rk,2.249999999999999556e+00_rk, &
                                        -1.107858653862722027e-16_rk, 4.973315690345565755e-16_rk, -7.499999999999998890e-01_rk,-1.410466701249084353e-16_rk,8.403154736015050617e-16_rk,-2.250000000000000888e+00_rk,2.249999999999998224e+00_rk,6.749999999999999112e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,1) = reshape((/                                                                                 &
                                        3.535533905932738419e-01_rk, 1.767766952966368099e-01_rk, -3.535533905932737864e-01_rk,-1.767766952966370042e-01_rk,1.630640067418198669e-16_rk,1.767766952966368932e-01_rk,-1.767766952966368377e-01_rk,6.938893903907228378e-18_rk, &
                                        1.767766952966368377e-01_rk, 1.060660171779821415e+00_rk, -1.767766952966368099e-01_rk,-1.387778780781445676e-17_rk,-5.303300858899107073e-01_rk,6.938893903907228378e-17_rk,-1.060660171779821193e+00_rk,5.303300858899104853e-01_rk, &
                                        -3.535533905932738419e-01_rk, -1.767766952966367544e-01_rk, 1.060660171779821193e+00_rk,1.767766952966369765e-01_rk,-5.551115123125782702e-17_rk,-5.303300858899104853e-01_rk,5.303300858899102632e-01_rk,2.220446049250313081e-16_rk, &
                                        -1.767766952966369209e-01_rk, -6.938893903907228378e-18_rk, 1.767766952966367267e-01_rk,1.060660171779821193e+00_rk,5.303300858899102632e-01_rk,-1.060660171779820971e+00_rk,3.677613769070831040e-16_rk,-5.303300858899104853e-01_rk, &
                                        2.081668171172168513e-17_rk, -5.303300858899105963e-01_rk, -4.857225732735059864e-17_rk,5.303300858899100412e-01_rk,3.181980515339463800e+00_rk,-5.303300858899104853e-01_rk,5.303300858899108183e-01_rk,-3.181980515339463800e+00_rk, &
                                        1.767766952966369765e-01_rk, -8.326672684688674053e-17_rk, -5.303300858899105963e-01_rk,-1.060660171779820971e+00_rk,-5.303300858899101522e-01_rk,3.181980515339463356e+00_rk,2.636779683484746784e-16_rk,1.590990257669730790e+00_rk, &
                                        -1.767766952966366989e-01_rk, -1.060660171779820971e+00_rk, 5.303300858899100412e-01_rk,6.938893903907228378e-18_rk,5.303300858899107073e-01_rk,1.249000902703301108e-16_rk,3.181980515339463800e+00_rk,-1.590990257669731456e+00_rk, &
                                        5.551115123125782702e-17_rk, 5.303300858899109294e-01_rk, 2.220446049250313081e-16_rk,-5.303300858899101522e-01_rk,-3.181980515339462467e+00_rk,1.590990257669730568e+00_rk,-1.590990257669733676e+00_rk,9.545941546018390511e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.040834085586084257e-17_rk, 1.767766952966368654e-01_rk, 7.979727989493312634e-17_rk,1.767766952966368377e-01_rk,-9.714451465470119729e-17_rk,-1.767766952966368099e-01_rk,-1.767766952966368377e-01_rk,4.163336342344337027e-17_rk, &
                                        1.767766952966369209e-01_rk, -6.938893903907228378e-17_rk, -1.767766952966368377e-01_rk,-4.163336342344337027e-17_rk,5.303300858899104853e-01_rk,1.249000902703301108e-16_rk,-9.714451465470119729e-17_rk,-5.303300858899104853e-01_rk, &
                                        5.551115123125782702e-17_rk, -1.767766952966368654e-01_rk, -5.551115123125782702e-17_rk,-1.767766952966368654e-01_rk,0.000000000000000000e+00_rk,5.303300858899104853e-01_rk,5.303300858899104853e-01_rk,-1.110223024625156540e-16_rk, &
                                        1.767766952966368654e-01_rk, 6.938893903907228378e-18_rk, -1.767766952966367822e-01_rk,-9.020562075079396891e-17_rk,5.303300858899105963e-01_rk,1.804112415015879378e-16_rk,6.938893903907228378e-17_rk,-5.303300858899104853e-01_rk, &
                                        -5.551115123125782702e-17_rk, 5.303300858899104853e-01_rk, -1.387778780781445676e-17_rk,5.303300858899104853e-01_rk,-1.526556658859590243e-16_rk,-5.303300858899104853e-01_rk,-5.303300858899104853e-01_rk,-2.775557561562891351e-16_rk, &
                                        -1.767766952966368932e-01_rk, 2.775557561562891351e-17_rk, 5.303300858899104853e-01_rk,8.326672684688674053e-17_rk,-5.303300858899104853e-01_rk,-3.053113317719180486e-16_rk,-2.636779683484746784e-16_rk,1.590990257669731012e+00_rk, &
                                        -1.767766952966368099e-01_rk, 8.326672684688674053e-17_rk, 5.303300858899107073e-01_rk,4.163336342344337027e-17_rk,-5.303300858899104853e-01_rk,-1.110223024625156540e-16_rk,-1.665334536937734811e-16_rk,1.590990257669731012e+00_rk, &
                                        1.387778780781445676e-16_rk, -5.303300858899101522e-01_rk, -4.440892098500626162e-16_rk,-5.303300858899102632e-01_rk,3.053113317719180486e-16_rk,1.590990257669731900e+00_rk,1.590990257669731234e+00_rk,-2.220446049250313081e-16_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,3,3) = reshape((/                                                                                 &
                                        2.499999999999999722e-01_rk, 2.499999999999999445e-01_rk, 9.491036237881327161e-17_rk,-2.500000000000000555e-01_rk,-2.499999999999998890e-01_rk,-6.898872073734236828e-17_rk,2.468634696540520557e-17_rk,-6.221360805892159172e-17_rk, &
                                        2.499999999999999722e-01_rk, 7.500000000000000000e-01_rk, 1.774745306149797411e-17_rk,-2.499999999999999722e-01_rk,-7.499999999999997780e-01_rk,6.268648221140851908e-17_rk,-3.445803244329269053e-17_rk,-2.268792046763892353e-18_rk, &
                                        -3.692862179542406756e-17_rk, 2.468634696540521174e-17_rk, 7.499999999999998890e-01_rk,-2.735535731389900110e-17_rk,-1.316025470979938632e-16_rk,-7.499999999999996669e-01_rk,7.499999999999995559e-01_rk,-7.499999999999996669e-01_rk, &
                                        -2.500000000000000000e-01_rk, -2.499999999999999445e-01_rk, -5.858037988148153804e-17_rk,7.500000000000000000e-01_rk,7.499999999999996669e-01_rk,1.043198456348518770e-16_rk,2.153421480973675557e-16_rk,1.642646616470095887e-16_rk, &
                                        -2.499999999999998890e-01_rk, -7.499999999999997780e-01_rk, -3.445803244329267821e-17_rk,7.499999999999996669e-01_rk,2.250000000000000000e+00_rk,1.642646616470095887e-16_rk,-1.965578213561662869e-16_rk,-4.786294609862021992e-17_rk, &
                                        1.774745306149798028e-17_rk, 1.411422488405792044e-17_rk, -7.499999999999997780e-01_rk,5.574758830750129070e-17_rk,2.197758128782674157e-16_rk,2.249999999999999556e+00_rk,-7.499999999999997780e-01_rk,2.249999999999999112e+00_rk, &
                                        3.856413477321967157e-17_rk, -1.364135073157099924e-17_rk, 7.499999999999996669e-01_rk,-6.221360805892159172e-17_rk,-9.941330670146508964e-17_rk,-7.499999999999996669e-01_rk,2.250000000000000444e+00_rk,-2.249999999999999556e+00_rk, &
                                        -5.527471415501437567e-17_rk, -2.798245482030530028e-16_rk, -7.499999999999995559e-01_rk,4.695759934189276620e-16_rk,8.403154736015048645e-16_rk,2.249999999999999556e+00_rk,-2.250000000000000888e+00_rk,6.749999999999999112e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,1) = reshape((/                                                                                 &
                                        9.540979117872439019e-18_rk, -1.767766952966368654e-01_rk, -3.122502256758252770e-17_rk,1.767766952966368654e-01_rk,-7.979727989493312634e-17_rk,-1.767766952966368654e-01_rk,1.767766952966367822e-01_rk,7.632783294297951215e-17_rk, &
                                        -1.767766952966368654e-01_rk, 1.318389841742373392e-16_rk, 1.767766952966368377e-01_rk,0.000000000000000000e+00_rk,5.303300858899105963e-01_rk,6.938893903907228378e-17_rk,5.551115123125782702e-17_rk,-5.303300858899104853e-01_rk, &
                                        -6.765421556309547668e-17_rk, 1.767766952966368099e-01_rk, 8.673617379884035472e-17_rk,-1.767766952966369209e-01_rk,8.326672684688674053e-17_rk,5.303300858899104853e-01_rk,-5.303300858899104853e-01_rk,-1.387778780781445676e-16_rk, &
                                        1.767766952966369209e-01_rk, -3.469446951953614189e-17_rk, -1.767766952966368099e-01_rk,2.081668171172168513e-17_rk,-5.303300858899104853e-01_rk,-1.040834085586084257e-16_rk,-6.938893903907228378e-18_rk,5.303300858899107073e-01_rk, &
                                        -4.857225732735059864e-17_rk, 5.303300858899104853e-01_rk, 4.857225732735059864e-17_rk,-5.303300858899102632e-01_rk,1.249000902703301108e-16_rk,5.303300858899107073e-01_rk,-5.303300858899104853e-01_rk,4.163336342344337027e-17_rk, &
                                        -1.767766952966369209e-01_rk, 5.551115123125782702e-17_rk, 5.303300858899104853e-01_rk,-1.387778780781445676e-16_rk,5.303300858899104853e-01_rk,3.330669073875469621e-16_rk,1.387778780781445676e-17_rk,-1.590990257669731234e+00_rk, &
                                        1.767766952966368654e-01_rk, -9.020562075079396891e-17_rk, -5.303300858899104853e-01_rk,7.632783294297951215e-17_rk,-5.303300858899104853e-01_rk,-1.249000902703301108e-16_rk,2.775557561562891351e-17_rk,1.590990257669731900e+00_rk, &
                                        2.775557561562891351e-17_rk, -5.303300858899103742e-01_rk, -1.665334536937734811e-16_rk,5.303300858899104853e-01_rk,-2.775557561562891351e-17_rk,-1.590990257669731234e+00_rk,1.590990257669731678e+00_rk,-1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -3.535533905932737309e-01_rk, -1.767766952966367544e-01_rk, 3.535533905932735643e-01_rk,-1.767766952966367267e-01_rk,-2.775557561562891351e-17_rk,1.767766952966368099e-01_rk,1.767766952966366434e-01_rk,-1.249000902703301108e-16_rk, &
                                        -1.767766952966368099e-01_rk, -1.060660171779821193e+00_rk, 1.767766952966367267e-01_rk,4.163336342344337027e-17_rk,-5.303300858899104853e-01_rk,-1.804112415015879378e-16_rk,1.060660171779820748e+00_rk,5.303300858899104853e-01_rk, &
                                        3.535533905932737309e-01_rk, 1.767766952966367267e-01_rk, -1.060660171779820971e+00_rk,1.767766952966368099e-01_rk,-1.110223024625156540e-16_rk,-5.303300858899104853e-01_rk,-5.303300858899100412e-01_rk,1.110223024625156540e-16_rk, &
                                        -1.767766952966368654e-01_rk, 4.857225732735059864e-17_rk, 1.767766952966368932e-01_rk,-1.060660171779821193e+00_rk,-5.303300858899100412e-01_rk,1.060660171779820526e+00_rk,-3.747002708109903324e-16_rk,5.303300858899100412e-01_rk, &
                                        6.938893903907228378e-17_rk, -5.303300858899104853e-01_rk, -1.387778780781445676e-17_rk,-5.303300858899100412e-01_rk,-3.181980515339463356e+00_rk,5.303300858899100412e-01_rk,5.303300858899102632e-01_rk,3.181980515339462912e+00_rk, &
                                        1.767766952966368654e-01_rk, 0.000000000000000000e+00_rk, -5.303300858899104853e-01_rk,1.060660171779820971e+00_rk,5.303300858899100412e-01_rk,-3.181980515339462912e+00_rk,-4.163336342344337027e-17_rk,-1.590990257669730124e+00_rk, &
                                        1.767766952966365324e-01_rk, 1.060660171779820971e+00_rk, -5.303300858899100412e-01_rk,-1.249000902703301108e-16_rk,5.303300858899101522e-01_rk,1.665334536937734811e-16_rk,-3.181980515339463356e+00_rk,-1.590990257669731012e+00_rk, &
                                        -2.775557561562891351e-16_rk, 5.303300858899095971e-01_rk, 2.220446049250313081e-16_rk,5.303300858899095971e-01_rk,3.181980515339461135e+00_rk,-1.590990257669730346e+00_rk,-1.590990257669729457e+00_rk,-9.545941546018386958e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,4,3) = reshape((/                                                                                 &
                                        2.499999999999999722e-01_rk, 2.499999999999999445e-01_rk, 5.387563825346223534e-17_rk,2.499999999999999445e-01_rk,2.500000000000000000e-01_rk,2.018002633374831520e-17_rk,-4.106102329926979500e-18_rk,-4.906538933386796626e-18_rk, &
                                        2.499999999999999445e-01_rk, 7.500000000000000000e-01_rk, -6.655614746509203644e-17_rk,2.499999999999999445e-01_rk,7.499999999999998890e-01_rk,1.199935513369433234e-16_rk,1.061157635291288667e-16_rk,-8.864613993276045528e-17_rk, &
                                        -2.245219468951727990e-17_rk, 9.771685477887472633e-18_rk, 7.499999999999998890e-01_rk,3.405781414156277504e-17_rk,3.672682449005657056e-17_rk,7.500000000000000000e-01_rk,7.499999999999995559e-01_rk,7.499999999999997780e-01_rk, &
                                        2.500000000000000000e-01_rk, 2.499999999999999445e-01_rk, -5.961725356118480806e-17_rk,7.500000000000000000e-01_rk,7.499999999999996669e-01_rk,3.004047928385312119e-16_rk,2.448936416072733849e-16_rk,2.999319186860443585e-16_rk, &
                                        2.499999999999998612e-01_rk, 7.499999999999998890e-01_rk, -8.817326578027354024e-17_rk,7.499999999999996669e-01_rk,2.250000000000000000e+00_rk,2.999319186860443585e-16_rk,1.056428893766419393e-16_rk,-2.090086461095627567e-16_rk, &
                                        1.671057938179470409e-17_rk, -5.347879626073739835e-17_rk, 7.500000000000001110e-01_rk,-3.960100845292294160e-17_rk,2.999319186860443585e-16_rk,2.249999999999999556e+00_rk,7.499999999999997780e-01_rk,2.249999999999999112e+00_rk, &
                                        2.364947328570193247e-17_rk, 2.032354970520440996e-18_rk, 7.499999999999996669e-01_rk,-4.906538933386796626e-18_rk,2.860541308782298032e-16_rk,7.499999999999998890e-01_rk,2.249999999999999556e+00_rk,2.249999999999999556e+00_rk, &
                                        9.917686962522163828e-17_rk, 2.444207674547864329e-16_rk, 7.499999999999994449e-01_rk,3.276874943016731734e-16_rk,9.012143785155936358e-16_rk,2.249999999999999112e+00_rk,2.249999999999998668e+00_rk,6.749999999999999112e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.127570259384924611e-17_rk, -1.767766952966369209e-01_rk, -2.428612866367529932e-17_rk,1.767766952966369765e-01_rk,-5.898059818321144121e-17_rk,1.767766952966369765e-01_rk,-1.767766952966369209e-01_rk,6.938893903907228378e-18_rk, &
                                        -1.767766952966369209e-01_rk, -7.632783294297951215e-17_rk, -1.767766952966369487e-01_rk,-4.163336342344337027e-17_rk,5.303300858899108183e-01_rk,-1.249000902703301108e-16_rk,5.551115123125782702e-17_rk,5.303300858899107073e-01_rk, &
                                        -4.336808689942017736e-17_rk, -1.767766952966369209e-01_rk, 5.204170427930421283e-17_rk,1.767766952966369209e-01_rk,0.000000000000000000e+00_rk,5.303300858899107073e-01_rk,-5.303300858899104853e-01_rk,-5.551115123125782702e-17_rk, &
                                        1.767766952966369209e-01_rk, -4.857225732735059864e-17_rk, 1.767766952966369765e-01_rk,3.469446951953614189e-17_rk,-5.303300858899107073e-01_rk,-6.938893903907228378e-18_rk,-7.632783294297951215e-17_rk,-5.303300858899105963e-01_rk, &
                                        -4.857225732735059864e-17_rk, 5.303300858899107073e-01_rk, -7.632783294297951215e-17_rk,-5.303300858899107073e-01_rk,-2.359223927328457648e-16_rk,-5.303300858899105963e-01_rk,5.303300858899107073e-01_rk,-2.636779683484746784e-16_rk, &
                                        1.767766952966368932e-01_rk, -2.775557561562891351e-17_rk, 5.303300858899107073e-01_rk,-1.942890293094023946e-16_rk,-5.303300858899105963e-01_rk,-5.551115123125782702e-17_rk,1.249000902703301108e-16_rk,-1.590990257669731234e+00_rk, &
                                        -1.767766952966368654e-01_rk, -2.081668171172168513e-17_rk, -5.303300858899107073e-01_rk,6.938893903907228378e-18_rk,5.303300858899108183e-01_rk,-1.249000902703301108e-16_rk,-4.163336342344337027e-16_rk,1.590990257669732344e+00_rk, &
                                        -2.775557561562891351e-17_rk, 5.303300858899111514e-01_rk, -5.551115123125782702e-17_rk,-5.303300858899107073e-01_rk,-1.942890293094023946e-16_rk,-1.590990257669732566e+00_rk,1.590990257669732122e+00_rk,-1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,2) = reshape((/                                                                                 &
                                        3.535533905932737309e-01_rk, -1.767766952966369765e-01_rk, 3.535533905932738419e-01_rk,-1.767766952966370042e-01_rk,2.359223927328457648e-16_rk,-1.767766952966369765e-01_rk,-1.767766952966370042e-01_rk,2.081668171172168513e-16_rk, &
                                        -1.767766952966369765e-01_rk, 1.060660171779821193e+00_rk, -1.767766952966371430e-01_rk,8.326672684688674053e-17_rk,-5.303300858899107073e-01_rk,2.081668171172168513e-16_rk,1.060660171779821415e+00_rk,-5.303300858899107073e-01_rk, &
                                        3.535533905932737309e-01_rk, -1.767766952966370320e-01_rk, 1.060660171779820971e+00_rk,-1.767766952966369209e-01_rk,5.551115123125782702e-17_rk,-5.303300858899104853e-01_rk,-5.303300858899109294e-01_rk,3.885780586188047891e-16_rk, &
                                        -1.767766952966368654e-01_rk, 2.081668171172168513e-17_rk, -1.767766952966369487e-01_rk,1.060660171779821193e+00_rk,-5.303300858899111514e-01_rk,1.060660171779821193e+00_rk,4.302114220422481594e-16_rk,-5.303300858899109294e-01_rk, &
                                        2.775557561562891351e-17_rk, -5.303300858899104853e-01_rk, 1.249000902703301108e-16_rk,-5.303300858899109294e-01_rk,3.181980515339463356e+00_rk,-5.303300858899109294e-01_rk,-5.303300858899108183e-01_rk,3.181980515339462912e+00_rk, &
                                        -1.767766952966368654e-01_rk, 1.665334536937734811e-16_rk, -5.303300858899104853e-01_rk,1.060660171779820971e+00_rk,-5.303300858899110404e-01_rk,3.181980515339463800e+00_rk,5.689893001203927270e-16_rk,-1.590990257669731900e+00_rk, &
                                        -1.767766952966370875e-01_rk, 1.060660171779821193e+00_rk, -5.303300858899111514e-01_rk,2.081668171172168513e-16_rk,-5.303300858899104853e-01_rk,2.775557561562891351e-16_rk,3.181980515339463356e+00_rk,-1.590990257669731012e+00_rk, &
                                        2.775557561562891351e-17_rk, -5.303300858899108183e-01_rk, 6.661338147750939243e-16_rk,-5.303300858899109294e-01_rk,3.181980515339464688e+00_rk,-1.590990257669733010e+00_rk,-1.590990257669733454e+00_rk,9.545941546018386958e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -2.500000000000000000e-01_rk, 2.500000000000000555e-01_rk, -1.171261199920871094e-16_rk,2.500000000000000555e-01_rk,-2.500000000000001665e-01_rk,6.261382636065149489e-17_rk,5.914437940869790535e-17_rk,-7.382260381997215612e-17_rk, &
                                        2.500000000000000555e-01_rk, -7.500000000000000000e-01_rk, 1.077166367360484793e-16_rk,-2.500000000000000555e-01_rk,7.500000000000000000e-01_rk,-5.994481601215769936e-17_rk,-2.403560575137456495e-16_rk,1.843720321300008951e-16_rk, &
                                        1.471286418215023902e-17_rk, 3.138880379306897951e-17_rk, -7.500000000000001110e-01_rk,2.098046293720813387e-17_rk,-5.994481601215771169e-17_rk,7.500000000000001110e-01_rk,7.500000000000001110e-01_rk,-7.500000000000001110e-01_rk, &
                                        2.500000000000000000e-01_rk, -2.500000000000000555e-01_rk, 8.689995502432679421e-17_rk,-7.500000000000000000e-01_rk,7.500000000000002220e-01_rk,-1.293337550512299955e-16_rk,-1.848449062824878225e-16_rk,7.334972966748524108e-17_rk, &
                                        -2.500000000000000000e-01_rk, 7.500000000000000000e-01_rk, -1.015781794356010696e-16_rk,7.500000000000002220e-01_rk,-2.250000000000000000e+00_rk,7.334972966748524108e-17_rk,1.011053052831141299e-16_rk,-3.047345383068031966e-16_rk, &
                                        -3.106124134209607589e-17_rk, 3.026080473863626955e-17_rk, 7.500000000000000000e-01_rk,-3.912813430043601423e-17_rk,1.783857843622741406e-17_rk,-2.250000000000000444e+00_rk,-7.500000000000004441e-01_rk,2.250000000000000000e+00_rk, &
                                        -3.800013524600331659e-17_rk, 2.505229123007349872e-18_rk, 7.500000000000002220e-01_rk,-7.382260381997215612e-17_rk,3.171636624404187082e-17_rk,-7.500000000000002220e-01_rk,-2.250000000000000444e+00_rk,2.249999999999999556e+00_rk, &
                                        -6.688370991606494007e-17_rk, 2.398831833612586975e-16_rk, -7.500000000000005551e-01_rk,-9.916997179401548754e-18_rk,-9.708683530818969729e-16_rk,2.250000000000000888e+00_rk,2.250000000000000888e+00_rk,-6.749999999999999112e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -3.535533905932738419e-01_rk, 1.767766952966369765e-01_rk, -3.535533905932738419e-01_rk,-1.767766952966368377e-01_rk,-7.979727989493312634e-17_rk,-1.767766952966368654e-01_rk,1.767766952966369765e-01_rk,-1.457167719820517959e-16_rk, &
                                        1.767766952966369487e-01_rk, -1.060660171779821415e+00_rk, 1.767766952966370875e-01_rk,-2.775557561562891351e-17_rk,-5.303300858899107073e-01_rk,-6.938893903907228378e-17_rk,-1.060660171779821415e+00_rk,-5.303300858899104853e-01_rk, &
                                        -3.535533905932737309e-01_rk, 1.767766952966369209e-01_rk, -1.060660171779821193e+00_rk,-1.767766952966369209e-01_rk,-8.326672684688674053e-17_rk,-5.303300858899107073e-01_rk,5.303300858899107073e-01_rk,-1.942890293094023946e-16_rk, &
                                        -1.767766952966369209e-01_rk, 6.245004513516505540e-17_rk, -1.767766952966369209e-01_rk,-1.060660171779821193e+00_rk,5.303300858899109294e-01_rk,-1.060660171779821415e+00_rk,-2.844946500601963635e-16_rk,5.303300858899105963e-01_rk, &
                                        1.318389841742373392e-16_rk, -5.303300858899105963e-01_rk, 2.081668171172168513e-17_rk,5.303300858899107073e-01_rk,-3.181980515339463800e+00_rk,5.303300858899105963e-01_rk,-5.303300858899103742e-01_rk,-3.181980515339463356e+00_rk, &
                                        -1.767766952966369487e-01_rk, 0.000000000000000000e+00_rk, -5.303300858899105963e-01_rk,-1.060660171779820971e+00_rk,5.303300858899104853e-01_rk,-3.181980515339464244e+00_rk,-4.024558464266192459e-16_rk,1.590990257669731678e+00_rk, &
                                        1.767766952966369209e-01_rk, -1.060660171779821193e+00_rk, 5.303300858899109294e-01_rk,-1.457167719820517959e-16_rk,-5.303300858899109294e-01_rk,-9.714451465470119729e-17_rk,-3.181980515339463800e+00_rk,-1.590990257669731900e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.303300858899107073e-01_rk, -1.110223024625156540e-16_rk,5.303300858899109294e-01_rk,-3.181980515339464688e+00_rk,1.590990257669733232e+00_rk,-1.590990257669730124e+00_rk,-9.545941546018390511e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 1.767766952966368654e-01_rk, 3.469446951953614189e-18_rk,1.767766952966368932e-01_rk,-8.326672684688674053e-17_rk,1.767766952966369209e-01_rk,1.767766952966369209e-01_rk,-1.249000902703301108e-16_rk, &
                                        1.767766952966368654e-01_rk, -1.110223024625156540e-16_rk, 1.767766952966369209e-01_rk,-2.775557561562891351e-17_rk,5.303300858899107073e-01_rk,1.387778780781445676e-17_rk,-1.249000902703301108e-16_rk,5.303300858899104853e-01_rk, &
                                        -2.775557561562891351e-17_rk, 1.767766952966368932e-01_rk, -6.938893903907228378e-17_rk,1.767766952966368932e-01_rk,0.000000000000000000e+00_rk,5.303300858899104853e-01_rk,5.303300858899104853e-01_rk,-1.665334536937734811e-16_rk, &
                                        1.767766952966368654e-01_rk, -2.081668171172168513e-17_rk, 1.767766952966368932e-01_rk,-6.245004513516505540e-17_rk,5.303300858899105963e-01_rk,4.163336342344337027e-17_rk,-1.387778780781445676e-17_rk,5.303300858899105963e-01_rk, &
                                        -6.938893903907228378e-17_rk, 5.303300858899104853e-01_rk, -9.714451465470119729e-17_rk,5.303300858899104853e-01_rk,1.387778780781445676e-17_rk,5.303300858899105963e-01_rk,5.303300858899104853e-01_rk,-1.665334536937734811e-16_rk, &
                                        1.767766952966368654e-01_rk, 2.775557561562891351e-17_rk, 5.303300858899104853e-01_rk,-8.326672684688674053e-17_rk,5.303300858899107073e-01_rk,-1.942890293094023946e-16_rk,-2.081668171172168513e-16_rk,1.590990257669731012e+00_rk, &
                                        1.767766952966368099e-01_rk, -8.326672684688674053e-17_rk, 5.303300858899104853e-01_rk,-1.249000902703301108e-16_rk,5.303300858899105963e-01_rk,-1.110223024625156540e-16_rk,-1.665334536937734811e-16_rk,1.590990257669731012e+00_rk, &
                                        -5.551115123125782702e-17_rk, 5.303300858899105963e-01_rk, -4.440892098500626162e-16_rk,5.303300858899104853e-01_rk,-3.053113317719180486e-16_rk,1.590990257669731456e+00_rk,1.590990257669731678e+00_rk,1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -2.500000000000000000e-01_rk, 2.500000000000000000e-01_rk, -3.939921114755544459e-17_rk,-2.499999999999999445e-01_rk,2.499999999999999445e-01_rk,-4.002183017299062516e-19_rk,1.694701645803816161e-17_rk,-1.043198456348518893e-16_rk, &
                                        2.500000000000000000e-01_rk, -7.500000000000000000e-01_rk, 6.551927378538876642e-17_rk,2.500000000000000000e-01_rk,-7.500000000000001110e-01_rk,2.058024463547822145e-17_rk,-2.105311878796513649e-17_rk,1.688022457405373734e-16_rk, &
                                        3.692862179542406140e-17_rk, 3.069228650223704856e-18_rk, -7.500000000000001110e-01_rk,-1.427800610954436301e-17_rk,-3.493090659577960557e-17_rk,-7.500000000000000000e-01_rk,7.499999999999998890e-01_rk,7.500000000000000000e-01_rk, &
                                        -2.500000000000000000e-01_rk, 2.500000000000001110e-01_rk, -3.856413477321965925e-17_rk,-7.500000000000000000e-01_rk,7.500000000000001110e-01_rk,-2.430977237129964692e-16_rk,-1.320754212504808152e-16_rk,-5.324235918449393467e-17_rk, &
                                        2.500000000000001110e-01_rk, -7.500000000000001110e-01_rk, 8.996918367455050523e-17_rk,7.500000000000001110e-01_rk,-2.250000000000000000e+00_rk,-5.324235918449393467e-17_rk,-1.920202372626385022e-16_rk,2.699075510236515280e-16_rk, &
                                        -4.550302867712689379e-17_rk, 4.139692634719990658e-17_rk, -7.499999999999998890e-01_rk,1.662970166175300051e-16_rk,5.777994327802171937e-17_rk,-2.250000000000000444e+00_rk,7.499999999999995559e-01_rk,2.250000000000000000e+00_rk, &
                                        -1.080855915759074728e-17_rk, -1.411422488405792044e-17_rk, 7.500000000000001110e-01_rk,-1.043198456348518893e-16_rk,-2.891647519173397242e-16_rk,7.500000000000002220e-01_rk,-2.249999999999999556e+00_rk,-2.249999999999999556e+00_rk, &
                                        1.107858653862722027e-16_rk, -4.973315690345565755e-16_rk, 7.500000000000000000e-01_rk,1.410466701249084353e-16_rk,-8.403154736015050617e-16_rk,2.250000000000000444e+00_rk,-2.249999999999998668e+00_rk,-6.749999999999999112e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,1) = reshape((/                                                                                 &
                                        3.535533905932738419e-01_rk, 1.767766952966368654e-01_rk, 3.535533905932738419e-01_rk,-1.767766952966370597e-01_rk,1.838806884535415520e-16_rk,-1.767766952966370320e-01_rk,1.767766952966368099e-01_rk,7.632783294297951215e-17_rk, &
                                        1.767766952966367822e-01_rk, 1.060660171779821415e+00_rk, 1.767766952966366711e-01_rk,6.938893903907228378e-17_rk,-5.303300858899107073e-01_rk,3.191891195797325054e-16_rk,1.060660171779821193e+00_rk,-5.303300858899107073e-01_rk, &
                                        3.535533905932737309e-01_rk, 1.767766952966368099e-01_rk, 1.060660171779821193e+00_rk,-1.767766952966369209e-01_rk,5.551115123125782702e-17_rk,-5.303300858899104853e-01_rk,5.303300858899100412e-01_rk,3.330669073875469621e-16_rk, &
                                        -1.767766952966368654e-01_rk, 6.938893903907228378e-18_rk, -1.767766952966370042e-01_rk,1.060660171779821193e+00_rk,5.303300858899102632e-01_rk,1.060660171779821415e+00_rk,4.371503159461553878e-16_rk,5.303300858899103742e-01_rk, &
                                        -6.938893903907228378e-18_rk, -5.303300858899105963e-01_rk, 1.318389841742373392e-16_rk,5.303300858899102632e-01_rk,3.181980515339463800e+00_rk,5.303300858899103742e-01_rk,-5.303300858899109294e-01_rk,3.181980515339463800e+00_rk, &
                                        -1.767766952966368099e-01_rk, 1.387778780781445676e-16_rk, -5.303300858899105963e-01_rk,1.060660171779821193e+00_rk,5.303300858899103742e-01_rk,3.181980515339463356e+00_rk,2.081668171172168513e-16_rk,1.590990257669730790e+00_rk, &
                                        1.767766952966367822e-01_rk, 1.060660171779820971e+00_rk, 5.303300858899100412e-01_rk,7.632783294297951215e-17_rk,-5.303300858899104853e-01_rk,3.469446951953614189e-16_rk,3.181980515339463800e+00_rk,-1.590990257669731900e+00_rk, &
                                        2.775557561562891351e-17_rk, -5.303300858899111514e-01_rk, 3.053113317719180486e-16_rk,5.303300858899102632e-01_rk,3.181980515339464688e+00_rk,1.590990257669731012e+00_rk,-1.590990257669733676e+00_rk,9.545941546018390511e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -3.816391647148975608e-17_rk, 1.767766952966369209e-01_rk, -7.979727989493312634e-17_rk,1.767766952966368932e-01_rk,-1.526556658859590243e-16_rk,1.767766952966369209e-01_rk,1.767766952966369487e-01_rk,-2.081668171172168513e-16_rk, &
                                        1.767766952966368654e-01_rk, -9.714451465470119729e-17_rk, 1.767766952966369209e-01_rk,-9.714451465470119729e-17_rk,5.303300858899107073e-01_rk,-1.526556658859590243e-16_rk,-3.469446951953614189e-16_rk,5.303300858899104853e-01_rk, &
                                        5.551115123125782702e-17_rk, 1.767766952966368932e-01_rk, -5.551115123125782702e-17_rk,1.767766952966368654e-01_rk,-1.110223024625156540e-16_rk,5.303300858899104853e-01_rk,5.303300858899107073e-01_rk,-2.775557561562891351e-16_rk, &
                                        1.767766952966368654e-01_rk, -6.938893903907228378e-18_rk, 1.767766952966369487e-01_rk,6.938893903907228378e-18_rk,5.303300858899108183e-01_rk,4.163336342344337027e-17_rk,-1.526556658859590243e-16_rk,5.303300858899107073e-01_rk, &
                                        -1.665334536937734811e-16_rk, 5.303300858899104853e-01_rk, -1.804112415015879378e-16_rk,5.303300858899107073e-01_rk,4.163336342344337027e-17_rk,5.303300858899107073e-01_rk,5.303300858899104853e-01_rk,-6.106226635438360972e-16_rk, &
                                        1.767766952966368377e-01_rk, -1.387778780781445676e-16_rk, 5.303300858899104853e-01_rk,-8.326672684688674053e-17_rk,5.303300858899109294e-01_rk,-1.387778780781445676e-16_rk,-4.579669976578770729e-16_rk,1.590990257669731456e+00_rk, &
                                        1.767766952966369765e-01_rk, -8.326672684688674053e-17_rk, 5.303300858899104853e-01_rk,-2.081668171172168513e-16_rk,5.303300858899104853e-01_rk,-2.220446049250313081e-16_rk,-1.110223024625156540e-16_rk,1.590990257669731012e+00_rk, &
                                        -1.942890293094023946e-16_rk, 5.303300858899105963e-01_rk, -6.661338147750939243e-16_rk,5.303300858899105963e-01_rk,-3.053113317719180486e-16_rk,1.590990257669731900e+00_rk,1.590990257669731678e+00_rk,-2.220446049250313081e-16_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -2.499999999999999722e-01_rk, -2.499999999999999722e-01_rk, -9.491036237881327161e-17_rk,2.500000000000000555e-01_rk,2.499999999999998890e-01_rk,6.898872073734236828e-17_rk,-2.468634696540521174e-17_rk,6.221360805892159172e-17_rk, &
                                        -2.500000000000000000e-01_rk, -7.500000000000000000e-01_rk, -1.774745306149797411e-17_rk,2.500000000000000000e-01_rk,7.499999999999996669e-01_rk,-6.268648221140851908e-17_rk,3.445803244329269053e-17_rk,2.268792046763892353e-18_rk, &
                                        3.692862179542406756e-17_rk, -2.468634696540520865e-17_rk, -7.499999999999998890e-01_rk,2.735535731389900726e-17_rk,1.316025470979938632e-16_rk,7.499999999999995559e-01_rk,-7.499999999999995559e-01_rk,7.499999999999996669e-01_rk, &
                                        2.499999999999999722e-01_rk, 2.499999999999999722e-01_rk, 5.858037988148153804e-17_rk,-7.500000000000000000e-01_rk,-7.499999999999996669e-01_rk,-1.043198456348518770e-16_rk,-2.153421480973675557e-16_rk,-1.642646616470095887e-16_rk, &
                                        2.499999999999999167e-01_rk, 7.499999999999996669e-01_rk, 3.445803244329267821e-17_rk,-7.499999999999996669e-01_rk,-2.250000000000000000e+00_rk,-1.642646616470095887e-16_rk,1.965578213561662869e-16_rk,4.786294609862021992e-17_rk, &
                                        -1.774745306149797411e-17_rk, -1.411422488405792044e-17_rk, 7.499999999999996669e-01_rk,-5.574758830750129070e-17_rk,-2.197758128782674157e-16_rk,-2.249999999999999556e+00_rk,7.499999999999998890e-01_rk,-2.249999999999999556e+00_rk, &
                                        -3.856413477321965925e-17_rk, 1.364135073157099307e-17_rk, -7.499999999999996669e-01_rk,6.221360805892159172e-17_rk,9.941330670146508964e-17_rk,7.499999999999997780e-01_rk,-2.250000000000000444e+00_rk,2.249999999999999556e+00_rk, &
                                        5.527471415501437567e-17_rk, 2.798245482030530028e-16_rk, 7.499999999999996669e-01_rk,-4.695759934189276620e-16_rk,-8.403154736015048645e-16_rk,-2.249999999999999556e+00_rk,2.250000000000000444e+00_rk,-6.749999999999999112e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,1) = reshape((/                                                                                 &
                                        1.474514954580286030e-17_rk, -1.767766952966368654e-01_rk, 3.122502256758252770e-17_rk,1.767766952966369209e-01_rk,-4.510281037539698445e-17_rk,1.767766952966369487e-01_rk,-1.767766952966368654e-01_rk,6.245004513516505540e-17_rk, &
                                        -1.767766952966368099e-01_rk, 2.012279232133096230e-16_rk, -1.767766952966368099e-01_rk,0.000000000000000000e+00_rk,5.303300858899105963e-01_rk,-1.249000902703301108e-16_rk,1.665334536937734811e-16_rk,5.303300858899104853e-01_rk, &
                                        6.765421556309547668e-17_rk, -1.767766952966368377e-01_rk, 6.591949208711866959e-17_rk,1.767766952966368932e-01_rk,2.775557561562891351e-17_rk,5.303300858899104853e-01_rk,-5.303300858899102632e-01_rk,-8.326672684688674053e-17_rk, &
                                        1.767766952966368654e-01_rk, -2.081668171172168513e-17_rk, 1.767766952966369209e-01_rk,6.245004513516505540e-17_rk,-5.303300858899104853e-01_rk,3.261280134836397337e-16_rk,-7.632783294297951215e-17_rk,-5.303300858899103742e-01_rk, &
                                        -7.632783294297951215e-17_rk, 5.303300858899104853e-01_rk, -7.632783294297951215e-17_rk,-5.303300858899102632e-01_rk,4.579669976578770729e-16_rk,-5.303300858899103742e-01_rk,5.303300858899105963e-01_rk,4.024558464266192459e-16_rk, &
                                        1.767766952966368654e-01_rk, -1.110223024625156540e-16_rk, 5.303300858899104853e-01_rk,1.387778780781445676e-16_rk,-5.303300858899102632e-01_rk,5.828670879282071837e-16_rk,6.938893903907228378e-17_rk,-1.590990257669731234e+00_rk, &
                                        -1.767766952966368377e-01_rk, 3.122502256758252770e-16_rk, -5.303300858899102632e-01_rk,6.245004513516505540e-17_rk,5.303300858899105963e-01_rk,-1.249000902703301108e-16_rk,1.665334536937734811e-16_rk,1.590990257669731456e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.303300858899108183e-01_rk, -1.387778780781445676e-16_rk,-5.303300858899104853e-01_rk,4.718447854656915297e-16_rk,-1.590990257669731678e+00_rk,1.590990257669731678e+00_rk,1.110223024625156540e-16_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -3.535533905932737309e-01_rk, -1.767766952966368099e-01_rk, -3.535533905932737864e-01_rk,-1.767766952966367822e-01_rk,0.000000000000000000e+00_rk,-1.767766952966368377e-01_rk,-1.767766952966368654e-01_rk,1.249000902703301108e-16_rk, &
                                        -1.767766952966367544e-01_rk, -1.060660171779821193e+00_rk, -1.767766952966366989e-01_rk,4.163336342344337027e-17_rk,-5.303300858899107073e-01_rk,-6.938893903907228378e-17_rk,-1.060660171779820748e+00_rk,-5.303300858899103742e-01_rk, &
                                        -3.535533905932737309e-01_rk, -1.767766952966367544e-01_rk, -1.060660171779820971e+00_rk,-1.767766952966368099e-01_rk,5.551115123125782702e-17_rk,-5.303300858899104853e-01_rk,-5.303300858899102632e-01_rk,5.551115123125782702e-17_rk, &
                                        -1.767766952966368654e-01_rk, 6.938893903907228378e-18_rk, -1.767766952966368932e-01_rk,-1.060660171779821193e+00_rk,-5.303300858899102632e-01_rk,-1.060660171779821415e+00_rk,-2.636779683484746784e-16_rk,-5.303300858899103742e-01_rk, &
                                        2.081668171172168513e-16_rk, -5.303300858899104853e-01_rk, 1.526556658859590243e-16_rk,-5.303300858899100412e-01_rk,-3.181980515339463356e+00_rk,-5.303300858899103742e-01_rk,-5.303300858899100412e-01_rk,-3.181980515339462912e+00_rk, &
                                        -1.767766952966368654e-01_rk, -5.551115123125782702e-17_rk, -5.303300858899104853e-01_rk,-1.060660171779820971e+00_rk,-5.303300858899105963e-01_rk,-3.181980515339462912e+00_rk,9.714451465470119729e-17_rk,-1.590990257669730568e+00_rk, &
                                        -1.767766952966367544e-01_rk, -1.060660171779820971e+00_rk, -5.303300858899098191e-01_rk,1.249000902703301108e-16_rk,-5.303300858899107073e-01_rk,5.551115123125782702e-17_rk,-3.181980515339463356e+00_rk,-1.590990257669731012e+00_rk, &
                                        2.220446049250313081e-16_rk, -5.303300858899103742e-01_rk, 4.440892098500626162e-16_rk,-5.303300858899101522e-01_rk,-3.181980515339463800e+00_rk,-1.590990257669730346e+00_rk,-1.590990257669729901e+00_rk,-9.545941546018386958e+00_rk  &
                                        /),(/8,8/))
        
        test_dinvmass_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.499999999999999722e-01_rk, -2.499999999999999722e-01_rk, -5.387563825346223534e-17_rk,-2.499999999999999167e-01_rk,-2.500000000000000000e-01_rk,-2.018002633374831520e-17_rk,4.106102329926985663e-18_rk,4.906538933386802789e-18_rk, &
                                        -2.499999999999999722e-01_rk, -7.500000000000000000e-01_rk, 6.655614746509201179e-17_rk,-2.499999999999999445e-01_rk,-7.499999999999997780e-01_rk,-1.199935513369433234e-16_rk,-1.061157635291288667e-16_rk,8.864613993276045528e-17_rk, &
                                        2.245219468951727990e-17_rk, -9.771685477887475714e-18_rk, -7.499999999999998890e-01_rk,-3.405781414156278120e-17_rk,-3.672682449005657056e-17_rk,-7.499999999999998890e-01_rk,-7.499999999999996669e-01_rk,-7.499999999999998890e-01_rk, &
                                        -2.500000000000000000e-01_rk, -2.499999999999999445e-01_rk, 5.961725356118480806e-17_rk,-7.500000000000000000e-01_rk,-7.499999999999996669e-01_rk,-3.004047928385312119e-16_rk,-2.448936416072733849e-16_rk,-2.999319186860443585e-16_rk, &
                                        -2.499999999999998890e-01_rk, -7.499999999999997780e-01_rk, 8.817326578027354024e-17_rk,-7.499999999999996669e-01_rk,-2.250000000000000000e+00_rk,-2.999319186860443585e-16_rk,-1.056428893766419393e-16_rk,2.090086461095627567e-16_rk, &
                                        -1.671057938179470409e-17_rk, 5.347879626073739835e-17_rk, -7.500000000000000000e-01_rk,3.960100845292294160e-17_rk,-2.999319186860443585e-16_rk,-2.249999999999999556e+00_rk,-7.499999999999998890e-01_rk,-2.249999999999999112e+00_rk, &
                                        -2.364947328570193863e-17_rk, -2.032354970520422508e-18_rk, -7.499999999999996669e-01_rk,4.906538933386802789e-18_rk,-2.860541308782298032e-16_rk,-7.500000000000000000e-01_rk,-2.249999999999999556e+00_rk,-2.249999999999999556e+00_rk, &
                                        -9.917686962522163828e-17_rk, -2.444207674547864329e-16_rk, -7.499999999999994449e-01_rk,-3.276874943016731734e-16_rk,-9.012143785155936358e-16_rk,-2.249999999999999556e+00_rk,-2.249999999999998224e+00_rk,-6.749999999999999112e+00_rk  &
                                        /),(/8,8/))
        
        
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dinvmass_dx(:,:,inode_diff,idir)),self%elem%dinvmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dinvmass_dx
    !*******************************************************************************************








    !> Test cartesian dmass_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dmass_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%nterms_s,self%elem%nterms_c,3) :: test_dmass_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dmass_dx
        ! 
        test_dmass_dx(:,:,1,1) = reshape((/                                                                                 &
                                        4.336808689942017736e-17_rk, 5.892556509887898059e-02_rk, -3.469446951953614189e-18_rk,-5.892556509887897365e-02_rk,2.168404344971008868e-18_rk,1.964185503295965904e-02_rk,-1.964185503295965904e-02_rk,1.084202172485504434e-18_rk, &
                                        5.892556509887898059e-02_rk, 1.257674520083185143e-17_rk, -1.964185503295965904e-02_rk,2.168404344971008868e-18_rk,-1.964185503295965904e-02_rk,1.084202172485504434e-18_rk,-2.168404344971008868e-19_rk,6.547285010986552724e-03_rk, &
                                        -3.469446951953614189e-18_rk, -1.964185503295965904e-02_rk, 1.257674520083185143e-17_rk,1.964185503295965904e-02_rk,1.084202172485504434e-18_rk,-1.964185503295965904e-02_rk,1.964185503295966251e-02_rk,-6.505213034913026604e-19_rk, &
                                        -5.892556509887897365e-02_rk, 2.168404344971008868e-18_rk, 1.964185503295965904e-02_rk,1.257674520083185143e-17_rk,1.964185503295966251e-02_rk,-2.168404344971008868e-19_rk,1.084202172485504434e-18_rk,-6.547285010986553591e-03_rk, &
                                        2.168404344971008868e-18_rk, -1.964185503295965904e-02_rk, 1.084202172485504434e-18_rk,1.964185503295966251e-02_rk,4.336808689942017736e-18_rk,-6.547285010986553591e-03_rk,6.547285010986552724e-03_rk,0.000000000000000000e+00_rk, &
                                        1.964185503295965904e-02_rk, 1.084202172485504434e-18_rk, -1.964185503295965904e-02_rk,-2.168404344971008868e-19_rk,-6.547285010986553591e-03_rk,4.336808689942017736e-18_rk,-2.168404344971008868e-18_rk,6.547285010986553591e-03_rk, &
                                        -1.964185503295965904e-02_rk, -2.168404344971008868e-19_rk, 1.964185503295966251e-02_rk,1.084202172485504434e-18_rk,6.547285010986552724e-03_rk,-2.168404344971008868e-18_rk,4.336808689942017736e-18_rk,-6.547285010986553591e-03_rk, &
                                        1.084202172485504434e-18_rk, 6.547285010986552724e-03_rk, -6.505213034913026604e-19_rk,-6.547285010986553591e-03_rk,0.000000000000000000e+00_rk,6.547285010986553591e-03_rk,-6.547285010986553591e-03_rk,1.517883041479706208e-18_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -3.535533905932737309e-01_rk, 5.892556509887891814e-02_rk, 1.178511301977578640e-01_rk,5.892556509887893201e-02_rk,-8.673617379884035472e-19_rk,-1.964185503295965557e-02_rk,-1.964185503295964863e-02_rk,8.673617379884035472e-19_rk, &
                                        5.892556509887891814e-02_rk, -1.178511301977579195e-01_rk, -1.964185503295964863e-02_rk,-8.673617379884035472e-19_rk,1.964185503295965210e-02_rk,8.673617379884035472e-19_rk,3.928371006591929726e-02_rk,-6.547285010986551856e-03_rk, &
                                        1.178511301977578640e-01_rk, -1.964185503295964863e-02_rk, -1.178511301977579195e-01_rk,-1.964185503295965557e-02_rk,8.673617379884035472e-19_rk,1.964185503295965210e-02_rk,1.964185503295963822e-02_rk,-8.673617379884035472e-19_rk, &
                                        5.892556509887893201e-02_rk, -8.673617379884035472e-19_rk, -1.964185503295965557e-02_rk,-1.178511301977579195e-01_rk,1.964185503295963822e-02_rk,3.928371006591929726e-02_rk,8.673617379884035472e-19_rk,-6.547285010986550122e-03_rk, &
                                        -8.673617379884035472e-19_rk, 1.964185503295965210e-02_rk, 8.673617379884035472e-19_rk,1.964185503295963822e-02_rk,-3.928371006591930420e-02_rk,-6.547285010986550989e-03_rk,-6.547285010986553591e-03_rk,1.309457002197310024e-02_rk, &
                                        -1.964185503295965557e-02_rk, 8.673617379884035472e-19_rk, 1.964185503295965210e-02_rk,3.928371006591929726e-02_rk,-6.547285010986550989e-03_rk,-3.928371006591930420e-02_rk,0.000000000000000000e+00_rk,6.547285010986550122e-03_rk, &
                                        -1.964185503295964863e-02_rk, 3.928371006591929726e-02_rk, 1.964185503295963822e-02_rk,8.673617379884035472e-19_rk,-6.547285010986553591e-03_rk,0.000000000000000000e+00_rk,-3.928371006591930420e-02_rk,6.547285010986550122e-03_rk, &
                                        8.673617379884035472e-19_rk, -6.547285010986551856e-03_rk, -8.673617379884035472e-19_rk,-6.547285010986550122e-03_rk,1.309457002197310024e-02_rk,6.547285010986550122e-03_rk,6.547285010986550122e-03_rk,-1.309457002197310024e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -2.499999999999999722e-01_rk, 8.333333333333331483e-02_rk, 4.904288060716746340e-18_rk,8.333333333333334259e-02_rk,-2.777777777777777277e-02_rk,-1.427404982704399984e-18_rk,-3.595809327675409622e-18_rk,4.525968480200261117e-18_rk, &
                                        8.333333333333331483e-02_rk, -8.333333333333334259e-02_rk, -3.595809327675409622e-18_rk,-2.777777777777777277e-02_rk,2.777777777777776583e-02_rk,4.525968480200261117e-18_rk,3.224925873217654256e-18_rk,-1.776844267884072239e-18_rk, &
                                        4.904288060716746340e-18_rk, -3.595809327675409622e-18_rk, -8.333333333333334259e-02_rk,-1.427404982704399984e-18_rk,4.525968480200261117e-18_rk,2.777777777777776583e-02_rk,2.777777777777775889e-02_rk,-9.259259259259251806e-03_rk, &
                                        8.333333333333334259e-02_rk, -2.777777777777777277e-02_rk, -1.427404982704399984e-18_rk,-8.333333333333334259e-02_rk,2.777777777777775889e-02_rk,3.224925873217654256e-18_rk,4.525968480200261117e-18_rk,-1.776844267884072239e-18_rk, &
                                        -2.777777777777777277e-02_rk, 2.777777777777776583e-02_rk, 4.525968480200261117e-18_rk,2.777777777777775889e-02_rk,-2.777777777777777971e-02_rk,-2.861046440369576288e-18_rk,-2.644206005872475786e-18_rk,2.159177463558056109e-18_rk, &
                                        -1.427404982704399984e-18_rk, 4.525968480200261117e-18_rk, 2.777777777777776583e-02_rk,3.224925873217654256e-18_rk,-2.861046440369576288e-18_rk,-2.777777777777777971e-02_rk,-9.259259259259255276e-03_rk,9.259259259259255276e-03_rk, &
                                        -3.595809327675409622e-18_rk, 3.224925873217654256e-18_rk, 2.777777777777775889e-02_rk,4.525968480200261117e-18_rk,-2.644206005872475786e-18_rk,-9.259259259259255276e-03_rk,-2.777777777777777971e-02_rk,9.259259259259258745e-03_rk, &
                                        4.525968480200261117e-18_rk, -1.776844267884072239e-18_rk, -9.259259259259251806e-03_rk,-1.776844267884072239e-18_rk,2.159177463558056109e-18_rk,9.259259259259255276e-03_rk,9.259259259259258745e-03_rk,-9.259259259259258745e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,1) = reshape((/                                                                                 &
                                        3.535533905932738419e-01_rk, -5.892556509887894589e-02_rk, -1.178511301977579334e-01_rk,5.892556509887896671e-02_rk,-3.903127820947815962e-18_rk,-1.964185503295965904e-02_rk,1.964185503295965210e-02_rk,6.505213034913026604e-19_rk, &
                                        -5.892556509887894589e-02_rk, 1.178511301977579334e-01_rk, 1.964185503295965210e-02_rk,-3.903127820947815962e-18_rk,1.964185503295965904e-02_rk,6.505213034913026604e-19_rk,-3.928371006591931114e-02_rk,-6.547285010986550989e-03_rk, &
                                        -1.178511301977579334e-01_rk, 1.964185503295965210e-02_rk, 1.178511301977579334e-01_rk,-1.964185503295965904e-02_rk,6.505213034913026604e-19_rk,1.964185503295965904e-02_rk,-1.964185503295964863e-02_rk,-1.084202172485504434e-18_rk, &
                                        5.892556509887896671e-02_rk, -3.903127820947815962e-18_rk, -1.964185503295965904e-02_rk,1.178511301977579334e-01_rk,-1.964185503295964863e-02_rk,-3.928371006591931114e-02_rk,6.505213034913026604e-19_rk,6.547285010986551856e-03_rk, &
                                        -3.903127820947815962e-18_rk, 1.964185503295965904e-02_rk, 6.505213034913026604e-19_rk,-1.964185503295964863e-02_rk,3.928371006591931114e-02_rk,6.547285010986550122e-03_rk,-6.547285010986550989e-03_rk,-1.309457002197310371e-02_rk, &
                                        -1.964185503295965904e-02_rk, 6.505213034913026604e-19_rk, 1.964185503295965904e-02_rk,-3.928371006591931114e-02_rk,6.547285010986550122e-03_rk,3.928371006591931114e-02_rk,4.336808689942017736e-19_rk,-6.547285010986550122e-03_rk, &
                                        1.964185503295965210e-02_rk, -3.928371006591931114e-02_rk, -1.964185503295964863e-02_rk,6.505213034913026604e-19_rk,-6.547285010986550989e-03_rk,4.336808689942017736e-19_rk,3.928371006591931114e-02_rk,6.547285010986553591e-03_rk, &
                                        6.505213034913026604e-19_rk, -6.547285010986550989e-03_rk, -1.084202172485504434e-18_rk,6.547285010986551856e-03_rk,-1.309457002197310371e-02_rk,-6.547285010986550122e-03_rk,6.547285010986553591e-03_rk,1.309457002197310198e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.469446951953614189e-18_rk, -5.892556509887891120e-02_rk, -3.469446951953614189e-18_rk,-5.892556509887893201e-02_rk,2.602085213965210642e-18_rk,1.964185503295965557e-02_rk,1.964185503295964516e-02_rk,-2.602085213965210642e-18_rk, &
                                        -5.892556509887891120e-02_rk, -1.214306433183764966e-17_rk, 1.964185503295964516e-02_rk,2.602085213965210642e-18_rk,-1.964185503295965210e-02_rk,-2.602085213965210642e-18_rk,2.602085213965210642e-18_rk,6.547285010986551856e-03_rk, &
                                        -3.469446951953614189e-18_rk, 1.964185503295964516e-02_rk, -1.214306433183764966e-17_rk,1.964185503295965557e-02_rk,-2.602085213965210642e-18_rk,-1.964185503295965210e-02_rk,-1.964185503295964516e-02_rk,1.301042606982605321e-18_rk, &
                                        -5.892556509887893201e-02_rk, 2.602085213965210642e-18_rk, 1.964185503295965557e-02_rk,-1.214306433183764966e-17_rk,-1.964185503295964516e-02_rk,2.602085213965210642e-18_rk,-2.602085213965210642e-18_rk,6.547285010986550122e-03_rk, &
                                        2.602085213965210642e-18_rk, -1.964185503295965210e-02_rk, -2.602085213965210642e-18_rk,-1.964185503295964516e-02_rk,-1.517883041479706208e-18_rk,6.547285010986549254e-03_rk,6.547285010986551856e-03_rk,2.059984127722458425e-18_rk, &
                                        1.964185503295965557e-02_rk, -2.602085213965210642e-18_rk, -1.964185503295965210e-02_rk,2.602085213965210642e-18_rk,6.547285010986549254e-03_rk,-1.517883041479706208e-18_rk,1.734723475976807094e-18_rk,-6.547285010986548387e-03_rk, &
                                        1.964185503295964516e-02_rk, 2.602085213965210642e-18_rk, -1.964185503295964516e-02_rk,-2.602085213965210642e-18_rk,6.547285010986551856e-03_rk,1.734723475976807094e-18_rk,-1.517883041479706208e-18_rk,-6.547285010986550122e-03_rk, &
                                        -2.602085213965210642e-18_rk, 6.547285010986551856e-03_rk, 1.301042606982605321e-18_rk,6.547285010986550122e-03_rk,2.059984127722458425e-18_rk,-6.547285010986548387e-03_rk,-6.547285010986550122e-03_rk,-8.673617379884035472e-19_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -2.499999999999999722e-01_rk, 8.333333333333334259e-02_rk, 7.447174252959743900e-19_rk,-8.333333333333334259e-02_rk,2.777777777777777971e-02_rk,-3.032048019930046332e-18_rk,-2.598367150935844558e-18_rk,2.482391417653248609e-19_rk, &
                                        8.333333333333334259e-02_rk, -8.333333333333334259e-02_rk, -2.598367150935844558e-18_rk,2.777777777777777971e-02_rk,-2.777777777777776930e-02_rk,2.482391417653248609e-19_rk,1.549281748747930374e-18_rk,-5.770018043158136382e-19_rk, &
                                        7.447174252959743900e-19_rk, -2.598367150935844558e-18_rk, -8.333333333333334259e-02_rk,-3.032048019930046332e-18_rk,2.482391417653248609e-19_rk,-2.777777777777776930e-02_rk,2.777777777777776583e-02_rk,9.259259259259255276e-03_rk, &
                                        -8.333333333333334259e-02_rk, 2.777777777777777971e-02_rk, -3.032048019930046332e-18_rk,-8.333333333333334259e-02_rk,2.777777777777776583e-02_rk,1.549281748747930374e-18_rk,2.482391417653248609e-19_rk,-1.444363542304217089e-18_rk, &
                                        2.777777777777777971e-02_rk, -2.777777777777776930e-02_rk, 2.482391417653248609e-19_rk,2.777777777777776583e-02_rk,-2.777777777777777971e-02_rk,-2.094884845795519750e-18_rk,2.903599336725898127e-19_rk,2.034310291062349473e-18_rk, &
                                        -3.032048019930046332e-18_rk, 2.482391417653248609e-19_rk, -2.777777777777776930e-02_rk,1.549281748747930374e-18_rk,-2.094884845795519750e-18_rk,-2.777777777777777971e-02_rk,9.259259259259258745e-03_rk,9.259259259259257011e-03_rk, &
                                        -2.598367150935844558e-18_rk, 1.549281748747930374e-18_rk, 2.777777777777776583e-02_rk,2.482391417653248609e-19_rk,2.903599336725898127e-19_rk,9.259259259259258745e-03_rk,-2.777777777777777971e-02_rk,-9.259259259259258745e-03_rk, &
                                        2.482391417653248609e-19_rk, -5.770018043158136382e-19_rk, 9.259259259259255276e-03_rk,-1.444363542304217089e-18_rk,2.034310291062349473e-18_rk,9.259259259259257011e-03_rk,-9.259259259259258745e-03_rk,-9.259259259259258745e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -3.535533905932738419e-01_rk, -5.892556509887897365e-02_rk, 1.178511301977579334e-01_rk,5.892556509887896671e-02_rk,3.035766082959412415e-18_rk,-1.964185503295965557e-02_rk,1.964185503295965557e-02_rk,-1.951563910473907981e-18_rk, &
                                        -5.892556509887897365e-02_rk, -1.178511301977579334e-01_rk, 1.964185503295965557e-02_rk,3.035766082959412415e-18_rk,1.964185503295965210e-02_rk,-1.951563910473907981e-18_rk,3.928371006591931114e-02_rk,-6.547285010986552724e-03_rk, &
                                        1.178511301977579334e-01_rk, 1.964185503295965557e-02_rk, -1.178511301977579334e-01_rk,-1.964185503295965557e-02_rk,-1.951563910473907981e-18_rk,1.964185503295965210e-02_rk,-1.964185503295966251e-02_rk,2.385244779468109755e-18_rk, &
                                        5.892556509887896671e-02_rk, 3.035766082959412415e-18_rk, -1.964185503295965557e-02_rk,-1.178511301977579334e-01_rk,-1.964185503295966251e-02_rk,3.928371006591931114e-02_rk,-1.951563910473907981e-18_rk,6.547285010986551856e-03_rk, &
                                        3.035766082959412415e-18_rk, 1.964185503295965210e-02_rk, -1.951563910473907981e-18_rk,-1.964185503295966251e-02_rk,-3.928371006591931114e-02_rk,6.547285010986553591e-03_rk,-6.547285010986551856e-03_rk,1.309457002197310371e-02_rk, &
                                        -1.964185503295965557e-02_rk, -1.951563910473907981e-18_rk, 1.964185503295965210e-02_rk,3.928371006591931114e-02_rk,6.547285010986553591e-03_rk,-3.928371006591931114e-02_rk,3.469446951953614189e-18_rk,-6.547285010986553591e-03_rk, &
                                        1.964185503295965557e-02_rk, 3.928371006591931114e-02_rk, -1.964185503295966251e-02_rk,-1.951563910473907981e-18_rk,-6.547285010986551856e-03_rk,3.469446951953614189e-18_rk,-3.928371006591931114e-02_rk,6.547285010986551856e-03_rk, &
                                        -1.951563910473907981e-18_rk, -6.547285010986552724e-03_rk, 2.385244779468109755e-18_rk,6.547285010986551856e-03_rk,1.309457002197310371e-02_rk,-6.547285010986553591e-03_rk,6.547285010986551856e-03_rk,-1.309457002197310198e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.892556509887893895e-02_rk, -3.469446951953614189e-18_rk,-5.892556509887893201e-02_rk,8.673617379884035472e-19_rk,1.964185503295965210e-02_rk,1.964185503295964863e-02_rk,2.602085213965210642e-18_rk, &
                                        -5.892556509887893895e-02_rk, 8.673617379884035472e-18_rk, 1.964185503295964863e-02_rk,8.673617379884035472e-19_rk,-1.964185503295965210e-02_rk,2.602085213965210642e-18_rk,-8.673617379884035472e-19_rk,6.547285010986550122e-03_rk, &
                                        -3.469446951953614189e-18_rk, 1.964185503295964863e-02_rk, 8.673617379884035472e-18_rk,1.964185503295965210e-02_rk,2.602085213965210642e-18_rk,-1.964185503295965210e-02_rk,-1.964185503295965210e-02_rk,8.673617379884035472e-19_rk, &
                                        -5.892556509887893201e-02_rk, 8.673617379884035472e-19_rk, 1.964185503295965210e-02_rk,8.673617379884035472e-18_rk,-1.964185503295965210e-02_rk,-8.673617379884035472e-19_rk,2.602085213965210642e-18_rk,6.547285010986550122e-03_rk, &
                                        8.673617379884035472e-19_rk, -1.964185503295965210e-02_rk, 2.602085213965210642e-18_rk,-1.964185503295965210e-02_rk,6.505213034913026604e-19_rk,6.547285010986550989e-03_rk,6.547285010986551856e-03_rk,-1.409462824231155764e-18_rk, &
                                        1.964185503295965210e-02_rk, 2.602085213965210642e-18_rk, -1.964185503295965210e-02_rk,-8.673617379884035472e-19_rk,6.547285010986550989e-03_rk,6.505213034913026604e-19_rk,0.000000000000000000e+00_rk,-6.547285010986551856e-03_rk, &
                                        1.964185503295964863e-02_rk, -8.673617379884035472e-19_rk, -1.964185503295965210e-02_rk,2.602085213965210642e-18_rk,6.547285010986551856e-03_rk,0.000000000000000000e+00_rk,6.505213034913026604e-19_rk,-6.547285010986550122e-03_rk, &
                                        2.602085213965210642e-18_rk, 6.547285010986550122e-03_rk, 8.673617379884035472e-19_rk,6.547285010986550122e-03_rk,-1.409462824231155764e-18_rk,-6.547285010986551856e-03_rk,-6.547285010986550122e-03_rk,6.505213034913026604e-19_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -2.500000000000000000e-01_rk, -8.333333333333335646e-02_rk, 7.447174252959743900e-19_rk,8.333333333333334259e-02_rk,2.777777777777778664e-02_rk,-1.297324543953239237e-18_rk,-4.333090626912651653e-18_rk,2.482391417653244757e-19_rk, &
                                        -8.333333333333335646e-02_rk, -8.333333333333334259e-02_rk, -4.333090626912651653e-18_rk,2.777777777777778664e-02_rk,2.777777777777777624e-02_rk,2.482391417653244757e-19_rk,1.549281748747930374e-18_rk,-1.444363542304217089e-18_rk, &
                                        7.447174252959743900e-19_rk, -4.333090626912651653e-18_rk, -8.333333333333334259e-02_rk,-1.297324543953239237e-18_rk,2.482391417653244757e-19_rk,2.777777777777777624e-02_rk,-2.777777777777777971e-02_rk,9.259259259259263949e-03_rk, &
                                        8.333333333333334259e-02_rk, 2.777777777777778664e-02_rk, -1.297324543953239237e-18_rk,-8.333333333333334259e-02_rk,-2.777777777777777971e-02_rk,1.549281748747930374e-18_rk,2.482391417653244757e-19_rk,-5.770018043158137345e-19_rk, &
                                        2.777777777777778664e-02_rk, 2.777777777777777624e-02_rk, 2.482391417653244757e-19_rk,-2.777777777777777971e-02_rk,-2.777777777777778664e-02_rk,5.072003681696906032e-19_rk,-2.311725280292620251e-18_rk,1.600629422068147507e-18_rk, &
                                        -1.297324543953239237e-18_rk, 2.482391417653244757e-19_rk, 2.777777777777777624e-02_rk,1.549281748747930374e-18_rk,5.072003681696906032e-19_rk,-2.777777777777778664e-02_rk,9.259259259259260480e-03_rk,-9.259259259259260480e-03_rk, &
                                        -4.333090626912651653e-18_rk, 1.549281748747930374e-18_rk, -2.777777777777777971e-02_rk,2.482391417653244757e-19_rk,-2.311725280292620251e-18_rk,9.259259259259260480e-03_rk,-2.777777777777778664e-02_rk,9.259259259259258745e-03_rk, &
                                        2.482391417653244757e-19_rk, -1.444363542304217089e-18_rk, 9.259259259259263949e-03_rk,-5.770018043158137345e-19_rk,1.600629422068147507e-18_rk,-9.259259259259260480e-03_rk,9.259259259259258745e-03_rk,-9.259259259259258745e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -4.336808689942017736e-17_rk, 5.892556509887893895e-02_rk, -3.469446951953614189e-18_rk,-5.892556509887895977e-02_rk,-1.301042606982605321e-18_rk,1.964185503295965210e-02_rk,-1.964185503295964863e-02_rk,2.168404344971008868e-19_rk, &
                                        5.892556509887893895e-02_rk, -1.344410693882025498e-17_rk, -1.964185503295964863e-02_rk,-1.301042606982605321e-18_rk,-1.964185503295965210e-02_rk,2.168404344971008868e-19_rk,-2.168404344971008868e-19_rk,6.547285010986550989e-03_rk, &
                                        -3.469446951953614189e-18_rk, -1.964185503295964863e-02_rk, -1.344410693882025498e-17_rk,1.964185503295965210e-02_rk,2.168404344971008868e-19_rk,-1.964185503295965210e-02_rk,1.964185503295964863e-02_rk,-6.505213034913026604e-19_rk, &
                                        -5.892556509887895977e-02_rk, -1.301042606982605321e-18_rk, 1.964185503295965210e-02_rk,-1.344410693882025498e-17_rk,1.964185503295964863e-02_rk,-2.168404344971008868e-19_rk,2.168404344971008868e-19_rk,-6.547285010986550122e-03_rk, &
                                        -1.301042606982605321e-18_rk, -1.964185503295965210e-02_rk, 2.168404344971008868e-19_rk,1.964185503295964863e-02_rk,-2.168404344971008868e-18_rk,-6.547285010986549254e-03_rk,6.547285010986550122e-03_rk,0.000000000000000000e+00_rk, &
                                        1.964185503295965210e-02_rk, 2.168404344971008868e-19_rk, -1.964185503295965210e-02_rk,-2.168404344971008868e-19_rk,-6.547285010986549254e-03_rk,-2.168404344971008868e-18_rk,-1.734723475976807094e-18_rk,6.547285010986550122e-03_rk, &
                                        -1.964185503295964863e-02_rk, -2.168404344971008868e-19_rk, 1.964185503295964863e-02_rk,2.168404344971008868e-19_rk,6.547285010986550122e-03_rk,-1.734723475976807094e-18_rk,-2.168404344971008868e-18_rk,-6.547285010986551856e-03_rk, &
                                        2.168404344971008868e-19_rk, 6.547285010986550989e-03_rk, -6.505213034913026604e-19_rk,-6.547285010986550122e-03_rk,0.000000000000000000e+00_rk,6.547285010986550122e-03_rk,-6.547285010986551856e-03_rk,-1.409462824231155764e-18_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,2) = reshape((/                                                                                 &
                                        3.535533905932737309e-01_rk, 5.892556509887893201e-02_rk, -1.178511301977578501e-01_rk,5.892556509887893201e-02_rk,-2.602085213965210642e-18_rk,-1.964185503295965210e-02_rk,-1.964185503295964516e-02_rk,-8.673617379884035472e-19_rk, &
                                        5.892556509887893201e-02_rk, 1.178511301977579195e-01_rk, -1.964185503295964516e-02_rk,-2.602085213965210642e-18_rk,1.964185503295965210e-02_rk,-8.673617379884035472e-19_rk,-3.928371006591929032e-02_rk,-6.547285010986550122e-03_rk, &
                                        -1.178511301977578501e-01_rk, -1.964185503295964516e-02_rk, 1.178511301977579195e-01_rk,-1.964185503295965210e-02_rk,-8.673617379884035472e-19_rk,1.964185503295965210e-02_rk,1.964185503295965904e-02_rk,-1.301042606982605321e-18_rk, &
                                        5.892556509887893201e-02_rk, -2.602085213965210642e-18_rk, -1.964185503295965210e-02_rk,1.178511301977579195e-01_rk,1.964185503295965904e-02_rk,-3.928371006591929032e-02_rk,-8.673617379884035472e-19_rk,-6.547285010986550122e-03_rk, &
                                        -2.602085213965210642e-18_rk, 1.964185503295965210e-02_rk, -8.673617379884035472e-19_rk,1.964185503295965904e-02_rk,3.928371006591930420e-02_rk,-6.547285010986549254e-03_rk,-6.547285010986550122e-03_rk,-1.309457002197310024e-02_rk, &
                                        -1.964185503295965210e-02_rk, -8.673617379884035472e-19_rk, 1.964185503295965210e-02_rk,-3.928371006591929032e-02_rk,-6.547285010986549254e-03_rk,3.928371006591930420e-02_rk,-1.734723475976807094e-18_rk,6.547285010986550122e-03_rk, &
                                        -1.964185503295964516e-02_rk, -3.928371006591929032e-02_rk, 1.964185503295965904e-02_rk,-8.673617379884035472e-19_rk,-6.547285010986550122e-03_rk,-1.734723475976807094e-18_rk,3.928371006591930420e-02_rk,6.547285010986550122e-03_rk, &
                                        -8.673617379884035472e-19_rk, -6.547285010986550122e-03_rk, -1.301042606982605321e-18_rk,-6.547285010986550122e-03_rk,-1.309457002197310024e-02_rk,6.547285010986550122e-03_rk,6.547285010986550122e-03_rk,1.309457002197310024e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -2.500000000000000000e-01_rk, -8.333333333333334259e-02_rk, -6.393722911308694734e-18_rk,-8.333333333333334259e-02_rk,-2.777777777777778664e-02_rk,-1.182116357319541669e-18_rk,-3.350520702290550923e-18_rk,1.916447140176318309e-18_rk, &
                                        -8.333333333333334259e-02_rk, -8.333333333333334259e-02_rk, -3.350520702290550923e-18_rk,-2.777777777777778664e-02_rk,-2.777777777777777971e-02_rk,1.916447140176318309e-18_rk,6.154045331937131806e-19_rk,3.287626625504890662e-19_rk, &
                                        -6.393722911308694734e-18_rk, -3.350520702290550923e-18_rk, -8.333333333333334259e-02_rk,-1.182116357319541669e-18_rk,1.916447140176318309e-18_rk,-2.777777777777777971e-02_rk,-2.777777777777777971e-02_rk,-9.259259259259262215e-03_rk, &
                                        -8.333333333333334259e-02_rk, -2.777777777777778664e-02_rk, -1.182116357319541669e-18_rk,-8.333333333333334259e-02_rk,-2.777777777777777971e-02_rk,6.154045331937131806e-19_rk,1.916447140176318309e-18_rk,3.287626625504890662e-19_rk, &
                                        -2.777777777777778664e-02_rk, -2.777777777777777971e-02_rk, 1.916447140176318309e-18_rk,-2.777777777777777971e-02_rk,-2.777777777777778664e-02_rk,9.792839660417915340e-19_rk,1.196124400538892421e-18_rk,1.144776727218674710e-18_rk, &
                                        -1.182116357319541669e-18_rk, 1.916447140176318309e-18_rk, -2.777777777777777971e-02_rk,6.154045331937131806e-19_rk,9.792839660417915340e-19_rk,-2.777777777777778664e-02_rk,-9.259259259259260480e-03_rk,-9.259259259259260480e-03_rk, &
                                        -3.350520702290550923e-18_rk, 6.154045331937131806e-19_rk, -2.777777777777777971e-02_rk,1.916447140176318309e-18_rk,1.196124400538892421e-18_rk,-9.259259259259260480e-03_rk,-2.777777777777778664e-02_rk,-9.259259259259258745e-03_rk, &
                                        1.916447140176318309e-18_rk, 3.287626625504890662e-19_rk, -9.259259259259262215e-03_rk,3.287626625504890662e-19_rk,1.144776727218674710e-18_rk,-9.259259259259260480e-03_rk,-9.259259259259258745e-03_rk,-9.259259259259258745e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,1) = reshape((/                                                                                 &
                                        7.112366251504909087e-17_rk, 5.892556509887898059e-02_rk, 3.122502256758252770e-17_rk,-5.892556509887897365e-02_rk,1.301042606982605321e-18_rk,-1.964185503295965557e-02_rk,1.964185503295965557e-02_rk,-2.168404344971008868e-19_rk, &
                                        5.892556509887898059e-02_rk, 1.344410693882025498e-17_rk, 1.964185503295965557e-02_rk,1.301042606982605321e-18_rk,-1.964185503295965904e-02_rk,-2.168404344971008868e-19_rk,7.155734338404329264e-18_rk,-6.547285010986554459e-03_rk, &
                                        3.122502256758252770e-17_rk, 1.964185503295965557e-02_rk, 1.344410693882025498e-17_rk,-1.964185503295965557e-02_rk,-2.168404344971008868e-19_rk,-1.964185503295965904e-02_rk,1.964185503295965557e-02_rk,-6.505213034913026604e-19_rk, &
                                        -5.892556509887897365e-02_rk, 1.301042606982605321e-18_rk, -1.964185503295965557e-02_rk,1.344410693882025498e-17_rk,1.964185503295965557e-02_rk,7.155734338404329264e-18_rk,-2.168404344971008868e-19_rk,6.547285010986552724e-03_rk, &
                                        1.301042606982605321e-18_rk, -1.964185503295965904e-02_rk, -2.168404344971008868e-19_rk,1.964185503295965557e-02_rk,4.770489558936219510e-18_rk,6.547285010986551856e-03_rk,-6.547285010986555326e-03_rk,1.734723475976807094e-18_rk, &
                                        -1.964185503295965557e-02_rk, -2.168404344971008868e-19_rk, -1.964185503295965904e-02_rk,7.155734338404329264e-18_rk,6.547285010986551856e-03_rk,4.770489558936219510e-18_rk,-1.734723475976807094e-18_rk,6.547285010986553591e-03_rk, &
                                        1.964185503295965557e-02_rk, 7.155734338404329264e-18_rk, 1.964185503295965557e-02_rk,-2.168404344971008868e-19_rk,-6.547285010986555326e-03_rk,-1.734723475976807094e-18_rk,4.770489558936219510e-18_rk,-6.547285010986553591e-03_rk, &
                                        -2.168404344971008868e-19_rk, -6.547285010986554459e-03_rk, -6.505213034913026604e-19_rk,6.547285010986552724e-03_rk,1.734723475976807094e-18_rk,6.547285010986553591e-03_rk,-6.547285010986553591e-03_rk,2.059984127722458425e-18_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -3.535533905932737309e-01_rk, 5.892556509887893201e-02_rk, -1.178511301977578640e-01_rk,5.892556509887893201e-02_rk,2.602085213965210642e-18_rk,1.964185503295964169e-02_rk,1.964185503295964516e-02_rk,6.071532165918824830e-18_rk, &
                                        5.892556509887893201e-02_rk, -1.178511301977579195e-01_rk, 1.964185503295964516e-02_rk,2.602085213965210642e-18_rk,1.964185503295965210e-02_rk,6.071532165918824830e-18_rk,-3.928371006591929726e-02_rk,6.547285010986547520e-03_rk, &
                                        -1.178511301977578640e-01_rk, 1.964185503295964516e-02_rk, -1.178511301977579195e-01_rk,1.964185503295964169e-02_rk,6.071532165918824830e-18_rk,1.964185503295965210e-02_rk,1.964185503295963822e-02_rk,1.734723475976807094e-18_rk, &
                                        5.892556509887893201e-02_rk, 2.602085213965210642e-18_rk, 1.964185503295964169e-02_rk,-1.178511301977579195e-01_rk,1.964185503295963822e-02_rk,-3.928371006591929726e-02_rk,6.071532165918824830e-18_rk,6.547285010986549254e-03_rk, &
                                        2.602085213965210642e-18_rk, 1.964185503295965210e-02_rk, 6.071532165918824830e-18_rk,1.964185503295963822e-02_rk,-3.928371006591930420e-02_rk,6.547285010986548387e-03_rk,6.547285010986546652e-03_rk,-1.309457002197309677e-02_rk, &
                                        1.964185503295964169e-02_rk, 6.071532165918824830e-18_rk, 1.964185503295965210e-02_rk,-3.928371006591929726e-02_rk,6.547285010986548387e-03_rk,-3.928371006591930420e-02_rk,2.602085213965210642e-18_rk,6.547285010986548387e-03_rk, &
                                        1.964185503295964516e-02_rk, -3.928371006591929726e-02_rk, 1.964185503295963822e-02_rk,6.071532165918824830e-18_rk,6.547285010986546652e-03_rk,2.602085213965210642e-18_rk,-3.928371006591930420e-02_rk,6.547285010986550122e-03_rk, &
                                        6.071532165918824830e-18_rk, 6.547285010986547520e-03_rk, 1.734723475976807094e-18_rk,6.547285010986549254e-03_rk,-1.309457002197309677e-02_rk,6.547285010986548387e-03_rk,6.547285010986550122e-03_rk,-1.309457002197310024e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,5,3) = reshape((/                                                                                 &
                                        2.499999999999999722e-01_rk, -8.333333333333332871e-02_rk, -4.904288060716747880e-18_rk,-8.333333333333334259e-02_rk,2.777777777777777624e-02_rk,1.427404982704400754e-18_rk,3.595809327675409622e-18_rk,-4.525968480200261117e-18_rk, &
                                        -8.333333333333332871e-02_rk, 8.333333333333334259e-02_rk, 3.595809327675409622e-18_rk,2.777777777777777624e-02_rk,-2.777777777777776930e-02_rk,-4.525968480200261117e-18_rk,-3.224925873217656567e-18_rk,1.776844267884072624e-18_rk, &
                                        -4.904288060716747880e-18_rk, 3.595809327675409622e-18_rk, 8.333333333333334259e-02_rk,1.427404982704400754e-18_rk,-4.525968480200261117e-18_rk,-2.777777777777776930e-02_rk,-2.777777777777776583e-02_rk,9.259259259259253541e-03_rk, &
                                        -8.333333333333334259e-02_rk, 2.777777777777777624e-02_rk, 1.427404982704400754e-18_rk,8.333333333333334259e-02_rk,-2.777777777777776583e-02_rk,-3.224925873217656567e-18_rk,-4.525968480200261117e-18_rk,1.776844267884072624e-18_rk, &
                                        2.777777777777777624e-02_rk, -2.777777777777776930e-02_rk, -4.525968480200261117e-18_rk,-2.777777777777776583e-02_rk,2.777777777777777971e-02_rk,2.861046440369577058e-18_rk,2.644206005872475786e-18_rk,-2.159177463558056109e-18_rk, &
                                        1.427404982704400754e-18_rk, -4.525968480200261117e-18_rk, -2.777777777777776930e-02_rk,-3.224925873217656567e-18_rk,2.861046440369577058e-18_rk,2.777777777777777971e-02_rk,9.259259259259255276e-03_rk,-9.259259259259257011e-03_rk, &
                                        3.595809327675409622e-18_rk, -3.224925873217656567e-18_rk, -2.777777777777776583e-02_rk,-4.525968480200261117e-18_rk,2.644206005872475786e-18_rk,9.259259259259255276e-03_rk,2.777777777777777971e-02_rk,-9.259259259259258745e-03_rk, &
                                        -4.525968480200261117e-18_rk, 1.776844267884072624e-18_rk, 9.259259259259253541e-03_rk,1.776844267884072624e-18_rk,-2.159177463558056109e-18_rk,-9.259259259259257011e-03_rk,-9.259259259259258745e-03_rk,9.259259259259258745e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,1) = reshape((/                                                                                 &
                                        3.535533905932738419e-01_rk, -5.892556509887894589e-02_rk, 1.178511301977579334e-01_rk,5.892556509887896671e-02_rk,-3.035766082959412415e-18_rk,1.964185503295965904e-02_rk,-1.964185503295964863e-02_rk,-1.517883041479706208e-18_rk, &
                                        -5.892556509887894589e-02_rk, 1.178511301977579334e-01_rk, -1.964185503295964863e-02_rk,-3.035766082959412415e-18_rk,1.964185503295965904e-02_rk,-1.517883041479706208e-18_rk,3.928371006591931114e-02_rk,6.547285010986556193e-03_rk, &
                                        1.178511301977579334e-01_rk, -1.964185503295964863e-02_rk, 1.178511301977579334e-01_rk,1.964185503295965904e-02_rk,-1.517883041479706208e-18_rk,1.964185503295965904e-02_rk,-1.964185503295964169e-02_rk,-1.084202172485504434e-18_rk, &
                                        5.892556509887896671e-02_rk, -3.035766082959412415e-18_rk, 1.964185503295965904e-02_rk,1.178511301977579334e-01_rk,-1.964185503295964169e-02_rk,3.928371006591931114e-02_rk,-1.517883041479706208e-18_rk,-6.547285010986547520e-03_rk, &
                                        -3.035766082959412415e-18_rk, 1.964185503295965904e-02_rk, -1.517883041479706208e-18_rk,-1.964185503295964169e-02_rk,3.928371006591931114e-02_rk,-6.547285010986544050e-03_rk,6.547285010986555326e-03_rk,1.309457002197310371e-02_rk, &
                                        1.964185503295965904e-02_rk, -1.517883041479706208e-18_rk, 1.964185503295965904e-02_rk,3.928371006591931114e-02_rk,-6.547285010986544050e-03_rk,3.928371006591931114e-02_rk,1.734723475976807094e-18_rk,-6.547285010986550122e-03_rk, &
                                        -1.964185503295964863e-02_rk, 3.928371006591931114e-02_rk, -1.964185503295964169e-02_rk,-1.517883041479706208e-18_rk,6.547285010986555326e-03_rk,1.734723475976807094e-18_rk,3.928371006591931114e-02_rk,6.547285010986553591e-03_rk, &
                                        -1.517883041479706208e-18_rk, 6.547285010986556193e-03_rk, -1.084202172485504434e-18_rk,-6.547285010986547520e-03_rk,1.309457002197310371e-02_rk,-6.547285010986550122e-03_rk,6.547285010986553591e-03_rk,1.309457002197310198e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -3.469446951953614189e-18_rk, -5.892556509887892507e-02_rk, -1.040834085586084257e-17_rk,-5.892556509887893201e-02_rk,-8.673617379884035472e-19_rk,-1.964185503295964169e-02_rk,-1.964185503295964863e-02_rk,-4.336808689942017736e-18_rk, &
                                        -5.892556509887892507e-02_rk, -5.204170427930421283e-18_rk, -1.964185503295964863e-02_rk,-8.673617379884035472e-19_rk,-1.964185503295965210e-02_rk,-4.336808689942017736e-18_rk,-2.602085213965210642e-18_rk,-6.547285010986549254e-03_rk, &
                                        -1.040834085586084257e-17_rk, -1.964185503295964863e-02_rk, -5.204170427930421283e-18_rk,-1.964185503295964169e-02_rk,-4.336808689942017736e-18_rk,-1.964185503295965210e-02_rk,-1.964185503295964516e-02_rk,-4.336808689942017736e-19_rk, &
                                        -5.892556509887893201e-02_rk, -8.673617379884035472e-19_rk, -1.964185503295964169e-02_rk,-5.204170427930421283e-18_rk,-1.964185503295964516e-02_rk,-2.602085213965210642e-18_rk,-4.336808689942017736e-18_rk,-6.547285010986549254e-03_rk, &
                                        -8.673617379884035472e-19_rk, -1.964185503295965210e-02_rk, -4.336808689942017736e-18_rk,-1.964185503295964516e-02_rk,-2.168404344971008868e-19_rk,-6.547285010986550122e-03_rk,-6.547285010986548387e-03_rk,-3.252606517456513302e-19_rk, &
                                        -1.964185503295964169e-02_rk, -4.336808689942017736e-18_rk, -1.964185503295965210e-02_rk,-2.602085213965210642e-18_rk,-6.547285010986550122e-03_rk,-2.168404344971008868e-19_rk,-8.673617379884035472e-19_rk,-6.547285010986550122e-03_rk, &
                                        -1.964185503295964863e-02_rk, -2.602085213965210642e-18_rk, -1.964185503295964516e-02_rk,-4.336808689942017736e-18_rk,-6.547285010986548387e-03_rk,-8.673617379884035472e-19_rk,-2.168404344971008868e-19_rk,-6.547285010986550122e-03_rk, &
                                        -4.336808689942017736e-18_rk, -6.547285010986549254e-03_rk, -4.336808689942017736e-19_rk,-6.547285010986549254e-03_rk,-3.252606517456513302e-19_rk,-6.547285010986550122e-03_rk,-6.547285010986550122e-03_rk,-1.517883041479706208e-18_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,6,3) = reshape((/                                                                                 &
                                        2.499999999999999722e-01_rk, -8.333333333333332871e-02_rk, -7.447174252959736197e-19_rk,8.333333333333334259e-02_rk,-2.777777777777778317e-02_rk,3.032048019930045947e-18_rk,2.598367150935844173e-18_rk,-2.482391417653240905e-19_rk, &
                                        -8.333333333333332871e-02_rk, 8.333333333333334259e-02_rk, 2.598367150935844173e-18_rk,-2.777777777777778317e-02_rk,2.777777777777777277e-02_rk,-2.482391417653240905e-19_rk,-1.549281748747929797e-18_rk,5.770018043158135419e-19_rk, &
                                        -7.447174252959736197e-19_rk, 2.598367150935844173e-18_rk, 8.333333333333334259e-02_rk,3.032048019930045947e-18_rk,-2.482391417653240905e-19_rk,2.777777777777777277e-02_rk,-2.777777777777776236e-02_rk,-9.259259259259255276e-03_rk, &
                                        8.333333333333334259e-02_rk, -2.777777777777778317e-02_rk, 3.032048019930045947e-18_rk,8.333333333333334259e-02_rk,-2.777777777777776236e-02_rk,-1.549281748747929797e-18_rk,-2.482391417653240905e-19_rk,1.444363542304217089e-18_rk, &
                                        -2.777777777777778317e-02_rk, 2.777777777777777277e-02_rk, -2.482391417653240905e-19_rk,-2.777777777777776236e-02_rk,2.777777777777777971e-02_rk,2.094884845795519364e-18_rk,-2.903599336725900053e-19_rk,-2.034310291062349473e-18_rk, &
                                        3.032048019930045947e-18_rk, -2.482391417653240905e-19_rk, 2.777777777777777277e-02_rk,-1.549281748747929797e-18_rk,2.094884845795519364e-18_rk,2.777777777777777971e-02_rk,-9.259259259259258745e-03_rk,-9.259259259259257011e-03_rk, &
                                        2.598367150935844173e-18_rk, -1.549281748747929797e-18_rk, -2.777777777777776236e-02_rk,-2.482391417653240905e-19_rk,-2.903599336725900053e-19_rk,-9.259259259259258745e-03_rk,2.777777777777777971e-02_rk,9.259259259259258745e-03_rk, &
                                        -2.482391417653240905e-19_rk, 5.770018043158135419e-19_rk, -9.259259259259255276e-03_rk,1.444363542304217089e-18_rk,-2.034310291062349473e-18_rk,-9.259259259259257011e-03_rk,9.259259259259258745e-03_rk,9.259259259259258745e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -3.535533905932738419e-01_rk, -5.892556509887897365e-02_rk, -1.178511301977579334e-01_rk,5.892556509887896671e-02_rk,4.336808689942017736e-19_rk,1.964185503295965210e-02_rk,-1.964185503295965557e-02_rk,4.553649124439118623e-18_rk, &
                                        -5.892556509887897365e-02_rk, -1.178511301977579334e-01_rk, -1.964185503295965557e-02_rk,4.336808689942017736e-19_rk,1.964185503295965210e-02_rk,4.553649124439118623e-18_rk,-3.928371006591931114e-02_rk,6.547285010986550989e-03_rk, &
                                        -1.178511301977579334e-01_rk, -1.964185503295965557e-02_rk, -1.178511301977579334e-01_rk,1.964185503295965210e-02_rk,4.553649124439118623e-18_rk,1.964185503295965210e-02_rk,-1.964185503295965557e-02_rk,2.385244779468109755e-18_rk, &
                                        5.892556509887896671e-02_rk, 4.336808689942017736e-19_rk, 1.964185503295965210e-02_rk,-1.178511301977579334e-01_rk,-1.964185503295965557e-02_rk,-3.928371006591931114e-02_rk,4.553649124439118623e-18_rk,-6.547285010986553591e-03_rk, &
                                        4.336808689942017736e-19_rk, 1.964185503295965210e-02_rk, 4.553649124439118623e-18_rk,-1.964185503295965557e-02_rk,-3.928371006591931114e-02_rk,-6.547285010986557061e-03_rk,6.547285010986552724e-03_rk,-1.309457002197310371e-02_rk, &
                                        1.964185503295965210e-02_rk, 4.553649124439118623e-18_rk, 1.964185503295965210e-02_rk,-3.928371006591931114e-02_rk,-6.547285010986557061e-03_rk,-3.928371006591931114e-02_rk,2.168404344971008868e-18_rk,-6.547285010986553591e-03_rk, &
                                        -1.964185503295965557e-02_rk, -3.928371006591931114e-02_rk, -1.964185503295965557e-02_rk,4.553649124439118623e-18_rk,6.547285010986552724e-03_rk,2.168404344971008868e-18_rk,-3.928371006591931114e-02_rk,6.547285010986551856e-03_rk, &
                                        4.553649124439118623e-18_rk, 6.547285010986550989e-03_rk, 2.385244779468109755e-18_rk,-6.547285010986553591e-03_rk,-1.309457002197310371e-02_rk,-6.547285010986553591e-03_rk,6.547285010986551856e-03_rk,-1.309457002197310198e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -6.938893903907228378e-18_rk, -5.892556509887895283e-02_rk, -1.040834085586084257e-17_rk,-5.892556509887893201e-02_rk,4.336808689942017736e-18_rk,-1.964185503295964516e-02_rk,-1.964185503295965210e-02_rk,-2.602085213965210642e-18_rk, &
                                        -5.892556509887895283e-02_rk, 1.734723475976807094e-18_rk, -1.964185503295965210e-02_rk,4.336808689942017736e-18_rk,-1.964185503295965210e-02_rk,-2.602085213965210642e-18_rk,-6.071532165918824830e-18_rk,-6.547285010986549254e-03_rk, &
                                        -1.040834085586084257e-17_rk, -1.964185503295965210e-02_rk, 1.734723475976807094e-18_rk,-1.964185503295964516e-02_rk,-2.602085213965210642e-18_rk,-1.964185503295965210e-02_rk,-1.964185503295965210e-02_rk,1.734723475976807094e-18_rk, &
                                        -5.892556509887893201e-02_rk, 4.336808689942017736e-18_rk, -1.964185503295964516e-02_rk,1.734723475976807094e-18_rk,-1.964185503295965210e-02_rk,-6.071532165918824830e-18_rk,-2.602085213965210642e-18_rk,-6.547285010986550989e-03_rk, &
                                        4.336808689942017736e-18_rk, -1.964185503295965210e-02_rk, -2.602085213965210642e-18_rk,-1.964185503295965210e-02_rk,-2.385244779468109755e-18_rk,-6.547285010986553591e-03_rk,-6.547285010986548387e-03_rk,-3.252606517456513302e-19_rk, &
                                        -1.964185503295964516e-02_rk, -2.602085213965210642e-18_rk, -1.964185503295965210e-02_rk,-6.071532165918824830e-18_rk,-6.547285010986553591e-03_rk,-2.385244779468109755e-18_rk,8.673617379884035472e-19_rk,-6.547285010986550122e-03_rk, &
                                        -1.964185503295965210e-02_rk, -6.071532165918824830e-18_rk, -1.964185503295965210e-02_rk,-2.602085213965210642e-18_rk,-6.547285010986548387e-03_rk,8.673617379884035472e-19_rk,-2.385244779468109755e-18_rk,-6.547285010986550122e-03_rk, &
                                        -2.602085213965210642e-18_rk, -6.547285010986549254e-03_rk, 1.734723475976807094e-18_rk,-6.547285010986550989e-03_rk,-3.252606517456513302e-19_rk,-6.547285010986550122e-03_rk,-6.547285010986550122e-03_rk,4.336808689942017736e-19_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,7,3) = reshape((/                                                                                 &
                                        2.500000000000000000e-01_rk, 8.333333333333337034e-02_rk, -7.447174252959736197e-19_rk,-8.333333333333334259e-02_rk,-2.777777777777779011e-02_rk,1.297324543953239045e-18_rk,4.333090626912651653e-18_rk,-2.482391417653240905e-19_rk, &
                                        8.333333333333337034e-02_rk, 8.333333333333334259e-02_rk, 4.333090626912651653e-18_rk,-2.777777777777779011e-02_rk,-2.777777777777777277e-02_rk,-2.482391417653240905e-19_rk,-1.549281748747929604e-18_rk,1.444363542304217089e-18_rk, &
                                        -7.447174252959736197e-19_rk, 4.333090626912651653e-18_rk, 8.333333333333334259e-02_rk,1.297324543953239045e-18_rk,-2.482391417653240905e-19_rk,-2.777777777777777277e-02_rk,2.777777777777778317e-02_rk,-9.259259259259263949e-03_rk, &
                                        -8.333333333333334259e-02_rk, -2.777777777777779011e-02_rk, 1.297324543953239045e-18_rk,8.333333333333334259e-02_rk,2.777777777777778317e-02_rk,-1.549281748747929604e-18_rk,-2.482391417653240905e-19_rk,5.770018043158135419e-19_rk, &
                                        -2.777777777777779011e-02_rk, -2.777777777777777277e-02_rk, -2.482391417653240905e-19_rk,2.777777777777778317e-02_rk,2.777777777777778664e-02_rk,-5.072003681696906032e-19_rk,2.311725280292620251e-18_rk,-1.600629422068147507e-18_rk, &
                                        1.297324543953239045e-18_rk, -2.482391417653240905e-19_rk, -2.777777777777777277e-02_rk,-1.549281748747929604e-18_rk,-5.072003681696906032e-19_rk,2.777777777777778664e-02_rk,-9.259259259259260480e-03_rk,9.259259259259260480e-03_rk, &
                                        4.333090626912651653e-18_rk, -1.549281748747929604e-18_rk, 2.777777777777778317e-02_rk,-2.482391417653240905e-19_rk,2.311725280292620251e-18_rk,-9.259259259259260480e-03_rk,2.777777777777778664e-02_rk,-9.259259259259258745e-03_rk, &
                                        -2.482391417653240905e-19_rk, 1.444363542304217089e-18_rk, -9.259259259259263949e-03_rk,5.770018043158135419e-19_rk,-1.600629422068147507e-18_rk,9.259259259259260480e-03_rk,-9.259259259259258745e-03_rk,9.259259259259258745e-03_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -6.418476861114186249e-17_rk, 5.892556509887893895e-02_rk, -2.428612866367529932e-17_rk,-5.892556509887895977e-02_rk,1.301042606982605321e-18_rk,-1.964185503295965210e-02_rk,1.964185503295964863e-02_rk,-2.818925648462311528e-18_rk, &
                                        5.892556509887893895e-02_rk, -1.604619215278546562e-17_rk, 1.964185503295964863e-02_rk,1.301042606982605321e-18_rk,-1.964185503295965210e-02_rk,-2.818925648462311528e-18_rk,-6.722053469410127491e-18_rk,-6.547285010986552724e-03_rk, &
                                        -2.428612866367529932e-17_rk, 1.964185503295964863e-02_rk, -1.604619215278546562e-17_rk,-1.964185503295965210e-02_rk,-2.818925648462311528e-18_rk,-1.964185503295965210e-02_rk,1.964185503295964169e-02_rk,-6.505213034913026604e-19_rk, &
                                        -5.892556509887895977e-02_rk, 1.301042606982605321e-18_rk, -1.964185503295965210e-02_rk,-1.604619215278546562e-17_rk,1.964185503295964169e-02_rk,-6.722053469410127491e-18_rk,-2.818925648462311528e-18_rk,6.547285010986548387e-03_rk, &
                                        1.301042606982605321e-18_rk, -1.964185503295965210e-02_rk, -2.818925648462311528e-18_rk,1.964185503295964169e-02_rk,-2.602085213965210642e-18_rk,6.547285010986548387e-03_rk,-6.547285010986552724e-03_rk,-1.734723475976807094e-18_rk, &
                                        -1.964185503295965210e-02_rk, -2.818925648462311528e-18_rk, -1.964185503295965210e-02_rk,-6.722053469410127491e-18_rk,6.547285010986548387e-03_rk,-2.602085213965210642e-18_rk,-2.168404344971008868e-18_rk,6.547285010986550122e-03_rk, &
                                        1.964185503295964863e-02_rk, -6.722053469410127491e-18_rk, 1.964185503295964169e-02_rk,-2.818925648462311528e-18_rk,-6.547285010986552724e-03_rk,-2.168404344971008868e-18_rk,-2.602085213965210642e-18_rk,-6.547285010986551856e-03_rk, &
                                        -2.818925648462311528e-18_rk, -6.547285010986552724e-03_rk, -6.505213034913026604e-19_rk,6.547285010986548387e-03_rk,-1.734723475976807094e-18_rk,6.547285010986550122e-03_rk,-6.547285010986551856e-03_rk,-1.951563910473907981e-18_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,2) = reshape((/                                                                                 &
                                        3.535533905932737309e-01_rk, 5.892556509887894589e-02_rk, 1.178511301977578779e-01_rk,5.892556509887893201e-02_rk,-6.071532165918824830e-18_rk,1.964185503295964516e-02_rk,1.964185503295965557e-02_rk,8.673617379884035472e-19_rk, &
                                        5.892556509887894589e-02_rk, 1.178511301977579195e-01_rk, 1.964185503295965557e-02_rk,-6.071532165918824830e-18_rk,1.964185503295965210e-02_rk,8.673617379884035472e-19_rk,3.928371006591930420e-02_rk,6.547285010986550989e-03_rk, &
                                        1.178511301977578779e-01_rk, 1.964185503295965557e-02_rk, 1.178511301977579195e-01_rk,1.964185503295964516e-02_rk,8.673617379884035472e-19_rk,1.964185503295965210e-02_rk,1.964185503295965904e-02_rk,-3.035766082959412415e-18_rk, &
                                        5.892556509887893201e-02_rk, -6.071532165918824830e-18_rk, 1.964185503295964516e-02_rk,1.178511301977579195e-01_rk,1.964185503295965904e-02_rk,3.928371006591930420e-02_rk,8.673617379884035472e-19_rk,6.547285010986550989e-03_rk, &
                                        -6.071532165918824830e-18_rk, 1.964185503295965210e-02_rk, 8.673617379884035472e-19_rk,1.964185503295965904e-02_rk,3.928371006591930420e-02_rk,6.547285010986555326e-03_rk,6.547285010986550122e-03_rk,1.309457002197309677e-02_rk, &
                                        1.964185503295964516e-02_rk, 8.673617379884035472e-19_rk, 1.964185503295965210e-02_rk,3.928371006591930420e-02_rk,6.547285010986555326e-03_rk,3.928371006591930420e-02_rk,-2.602085213965210642e-18_rk,6.547285010986551856e-03_rk, &
                                        1.964185503295965557e-02_rk, 3.928371006591930420e-02_rk, 1.964185503295965904e-02_rk,8.673617379884035472e-19_rk,6.547285010986550122e-03_rk,-2.602085213965210642e-18_rk,3.928371006591930420e-02_rk,6.547285010986550122e-03_rk, &
                                        8.673617379884035472e-19_rk, 6.547285010986550989e-03_rk, -3.035766082959412415e-18_rk,6.547285010986550989e-03_rk,1.309457002197309677e-02_rk,6.547285010986551856e-03_rk,6.547285010986550122e-03_rk,1.309457002197310024e-02_rk  &
                                        /),(/8,8/))
        
        test_dmass_dx(:,:,8,3) = reshape((/                                                                                 &
                                        2.500000000000000000e-01_rk, 8.333333333333335646e-02_rk, 6.393722911308696275e-18_rk,8.333333333333334259e-02_rk,2.777777777777779011e-02_rk,1.182116357319541669e-18_rk,3.350520702290550537e-18_rk,-1.916447140176318309e-18_rk, &
                                        8.333333333333335646e-02_rk, 8.333333333333334259e-02_rk, 3.350520702290550537e-18_rk,2.777777777777779011e-02_rk,2.777777777777777624e-02_rk,-1.916447140176318309e-18_rk,-6.154045331937122176e-19_rk,-3.287626625504889699e-19_rk, &
                                        6.393722911308696275e-18_rk, 3.350520702290550537e-18_rk, 8.333333333333334259e-02_rk,1.182116357319541669e-18_rk,-1.916447140176318309e-18_rk,2.777777777777777624e-02_rk,2.777777777777778317e-02_rk,9.259259259259263949e-03_rk, &
                                        8.333333333333334259e-02_rk, 2.777777777777779011e-02_rk, 1.182116357319541669e-18_rk,8.333333333333334259e-02_rk,2.777777777777778317e-02_rk,-6.154045331937122176e-19_rk,-1.916447140176318309e-18_rk,-3.287626625504889699e-19_rk, &
                                        2.777777777777779011e-02_rk, 2.777777777777777624e-02_rk, -1.916447140176318309e-18_rk,2.777777777777778317e-02_rk,2.777777777777778664e-02_rk,-9.792839660417919192e-19_rk,-1.196124400538892806e-18_rk,-1.144776727218674710e-18_rk, &
                                        1.182116357319541669e-18_rk, -1.916447140176318309e-18_rk, 2.777777777777777624e-02_rk,-6.154045331937122176e-19_rk,-9.792839660417919192e-19_rk,2.777777777777778664e-02_rk,9.259259259259260480e-03_rk,9.259259259259260480e-03_rk, &
                                        3.350520702290550537e-18_rk, -6.154045331937122176e-19_rk, 2.777777777777778317e-02_rk,-1.916447140176318309e-18_rk,-1.196124400538892806e-18_rk,9.259259259259260480e-03_rk,2.777777777777778664e-02_rk,9.259259259259258745e-03_rk, &
                                        -1.916447140176318309e-18_rk, -3.287626625504889699e-19_rk, 9.259259259259263949e-03_rk,-3.287626625504889699e-19_rk,-1.144776727218674710e-18_rk,9.259259259259260480e-03_rk,9.259259259259258745e-03_rk,9.259259259259258745e-03_rk  &
                                        /),(/8,8/))
        


        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dmass_dx(:,:,inode_diff,idir)),self%elem%dmass_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_dmass_dx
    !*******************************************************************************************









    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_vol_dcoords_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_elem()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_elem(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,8/))
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','1',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,8/))
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','2',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,4.905626121623440916e-01_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 4.905626121623440916e-01_rk, 3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086451316e-02_rk, 4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086451316e-02_rk, 1.314458557658021443e-01_rk, 1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.314458557658021443e-01_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,9.437387837655939610e-03_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 1.314458557658021443e-01_rk, 9.437387837655939610e-03_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.522081090086452704e-02_rk, 9.437387837655939610e-03_rk, 1.314458557658021443e-01_rk,3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,4.905626121623440916e-01_rk,1.314458557658021443e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.437387837655939610e-03_rk, 3.522081090086452704e-02_rk, 3.522081090086452704e-02_rk,1.314458557658021443e-01_rk,3.522081090086451316e-02_rk,1.314458557658021443e-01_rk,1.314458557658021443e-01_rk,4.905626121623440916e-01_rk  &
                                        /),(/24,8/))
        
        
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_elem()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('element','3',inode,0)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_vol_dcoords_dx
    !*******************************************************************************************






!------------------------------------------------------------------------------
!                                Face tests
!------------------------------------------------------------------------------









    !> Test the interpolation coordinates derivatives given by
    !! elem%basis_c%get_coord_derivatives 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_ximax_dcoords_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_c*3,self%elem%basis_s%nnodes_face()) :: test_dcoords_dx
        real(rk), dimension(self%elem%basis_s%nnodes_face(),self%elem%nterms_c*3) :: dcoords_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode

        !
        ! Refrence X-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        
        
        

        !
        ! Computed X-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','1',inode,2)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        
        !
        ! Refrence Y-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        
        !
        ! Computed Y-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','2',inode,2)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)
        
        
        !
        ! Refrence Z-coordinates
        !
        test_dcoords_dx = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,  &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, 4.465819873852046318e-02_rk, 0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,1.666666666666666852e-01_rk,0.000000000000000000e+00_rk,6.220084679281461248e-01_rk  &
                                        /),(/24,4/))
        
        
        
        
        
        
        
        !
        ! Computed Z-coordiantes
        !
        do inode = 1,self%elem%basis_s%nnodes_face()
            dcoords_dx(inode,:) = self%elem%basis_c%get_coord_derivatives('face interior','3',inode,2)
        end do
        
        
        !
        ! TEST
        ! 
        @assertEqual(transpose(test_dcoords_dx),dcoords_dx,tol)

    end subroutine testElement_ximax_dcoords_dx
    !*******************************************************************************************




    !> Test cartesian dbr2_vol_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_vol_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)   :: test_dbr2_vol_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)   :: test_dbr2_vol_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)  :: test_dbr2_vol_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3)  :: test_dbr2_vol_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%basis_s%nnodes_elem(),self%elem%nterms_c,3) :: test_dbr2_vol_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       
       
        !
        ! dbr2_vol_face1_dx
        ! 
        test_dbr2_vol_face1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.338263366349876311e-16_rk, 8.967239854014846463e-17_rk,-1.001001038137321421e-16_rk, &
                                        -9.428090415820636894e-01_rk, 4.931356063059189620e-16_rk, 2.362933176816556441e-17_rk,3.550561576995040905e-17_rk, &
                                        -2.485344296194689399e-16_rk, -3.518611245019578782e+00_rk, -1.458962466105317926e-17_rk,-1.056172533203547028e-16_rk, &
                                        -5.448571911354314558e-17_rk, 7.536329748634748386e-17_rk, 2.465586218094419818e-17_rk,-6.595378584034019365e-17_rk, &
                                        -1.421111175603823860e-17_rk, 3.656944912158582106e-16_rk, -1.339315945789172632e-16_rk,1.566887258652672567e-16_rk, &
                                        -4.900764432566926970e-18_rk, 1.801573910683224287e-17_rk, -2.526249213086747547e-01_rk,-8.138388509241588701e-17_rk, &
                                        -1.287398414419301802e-16_rk, -2.083041717113151495e-17_rk, 3.793235890702911857e-17_rk,-9.428090415820631343e-01_rk, &
                                        3.831742106418589223e-18_rk, 1.944574066953863874e-16_rk, -3.724900210354242356e-17_rk,8.996239654588481328e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        9.613024693476670990e+00_rk, -1.841093146241833594e-16_rk, -3.126740083380376842e-16_rk,5.656478289924308871e-16_rk, &
                                        -1.632993161855451403e+00_rk, -9.300713131088273700e-18_rk, 2.383962751947662260e-16_rk,3.512364571555273426e-17_rk, &
                                        5.739545487335567442e-16_rk, 6.094413448457089544e+00_rk, 5.253306289763237835e-16_rk,1.745660463609462522e-16_rk, &
                                        7.393080399500152436e-16_rk, -6.901841202733882685e-01_rk, 1.555975308019330257e-16_rk,3.117051048037788216e-16_rk, &
                                        3.655766550079882787e-16_rk, -8.877407796530833916e-16_rk, 2.575802203437516535e+00_rk,1.213593036314721117e-16_rk, &
                                        -1.294091100661083474e-16_rk, 1.083098586998930513e-17_rk, -4.375591989647143465e-01_rk,-8.235617263373803107e-18_rk, &
                                        2.387183874863017817e-16_rk, 3.036161824282855310e-16_rk, 1.460965852960611702e-16_rk,1.632993161855451403e+00_rk, &
                                        7.952060821352554910e-18_rk, -6.274601614059706341e-16_rk, -6.190115191642171275e-17_rk,-1.849342776560392587e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        6.797434948471087424e+00_rk, -3.466819726019154891e-16_rk, -3.140814009593135442e-16_rk,4.144049963323673106e-16_rk, &
                                        -4.880338717125850545e-01_rk, -1.920967236307429949e-17_rk, 3.401121213453482680e-16_rk,-3.706125891938929174e-17_rk, &
                                        4.678699218143146682e-16_rk, 1.821367205045917093e+00_rk, 4.508130096337541406e-16_rk,1.807696779171081435e-16_rk, &
                                        5.207725089422488752e-16_rk, -1.307682818044211825e-01_rk, 1.492171605019361757e-16_rk,1.618951192018229127e-16_rk, &
                                        3.745871332896659007e-16_rk, -1.861341669694437523e-16_rk, 6.797434948471090088e+00_rk,1.585099139002783493e-16_rk, &
                                        -4.778496686726750158e-17_rk, -1.731478693085089380e-16_rk, -4.880338717125853321e-01_rk,-5.709682615052167340e-18_rk, &
                                        2.618061596936772340e-16_rk, 1.582911326689236151e-16_rk, 3.279707773123648885e-16_rk,1.821367205045917093e+00_rk, &
                                        -5.113518436512773411e-17_rk, -3.604423128960644038e-16_rk, 1.890402274602012964e-16_rk,-1.307682818044211270e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -6.094413448457094873e+00_rk, -6.154975135845913463e-17_rk, 2.319699640943750659e-16_rk,-2.855268506403044461e-16_rk, &
                                        2.575802203437515647e+00_rk, -5.083506711939483211e-16_rk, -1.186812426166760391e-16_rk,-9.384781625588893072e-17_rk, &
                                        -1.313578297232634281e-16_rk, -2.575802203437514315e+00_rk, -5.045336849056777388e-16_rk,-8.487680087113652890e-17_rk, &
                                        -5.817402769700741196e-16_rk, 1.632993161855451625e+00_rk, -1.923487443806118963e-16_rk,-3.386510267469108336e-16_rk, &
                                        -1.428920781722700849e-16_rk, 6.112494459459769749e-16_rk, -1.632993161855452513e+00_rk,-3.377839382916704524e-16_rk, &
                                        1.270879981501601524e-16_rk, -1.151830066159449132e-16_rk, 6.901841202733890457e-01_rk,1.215489724103412847e-16_rk, &
                                        -3.823897069840996021e-18_rk, -3.466863224502131053e-16_rk, -1.561495222009615124e-16_rk,-6.901841202733887126e-01_rk, &
                                        -5.986310923821335087e-19_rk, 3.066786658009020578e-16_rk, 1.181808484235631200e-16_rk,4.375591989647137359e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.518611245019578782e+00_rk, 1.118327293476548876e-16_rk, -8.968354296485562833e-18_rk,-1.800208745383943482e-16_rk, &
                                        1.649460857228741331e-16_rk, 2.451577801911763894e-17_rk, -1.433443643462557390e-16_rk,2.321855477038575659e-17_rk, &
                                        -1.940622893908245240e-16_rk, -1.098977650257827148e-17_rk, -6.207319409593370765e-18_rk,1.592800783054487470e-17_rk, &
                                        -1.030820438663982064e-16_rk, -9.428090415820624681e-01_rk, 1.209535139773458921e-17_rk,9.289970778347198376e-17_rk, &
                                        -2.084734650796799614e-16_rk, -8.920315750875139944e-17_rk, -9.428090415820631343e-01_rk,5.973590879493107163e-17_rk, &
                                        7.221876348515135881e-18_rk, 8.633628163912328513e-17_rk, 3.617733102856463910e-17_rk,-3.192947005455157919e-17_rk, &
                                        -1.061546489745306548e-16_rk, 6.390055719305897832e-17_rk, -2.787942200212880718e-17_rk,-2.157013606592081505e-16_rk, &
                                        -1.118517183538899830e-17_rk, 1.263240889096823861e-16_rk, -1.903069440359896519e-17_rk,-2.526249213086743661e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.821367205045918425e+00_rk, -8.275573446858060110e-17_rk, -2.136814724722489426e-16_rk,7.214112007437104048e-17_rk, &
                                        -1.821367205045917981e+00_rk, 5.601278145794347742e-16_rk, -4.213615866342340979e-17_rk,1.941604837175004852e-17_rk, &
                                        -1.192390319597190934e-16_rk, 4.880338717125849435e-01_rk, 4.303636230374086759e-16_rk,-1.053172719014975036e-17_rk, &
                                        1.914660420860482039e-16_rk, -4.880338717125845549e-01_rk, 1.133750245276214260e-16_rk,1.166565850765833365e-16_rk, &
                                        -5.212432137329539274e-17_rk, -2.890601709777908007e-16_rk, 1.821367205045918425e+00_rk,1.951736405352073744e-16_rk, &
                                        -1.029713363006233917e-16_rk, -1.785874948445854198e-18_rk, -1.821367205045917981e+00_rk,-2.172856134967093630e-16_rk, &
                                        -3.423756648011186950e-17_rk, 1.732321409027922557e-16_rk, -3.726284373918858120e-18_rk,4.880338717125849435e-01_rk, &
                                        -7.296180875252304938e-17_rk, -2.241459896354274257e-16_rk, -3.806967661652330687e-17_rk,-4.880338717125846104e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        6.094413448457094873e+00_rk, -2.061029219115161029e-16_rk, -4.113147611746718719e-16_rk,4.857270582677686811e-16_rk, &
                                        -6.901841202733883796e-01_rk, -4.779205414178895043e-16_rk, 7.142257908034492265e-17_rk,2.283658471598811879e-17_rk, &
                                        6.284266889622011601e-16_rk, 9.613024693476670990e+00_rk, 5.337129342277838755e-16_rk,2.961113075118458359e-16_rk, &
                                        6.907117151971603245e-16_rk, -1.632993161855451625e+00_rk, 1.430370200187234629e-16_rk,4.705585984275910237e-16_rk, &
                                        1.713143016843465498e-16_rk, -1.342638428377692903e-15_rk, 1.632993161855453401e+00_rk,2.440648656113596359e-17_rk, &
                                        -1.172864692850263200e-16_rk, 7.915152840228041518e-17_rk, -1.849342776560395363e-01_rk,4.121879777449048930e-17_rk, &
                                        2.613035799537012824e-16_rk, 3.883471567924759873e-16_rk, 8.028480438690326293e-17_rk,2.575802203437514759e+00_rk, &
                                        -7.064853120455020286e-18_rk, -6.955934791916745368e-16_rk, -4.368284421647830368e-17_rk,-4.375591989647138469e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.518611245019578337e+00_rk, 1.118327293476548876e-16_rk, -8.968354296485587485e-18_rk,-1.800208745383942496e-16_rk, &
                                        1.649460857228741331e-16_rk, 2.451577801911753725e-17_rk, -1.433443643462557883e-16_rk,2.321855477038574427e-17_rk, &
                                        -1.940622893908245240e-16_rk, -1.098977650257827148e-17_rk, -6.207319409593376928e-18_rk,1.592800783054487470e-17_rk, &
                                        -1.030820438663981818e-16_rk, -9.428090415820626902e-01_rk, 1.209535139773459538e-17_rk,9.289970778347198376e-17_rk, &
                                        -2.084734650796799614e-16_rk, -8.920315750875139944e-17_rk, -9.428090415820640224e-01_rk,5.973590879493103465e-17_rk, &
                                        7.221876348515148207e-18_rk, 8.633628163912333443e-17_rk, 3.617733102856463910e-17_rk,-3.192947005455156071e-17_rk, &
                                        -1.061546489745305931e-16_rk, 6.390055719305894134e-17_rk, -2.787942200212878253e-17_rk,2.283878491908544656e-16_rk, &
                                        -1.118517183538902295e-17_rk, 1.263240889096823861e-16_rk, -1.903069440359901449e-17_rk,-2.526249213086744771e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.821367205045918869e+00_rk, -3.401825129327679872e-16_rk, -2.700326238315759018e-16_rk,4.275795380016300651e-16_rk, &
                                        -1.307682818044212658e-01_rk, -6.131562971604936567e-16_rk, 1.713416405941054360e-16_rk,-1.462728161003528093e-16_rk, &
                                        4.377237642620452787e-16_rk, 6.797434948471085647e+00_rk, 3.125654306645053190e-16_rk,3.798947429003772610e-16_rk, &
                                        3.824527600926655957e-16_rk, -4.880338717125848880e-01_rk, 9.777645432992836382e-17_rk,3.155027366793874426e-16_rk, &
                                        7.962811427262823201e-17_rk, -8.000377956736840402e-16_rk, 1.821367205045918869e+00_rk,-7.550792760562050941e-18_rk, &
                                        -7.128324597965684161e-17_rk, -1.508816186391424644e-16_rk, -1.307682818044212381e-01_rk,2.175335076159996948e-16_rk, &
                                        3.822110657201498956e-16_rk, 5.807019963140073700e-16_rk, 8.258933844379915074e-17_rk,6.797434948471085647e+00_rk, &
                                        -1.102728251343996985e-16_rk, -6.279057876109907082e-16_rk, 4.043757639428030771e-17_rk,-4.880338717125849435e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.338263366349876064e-16_rk, 8.967239854014836602e-17_rk,-1.001001038137320435e-16_rk, &
                                        -9.428090415820631343e-01_rk, 4.931356063059187648e-16_rk, 2.362933176816556441e-17_rk,3.550561576995039672e-17_rk, &
                                        -2.485344296194687920e-16_rk, -3.518611245019577005e+00_rk, -1.458962466105308065e-17_rk,-1.056172533203546042e-16_rk, &
                                        -5.448571911354303465e-17_rk, -2.577036099011994783e-16_rk, 2.465586218094419202e-17_rk,-6.595378584033999643e-17_rk, &
                                        -1.421111175603823244e-17_rk, 3.656944912158579147e-16_rk, -1.339315945789172632e-16_rk,1.566887258652672321e-16_rk, &
                                        -4.900764432566933133e-18_rk, 1.801573910683226752e-17_rk, -2.526249213086747547e-01_rk,-8.138388509241588701e-17_rk, &
                                        -1.287398414419301802e-16_rk, -2.083041717113144099e-17_rk, 3.793235890702912473e-17_rk,-9.428090415820631343e-01_rk, &
                                        3.831742106418564571e-18_rk, 1.944574066953861902e-16_rk, -3.724900210354240507e-17_rk,-2.105990591663083460e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -2.575802203437515203e+00_rk, -3.955614407112641580e-17_rk, 3.306107169310088592e-16_rk,-2.056060799156422893e-16_rk, &
                                        1.632993161855451403e+00_rk, -3.973084290714690556e-17_rk, 4.829245349774531971e-17_rk,-8.156075525632425362e-17_rk, &
                                        -1.858299699519077455e-16_rk, -6.094413448457089544e+00_rk, -5.129159901571370420e-16_rk,-2.064220620220359647e-16_rk, &
                                        -5.331439522172189047e-16_rk, 2.575802203437513871e+00_rk, -1.797882335974022349e-16_rk,-4.975045203707227891e-16_rk, &
                                        5.137027515137163168e-17_rk, 1.066147094670586190e-15_rk, -6.901841202733893788e-01_rk,-2.408311212213341810e-16_rk, &
                                        1.149653573690781003e-16_rk, -1.835035491482359185e-16_rk, 4.375591989647142355e-01_rk,7.209455737247694609e-17_rk, &
                                        -2.640908953724054605e-17_rk, -4.314172968144033644e-16_rk, -9.033774129180358048e-17_rk,-1.632993161855450959e+00_rk, &
                                        1.441828284942547866e-17_rk, 3.748119835866058619e-16_rk, 9.996254072361969243e-17_rk,6.901841202733880465e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        4.880338717125849435e-01_rk, 1.768079036367758941e-16_rk, -3.310421152758852330e-16_rk,7.327548404333588560e-17_rk, &
                                        -4.880338717125846104e-01_rk, 2.842379872495590489e-17_rk, -1.115405883625323557e-16_rk,-4.236938823877427552e-17_rk, &
                                        -8.958453426828097662e-17_rk, 1.821367205045917537e+00_rk, 2.967164881823627197e-16_rk,2.264065091757416755e-16_rk, &
                                        2.478088221273456510e-16_rk, -1.821367205045917537e+00_rk, 8.511228549768197830e-17_rk,4.432660753335985475e-16_rk, &
                                        -7.353287238238883534e-17_rk, -4.306247983202173454e-16_rk, 4.880338717125852765e-01_rk,2.002076985124907678e-16_rk, &
                                        -1.109253276112151271e-17_rk, 7.676648943536303650e-17_rk, -4.880338717125847769e-01_rk,-6.893642487192302813e-17_rk, &
                                        2.718831861766082559e-17_rk, 3.237517505619683525e-16_rk, 1.146309051404419776e-16_rk,1.821367205045917537e+00_rk, &
                                        -1.467407819924728286e-16_rk, -1.571486117612384705e-16_rk, 2.137153348701064607e-17_rk,-1.821367205045917537e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.820188407604642944e-17_rk, -4.982611728629877345e-17_rk,-1.512328117968508837e-16_rk, &
                                        -2.526249213086746437e-01_rk, 3.365015453638198027e-16_rk, -1.745809312559447560e-16_rk,8.165410386537236798e-17_rk, &
                                        -1.452977404575619821e-16_rk, -9.428090415820638004e-01_rk, 9.788552529945051856e-17_rk,-1.704559512353838641e-16_rk, &
                                        -8.056228430549896740e-17_rk, 1.466813074386838242e-16_rk, -1.362600741734104964e-17_rk,-7.465167637085108375e-17_rk, &
                                        -7.895192892703858403e-17_rk, -4.378747758797172517e-18_rk, -7.542468251212079445e-16_rk,-1.334090436962874047e-17_rk, &
                                        -1.750609911624032312e-17_rk, 8.741087230291079680e-17_rk, -9.428090415820634673e-01_rk,-2.260796640359554506e-16_rk, &
                                        -1.657338104027374906e-16_rk, -2.672942807192407938e-16_rk, -9.896672112377794853e-17_rk,-3.518611245019579226e+00_rk, &
                                        2.255113059016877504e-17_rk, 9.104388442364502095e-17_rk, -1.826400887272489601e-17_rk,1.320822083791464948e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        2.575802203437515203e+00_rk, -6.052355356203505177e-16_rk, -4.735416862397224159e-16_rk,3.737652031605198754e-16_rk, &
                                        -4.375591989647140134e-01_rk, -5.536266568261460616e-17_rk, 3.339569719789702996e-16_rk,-1.772374614182757015e-16_rk, &
                                        3.129161540380436028e-16_rk, 1.632993161855451181e+00_rk, 6.375454151550922364e-16_rk,3.422599769434592409e-16_rk, &
                                        4.029973819782061979e-16_rk, -1.849342776560395918e-01_rk, 2.047340438764493617e-16_rk,2.228319554200738131e-16_rk, &
                                        1.836176676481840596e-16_rk, -1.456012412918601769e-16_rk, 9.613024693476676319e+00_rk,2.354769543438762212e-16_rk, &
                                        -6.138563493834567084e-17_rk, -3.636512709246243311e-16_rk, -1.632993161855452957e+00_rk,3.361942850875638451e-19_rk, &
                                        3.775858552511558045e-16_rk, 4.533532251895330738e-16_rk, 3.734887363590252229e-16_rk,6.094413448457091320e+00_rk, &
                                        -2.098345842346423058e-16_rk, -4.847738355577621173e-16_rk, 3.309187634147553030e-16_rk,-6.901841202733882685e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -6.797434948471087424e+00_rk, 3.466819726019154891e-16_rk, 3.140814009593135442e-16_rk,-4.144049963323673106e-16_rk, &
                                        4.880338717125850545e-01_rk, 1.920967236307429949e-17_rk, -3.401121213453483173e-16_rk,3.706125891938929174e-17_rk, &
                                        -4.678699218143147668e-16_rk, -1.821367205045917093e+00_rk, -4.508130096337541406e-16_rk,-1.807696779171081435e-16_rk, &
                                        -5.207725089422488752e-16_rk, 1.307682818044211825e-01_rk, -1.492171605019361757e-16_rk,-1.618951192018229127e-16_rk, &
                                        -3.745871332896659007e-16_rk, 1.861341669694437523e-16_rk, -6.797434948471090088e+00_rk,-1.585099139002783493e-16_rk, &
                                        4.778496686726750158e-17_rk, 1.731478693085089380e-16_rk, 4.880338717125853321e-01_rk,5.709682615052179666e-18_rk, &
                                        -2.618061596936772340e-16_rk, -1.582911326689236151e-16_rk, -3.279707773123648885e-16_rk,-1.821367205045917093e+00_rk, &
                                        5.113518436512773411e-17_rk, 3.604423128960644038e-16_rk, -1.890402274602012964e-16_rk,1.307682818044211270e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.632993161855452069e+00_rk, 2.987031395210738955e-16_rk, 5.263924853365515372e-16_rk,-1.613382744996296591e-16_rk, &
                                        6.901841202733888236e-01_rk, -2.903050520798870775e-16_rk, 1.664628870644020964e-17_rk,1.225553265604414349e-16_rk, &
                                        3.249912312735557753e-17_rk, -6.901841202733887126e-01_rk, -6.326755645885988494e-16_rk,-1.881461307323765584e-16_rk, &
                                        -2.325026675746065145e-16_rk, 4.375591989647141800e-01_rk, -1.336836932387496114e-16_rk,-2.542398823754720317e-16_rk, &
                                        3.729490995238517076e-18_rk, 2.336578149066182781e-16_rk, -6.094413448457095761e+00_rk,-1.918849274390679639e-16_rk, &
                                        6.016814142840476545e-17_rk, 1.858605424771575737e-16_rk, 2.575802203437516535e+00_rk,2.385220578984837214e-16_rk, &
                                        -1.521068274107500520e-16_rk, -2.391567122087216160e-16_rk, -1.515473669271382066e-16_rk,-2.575802203437514759e+00_rk, &
                                        2.437016482107727920e-16_rk, 3.763036853988530022e-16_rk, -2.131257784444942823e-16_rk,1.632993161855451181e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -9.428090415820631343e-01_rk, 2.583305120232302236e-16_rk, -3.024681810530015077e-18_rk,-6.119411686403954209e-17_rk, &
                                        5.709851920215716264e-17_rk, 9.166172398681994956e-18_rk, -1.760223294294658148e-16_rk,-2.697196900753802120e-17_rk, &
                                        -2.001175367078372044e-16_rk, 1.098977650257827148e-17_rk, -1.027553758659438932e-16_rk,1.634210502430108913e-17_rk, &
                                        -8.993243009810082698e-17_rk, -2.526249213086744216e-01_rk, -5.742434322035876222e-17_rk,1.060596033262491299e-16_rk, &
                                        -1.083952297163840112e-16_rk, -8.367782585596087943e-17_rk, -3.518611245019579226e+00_rk,-3.025112253517957849e-17_rk, &
                                        1.872359262618122852e-17_rk, 9.037985614455607150e-17_rk, 4.079118788214979771e-16_rk,-1.277858814761588387e-17_rk, &
                                        -5.974521743766827421e-17_rk, 5.309776773842923732e-17_rk, -1.229746483081091417e-16_rk,-2.283878491908544656e-16_rk, &
                                        -5.641819456629918112e-17_rk, 1.742626573526432214e-17_rk, -9.952897609753612469e-17_rk,-9.428090415820626902e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.821367205045918425e+00_rk, 8.275573446858060110e-17_rk, 2.136814724722489426e-16_rk,-7.214112007437104048e-17_rk, &
                                        1.821367205045917981e+00_rk, -5.601278145794347742e-16_rk, 4.213615866342343444e-17_rk,-1.941604837175004852e-17_rk, &
                                        1.192390319597191427e-16_rk, -4.880338717125849435e-01_rk, -4.303636230374086759e-16_rk,1.053172719014975036e-17_rk, &
                                        -1.914660420860482039e-16_rk, 4.880338717125845549e-01_rk, -1.133750245276214260e-16_rk,-1.166565850765833365e-16_rk, &
                                        5.212432137329541739e-17_rk, 2.890601709777908007e-16_rk, -1.821367205045918425e+00_rk,-1.951736405352073744e-16_rk, &
                                        1.029713363006233917e-16_rk, 1.785874948445854198e-18_rk, 1.821367205045917981e+00_rk,2.172856134967093630e-16_rk, &
                                        3.423756648011186950e-17_rk, -1.732321409027922557e-16_rk, 3.726284373918858120e-18_rk,-4.880338717125849435e-01_rk, &
                                        7.296180875252304938e-17_rk, 2.241459896354274257e-16_rk, 3.806967661652331919e-17_rk,4.880338717125846104e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.632993161855452069e+00_rk, -3.951069076731667420e-16_rk, -4.267402507639538671e-16_rk,4.638038980933313280e-16_rk, &
                                        -1.849342776560394253e-01_rk, -3.826980386477523800e-16_rk, 3.325155738054492654e-16_rk,-2.858635342911860722e-16_rk, &
                                        2.580963577877683312e-16_rk, 2.575802203437514315e+00_rk, 4.369045139896977383e-16_rk,5.290580332031440893e-16_rk, &
                                        3.936272361856044000e-16_rk, -4.375591989647144020e-01_rk, 1.609357080734317107e-16_rk,4.035432351171740513e-16_rk, &
                                        1.541743668588386078e-16_rk, -2.249003193890236866e-16_rk, 6.094413448457096649e+00_rk,2.185667361783254448e-16_rk, &
                                        -2.515594319592413769e-17_rk, -3.606822870829790934e-16_rk, -6.901841202733894898e-01_rk,2.136372701734270813e-16_rk, &
                                        4.835744482162249346e-16_rk, 7.737452736472030063e-16_rk, 3.494808091746939804e-16_rk,9.613024693476670990e+00_rk, &
                                        -2.888039093911102311e-16_rk, -5.583914542461428469e-16_rk, 2.496537961899440004e-16_rk,-1.632993161855451181e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -9.428090415820635783e-01_rk, 2.583305120232302236e-16_rk, -3.024681810529990425e-18_rk,-6.119411686403944349e-17_rk, &
                                        5.709851920215716264e-17_rk, 9.166172398681899430e-18_rk, -1.760223294294658641e-16_rk,-2.697196900753803352e-17_rk, &
                                        -2.001175367078372044e-16_rk, 1.098977650257827148e-17_rk, -1.027553758659438932e-16_rk,1.634210502430108913e-17_rk, &
                                        -8.993243009810085163e-17_rk, -2.526249213086746437e-01_rk, -5.742434322035876222e-17_rk,1.060596033262491299e-16_rk, &
                                        -1.083952297163840112e-16_rk, -8.367782585596087943e-17_rk, -3.518611245019580114e+00_rk,-3.025112253517964012e-17_rk, &
                                        1.872359262618124084e-17_rk, 9.037985614455607150e-17_rk, 4.079118788214979771e-16_rk,-1.277858814761582532e-17_rk, &
                                        -5.974521743766823724e-17_rk, 5.309776773842927430e-17_rk, -1.229746483081091664e-16_rk,1.103879780359333383e-15_rk, &
                                        -5.641819456629920577e-17_rk, 1.742626573526432214e-17_rk, -9.952897609753617399e-17_rk,-9.428090415820624681e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.821367205045918869e+00_rk, 3.401825129327679872e-16_rk, 2.700326238315759018e-16_rk,-4.275795380016300651e-16_rk, &
                                        1.307682818044212658e-01_rk, 6.131562971604936567e-16_rk, -1.713416405941053867e-16_rk,1.462728161003528093e-16_rk, &
                                        -4.377237642620451801e-16_rk, -6.797434948471085647e+00_rk, -3.125654306645053190e-16_rk,-3.798947429003772610e-16_rk, &
                                        -3.824527600926655957e-16_rk, 4.880338717125848880e-01_rk, -9.777645432992836382e-17_rk,-3.155027366793874426e-16_rk, &
                                        -7.962811427262818271e-17_rk, 8.000377956736840402e-16_rk, -1.821367205045918869e+00_rk,7.550792760562050941e-18_rk, &
                                        7.128324597965684161e-17_rk, 1.508816186391424644e-16_rk, 1.307682818044212381e-01_rk,-2.175335076159996948e-16_rk, &
                                        -3.822110657201498956e-16_rk, -5.807019963140073700e-16_rk, -8.258933844379915074e-17_rk,-6.797434948471085647e+00_rk, &
                                        1.102728251343996985e-16_rk, 6.279057876109907082e-16_rk, -4.043757639428030771e-17_rk,4.880338717125849435e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.820188407604646642e-17_rk, -4.982611728629887206e-17_rk,-1.512328117968507851e-16_rk, &
                                        -2.526249213086747547e-01_rk, 3.365015453638196055e-16_rk, -1.745809312559447067e-16_rk,8.165410386537226937e-17_rk, &
                                        -1.452977404575619575e-16_rk, -9.428090415820624681e-01_rk, 9.788552529945061717e-17_rk,-1.704559512353836669e-16_rk, &
                                        -8.056228430549886879e-17_rk, 3.565900497616817019e-17_rk, -1.362600741734104348e-17_rk,-7.465167637085088654e-17_rk, &
                                        -7.895192892703853472e-17_rk, -4.378747758797295777e-18_rk, 1.339315945789172632e-16_rk,-1.334090436962871582e-17_rk, &
                                        -1.750609911624031696e-17_rk, 8.741087230291072284e-17_rk, -9.428090415820634673e-01_rk,-2.260796640359553520e-16_rk, &
                                        -1.657338104027373920e-16_rk, -2.672942807192405473e-16_rk, -9.896672112377784992e-17_rk,-3.518611245019575673e+00_rk, &
                                        2.255113059016870108e-17_rk, 9.104388442364482374e-17_rk, -1.826400887272482822e-17_rk,-2.009846990084004673e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -6.901841202733889347e-01_rk, 8.857451157389004587e-17_rk, 4.795910498607824954e-16_rk,-2.513769694324409638e-16_rk, &
                                        4.375591989647141244e-01_rk, 3.703032088525070869e-17_rk, 1.808768687996131159e-17_rk,2.311813994333517316e-16_rk, &
                                        8.731891937763080599e-17_rk, -1.632993161855451181e+00_rk, -4.320346634232044006e-16_rk,-3.749441869920613575e-16_rk, &
                                        -2.231325217820044700e-16_rk, 6.901841202733887126e-01_rk, -8.988535743573186189e-17_rk,-4.349511620725720728e-16_rk, &
                                        3.317279178458396271e-17_rk, 3.129568930037818864e-16_rk, -2.575802203437516535e+00_rk,-1.749747092735169903e-16_rk, &
                                        2.393844968598322614e-17_rk, 1.828915586355121881e-16_rk, 1.632993161855452069e+00_rk,2.522098201014413918e-17_rk, &
                                        -2.580954203758192807e-16_rk, -5.595487606663915485e-16_rk, -1.275394397428069148e-16_rk,-6.094413448457091320e+00_rk, &
                                        3.226709733672406433e-16_rk, 4.499213040872335840e-16_rk, -1.318608112196829797e-16_rk,2.575802203437513427e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -4.880338717125849435e-01_rk, -1.768079036367758941e-16_rk, 3.310421152758852330e-16_rk,-7.327548404333588560e-17_rk, &
                                        4.880338717125846104e-01_rk, -2.842379872495590489e-17_rk, 1.115405883625323064e-16_rk,4.236938823877427552e-17_rk, &
                                        8.958453426828092732e-17_rk, -1.821367205045917537e+00_rk, -2.967164881823627197e-16_rk,-2.264065091757416755e-16_rk, &
                                        -2.478088221273456510e-16_rk, 1.821367205045917537e+00_rk, -8.511228549768197830e-17_rk,-4.432660753335985475e-16_rk, &
                                        7.353287238238885999e-17_rk, 4.306247983202173454e-16_rk, -4.880338717125852765e-01_rk,-2.002076985124907678e-16_rk, &
                                        1.109253276112151271e-17_rk, -7.676648943536303650e-17_rk, 4.880338717125847769e-01_rk,6.893642487192302813e-17_rk, &
                                        -2.718831861766082559e-17_rk, -3.237517505619683525e-16_rk, -1.146309051404419776e-16_rk,-1.821367205045917537e+00_rk, &
                                        1.467407819924728286e-16_rk, 1.571486117612384705e-16_rk, -2.137153348701065840e-17_rk,1.821367205045917537e+00_rk  &
                                        /),(/4,8/))
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        !
        ! dbr2_vol_face2_dx
        ! 
        test_dbr2_vol_face2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, -1.239485637377214636e-16_rk, 3.227069251455094328e-17_rk,-1.096694507237309619e-16_rk, &
                                        3.518611245019578782e+00_rk, -1.485469871480049323e-16_rk, -1.654321338237958852e-16_rk,7.186292059773806650e-18_rk, &
                                        -1.188947498152663803e-16_rk, 9.428090415820631343e-01_rk, 7.082374249192223858e-17_rk,-1.564228272919699905e-17_rk, &
                                        1.794692524172228747e-16_rk, -1.970701798972661588e-16_rk, -7.595896922388483756e-17_rk,-7.741559119032468289e-17_rk, &
                                        -2.617977275844185190e-16_rk, 8.787994160353567736e-19_rk, 6.834829552906300397e-17_rk,-9.788381914317637598e-17_rk, &
                                        1.650688750916364676e-16_rk, 2.865952575869552291e-17_rk, 9.428090415820635783e-01_rk,-1.690315079192739822e-16_rk, &
                                        2.289376040922302113e-16_rk, 6.779636071639015390e-17_rk, -5.194041403844272410e-17_rk,2.526249213086746437e-01_rk, &
                                        -3.621779220621288308e-16_rk, -3.576809803432180436e-17_rk, 1.577849333123354794e-16_rk,-7.633330641188293144e-18_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -2.575802203437514315e+00_rk, -3.699591843915227404e-16_rk, -1.578676388431326923e-16_rk,-3.644777635532893158e-16_rk, &
                                        6.094413448457092208e+00_rk, 4.225970245927681070e-16_rk, -4.018998005986466906e-16_rk,-3.254923556074476078e-18_rk, &
                                        -5.646122507211108755e-16_rk, -1.632993161855450737e+00_rk, -7.597193272928540701e-17_rk,-3.109788399714449001e-17_rk, &
                                        2.411902139737596478e-16_rk, 2.575802203437513427e+00_rk, -4.372909167681242712e-16_rk,3.426186969956286376e-17_rk, &
                                        -6.414000909602615588e-16_rk, 2.113263333266273194e-16_rk, -6.901841202733884906e-01_rk,-3.342500201882499251e-16_rk, &
                                        2.482902645850554554e-16_rk, -6.075960376096262014e-16_rk, 1.632993161855452291e+00_rk,1.793644515241285797e-18_rk, &
                                        1.483138533240234281e-16_rk, -2.604299596345007064e-16_rk, -2.587815268326181102e-16_rk,-4.375591989647140134e-01_rk, &
                                        -8.333181883216877061e-16_rk, -3.587969181897242084e-16_rk, -1.671975286243766239e-16_rk,6.901841202733884906e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -1.821367205045917537e+00_rk, 2.256472742221829266e-18_rk, -1.855376165503558696e-16_rk,-1.409158207910544497e-16_rk, &
                                        1.821367205045918425e+00_rk, 1.729535661417224104e-16_rk, -3.754945949384470321e-16_rk,-8.697538076026719106e-17_rk, &
                                        -2.849933097422763003e-16_rk, -4.880338717125848325e-01_rk, -3.423206251060538634e-17_rk,4.593831916086398574e-17_rk, &
                                        1.968775525941535597e-16_rk, 4.880338717125849435e-01_rk, -1.990783724535015748e-16_rk,3.165626048109285151e-17_rk, &
                                        -4.484323189047419180e-16_rk, 5.335925101096620819e-17_rk, -1.821367205045918425e+00_rk,-5.205588682839219743e-16_rk, &
                                        -1.884496240978645398e-17_rk, -1.864085898243831574e-16_rk, 1.821367205045918203e+00_rk,1.238831186466103455e-16_rk, &
                                        3.074630123374782063e-17_rk, -2.007652610693696095e-16_rk, -3.150247420764971863e-16_rk,-4.880338717125847214e-01_rk, &
                                        -1.719281315414722286e-16_rk, -3.227492291028786928e-16_rk, -1.259881515480225680e-17_rk,4.880338717125849435e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        1.632993161855451403e+00_rk, 7.139477306021717552e-16_rk, 7.339171937295420654e-17_rk,2.312888708672100415e-16_rk, &
                                        -9.613024693476674543e+00_rk, -6.074476357168374824e-16_rk, 5.333350232221312733e-16_rk,-5.682071615566298254e-17_rk, &
                                        5.819572667146461662e-16_rk, 6.901841202733878244e-01_rk, 4.669504098203179468e-18_rk,7.610192113537225456e-18_rk, &
                                        -6.364137168701353341e-16_rk, -6.094413448457092208e+00_rk, 6.696316186078513089e-16_rk,1.281853944506753372e-16_rk, &
                                        9.063044425158704453e-16_rk, -3.473011207075617766e-16_rk, 4.375591989647139024e-01_rk,2.906067868439369152e-16_rk, &
                                        -4.406162117319423828e-16_rk, 9.541349243646670914e-16_rk, -2.575802203437515647e+00_rk,1.304657187868668323e-16_rk, &
                                        -3.553856656471816680e-16_rk, 4.098525971130922922e-16_rk, 2.295827319301290774e-16_rk,1.849342776560395363e-01_rk, &
                                        1.184151294837701815e-15_rk, 1.933954126677143524e-16_rk, -2.228673423057875686e-17_rk,-1.632993161855452069e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        9.428090415820630232e-01_rk, -2.200399824729273540e-16_rk, 5.220522695562757946e-17_rk,2.428583434098101623e-16_rk, &
                                        1.142933284181068522e-15_rk, 3.333975982720739873e-16_rk, 3.399691120031148123e-17_rk,5.288934765196360266e-17_rk, &
                                        1.015497338217311389e-16_rk, 2.992170654351984338e-16_rk, 4.786861391600012842e-19_rk,3.912997461280420197e-17_rk, &
                                        2.157542504791527129e-16_rk, 3.518611245019576117e+00_rk, -1.563817326158418797e-16_rk,-8.503167295991356741e-17_rk, &
                                        -3.106623971190145629e-18_rk, 1.350959879648990018e-16_rk, 2.526249213086746992e-01_rk,1.415270524874894474e-16_rk, &
                                        2.725707205525039816e-17_rk, -3.751984125137360432e-16_rk, -4.723416877499200750e-17_rk,3.677214461716576551e-17_rk, &
                                        -2.186579176907186042e-17_rk, -2.172189981949815178e-16_rk, 8.113920894093179395e-17_rk,-2.927762672630833549e-18_rk, &
                                        1.134481554611497431e-17_rk, 2.011696035563316850e-16_rk, 3.169932954262002459e-17_rk,9.428090415820626902e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -4.880338717125846659e-01_rk, -1.938823913641920241e-16_rk, -5.520033511485288804e-17_rk,1.361181849075040990e-17_rk, &
                                        6.797434948471087424e+00_rk, -6.441138918755756886e-17_rk, -5.737763876527567876e-16_rk,7.182882445445401153e-17_rk, &
                                        -3.486863896253240159e-16_rk, -1.307682818044211270e-01_rk, 1.781384441787304262e-16_rk,6.931992650734612295e-18_rk, &
                                        3.201879090087493491e-16_rk, 1.821367205045917093e+00_rk, -7.776108355575986154e-16_rk,-2.204366163481411068e-16_rk, &
                                        -6.382282972308269824e-16_rk, 1.398480643644470605e-16_rk, -4.880338717125846659e-01_rk,-1.657642048400771748e-16_rk, &
                                        2.667428708636154822e-16_rk, -5.000390175737040785e-16_rk, 6.797434948471087424e+00_rk,-7.187671775608646941e-17_rk, &
                                        2.140245167958085711e-16_rk, -4.817434566779515767e-17_rk, -3.060364597401414628e-16_rk,-1.307682818044213213e-01_rk, &
                                        -7.263097927438712218e-16_rk, -3.905009551315118625e-17_rk, 4.669210425118861735e-16_rk,1.821367205045917093e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -1.632993161855451403e+00_rk, -4.660506031267287293e-16_rk, -1.379331044020561424e-16_rk,-1.194996941974829017e-17_rk, &
                                        2.575802203437516091e+00_rk, 9.045416100128471992e-16_rk, -2.024707555745393550e-16_rk,4.244813203611531993e-17_rk, &
                                        -3.441677670841135042e-16_rk, -2.575802203437513427e+00_rk, -1.463169890820476073e-16_rk,2.367437334485685892e-17_rk, &
                                        2.774752120356895354e-16_rk, 6.094413448457091320e+00_rk, -5.177136801600813873e-16_rk,2.664578792997401006e-17_rk, &
                                        -3.827089873470333086e-16_rk, 3.455435218754910137e-16_rk, -4.375591989647142355e-01_rk,-9.483914855758423724e-17_rk, &
                                        1.104784615486693736e-16_rk, -1.011453975882058088e-15_rk, 6.901841202733884906e-01_rk,2.075972970516810828e-16_rk, &
                                        -1.024895425372786313e-16_rk, -5.454453185458724521e-16_rk, -1.257019038532436045e-16_rk,-6.901841202733884906e-01_rk, &
                                        -4.597954507134439565e-16_rk, -1.218592165990707683e-16_rk, -2.932831323940922019e-16_rk,1.632993161855451625e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        9.428090415820630232e-01_rk, -2.200399824729274279e-16_rk, 5.220522695562757946e-17_rk,2.428583434098101623e-16_rk, &
                                        -1.893343453691193265e-16_rk, 3.333975982720741352e-16_rk, 3.399691120031148123e-17_rk,5.288934765196350405e-17_rk, &
                                        1.015497338217312622e-16_rk, 2.992170654351984338e-16_rk, 4.786861391600074472e-19_rk,3.912997461280430058e-17_rk, &
                                        2.157542504791526390e-16_rk, 3.518611245019576117e+00_rk, -1.563817326158419783e-16_rk,-8.503167295991346880e-17_rk, &
                                        -3.106623971190083999e-18_rk, 1.350959879648990264e-16_rk, 2.526249213086746992e-01_rk,1.415270524874893981e-16_rk, &
                                        2.725707205525029956e-17_rk, -3.751984125137362404e-16_rk, -4.723416877499200750e-17_rk,3.677214461716574085e-17_rk, &
                                        -2.186579176907190973e-17_rk, -2.172189981949815671e-16_rk, 8.113920894093178162e-17_rk,-1.139500651351464876e-16_rk, &
                                        1.134481554611517152e-17_rk, 2.011696035563316850e-16_rk, 3.169932954261998761e-17_rk,9.428090415820626902e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -4.880338717125848880e-01_rk, 2.595639346204168738e-17_rk, -1.252258029227538941e-16_rk,1.603297648425807868e-16_rk, &
                                        4.880338717125850545e-01_rk, 4.067615877109179740e-16_rk, -4.590461271473717592e-17_rk,-1.223590839972904872e-16_rk, &
                                        -1.935830963555119128e-16_rk, -1.821367205045917093e+00_rk, -1.814956049500033698e-16_rk,8.694056612648408925e-17_rk, &
                                        -1.369542108438086350e-19_rk, 1.821367205045917537e+00_rk, -1.996217691075568797e-16_rk,-4.147753840494140301e-17_rk, &
                                        -1.303308560501297966e-16_rk, 4.619649468094841166e-17_rk, -4.880338717125848880e-01_rk,-1.599204773829440917e-16_rk, &
                                        -4.017422443878731612e-18_rk, -3.359960097241413224e-16_rk, 4.880338717125851655e-01_rk,2.674677779125678847e-16_rk, &
                                        -2.873610642123896907e-16_rk, -5.847326839427873970e-16_rk, -3.556100980120782159e-16_rk,-1.821367205045917537e+00_rk, &
                                        -7.263563602443590313e-17_rk, 2.448257843190796558e-17_rk, -1.600620159680620132e-16_rk,1.821367205045917537e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, -1.239485637377214883e-16_rk, 3.227069251455094944e-17_rk,-1.096694507237307647e-16_rk, &
                                        3.518611245019578782e+00_rk, -1.485469871480047351e-16_rk, -1.654321338237959345e-16_rk,7.186292059773855954e-18_rk, &
                                        -1.188947498152663803e-16_rk, 9.428090415820626902e-01_rk, 7.082374249192216462e-17_rk,-1.564228272919706068e-17_rk, &
                                        1.794692524172229733e-16_rk, 6.911082398028590489e-16_rk, -7.595896922388508408e-17_rk,-7.741559119032465823e-17_rk, &
                                        -2.617977275844184204e-16_rk, 8.787994160353999144e-19_rk, 6.834829552906300397e-17_rk,-9.788381914317630202e-17_rk, &
                                        1.650688750916364923e-16_rk, 2.865952575869542431e-17_rk, 9.428090415820635783e-01_rk,-1.690315079192739329e-16_rk, &
                                        2.289376040922301126e-16_rk, 6.779636071639005529e-17_rk, -5.194041403844272410e-17_rk,2.526249213086744216e-01_rk, &
                                        -3.621779220621289294e-16_rk, -3.576809803432177971e-17_rk, 1.577849333123354547e-16_rk,4.364558792088743230e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        6.901841202733882685e-01_rk, 8.100391493373775469e-16_rk, 5.345718493187753953e-17_rk,-1.212389232663309595e-16_rk, &
                                        -6.094413448457093097e+00_rk, -1.089392221136916328e-15_rk, 3.339059781980237405e-16_rk,-1.025237717478526306e-16_rk, &
                                        3.615127830776484990e-16_rk, 1.632993161855450293e+00_rk, 7.501456045096537979e-17_rk,-4.716206522846398789e-17_rk, &
                                        -6.726987149320649751e-16_rk, -9.613024693476663884e+00_rk, 7.500543819998081785e-16_rk,1.358014762202641231e-16_rk, &
                                        6.476133389026418007e-16_rk, -4.815183092564253229e-16_rk, 1.849342776560392032e-01_rk,5.119591521327114115e-17_rk, &
                                        -3.028044086955560791e-16_rk, 1.357992862637098386e-15_rk, -1.632993161855452291e+00_rk,-7.533793374957281681e-17_rk, &
                                        -1.045822697858796333e-16_rk, 6.948679560244637420e-16_rk, 9.650310895075458397e-17_rk,4.375591989647142355e-01_rk, &
                                        8.106285572294575726e-16_rk, -4.354228892293917392e-17_rk, 1.037988695391365993e-16_rk,-2.575802203437513871e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.307682818044211825e-01_rk, -5.979130443495762269e-16_rk, 1.426280686286436992e-17_rk,9.891953169110542328e-16_rk, &
                                        1.821367205045918869e+00_rk, 6.322611182699907004e-16_rk, -1.952305554571099558e-16_rk,-1.541466719989124792e-16_rk, &
                                        1.658315275931072024e-16_rk, -4.880338717125841663e-01_rk, 4.992115550825153895e-17_rk,3.517435667749616111e-16_rk, &
                                        3.988707714570781768e-16_rk, 6.797434948471085647e+00_rk, -5.560849618941703550e-16_rk,-4.675629594389884607e-16_rk, &
                                        -1.523688730338809001e-16_rk, 3.133434525434242774e-16_rk, -1.307682818044211825e-01_rk,-2.704729156710164533e-17_rk, &
                                        -4.277393657783799174e-17_rk, -7.490593464836355607e-16_rk, 1.821367205045918647e+00_rk,4.519646550794999247e-16_rk, &
                                        -1.971725152783947307e-16_rk, -5.289168341220533304e-16_rk, -7.430138343857709518e-17_rk,-4.880338717125849435e-01_rk, &
                                        -2.097215361178416922e-16_rk, 2.756640224941525608e-16_rk, 9.826895320029951816e-17_rk,6.797434948471085647e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.150093178071874552e-17_rk, 1.724479062817617381e-17_rk,5.924195936587400785e-18_rk, &
                                        9.428090415820635783e-01_rk, -1.846226199287597239e-16_rk, -2.078295778318567177e-16_rk,1.301252948308872191e-16_rk, &
                                        9.220159359816425202e-18_rk, 2.526249213086745882e-01_rk, 1.834759323925814201e-16_rk,-4.093232212856753099e-17_rk, &
                                        4.703463054800469964e-17_rk, 1.970701798972661588e-16_rk, -3.327410191146214433e-16_rk,-4.912758637820370814e-17_rk, &
                                        -9.733999722174826856e-17_rk, 6.534286057593104759e-17_rk, 1.536963093959683041e-16_rk,9.375167983083161448e-17_rk, &
                                        2.638756438215127366e-17_rk, -1.446554490153593227e-16_rk, 3.518611245019578782e+00_rk,-7.092128612636062665e-17_rk, &
                                        1.255955402278239406e-16_rk, 3.116076787800424588e-16_rk, 8.699426982861823517e-17_rk,9.428090415820633563e-01_rk, &
                                        -1.000395068405818602e-16_rk, -9.156286539143443748e-18_rk, 2.855590390279175953e-16_rk,-4.364558792088743230e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -6.901841202733887126e-01_rk, 2.544087068925695717e-16_rk, -2.321027205224512555e-16_rk,2.881879717429669948e-16_rk, &
                                        1.632993161855451625e+00_rk, 6.407440122207675976e-17_rk, -5.673103856934154137e-16_rk,-1.554771286855150962e-16_rk, &
                                        -2.218715838696048520e-16_rk, -4.375591989647142355e-01_rk, 2.518661451188315217e-17_rk,1.624424008657659635e-16_rk, &
                                        2.635468914945427200e-16_rk, 6.901841202733880465e-01_rk, -5.352562190861036894e-16_rk,-1.746944317078332503e-16_rk, &
                                        -5.362323652691972127e-16_rk, -4.311587564988574050e-18_rk, -2.575802203437515647e+00_rk,-6.322252386809462617e-16_rk, &
                                        -8.916611983951435767e-17_rk, -2.471915553746461125e-16_rk, 6.094413448457093097e+00_rk,3.117073069999841955e-16_rk, &
                                        -1.566887871135218663e-16_rk, -4.710278479214546352e-16_rk, -6.545855036303814452e-16_rk,-1.632993161855451625e+00_rk, &
                                        2.523536246220887376e-17_rk, -1.079402089662259942e-16_rk, 3.663622119000644749e-16_rk,2.575802203437513871e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        1.821367205045917537e+00_rk, -2.256472742221829266e-18_rk, 1.855376165503558696e-16_rk,1.409158207910544497e-16_rk, &
                                        -1.821367205045918425e+00_rk, -1.729535661417224104e-16_rk, 3.754945949384470321e-16_rk,8.697538076026719106e-17_rk, &
                                        2.849933097422763989e-16_rk, 4.880338717125848325e-01_rk, 3.423206251060537402e-17_rk,-4.593831916086398574e-17_rk, &
                                        -1.968775525941535597e-16_rk, -4.880338717125849435e-01_rk, 1.990783724535015748e-16_rk,-3.165626048109285151e-17_rk, &
                                        4.484323189047419180e-16_rk, -5.335925101096620819e-17_rk, 1.821367205045918425e+00_rk,5.205588682839221715e-16_rk, &
                                        1.884496240978642933e-17_rk, 1.864085898243831574e-16_rk, -1.821367205045918203e+00_rk,-1.238831186466103455e-16_rk, &
                                        -3.074630123374782063e-17_rk, 2.007652610693696095e-16_rk, 3.150247420764971863e-16_rk,4.880338717125847214e-01_rk, &
                                        1.719281315414722286e-16_rk, 3.227492291028787421e-16_rk, 1.259881515480220749e-17_rk,-4.880338717125849435e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        4.375591989647141244e-01_rk, -1.856382218771256299e-17_rk, 1.257829225704711743e-16_rk,-8.503630732333496665e-16_rk, &
                                        -2.575802203437515647e+00_rk, 1.291663322186649916e-16_rk, 6.816709500042505972e-16_rk,1.257384570424941076e-16_rk, &
                                        -4.580141275652195367e-18_rk, 1.849342776560396473e-01_rk, -2.676891718851082353e-16_rk,-2.986170684347540680e-16_rk, &
                                        -2.376580463750671982e-16_rk, -1.632993161855452513e+00_rk, 9.640572859066619245e-16_rk,4.917916408302714195e-16_rk, &
                                        4.211172682830129082e-16_rk, -1.097718769510145522e-16_rk, 1.632993161855452069e+00_rk,3.310352288470754700e-16_rk, &
                                        1.069559674136803774e-16_rk, 4.145027573497687642e-16_rk, -9.613024693476674543e+00_rk,-4.360025554502554452e-16_rk, &
                                        1.703903958323745435e-16_rk, 1.742393735090161937e-16_rk, 4.785133234598207231e-16_rk,6.901841202733889347e-01_rk, &
                                        1.128729325845657288e-16_rk, -1.048759690944512592e-16_rk, -6.986172722042738931e-16_rk,-6.094413448457092208e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        2.526249213086745327e-01_rk, -2.043439529241381522e-16_rk, 8.907500732380389509e-17_rk,5.562509055537947040e-16_rk, &
                                        1.893343453691193265e-16_rk, -8.618113511982052161e-18_rk, 9.346901352102150958e-17_rk,-1.003866231878661319e-16_rk, &
                                        2.172315657854405483e-16_rk, 1.448721444148641824e-16_rk, 5.902662498064363217e-17_rk,1.771069896975554938e-16_rk, &
                                        -7.292347566748025840e-17_rk, 9.428090415820626902e-01_rk, -9.606004770593654537e-17_rk,-2.679696227442343071e-16_rk, &
                                        2.124550942079322772e-16_rk, 4.874060394007204169e-17_rk, 9.428090415820633563e-01_rk,2.074383300030393620e-16_rk, &
                                        -4.417741195631725638e-17_rk, -2.265575295976325500e-17_rk, 4.723416877499200750e-17_rk,1.952165345766316175e-16_rk, &
                                        -1.392971489466765685e-16_rk, -1.481920436760379544e-17_rk, 8.907791034194275809e-17_rk,-1.080945397898848205e-16_rk, &
                                        -3.806878820619264375e-17_rk, 2.219724645998206109e-16_rk, 4.669602127629171192e-17_rk,3.518611245019576117e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        4.880338717125846659e-01_rk, 1.938823913641920241e-16_rk, 5.520033511485288804e-17_rk,-1.361181849075040990e-17_rk, &
                                        -6.797434948471087424e+00_rk, 6.441138918755756886e-17_rk, 5.737763876527567876e-16_rk,-7.182882445445401153e-17_rk, &
                                        3.486863896253240159e-16_rk, 1.307682818044211270e-01_rk, -1.781384441787304262e-16_rk,-6.931992650734612295e-18_rk, &
                                        -3.201879090087493491e-16_rk, -1.821367205045917093e+00_rk, 7.776108355575986154e-16_rk,2.204366163481411068e-16_rk, &
                                        6.382282972308269824e-16_rk, -1.398480643644470605e-16_rk, 4.880338717125846659e-01_rk,1.657642048400771255e-16_rk, &
                                        -2.667428708636154822e-16_rk, 5.000390175737040785e-16_rk, -6.797434948471087424e+00_rk,7.187671775608646941e-17_rk, &
                                        -2.140245167958085711e-16_rk, 4.817434566779515767e-17_rk, 3.060364597401414628e-16_rk,1.307682818044213213e-01_rk, &
                                        7.263097927438712218e-16_rk, 3.905009551315113694e-17_rk, -4.669210425118861735e-16_rk,-1.821367205045917093e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -4.375591989647140134e-01_rk, 8.156568574914998008e-17_rk, -1.602725038268234972e-16_rk,8.385146813601745198e-16_rk, &
                                        6.901841202733889347e-01_rk, 2.400789076388542589e-16_rk, -2.660117943405370138e-16_rk,-3.859890467042683732e-16_rk, &
                                        -1.386017744398077830e-17_rk, -6.901841202733887126e-01_rk, -9.926269290005460496e-17_rk,3.804817126918890437e-16_rk, &
                                        1.435887852790576757e-16_rk, 1.632993161855451625e+00_rk, -2.985752476774190380e-16_rk,-3.935364680738638430e-16_rk, &
                                        -2.264372738395165190e-16_rk, -2.091384420084754297e-17_rk, -1.632993161855452513e+00_rk,-5.185385885087386251e-16_rk, &
                                        -1.597310961779828754e-16_rk, -1.251918593190502419e-16_rk, 2.575802203437515647e+00_rk,5.778451277029765752e-16_rk, &
                                        -4.215814762880223261e-16_rk, -7.974547310691008895e-16_rk, -6.525018631170569716e-16_rk,-2.575802203437514315e+00_rk, &
                                        8.720608109659801629e-17_rk, 1.231885421727380727e-16_rk, 1.274991941484385792e-16_rk,6.094413448457091320e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        2.526249213086745327e-01_rk, -2.043439529241382755e-16_rk, 8.907500732380389509e-17_rk,5.562509055537947040e-16_rk, &
                                        -2.547548644809432897e-16_rk, -8.618113511982101465e-18_rk, 9.346901352102150958e-17_rk,-1.003866231878662305e-16_rk, &
                                        2.172315657854406222e-16_rk, 1.448721444148641824e-16_rk, 5.902662498064363217e-17_rk,1.771069896975554938e-16_rk, &
                                        -7.292347566748039398e-17_rk, 9.428090415820626902e-01_rk, -9.606004770593664398e-17_rk,-2.679696227442342084e-16_rk, &
                                        2.124550942079324005e-16_rk, 4.874060394007206635e-17_rk, 9.428090415820638004e-01_rk,2.074383300030394113e-16_rk, &
                                        -4.417741195631725638e-17_rk, -2.265575295976325500e-17_rk, 4.723416877499200750e-17_rk,1.952165345766315928e-16_rk, &
                                        -1.392971489466765685e-16_rk, -1.481920436760374614e-17_rk, 8.907791034194277042e-17_rk,-4.411614471774318073e-16_rk, &
                                        -3.806878820619254514e-17_rk, 2.219724645998206109e-16_rk, 4.669602127629174890e-17_rk,3.518611245019576117e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        4.880338717125848880e-01_rk, -2.595639346204168738e-17_rk, 1.252258029227538941e-16_rk,-1.603297648425807868e-16_rk, &
                                        -4.880338717125850545e-01_rk, -4.067615877109179740e-16_rk, 4.590461271473717592e-17_rk,1.223590839972904872e-16_rk, &
                                        1.935830963555119128e-16_rk, 1.821367205045917093e+00_rk, 1.814956049500033698e-16_rk,-8.694056612648408925e-17_rk, &
                                        1.369542108438086350e-19_rk, -1.821367205045917537e+00_rk, 1.996217691075568797e-16_rk,4.147753840494140301e-17_rk, &
                                        1.303308560501297966e-16_rk, -4.619649468094841166e-17_rk, 4.880338717125848880e-01_rk,1.599204773829440917e-16_rk, &
                                        4.017422443878731612e-18_rk, 3.359960097241413224e-16_rk, -4.880338717125851655e-01_rk,-2.674677779125678847e-16_rk, &
                                        2.873610642123896907e-16_rk, 5.847326839427873970e-16_rk, 3.556100980120782159e-16_rk,1.821367205045917537e+00_rk, &
                                        7.263563602443590313e-17_rk, -2.448257843190801489e-17_rk, 1.600620159680620132e-16_rk,-1.821367205045917537e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.150093178071870854e-17_rk, 1.724479062817616764e-17_rk,5.924195936587795215e-18_rk, &
                                        9.428090415820635783e-01_rk, -1.846226199287596252e-16_rk, -2.078295778318568656e-16_rk,1.301252948308870712e-16_rk, &
                                        9.220159359816523810e-18_rk, 2.526249213086744771e-01_rk, 1.834759323925813955e-16_rk,-4.093232212856746937e-17_rk, &
                                        4.703463054800479824e-17_rk, 1.970701798972661588e-16_rk, -3.327410191146215419e-16_rk,-4.912758637820383140e-17_rk, &
                                        -9.733999722174816996e-17_rk, 6.534286057593104759e-17_rk, 1.536963093959683041e-16_rk,9.375167983083154053e-17_rk, &
                                        2.638756438215121203e-17_rk, -1.446554490153592241e-16_rk, 3.518611245019578782e+00_rk,-7.092128612636047874e-17_rk, &
                                        1.255955402278238420e-16_rk, 3.116076787800421630e-16_rk, 8.699426982861803796e-17_rk,9.428090415820626902e-01_rk, &
                                        -1.000395068405818109e-16_rk, -9.156286539143369792e-18_rk, 2.855590390279175953e-16_rk,1.783990170041438856e-15_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        1.849342776560395363e-01_rk, 1.542791989557069054e-16_rk, 5.395270587484343451e-17_rk,-1.400689782850556698e-15_rk, &
                                        -1.632993161855452069e+00_rk, -4.683817419811265544e-17_rk, 3.803723586513722466e-16_rk,3.562503750612474586e-16_rk, &
                                        -2.125915477012763184e-16_rk, 4.375591989647139024e-01_rk, -1.432398644731704227e-16_rk,-5.166563802608769511e-16_rk, &
                                        -1.176999401595820553e-16_rk, -2.575802203437513871e+00_rk, 7.273763144979770759e-16_rk,7.106336771963017658e-16_rk, &
                                        1.113221768533324364e-16_rk, -9.316962031515551550e-17_rk, 6.901841202733884906e-01_rk,2.173485786748675869e-16_rk, &
                                        1.775209437521489074e-16_rk, 2.925030612941726225e-16_rk, -6.094413448457093097e+00_rk,-7.021403761532473319e-16_rk, &
                                        4.352830850068749540e-16_rk, 5.006662566566622261e-16_rk, 4.764296829464960523e-16_rk,1.632993161855452069e+00_rk, &
                                        5.090221395017638909e-17_rk, -3.360047202334151905e-16_rk, -4.597542544526480220e-16_rk,-9.613024693476663884e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        1.307682818044211825e-01_rk, 5.979130443495762269e-16_rk, -1.426280686286436992e-17_rk,-9.891953169110542328e-16_rk, &
                                        -1.821367205045918869e+00_rk, -6.322611182699907004e-16_rk, 1.952305554571099558e-16_rk,1.541466719989124792e-16_rk, &
                                        -1.658315275931073010e-16_rk, 4.880338717125841663e-01_rk, -4.992115550825151430e-17_rk,-3.517435667749616111e-16_rk, &
                                        -3.988707714570781768e-16_rk, -6.797434948471085647e+00_rk, 5.560849618941703550e-16_rk,4.675629594389884607e-16_rk, &
                                        1.523688730338809001e-16_rk, -3.133434525434242774e-16_rk, 1.307682818044211825e-01_rk,2.704729156710159602e-17_rk, &
                                        4.277393657783804104e-17_rk, 7.490593464836355607e-16_rk, -1.821367205045918647e+00_rk,-4.519646550794999247e-16_rk, &
                                        1.971725152783947307e-16_rk, 5.289168341220533304e-16_rk, 7.430138343857709518e-17_rk,4.880338717125849435e-01_rk, &
                                        2.097215361178416922e-16_rk, -2.756640224941525608e-16_rk, -9.826895320029946886e-17_rk,-6.797434948471085647e+00_rk  &
                                        /),(/4,8/))
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face3_dx
        ! 
        test_dbr2_vol_face3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.704460580814656840e-16_rk, 3.777055431973655925e-18_rk,1.021541571137367074e-17_rk, &
                                        1.148838135662629639e-16_rk, 3.518611245019578782e+00_rk, 2.047680445054255826e-16_rk,1.125179099524491250e-16_rk, &
                                        9.428090415820631343e-01_rk, -4.632255647480433812e-17_rk, -6.599596617258054892e-17_rk,1.474948142144216212e-16_rk, &
                                        2.481879570770967779e-17_rk, 3.734937404263677307e-16_rk, -1.366862205461753406e-16_rk,-7.935472833226150238e-18_rk, &
                                        -2.165913908713513198e-17_rk, -2.880529163762949391e-16_rk, -1.295702266381289941e-16_rk,1.263913340575457318e-16_rk, &
                                        2.182048567185138238e-16_rk, 2.235144864965457438e-16_rk, 1.192845872155809831e-18_rk,9.428090415820633563e-01_rk, &
                                        -1.514361134144936962e-16_rk, 1.619856371309171687e-16_rk, 2.526249213086747547e-01_rk,2.909420291283164081e-17_rk, &
                                        -1.295069816930964497e-16_rk, -3.539342682346536725e-16_rk, -1.549844914523159130e-17_rk,3.948745726654736675e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        9.613024693476670990e+00_rk, 4.537074845833742455e-16_rk, -4.111389504308409221e-16_rk,5.685068434140608409e-16_rk, &
                                        -1.475819626949117679e-16_rk, 6.094413448457092208e+00_rk, 6.546636483751265983e-16_rk,1.377168798846136774e-16_rk, &
                                        -1.632993161855450515e+00_rk, -4.736931569213214543e-16_rk, 3.604157680095199044e-16_rk,-5.988981350651218183e-16_rk, &
                                        6.649053421754080357e-16_rk, -6.901841202733878244e-01_rk, 4.928694025907733926e-17_rk,-1.222163735050009582e-16_rk, &
                                        6.291669017197018757e-16_rk, -7.010883904816229655e-16_rk, 2.575802203437516535e+00_rk,-3.213616561026658364e-16_rk, &
                                        -1.385791809861910837e-16_rk, 3.326390784759476367e-16_rk, -7.872706040420387339e-16_rk,1.632993161855452069e+00_rk, &
                                        -1.116130205896958507e-17_rk, 8.603451294360961006e-17_rk, -4.375591989647135138e-01_rk,-1.681794133754051940e-16_rk, &
                                        -8.027291586710089502e-17_rk, -1.014145640464313587e-15_rk, 4.020791798202757108e-16_rk,-1.849342776560389812e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        6.797434948471087424e+00_rk, 1.837132527504303408e-16_rk, -3.632480010298676257e-16_rk,3.306603605572236516e-16_rk, &
                                        -2.602391079968264494e-16_rk, 1.821367205045918203e+00_rk, 7.957717728847889825e-16_rk,-1.072594286166868416e-17_rk, &
                                        -4.880338717125843884e-01_rk, -6.855403299920164640e-17_rk, 6.438682887550549819e-16_rk,-1.685103172782623105e-16_rk, &
                                        4.837172749655797274e-16_rk, -1.307682818044211548e-01_rk, 1.985046966101219931e-16_rk,9.340487161674570919e-17_rk, &
                                        6.928531025977583461e-16_rk, -4.443494702569660255e-16_rk, 6.797434948471090088e+00_rk,-7.404055840406646174e-17_rk, &
                                        4.807177261278828674e-17_rk, 1.275662826855946632e-16_rk, -8.940713975429508100e-16_rk,1.821367205045918425e+00_rk, &
                                        9.567501942517713040e-17_rk, -1.834747081676100425e-16_rk, -4.880338717125841663e-01_rk,-1.293668397907501551e-16_rk, &
                                        -3.689672522800263435e-17_rk, -4.307524290362141239e-16_rk, 4.249195594911227812e-16_rk,-1.307682818044209605e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -6.094413448457094873e+00_rk, -1.086856045977458710e-16_rk, 2.690683803086731842e-16_rk,-4.728565826743607230e-16_rk, &
                                        -1.733785433079779979e-16_rk, -9.613024693476674543e+00_rk, -6.857710465110487736e-16_rk,-3.404894600630649284e-16_rk, &
                                        6.901841202733880465e-01_rk, 5.820780580718684811e-16_rk, -2.948785773490929115e-16_rk,2.766620674336152501e-16_rk, &
                                        -4.221044284192179879e-16_rk, 1.632993161855450293e+00_rk, 2.328655438719606462e-16_rk,3.577807412510014909e-16_rk, &
                                        -4.276630749561908758e-16_rk, 1.059622120733566747e-15_rk, -1.632993161855452513e+00_rk,1.383387114200418090e-16_rk, &
                                        -1.064189598916854796e-16_rk, -7.315453035035618081e-16_rk, 7.306502343546664273e-16_rk,-2.575802203437515203e+00_rk, &
                                        2.176568754914887098e-16_rk, -4.194209599516465679e-16_rk, 1.849342776560388701e-01_rk,1.781280814317218233e-16_rk, &
                                        2.100510779392833676e-16_rk, 1.390362936555912015e-15_rk, -4.424605400440045315e-16_rk,4.375591989647135138e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.518611245019578782e+00_rk, -1.745758219041627152e-16_rk, 1.382935146901940913e-16_rk,-1.058656764510739119e-16_rk, &
                                        2.060766924366268018e-16_rk, 1.115090422042327224e-15_rk, -1.736606463695033333e-16_rk,9.025467022600202740e-17_rk, &
                                        -1.911142933676037233e-16_rk, -6.206234467574259626e-17_rk, 4.587755121534574980e-19_rk,1.747412534170849963e-16_rk, &
                                        -2.676197094638997934e-16_rk, -9.428090415820624681e-01_rk, -1.454662635848626017e-16_rk,-2.276288949127742345e-16_rk, &
                                        -1.798446876763759358e-16_rk, -7.048081387564863331e-17_rk, -9.428090415820631343e-01_rk,5.663161062507852974e-17_rk, &
                                        2.679328415936286888e-17_rk, 1.753917385310684277e-16_rk, 5.542752381521717472e-17_rk,2.352669092780066075e-17_rk, &
                                        -5.505946001802544079e-17_rk, 1.714008098771197152e-16_rk, -4.143020581997434579e-17_rk,-3.904287096914823931e-17_rk, &
                                        -2.711803790860659687e-19_rk, -2.228302785694457323e-17_rk, 5.587980936896025179e-17_rk,-2.526249213086745327e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.821367205045918425e+00_rk, -2.353517213715178634e-16_rk, -1.040497699196071744e-16_rk,3.735018939004113782e-16_rk, &
                                        -4.849121276854336738e-17_rk, 6.797434948471087424e+00_rk, 5.304148142693700412e-16_rk,-1.458637317482462106e-18_rk, &
                                        -1.307682818044212658e-01_rk, -4.429501616742076837e-16_rk, 2.700085779804133658e-16_rk,1.685103172782622612e-16_rk, &
                                        2.548438702408482657e-16_rk, -4.880338717125841663e-01_rk, -7.793602174119626469e-17_rk,-2.847828951096234012e-16_rk, &
                                        1.380536809644430490e-16_rk, -6.576159463594179312e-16_rk, 1.821367205045918425e+00_rk,2.490103858737946570e-16_rk, &
                                        1.553830315018341992e-16_rk, 8.414649833097778090e-16_rk, -6.382219687793764757e-16_rk,6.797434948471089200e+00_rk, &
                                        -1.138791834598803169e-16_rk, 1.296755710203359443e-16_rk, -1.307682818044209050e-01_rk,-3.168533742181371736e-16_rk, &
                                        -2.457415631830394946e-16_rk, -8.917452804494728345e-16_rk, 2.861964210541006426e-16_rk,-4.880338717125846659e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        6.094413448457094873e+00_rk, 4.495777207606771896e-16_rk, -2.766224911726204775e-16_rk,4.524257512516134308e-16_rk, &
                                        -5.638908382454789299e-17_rk, 2.575802203437516091e+00_rk, 2.762349575001977564e-16_rk,1.154536401581666538e-16_rk, &
                                        -2.575802203437513871e+00_rk, -4.894329451222599404e-16_rk, 4.268705096942538122e-16_rk,-5.716516958624584926e-16_rk, &
                                        3.724668370037985954e-16_rk, -1.632993161855450737e+00_rk, 4.050689722038996104e-17_rk,-3.419097955845491904e-16_rk, &
                                        4.709813531304611520e-16_rk, -4.835162879809770665e-16_rk, 1.632993161855453401e+00_rk,-3.911213795351331247e-16_rk, &
                                        -3.299907535453420941e-16_rk, 2.845163305104704685e-16_rk, -7.330359260989777264e-16_rk,6.901841202733891567e-01_rk, &
                                        8.521535133749865804e-17_rk, 9.544968568981221816e-17_rk, -6.901841202733883796e-01_rk,-2.363164872573850926e-16_rk, &
                                        4.896288544690943325e-17_rk, -6.824944000866047683e-16_rk, 4.734574383344675908e-16_rk,-4.375591989647136248e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.518611245019578337e+00_rk, -1.745758219041626166e-16_rk, 1.382935146901941406e-16_rk,-1.058656764510738872e-16_rk, &
                                        2.060766924366268018e-16_rk, -2.171772075078606249e-16_rk, -1.736606463695034319e-16_rk,9.025467022600201507e-17_rk, &
                                        -1.911142933676037233e-16_rk, -6.206234467574257161e-17_rk, 4.587755121534081942e-19_rk,1.747412534170849963e-16_rk, &
                                        -2.676197094638998427e-16_rk, -9.428090415820626902e-01_rk, -1.454662635848626510e-16_rk,-2.276288949127743331e-16_rk, &
                                        -1.798446876763759358e-16_rk, -7.048081387564862099e-17_rk, -9.428090415820640224e-01_rk,5.663161062507848044e-17_rk, &
                                        2.679328415936283190e-17_rk, 1.753917385310685756e-16_rk, 5.542752381521712542e-17_rk,2.352669092780066075e-17_rk, &
                                        -5.505946001802534218e-17_rk, 1.714008098771197399e-16_rk, -1.524525082824899998e-16_rk,-3.904287096914823931e-17_rk, &
                                        -2.711803790860413168e-19_rk, -2.228302785694452392e-17_rk, 5.587980936896025179e-17_rk,-2.526249213086745327e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.821367205045918869e+00_rk, 1.374071689598717751e-16_rk, -1.326316882098659415e-16_rk,8.954304691861707121e-17_rk, &
                                        -4.292823189847279636e-17_rk, 4.880338717125851655e-01_rk, 1.437267559387205284e-16_rk,-8.161174695082627399e-17_rk, &
                                        -1.821367205045917093e+00_rk, -2.748964473814271443e-16_rk, 3.306992031117888725e-16_rk,-2.886658208098730813e-16_rk, &
                                        2.650841605716355817e-16_rk, -4.880338717125846104e-01_rk, 2.190228901823373387e-16_rk,-4.978378669677194166e-17_rk, &
                                        2.022117659119524327e-16_rk, -1.937856352260769957e-16_rk, 1.821367205045918869e+00_rk,-1.015262453446747083e-16_rk, &
                                        -1.849270766666524802e-16_rk, 1.064428348089919922e-17_rk, -4.719692616726654513e-16_rk,4.880338717125849435e-01_rk, &
                                        1.660072788834885836e-16_rk, -2.323699582284959498e-17_rk, -1.821367205045917759e+00_rk,-4.667275496690610573e-16_rk, &
                                        1.005309299120279045e-16_rk, -1.995996983158481172e-16_rk, 4.630432610941900423e-16_rk,-4.880338717125845549e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.704460580814656347e-16_rk, 3.777055431973662088e-18_rk,1.021541571137367074e-17_rk, &
                                        1.148838135662629146e-16_rk, 3.518611245019578782e+00_rk, 2.047680445054255333e-16_rk,1.125179099524491003e-16_rk, &
                                        9.428090415820624681e-01_rk, -4.632255647480430114e-17_rk, -6.599596617258049962e-17_rk,1.474948142144215473e-16_rk, &
                                        2.481879570770970244e-17_rk, 4.042683303882078091e-17_rk, -1.366862205461752420e-16_rk,-7.935472833226187216e-18_rk, &
                                        -2.165913908713505803e-17_rk, -2.880529163762948405e-16_rk, -1.295702266381289941e-16_rk,1.263913340575456332e-16_rk, &
                                        2.182048567185137252e-16_rk, 2.235144864965456452e-16_rk, 1.192845872155587964e-18_rk,9.428090415820633563e-01_rk, &
                                        -1.514361134144936962e-16_rk, 1.619856371309171687e-16_rk, 2.526249213086745327e-01_rk,2.909420291283160383e-17_rk, &
                                        -1.295069816930963511e-16_rk, -3.539342682346536725e-16_rk, -1.549844914523141874e-17_rk,-7.153484519596828729e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -2.575802203437515203e+00_rk, -1.045558407750488151e-16_rk, 1.345519210504527149e-16_rk,-3.567754905119131158e-16_rk, &
                                        -2.645714221783418358e-16_rk, -6.094413448457093097e+00_rk, -3.073423556361198331e-16_rk,-3.182262203366177322e-16_rk, &
                                        1.632993161855450959e+00_rk, 5.978178462728066714e-16_rk, -3.613333190338268687e-16_rk,2.494156282309518257e-16_rk, &
                                        -1.296659232476083504e-16_rk, 2.575802203437512983e+00_rk, 2.416455869106479319e-16_rk,5.774741633305494766e-16_rk, &
                                        -2.694775263669499549e-16_rk, 8.420500182329202568e-16_rk, -6.901841202733893788e-01_rk,2.080984348525088262e-16_rk, &
                                        8.499261266746540757e-17_rk, -6.834225555380845906e-16_rk, 6.764155564116046310e-16_rk,-1.632993161855452069e+00_rk, &
                                        1.212802220950203865e-16_rk, -4.288361326978491144e-16_rk, 4.375591989647138469e-01_rk,2.462651553137017219e-16_rk, &
                                        8.081527662527301463e-17_rk, 1.058711696178202703e-15_rk, -5.138387985581961650e-16_rk,6.901841202733881575e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        4.880338717125849435e-01_rk, 9.643346999984217850e-17_rk, -3.142273746001801576e-17_rk,2.017392658399135766e-16_rk, &
                                        1.496003125042637667e-16_rk, 1.821367205045918647e+00_rk, -6.879442204790847157e-17_rk,2.081160517477337983e-16_rk, &
                                        -4.880338717125846104e-01_rk, -3.110198898510837621e-16_rk, 3.177384308055285980e-16_rk,2.133976712087798501e-16_rk, &
                                        3.552814591548237668e-17_rk, -1.821367205045916871e+00_rk, -1.024672712171130444e-16_rk,-3.496800093545153458e-16_rk, &
                                        4.768826564283538928e-17_rk, -3.709395267709138514e-16_rk, 4.880338717125852765e-01_rk,1.249851091007767181e-16_rk, &
                                        9.160095506191320589e-17_rk, 4.670659452660085862e-16_rk, -3.176254273325586335e-16_rk,1.821367205045918425e+00_rk, &
                                        8.361995462751552137e-17_rk, 3.056480476440273676e-16_rk, -4.880338717125847214e-01_rk,-1.389291092837174869e-16_rk, &
                                        -6.662121588484138499e-18_rk, -5.254533987719139330e-16_rk, 5.229714613792611989e-16_rk,-1.821367205045917315e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.313428101943248896e-17_rk, 1.643341281038812839e-17_rk,1.905738105673663031e-16_rk, &
                                        -1.188174350631009043e-16_rk, 9.428090415820635783e-01_rk, 6.866170374403579677e-17_rk,-5.584110259752292682e-17_rk, &
                                        2.526249213086748102e-01_rk, -7.250936450520744331e-17_rk, 2.308121358773417829e-17_rk,1.757775332243763522e-16_rk, &
                                        -3.205977444192848245e-17_rk, 1.816177718862105395e-16_rk, -7.329543980873411413e-17_rk,-1.582339902982937795e-16_rk, &
                                        -2.370747784719145152e-17_rk, -3.992464194595665132e-17_rk, -7.586081930619962876e-16_rk,1.214754949313220421e-16_rk, &
                                        2.243072847375076540e-17_rk, 3.639644643026075526e-16_rk, -1.187512624579318488e-16_rk,3.518611245019578782e+00_rk, &
                                        -4.647350207081581604e-17_rk, -5.386012418745945390e-17_rk, 9.428090415820639114e-01_rk,7.688284287325911200e-17_rk, &
                                        -1.153446463127977588e-16_rk, -1.354865664603429670e-16_rk, -1.095511506785285538e-16_rk,7.153484519596828729e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        2.575802203437515203e+00_rk, -2.631549681465955005e-16_rk, -2.699303631549841729e-16_rk,2.265397406724010509e-16_rk, &
                                        -2.850950225504322198e-16_rk, 1.632993161855451625e+00_rk, 9.474176611661122822e-16_rk,-2.116252857807178247e-16_rk, &
                                        -4.375591989647132363e-01_rk, -1.308510914165298160e-16_rk, 9.749160438516555704e-16_rk,2.756257876263238202e-16_rk, &
                                        3.868188247515457995e-16_rk, -1.849342776560392587e-01_rk, 3.312045752928188103e-16_rk,1.773644027273647336e-17_rk, &
                                        5.912793575960956166e-16_rk, -5.293484886411333385e-16_rk, 9.613024693476676319e+00_rk,3.209395301275684527e-16_rk, &
                                        1.856721391027872024e-16_rk, 4.502991294591251124e-16_rk, -1.262161039559545029e-15_rk,6.094413448457094873e+00_rk, &
                                        1.833263418747372166e-16_rk, -2.702434952847126616e-16_rk, -1.632993161855451181e+00_rk,-5.688483108670787049e-16_rk, &
                                        -7.458635684381916124e-17_rk, -3.667277218027011556e-16_rk, 7.286402841107809905e-16_rk,-6.901841202733881575e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -6.797434948471087424e+00_rk, -1.837132527504303408e-16_rk, 3.632480010298676257e-16_rk,-3.306603605572236516e-16_rk, &
                                        2.602391079968264987e-16_rk, -1.821367205045918203e+00_rk, -7.957717728847891797e-16_rk,1.072594286166868416e-17_rk, &
                                        4.880338717125843884e-01_rk, 6.855403299920164640e-17_rk, -6.438682887550549819e-16_rk,1.685103172782623105e-16_rk, &
                                        -4.837172749655797274e-16_rk, 1.307682818044211548e-01_rk, -1.985046966101220178e-16_rk,-9.340487161674570919e-17_rk, &
                                        -6.928531025977583461e-16_rk, 4.443494702569660255e-16_rk, -6.797434948471090088e+00_rk,7.404055840406643709e-17_rk, &
                                        -4.807177261278831139e-17_rk, -1.275662826855946632e-16_rk, 8.940713975429508100e-16_rk,-1.821367205045918425e+00_rk, &
                                        -9.567501942517713040e-17_rk, 1.834747081676100671e-16_rk, 4.880338717125841663e-01_rk,1.293668397907501551e-16_rk, &
                                        3.689672522800265900e-17_rk, 4.307524290362141239e-16_rk, -4.249195594911227812e-16_rk,1.307682818044209605e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.632993161855452069e+00_rk, 2.434295535052949280e-16_rk, 1.571545709955360433e-16_rk,-4.318182473782381398e-16_rk, &
                                        3.201889166162741139e-16_rk, -2.575802203437515647e+00_rk, -5.783993920580905755e-16_rk,2.029764002075444025e-16_rk, &
                                        1.849342776560389257e-01_rk, 3.127473628321673232e-16_rk, -7.669298478237208540e-16_rk,-5.467117958821166251e-16_rk, &
                                        -3.054611873681008008e-16_rk, 4.375591989647135693e-01_rk, -1.905560796712502542e-16_rk,2.261769790887958507e-16_rk, &
                                        -2.912161362313409078e-16_rk, 4.468836478659328623e-16_rk, -6.094413448457095761e+00_rk,-5.265158135566657610e-16_rk, &
                                        -2.120893635064578345e-16_rk, -8.789343688518196260e-16_rk, 1.028730971309267590e-15_rk,-9.613024693476674543e+00_rk, &
                                        -1.833880817558771057e-16_rk, 1.496424118822312035e-16_rk, 6.901841202733881575e-01_rk,4.596841426266819408e-16_rk, &
                                        1.682807295175399050e-16_rk, 5.468949582911552016e-16_rk, -6.325424887966330836e-16_rk,1.632993161855451403e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -9.428090415820631343e-01_rk, 1.128596956607330367e-16_rk, 9.634237934905990572e-17_rk,1.470469613847075502e-17_rk, &
                                        8.372354099725899784e-17_rk, 2.171772075078606249e-16_rk, -4.376799728520575774e-16_rk,6.448998817069634900e-17_rk, &
                                        -1.419526140199432388e-16_rk, -1.093869069104299283e-16_rk, -2.310674096156690364e-16_rk,9.530847503141637868e-17_rk, &
                                        -4.929786294151669494e-17_rk, -2.526249213086744216e-01_rk, -6.735305581283457751e-17_rk,-8.567942906323851989e-17_rk, &
                                        -2.763557435175634114e-16_rk, 1.223894827211573740e-16_rk, -3.518611245019579226e+00_rk,8.410078849777508132e-17_rk, &
                                        3.986495929919835842e-18_rk, 6.467077509008699801e-17_rk, 3.521813307082097312e-16_rk,-2.352669092780066075e-17_rk, &
                                        4.653524195195562505e-17_rk, 1.744612075899409244e-16_rk, -6.959209664254130826e-17_rk,3.228132536713778766e-17_rk, &
                                        2.165027363907702126e-17_rk, -4.468067002811074621e-17_rk, 1.345335536438038186e-17_rk,-9.428090415820628012e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.821367205045918425e+00_rk, 2.353517213715178634e-16_rk, 1.040497699196071744e-16_rk,-3.735018939004113782e-16_rk, &
                                        4.849121276854335505e-17_rk, -6.797434948471087424e+00_rk, -5.304148142693700412e-16_rk,1.458637317482462106e-18_rk, &
                                        1.307682818044212658e-01_rk, 4.429501616742076837e-16_rk, -2.700085779804133658e-16_rk,-1.685103172782622859e-16_rk, &
                                        -2.548438702408482657e-16_rk, 4.880338717125841663e-01_rk, 7.793602174119628934e-17_rk,2.847828951096234012e-16_rk, &
                                        -1.380536809644430490e-16_rk, 6.576159463594179312e-16_rk, -1.821367205045918425e+00_rk,-2.490103858737947063e-16_rk, &
                                        -1.553830315018341992e-16_rk, -8.414649833097778090e-16_rk, 6.382219687793764757e-16_rk,-6.797434948471089200e+00_rk, &
                                        1.138791834598803169e-16_rk, -1.296755710203359443e-16_rk, 1.307682818044209050e-01_rk,3.168533742181371736e-16_rk, &
                                        2.457415631830394946e-16_rk, 8.917452804494728345e-16_rk, -2.861964210541006426e-16_rk,4.880338717125846659e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.632993161855452069e+00_rk, -5.716099146642990082e-17_rk, -1.900213966163122939e-16_rk,5.067062624350555827e-17_rk, &
                                        -8.255404649007235462e-17_rk, 6.901841202733889347e-01_rk, 4.410759845700189327e-16_rk,-9.129419501249857355e-17_rk, &
                                        -6.901841202733884906e-01_rk, -1.677286338217524612e-16_rk, 7.207674206482522140e-16_rk,1.951567294333638466e-16_rk, &
                                        3.695807362519577041e-16_rk, -4.375591989647139024e-01_rk, 3.371469592887183099e-16_rk,9.029100150779160974e-17_rk, &
                                        3.386310919257236999e-16_rk, -3.670343639740195104e-16_rk, 6.094413448457096649e+00_rk,2.835648236940215782e-16_rk, &
                                        1.672279065589562790e-16_rk, 1.510054402466045701e-16_rk, -7.912284463934034980e-16_rk,2.575802203437516091e+00_rk, &
                                        2.763350858975086145e-16_rk, -4.192216350731230797e-17_rk, -2.575802203437515203e+00_rk,-6.134498283732000662e-16_rk, &
                                        6.240856310805561268e-17_rk, -2.759218253704691198e-16_rk, 8.516447901536899200e-16_rk,-1.632993161855451403e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -9.428090415820635783e-01_rk, 1.128596956607331353e-16_rk, 9.634237934905995502e-17_rk,1.470469613847073654e-17_rk, &
                                        8.372354099725899784e-17_rk, -2.269120023422019912e-16_rk, -4.376799728520576760e-16_rk,6.448998817069633667e-17_rk, &
                                        -1.419526140199432388e-16_rk, -1.093869069104299529e-16_rk, -2.310674096156691350e-16_rk,9.530847503141637868e-17_rk, &
                                        -4.929786294151664563e-17_rk, -2.526249213086746437e-01_rk, -6.735305581283462682e-17_rk,-8.567942906323861850e-17_rk, &
                                        -2.763557435175634114e-16_rk, 1.223894827211573494e-16_rk, -3.518611245019580114e+00_rk,8.410078849777522923e-17_rk, &
                                        3.986495929919798864e-18_rk, 6.467077509008704732e-17_rk, 3.521813307082098298e-16_rk,-2.352669092780066075e-17_rk, &
                                        4.653524195195567435e-17_rk, 1.744612075899408997e-16_rk, -4.026590040300882704e-16_rk,3.228132536713778766e-17_rk, &
                                        2.165027363907704591e-17_rk, -4.468067002811079551e-17_rk, 1.345335536438038186e-17_rk,-9.428090415820628012e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.821367205045918869e+00_rk, -1.374071689598717751e-16_rk, 1.326316882098659415e-16_rk,-8.954304691861707121e-17_rk, &
                                        4.292823189847277171e-17_rk, -4.880338717125851655e-01_rk, -1.437267559387205284e-16_rk,8.161174695082627399e-17_rk, &
                                        1.821367205045917093e+00_rk, 2.748964473814271443e-16_rk, -3.306992031117888725e-16_rk,2.886658208098730813e-16_rk, &
                                        -2.650841605716355817e-16_rk, 4.880338717125846104e-01_rk, -2.190228901823373141e-16_rk,4.978378669677194166e-17_rk, &
                                        -2.022117659119524327e-16_rk, 1.937856352260769957e-16_rk, -1.821367205045918869e+00_rk,1.015262453446746837e-16_rk, &
                                        1.849270766666524802e-16_rk, -1.064428348089919922e-17_rk, 4.719692616726654513e-16_rk,-4.880338717125849435e-01_rk, &
                                        -1.660072788834885836e-16_rk, 2.323699582284957033e-17_rk, 1.821367205045917759e+00_rk,4.667275496690610573e-16_rk, &
                                        -1.005309299120279045e-16_rk, 1.995996983158481172e-16_rk, -4.630432610941900423e-16_rk,4.880338717125845549e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.313428101943253826e-17_rk, 1.643341281038812223e-17_rk,1.905738105673663031e-16_rk, &
                                        -1.188174350631009043e-16_rk, 9.428090415820635783e-01_rk, 6.866170374403584608e-17_rk,-5.584110259752290217e-17_rk, &
                                        2.526249213086745882e-01_rk, -7.250936450520746796e-17_rk, 2.308121358773432620e-17_rk,1.757775332243764755e-16_rk, &
                                        -3.205977444192840849e-17_rk, 7.059546942369487313e-17_rk, -7.329543980873395389e-17_rk,-1.582339902982937302e-16_rk, &
                                        -2.370747784719132826e-17_rk, -3.992464194595657736e-17_rk, 1.295702266381289941e-16_rk,1.214754949313221407e-16_rk, &
                                        2.243072847375076540e-17_rk, 3.639644643026074540e-16_rk, -1.187512624579319968e-16_rk,3.518611245019578782e+00_rk, &
                                        -4.647350207081571743e-17_rk, -5.386012418745945390e-17_rk, 9.428090415820628012e-01_rk,7.688284287325893944e-17_rk, &
                                        -1.153446463127977588e-16_rk, -1.354865664603429670e-16_rk, -1.095511506785283319e-16_rk,-2.615320621915786625e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -6.901841202733889347e-01_rk, 3.743557682512930373e-17_rk, 7.724560445686428751e-17_rk,-2.559491329493424746e-16_rk, &
                                        1.176479405559142487e-16_rk, -1.632993161855452069e+00_rk, -7.205771546199705343e-17_rk,8.264530943932513905e-17_rk, &
                                        4.375591989647136804e-01_rk, 3.496249052373897465e-16_rk, -5.127812246203174976e-16_rk,-4.662427376891565775e-16_rk, &
                                        -2.882230988685125082e-16_rk, 6.901841202733884906e-01_rk, -1.964984636671496552e-16_rk,1.536224178537406404e-16_rk, &
                                        -3.856787056096889236e-17_rk, 2.845695231988186891e-16_rk, -2.575802203437516535e+00_rk,-4.891411071231187386e-16_rk, &
                                        -1.936451309626268371e-16_rk, -5.796406796392991331e-16_rk, 5.577983781431254677e-16_rk,-6.094413448457094873e+00_rk, &
                                        -2.763968257786484051e-16_rk, -7.867891989516918716e-17_rk, 1.632993161855451625e+00_rk,5.042856601328032035e-16_rk, &
                                        3.128580956566510640e-17_rk, 4.560890618589227713e-16_rk, -7.555469948395418158e-16_rk,2.575802203437513871e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -4.880338717125849435e-01_rk, -9.643346999984217850e-17_rk, 3.142273746001801576e-17_rk,-2.017392658399135766e-16_rk, &
                                        -1.496003125042637914e-16_rk, -1.821367205045918647e+00_rk, 6.879442204790866878e-17_rk,-2.081160517477337983e-16_rk, &
                                        4.880338717125846104e-01_rk, 3.110198898510837621e-16_rk, -3.177384308055285980e-16_rk,-2.133976712087798254e-16_rk, &
                                        -3.552814591548237668e-17_rk, 1.821367205045916871e+00_rk, 1.024672712171130198e-16_rk,3.496800093545153458e-16_rk, &
                                        -4.768826564283538928e-17_rk, 3.709395267709138514e-16_rk, -4.880338717125852765e-01_rk,-1.249851091007766934e-16_rk, &
                                        -9.160095506191318124e-17_rk, -4.670659452660085862e-16_rk, 3.176254273325586335e-16_rk,-1.821367205045918425e+00_rk, &
                                        -8.361995462751552137e-17_rk, -3.056480476440273676e-16_rk, 4.880338717125847214e-01_rk,1.389291092837174869e-16_rk, &
                                        6.662121588484138499e-18_rk, 5.254533987719139330e-16_rk, -5.229714613792611989e-16_rk,1.821367205045917315e+00_rk  &
                                        /),(/4,8/))
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        
        !
        ! dbr2_vol_face4_dx
        ! 
        test_dbr2_vol_face4_dx(:,:,1,1) = reshape((/                                                                                 &
                                        1.942890293094023946e-16_rk, 4.875668992816844047e-17_rk, -3.928983049370785747e-17_rk,1.014275314779435814e-17_rk, &
                                        3.315862555173642326e-16_rk, -9.428090415820638004e-01_rk, -2.594307871477038048e-16_rk,-1.466833303115447053e-16_rk, &
                                        -3.518611245019578782e+00_rk, -1.475751544812350931e-16_rk, 1.417577562477056668e-16_rk,-2.137466053596199853e-17_rk, &
                                        3.620726916074154405e-17_rk, -2.413725491905395699e-16_rk, 8.785124758557472863e-17_rk,9.820755570007746385e-18_rk, &
                                        3.531857119577406711e-16_rk, 3.124504555984645637e-17_rk, 1.161577733221894205e-16_rk,-7.680455984082679261e-17_rk, &
                                        3.785327007619781691e-17_rk, -5.235295844075137651e-17_rk, -1.232074565824446458e-16_rk,-2.526249213086746437e-01_rk, &
                                        1.224396634093248074e-17_rk, 1.077828577456162938e-16_rk, -9.428090415820631343e-01_rk,-3.403101791437646484e-17_rk, &
                                        2.792486524830811500e-16_rk, 4.406683445118325310e-17_rk, -1.675541038817473706e-17_rk,-2.501195059266425621e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -2.575802203437515203e+00_rk, -9.119146210419935681e-16_rk, -7.338021279957648115e-17_rk,3.297202325264896227e-17_rk, &
                                        -3.699871885653204502e-16_rk, -1.632993161855451403e+00_rk, -7.621035326676347701e-16_rk,-2.208434467115038204e-16_rk, &
                                        6.094413448457089544e+00_rk, 2.704771566371851383e-16_rk, 2.722103060331313606e-17_rk,3.342762139433457372e-16_rk, &
                                        -9.662242517620408858e-17_rk, 2.575802203437513427e+00_rk, -2.155107838237692254e-16_rk,-1.571088230313972832e-16_rk, &
                                        -6.926581291097201191e-16_rk, 2.724100115934622688e-16_rk, -6.901841202733889347e-01_rk,-1.079417993001281822e-16_rk, &
                                        6.212970502573533195e-17_rk, -6.460898008551802929e-16_rk, -6.231136143468355182e-17_rk,-4.375591989647137914e-01_rk, &
                                        3.697559027024955312e-16_rk, -3.982601726376596352e-16_rk, 1.632993161855451403e+00_rk,-1.319680297459009628e-16_rk, &
                                        -7.571622849420611680e-16_rk, 5.373545668035571188e-17_rk, -1.288080548700600118e-16_rk,6.901841202733884906e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -1.821367205045917981e+00_rk, -3.569059186639249319e-16_rk, -1.670431165955388797e-16_rk,-1.705716731556966223e-17_rk, &
                                        -1.146752469451860538e-16_rk, -4.880338717125848325e-01_rk, -5.530314382642847058e-16_rk,-4.341785870099337406e-17_rk, &
                                        1.821367205045917093e+00_rk, -1.077676971334791818e-16_rk, -4.609322930346099473e-17_rk,1.221693652047778999e-16_rk, &
                                        -9.279597252281509943e-17_rk, 4.880338717125849435e-01_rk, -1.586740200975866681e-16_rk,1.098587938348624461e-16_rk, &
                                        -2.756240039448056003e-16_rk, 3.036055865063744921e-16_rk, -1.821367205045918203e+00_rk,-4.961381051807501785e-16_rk, &
                                        1.686444217533532679e-16_rk, -3.014403288865862992e-16_rk, -1.125158080629238871e-16_rk,-4.880338717125850545e-01_rk, &
                                        3.904761721912870604e-16_rk, -4.156883077315575488e-17_rk, 1.821367205045917093e+00_rk,-1.222606528536645069e-16_rk, &
                                        -3.948658514245391755e-16_rk, -9.280224134125509920e-17_rk, -1.442176123851656812e-16_rk,4.880338717125849435e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,1) = reshape((/                                                                                 &
                                        1.632993161855452291e+00_rk, 8.625328545991920154e-16_rk, 7.875601518277739488e-17_rk,-1.688092408693339517e-16_rk, &
                                        -4.622567305669865167e-17_rk, 2.575802203437515647e+00_rk, 8.210659033695616681e-16_rk,3.780839784427063793e-16_rk, &
                                        -2.575802203437514315e+00_rk, -6.867381417129909771e-17_rk, -2.684170257051322189e-16_rk,-3.563498013023441736e-16_rk, &
                                        -1.779169019546604370e-17_rk, -6.094413448457092208e+00_rk, -1.731005547152153127e-16_rk,2.705948058012887409e-17_rk, &
                                        3.082758133011862816e-16_rk, -4.358443195691529269e-16_rk, 4.375591989647141800e-01_rk,2.572666463286019032e-16_rk, &
                                        -3.283492706301563735e-17_rk, 1.114480136212146798e-15_rk, 1.075456331586721724e-16_rk,6.901841202733887126e-01_rk, &
                                        -2.817380358591747672e-16_rk, 5.876322718848124738e-16_rk, -6.901841202733887126e-01_rk,9.111048136916905326e-17_rk, &
                                        4.587240886174414313e-16_rk, -1.842302764716906835e-16_rk, 4.939190491192498852e-18_rk,-1.632993161855452069e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,2) = reshape((/                                                                                 &
                                        9.428090415820631343e-01_rk, 6.250765146331738897e-19_rk, 3.391402811050693141e-17_rk,1.256944644688905573e-16_rk, &
                                        8.462660610465498022e-17_rk, 1.297328479166248766e-16_rk, 2.004684164457771533e-16_rk,-1.055720141965764412e-17_rk, &
                                        -8.485409481778606382e-17_rk, -5.422818798465113237e-17_rk, 9.943823885411333593e-17_rk,4.344824789496027475e-17_rk, &
                                        7.820684621092858823e-17_rk, 3.518611245019576117e+00_rk, 3.007600909534098094e-16_rk,1.202285868812606873e-16_rk, &
                                        3.119660385079357309e-17_rk, 1.321892624158439676e-16_rk, 2.526249213086745882e-01_rk,-7.252028718764684213e-17_rk, &
                                        -6.714804803891748685e-17_rk, -4.160373769162147586e-16_rk, 7.797318485845600056e-17_rk,8.249792707778541065e-18_rk, &
                                        -1.002618331842533556e-16_rk, -2.971549569927687503e-16_rk, -1.325278031449227877e-17_rk,7.488856629110838672e-17_rk, &
                                        1.918954384153883325e-17_rk, 8.642798534015166926e-17_rk, 1.406242747670422253e-16_rk,9.428090415820626902e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -4.880338717125848325e-01_rk, -2.120240527217439213e-16_rk, -1.273557227452977468e-16_rk,6.462829047274749264e-17_rk, &
                                        3.665629999965041005e-16_rk, -1.821367205045917759e+00_rk, -5.654094516532508558e-16_rk,-4.829011753810292866e-16_rk, &
                                        4.880338717125848325e-01_rk, -1.127754536478651536e-16_rk, 2.016816168300281839e-16_rk,6.156605345064983371e-17_rk, &
                                        2.484624952394261185e-17_rk, 1.821367205045917093e+00_rk, 3.372836837333732599e-17_rk,2.290183907676081946e-18_rk, &
                                        -1.362715566902808326e-17_rk, 1.936698871253923104e-16_rk, -4.880338717125848325e-01_rk,-4.341628546644248494e-16_rk, &
                                        1.727590083960208573e-16_rk, -9.123382497620551651e-16_rk, -3.117549448768268484e-16_rk,-1.821367205045918425e+00_rk, &
                                        2.557769475700078991e-16_rk, -2.034028091012150488e-16_rk, 4.880338717125849435e-01_rk,-1.279903119349511886e-16_rk, &
                                        -9.320332512260388303e-17_rk, 1.587237205641934075e-16_rk, 5.772655939856678224e-17_rk,1.821367205045917093e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -1.632993161855452735e+00_rk, -9.600462344555289703e-16_rk, -1.763541953617045876e-19_rk,1.485237345737451368e-16_rk, &
                                        -6.169468379780296656e-16_rk, -6.901841202733884906e-01_rk, -3.022043290741541572e-16_rk,-8.471731781961677158e-17_rk, &
                                        9.613024693476670990e+00_rk, 3.638241231337691854e-16_rk, -1.509848679027912701e-17_rk,3.990991223742681707e-16_rk, &
                                        -5.462284812601704440e-17_rk, 6.094413448457092208e+00_rk, -2.601940455934101439e-18_rk,-4.670099172014436686e-17_rk, &
                                        -1.014647237216667525e-15_rk, 3.733542284494599402e-16_rk, -4.375591989647141800e-01_rk,-1.036575266469482810e-16_rk, &
                                        -4.287161308937994717e-17_rk, -1.009774219330643700e-15_rk, 1.388692800062171438e-16_rk,-1.849342776560394253e-01_rk, &
                                        2.572501031773096825e-16_rk, -8.031979873760448889e-16_rk, 2.575802203437514759e+00_rk,-2.304844554041614824e-17_rk, &
                                        -1.017221393583603534e-15_rk, 9.609660756932420201e-17_rk, 2.857163028515696911e-17_rk,1.632993161855451625e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,2) = reshape((/                                                                                 &
                                        9.428090415820631343e-01_rk, 6.250765146331738897e-19_rk, 3.391402811050696839e-17_rk,1.256944644688905573e-16_rk, &
                                        8.462660610465502952e-17_rk, 4.627997553041718387e-16_rk, 2.004684164457771533e-16_rk,-1.055720141965769342e-17_rk, &
                                        -8.485409481778606382e-17_rk, -5.422818798465110772e-17_rk, 9.943823885411336058e-17_rk,4.344824789496033638e-17_rk, &
                                        7.820684621092857590e-17_rk, 3.518611245019576117e+00_rk, 3.007600909534098587e-16_rk,1.202285868812607367e-16_rk, &
                                        3.119660385079357309e-17_rk, 1.321892624158439676e-16_rk, 2.526249213086745882e-01_rk,-7.252028718764689143e-17_rk, &
                                        -6.714804803891747453e-17_rk, -4.160373769162149558e-16_rk, 7.797318485845600056e-17_rk,8.249792707778541065e-18_rk, &
                                        -1.002618331842533556e-16_rk, -2.971549569927688489e-16_rk, 4.308364295355703374e-16_rk,7.488856629110838672e-17_rk, &
                                        1.918954384153883325e-17_rk, 8.642798534015164461e-17_rk, 1.406242747670422253e-16_rk,9.428090415820626902e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -4.880338717125852765e-01_rk, -3.277533290123383497e-16_rk, -1.554058122287938457e-16_rk,7.770145143001536701e-17_rk, &
                                        -5.494875229829454122e-16_rk, -1.307682818044210438e-01_rk, -2.119350596196579873e-16_rk,-1.202501506301744878e-16_rk, &
                                        6.797434948471084759e+00_rk, 2.548770587989355556e-16_rk, 1.322550648803153591e-16_rk,1.116466485620896462e-16_rk, &
                                        -2.094748380510887340e-16_rk, 1.821367205045917537e+00_rk, -2.781184789743383831e-16_rk,-1.934004485312855925e-16_rk, &
                                        -7.944106920346336942e-16_rk, 2.556000262687125175e-16_rk, -4.880338717125847214e-01_rk,-1.491562471556623402e-16_rk, &
                                        -1.433678741616139768e-16_rk, -3.315529156069799529e-16_rk, 3.228888551602466562e-16_rk,-1.307682818044214323e-01_rk, &
                                        3.824997608504909563e-16_rk, -7.550606288784641956e-16_rk, 6.797434948471085647e+00_rk,7.298255478701871119e-17_rk, &
                                        -7.615629558961345046e-16_rk, -5.998584929495645075e-17_rk, -1.299951601619633753e-16_rk,1.821367205045917537e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,1) = reshape((/                                                                                 &
                                        1.942890293094023946e-16_rk, 4.875668992816834186e-17_rk, -3.928983049370783282e-17_rk,1.014275314779440744e-17_rk, &
                                        3.315862555173640354e-16_rk, -9.428090415820633563e-01_rk, -2.594307871477037061e-16_rk,-1.466833303115448039e-16_rk, &
                                        -3.518611245019577005e+00_rk, -1.475751544812349699e-16_rk, 1.417577562477056668e-16_rk,-2.137466053596194923e-17_rk, &
                                        3.620726916074151939e-17_rk, 6.468058705095856132e-16_rk, 8.785124758557465467e-17_rk,9.820755570007746385e-18_rk, &
                                        3.531857119577405725e-16_rk, 3.124504555984654265e-17_rk, 5.135470859673769504e-18_rk,-7.680455984082681726e-17_rk, &
                                        3.785327007619779226e-17_rk, -5.235295844075147511e-17_rk, -1.232074565824446458e-16_rk,-2.526249213086746437e-01_rk, &
                                        1.224396634093255469e-17_rk, 1.077828577456161952e-16_rk, -9.428090415820631343e-01_rk,-3.403101791437644018e-17_rk, &
                                        2.792486524830809528e-16_rk, 4.406683445118324077e-17_rk, -1.675541038817473706e-17_rk,1.939697039234200540e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,2) = reshape((/                                                                                 &
                                        6.901841202733887126e-01_rk, 9.106644680127273189e-16_rk, 5.552156578562605995e-18_rk,-2.843609521904301509e-16_rk, &
                                        2.007339763560104405e-16_rk, 1.632993161855450959e+00_rk, 3.611666997760806115e-16_rk,2.419578495508192319e-16_rk, &
                                        -6.094413448457089544e+00_rk, -1.620207806678828983e-16_rk, -2.260975083115398387e-16_rk,-4.211727097332664099e-16_rk, &
                                        -5.979126724565306322e-17_rk, -9.613024693476663884e+00_rk, -3.860093980830503935e-16_rk,-8.334835073112414083e-17_rk, &
                                        6.302649214081329975e-16_rk, -5.367885364251502532e-16_rk, 1.849342776560397028e-01_rk,2.529823736754218665e-16_rk, &
                                        7.216639105209964176e-17_rk, 1.478164554687610205e-15_rk, -9.363500828222844931e-17_rk,4.375591989647140134e-01_rk, &
                                        -1.692322363339887953e-16_rk, 9.925700866231973331e-16_rk, -1.632993161855451847e+00_rk,-1.780910283631581062e-17_rk, &
                                        7.187831972589835015e-16_rk, -2.265914273606590504e-16_rk, -1.524404946640244389e-16_rk,-2.575802203437513871e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.307682818044213768e-01_rk, -5.508252082841792071e-16_rk, -2.974923644850261495e-18_rk,6.861550478234723110e-16_rk, &
                                        1.385034003095222340e-16_rk, -4.880338717125841663e-01_rk, -5.369805648922211369e-17_rk,-3.675570857852264092e-16_rk, &
                                        1.821367205045917537e+00_rk, -6.326385017291473689e-17_rk, 1.668022774659179576e-16_rk,2.740935002557190676e-16_rk, &
                                        -1.665222986139922422e-18_rk, 6.797434948471085647e+00_rk, 3.311723180057900439e-16_rk,-1.390260509290820249e-16_rk, &
                                        -1.335704195355036045e-16_rk, 5.304005969076513388e-16_rk, -1.307682818044216544e-01_rk,-3.244251775868593135e-16_rk, &
                                        -8.205519747746536054e-17_rk, -1.070595739072650283e-15_rk, 8.944549045129043977e-17_rk,-4.880338717125844994e-01_rk, &
                                        1.476575376396899280e-17_rk, -7.405465721561578159e-16_rk, 1.821367205045917537e+00_rk,-1.737131867273017548e-16_rk, &
                                        -2.091209954484977488e-16_rk, 1.421968670715962864e-16_rk, 3.036632355162598602e-16_rk,6.797434948471085647e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.387778780781445676e-16_rk, 3.307626611872240896e-17_rk, 5.912423898037742346e-17_rk,-1.938687391222177694e-17_rk, &
                                        3.161592811908881627e-16_rk, -2.526249213086746992e-01_rk, 9.486647564958055559e-18_rk,-1.097496684940351901e-16_rk, &
                                        -9.428090415820638004e-01_rk, -1.123944301901692974e-16_rk, -9.266577056966357174e-17_rk,-1.403766787319501049e-17_rk, &
                                        1.294827608385700204e-16_rk, 2.413725491905395699e-16_rk, 1.326577728656130204e-16_rk,1.285534176422661974e-16_rk, &
                                        1.989116212451925246e-16_rk, -7.503626690791465593e-17_rk, 2.169091340653575417e-16_rk,-1.247255450115919124e-16_rk, &
                                        1.856821922956691660e-16_rk, -3.583242897539973647e-16_rk, -3.255534780617693468e-16_rk,-9.428090415820635783e-01_rk, &
                                        -1.018505269425988317e-16_rk, 2.822981275134629111e-16_rk, -3.518611245019579226e+00_rk,-1.080782589792287830e-16_rk, &
                                        1.933529747082196615e-16_rk, 1.105841855066146456e-16_rk, 1.494947112654250205e-16_rk,-6.380589137734826702e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -6.901841202733891567e-01_rk, 2.549318342095321337e-17_rk, -3.627970270298020619e-16_rk,4.354782505798010288e-17_rk, &
                                        7.846472841792751892e-17_rk, -4.375591989647139579e-01_rk, -5.696666029836321477e-16_rk,-2.670510706168199810e-16_rk, &
                                        1.632993161855451181e+00_rk, -3.224026868892525296e-16_rk, 1.437221915064769190e-16_rk,-3.902276458338436153e-17_rk, &
                                        -1.651630246476078250e-16_rk, 6.901841202733880465e-01_rk, -1.816980718553970296e-16_rk,1.773372551488996549e-16_rk, &
                                        -2.685021169512409295e-16_rk, 4.746349288001547739e-16_rk, -2.575802203437516091e+00_rk,-1.006172330349207732e-15_rk, &
                                        1.971521937603382768e-16_rk, -6.597750785929182132e-16_rk, -8.893715684674274672e-17_rk,-1.632993161855452069e+00_rk, &
                                        6.337905845915180446e-16_rk, -3.382630281285320707e-16_rk, 6.094413448457089544e+00_rk,-7.983100176150611276e-17_rk, &
                                        -4.056733910984774943e-16_rk, -1.151594266693779682e-16_rk, -1.262480661647684440e-16_rk,2.575802203437513871e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,5,3) = reshape((/                                                                                 &
                                        1.821367205045917981e+00_rk, 3.569059186639249319e-16_rk, 1.670431165955388797e-16_rk,1.705716731556966223e-17_rk, &
                                        1.146752469451860538e-16_rk, 4.880338717125848325e-01_rk, 5.530314382642847058e-16_rk,4.341785870099337406e-17_rk, &
                                        -1.821367205045917093e+00_rk, 1.077676971334792064e-16_rk, 4.609322930346099473e-17_rk,-1.221693652047778999e-16_rk, &
                                        9.279597252281509943e-17_rk, -4.880338717125849435e-01_rk, 1.586740200975867174e-16_rk,-1.098587938348624708e-16_rk, &
                                        2.756240039448056003e-16_rk, -3.036055865063744921e-16_rk, 1.821367205045918203e+00_rk,4.961381051807501785e-16_rk, &
                                        -1.686444217533532925e-16_rk, 3.014403288865862992e-16_rk, 1.125158080629239364e-16_rk,4.880338717125850545e-01_rk, &
                                        -3.904761721912870604e-16_rk, 4.156883077315575488e-17_rk, -1.821367205045917093e+00_rk,1.222606528536645069e-16_rk, &
                                        3.948658514245391755e-16_rk, 9.280224134125509920e-17_rk, 1.442176123851656812e-16_rk,-4.880338717125849435e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,1) = reshape((/                                                                                 &
                                        4.375591989647141800e-01_rk, 7.917727166831730628e-17_rk, 2.215730843474769448e-16_rk,-3.957126126148978352e-16_rk, &
                                        -4.890217418296016351e-16_rk, 6.901841202733884906e-01_rk, 4.075663515384932867e-16_rk,5.954445832110250168e-16_rk, &
                                        -6.901841202733887126e-01_rk, 3.490999571200672336e-16_rk, -1.021580386034744369e-16_rk,-1.091790576888164247e-17_rk, &
                                        4.944793904797069444e-17_rk, -1.632993161855451625e+00_rk, 3.426722530898047916e-18_rk,-9.673924442758801510e-18_rk, &
                                        3.400467291690412078e-19_rk, -4.277776892704127159e-16_rk, 1.632993161855452513e+00_rk,9.369582126541180495e-16_rk, &
                                        -2.727110332959275798e-16_rk, 1.145936997759586699e-15_rk, 3.496556160503265316e-16_rk,2.575802203437515647e+00_rk, &
                                        -3.665345062007809853e-16_rk, 2.530618444526780756e-16_rk, -2.575802203437514759e+00_rk,2.991802626431226536e-16_rk, &
                                        1.001685130006192461e-16_rk, -7.516623662860483928e-17_rk, -1.993219550482931728e-16_rk,-6.094413448457092208e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,2) = reshape((/                                                                                 &
                                        2.526249213086745882e-01_rk, -1.377467212079930272e-16_rk, 8.209970370194785388e-17_rk,3.715516614691392381e-16_rk, &
                                        9.439773222078610143e-17_rk, 9.231175700840643151e-17_rk, 1.526136038801809040e-16_rk,-2.186438441001697225e-16_rk, &
                                        8.485409481778606382e-17_rk, 8.569715995935460575e-17_rk, 5.110161766666102183e-17_rk,6.397833822546095285e-17_rk, &
                                        -1.376767523893276653e-17_rk, 9.428090415820626902e-01_rk, 4.561357645888611538e-17_rk,-2.962167483484069891e-16_rk, &
                                        6.925044897687944995e-17_rk, 2.817902737817241296e-17_rk, 9.428090415820629122e-01_rk,1.939396627066817431e-16_rk, &
                                        -1.101233527600797890e-16_rk, -1.278376294126711212e-16_rk, 6.483501885818548794e-17_rk,2.137948122172527670e-16_rk, &
                                        -1.654055514481384125e-16_rk, -1.970969438376085709e-16_rk, 1.325278031449227877e-17_rk,-1.112710019023877456e-16_rk, &
                                        1.121519033896386360e-16_rk, 7.974147779136818655e-17_rk, 1.760753099476365224e-16_rk,3.518611245019576117e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,6,3) = reshape((/                                                                                 &
                                        4.880338717125848325e-01_rk, 2.120240527217439213e-16_rk, 1.273557227452977468e-16_rk,-6.462829047274749264e-17_rk, &
                                        -3.665629999965041005e-16_rk, 1.821367205045917759e+00_rk, 5.654094516532508558e-16_rk,4.829011753810292866e-16_rk, &
                                        -4.880338717125848325e-01_rk, 1.127754536478651536e-16_rk, -2.016816168300281839e-16_rk,-6.156605345064983371e-17_rk, &
                                        -2.484624952394261185e-17_rk, -1.821367205045917093e+00_rk, -3.372836837333735065e-17_rk,-2.290183907676069620e-18_rk, &
                                        1.362715566902808326e-17_rk, -1.936698871253923104e-16_rk, 4.880338717125848325e-01_rk,4.341628546644248494e-16_rk, &
                                        -1.727590083960208327e-16_rk, 9.123382497620551651e-16_rk, 3.117549448768268484e-16_rk,1.821367205045918425e+00_rk, &
                                        -2.557769475700078991e-16_rk, 2.034028091012150488e-16_rk, -4.880338717125849435e-01_rk,1.279903119349511886e-16_rk, &
                                        9.320332512260388303e-17_rk, -1.587237205641934075e-16_rk, -5.772655939856678224e-17_rk,-1.821367205045917093e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -4.375591989647145130e-01_rk, -1.453298039057621365e-16_rk, -3.398215623082316438e-16_rk,4.344863604393411919e-16_rk, &
                                        -1.432968205521743944e-16_rk, -1.849342776560392032e-01_rk, -4.265396466684092499e-16_rk,-3.759452462229545381e-16_rk, &
                                        2.575802203437514315e+00_rk, -1.243110967397286881e-16_rk, 2.874895797428015064e-16_rk,3.899324151527161414e-17_rk, &
                                        -3.084134607251106736e-16_rk, 1.632993161855451625e+00_rk, -2.687422682621239839e-16_rk,-2.474329108417735316e-16_rk, &
                                        -3.981632892195540165e-16_rk, 5.778502230862418552e-16_rk, -1.632993161855452513e+00_rk,-6.875071226309341753e-16_rk, &
                                        -9.865335129541062887e-17_rk, -4.292884182515921668e-16_rk, 3.014513400732120141e-16_rk,-6.901841202733887126e-01_rk, &
                                        5.702355600859785255e-16_rk, -8.176580994796038485e-16_rk, 9.613024693476670990e+00_rk,-8.302374468466511233e-17_rk, &
                                        -4.868744624170582240e-16_rk, -1.460021343846243902e-16_rk, -9.966746748255689288e-17_rk,6.094413448457091320e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,2) = reshape((/                                                                                 &
                                        2.526249213086745882e-01_rk, -1.377467212079930272e-16_rk, 8.209970370194781690e-17_rk,3.715516614691392381e-16_rk, &
                                        9.439773222078605212e-17_rk, 2.033340594709220856e-16_rk, 1.526136038801809040e-16_rk,-2.186438441001697718e-16_rk, &
                                        8.485409481778606382e-17_rk, 8.569715995935464273e-17_rk, 5.110161766666109579e-17_rk,6.397833822546098983e-17_rk, &
                                        -1.376767523893282815e-17_rk, 9.428090415820626902e-01_rk, 4.561357645888609073e-17_rk,-2.962167483484070384e-16_rk, &
                                        6.925044897687944995e-17_rk, 2.817902737817241296e-17_rk, 9.428090415820633563e-01_rk,1.939396627066817924e-16_rk, &
                                        -1.101233527600798014e-16_rk, -1.278376294126713184e-16_rk, 6.483501885818553725e-17_rk,2.137948122172527670e-16_rk, &
                                        -1.654055514481383139e-16_rk, -1.970969438376088667e-16_rk, 1.345520409864680127e-15_rk,-1.112710019023877456e-16_rk, &
                                        1.121519033896386360e-16_rk, 7.974147779136816190e-17_rk, 1.760753099476365224e-16_rk,3.518611245019576117e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,7,3) = reshape((/                                                                                 &
                                        4.880338717125852765e-01_rk, 3.277533290123383497e-16_rk, 1.554058122287938457e-16_rk,-7.770145143001536701e-17_rk, &
                                        5.494875229829454122e-16_rk, 1.307682818044210438e-01_rk, 2.119350596196579873e-16_rk,1.202501506301744878e-16_rk, &
                                        -6.797434948471084759e+00_rk, -2.548770587989355556e-16_rk, -1.322550648803153591e-16_rk,-1.116466485620896462e-16_rk, &
                                        2.094748380510887340e-16_rk, -1.821367205045917537e+00_rk, 2.781184789743383338e-16_rk,1.934004485312856172e-16_rk, &
                                        7.944106920346336942e-16_rk, -2.556000262687125175e-16_rk, 4.880338717125847214e-01_rk,1.491562471556623402e-16_rk, &
                                        1.433678741616140014e-16_rk, 3.315529156069799529e-16_rk, -3.228888551602466562e-16_rk,1.307682818044214323e-01_rk, &
                                        -3.824997608504909563e-16_rk, 7.550606288784641956e-16_rk, -6.797434948471085647e+00_rk,-7.298255478701871119e-17_rk, &
                                        7.615629558961345046e-16_rk, 5.998584929495645075e-17_rk, 1.299951601619633753e-16_rk,-1.821367205045917537e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,1) = reshape((/                                                                                 &
                                        1.387778780781445676e-16_rk, 3.307626611872231036e-17_rk, 5.912423898037730020e-17_rk,-1.938687391222162903e-17_rk, &
                                        3.161592811908879655e-16_rk, -2.526249213086746992e-01_rk, 9.486647564957956951e-18_rk,-1.097496684940352887e-16_rk, &
                                        -9.428090415820624681e-01_rk, -1.123944301901692728e-16_rk, -9.266577056966347314e-17_rk,-1.403766787319496118e-17_rk, &
                                        1.294827608385699218e-16_rk, 2.413725491905395699e-16_rk, 1.326577728656128725e-16_rk,1.285534176422660987e-16_rk, &
                                        1.989116212451924260e-16_rk, -7.503626690791454500e-17_rk, -1.161577733221894205e-16_rk,-1.247255450115920850e-16_rk, &
                                        1.856821922956690920e-16_rk, -3.583242897539972661e-16_rk, -3.255534780617691496e-16_rk,-9.428090415820635783e-01_rk, &
                                        -1.018505269425987084e-16_rk, 2.822981275134628125e-16_rk, -3.518611245019575673e+00_rk,-1.080782589792287583e-16_rk, &
                                        1.933529747082194643e-16_rk, 1.105841855066145839e-16_rk, 1.494947112654250698e-16_rk,1.582387135476830312e-15_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,2) = reshape((/                                                                                 &
                                        1.849342776560398138e-01_rk, 2.500002589950327918e-16_rk, 1.985976196259064281e-16_rk,-7.866511479962585545e-16_rk, &
                                        -2.672601928594996848e-16_rk, 4.375591989647136248e-01_rk, 2.644393952232702904e-16_rk,7.043387588171595246e-16_rk, &
                                        -1.632993161855451181e+00_rk, 1.510083669705432935e-16_rk, -2.459254268397990243e-16_rk,-8.893391186753760581e-17_rk, &
                                        1.926983751254734321e-16_rk, -2.575802203437513871e+00_rk, 9.047091893762484814e-17_rk,4.150962415479143726e-16_rk, &
                                        1.300012189974820543e-16_rk, -5.309929835564995506e-16_rk, 6.901841202733893788e-01_rk,6.182930049358441968e-16_rk, &
                                        2.309451175982131972e-17_rk, 9.154503374182604555e-16_rk, -4.073288086962827231e-17_rk,1.632993161855452069e+00_rk, &
                                        -3.029794816952413183e-16_rk, 7.324569158037496069e-16_rk, -6.094413448457091320e+00_rk,3.023730055662816039e-16_rk, &
                                        1.813695843192001483e-16_rk, -4.432352891335834330e-17_rk, -2.259025537305046007e-16_rk,-9.613024693476663884e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face4_dx(:,:,8,3) = reshape((/                                                                                 &
                                        1.307682818044213768e-01_rk, 5.508252082841792071e-16_rk, 2.974923644850261495e-18_rk,-6.861550478234723110e-16_rk, &
                                        -1.385034003095222340e-16_rk, 4.880338717125841663e-01_rk, 5.369805648922211369e-17_rk,3.675570857852264092e-16_rk, &
                                        -1.821367205045917537e+00_rk, 6.326385017291472456e-17_rk, -1.668022774659179576e-16_rk,-2.740935002557190676e-16_rk, &
                                        1.665222986139922422e-18_rk, -6.797434948471085647e+00_rk, -3.311723180057900439e-16_rk,1.390260509290820003e-16_rk, &
                                        1.335704195355036045e-16_rk, -5.304005969076513388e-16_rk, 1.307682818044216544e-01_rk,3.244251775868593135e-16_rk, &
                                        8.205519747746538519e-17_rk, 1.070595739072650283e-15_rk, -8.944549045129048907e-17_rk,4.880338717125844994e-01_rk, &
                                        -1.476575376396899280e-17_rk, 7.405465721561578159e-16_rk, -1.821367205045917537e+00_rk,1.737131867273017548e-16_rk, &
                                        2.091209954484977488e-16_rk, -1.421968670715962864e-16_rk, -3.036632355162598602e-16_rk,-6.797434948471085647e+00_rk  &
                                        /),(/4,8/))
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face5_dx
        ! 
        test_dbr2_vol_face5_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.602669736518816695e-16_rk, 1.313491249344118011e-16_rk,-8.138423372761935548e-17_rk, &
                                        4.838506289650515424e-17_rk, 3.518611245019578782e+00_rk, 4.805273650869112925e-16_rk,1.311405539260230657e-16_rk, &
                                        -1.484407005620176157e-16_rk, -2.246411597635323626e-16_rk, -3.518611245019578782e+00_rk,-2.001088998413772419e-16_rk, &
                                        1.577524999317038981e-17_rk, 2.276212172095401492e-16_rk, -1.087860512503232083e-16_rk,-2.605108410885991212e-16_rk, &
                                        4.743917654890915671e-18_rk, -2.233655981349156587e-16_rk, 2.073930180710623776e-16_rk,-2.008698848008198140e-17_rk, &
                                        -3.071922795296659445e-17_rk, -2.526249213086744216e-01_rk, 2.362476209073018154e-17_rk,-5.638465110051883762e-17_rk, &
                                        5.253374536014211797e-17_rk, 2.889084092641955967e-16_rk, 2.526249213086747547e-01_rk,2.549468942104348374e-17_rk, &
                                        4.684718633686041501e-17_rk, -1.041865892330333085e-16_rk, 1.141021709867654717e-16_rk,2.812912183905136660e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,1,2) = reshape((/                                                                                 &
                                        9.613024693476670990e+00_rk, 7.213461126882140145e-16_rk, -2.517547025215668063e-16_rk,5.247936492697002605e-17_rk, &
                                        -3.792889347421250094e-16_rk, 6.094413448457092208e+00_rk, 4.361011617341092345e-17_rk,5.605763545391551458e-16_rk, &
                                        3.354548921538568224e-16_rk, -3.619822981477200790e-16_rk, 6.094413448457089544e+00_rk,5.903265777585813520e-17_rk, &
                                        7.853445572994387465e-16_rk, 4.424767649400304333e-16_rk, 3.984684253907819037e-16_rk,2.575802203437514315e+00_rk, &
                                        -6.901841202733889347e-01_rk, -3.325959389804811577e-16_rk, -8.118170316258387640e-16_rk,-1.570416956604291723e-16_rk, &
                                        2.624802621780855658e-16_rk, -4.375591989647137359e-01_rk, -3.133543901954178704e-17_rk,-5.515363720590873454e-16_rk, &
                                        -1.878596312868581226e-16_rk, 5.829675067519108182e-16_rk, -4.375591989647136248e-01_rk,-1.200114686800804067e-16_rk, &
                                        6.647694337305985143e-16_rk, -2.219281682278479610e-16_rk, 1.899298154117931289e-16_rk,-1.849342776560392587e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,1,3) = reshape((/                                                                                 &
                                        6.797434948471087424e+00_rk, 4.583454654533143547e-16_rk, -1.639236806444698634e-16_rk,3.676788173644855361e-16_rk, &
                                        -3.212766920903904537e-16_rk, 1.821367205045918425e+00_rk, 9.469806036693652483e-17_rk,5.478114420847636939e-16_rk, &
                                        2.868201523317122702e-16_rk, -1.596077122487086415e-16_rk, 1.821367205045917093e+00_rk,-8.973709495039440257e-17_rk, &
                                        3.716956827987781525e-16_rk, 1.047202922950625899e-16_rk, 2.605455446796113683e-16_rk,4.880338717125853876e-01_rk, &
                                        -1.821367205045918647e+00_rk, -4.395392859650827380e-16_rk, -6.308596604480747907e-16_rk,-2.896041020545965735e-16_rk, &
                                        2.183774430806422305e-16_rk, -4.880338717125844994e-01_rk, 1.425043686572569396e-17_rk,-1.939431352500900627e-16_rk, &
                                        -1.819766134736002414e-16_rk, 2.247416913515821815e-16_rk, -4.880338717125845549e-01_rk,-2.008957522925714740e-17_rk, &
                                        3.393154075578022032e-16_rk, -4.006340235782946783e-17_rk, 1.930227602988586226e-16_rk,-1.307682818044210438e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -6.094413448457094873e+00_rk, -7.162462416633947075e-16_rk, 1.266244441757271169e-16_rk,5.072019204632898129e-16_rk, &
                                        2.070261420186943054e-16_rk, -9.613024693476674543e+00_rk, -5.850896958203703401e-16_rk,-6.096160170184065911e-16_rk, &
                                        1.814202309654177188e-17_rk, 6.043401100534917259e-16_rk, -2.575802203437514315e+00_rk,1.480549058687097158e-16_rk, &
                                        -8.523945341754270701e-16_rk, -9.250205702292375430e-16_rk, -3.882154906527949211e-16_rk,-6.094413448457092208e+00_rk, &
                                        4.375591989647142910e-01_rk, 4.886988747622576744e-16_rk, 4.878941990730573345e-16_rk,-7.802432031242300704e-17_rk, &
                                        -1.991500335769604373e-16_rk, 6.901841202733882685e-01_rk, 4.270855706610532238e-17_rk,1.049073784761967350e-15_rk, &
                                        -1.185698390280086205e-17_rk, -8.385902093994380695e-16_rk, 1.849342776560393142e-01_rk,3.607882645307406752e-16_rk, &
                                        -3.171149024760994320e-16_rk, 4.049224593319168365e-16_rk, -9.811186002679594453e-17_rk,4.375591989647137359e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.518611245019578782e+00_rk, -1.653668446767010752e-16_rk, -6.218866588571920656e-18_rk,-4.782970516626401630e-16_rk, &
                                        1.238777298269255620e-16_rk, 1.109930868370749118e-15_rk, 6.095221456004812420e-17_rk,-8.210089144677169437e-17_rk, &
                                        -2.051562146883810156e-16_rk, -1.771665214223919802e-17_rk, 8.391438110953153645e-18_rk,-6.978663803190744644e-18_rk, &
                                        5.127472688281748690e-17_rk, 2.549225880796668126e-16_rk, 9.853311651233596686e-17_rk,3.518611245019576117e+00_rk, &
                                        2.526249213086746992e-01_rk, 6.726266235313921603e-17_rk, 1.165298144817191998e-16_rk,2.551530044529340991e-16_rk, &
                                        -3.261100064815859568e-17_rk, -2.412002754420773352e-17_rk, -3.499788013729369222e-17_rk,-4.411527616023606243e-16_rk, &
                                        1.471828698295168868e-16_rk, -3.328570661666849335e-17_rk, -4.546011733060479826e-17_rk,-2.662714852717036290e-16_rk, &
                                        -3.945017175913594480e-16_rk, -7.880770187103540675e-17_rk, -2.059201263717625328e-16_rk,-2.526249213086743661e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.821367205045918425e+00_rk, 3.702176242040130306e-16_rk, 8.985530233892828740e-17_rk,1.162935582346647931e-17_rk, &
                                        4.200892185011772529e-17_rk, 6.797434948471087424e+00_rk, 6.946651324369178444e-16_rk,3.529655086948381267e-16_rk, &
                                        -1.646559910424982536e-16_rk, -3.639247922237631272e-16_rk, 4.880338717125849435e-01_rk,-1.429313072753772546e-16_rk, &
                                        2.192568456715559704e-16_rk, 4.280206390677856487e-16_rk, 1.078978273369310343e-16_rk,1.821367205045917981e+00_rk, &
                                        -4.880338717125849990e-01_rk, -3.846113437320330091e-16_rk, -2.546834608480722102e-16_rk,-1.392094057898656494e-16_rk, &
                                        -2.062095395510589739e-17_rk, -1.821367205045917537e+00_rk, 2.106784188772313744e-16_rk,-9.477381099399724564e-16_rk, &
                                        5.084928877618427330e-17_rk, 4.901500301584469348e-16_rk, -1.307682818044210715e-01_rk,-1.026368587970930864e-17_rk, &
                                        4.290086207791161883e-17_rk, -2.767573981241827497e-16_rk, 1.274927365891519144e-16_rk,-4.880338717125847214e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,1) = reshape((/                                                                                 &
                                        6.094413448457094873e+00_rk, 3.957122943596313684e-16_rk, -3.893226940445504972e-16_rk,-3.444334530080511019e-16_rk, &
                                        -3.037962678117046386e-16_rk, 2.575802203437516091e+00_rk, -3.759650343534520969e-16_rk,3.473349091663602625e-16_rk, &
                                        2.787393780274934225e-16_rk, -1.550577905264269021e-16_rk, 9.613024693476670990e+00_rk,2.521628938140446202e-16_rk, &
                                        8.208440341890861980e-16_rk, 4.697781358101573432e-16_rk, 6.057875931534410666e-16_rk,6.094413448457092208e+00_rk, &
                                        -4.375591989647142910e-01_rk, -4.196767849242644324e-17_rk, -9.026802352151817939e-16_rk,1.181982972725868959e-16_rk, &
                                        2.605884894828936262e-16_rk, -1.849342776560393142e-01_rk, -8.995808124756569778e-17_rk,-9.363044825609294772e-16_rk, &
                                        -9.321050681748338467e-17_rk, 2.607733908710470240e-16_rk, -6.901841202733883796e-01_rk,-4.117776433728276920e-16_rk, &
                                        2.234205298023786513e-16_rk, -1.965492808658501702e-16_rk, -1.300924819467349250e-16_rk,-4.375591989647138469e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.518611245019578337e+00_rk, -1.653668446767010752e-16_rk, -6.218866588571976123e-18_rk,-4.782970516626403602e-16_rk, &
                                        1.238777298269255620e-16_rk, -2.223367611794386316e-16_rk, 6.095221456004812420e-17_rk,-8.210089144677173135e-17_rk, &
                                        -2.051562146883810156e-16_rk, -1.771665214223911174e-17_rk, 8.391438110953153645e-18_rk,-6.978663803190744644e-18_rk, &
                                        5.127472688281761016e-17_rk, 2.549225880796668126e-16_rk, 9.853311651233599151e-17_rk,3.518611245019576117e+00_rk, &
                                        2.526249213086748102e-01_rk, 6.726266235313931463e-17_rk, 1.165298144817191505e-16_rk,2.551530044529340991e-16_rk, &
                                        -3.261100064815858336e-17_rk, -2.412002754420773352e-17_rk, -3.499788013729368606e-17_rk,-4.411527616023609201e-16_rk, &
                                        1.471828698295168375e-16_rk, -3.328570661666850568e-17_rk, -4.546011733060479826e-17_rk,-2.662714852717038262e-16_rk, &
                                        -3.945017175913594973e-16_rk, -7.880770187103540675e-17_rk, -2.059201263717625328e-16_rk,-2.526249213086744771e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.821367205045918869e+00_rk, 1.195180049731943406e-16_rk, -3.917413762989545681e-16_rk,6.548782170546457450e-17_rk, &
                                        -1.481918257343020916e-16_rk, 4.880338717125850545e-01_rk, -5.400485000530275685e-16_rk,8.799877594872578515e-17_rk, &
                                        2.049596177079864577e-16_rk, 4.010056518755605360e-17_rk, 6.797434948471085647e+00_rk,2.584529329944379522e-16_rk, &
                                        2.198321061264854152e-16_rk, 1.154798737957326116e-16_rk, 3.306204530997823390e-16_rk,1.821367205045917981e+00_rk, &
                                        -4.880338717125851100e-01_rk, 6.945117714255926922e-17_rk, -6.747038429452257947e-16_rk,-5.561850070775003311e-17_rk, &
                                        1.103363330814169795e-16_rk, -1.307682818044210160e-01_rk, -1.187133781226478568e-16_rk,-2.736968408269237567e-16_rk, &
                                        -1.077745807738816078e-16_rk, -1.376527855798911040e-18_rk, -1.821367205045917093e+00_rk,-5.784483591495554471e-16_rk, &
                                        -1.331789640222719305e-16_rk, -1.350054965630159604e-17_rk, -2.082883839554278585e-16_rk,-4.880338717125847214e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.602669736518816449e-16_rk, 1.313491249344116532e-16_rk,-8.138423372761933083e-17_rk, &
                                        4.838506289650512959e-17_rk, 3.518611245019578782e+00_rk, 4.805273650869110953e-16_rk,1.311405539260230904e-16_rk, &
                                        -1.484407005620175664e-16_rk, -2.246411597635324119e-16_rk, -3.518611245019577005e+00_rk,-2.001088998413771433e-16_rk, &
                                        1.577524999317048842e-17_rk, 2.276212172095401492e-16_rk, -1.087860512503230481e-16_rk,6.276675786115260618e-16_rk, &
                                        4.743917654890915671e-18_rk, -2.233655981349155601e-16_rk, 2.073930180710621804e-16_rk,-2.008698848008192593e-17_rk, &
                                        -3.071922795296656364e-17_rk, -2.526249213086744216e-01_rk, 2.362476209073018154e-17_rk,-5.638465110051903484e-17_rk, &
                                        5.253374536014211797e-17_rk, 2.889084092641954981e-16_rk, 2.526249213086744216e-01_rk,2.549468942104348374e-17_rk, &
                                        4.684718633686031640e-17_rk, -1.041865892330333085e-16_rk, 1.141021709867654224e-16_rk,-8.289318062346428128e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -2.575802203437515203e+00_rk, -3.906124233348118641e-16_rk, 2.641924356987106846e-16_rk,9.041147383983105710e-16_rk, &
                                        1.315334750882738853e-16_rk, -6.094413448457092208e+00_rk, -1.655145452935071842e-16_rk,-3.963745716456116092e-16_rk, &
                                        7.485753722290520872e-17_rk, 3.974156024321983517e-16_rk, -6.094413448457089544e+00_rk,-4.507533016947665824e-17_rk, &
                                        -8.878940110650739299e-16_rk, -9.523219410993639599e-16_rk, -5.955346584154538375e-16_rk,-9.613024693476667437e+00_rk, &
                                        1.849342776560394253e-01_rk, 1.980706142742026517e-16_rk, 5.787574026624004630e-16_rk,-3.532643132454390013e-16_rk, &
                                        -1.972582608817683991e-16_rk, 4.375591989647136248e-01_rk, 1.013311992941291653e-16_rk,1.433841895263808988e-15_rk, &
                                        -1.065061083721755892e-16_rk, -5.163960935185739301e-16_rk, 4.375591989647137359e-01_rk,6.525544392234878372e-16_rk, &
                                        1.242340014521204804e-16_rk, 3.795435719699187992e-16_rk, 2.219104373317319368e-16_rk,6.901841202733880465e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,4,3) = reshape((/                                                                                 &
                                        4.880338717125849435e-01_rk, 1.781941536094404523e-16_rk, -5.275305634514439544e-17_rk,-8.684364182550192861e-16_rk, &
                                        -6.488166723924862383e-17_rk, 1.821367205045918869e+00_rk, 1.853722069181301217e-16_rk,2.573149497214591608e-16_rk, &
                                        -1.154063276992898628e-16_rk, -7.761016378112869835e-17_rk, 1.821367205045917537e+00_rk,9.689343243500083780e-17_rk, &
                                        6.050580029489271130e-16_rk, 5.244164961569873725e-16_rk, 3.361241052351290424e-16_rk,6.797434948471085647e+00_rk, &
                                        -1.307682818044215156e-01_rk, -8.906198348133749301e-17_rk, -6.803244728251823069e-17_rk,5.933037208375726891e-16_rk, &
                                        1.936030599283037570e-16_rk, -4.880338717125848325e-01_rk, -6.777677596921622921e-17_rk,-9.380730800641149796e-16_rk, &
                                        2.504548058295584166e-16_rk, 1.608643529911353531e-16_rk, -4.880338717125843329e-01_rk,-5.727792584469173191e-16_rk, &
                                        -5.052268096988025625e-16_rk, -4.413152178773919087e-16_rk, -4.921148061869696644e-16_rk,-1.821367205045917315e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.700442714711566797e-17_rk, 2.091911523273538395e-16_rk,4.330054727815400554e-17_rk, &
                                        8.610717550718893498e-17_rk, 9.428090415820635783e-01_rk, 3.925470172702038651e-16_rk,5.621921958759660581e-17_rk, &
                                        -1.129170028178440554e-16_rk, -6.104791023332997632e-17_rk, -9.428090415820638004e-01_rk,-8.371261831481967298e-17_rk, &
                                        -1.618202056179950417e-17_rk, -6.621522688438378714e-18_rk, -4.870262775026279692e-17_rk,2.605108410885991212e-16_rk, &
                                        -4.743917654890915671e-18_rk, -9.770508945816691645e-17_rk, 8.960624234639994575e-17_rk,-3.902070734900310425e-17_rk, &
                                        -6.188155775635191027e-17_rk, -9.428090415820633563e-01_rk, 2.092904112351071638e-16_rk,-4.202345010889046487e-16_rk, &
                                        5.963026845675983747e-17_rk, 5.865335304096066502e-17_rk, 9.428090415820631343e-01_rk,3.762725460143276898e-16_rk, &
                                        7.766005272872756116e-17_rk, -8.196411351240488560e-17_rk, 1.233309363447244980e-16_rk,8.289318062346428128e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,2) = reshape((/                                                                                 &
                                        2.575802203437515203e+00_rk, 2.731476451879360933e-16_rk, -1.935340798828766294e-16_rk,5.220270843638596637e-16_rk, &
                                        -1.501475718690561575e-16_rk, 1.632993161855452069e+00_rk, 1.996436343708131575e-16_rk,5.259548524128197382e-16_rk, &
                                        9.866902495714534035e-17_rk, -9.271540002354020924e-17_rk, 1.632993161855451181e+00_rk,-1.042539495830260442e-16_rk, &
                                        5.079529375060928181e-17_rk, 8.993299090348180854e-17_rk, 2.800778672820739177e-16_rk,6.901841202733889347e-01_rk, &
                                        -2.575802203437516091e+00_rk, -5.118583713824239071e-16_rk, -7.375293209948372205e-16_rk,-3.902844870329058773e-16_rk, &
                                        1.097904324998538278e-16_rk, -1.632993161855451847e+00_rk, 1.165177040544559235e-16_rk,-5.864255766062784308e-16_rk, &
                                        -1.097464235148300368e-16_rk, 8.048029913066576527e-17_rk, -1.632993161855450959e+00_rk,-3.246817602778427874e-16_rk, &
                                        -2.487412405177082593e-16_rk, -3.997340191027585354e-17_rk, 2.591443990649319257e-17_rk,-6.901841202733882685e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -6.797434948471087424e+00_rk, -4.583454654533143547e-16_rk, 1.639236806444698634e-16_rk,-3.676788173644856347e-16_rk, &
                                        3.212766920903904537e-16_rk, -1.821367205045918425e+00_rk, -9.469806036693662344e-17_rk,-5.478114420847636939e-16_rk, &
                                        -2.868201523317122702e-16_rk, 1.596077122487086415e-16_rk, -1.821367205045917093e+00_rk,8.973709495039442722e-17_rk, &
                                        -3.716956827987781525e-16_rk, -1.047202922950625899e-16_rk, -2.605455446796113683e-16_rk,-4.880338717125853876e-01_rk, &
                                        1.821367205045918647e+00_rk, 4.395392859650828366e-16_rk, 6.308596604480747907e-16_rk,2.896041020545966721e-16_rk, &
                                        -2.183774430806422305e-16_rk, 4.880338717125844994e-01_rk, -1.425043686572571861e-17_rk,1.939431352500900627e-16_rk, &
                                        1.819766134736002907e-16_rk, -2.247416913515822801e-16_rk, 4.880338717125845549e-01_rk,2.008957522925714740e-17_rk, &
                                        -3.393154075578022525e-16_rk, 4.006340235782946783e-17_rk, -1.930227602988587212e-16_rk,1.307682818044210438e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.632993161855452069e+00_rk, -2.574220246486423194e-16_rk, -1.004854413438440660e-16_rk,-1.695592178700953815e-16_rk, &
                                        6.619465454057041318e-18_rk, -2.575802203437515647e+00_rk, -5.953547409856206977e-16_rk,-4.588629237861894788e-16_rk, &
                                        9.350883477503467111e-17_rk, 7.806563555253269944e-17_rk, -6.901841202733887126e-01_rk,4.902019260402029168e-17_rk, &
                                        -1.483506253575887950e-16_rk, -1.251589119243951618e-16_rk, -1.862842357005998127e-16_rk,-1.632993161855451625e+00_rk, &
                                        1.632993161855452957e+00_rk, 4.290012459555050026e-16_rk, 3.664739540644648504e-16_rk,6.014809010513896230e-17_rk, &
                                        -6.300174106492825958e-17_rk, 2.575802203437515647e+00_rk, -3.028039969894370736e-16_rk,1.091686646154790413e-15_rk, &
                                        -1.084761640997998236e-16_rk, -1.272512596694753339e-16_rk, 6.901841202733883796e-01_rk,7.294835188686361313e-17_rk, &
                                        3.737609990180890546e-16_rk, 3.268576932689415970e-16_rk, 1.292999166847981079e-16_rk,1.632993161855451181e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -9.428090415820631343e-01_rk, -3.273004768640938022e-17_rk, 8.482836889936696694e-17_rk,-3.957684137719181644e-16_rk, &
                                        5.742093090781023054e-17_rk, 2.223367611794386316e-16_rk, 3.164089344603638146e-18_rk,-1.233111482142269391e-16_rk, &
                                        -7.926085691433598072e-17_rk, 7.569767470433747379e-17_rk, -8.391438110953153645e-18_rk,1.389463752938253762e-16_rk, &
                                        1.137373521687788109e-16_rk, 4.184744370935180589e-17_rk, -4.509100383121133275e-17_rk,9.428090415820626902e-01_rk, &
                                        9.428090415820633563e-01_rk, 1.805622148850858332e-16_rk, 2.814491245839724860e-16_rk,3.691571042767699515e-16_rk, &
                                        1.509286632142626813e-17_rk, -8.690227491830792052e-17_rk, -2.300411830012596440e-17_rk,-8.502656845960728427e-17_rk, &
                                        1.585923191578699860e-16_rk, -1.188239250215110567e-17_rk, 4.546011733060479826e-17_rk,-1.245391376233482936e-16_rk, &
                                        -2.026798112291080606e-16_rk, -2.049201778462607839e-16_rk, -2.785452929360155705e-16_rk,-9.428090415820626902e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.821367205045918425e+00_rk, -3.702176242040130306e-16_rk, -8.985530233892828740e-17_rk,-1.162935582346643001e-17_rk, &
                                        -4.200892185011772529e-17_rk, -6.797434948471087424e+00_rk, -6.946651324369178444e-16_rk,-3.529655086948381267e-16_rk, &
                                        1.646559910424982783e-16_rk, 3.639247922237631272e-16_rk, -4.880338717125849435e-01_rk,1.429313072753772546e-16_rk, &
                                        -2.192568456715559704e-16_rk, -4.280206390677856487e-16_rk, -1.078978273369310343e-16_rk,-1.821367205045917981e+00_rk, &
                                        4.880338717125849990e-01_rk, 3.846113437320330091e-16_rk, 2.546834608480722102e-16_rk,1.392094057898656001e-16_rk, &
                                        2.062095395510589739e-17_rk, 1.821367205045917537e+00_rk, -2.106784188772313744e-16_rk,9.477381099399724564e-16_rk, &
                                        -5.084928877618427330e-17_rk, -4.901500301584469348e-16_rk, 1.307682818044210715e-01_rk,1.026368587970930864e-17_rk, &
                                        -4.290086207791156953e-17_rk, 2.767573981241827497e-16_rk, -1.274927365891518898e-16_rk,4.880338717125847214e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.632993161855452069e+00_rk, 2.234131703544109835e-16_rk, -3.178968633108634896e-16_rk,8.295812331378732114e-17_rk, &
                                        -1.788338164684348373e-16_rk, 6.901841202733889347e-01_rk, -1.897392935547869092e-16_rk,3.464244846109964151e-16_rk, &
                                        1.323251708606533904e-16_rk, 4.403018491412727786e-17_rk, 2.575802203437514315e+00_rk,1.184050440256189680e-16_rk, &
                                        1.807146664811876986e-16_rk, 1.384019573012719685e-16_rk, 2.836894912011252093e-16_rk,1.632993161855451625e+00_rk, &
                                        -1.632993161855452957e+00_rk, -2.335910670391711451e-16_rk, -5.456864387572645693e-16_rk,1.789332459286720306e-17_rk, &
                                        1.867648565776319938e-16_rk, -6.901841202733887126e-01_rk, -1.157768254807771800e-16_rk,-2.512176439769813129e-16_rk, &
                                        -1.078437281371985905e-17_rk, 9.944553587553979177e-18_rk, -2.575802203437513871e+00_rk,-8.254934439155188941e-16_rk, &
                                        -5.290811044755438811e-16_rk, -1.629294662441318258e-16_rk, -3.759617893742468081e-16_rk,-1.632993161855451181e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -9.428090415820635783e-01_rk, -3.273004768640938022e-17_rk, 8.482836889936692996e-17_rk,-3.957684137719182630e-16_rk, &
                                        5.742093090781023054e-17_rk, -2.217524486706239845e-16_rk, 3.164089344603588842e-18_rk,-1.233111482142270131e-16_rk, &
                                        -7.926085691433598072e-17_rk, 7.569767470433756008e-17_rk, -8.391438110953153645e-18_rk,1.389463752938253762e-16_rk, &
                                        1.137373521687788849e-16_rk, 4.184744370935178123e-17_rk, -4.509100383121135740e-17_rk,9.428090415820626902e-01_rk, &
                                        9.428090415820638004e-01_rk, 1.805622148850859318e-16_rk, 2.814491245839725353e-16_rk,3.691571042767699515e-16_rk, &
                                        1.509286632142625581e-17_rk, -8.690227491830792052e-17_rk, -2.300411830012597056e-17_rk,-8.502656845960738288e-17_rk, &
                                        1.585923191578699367e-16_rk, -1.188239250215109334e-17_rk, 4.546011733060479826e-17_rk,-1.245391376233484908e-16_rk, &
                                        -2.026798112291080113e-16_rk, -2.049201778462607839e-16_rk, -2.785452929360155705e-16_rk,-9.428090415820624681e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.821367205045918869e+00_rk, -1.195180049731943406e-16_rk, 3.917413762989545681e-16_rk,-6.548782170546454985e-17_rk, &
                                        1.481918257343020916e-16_rk, -4.880338717125850545e-01_rk, 5.400485000530275685e-16_rk,-8.799877594872578515e-17_rk, &
                                        -2.049596177079864577e-16_rk, -4.010056518755605360e-17_rk, -6.797434948471085647e+00_rk,-2.584529329944379522e-16_rk, &
                                        -2.198321061264854152e-16_rk, -1.154798737957326116e-16_rk, -3.306204530997823390e-16_rk,-1.821367205045917981e+00_rk, &
                                        4.880338717125851100e-01_rk, -6.945117714255926922e-17_rk, 6.747038429452257947e-16_rk,5.561850070775000846e-17_rk, &
                                        -1.103363330814169795e-16_rk, 1.307682818044210160e-01_rk, 1.187133781226478568e-16_rk,2.736968408269237567e-16_rk, &
                                        1.077745807738816078e-16_rk, 1.376527855798911040e-18_rk, 1.821367205045917093e+00_rk,5.784483591495554471e-16_rk, &
                                        1.331789640222719798e-16_rk, 1.350054965630159604e-17_rk, 2.082883839554279078e-16_rk,4.880338717125847214e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.700442714711570495e-17_rk, 2.091911523273536916e-16_rk,4.330054727815403019e-17_rk, &
                                        8.610717550718891033e-17_rk, 9.428090415820635783e-01_rk, 3.925470172702036679e-16_rk,5.621921958759659348e-17_rk, &
                                        -1.129170028178440061e-16_rk, -6.104791023332995167e-17_rk, -9.428090415820624681e-01_rk,-8.371261831481957438e-17_rk, &
                                        -1.618202056179940556e-17_rk, -6.621522688438354062e-18_rk, -4.870262775026266133e-17_rk,2.605108410885991212e-16_rk, &
                                        -4.743917654890915671e-18_rk, -9.770508945816691645e-17_rk, 8.960624234639974853e-17_rk,-3.902070734900304878e-17_rk, &
                                        -6.188155775635183631e-17_rk, -9.428090415820633563e-01_rk, 2.092904112351070652e-16_rk,-4.202345010889046487e-16_rk, &
                                        5.963026845675983747e-17_rk, 5.865335304096071432e-17_rk, 9.428090415820625791e-01_rk,3.762725460143274925e-16_rk, &
                                        7.766005272872736395e-17_rk, -8.196411351240488560e-17_rk, 1.233309363447242515e-16_rk,-2.501737267640826562e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -6.901841202733889347e-01_rk, -2.076875498151172835e-16_rk, 2.387734208414276951e-17_rk,2.695097431799768131e-16_rk, &
                                        3.530571005343574576e-17_rk, -1.632993161855451625e+00_rk, -2.059718130600204091e-16_rk,-2.793325559843659585e-16_rk, &
                                        5.985268887152659644e-17_rk, -5.867994938513481230e-17_rk, -1.632993161855451181e+00_rk,-1.736388010046247328e-16_rk, &
                                        -2.782699980881670331e-16_rk, -1.736278783221853587e-16_rk, -1.898958596196511536e-16_rk,-2.575802203437513871e+00_rk, &
                                        6.901841202733889347e-01_rk, 1.507339416122521174e-16_rk, 1.746310718268920760e-16_rk,-3.480297215206340256e-16_rk, &
                                        -1.399761651427063270e-16_rk, 1.632993161855451847e+00_rk, -7.050946745420398240e-17_rk,7.564787135254930980e-16_rk, &
                                        -2.074382148009098981e-16_rk, -5.671551412636352312e-17_rk, 1.632993161855450959e+00_rk,5.737600355245395226e-16_rk, &
                                        6.541008629759243805e-16_rk, 4.498137576027973720e-16_rk, 5.311761459655380285e-16_rk,2.575802203437513427e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face5_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -4.880338717125849435e-01_rk, -1.781941536094404523e-16_rk, 5.275305634514439544e-17_rk,8.684364182550192861e-16_rk, &
                                        6.488166723924862383e-17_rk, -1.821367205045918869e+00_rk, -1.853722069181300231e-16_rk,-2.573149497214591608e-16_rk, &
                                        1.154063276992898381e-16_rk, 7.761016378112869835e-17_rk, -1.821367205045917537e+00_rk,-9.689343243500083780e-17_rk, &
                                        -6.050580029489271130e-16_rk, -5.244164961569873725e-16_rk, -3.361241052351290424e-16_rk,-6.797434948471085647e+00_rk, &
                                        1.307682818044215156e-01_rk, 8.906198348133739440e-17_rk, 6.803244728251823069e-17_rk,-5.933037208375726891e-16_rk, &
                                        -1.936030599283037570e-16_rk, 4.880338717125848325e-01_rk, 6.777677596921625386e-17_rk,9.380730800641149796e-16_rk, &
                                        -2.504548058295584166e-16_rk, -1.608643529911352545e-16_rk, 4.880338717125843329e-01_rk,5.727792584469173191e-16_rk, &
                                        5.052268096988026611e-16_rk, 4.413152178773919087e-16_rk, 4.921148061869696644e-16_rk,1.821367205045917315e+00_rk  &
                                        /),(/4,8/))
        
        


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
       
        
        !
        ! dbr2_vol_face6_dx
        ! 
        test_dbr2_vol_face6_dx(:,:,1,1) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 1.437177587824480917e-17_rk, 9.388576402028448495e-18_rk,6.471446581984366883e-18_rk, &
                                        2.728102922036811013e-16_rk, -9.428090415820639114e-01_rk, -2.446371182733863076e-17_rk,-2.585064279097204616e-17_rk, &
                                        -9.836887274423757554e-17_rk, -7.601967228212419648e-17_rk, 9.428090415820631343e-01_rk,1.154548279029905559e-16_rk, &
                                        2.698412427163542597e-17_rk, -2.370283939972421435e-16_rk, 4.336228715929400560e-17_rk,6.843868898875834080e-17_rk, &
                                        -8.503488173717676214e-17_rk, 6.293762569414065248e-17_rk, 2.964986184309078476e-17_rk,-1.222417821043515300e-17_rk, &
                                        -4.365768839290648856e-17_rk, 9.428090415820633563e-01_rk, -4.220157282392368038e-18_rk,-1.412041545518279527e-16_rk, &
                                        2.206325002134675273e-16_rk, -3.340443539965268778e-18_rk, -9.428090415820631343e-01_rk,1.958027818233184815e-16_rk, &
                                        -2.555080883333048935e-17_rk, 2.267754592592550129e-16_rk, -4.280219550500584943e-17_rk,-2.818021512299629044e-17_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -2.575802203437515203e+00_rk, 2.126444712024257943e-16_rk, 4.255884581072266293e-16_rk,3.981769056469073167e-16_rk, &
                                        7.213895704389466152e-16_rk, -1.632993161855451625e+00_rk, -1.568083525632230885e-16_rk,-2.017847420802125318e-16_rk, &
                                        -1.657804234590067657e-16_rk, 3.959852989940738942e-17_rk, -1.632993161855450737e+00_rk,1.658510287882048148e-16_rk, &
                                        -5.148503687032117296e-17_rk, -7.559738717939345122e-16_rk, 1.388935008607434745e-16_rk,-6.901841202733882685e-01_rk, &
                                        2.575802203437516535e+00_rk, 2.178565810518192605e-16_rk, 3.029431504134516373e-16_rk,1.162772344883066981e-16_rk, &
                                        -1.470626350464421754e-16_rk, 1.632993161855452069e+00_rk, -1.995511836767366558e-16_rk,8.020943700684604906e-17_rk, &
                                        3.782768757893601321e-16_rk, -2.382280480830743938e-16_rk, 1.632993161855451403e+00_rk,-1.795436659739106494e-16_rk, &
                                        -1.325916002604440636e-16_rk, -5.762799591610865859e-17_rk, 1.619504935939513899e-16_rk,6.901841202733884906e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -1.821367205045917981e+00_rk, 5.854081451723047438e-17_rk, 3.184563591007900428e-16_rk,1.724210628799871295e-16_rk, &
                                        7.941892741822949141e-16_rk, -4.880338717125850545e-01_rk, -1.170076328571043003e-16_rk,-2.666198681762858252e-16_rk, &
                                        1.701675917211234378e-16_rk, 1.041776055762581443e-16_rk, -4.880338717125844994e-01_rk,2.928460050057043964e-16_rk, &
                                        2.875186593496910059e-16_rk, -5.159646753753889802e-16_rk, -1.807173928445069165e-17_rk,-1.307682818044214046e-01_rk, &
                                        6.797434948471090088e+00_rk, 4.198770994348593184e-16_rk, 4.505767046840518581e-16_rk,1.015644730772774906e-16_rk, &
                                        -2.100095762266145262e-16_rk, 1.821367205045918425e+00_rk, -6.312745115102287224e-17_rk,3.658676435449230079e-17_rk, &
                                        4.104556533163370900e-16_rk, -1.831162764714175139e-16_rk, 1.821367205045917093e+00_rk,-1.717112478690525072e-16_rk, &
                                        2.852702273653430778e-16_rk, 8.844956019668094475e-18_rk, 1.244213213798512303e-16_rk,4.880338717125849435e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,1) = reshape((/                                                                                 &
                                        1.632993161855452291e+00_rk, -1.857176540879012884e-16_rk, -2.569018275106152671e-16_rk,-4.789655859280064799e-16_rk, &
                                        -8.161403293057227529e-16_rk, 2.575802203437516091e+00_rk, 5.385537320816410425e-17_rk,3.353472337560938728e-17_rk, &
                                        1.989249194172794812e-16_rk, 1.900875692214811028e-17_rk, 6.901841202733882685e-01_rk,-2.058749296419148151e-16_rk, &
                                        5.870828470842391641e-17_rk, 1.133736722148411949e-15_rk, -3.207788495939416568e-16_rk,1.632993161855451625e+00_rk, &
                                        -1.632993161855452735e+00_rk, -3.615654743862091736e-16_rk, -3.686679362069462497e-16_rk,-3.568232104341916670e-17_rk, &
                                        1.284485382656599525e-16_rk, -2.575802203437515203e+00_rk, 1.563563852647463304e-16_rk,-1.226852022100362560e-16_rk, &
                                        -4.998746627381380996e-16_rk, 2.509990197757107372e-16_rk, -6.901841202733887126e-01_rk,-1.465444951427965098e-16_rk, &
                                        1.983559623149333992e-16_rk, -2.933185371693030681e-16_rk, -1.769618319037403580e-16_rk,-1.632993161855452069e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,2) = reshape((/                                                                                 &
                                        9.428090415820632453e-01_rk, -4.129859299276933050e-17_rk, -1.780752069986398723e-16_rk,7.431723369911452512e-17_rk, &
                                        -1.780595333369050869e-16_rk, -1.241877962538955972e-16_rk, 1.274166911823975903e-16_rk,1.941006614955751044e-16_rk, &
                                        6.522437678596484771e-17_rk, 1.741238546056856736e-17_rk, 5.904124713867185554e-17_rk,-7.543092704928043237e-17_rk, &
                                        -3.420737210973809547e-17_rk, -1.407344563572349485e-16_rk, 1.385230615739040411e-16_rk,-9.428090415820624681e-01_rk, &
                                        -9.428090415820631343e-01_rk, 8.077126764024914973e-17_rk, 3.607492395040374134e-17_rk,-6.837073523445237534e-17_rk, &
                                        6.227178517368870530e-17_rk, -1.497868675198322270e-17_rk, 4.741495569438273047e-17_rk,1.836799197550179378e-16_rk, &
                                        -9.903471326468942411e-17_rk, -9.430528152670923615e-18_rk, -1.915812019446824055e-16_rk,1.302853792933887763e-16_rk, &
                                        -4.021355322115873535e-17_rk, 1.241710738261566398e-16_rk, 5.781353381479474354e-17_rk,9.428090415820626902e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -4.880338717125849435e-01_rk, 5.500607742309396557e-17_rk, 9.256537648327345447e-17_rk,2.543091320653223996e-16_rk, &
                                        6.215723188046441359e-16_rk, -1.821367205045918425e+00_rk, -4.556996386193914113e-17_rk,5.122361755893410864e-17_rk, &
                                        -6.961494598501234837e-17_rk, 9.686835716124040731e-17_rk, -1.307682818044211548e-01_rk,1.457533199898160726e-16_rk, &
                                        1.032142490577741108e-16_rk, -9.644036570012625960e-16_rk, 8.251057081902246412e-17_rk,-4.880338717125848325e-01_rk, &
                                        1.821367205045918425e+00_rk, 3.843088813208873676e-16_rk, 3.631736753704144418e-16_rk,1.211502041422952469e-16_rk, &
                                        -1.379373180417959992e-16_rk, 6.797434948471089200e+00_rk, 7.879829760162816588e-17_rk,3.486642077417096056e-16_rk, &
                                        4.562516241242163573e-16_rk, -1.887135108024516206e-16_rk, 4.880338717125849435e-01_rk,1.997910017199104444e-16_rk, &
                                        -5.193757158255623291e-17_rk, 6.660602686786513480e-16_rk, 8.438008492701913679e-17_rk,1.821367205045917093e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -1.632993161855452291e+00_rk, 1.569741023314117625e-16_rk, 2.381246747065583947e-16_rk,4.660226927640374010e-16_rk, &
                                        2.705197448983605995e-16_rk, -6.901841202733888236e-01_rk, -4.927949553486855051e-18_rk,1.816656220633465572e-17_rk, &
                                        -2.187173928804391745e-18_rk, 1.330305876421001348e-16_rk, -2.575802203437514315e+00_rk,-2.503472616406618575e-17_rk, &
                                        -1.126765332516947314e-16_rk, -6.596799341539276623e-16_rk, 2.340542752753536210e-16_rk,-1.632993161855451625e+00_rk, &
                                        1.632993161855452291e+00_rk, 2.356902229979278194e-16_rk, 3.093682125207646555e-16_rk,6.013067746428947888e-17_rk, &
                                        -4.113316147984701240e-17_rk, 6.901841202733891567e-01_rk, -1.479160706999616189e-16_rk,4.050935113136919395e-16_rk, &
                                        5.860966231120319302e-17_rk, -2.443181326957800764e-16_rk, 2.575802203437514759e+00_rk,-2.450610685038403792e-16_rk, &
                                        -1.472543446482723958e-16_rk, -1.602323813492069824e-16_rk, 2.625662229137520568e-16_rk,1.632993161855451625e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,2) = reshape((/                                                                                 &
                                        9.428090415820632453e-01_rk, -4.129859299276933050e-17_rk, -1.780752069986398723e-16_rk,7.431723369911452512e-17_rk, &
                                        -1.780595333369051855e-16_rk, 2.088791111336513650e-16_rk, 1.274166911823976643e-16_rk,1.941006614955751044e-16_rk, &
                                        6.522437678596484771e-17_rk, 1.741238546056856736e-17_rk, 5.904124713867185554e-17_rk,-7.543092704928045702e-17_rk, &
                                        -3.420737210973809547e-17_rk, -1.407344563572349978e-16_rk, 1.385230615739040411e-16_rk,-9.428090415820626902e-01_rk, &
                                        -9.428090415820640224e-01_rk, 8.077126764024919903e-17_rk, 3.607492395040374134e-17_rk,-6.837073523445242464e-17_rk, &
                                        6.227178517368872995e-17_rk, -1.497868675198322270e-17_rk, 4.741495569438269350e-17_rk,1.836799197550179871e-16_rk, &
                                        -9.903471326468942411e-17_rk, -9.430528152670966755e-18_rk, 2.525080079053802353e-16_rk,1.302853792933887517e-16_rk, &
                                        -4.021355322115871070e-17_rk, 1.241710738261566645e-16_rk, 5.781353381479479285e-17_rk,9.428090415820626902e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -4.880338717125848325e-01_rk, 4.638880807420437050e-17_rk, -6.385964095023363929e-18_rk,1.953601853852925339e-16_rk, &
                                        5.366839212186010284e-17_rk, -1.307682818044213491e-01_rk, 2.484374199656661318e-16_rk,5.328947424550879808e-17_rk, &
                                        2.631118860807483203e-16_rk, 1.629598740450718561e-16_rk, -1.821367205045917093e+00_rk,-3.830918626960366078e-17_rk, &
                                        5.953674477183938392e-17_rk, -4.286537897302348945e-17_rk, 3.033445465364605614e-17_rk,-4.880338717125848325e-01_rk, &
                                        1.821367205045918869e+00_rk, 8.680437330978628088e-17_rk, 4.433998810192868686e-16_rk,8.620862667469801062e-17_rk, &
                                        -9.491030003207192229e-17_rk, 4.880338717125849435e-01_rk, 1.497726447119576790e-16_rk,3.523827497775440515e-16_rk, &
                                        5.933917254933681049e-17_rk, -2.382781741936859237e-16_rk, 6.797434948471085647e+00_rk,2.564460755604906505e-17_rk, &
                                        1.392081761459412160e-16_rk, -1.733183717643931926e-16_rk, 3.527570785602939608e-16_rk,1.821367205045917537e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,1) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 1.437177587824477219e-17_rk, 9.388576402028448495e-18_rk,6.471446581984564098e-18_rk, &
                                        2.728102922036810027e-16_rk, -9.428090415820634673e-01_rk, -2.446371182733863076e-17_rk,-2.585064279097199685e-17_rk, &
                                        -9.836887274423750158e-17_rk, -7.601967228212407322e-17_rk, 9.428090415820626902e-01_rk,1.154548279029904819e-16_rk, &
                                        2.698412427163541365e-17_rk, -2.370283939972421435e-16_rk, 4.336228715929403025e-17_rk,-2.646282183987886213e-16_rk, &
                                        -8.503488173717676214e-17_rk, 6.293762569414067714e-17_rk, 2.964986184309078476e-17_rk,-1.222417821043514068e-17_rk, &
                                        -4.365768839290646391e-17_rk, 9.428090415820633563e-01_rk, -4.220157282392355712e-18_rk,-1.412041545518277555e-16_rk, &
                                        2.206325002134674780e-16_rk, -3.340443539965330407e-18_rk, -9.428090415820631343e-01_rk,1.958027818233183829e-16_rk, &
                                        -2.555080883333053865e-17_rk, 2.267754592592551115e-16_rk, -4.280219550500580013e-17_rk,4.159089947270663257e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,2) = reshape((/                                                                                 &
                                        6.901841202733883796e-01_rk, -1.300472852168871580e-16_rk, -6.943804410994690927e-17_rk,-5.468113730451363669e-16_rk, &
                                        -3.652705037651362935e-16_rk, 1.632993161855451625e+00_rk, -9.802502980157219080e-17_rk,-1.864165809109376770e-16_rk, &
                                        3.533166988707707027e-17_rk, -7.442330082054454879e-17_rk, 1.632993161855450737e+00_rk,-1.498917468964388847e-17_rk, &
                                        1.198997810897973639e-16_rk, 1.037442784508404606e-15_rk, -4.159396240085515568e-16_rk,2.575802203437513871e+00_rk, &
                                        -6.901841202733893788e-01_rk, -3.793991163323176092e-16_rk, -3.750929983142590707e-16_rk,2.046423598059810801e-17_rk, &
                                        2.251906469906474327e-17_rk, -1.632993161855452069e+00_rk, 1.047212722879712072e-16_rk,-4.475692765168820232e-16_rk, &
                                        -1.802074492599811606e-16_rk, 2.570891043884162226e-16_rk, -1.632993161855451847e+00_rk,-8.102709261286686629e-17_rk, &
                                        2.130187067027615836e-16_rk, -1.907141517362047196e-16_rk, -2.775775612235409263e-16_rk,-2.575802203437513871e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.307682818044212381e-01_rk, -6.287010011288235274e-17_rk, -2.064639812204363325e-16_rk,8.518176622915730208e-16_rk, &
                                        1.595613712317790614e-16_rk, -4.880338717125849435e-01_rk, 3.277754949173357548e-17_rk,1.739830754023226929e-17_rk, &
                                        9.375105101592406443e-18_rk, 7.896038671924270236e-17_rk, -4.880338717125846104e-01_rk,3.751250796233575641e-17_rk, &
                                        -8.249635345730376168e-17_rk, -5.412115585997665563e-16_rk, 2.644124085522555973e-16_rk,-1.821367205045917537e+00_rk, &
                                        4.880338717125852765e-01_rk, 3.715085184074030992e-16_rk, 1.913032477525104358e-16_rk,-7.072371497154306566e-17_rk, &
                                        -1.564745090168347669e-17_rk, 1.821367205045918425e+00_rk, 8.808899869473630040e-17_rk,8.099332166484291308e-16_rk, &
                                        -6.363084523434817254e-17_rk, -1.409293684171280316e-16_rk, 1.821367205045917537e+00_rk,1.323692979972097817e-17_rk, &
                                        8.146449001689268129e-17_rk, 5.431061479815235238e-16_rk, 3.265171744500705622e-16_rk,6.797434948471085647e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -8.278446286333985684e-18_rk, 6.058058752838486263e-17_rk,3.521175335926881349e-17_rk, &
                                        1.287584254161834236e-16_rk, -2.526249213086749767e-01_rk, -1.834309029960771178e-16_rk,2.438986151893551465e-17_rk, &
                                        -1.369045264921795480e-16_rk, 2.928591251466162701e-17_rk, 2.526249213086744216e-01_rk,1.469701843523652794e-17_rk, &
                                        3.900535194253363318e-18_rk, -4.145975715194996511e-16_rk, -6.468201602779262949e-18_rk,4.258361347375731324e-17_rk, &
                                        -8.031435379629484702e-16_rk, 1.474298293540764679e-16_rk, -8.637835588627509340e-17_rk,3.693160458312820247e-17_rk, &
                                        1.323299218399488633e-17_rk, 3.518611245019578782e+00_rk, -4.596628484960948758e-17_rk,1.385747482621620900e-16_rk, &
                                        6.002698583250696363e-17_rk, 3.838795313113576490e-17_rk, -3.518611245019579226e+00_rk,-7.266268559086664536e-17_rk, &
                                        -1.096096455804632527e-16_rk, 3.667548693811666288e-16_rk, -1.469689966075417717e-16_rk,-4.159089947270663257e-16_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -6.901841202733888236e-01_rk, -5.815824624701753890e-17_rk, 8.571489085547079022e-17_rk,1.636275235776108284e-16_rk, &
                                        8.792309578302557461e-16_rk, -4.375591989647142355e-01_rk, 1.347835251685438789e-16_rk,-1.013707755551239625e-16_rk, &
                                        5.432567380279294546e-16_rk, 2.914571570317812988e-16_rk, -4.375591989647134028e-01_rk,3.242702387299181632e-16_rk, &
                                        5.731801557397538692e-16_rk, -6.859571356440258763e-16_rk, -8.465731691759171601e-17_rk,-1.849342776560395918e-01_rk, &
                                        9.613024693476676319e+00_rk, 7.090666845550492265e-16_rk, 9.046021674890194023e-16_rk,1.739814562024661538e-16_rk, &
                                        -3.145838856046296062e-16_rk, 6.094413448457094873e+00_rk, 2.718995493930507871e-16_rk,4.672471189386873202e-16_rk, &
                                        5.667728245285570231e-16_rk, -3.226661895651045041e-16_rk, 6.094413448457089544e+00_rk,9.611433846544026322e-17_rk, &
                                        5.977342610267879354e-16_rk, 4.185577893605115292e-16_rk, 3.231104791603471522e-16_rk,2.575802203437513871e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,5,3) = reshape((/                                                                                 &
                                        1.821367205045917981e+00_rk, -5.854081451723049903e-17_rk, -3.184563591007900921e-16_rk,-1.724210628799871295e-16_rk, &
                                        -7.941892741822951113e-16_rk, 4.880338717125850545e-01_rk, 1.170076328571043249e-16_rk,2.666198681762858745e-16_rk, &
                                        -1.701675917211234378e-16_rk, -1.041776055762581443e-16_rk, 4.880338717125844994e-01_rk,-2.928460050057044950e-16_rk, &
                                        -2.875186593496911045e-16_rk, 5.159646753753889802e-16_rk, 1.807173928445069165e-17_rk,1.307682818044214046e-01_rk, &
                                        -6.797434948471090088e+00_rk, -4.198770994348593184e-16_rk, -4.505767046840518581e-16_rk,-1.015644730772774906e-16_rk, &
                                        2.100095762266145262e-16_rk, -1.821367205045918425e+00_rk, 6.312745115102287224e-17_rk,-3.658676435449230079e-17_rk, &
                                        -4.104556533163371886e-16_rk, 1.831162764714175139e-16_rk, -1.821367205045917093e+00_rk,1.717112478690525565e-16_rk, &
                                        -2.852702273653430778e-16_rk, -8.844956019668094475e-18_rk, -1.244213213798512303e-16_rk,-4.880338717125849435e-01_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,1) = reshape((/                                                                                 &
                                        4.375591989647141800e-01_rk, 1.109885805855959803e-16_rk, 4.680404684139404701e-17_rk,-6.049279857967780300e-16_rk, &
                                        -7.372992228768364008e-16_rk, 6.901841202733892677e-01_rk, 7.014995084980398479e-17_rk,7.025039750238123587e-17_rk, &
                                        -2.274303770972674380e-16_rk, -2.854994176294135792e-16_rk, 1.849342776560393697e-01_rk,-2.338501369909939286e-16_rk, &
                                        -3.496479383470921505e-16_rk, 9.776724931380726219e-16_rk, 2.990212358123686890e-17_rk,4.375591989647142355e-01_rk, &
                                        -6.094413448457096649e+00_rk, -7.415234946279913697e-16_rk, -5.988148680743694998e-16_rk,-1.574576499323827163e-16_rk, &
                                        2.261879017712351756e-16_rk, -9.613024693476674543e+00_rk, -2.854444859619503401e-16_rk,-9.689804680694330659e-16_rk, &
                                        -3.906047456315775815e-16_rk, 2.450170595188165143e-16_rk, -2.575802203437514759e+00_rk,-2.394438417886908765e-17_rk, &
                                        -3.842257497436698149e-16_rk, -1.038921296676557298e-15_rk, -2.612312968936430216e-16_rk,-6.094413448457092208e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,2) = reshape((/                                                                                 &
                                        2.526249213086745327e-01_rk, -4.455188805224444033e-17_rk, -1.930995252252495519e-16_rk,4.060887088598981786e-16_rk, &
                                        -2.706901603696028182e-16_rk, 1.316549379137994467e-17_rk, -2.150257302227080135e-17_rk,6.730516533807273660e-18_rk, &
                                        -1.789218344384825425e-16_rk, -3.524365191702945757e-17_rk, -5.904124713867185554e-17_rk,-1.051171201741608365e-16_rk, &
                                        -2.274327525869151436e-16_rk, 1.228822140254528068e-16_rk, 6.122339493913413471e-17_rk,-2.526249213086744216e-01_rk, &
                                        -3.518611245019579226e+00_rk, -1.149730192811343986e-16_rk, -2.194089435283749200e-16_rk,-5.345541085321163996e-17_rk, &
                                        7.516299164939961209e-17_rk, 1.497868675198322270e-17_rk, 5.951122141850902828e-17_rk,3.631586008685834585e-16_rk, &
                                        -2.361950647294865531e-16_rk, 3.926117691515240977e-17_rk, -2.525080079053802353e-16_rk,4.927313042953835066e-19_rk, &
                                        -1.038988657026549047e-16_rk, 2.536086379348789425e-16_rk, 8.508981434083746842e-17_rk,3.518611245019576117e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,6,3) = reshape((/                                                                                 &
                                        4.880338717125849435e-01_rk, -5.500607742309396557e-17_rk, -9.256537648327342982e-17_rk,-2.543091320653223996e-16_rk, &
                                        -6.215723188046441359e-16_rk, 1.821367205045918425e+00_rk, 4.556996386193911648e-17_rk,-5.122361755893413329e-17_rk, &
                                        6.961494598501234837e-17_rk, -9.686835716124040731e-17_rk, 1.307682818044211548e-01_rk,-1.457533199898160479e-16_rk, &
                                        -1.032142490577740615e-16_rk, 9.644036570012625960e-16_rk, -8.251057081902246412e-17_rk,4.880338717125848325e-01_rk, &
                                        -1.821367205045918425e+00_rk, -3.843088813208873676e-16_rk, -3.631736753704144418e-16_rk,-1.211502041422952469e-16_rk, &
                                        1.379373180417959992e-16_rk, -6.797434948471089200e+00_rk, -7.879829760162816588e-17_rk,-3.486642077417096056e-16_rk, &
                                        -4.562516241242163573e-16_rk, 1.887135108024516206e-16_rk, -4.880338717125849435e-01_rk,-1.997910017199104444e-16_rk, &
                                        5.193757158255623291e-17_rk, -6.660602686786513480e-16_rk, -8.438008492701913679e-17_rk,-1.821367205045917093e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -4.375591989647140689e-01_rk, -9.443168801292802744e-17_rk, -1.679652218981636860e-16_rk,5.345044790782401812e-16_rk, &
                                        4.797823720444697509e-16_rk, -1.849342776560393697e-01_rk, 2.967118551423502015e-16_rk,-1.190301205402521912e-16_rk, &
                                        5.012394300816264354e-16_rk, 2.269275926000902389e-16_rk, -6.901841202733882685e-01_rk,2.044561001205208234e-16_rk, &
                                        3.418468679585853992e-16_rk, -1.484773500990735416e-16_rk, -1.696572037567831835e-17_rk,-4.375591989647143465e-01_rk, &
                                        6.094413448457096649e+00_rk, 4.466638359198383845e-16_rk, 7.715715798469195140e-16_rk,8.359444076612631139e-17_rk, &
                                        -2.526538861392249606e-16_rk, 2.575802203437516091e+00_rk, 3.773770556611691427e-16_rk,6.918309715451086888e-16_rk, &
                                        2.705507739665636050e-16_rk, -3.217929657810879208e-16_rk, 9.613024693476670990e+00_rk,1.692697553606022798e-16_rk, &
                                        6.034450409045961478e-16_rk, 3.054115579142241387e-16_rk, 5.551692901087264663e-16_rk,6.094413448457091320e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,2) = reshape((/                                                                                 &
                                        2.526249213086745327e-01_rk, -4.455188805224444033e-17_rk, -1.930995252252495519e-16_rk,4.060887088598981786e-16_rk, &
                                        -2.706901603696029168e-16_rk, 1.241877962538955972e-16_rk, -2.150257302227075821e-17_rk,6.730516533807273660e-18_rk, &
                                        -1.789218344384825425e-16_rk, -3.524365191702945757e-17_rk, -5.904124713867185554e-17_rk,-1.051171201741608365e-16_rk, &
                                        -2.274327525869151436e-16_rk, 1.228822140254528561e-16_rk, 6.122339493913415936e-17_rk,-2.526249213086746437e-01_rk, &
                                        -3.518611245019580114e+00_rk, -1.149730192811344479e-16_rk, -2.194089435283749200e-16_rk,-5.345541085321168927e-17_rk, &
                                        7.516299164939958743e-17_rk, 1.497868675198322270e-17_rk, 5.951122141850896665e-17_rk,3.631586008685834092e-16_rk, &
                                        -2.361950647294865531e-16_rk, 3.926117691515236047e-17_rk, 1.079759621644807613e-15_rk,4.927313042954451363e-19_rk, &
                                        -1.038988657026549294e-16_rk, 2.536086379348788932e-16_rk, 8.508981434083751773e-17_rk,3.518611245019576117e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,7,3) = reshape((/                                                                                 &
                                        4.880338717125848325e-01_rk, -4.638880807420437050e-17_rk, 6.385964095023388581e-18_rk,-1.953601853852925339e-16_rk, &
                                        -5.366839212186010284e-17_rk, 1.307682818044213491e-01_rk, -2.484374199656661318e-16_rk,-5.328947424550882273e-17_rk, &
                                        -2.631118860807483203e-16_rk, -1.629598740450718561e-16_rk, 1.821367205045917093e+00_rk,3.830918626960368543e-17_rk, &
                                        -5.953674477183938392e-17_rk, 4.286537897302348945e-17_rk, -3.033445465364605614e-17_rk,4.880338717125848325e-01_rk, &
                                        -1.821367205045918869e+00_rk, -8.680437330978628088e-17_rk, -4.433998810192868686e-16_rk,-8.620862667469801062e-17_rk, &
                                        9.491030003207192229e-17_rk, -4.880338717125849435e-01_rk, -1.497726447119576790e-16_rk,-3.523827497775440515e-16_rk, &
                                        -5.933917254933681049e-17_rk, 2.382781741936859237e-16_rk, -6.797434948471085647e+00_rk,-2.564460755604908970e-17_rk, &
                                        -1.392081761459412160e-16_rk, 1.733183717643931926e-16_rk, -3.527570785602939608e-16_rk,-1.821367205045917537e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -8.278446286333973358e-18_rk, 6.058058752838476402e-17_rk,3.521175335926901070e-17_rk, &
                                        1.287584254161833250e-16_rk, -2.526249213086749767e-01_rk, -1.834309029960770685e-16_rk,2.438986151893546534e-17_rk, &
                                        -1.369045264921794494e-16_rk, 2.928591251466174411e-17_rk, 2.526249213086744216e-01_rk,1.469701843523655259e-17_rk, &
                                        3.900535194253474252e-18_rk, -4.145975715194996511e-16_rk, -6.468201602779287601e-18_rk,-6.843868898875834080e-17_rk, &
                                        8.503488173717676214e-17_rk, 1.474298293540764679e-16_rk, -8.637835588627489618e-17_rk,3.693160458312821480e-17_rk, &
                                        1.323299218399486168e-17_rk, 3.518611245019578782e+00_rk, -4.596628484960935199e-17_rk,1.385747482621622872e-16_rk, &
                                        6.002698583250701293e-17_rk, 3.838795313113562931e-17_rk, -3.518611245019575673e+00_rk,-7.266268559086654675e-17_rk, &
                                        -1.096096455804631048e-16_rk, 3.667548693811666288e-16_rk, -1.469689966075416237e-16_rk,1.804537054523246854e-15_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,2) = reshape((/                                                                                 &
                                        1.849342776560396473e-01_rk, 1.472620223515064319e-16_rk, 3.004841595950283383e-16_rk,-9.758049412974072842e-16_rk, &
                                        -3.378506370910500112e-16_rk, 4.375591989647142355e-01_rk, -9.177837912400236249e-17_rk,8.790974248750937824e-17_rk, &
                                        -1.854130691509643449e-16_rk, -2.209698531977223713e-16_rk, 4.375591989647135138e-01_rk,-1.140359983815965149e-16_rk, &
                                        -1.183146505659236312e-16_rk, 4.401927075931202626e-16_rk, -3.778947296067655340e-17_rk,6.901841202733887126e-01_rk, &
                                        -2.575802203437516535e+00_rk, -4.791206459927803306e-16_rk, -4.657842804322695129e-16_rk,-6.707063449604282460e-17_rk, &
                                        1.642579023058304560e-16_rk, -6.094413448457094873e+00_rk, -3.909219922300687943e-16_rk,-1.193564320675854237e-15_rk, &
                                        -9.438269506958397852e-17_rk, 2.441438357347997338e-16_rk, -6.094413448457091320e+00_rk,-9.709980107403110419e-17_rk, &
                                        -3.899365296214780766e-16_rk, -9.257750652302694141e-16_rk, -4.932901078420221384e-16_rk,-9.613024693476663884e+00_rk  &
                                        /),(/4,8/))
        
        test_dbr2_vol_face6_dx(:,:,8,3) = reshape((/                                                                                 &
                                        1.307682818044212381e-01_rk, 6.287010011288235274e-17_rk, 2.064639812204363325e-16_rk,-8.518176622915730208e-16_rk, &
                                        -1.595613712317788642e-16_rk, 4.880338717125849435e-01_rk, -3.277754949173360013e-17_rk,-1.739830754023226929e-17_rk, &
                                        -9.375105101592406443e-18_rk, -7.896038671924270236e-17_rk, 4.880338717125846104e-01_rk,-3.751250796233573175e-17_rk, &
                                        8.249635345730378633e-17_rk, 5.412115585997665563e-16_rk, -2.644124085522555973e-16_rk,1.821367205045917537e+00_rk, &
                                        -4.880338717125852765e-01_rk, -3.715085184074030992e-16_rk, -1.913032477525104358e-16_rk,7.072371497154306566e-17_rk, &
                                        1.564745090168347669e-17_rk, -1.821367205045918425e+00_rk, -8.808899869473630040e-17_rk,-8.099332166484291308e-16_rk, &
                                        6.363084523434827114e-17_rk, 1.409293684171280316e-16_rk, -1.821367205045917537e+00_rk,-1.323692979972095352e-17_rk, &
                                        -8.146449001689268129e-17_rk, -5.431061479815235238e-16_rk, -3.265171744500705622e-16_rk,-6.797434948471085647e+00_rk  &
                                        /),(/4,8/))
        
        



        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_vol_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_v_dx(:,:,inode_diff,idir),tol)
            end do
        end do


    end subroutine testElement_dbr2_vol_dx
    !*******************************************************************************************





    !> Test cartesian dbr2_face_dx 
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_dbr2_face_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        real(rk), dimension(self%faces(XI_MIN)%basis_s%nnodes_face(),  self%faces(XI_MIN)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face1_dx
        real(rk), dimension(self%faces(XI_MAX)%basis_s%nnodes_face(),  self%faces(XI_MAX)%basis_s%nnodes_face(),  self%elem%nterms_c,3) :: test_dbr2_face_face2_dx
        real(rk), dimension(self%faces(ETA_MIN)%basis_s%nnodes_face(), self%faces(ETA_MIN)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face3_dx
        real(rk), dimension(self%faces(ETA_MAX)%basis_s%nnodes_face(), self%faces(ETA_MAX)%basis_s%nnodes_face(), self%elem%nterms_c,3) :: test_dbr2_face_face4_dx
        real(rk), dimension(self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%faces(ZETA_MIN)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face5_dx
        real(rk), dimension(self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dbr2_face_face6_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode
        
        tol = 1.e-14_rk
       

        !
        ! dbr2_face_face1_dx
        ! 
        test_dbr2_face_face1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        3.450920601366942453e-01_rk, -9.740148877280145078e-17_rk, -2.616808181115189290e-17_rk,8.463551638954727490e-17_rk, &
                                        -3.694517709714435456e-16_rk, -4.806512346738336383e+00_rk, 1.622340906415732685e-17_rk,-3.154204379229916587e-18_rk, &
                                        1.841337117489672120e-16_rk, 1.960545699868484968e-16_rk, 9.246713882801904649e-02_rk,1.389703776866889614e-17_rk, &
                                        -1.913096319204770066e-16_rk, 4.339849260750593993e-17_rk, 6.130627469187013854e-17_rk,-1.287901101718757824e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.372935291994161489e+01_rk, 2.086080837800147538e-16_rk, -2.430673976465011323e-16_rk,3.379021564459647186e-16_rk, &
                                        5.961956778995687907e-16_rk, 8.577748513066584479e+00_rk, 3.408843772114425498e-16_rk,8.170634313613530728e-17_rk, &
                                        6.070342814306912956e-16_rk, -2.222475004861345161e-16_rk, 3.678769027500235378e+00_rk,9.882613211323323419e-17_rk, &
                                        4.553891758726604562e-16_rk, -7.763008387723627614e-17_rk, 2.252652014923843036e-16_rk,2.298400786953455732e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        9.464101615137749945e+00_rk, 1.750459537541938739e-16_rk, -5.629158836951210529e-16_rk,4.028160127613330854e-16_rk, &
                                        4.115969480348852435e-16_rk, 2.535898384862245614e+00_rk, 4.167210203627372842e-16_rk,-1.025561400791128894e-16_rk, &
                                        5.562741834965879013e-16_rk, -1.695886570484973894e-16_rk, 9.464101615137753498e+00_rk,2.362295651377669882e-16_rk, &
                                        4.555960839594132472e-16_rk, 9.033302073925136981e-17_rk, 7.355394226592317929e-16_rk,2.535898384862244725e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -9.267932633339974302e+00_rk, -1.411197184904488024e-16_rk, 2.381317395214626949e-16_rk,-2.915773589920152575e-16_rk, &
                                        -1.454524618983381071e-16_rk, -4.116328226464946560e+00_rk, -1.596180109494087000e-16_rk,-1.171154290089908524e-16_rk, &
                                        -5.857369374695561690e-16_rk, 1.680401822917157800e-16_rk, -2.483335064609496712e+00_rk,-1.057471680611430628e-16_rk, &
                                        -1.631883688626113664e-16_rk, -1.832474249102772186e-17_rk, -3.083715534055179873e-16_rk,-1.102966824062717954e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -4.806512346738334607e+00_rk, 2.991312348323543775e-17_rk, 3.110373993619051519e-17_rk,-1.309603138434966127e-16_rk, &
                                        -8.129144502978735990e-17_rk, 3.450920601366940232e-01_rk, -1.974897753261911459e-16_rk,3.856329025208542399e-17_rk, &
                                        -2.054310557101023386e-16_rk, -1.418472517924295635e-16_rk, -1.287901101718757602e+00_rk,-6.976001820759122993e-18_rk, &
                                        -1.008911750895723297e-16_rk, 5.255633376075813203e-17_rk, 2.180007722126358215e-17_rk,9.246713882801949058e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        3.154700538379251906e+00_rk, 1.977473787454585645e-16_rk, -2.175866673648995927e-16_rk,3.076758266249705007e-16_rk, &
                                        -1.742458867555759720e-16_rk, 8.452994616207483158e-01_rk, 2.429056331608246233e-16_rk,3.047160563102883195e-17_rk, &
                                        3.248557869678879639e-16_rk, -1.835381612009445922e-16_rk, 3.154700538379251462e+00_rk,-6.368256749997617402e-17_rk, &
                                        -2.068884605507067206e-17_rk, 1.969872164454514619e-17_rk, 2.623476202233447132e-16_rk,8.452994616207480938e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        8.577748513066588032e+00_rk, 3.359226960360516546e-16_rk, -1.857955758991588105e-16_rk,1.223063262129206584e-16_rk, &
                                        8.843560038412250257e-16_rk, 1.372935291994161489e+01_rk, 1.271711928210940339e-16_rk,1.234238377674506841e-16_rk, &
                                        2.174695139716218682e-16_rk, -5.601493222654124531e-16_rk, 2.298400786953457953e+00_rk,7.795309252380531984e-17_rk, &
                                        5.458076327035651824e-16_rk, -6.847224272398415800e-17_rk, 1.857590040217777349e-16_rk,3.678769027500233157e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -4.806512346738333719e+00_rk, 2.991312348323543159e-17_rk, 3.110373993619051519e-17_rk,-1.309603138434966127e-16_rk, &
                                        -8.129144502978735990e-17_rk, 3.450920601366940232e-01_rk, -1.974897753261912691e-16_rk,3.856329025208541166e-17_rk, &
                                        -2.054310557101024372e-16_rk, -1.418472517924296868e-16_rk, -1.287901101718758046e+00_rk,-6.976001820759073689e-18_rk, &
                                        -1.008911750895722804e-16_rk, 5.255633376075813203e-17_rk, 2.180007722126358215e-17_rk,9.246713882801993467e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        2.535898384862245614e+00_rk, 3.002485565733625272e-17_rk, -6.141300356607543816e-17_rk,4.858725895492313416e-16_rk, &
                                        6.296559004681635150e-16_rk, 9.464101615137751722e+00_rk, 4.226071400506898108e-17_rk,5.746711184470451417e-17_rk, &
                                        1.338548570398220179e-17_rk, -5.011107884715563852e-16_rk, 2.535898384862245614e+00_rk,1.433298435651634384e-16_rk, &
                                        4.815138994405543380e-16_rk, 4.274471063418023095e-16_rk, 2.337646044486247190e-16_rk,9.464101615137751722e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        3.450920601366942453e-01_rk, -9.740148877280137682e-17_rk, -2.616808181115197302e-17_rk,8.463551638954728722e-17_rk, &
                                        -3.694517709714433484e-16_rk, -4.806512346738333719e+00_rk, 1.622340906415735150e-17_rk,-3.154204379229916587e-18_rk, &
                                        1.841337117489670641e-16_rk, 1.960545699868482503e-16_rk, 9.246713882801904649e-02_rk,1.389703776866887148e-17_rk, &
                                        -1.913096319204769080e-16_rk, 4.339849260750593993e-17_rk, 6.130627469187018785e-17_rk,-1.287901101718756047e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -4.116328226464945672e+00_rk, -2.684343307464855800e-16_rk, 1.808599177741201513e-16_rk,-7.598152875897151780e-17_rk, &
                                        -4.336127878399940709e-16_rk, -9.267932633339974302e+00_rk, 5.409517344093982823e-17_rk,-1.588329236403061799e-16_rk, &
                                        -1.961721700104865691e-16_rk, 5.059420040709937417e-16_rk, -1.102966824062719287e+00_rk,-8.487412847171502519e-17_rk, &
                                        -2.536068256935158461e-16_rk, -2.748258364427998792e-17_rk, -2.688653559349114186e-16_rk,-2.483335064609494491e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        8.452994616207485379e-01_rk, 1.950694992168809903e-16_rk, -9.087416152683391041e-17_rk,7.120850754020222524e-17_rk, &
                                        1.117501317736737182e-16_rk, 3.154700538379250574e+00_rk, -1.707200165354106282e-16_rk,1.388254854838171240e-16_rk, &
                                        6.491478799021043528e-17_rk, -3.646394012689533734e-16_rk, 8.452994616207483158e-01_rk,1.179500820548319453e-16_rk, &
                                        1.612409763206859354e-16_rk, 2.456051607063601999e-16_rk, 2.751154188393590652e-16_rk,3.154700538379251018e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        9.246713882801960160e-02_rk, 2.159992222061299378e-16_rk, -8.426337490374461849e-17_rk,-2.106396558387838395e-16_rk, &
                                        -1.989926341824479269e-16_rk, -1.287901101718757602e+00_rk, 1.256539738815041039e-16_rk,-1.593450112602375181e-17_rk, &
                                        3.610905041295756095e-17_rk, 2.850318827542918029e-17_rk, 3.450920601366925800e-01_rk,-1.602769174226062874e-16_rk, &
                                        -1.638013349499814120e-16_rk, -3.317201404447977115e-16_rk, -4.109503041080374113e-17_rk,-4.806512346738336383e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        3.678769027500234490e+00_rk, 2.000035695699278196e-16_rk, -7.502984388144828404e-16_rk,7.928891782187889568e-16_rk, &
                                        3.079138171591691068e-16_rk, 2.298400786953456176e+00_rk, 4.500911993586958859e-16_rk,-1.645605638847127935e-16_rk, &
                                        4.188289108516504298e-16_rk, -5.017069933821629069e-16_rk, 1.372935291994162199e+01_rk,2.915720517468261248e-16_rk, &
                                        5.147735052163411992e-16_rk, 5.215601140852354326e-16_rk, 1.165748943987471639e-15_rk,8.577748513066586256e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -9.464101615137751722e+00_rk, -1.750459537541938739e-16_rk, 5.629158836951210529e-16_rk,-4.028160127613330854e-16_rk, &
                                        -4.115969480348852435e-16_rk, -2.535898384862245614e+00_rk, -4.167210203627374321e-16_rk,1.025561400791129140e-16_rk, &
                                        -5.562741834965879013e-16_rk, 1.695886570484973894e-16_rk, -9.464101615137755275e+00_rk,-2.362295651377670375e-16_rk, &
                                        -4.555960839594132472e-16_rk, -9.033302073925136981e-17_rk, -7.355394226592317929e-16_rk,-2.535898384862244725e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -2.483335064609494935e+00_rk, -4.002484530728854604e-16_rk, 5.318816509062457503e-16_rk,-4.787279205892865615e-16_rk, &
                                        2.181108908899093977e-17_rk, -1.102966824062718842e+00_rk, -3.578514078284539031e-16_rk,4.837577097344198827e-17_rk, &
                                        -3.129254564124282041e-16_rk, 4.692782572280713859e-16_rk, -9.267932633339977855e+00_rk,-5.463491158179613231e-17_rk, &
                                        -2.437228526676919328e-16_rk, -2.470776229797692258e-16_rk, -7.772849010333112352e-16_rk,-4.116328226464946560e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.287901101718757157e+00_rk, -1.575433870317221073e-17_rk, 3.026801628119816593e-16_rk,-1.035216017907184326e-16_rk, &
                                        -1.307322720657120705e-16_rk, 9.246713882801937956e-02_rk, -2.178937654117460620e-16_rk,1.321192940372945077e-16_rk, &
                                        -1.420125048521798483e-16_rk, 3.925547878662488549e-18_rk, -4.806512346738337271e+00_rk,-7.666022274242384060e-17_rk, &
                                        -1.072493175986680024e-16_rk, 5.723764933933119656e-17_rk, -3.473690125433566262e-16_rk,3.450920601366939122e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -3.154700538379251018e+00_rk, -1.977473787454585645e-16_rk, 2.175866673648995927e-16_rk,-3.076758266249705007e-16_rk, &
                                        1.742458867555759720e-16_rk, -8.452994616207483158e-01_rk, -2.429056331608245740e-16_rk,-3.047160563102885660e-17_rk, &
                                        -3.248557869678879639e-16_rk, 1.835381612009445922e-16_rk, -3.154700538379250574e+00_rk,6.368256749997619867e-17_rk, &
                                        2.068884605507067206e-17_rk, -1.969872164454514619e-17_rk, -2.623476202233447132e-16_rk,-8.452994616207480938e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.298400786953456176e+00_rk, -3.174999133937431653e-17_rk, -3.633549010987565626e-16_rk,9.000072322668540432e-16_rk, &
                                        3.761741792759049632e-16_rk, 3.678769027500233157e+00_rk, 1.065434600654456953e-16_rk,-1.650676872139452163e-17_rk, &
                                        2.407073555865130575e-16_rk, -5.262846337789297958e-16_rk, 8.577748513066591585e+00_rk,3.751887464270086209e-16_rk, &
                                        5.713255225676547567e-16_rk, 9.105179038693643530e-16_rk, 8.594749618549185942e-16_rk,1.372935291994161666e+01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -1.287901101718757602e+00_rk, -1.575433870317230317e-17_rk, 3.026801628119817579e-16_rk,-1.035216017907184326e-16_rk, &
                                        -1.307322720657120951e-16_rk, 9.246713882801937956e-02_rk, -2.178937654117461360e-16_rk,1.321192940372945077e-16_rk, &
                                        -1.420125048521798483e-16_rk, 3.925547878662414594e-18_rk, -4.806512346738336383e+00_rk,-7.666022274242379130e-17_rk, &
                                        -1.072493175986678545e-16_rk, 5.723764933933129517e-17_rk, -3.473690125433566262e-16_rk,3.450920601366952445e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -2.535898384862244725e+00_rk, -3.002485565733625272e-17_rk, 6.141300356607543816e-17_rk,-4.858725895492313416e-16_rk, &
                                        -6.296559004681635150e-16_rk, -9.464101615137751722e+00_rk, -4.226071400506893178e-17_rk,-5.746711184470451417e-17_rk, &
                                        -1.338548570398220179e-17_rk, 5.011107884715563852e-16_rk, -2.535898384862245614e+00_rk,-1.433298435651634138e-16_rk, &
                                        -4.815138994405543380e-16_rk, -4.274471063418023095e-16_rk, -2.337646044486247190e-16_rk,-9.464101615137751722e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        9.246713882801960160e-02_rk, 2.159992222061298638e-16_rk, -8.426337490374464314e-17_rk,-2.106396558387836423e-16_rk, &
                                        -1.989926341824479269e-16_rk, -1.287901101718756713e+00_rk, 1.256539738815040793e-16_rk,-1.593450112602372716e-17_rk, &
                                        3.610905041295753630e-17_rk, 2.850318827542903238e-17_rk, 3.450920601366943563e-01_rk,-1.602769174226062135e-16_rk, &
                                        -1.638013349499813134e-16_rk, -3.317201404447975143e-16_rk, -4.109503041080359322e-17_rk,-4.806512346738332830e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.102966824062718398e+00_rk, -1.684948921635832749e-16_rk, 1.449381131905193493e-16_rk,-5.858459746373520423e-16_rk, &
                                        -4.644927302774489814e-17_rk, -2.483335064609494935e+00_rk, -1.430366853520365088e-17_rk,-9.967802418987624661e-17_rk, &
                                        -1.348039011472906839e-16_rk, 4.938558976248381763e-16_rk, -4.116328226464947448e+00_rk,-1.382516062619785668e-16_rk, &
                                        -3.002748700190053423e-16_rk, -6.360354127638978504e-16_rk, -4.710109189007581899e-16_rk,-9.267932633339976078e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -8.452994616207478717e-01_rk, -1.950694992168809903e-16_rk, 9.087416152683391041e-17_rk,-7.120850754020222524e-17_rk, &
                                        -1.117501317736737182e-16_rk, -3.154700538379250574e+00_rk, 1.707200165354106775e-16_rk,-1.388254854838171240e-16_rk, &
                                        -6.491478799021043528e-17_rk, 3.646394012689533734e-16_rk, -8.452994616207483158e-01_rk,-1.179500820548319700e-16_rk, &
                                        -1.612409763206859354e-16_rk, -2.456051607063601999e-16_rk, -2.751154188393590652e-16_rk,-3.154700538379251018e+00_rk  &
                                        /),(/4,4/))
        
        


        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face1_dx(:,:,inode_diff,idir)),self%faces(XI_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face2_dx
        ! 
        test_dbr2_face_face2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        4.806512346738336383e+00_rk, 8.049665897731008406e-17_rk, -2.425310383268455727e-16_rk,-3.455290479725735740e-17_rk, &
                                        -1.187205713934841155e-16_rk, -3.450920601366945784e-01_rk, -1.296555802248740481e-16_rk,-4.447564917984183138e-17_rk, &
                                        2.625292868839119869e-16_rk, -5.951502964599880314e-17_rk, 1.287901101718757602e+00_rk,-2.096358793373033133e-16_rk, &
                                        -3.723810436014756430e-16_rk, -9.896887737079145062e-18_rk, 1.893590971964032807e-17_rk,-9.246713882801968487e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        9.267932633339972526e+00_rk, -2.480732672378499933e-16_rk, -3.495861652373273509e-16_rk,2.746215748884225283e-17_rk, &
                                        -5.445396113846603712e-16_rk, 4.116328226464944784e+00_rk, -9.782798956074172143e-17_rk,2.478939355216162308e-16_rk, &
                                        -5.003485411362343521e-17_rk, -8.585577385149075236e-16_rk, 2.483335064609496268e+00_rk,2.100590657092394497e-16_rk, &
                                        -8.288745233890793931e-17_rk, 3.786767297964466404e-16_rk, 3.700724467389883198e-16_rk,1.102966824062717954e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        3.154700538379249686e+00_rk, -1.623230323288578485e-16_rk, -7.390970700607437239e-17_rk,7.909419114039110923e-17_rk, &
                                        -4.164491886537536849e-16_rk, 8.452994616207480938e-01_rk, 9.589037339972952274e-17_rk,2.079022145776058152e-16_rk, &
                                        -6.734081264565225998e-17_rk, -8.135645953339872512e-16_rk, 3.154700538379250574e+00_rk,1.953191160910520198e-16_rk, &
                                        2.042491878750896186e-16_rk, -2.511969621082736877e-18_rk, 4.930487469331387762e-16_rk,8.452994616207485379e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.372935291994161844e+01_rk, 2.444516131010197883e-17_rk, 5.345617838750436508e-16_rk,1.820729438662656786e-16_rk, &
                                        1.421495597221743149e-16_rk, -8.577748513066588032e+00_rk, 3.251343072360244942e-16_rk,-2.908685236296673555e-16_rk, &
                                        -3.113396933835975312e-16_rk, 9.432558194383180498e-16_rk, -3.678769027500233602e+00_rk,4.332247604834847732e-17_rk, &
                                        4.974462394272953782e-16_rk, -4.849447349750800642e-16_rk, -3.273726799041698116e-16_rk,-2.298400786953455732e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.450920601366934126e-01_rk, 1.431314469504379119e-16_rk, 5.755541968912924804e-17_rk,-1.749821965578504631e-16_rk, &
                                        5.211106230559699253e-16_rk, 4.806512346738331942e+00_rk, -9.765073745040866299e-17_rk,8.745023728789273415e-17_rk, &
                                        9.884526061330894261e-17_rk, -2.518305127741150127e-17_rk, -9.246713882801960160e-02_rk,-4.374566242028470613e-17_rk, &
                                        -4.217774348691183278e-17_rk, 1.161648929157123223e-16_rk, -6.163567655445876228e-17_rk,1.287901101718757380e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        9.464101615137751722e+00_rk, -1.374222204969272656e-16_rk, -9.018552193336454939e-17_rk,-1.386178785666767470e-16_rk, &
                                        -1.488487935741087323e-16_rk, 2.535898384862244281e+00_rk, -9.112755088542165708e-18_rk,3.946121109044436035e-17_rk, &
                                        4.392657308768673285e-16_rk, -8.393616637395337799e-16_rk, 9.464101615137753498e+00_rk,-2.280480060528040436e-16_rk, &
                                        -4.048142224882028749e-16_rk, 3.669557544800634795e-16_rk, 3.828075693996699446e-16_rk,2.535898384862245170e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        4.116328226464947448e+00_rk, -1.854384792647221408e-16_rk, -4.949970722135262879e-17_rk,-1.129671342717509145e-16_rk, &
                                        9.529158306479381742e-17_rk, 9.267932633339974302e+00_rk, -6.582314678627650887e-17_rk,3.798198219893508703e-16_rk, &
                                        -2.137188803842264671e-16_rk, -8.242257601463202463e-16_rk, 1.102966824062718842e+00_rk,3.759492826262581308e-16_rk, &
                                        2.473158477756558093e-16_rk, 5.047385104492383050e-16_rk, 2.895008604648892541e-16_rk,2.483335064609495380e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.450920601366943008e-01_rk, 1.431314469504380105e-16_rk, 5.755541968912934665e-17_rk,-1.749821965578504631e-16_rk, &
                                        5.211106230559703197e-16_rk, 4.806512346738333719e+00_rk, -9.765073745040872462e-17_rk,8.745023728789278346e-17_rk, &
                                        9.884526061330895493e-17_rk, -2.518305127741171081e-17_rk, -9.246713882801960160e-02_rk,-4.374566242028468148e-17_rk, &
                                        -4.217774348691173417e-17_rk, 1.161648929157124209e-16_rk, -6.163567655445876228e-17_rk,1.287901101718756491e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        8.452994616207483158e-01_rk, -2.610237100074175821e-16_rk, 1.863153095032725991e-16_rk,-1.624084190203724847e-16_rk, &
                                        2.670349874283848027e-17_rk, 3.154700538379250130e+00_rk, 2.070941313434594815e-16_rk,-5.708641478051176560e-17_rk, &
                                        -2.364451660732136176e-16_rk, -4.982618158178643658e-16_rk, 8.452994616207480938e-01_rk,2.077430913765904174e-16_rk, &
                                        2.618416427985653449e-16_rk, 5.463211973659563133e-16_rk, 2.842250743325609942e-16_rk,3.154700538379250130e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        4.806512346738334607e+00_rk, 8.049665897731007174e-17_rk, -2.425310383268454740e-16_rk,-3.455290479725740671e-17_rk, &
                                        -1.187205713934840168e-16_rk, -3.450920601366928020e-01_rk, -1.296555802248739495e-16_rk,-4.447564917984175126e-17_rk, &
                                        2.625292868839119869e-16_rk, -5.951502964599872919e-17_rk, 1.287901101718757602e+00_rk,-2.096358793373032640e-16_rk, &
                                        -3.723810436014755444e-16_rk, -9.896887737079145062e-18_rk, 1.893590971964032807e-17_rk,-9.246713882801924078e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -8.577748513066586256e+00_rk, -3.818962666302591679e-17_rk, 2.344753258590687069e-16_rk,3.225022356268586610e-16_rk, &
                                        -4.976816347272799724e-16_rk, -1.372935291994161133e+01_rk, 2.931294644615590844e-16_rk,-4.227944100974017484e-16_rk, &
                                        -1.476556671129944377e-16_rk, 9.089238410697305754e-16_rk, -2.298400786953457064e+00_rk,-1.225677408686700620e-16_rk, &
                                        1.672429393127315063e-16_rk, -6.110065156278713343e-16_rk, -2.468010936300707952e-16_rk,-3.678769027500233157e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        2.535898384862246502e+00_rk, 1.893901990785567417e-16_rk, -3.148703604285425223e-17_rk,-6.157274715309521312e-16_rk, &
                                        7.505464590255174461e-16_rk, 9.464101615137749945e+00_rk, -1.568058856604859999e-16_rk,4.934415864669806270e-16_rk, &
                                        2.439131054758407860e-16_rk, -5.204042600159022109e-16_rk, 2.535898384862245614e+00_rk,2.173450917139048832e-17_rk, &
                                        -2.513667929280492795e-17_rk, 6.321417245223123174e-16_rk, 2.218316663974536272e-16_rk,9.464101615137751722e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        1.287901101718757602e+00_rk, 6.902792420315595888e-18_rk, 4.701542541428075250e-17_rk,5.137535728015849888e-17_rk, &
                                        -5.413644956672352324e-18_rk, -9.246713882801968487e-02_rk, -2.322577531042415558e-17_rk,1.127451301406566576e-16_rk, &
                                        2.152704704711347359e-16_rk, -1.816789858811136385e-16_rk, 4.806512346738336383e+00_rk,-9.851496083574903897e-17_rk, &
                                        -9.901583946058380497e-17_rk, -1.169336332380641504e-16_rk, 5.077244104860167988e-17_rk,-3.450920601366950224e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        2.483335064609495380e+00_rk, -2.632299859629529839e-16_rk, 3.130360798630195007e-16_rk,-1.284638160124535195e-16_rk, &
                                        -1.307782455139710051e-16_rk, 1.102966824062717732e+00_rk, 3.734314298221568552e-16_rk,3.366129493239443773e-17_rk, &
                                        9.821636030566557890e-17_rk, -1.237838979142377640e-15_rk, 9.267932633339977855e+00_rk,5.180613439848642645e-17_rk, &
                                        2.706425433132733218e-16_rk, 2.635551344488493867e-16_rk, 7.988670837407676008e-16_rk,4.116328226464945672e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -3.154700538379251462e+00_rk, 1.623230323288578485e-16_rk, 7.390970700607439704e-17_rk,-7.909419114039110923e-17_rk, &
                                        4.164491886537538821e-16_rk, -8.452994616207480938e-01_rk, -9.589037339972952274e-17_rk,-2.079022145776058152e-16_rk, &
                                        6.734081264565221068e-17_rk, 8.135645953339872512e-16_rk, -3.154700538379251462e+00_rk,-1.953191160910520198e-16_rk, &
                                        -2.042491878750896186e-16_rk, 2.511969621082736877e-18_rk, -4.930487469331387762e-16_rk,-8.452994616207485379e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -3.678769027500234046e+00_rk, 1.507598295318592861e-16_rk, -3.324934439023095917e-16_rk,3.934193715646633089e-16_rk, &
                                        -1.678880225625861177e-16_rk, -2.298400786953455288e+00_rk, -2.691731536001905985e-16_rk,-2.608630139438827449e-16_rk, &
                                        -4.347313263380815696e-16_rk, 1.187039252667739432e-15_rk, -1.372935291994162199e+01_rk,1.257060166794718788e-16_rk, &
                                        -5.160414515682645613e-17_rk, -4.792245391289608866e-16_rk, -7.194957645234269698e-16_rk,-8.577748513066589808e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -9.246713882801910200e-02_rk, 1.055673640107781513e-16_rk, -2.755806137499069846e-17_rk,-3.163309128323680911e-16_rk, &
                                        3.040799130332293642e-16_rk, 1.287901101718756713e+00_rk, -8.103250091154215045e-17_rk,1.144565888708316126e-16_rk, &
                                        1.212444955612811193e-16_rk, 2.324787123557519695e-16_rk, -3.450920601366942453e-01_rk,-7.899719024220925392e-17_rk, &
                                        -1.200225586958630977e-16_rk, 3.326030379181752312e-16_rk, -1.301437602659422863e-16_rk,4.806512346738332830e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -9.464101615137751722e+00_rk, 1.374222204969272656e-16_rk, 9.018552193336454939e-17_rk,1.386178785666767470e-16_rk, &
                                        1.488487935741087323e-16_rk, -2.535898384862244281e+00_rk, 9.112755088542165708e-18_rk,-3.946121109044436035e-17_rk, &
                                        -4.392657308768673285e-16_rk, 8.393616637395337799e-16_rk, -9.464101615137753498e+00_rk,2.280480060528040436e-16_rk, &
                                        4.048142224882028749e-16_rk, -3.669557544800634795e-16_rk, -3.828075693996699446e-16_rk,-2.535898384862245170e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.102966824062718620e+00_rk, -1.645654143724904285e-16_rk, 2.384625930737479634e-16_rk,-4.961700861249801587e-16_rk, &
                                        1.787153124759307483e-16_rk, 2.483335064609495380e+00_rk, 3.156247042210388850e-16_rk,3.537275366256947900e-17_rk, &
                                        4.190385395812020830e-18_rk, -8.236812809055123030e-16_rk, 4.116328226464949225e+00_rk,7.132390499202614987e-17_rk, &
                                        2.496358240779939798e-16_rk, 7.130918056050889409e-16_rk, 6.179508824262235114e-16_rk,9.267932633339976078e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -9.246713882801999018e-02_rk, 1.055673640107781513e-16_rk, -2.755806137499069846e-17_rk,-3.163309128323680911e-16_rk, &
                                        3.040799130332294628e-16_rk, 1.287901101718756713e+00_rk, -8.103250091154211347e-17_rk,1.144565888708315633e-16_rk, &
                                        1.212444955612811193e-16_rk, 2.324787123557517723e-16_rk, -3.450920601366942453e-01_rk,-7.899719024220927857e-17_rk, &
                                        -1.200225586958630977e-16_rk, 3.326030379181753298e-16_rk, -1.301437602659422863e-16_rk,4.806512346738333719e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -8.452994616207483158e-01_rk, 2.610237100074175821e-16_rk, -1.863153095032725991e-16_rk,1.624084190203724847e-16_rk, &
                                        -2.670349874283852957e-17_rk, -3.154700538379250130e+00_rk, -2.070941313434594815e-16_rk,5.708641478051176560e-17_rk, &
                                        2.364451660732136176e-16_rk, 4.982618158178643658e-16_rk, -8.452994616207485379e-01_rk,-2.077430913765904174e-16_rk, &
                                        -2.618416427985653449e-16_rk, -5.463211973659563133e-16_rk, -2.842250743325609942e-16_rk,-3.154700538379250130e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        1.287901101718757602e+00_rk, 6.902792420315558911e-18_rk, 4.701542541428088808e-17_rk,5.137535728015835097e-17_rk, &
                                        -5.413644956672266042e-18_rk, -9.246713882801968487e-02_rk, -2.322577531042413093e-17_rk,1.127451301406565837e-16_rk, &
                                        2.152704704711347359e-16_rk, -1.816789858811137125e-16_rk, 4.806512346738336383e+00_rk,-9.851496083574898967e-17_rk, &
                                        -9.901583946058370636e-17_rk, -1.169336332380639532e-16_rk, 5.077244104860187710e-17_rk,-3.450920601366919138e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -2.298400786953456176e+00_rk, 5.209525794139671833e-17_rk, -2.579199571130380545e-16_rk,7.611256416771896770e-16_rk, &
                                        -4.773815805524878958e-16_rk, -3.678769027500231381e+00_rk, -2.113664279990726036e-16_rk,-2.625744726740576506e-16_rk, &
                                        -3.407053514282278051e-16_rk, 7.728815544308738981e-16_rk, -8.577748513066591585e+00_rk,1.061882460859321184e-16_rk, &
                                        -3.059742592154715112e-17_rk, -9.287612102851999477e-16_rk, -5.385795632088828804e-16_rk,-1.372935291994161311e+01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.535898384862244725e+00_rk, -1.893901990785567417e-16_rk, 3.148703604285425223e-17_rk,6.157274715309521312e-16_rk, &
                                        -7.505464590255174461e-16_rk, -9.464101615137749945e+00_rk, 1.568058856604859999e-16_rk,-4.934415864669806270e-16_rk, &
                                        -2.439131054758406874e-16_rk, 5.204042600159022109e-16_rk, -2.535898384862244725e+00_rk,-2.173450917139048832e-17_rk, &
                                        2.513667929280487865e-17_rk, -6.321417245223123174e-16_rk, -2.218316663974536272e-16_rk,-9.464101615137751722e+00_rk  &
                                        /),(/4,4/))
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face2_dx(:,:,inode_diff,idir)),self%faces(XI_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face3_dx
        ! 
        test_dbr2_face_face3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -3.450920601366944673e-01_rk, -2.427613374951953738e-16_rk, 1.513336095275351571e-16_rk,-1.573994732857144103e-16_rk, &
                                        2.097722198569631978e-16_rk, 4.806512346738336383e+00_rk, 3.396904048427175830e-16_rk,1.402736236107002029e-16_rk, &
                                        -1.589010185635695549e-16_rk, -7.421509466322724958e-16_rk, -9.246713882801971263e-02_rk,-6.383095586392118747e-17_rk, &
                                        -1.185793409865993352e-16_rk, -4.502578599184219556e-18_rk, -1.720004777924026809e-16_rk,1.287901101718757602e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.372935291994161844e+01_rk, 3.059010442393144059e-16_rk, -1.031698048838454123e-15_rk,5.096251312342144486e-16_rk, &
                                        6.257534773608907166e-16_rk, 8.577748513066584479e+00_rk, 1.084467512785450012e-15_rk,-7.416779410319329908e-17_rk, &
                                        -4.864413284832793776e-17_rk, -1.246316690237266789e-15_rk, 3.678769027500233602e+00_rk,3.614378801551666713e-16_rk, &
                                        -1.832194052637491783e-17_rk, 4.233764268133629854e-16_rk, -3.491782401524992942e-16_rk,2.298400786953457064e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        9.464101615137751722e+00_rk, 2.153333976919027363e-16_rk, -1.659966383662451716e-15_rk,5.639998999804129903e-16_rk, &
                                        2.197978526655218117e-16_rk, 2.535898384862244281e+00_rk, 8.949616580459060931e-16_rk,5.379286832883404291e-17_rk, &
                                        2.510294514625254968e-16_rk, -9.776610729811422394e-16_rk, 9.464101615137753498e+00_rk,6.577546399281105552e-16_rk, &
                                        -4.397431270060254837e-17_rk, 1.502919358818402367e-16_rk, -5.196518733190228356e-16_rk,2.535898384862244725e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -8.577748513066589808e+00_rk, 1.005338830528968630e-16_rk, 6.816339232403838034e-16_rk,-9.926426014839938629e-17_rk, &
                                        -6.408947853913700405e-16_rk, -1.372935291994161666e+01_rk, -1.368935401586868213e-15_rk,-7.746564938198325456e-17_rk, &
                                        1.959173961375401737e-16_rk, 1.932296858990996056e-15_rk, -2.298400786953457064e+00_rk,-1.093251670292900022e-16_rk, &
                                        1.932782549102589868e-16_rk, -4.324099193350206026e-16_rk, 5.232205667465479511e-16_rk,-3.678769027500233602e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -4.806512346738335495e+00_rk, -1.636735897970159814e-16_rk, 1.987305160705353102e-16_rk,-2.529613978001006027e-16_rk, &
                                        -1.946309118264839231e-16_rk, 3.450920601366950224e-01_rk, -5.522251604129992382e-17_rk,1.135981987447645554e-17_rk, &
                                        1.162775527435728199e-17_rk, 5.617077787854352531e-17_rk, -1.287901101718757602e+00_rk,-1.882817572619555556e-16_rk, &
                                        -5.637697339728465368e-17_rk, 1.353607112084157789e-17_rk, -2.041848801645963758e-18_rk,9.246713882801937956e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        2.535898384862245614e+00_rk, -5.152684629042110161e-16_rk, -3.027055329942537083e-16_rk,1.344778067689406771e-16_rk, &
                                        4.557419612224509340e-16_rk, 9.464101615137751722e+00_rk, 9.025733688720696935e-16_rk,-5.541007057320581175e-17_rk, &
                                        -3.929532351504725451e-17_rk, -1.525553559624713091e-15_rk, 2.535898384862245614e+00_rk,4.969759205893840015e-16_rk, &
                                        -3.470560189434929270e-16_rk, 5.905109224095814893e-16_rk, -4.088727045329290479e-16_rk,9.464101615137753498e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        9.267932633339979631e+00_rk, 3.849887919374938476e-16_rk, -9.843011422954541176e-16_rk,4.140632067198280837e-16_rk, &
                                        2.213503456774438422e-16_rk, 4.116328226464947448e+00_rk, 6.895545919014329486e-16_rk,-2.030815978394170649e-16_rk, &
                                        1.218846409895988621e-16_rk, -4.479949657264513598e-16_rk, 2.483335064609497156e+00_rk,2.369870787571323524e-16_rk, &
                                        4.388042706293968974e-17_rk, 4.414150765333888938e-16_rk, -1.792196111617426879e-16_rk,1.102966824062718842e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -4.806512346738335495e+00_rk, -1.636735897970158335e-16_rk, 1.987305160705353102e-16_rk,-2.529613978001006027e-16_rk, &
                                        -1.946309118264840217e-16_rk, 3.450920601366936902e-01_rk, -5.522251604130004708e-17_rk,1.135981987447639391e-17_rk, &
                                        1.162775527435731896e-17_rk, 5.617077787854372252e-17_rk, -1.287901101718757602e+00_rk,-1.882817572619554570e-16_rk, &
                                        -5.637697339728470298e-17_rk, 1.353607112084157789e-17_rk, -2.041848801645914454e-18_rk,9.246713882801937956e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        3.154700538379251462e+00_rk, 5.754795837243277162e-17_rk, -8.821623600352982616e-16_rk,3.353479131080199142e-16_rk, &
                                        -1.181084533003564012e-16_rk, 8.452994616207483158e-01_rk, 1.681656528628743381e-16_rk,-1.296601240146927099e-16_rk, &
                                        1.785582393021108132e-16_rk, -2.479749982426581619e-16_rk, 3.154700538379251462e+00_rk,4.198199005058880719e-16_rk, &
                                        1.153589217794838951e-16_rk, 1.364780659023513204e-16_rk, 2.153628973182170957e-17_rk,8.452994616207478717e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -3.450920601366944673e-01_rk, -2.427613374951953245e-16_rk, 1.513336095275350585e-16_rk,-1.573994732857143117e-16_rk, &
                                        2.097722198569630991e-16_rk, 4.806512346738334607e+00_rk, 3.396904048427175830e-16_rk,1.402736236107001289e-16_rk, &
                                        -1.589010185635695056e-16_rk, -7.421509466322722986e-16_rk, -9.246713882801971263e-02_rk,-6.383095586392111351e-17_rk, &
                                        -1.185793409865992859e-16_rk, -4.502578599184120949e-18_rk, -1.720004777924027302e-16_rk,1.287901101718757602e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -4.116328226464947448e+00_rk, 2.144613535471739669e-17_rk, 6.342370166973835024e-16_rk,-3.702335634013095291e-18_rk, &
                                        -2.364916537079228211e-16_rk, -9.267932633339974302e+00_rk, -9.740224807028503613e-16_rk,5.144815435424046196e-17_rk, &
                                        2.538862229961331216e-17_rk, 1.133975134480179344e-15_rk, -1.102966824062718842e+00_rk,1.512563436874435365e-17_rk, &
                                        1.310758873209442807e-16_rk, -4.504485690550463138e-16_rk, 3.532619377557911970e-16_rk,-2.483335064609495824e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        8.452994616207480938e-01_rk, 1.005925531935526116e-16_rk, -3.300358497166015151e-16_rk,1.669521142865178062e-17_rk, &
                                        -4.857914096775293221e-17_rk, 3.154700538379252794e+00_rk, 3.075518152129873234e-16_rk,-4.200142338775312572e-17_rk, &
                                        6.338082791752405273e-17_rk, -4.096247215481056807e-16_rk, 8.452994616207480938e-01_rk,2.137703202666910811e-16_rk, &
                                        -2.308559223056982961e-16_rk, 2.618005056971995495e-16_rk, -3.290082900299263337e-16_rk,3.154700538379251462e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -9.246713882801937956e-02_rk, -1.622810383645295839e-16_rk, 2.584042422780281427e-16_rk,1.536285895568840116e-17_rk, &
                                        1.960012996388252533e-16_rk, 1.287901101718757602e+00_rk, 1.796142713031085260e-16_rk,-8.777090731876128138e-17_rk, &
                                        4.855286989907480820e-18_rk, -1.612335176195324609e-16_rk, -3.450920601366959106e-01_rk,1.183885008743265747e-16_rk, &
                                        -2.083973993205929970e-16_rk, 3.255522903169453954e-16_rk, -1.323446407358843591e-16_rk,4.806512346738336383e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        3.678769027500234046e+00_rk, -3.250309054340943916e-16_rk, -2.153677045991818311e-15_rk,6.202081289960050071e-16_rk, &
                                        -7.616943013331165518e-17_rk, 2.298400786953456620e+00_rk, 9.383262249768115262e-16_rk,1.937800846416367238e-17_rk, &
                                        5.021271397825539020e-16_rk, -1.390378928472912922e-15_rk, 1.372935291994162199e+01_rk,1.217040194404954445e-15_rk, &
                                        -2.077017174767617493e-16_rk, 3.032273107093583101e-16_rk, -6.596086923141967534e-16_rk,8.577748513066588032e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -9.464101615137753498e+00_rk, -2.153333976919027363e-16_rk, 1.659966383662451716e-15_rk,-5.639998999804129903e-16_rk, &
                                        -2.197978526655219103e-16_rk, -2.535898384862246058e+00_rk, -8.949616580459060931e-16_rk,-5.379286832883405523e-17_rk, &
                                        -2.510294514625254968e-16_rk, 9.776610729811422394e-16_rk, -9.464101615137753498e+00_rk,-6.577546399281105552e-16_rk, &
                                        4.397431270060254837e-17_rk, -1.502919358818402367e-16_rk, 5.196518733190228356e-16_rk,-2.535898384862245614e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -2.298400786953457064e+00_rk, 4.047723832254627014e-16_rk, 1.153600420724169354e-15_rk,-5.015295291016523723e-16_rk, &
                                        -1.246915892194501097e-16_rk, -3.678769027500234046e+00_rk, -7.578015291183388077e-16_rk,1.474895120008351429e-16_rk, &
                                        -3.626670573091119032e-16_rk, 1.206120867912224596e-15_rk, -8.577748513066589808e+00_rk,-1.209766129368151445e-15_rk, &
                                        4.918673968308902693e-16_rk, -6.940919957823162583e-16_rk, 6.551061137150127557e-16_rk,-1.372935291994162199e+01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.287901101718757380e+00_rk, 8.253956057316131106e-17_rk, 7.416723829896212576e-16_rk,-1.340414588500411593e-16_rk, &
                                        4.859719713936499204e-18_rk, 9.246713882801971263e-02_rk, -3.601389671615808994e-16_rk,-7.909661314623752777e-17_rk, &
                                        -1.443153694633495536e-16_rk, 3.454915781802209843e-16_rk, -4.806512346738336383e+00_rk,-1.256625659111298948e-16_rk, &
                                        -7.576828003353547365e-17_rk, 6.531239475601254053e-17_rk, 1.368472193350684554e-16_rk,3.450920601366944673e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -2.535898384862244725e+00_rk, 5.152684629042110161e-16_rk, 3.027055329942537083e-16_rk,-1.344778067689406771e-16_rk, &
                                        -4.557419612224509340e-16_rk, -9.464101615137751722e+00_rk, -9.025733688720696935e-16_rk,5.541007057320582408e-17_rk, &
                                        3.929532351504725451e-17_rk, 1.525553559624713091e-15_rk, -2.535898384862244725e+00_rk,-4.969759205893840015e-16_rk, &
                                        3.470560189434929270e-16_rk, -5.905109224095814893e-16_rk, 4.088727045329290479e-16_rk,-9.464101615137753498e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.483335064609495824e+00_rk, -8.021030649640352131e-17_rk, -1.670408905280225344e-15_rk,4.708038111902755207e-16_rk, &
                                        -2.673110100582002984e-16_rk, 1.102966824062719065e+00_rk, 3.985729865121219036e-16_rk,2.805230263668737053e-17_rk, &
                                        3.529564833292968923e-16_rk, -8.836538326731593782e-16_rk, 9.267932633339981408e+00_rk,9.729891276194980492e-16_rk, &
                                        -7.507259818970429990e-17_rk, 4.298741514842554148e-17_rk, -3.904168322432438403e-16_rk,4.116328226464949225e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -1.287901101718757380e+00_rk, 8.253956057316138502e-17_rk, 7.416723829896212576e-16_rk,-1.340414588500411593e-16_rk, &
                                        4.859719713936511530e-18_rk, 9.246713882801926854e-02_rk, -3.601389671615811952e-16_rk,-7.909661314623755242e-17_rk, &
                                        -1.443153694633494796e-16_rk, 3.454915781802211815e-16_rk, -4.806512346738336383e+00_rk,-1.256625659111299441e-16_rk, &
                                        -7.576828003353544900e-17_rk, 6.531239475601254053e-17_rk, 1.368472193350685047e-16_rk,3.450920601366944673e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -3.154700538379251462e+00_rk, -5.754795837243277162e-17_rk, 8.821623600352982616e-16_rk,-3.353479131080199142e-16_rk, &
                                        1.181084533003564012e-16_rk, -8.452994616207483158e-01_rk, -1.681656528628743381e-16_rk,1.296601240146927345e-16_rk, &
                                        -1.785582393021108132e-16_rk, 2.479749982426581619e-16_rk, -3.154700538379251462e+00_rk,-4.198199005058880719e-16_rk, &
                                        -1.153589217794838951e-16_rk, -1.364780659023513204e-16_rk, -2.153628973182170957e-17_rk,-8.452994616207483158e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -9.246713882801937956e-02_rk, -1.622810383645295839e-16_rk, 2.584042422780278469e-16_rk,1.536285895568849977e-17_rk, &
                                        1.960012996388251547e-16_rk, 1.287901101718756713e+00_rk, 1.796142713031085260e-16_rk,-8.777090731876125673e-17_rk, &
                                        4.855286989907530124e-18_rk, -1.612335176195326581e-16_rk, -3.450920601366941343e-01_rk,1.183885008743268952e-16_rk, &
                                        -2.083973993205929477e-16_rk, 3.255522903169452968e-16_rk, -1.323446407358845070e-16_rk,4.806512346738336383e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.102966824062719065e+00_rk, 1.599517842877716955e-16_rk, 6.703322800125756971e-16_rk,-3.521252112959227379e-16_rk, &
                                        6.644999070543860747e-17_rk, -2.483335064609495380e+00_rk, -2.180482906536492344e-16_rk,1.388152178283114140e-16_rk, &
                                        -2.134964008558549181e-16_rk, 6.993957721124705589e-16_rk, -4.116328226464949225e+00_rk,-9.657150625826946552e-16_rk, &
                                        3.592382775438326720e-16_rk, -4.338521002213834158e-16_rk, 3.859142536440596453e-16_rk,-9.267932633339977855e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -8.452994616207480938e-01_rk, -1.005925531935526610e-16_rk, 3.300358497166015151e-16_rk,-1.669521142865178062e-17_rk, &
                                        4.857914096775303082e-17_rk, -3.154700538379251018e+00_rk, -3.075518152129873234e-16_rk,4.200142338775311339e-17_rk, &
                                        -6.338082791752405273e-17_rk, 4.096247215481056807e-16_rk, -8.452994616207480938e-01_rk,-2.137703202666910811e-16_rk, &
                                        2.308559223056982961e-16_rk, -2.618005056971995495e-16_rk, 3.290082900299263337e-16_rk,-3.154700538379250574e+00_rk  &
                                        /),(/4,4/))
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face4_dx
        ! 
        test_dbr2_face_face4_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -4.806512346738337271e+00_rk, -3.806678697472579589e-16_rk, 1.035857335729264653e-16_rk,3.050092200696241167e-17_rk, &
                                        1.147118920949303763e-16_rk, 3.450920601366939677e-01_rk, 1.275561628616779060e-17_rk,1.690960096339128810e-17_rk, &
                                        1.064742098144150130e-16_rk, -6.046945117239351549e-18_rk, -1.287901101718758046e+00_rk,-2.666655941787790040e-17_rk, &
                                        1.643341281038813763e-17_rk, -7.347622672812493571e-17_rk, 1.867789389630352339e-17_rk,9.246713882801929629e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,1,2) = reshape((/                                                                                 &
                                        9.267932633339972526e+00_rk, 1.798682720203696533e-16_rk, 3.933708445793690643e-17_rk,4.980096569396034244e-17_rk, &
                                        -5.826558806222725506e-16_rk, 4.116328226464944784e+00_rk, 3.526034566833071148e-16_rk,2.820192694311425194e-16_rk, &
                                        -3.406088253565819333e-16_rk, -5.854551511488895649e-16_rk, 2.483335064609494491e+00_rk,8.968603137892217805e-17_rk, &
                                        -4.095808030555065136e-18_rk, 3.183819169119245166e-16_rk, -2.454025588065582077e-17_rk,1.102966824062717732e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,1,3) = reshape((/                                                                                 &
                                        3.154700538379251462e+00_rk, 1.122818525737052554e-16_rk, -7.957555463161347213e-17_rk,-3.189019835754125614e-17_rk, &
                                        -4.747655842913816590e-16_rk, 8.452994616207480938e-01_rk, 7.042645647596115956e-17_rk,-1.623150417653390385e-16_rk, &
                                        -1.081917263828357811e-16_rk, -4.645520489591932421e-16_rk, 3.154700538379251462e+00_rk,1.854829158442994378e-16_rk, &
                                        -1.220568118127219152e-17_rk, 2.142496598369020145e-17_rk, -2.686976476777785193e-16_rk,8.452994616207485379e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -4.116328226464947448e+00_rk, 1.240644554704354505e-16_rk, -3.852035346490265952e-16_rk,-3.356974189543875331e-16_rk, &
                                        2.439609915810276735e-16_rk, -9.267932633339976078e+00_rk, -7.502550959576259448e-16_rk,-7.030847242981552994e-16_rk, &
                                        1.316501466368771121e-16_rk, 8.281668591902086217e-16_rk, -1.102966824062718620e+00_rk,-3.259358800730882260e-17_rk, &
                                        1.788651637919043589e-17_rk, -6.257159583342774786e-16_rk, -5.636098148028357394e-17_rk,-2.483335064609495380e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -3.450920601366941898e-01_rk, 7.673514225645265790e-17_rk, 2.422807166181631433e-16_rk,2.553955312534647112e-16_rk, &
                                        2.239829969463146487e-16_rk, 4.806512346738331942e+00_rk, 3.848960229881507065e-16_rk,4.041558539036211961e-16_rk, &
                                        1.024844689052899807e-16_rk, -2.366647629240793108e-16_rk, -9.246713882802010120e-02_rk,-3.042588395373543040e-17_rk, &
                                        -3.022412115902348066e-17_rk, 3.808102681504775649e-16_rk, 6.222334346463587132e-17_rk,1.287901101718756935e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,2,3) = reshape((/                                                                                 &
                                        8.452994616207489820e-01_rk, -2.116405457517909745e-16_rk, 3.117526503300259781e-16_rk,1.409870174270133997e-16_rk, &
                                        -1.048069908503477275e-16_rk, 3.154700538379250130e+00_rk, 3.125025375394502301e-16_rk,3.786374860714483693e-16_rk, &
                                        5.978844181350216965e-17_rk, -2.778433863837539561e-16_rk, 8.452994616207487599e-01_rk,2.372755250397228928e-16_rk, &
                                        -5.667818404963626470e-17_rk, 5.266438271392139873e-16_rk, -3.248700989550576608e-17_rk,3.154700538379251018e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,1) = reshape((/                                                                                 &
                                        1.372935291994161844e+01_rk, 6.372712840240802207e-16_rk, 1.780320675031736646e-16_rk,2.746955749404627098e-16_rk, &
                                        -4.733847757708883275e-16_rk, 8.577748513066586256e+00_rk, 7.247438633852900924e-16_rk,6.692655223713726246e-16_rk, &
                                        -3.445985662657070887e-16_rk, -8.160729689557298200e-16_rk, 3.678769027500234046e+00_rk,8.592670684306459258e-17_rk, &
                                        -5.075334199996668034e-17_rk, 7.726684117905270789e-16_rk, 1.900519368767663810e-17_rk,2.298400786953455732e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -3.450920601366941898e-01_rk, 7.673514225645275651e-17_rk, 2.422807166181630447e-16_rk,2.553955312534647112e-16_rk, &
                                        2.239829969463146487e-16_rk, 4.806512346738333719e+00_rk, 3.848960229881507065e-16_rk,4.041558539036210481e-16_rk, &
                                        1.024844689052900300e-16_rk, -2.366647629240794094e-16_rk, -9.246713882801965712e-02_rk,-3.042588395373543040e-17_rk, &
                                        -3.022412115902348066e-17_rk, 3.808102681504776635e-16_rk, 6.222334346463587132e-17_rk,1.287901101718756935e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,3,3) = reshape((/                                                                                 &
                                        9.464101615137753498e+00_rk, 4.659847108410873141e-16_rk, 7.996991951360820857e-17_rk,1.448083198457385330e-16_rk, &
                                        -3.818605825672359957e-16_rk, 2.535898384862244281e+00_rk, 2.302835712195317411e-16_rk,1.070441148417399416e-16_rk, &
                                        2.214824969289444000e-16_rk, -9.317738145243764883e-16_rk, 9.464101615137751722e+00_rk,3.113200577154285333e-16_rk, &
                                        -1.716107820329627148e-16_rk, 3.920866555363047572e-16_rk, -3.774309958765427159e-16_rk,2.535898384862244725e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -4.806512346738334607e+00_rk, -3.806678697472578110e-16_rk, 1.035857335729264653e-16_rk,3.050092200696242399e-17_rk, &
                                        1.147118920949303270e-16_rk, 3.450920601366953000e-01_rk, 1.275561628616793851e-17_rk,1.690960096339148531e-17_rk, &
                                        1.064742098144149883e-16_rk, -6.046945117239351549e-18_rk, -1.287901101718756713e+00_rk,-2.666655941787785109e-17_rk, &
                                        1.643341281038810066e-17_rk, -7.347622672812456593e-17_rk, 1.867789389630344943e-17_rk,9.246713882802018447e-02_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -8.577748513066586256e+00_rk, -3.333385565332750923e-16_rk, -5.238985176942630760e-16_rk,-5.605920282008898327e-16_rk, &
                                        1.346898867296433272e-16_rk, -1.372935291994161133e+01_rk, -1.122395502659608528e-15_rk,-1.090330977238384862e-15_rk, &
                                        1.356398875460019471e-16_rk, 1.058784676997048285e-15_rk, -2.298400786953454844e+00_rk,-2.883426347145126794e-17_rk, &
                                        6.454405034860201720e-17_rk, -1.080002453212879548e-15_rk, -9.990643104861592188e-17_rk,-3.678769027500233157e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,4,3) = reshape((/                                                                                 &
                                        2.535898384862245170e+00_rk, 4.828127971009056433e-16_rk, 4.672862982154708307e-16_rk,8.013205363931411531e-16_rk, &
                                        1.630649289747632905e-16_rk, 9.464101615137749945e+00_rk, 8.013804799498272929e-16_rk,9.520651009888239329e-16_rk, &
                                        4.768826564283533998e-17_rk, -6.973232115678556976e-16_rk, 2.535898384862245614e+00_rk,2.565621531432719697e-16_rk, &
                                        -1.196122019908440839e-16_rk, 8.243714327274922611e-16_rk, 2.035009803905040695e-16_rk,9.464101615137751722e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.287901101718757824e+00_rk, -9.848554429284064211e-17_rk, 6.030940714929881515e-17_rk,-3.320299086020737745e-17_rk, &
                                        8.119458136017055876e-17_rk, 9.246713882801943507e-02_rk, 4.538197234079479116e-17_rk,1.751359135584509823e-16_rk, &
                                        -2.208091726640956741e-16_rk, 4.684455852796960136e-16_rk, -4.806512346738337271e+00_rk,-2.569083174690264240e-17_rk, &
                                        6.483620660300937774e-17_rk, 1.686225152258238167e-16_rk, 2.252343377204051451e-16_rk,3.450920601366936902e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,2) = reshape((/                                                                                 &
                                        2.483335064609495380e+00_rk, 1.587707305876128800e-16_rk, 1.251157724289288554e-16_rk,1.071873042990959166e-16_rk, &
                                        -4.328899889777615688e-16_rk, 1.102966824062717732e+00_rk, 1.308023314522105152e-16_rk,-1.681386493695864453e-16_rk, &
                                        3.864912067049064768e-16_rk, -9.268491823194405981e-16_rk, 9.267932633339974302e+00_rk,5.605420804917467530e-16_rk, &
                                        -1.745903078210735492e-16_rk, 3.615581149382412100e-16_rk, -6.453114032548877937e-16_rk,4.116328226464946560e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -3.154700538379251462e+00_rk, -1.122818525737052554e-16_rk, 7.957555463161347213e-17_rk,3.189019835754125614e-17_rk, &
                                        4.747655842913816590e-16_rk, -8.452994616207480938e-01_rk, -7.042645647596115956e-17_rk,1.623150417653390385e-16_rk, &
                                        1.081917263828357935e-16_rk, 4.645520489591932421e-16_rk, -3.154700538379251462e+00_rk,-1.854829158442994378e-16_rk, &
                                        1.220568118127219152e-17_rk, -2.142496598369020145e-17_rk, 2.686976476777785193e-16_rk,-8.452994616207485379e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -1.102966824062718620e+00_rk, -2.455549875529595416e-16_rk, -3.298341874804777758e-16_rk,-4.077577428850572621e-16_rk, &
                                        1.246641233857183669e-16_rk, -2.483335064609494047e+00_rk, -3.081508275388161837e-16_rk,-3.908271660463447103e-16_rk, &
                                        -1.734213645481781086e-16_rk, 3.863329016609272879e-16_rk, -4.116328226464947448e+00_rk,-6.155377433942510967e-16_rk, &
                                        1.554778592671430469e-16_rk, -7.171392535779087016e-16_rk, 1.484055570250516643e-16_rk,-9.267932633339977855e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -9.246713882801965712e-02_rk, 1.852698012581871557e-16_rk, 1.444090079022500806e-16_rk,3.337734294461684887e-16_rk, &
                                        2.270312842318726062e-16_rk, 1.287901101718756713e+00_rk, 1.319665237458107418e-16_rk,3.838299018574802226e-16_rk, &
                                        7.739330507367034718e-18_rk, 7.207069537881781429e-17_rk, -3.450920601366946339e-01_rk,8.068649464940670875e-17_rk, &
                                        -4.572375804907881384e-17_rk, 1.869586234138433544e-16_rk, 2.716715085094310583e-16_rk,4.806512346738333719e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -8.452994616207489820e-01_rk, 2.116405457517909745e-16_rk, -3.117526503300259781e-16_rk,-1.409870174270133997e-16_rk, &
                                        1.048069908503476782e-16_rk, -3.154700538379250130e+00_rk, -3.125025375394502301e-16_rk,-3.786374860714483693e-16_rk, &
                                        -5.978844181350216965e-17_rk, 2.778433863837539561e-16_rk, -8.452994616207487599e-01_rk,-2.372755250397228928e-16_rk, &
                                        5.667818404963626470e-17_rk, -5.266438271392139873e-16_rk, 3.248700989550576608e-17_rk,-3.154700538379251018e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,1) = reshape((/                                                                                 &
                                        3.678769027500234046e+00_rk, 4.425260761386408258e-16_rk, 2.092153731818801455e-16_rk,4.741637246054718445e-16_rk, &
                                        -2.870532861060593612e-16_rk, 2.298400786953455288e+00_rk, 2.173868828572264781e-16_rk,4.055533892944277036e-17_rk, &
                                        6.150397098763692102e-16_rk, -1.323224072220319118e-15_rk, 1.372935291994161844e+01_rk,6.669194068880561473e-16_rk, &
                                        -2.851502724731617285e-16_rk, 3.798942231262609696e-16_rk, -5.988742324658618805e-16_rk,8.577748513066586256e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -9.246713882801965712e-02_rk, 1.852698012581872544e-16_rk, 1.444090079022499820e-16_rk,3.337734294461684887e-16_rk, &
                                        2.270312842318726062e-16_rk, 1.287901101718756713e+00_rk, 1.319665237458107418e-16_rk,3.838299018574800747e-16_rk, &
                                        7.739330507367084022e-18_rk, 7.207069537881756777e-17_rk, -3.450920601366933016e-01_rk,8.068649464940670875e-17_rk, &
                                        -4.572375804907882617e-17_rk, 1.869586234138434530e-16_rk, 2.716715085094310583e-16_rk,4.806512346738333719e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -9.464101615137753498e+00_rk, -4.659847108410873141e-16_rk, -7.996991951360820857e-17_rk,-1.448083198457385330e-16_rk, &
                                        3.818605825672359464e-16_rk, -2.535898384862244281e+00_rk, -2.302835712195317411e-16_rk,-1.070441148417399416e-16_rk, &
                                        -2.214824969289444000e-16_rk, 9.317738145243764883e-16_rk, -9.464101615137751722e+00_rk,-3.113200577154285333e-16_rk, &
                                        1.716107820329627148e-16_rk, -3.920866555363047572e-16_rk, 3.774309958765427159e-16_rk,-2.535898384862244725e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -1.287901101718756935e+00_rk, -9.848554429284059280e-17_rk, 6.030940714929881515e-17_rk,-3.320299086020729116e-17_rk, &
                                        8.119458136017050946e-17_rk, 9.246713882801987916e-02_rk, 4.538197234079484046e-17_rk,1.751359135584509823e-16_rk, &
                                        -2.208091726640955015e-16_rk, 4.684455852796956192e-16_rk, -4.806512346738333719e+00_rk,-2.569083174690249449e-17_rk, &
                                        6.483620660300931611e-17_rk, 1.686225152258240139e-16_rk, 2.252343377204049972e-16_rk,3.450920601366963547e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -2.298400786953456176e+00_rk, -5.293103331039873641e-16_rk, -4.139337882334289920e-16_rk,-7.747341631914329434e-16_rk, &
                                        -2.117257948598367438e-17_rk, -3.678769027500231381e+00_rk, -3.947353789438320234e-16_rk,-5.995211543453737534e-16_rk, &
                                        -4.019698677196405955e-16_rk, 7.827077915618052160e-16_rk, -8.577748513066588032e+00_rk,-7.219150697905601951e-16_rk, &
                                        2.660378239192311522e-16_rk, -7.354753617659280667e-16_rk, 1.019683862360256771e-16_rk,-1.372935291994161311e+01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face4_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.535898384862245170e+00_rk, -4.828127971009056433e-16_rk, -4.672862982154708307e-16_rk,-8.013205363931411531e-16_rk, &
                                        -1.630649289747632412e-16_rk, -9.464101615137749945e+00_rk, -8.013804799498272929e-16_rk,-9.520651009888239329e-16_rk, &
                                        -4.768826564283533998e-17_rk, 6.973232115678556976e-16_rk, -2.535898384862245614e+00_rk,-2.565621531432719697e-16_rk, &
                                        1.196122019908440839e-16_rk, -8.243714327274922611e-16_rk, -2.035009803905040695e-16_rk,-9.464101615137751722e+00_rk  &
                                        /),(/4,4/))
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face4_dx(:,:,inode_diff,idir)),self%faces(ETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face5_dx
        ! 
        test_dbr2_face_face5_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -4.440892098500626162e-16_rk, 3.307130317333473535e-16_rk, 3.108080179174799109e-17_rk,-1.154427174757272550e-16_rk, &
                                        -3.965464931169449363e-17_rk, 4.898979485566355763e+00_rk, 3.205977444192848861e-17_rk,2.354990646303891344e-16_rk, &
                                        -7.771411490663322937e-17_rk, 7.527760596362135358e-17_rk, -4.898979485566355763e+00_rk,-2.264005872483865365e-16_rk, &
                                        -4.855935985748552143e-17_rk, 2.530473585357669951e-16_rk, -7.291613507383666860e-17_rk,-6.304718340326608260e-16_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.338426085980492175e+01_rk, 1.148878899668448117e-15_rk, -2.975922053953099017e-16_rk,-1.183527634649490125e-15_rk, &
                                        -3.993085628722142428e-16_rk, 8.485281374238565988e+00_rk, -2.533912014784322689e-16_rk,-1.511874149108191705e-16_rk, &
                                        1.402065815159737368e-16_rk, 3.633063014853897894e-16_rk, 8.485281374238565988e+00_rk,8.666921414900017570e-16_rk, &
                                        1.380804177661665714e-15_rk, 3.433044042514166295e-16_rk, 6.095735140334727501e-16_rk,3.586301888672211113e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,1,3) = reshape((/                                                                                 &
                                        9.952135486850337998e+00_rk, 5.637922494088791362e-16_rk, -9.067291690726906487e-17_rk,-7.322829806688107658e-16_rk, &
                                        -5.108662460340787536e-16_rk, 2.666666666666665186e+00_rk, -3.834511945540572686e-17_rk,-1.655483813512072487e-17_rk, &
                                        1.598353989194872487e-16_rk, 1.838085146709562745e-16_rk, 2.666666666666666519e+00_rk,4.582924055370307272e-16_rk, &
                                        8.087216872790078617e-16_rk, -7.629419430397821160e-17_rk, 1.569728639256447042e-16_rk,7.145311798163274108e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -8.485281374238571317e+00_rk, -1.351197455314041593e-15_rk, 2.006365417036136562e-16_rk,1.560690817088684547e-15_rk, &
                                        3.594323626353105240e-16_rk, -1.338426085980492175e+01_rk, 2.861256818888707045e-16_rk,-1.979618534078585788e-16_rk, &
                                        6.049787177192364811e-17_rk, -4.230798378349269147e-16_rk, -3.586301888672212890e+00_rk,-4.023855037363276480e-16_rk, &
                                        -1.071495647787659856e-15_rk, -9.203980751022453255e-16_rk, -7.451197631405743920e-16_rk,-8.485281374238565988e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -4.898979485566354874e+00_rk, -1.283944760877540748e-16_rk, 6.587486189994837769e-17_rk,-2.617204649634668219e-16_rk, &
                                        7.953084954859823701e-17_rk, 1.008676447045159469e-15_rk, -6.479425485236682558e-17_rk,1.136502036882887383e-16_rk, &
                                        -1.229903383812641925e-16_rk, -1.550406961408433616e-17_rk, 7.301096125756092521e-18_rk,-2.379060505052878190e-16_rk, &
                                        -2.607491700165205700e-16_rk, 3.240463123150612571e-16_rk, 2.084623841809380024e-16_rk,4.898979485566352210e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,2,3) = reshape((/                                                                                 &
                                        2.666666666666666963e+00_rk, 7.000351301780874408e-16_rk, 6.987979548551741197e-17_rk,-6.201548185885275185e-16_rk, &
                                        -3.880228342631201715e-16_rk, 9.952135486850337998e+00_rk, -1.744396783878040697e-16_rk,6.889886215563766461e-17_rk, &
                                        7.426427080320563138e-17_rk, 2.162631155713853583e-16_rk, 7.145311798163271888e-01_rk,3.251619123374409055e-16_rk, &
                                        3.661732242081112526e-16_rk, 6.976434155314452467e-16_rk, 3.569105077575266232e-16_rk,2.666666666666666075e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,1) = reshape((/                                                                                 &
                                        8.485281374238571317e+00_rk, 6.897713918473468857e-16_rk, -2.627981452871095644e-16_rk,-1.329805382137229741e-15_rk, &
                                        -2.801230640119215368e-16_rk, 3.586301888672214666e+00_rk, -3.502452307727277064e-16_rk,-2.730362758529194927e-16_rk, &
                                        9.493035804134274900e-17_rk, 2.725246259076841089e-16_rk, 1.338426085980492175e+01_rk,8.551866782331007702e-16_rk, &
                                        1.168614367502630924e-15_rk, 4.143033580307110394e-16_rk, 8.909520332882476060e-16_rk,8.485281374238565988e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -4.898979485566355763e+00_rk, -1.283944760877542227e-16_rk, 6.587486189994836536e-17_rk,-2.617204649634668219e-16_rk, &
                                        7.953084954859823701e-17_rk, -3.235911825050283300e-16_rk, -6.479425485236682558e-17_rk,1.136502036882887136e-16_rk, &
                                        -1.229903383812641925e-16_rk, -1.550406961408439779e-17_rk, 7.301096125756092521e-18_rk,-2.379060505052877697e-16_rk, &
                                        -2.607491700165205207e-16_rk, 3.240463123150611585e-16_rk, 2.084623841809380517e-16_rk,4.898979485566353098e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,3,3) = reshape((/                                                                                 &
                                        2.666666666666666963e+00_rk, 3.386532838065394271e-16_rk, -2.542594315987156848e-16_rk,-4.535482688792253363e-16_rk, &
                                        -3.891747054157202919e-17_rk, 7.145311798163271888e-01_rk, -1.127606214641842591e-16_rk,-4.409237623641604071e-16_rk, &
                                        2.497391720810978421e-16_rk, 2.287472487929191331e-16_rk, 9.952135486850334445e+00_rk,8.796367056546132792e-16_rk, &
                                        4.514761433742106224e-16_rk, -5.458786691126348473e-17_rk, 3.841342545663925604e-16_rk,2.666666666666666075e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,1) = reshape((/                                                                                 &
                                        4.440892098500626162e-16_rk, 3.307130317333473535e-16_rk, 3.108080179174794179e-17_rk,-1.154427174757274522e-16_rk, &
                                        -3.965464931169446898e-17_rk, 4.898979485566353986e+00_rk, 3.205977444192842082e-17_rk,2.354990646303889372e-16_rk, &
                                        -7.771411490663315542e-17_rk, 7.527760596362142754e-17_rk, -4.898979485566353986e+00_rk,-2.264005872483865365e-16_rk, &
                                        -4.855935985748547213e-17_rk, 2.530473585357670937e-16_rk, -7.291613507383643441e-17_rk,7.017957955175270225e-16_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -3.586301888672213778e+00_rk, -8.920899474929397700e-16_rk, 1.658424815954131710e-16_rk,1.706968564576423769e-15_rk, &
                                        2.402468637750177688e-16_rk, -8.485281374238565988e+00_rk, 3.829797111831658954e-16_rk,-7.611299246575830598e-17_rk, &
                                        1.057740952465546483e-16_rk, -3.322981622572210369e-16_rk, -8.485281374238565988e+00_rk,-3.908800404794262175e-16_rk, &
                                        -8.593058376286245737e-16_rk, -9.913970288815390451e-16_rk, -1.026498282395348854e-15_rk,-1.338426085980491642e+01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,4,3) = reshape((/                                                                                 &
                                        7.145311798163269668e-01_rk, 3.631594580086958380e-16_rk, 4.866645434500028651e-17_rk,-1.127572411261792740e-15_rk, &
                                        -2.786862409669032469e-16_rk, 2.666666666666666963e+00_rk, -3.182019174314128075e-16_rk,-3.899851510037935906e-17_rk, &
                                        -1.883408617445403649e-16_rk, 1.294775487169193726e-16_rk, 2.666666666666666075e+00_rk,8.168254841955404321e-17_rk, &
                                        4.886273102715907139e-16_rk, 7.779289499150417444e-16_rk, 8.171580610549626252e-16_rk,9.952135486850334445e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -4.440892098500626162e-16_rk, -7.517747756631052006e-17_rk, 1.981202437280794618e-16_rk,-2.365903613813777321e-18_rk, &
                                        -2.072001207244083290e-16_rk, 1.632993161855451625e+00_rk, -7.567345384981111843e-17_rk,1.249999703698833350e-16_rk, &
                                        -4.636537771500436869e-17_rk, -8.410522122180423529e-17_rk, -1.632993161855452513e+00_rk,-1.656722991031954293e-16_rk, &
                                        -1.175891273987128118e-17_rk, 2.788604823001255938e-16_rk, 5.366603909598161415e-17_rk,-2.577065856674644064e-16_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,2) = reshape((/                                                                                 &
                                        4.461420286601641472e+00_rk, 3.829073668748530990e-16_rk, 3.898524555677094485e-17_rk,-6.112996222367176358e-16_rk, &
                                        -6.250577955170595182e-16_rk, 2.828427124746189403e+00_rk, -3.918266090369584766e-18_rk,-1.352859914104548084e-16_rk, &
                                        3.149398389745581563e-16_rk, 2.113080391822265626e-16_rk, 2.828427124746188959e+00_rk,6.333524666994194580e-16_rk, &
                                        3.410664131239116612e-16_rk, 3.508250542535280189e-18_rk, 1.364174156567368632e-16_rk,1.195433962890737112e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -9.952135486850339774e+00_rk, -5.637922494088791362e-16_rk, 9.067291690726906487e-17_rk,7.322829806688107658e-16_rk, &
                                        5.108662460340787536e-16_rk, -2.666666666666666963e+00_rk, 3.834511945540572686e-17_rk,1.655483813512072487e-17_rk, &
                                        -1.598353989194872487e-16_rk, -1.838085146709562745e-16_rk, -2.666666666666666519e+00_rk,-4.582924055370307272e-16_rk, &
                                        -8.087216872790078617e-16_rk, 7.629419430397821160e-17_rk, -1.569728639256447042e-16_rk,-7.145311798163274108e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -2.828427124746191623e+00_rk, -2.942555580688409764e-16_rk, -2.697584416836514867e-16_rk,6.314568977907313105e-16_rk, &
                                        7.476127097511394691e-16_rk, -4.461420286601641472e+00_rk, 2.126861046978020768e-16_rk,1.398063009057551262e-16_rk, &
                                        -1.453670046771092528e-16_rk, -1.042890931199918970e-16_rk, -1.195433962890738000e+00_rk,-4.392828342720474823e-16_rk, &
                                        -3.637157657989331255e-16_rk, -5.623493984513628664e-16_rk, -4.484425003008989516e-16_rk,-2.828427124746189403e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.632993161855452069e+00_rk, -1.347433123970157782e-17_rk, 3.265295239880109854e-17_rk,-1.779137194019976173e-17_rk, &
                                        8.464520649032857531e-17_rk, 3.235911825050283300e-16_rk, -1.330943847576212627e-16_rk,-1.295202798651835049e-16_rk, &
                                        -1.232074565824445965e-16_rk, -2.291372484043059367e-17_rk, -7.301096125756092521e-18_rk,-2.839733332417660808e-17_rk, &
                                        3.440826541489256064e-17_rk, 2.799806656087018322e-16_rk, 2.583590455481802278e-16_rk,1.632993161855450737e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -2.666666666666666075e+00_rk, -7.000351301780874408e-16_rk, -6.987979548551741197e-17_rk,6.201548185885275185e-16_rk, &
                                        3.880228342631201715e-16_rk, -9.952135486850337998e+00_rk, 1.744396783878040697e-16_rk,-6.889886215563766461e-17_rk, &
                                        -7.426427080320563138e-17_rk, -2.162631155713853583e-16_rk, -7.145311798163271888e-01_rk,-3.251619123374409055e-16_rk, &
                                        -3.661732242081112526e-16_rk, -6.976434155314452467e-16_rk, -3.569105077575266232e-16_rk,-2.666666666666666075e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.828427124746191623e+00_rk, 4.446105132014619673e-16_rk, -1.264820457725073876e-16_rk,-6.267250905631036326e-16_rk, &
                                        -3.332124683023228603e-16_rk, 1.195433962890738444e+00_rk, -6.133919699817979065e-17_rk,-3.898062416455215990e-16_rk, &
                                        2.380977601071179162e-16_rk, 2.724995355636002196e-16_rk, 4.461420286601640584e+00_rk,7.706274324784382915e-16_rk, &
                                        3.872335912786756632e-16_rk, 4.628433851111604856e-18_rk, 3.411104221089355754e-16_rk,2.828427124746189403e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -1.632993161855451625e+00_rk, -1.347433123970162712e-17_rk, 3.265295239880104307e-17_rk,-1.779137194019971243e-17_rk, &
                                        8.464520649032857531e-17_rk, -1.204980273450342861e-16_rk, -1.330943847576212627e-16_rk,-1.295202798651835295e-16_rk, &
                                        -1.232074565824445965e-16_rk, -2.291372484043063065e-17_rk, -7.301096125756092521e-18_rk,-2.839733332417646017e-17_rk, &
                                        3.440826541489253599e-17_rk, 2.799806656087017336e-16_rk, 2.583590455481801785e-16_rk,1.632993161855451625e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -2.666666666666666963e+00_rk, -3.386532838065394271e-16_rk, 2.542594315987156848e-16_rk,4.535482688792253363e-16_rk, &
                                        3.891747054157202919e-17_rk, -7.145311798163271888e-01_rk, 1.127606214641842591e-16_rk,4.409237623641604071e-16_rk, &
                                        -2.497391720810978421e-16_rk, -2.287472487929191331e-16_rk, -9.952135486850334445e+00_rk,-8.796367056546132792e-16_rk, &
                                        -4.514761433742106224e-16_rk, 5.458786691126348473e-17_rk, -3.841342545663925604e-16_rk,-2.666666666666666075e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,1) = reshape((/                                                                                 &
                                        4.440892098500626162e-16_rk, -7.517747756631049541e-17_rk, 1.981202437280794125e-16_rk,-2.365903613813974536e-18_rk, &
                                        -2.072001207244083537e-16_rk, 1.632993161855450737e+00_rk, -7.567345384981115541e-17_rk,1.249999703698831378e-16_rk, &
                                        -4.636537771500429473e-17_rk, -8.410522122180411203e-17_rk, -1.632993161855450737e+00_rk,-1.656722991031954293e-16_rk, &
                                        -1.175891273987133048e-17_rk, 2.788604823001255938e-16_rk, 5.366603909598177439e-17_rk,1.863826241825982098e-16_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.195433962890738222e+00_rk, -3.559587043954499433e-16_rk, -1.042911503543730618e-16_rk,6.468823661171171100e-16_rk, &
                                        4.557673825364024662e-16_rk, -2.828427124746189403e+00_rk, 2.701070356056122211e-16_rk,3.943265511408218181e-16_rk, &
                                        -6.852492580966900033e-17_rk, -1.654805895013653568e-16_rk, -2.828427124746188959e+00_rk,-5.765578000510663651e-16_rk, &
                                        -4.098829439536969304e-16_rk, -5.634695817599386610e-16_rk, -6.531355067530973434e-16_rk,-4.461420286601638807e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face5_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -7.145311798163269668e-01_rk, -3.631594580086958380e-16_rk, -4.866645434500028651e-17_rk,1.127572411261792740e-15_rk, &
                                        2.786862409669032469e-16_rk, -2.666666666666665630e+00_rk, 3.182019174314128075e-16_rk,3.899851510037935906e-17_rk, &
                                        1.883408617445403649e-16_rk, -1.294775487169193726e-16_rk, -2.666666666666666075e+00_rk,-8.168254841955404321e-17_rk, &
                                        -4.886273102715907139e-16_rk, -7.779289499150417444e-16_rk, -8.171580610549626252e-16_rk,-9.952135486850334445e+00_rk  &
                                        /),(/4,4/))
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face5_dx(:,:,inode_diff,idir)),self%faces(ZETA_MIN)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        
        
        !
        ! dbr2_face_face6_dx
        ! 
        test_dbr2_face_face6_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -3.885780586188047891e-16_rk, 4.207304773724053457e-16_rk, 2.413102911607745239e-16_rk,-2.882951249215585666e-17_rk, &
                                        3.248308816184976206e-17_rk, 1.632993161855451625e+00_rk, -5.907460952650061340e-17_rk,6.531682748004149728e-17_rk, &
                                        1.392659973819642700e-16_rk, -5.027844971772854209e-19_rk, -1.632993161855452513e+00_rk,-3.506729772166788240e-17_rk, &
                                        -9.238691248734332799e-17_rk, 1.837703132147132007e-16_rk, 4.052225262685831661e-17_rk,-3.916322424584599713e-16_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,1,2) = reshape((/                                                                                 &
                                        4.461420286601642360e+00_rk, 4.048376863410740011e-16_rk, -7.354724350419892448e-16_rk,-7.934514003697063187e-16_rk, &
                                        -2.819675827428841254e-17_rk, 2.828427124746190735e+00_rk, -7.302088714833625025e-16_rk,1.899862530793464904e-16_rk, &
                                        6.311038711447415330e-16_rk, 1.177368280155193645e-16_rk, 2.828427124746188515e+00_rk,1.498607178282352383e-16_rk, &
                                        7.920089012280771866e-16_rk, 3.398118273706161718e-16_rk, -4.607679946534686461e-16_rk,1.195433962890737556e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,1,3) = reshape((/                                                                                 &
                                        9.952135486850337998e+00_rk, 4.435385745879793940e-16_rk, -3.463798425715597408e-16_rk,-8.126541487048159643e-16_rk, &
                                        -4.742907013880809642e-18_rk, 2.666666666666666075e+00_rk, -1.253475150686085733e-16_rk,2.080966304704512372e-16_rk, &
                                        6.687247813690771482e-16_rk, 3.969993148712130507e-17_rk, 2.666666666666666519e+00_rk,1.718173677016202306e-16_rk, &
                                        5.781020150093291662e-16_rk, 4.086008066509739686e-17_rk, -3.497930128274852116e-16_rk,7.145311798163267447e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -2.828427124746190735e+00_rk, -8.574935357106887446e-16_rk, 3.913172888819675661e-16_rk,7.280615920708191899e-16_rk, &
                                        4.496752406893150518e-17_rk, -4.461420286601642360e+00_rk, 8.826405006993290279e-16_rk,-3.198878949138087535e-16_rk, &
                                        -6.800756220397093235e-16_rk, -6.219880435484307376e-17_rk, -1.195433962890738666e+00_rk,-2.496516650730721560e-16_rk, &
                                        -4.960314347009955208e-16_rk, -8.161001165341951945e-16_rk, 3.267035026937248857e-16_rk,-2.828427124746188515e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.632993161855451625e+00_rk, 3.192537199720934850e-17_rk, 1.028448549992475492e-16_rk,9.421932079104304712e-17_rk, &
                                        -4.925385395649285469e-17_rk, -2.518036954649108444e-18_rk, -9.335701968946571478e-17_rk,6.458481435442074119e-17_rk, &
                                        -9.029424648699682461e-17_rk, -5.503523916349900531e-17_rk, -1.733134616388353265e-16_rk,1.348582449665044796e-16_rk, &
                                        -2.035905540397382762e-16_rk, 2.925179759488654523e-16_rk, 9.354223933288543148e-17_rk,1.632993161855451403e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,2,3) = reshape((/                                                                                 &
                                        2.666666666666666519e+00_rk, 1.111641304404283618e-15_rk, -1.839117251347609602e-16_rk,-5.431838330906536698e-16_rk, &
                                        3.562721736659983161e-18_rk, 9.952135486850339774e+00_rk, -3.832673896123591651e-16_rk,4.924093200548365540e-16_rk, &
                                        3.552640912267069405e-16_rk, -1.089077660699794137e-17_rk, 7.145311798163276329e-01_rk,1.835448948143757552e-16_rk, &
                                        1.540915224764819632e-16_rk, 9.318600629987475536e-16_rk, 8.312008473491545082e-17_rk,2.666666666666665630e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,1) = reshape((/                                                                                 &
                                        2.828427124746191623e+00_rk, 1.603258096587826272e-17_rk, -8.739378712035167125e-16_rk,-6.704025670865072547e-16_rk, &
                                        -1.099337003926310539e-16_rk, 1.195433962890739110e+00_rk, -7.644912816463276532e-16_rk,1.892542399537256850e-16_rk, &
                                        4.015436272757806850e-16_rk, 6.320437334919766925e-17_rk, 4.461420286601642360e+00_rk,3.197862605164077236e-16_rk, &
                                        6.808052596756822014e-16_rk, 4.485594901047686453e-16_rk, -4.077480079474414943e-16_rk,2.828427124746189403e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.632993161855452069e+00_rk, 3.192537199720920059e-17_rk, 1.028448549992475492e-16_rk,9.421932079104314573e-17_rk, &
                                        -4.925385395649287934e-17_rk, -2.518036954649108444e-18_rk, -9.335701968946571478e-17_rk,6.458481435442069189e-17_rk, &
                                        -9.029424648699684926e-17_rk, -5.503523916349898066e-17_rk, 2.707757482112272897e-16_rk,1.348582449665045782e-16_rk, &
                                        -2.035905540397382762e-16_rk, 2.925179759488654523e-16_rk, 9.354223933288538218e-17_rk,1.632993161855450959e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,3,3) = reshape((/                                                                                 &
                                        2.666666666666666519e+00_rk, -7.157423275810547634e-17_rk, -1.062185670214380248e-15_rk,-5.813280208738796824e-16_rk, &
                                        -3.549131579928789190e-16_rk, 7.145311798163269668e-01_rk, 5.132682802273904084e-18_rk,2.550932727357100825e-16_rk, &
                                        4.354627623139698111e-16_rk, -1.537844709717346304e-16_rk, 9.952135486850337998e+00_rk,4.495021891584850032e-16_rk, &
                                        5.253163849280597160e-16_rk, 2.006411900243762457e-16_rk, -2.620749834658218585e-16_rk,2.666666666666665630e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -3.885780586188047891e-16_rk, 4.207304773724051485e-16_rk, 2.413102911607743267e-16_rk,-2.882951249215595527e-17_rk, &
                                        3.248308816184976206e-17_rk, 1.632993161855452069e+00_rk, -5.907460952650071201e-17_rk,6.531682748004162054e-17_rk, &
                                        1.392659973819642453e-16_rk, -5.027844971772977468e-19_rk, -1.632993161855450737e+00_rk,-3.506729772166772217e-17_rk, &
                                        -9.238691248734325403e-17_rk, 1.837703132147133979e-16_rk, 4.052225262685829195e-17_rk,4.965461772416652610e-16_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -1.195433962890739110e+00_rk, -4.686884303354925995e-16_rk, 5.297827250434941464e-16_rk,6.050127587876203231e-16_rk, &
                                        1.267044661872741466e-16_rk, -2.828427124746190735e+00_rk, 9.169229108622939814e-16_rk,-3.191558817881880221e-16_rk, &
                                        -4.505153781707478345e-16_rk, -7.666349688521390850e-18_rk, -2.828427124746188515e+00_rk,-4.195772077612442222e-16_rk, &
                                        -3.848277931486004863e-16_rk, -9.248477792683471257e-16_rk, 2.736835159876978325e-16_rk,-4.461420286601640584e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,4,3) = reshape((/                                                                                 &
                                        7.145311798163271888e-01_rk, 1.332713165740348758e-16_rk, -5.584055750181421677e-16_rk,-7.189394809556082508e-16_rk, &
                                        -2.174885887905253305e-18_rk, 2.666666666666666963e+00_rk, -4.022824493160491679e-16_rk,3.935904042267923907e-16_rk, &
                                        2.663521093070177362e-16_rk, 1.004933170013873513e-16_rk, 2.666666666666666519e+00_rk,4.547718858046130256e-16_rk, &
                                        2.844347065035103223e-16_rk, 1.048160010650669883e-15_rk, 6.012163349488603707e-17_rk,9.952135486850334445e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.831867990631508292e-15_rk, 4.159292525604035454e-16_rk, 3.797231711444859158e-16_rk,5.580152633652827752e-17_rk, &
                                        2.209976372867204084e-16_rk, 4.898979485566355763e+00_rk, -2.155657154912325877e-16_rk,1.024909588637003119e-16_rk, &
                                        -1.959750215499176099e-16_rk, 1.015438847712805878e-16_rk, -4.898979485566356651e+00_rk,-1.529929086150785221e-16_rk, &
                                        -1.701087050972107413e-16_rk, 3.332795103970492278e-16_rk, 2.035675209300358230e-16_rk,-4.965461772416652610e-16_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,2) = reshape((/                                                                                 &
                                        1.338426085980492886e+01_rk, 9.578590605267241225e-16_rk, -6.355065543256397658e-16_rk,-1.150965075710384178e-15_rk, &
                                        -2.269530011994404471e-16_rk, 8.485281374238571317e+00_rk, 2.855591002761721309e-16_rk,6.328709763328297923e-16_rk, &
                                        8.737441043673046863e-16_rk, -1.780356307376450258e-16_rk, 8.485281374238567764e+00_rk,5.407576197142201188e-16_rk, &
                                        5.059647473508437329e-16_rk, 5.187723685805362241e-16_rk, -1.604542505296826743e-16_rk,3.586301888672212890e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -9.952135486850339774e+00_rk, -4.435385745879795912e-16_rk, 3.463798425715597408e-16_rk,8.126541487048159643e-16_rk, &
                                        4.742907013880809642e-18_rk, -2.666666666666666963e+00_rk, 1.253475150686085733e-16_rk,-2.080966304704512372e-16_rk, &
                                        -6.687247813690771482e-16_rk, -3.969993148712130507e-17_rk, -2.666666666666666519e+00_rk,-1.718173677016202306e-16_rk, &
                                        -5.781020150093291662e-16_rk, -4.086008066509739686e-17_rk, 3.497930128274852116e-16_rk,-7.145311798163267447e-01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -8.485281374238571317e+00_rk, -1.122470858968101816e-15_rk, 5.085530713794248485e-16_rk,1.123116593102790329e-15_rk, &
                                        -4.511435519618035144e-17_rk, -1.338426085980492886e+01_rk, 3.247216547941048650e-17_rk,-8.019410261331017432e-16_rk, &
                                        -4.835428843251510289e-16_rk, -2.153090834555994860e-17_rk, -3.586301888672214666e+00_rk,-4.529855246506353050e-16_rk, &
                                        -3.317924510361050651e-16_rk, -1.271802514210253025e-15_rk, -2.394244571897017005e-16_rk,-8.485281374238567764e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -4.898979485566355763e+00_rk, -2.513174541190256056e-16_rk, -2.527696881982705549e-16_rk,-2.795304372893399692e-17_rk, &
                                        5.106971910890043938e-17_rk, 2.518036954649108444e-18_rk, -1.024655502643500544e-16_rk,6.657909093657124461e-17_rk, &
                                        -1.942261984922362447e-16_rk, 9.802265431192447284e-17_rk, -2.707757482112272897e-16_rk,6.522081355149331390e-17_rk, &
                                        -4.063591217528074383e-18_rk, 4.197506352326672281e-16_rk, 1.963111867893485272e-16_rk,4.898979485566353098e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -2.666666666666665630e+00_rk, -1.111641304404283618e-15_rk, 1.839117251347609602e-16_rk,5.431838330906536698e-16_rk, &
                                        -3.562721736659983161e-18_rk, -9.952135486850339774e+00_rk, 3.832673896123591651e-16_rk,-4.924093200548365540e-16_rk, &
                                        -3.552640912267069405e-16_rk, 1.089077660699794137e-17_rk, -7.145311798163276329e-01_rk,-1.835448948143757552e-16_rk, &
                                        -1.540915224764819632e-16_rk, -9.318600629987475536e-16_rk, -8.312008473491545082e-17_rk,-2.666666666666665630e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,1) = reshape((/                                                                                 &
                                        8.485281374238573093e+00_rk, 2.906123538472953166e-16_rk, -1.267999413668396286e-15_rk,-1.234719645775846613e-15_rk, &
                                        -3.968809193772603668e-16_rk, 3.586301888672214222e+00_rk, 3.986592655030546149e-16_rk,5.969591084057008729e-16_rk, &
                                        8.754929274249860515e-16_rk, -1.815568611970011285e-16_rk, 1.338426085980492530e+01_rk,7.589713418807920533e-16_rk, &
                                        6.720098612305263505e-16_rk, 6.052434934161543723e-16_rk, -1.677105846703698962e-16_rk,8.485281374238567764e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -4.898979485566355763e+00_rk, -2.513174541190256549e-16_rk, -2.527696881982705549e-16_rk,-2.795304372893409553e-17_rk, &
                                        5.106971910890036543e-17_rk, 2.518036954649108444e-18_rk, -1.024655502643500544e-16_rk,6.657909093657129391e-17_rk, &
                                        -1.942261984922362201e-16_rk, 9.802265431192444819e-17_rk, 1.061491881338960509e-15_rk,6.522081355149340018e-17_rk, &
                                        -4.063591217528074383e-18_rk, 4.197506352326672281e-16_rk, 1.963111867893484779e-16_rk,4.898979485566353098e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -2.666666666666666519e+00_rk, 7.157423275810547634e-17_rk, 1.062185670214380248e-15_rk,5.813280208738796824e-16_rk, &
                                        3.549131579928789190e-16_rk, -7.145311798163274108e-01_rk, -5.132682802273904084e-18_rk,-2.550932727357100825e-16_rk, &
                                        -4.354627623139698111e-16_rk, 1.537844709717346304e-16_rk, -9.952135486850337998e+00_rk,-4.495021891584850032e-16_rk, &
                                        -5.253163849280597160e-16_rk, -2.006411900243762457e-16_rk, 2.620749834658218585e-16_rk,-2.666666666666665630e+00_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 4.159292525604033482e-16_rk, 3.797231711444857186e-16_rk,5.580152633652798170e-17_rk, &
                                        2.209976372867203098e-16_rk, 4.898979485566355763e+00_rk, -2.155657154912324891e-16_rk,1.024909588637004105e-16_rk, &
                                        -1.959750215499173880e-16_rk, 1.015438847712804769e-16_rk, -4.898979485566353098e+00_rk,-1.529929086150783002e-16_rk, &
                                        -1.701087050972105934e-16_rk, 3.332795103970494250e-16_rk, 2.035675209300357737e-16_rk,2.167989081858710239e-15_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -3.586301888672214222e+00_rk, -4.552241522886729113e-16_rk, 1.141045930722180876e-15_rk,1.206871163168252369e-15_rk, &
                                        1.248135629816396176e-16_rk, -8.485281374238571317e+00_rk, -8.062799974747204681e-17_rk,-7.660291582059723308e-16_rk, &
                                        -4.852917073828321969e-16_rk, -1.800967788620388289e-17_rk, -8.485281374238567764e+00_rk,-6.711992468172068452e-16_rk, &
                                        -4.978375649157875841e-16_rk, -1.358273639045870582e-15_rk, -2.321681230490143800e-16_rk,-1.338426085980491820e+01_rk  &
                                        /),(/4,4/))
        
        test_dbr2_face_face6_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -7.145311798163271888e-01_rk, -1.332713165740346785e-16_rk, 5.584055750181421677e-16_rk,7.189394809556082508e-16_rk, &
                                        2.174885887905253305e-18_rk, -2.666666666666666075e+00_rk, 4.022824493160491679e-16_rk,-3.935904042267923907e-16_rk, &
                                        -2.663521093070177362e-16_rk, -1.004933170013873513e-16_rk, -2.666666666666666519e+00_rk,-4.547718858046130256e-16_rk, &
                                        -2.844347065035103223e-16_rk, -1.048160010650669883e-15_rk, -6.012163349488603707e-17_rk,-9.952135486850334445e+00_rk  &
                                        /),(/4,4/))
        
        

        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dbr2_face_face6_dx(:,:,inode_diff,idir)),self%faces(ZETA_MAX)%dbr2_f_dx(:,:,inode_diff,idir),tol)
            end do
        end do
    
    
    
    
    
    
    
    
    
    end subroutine testElement_dbr2_face_dx
    !*******************************************************************************************


    !>
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dmetrics_dx_etamax(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        real(rk)    :: test_dmetric_dx_etamax(3,3,self%faces(ETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3)
        real(rk)    :: tol
        
        integer(ik)     :: inode_diff, idir, inode, irow
        
        tol = 1.e-14_rk
       
       
       
        test_dmetric_dx_etamax(:,:,1,1,1) = reshape((/                                                                                 &
                                        -6.220084679281462359e-01_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, &
                                        6.220084679281467910e-01_rk, -6.220084679281466800e-01_rk, 0.000000000000000000e+00_rk, &
                                        -4.316050766285292543e-18_rk, 4.316050766285291773e-18_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,1,2) = reshape((/                                                                                 &
                                        -6.220084679281463469e-01_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk, &
                                        -6.220084679281466800e-01_rk, 6.220084679281465689e-01_rk, 0.000000000000000000e+00_rk, &
                                        4.316050766285290232e-18_rk, -4.316050766285290232e-18_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -8.796528112548946954e-01_rk, 8.796528112548945844e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,2,1) = reshape((/                                                                                 &
                                        -1.666666666666665741e-01_rk, 1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.666666666666666574e-01_rk, -1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.156482317317871717e-18_rk, 1.156482317317871525e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,2,2) = reshape((/                                                                                 &
                                        -1.666666666666666297e-01_rk, 1.666666666666665741e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.666666666666666852e-01_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.156482317317871525e-18_rk, -1.156482317317871332e-18_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955157558e-01_rk, 2.357022603955157281e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,3,1) = reshape((/                                                                                 &
                                        1.410683602522960989e+00_rk, 1.666666666666714036e-01_rk, 1.115355071650409480e+00_rk, &
                                        -1.410683602522964097e+00_rk, -1.666666666666598573e-01_rk, -1.115355071650409702e+00_rk, &
                                        -5.343778622954837755e-16_rk, 5.453229284626900736e-16_rk, -8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,3,2) = reshape((/                                                                                 &
                                        1.410683602522959212e+00_rk, 1.666666666666665741e-01_rk, 1.115355071650409480e+00_rk, &
                                        1.410683602522958324e+00_rk, 1.666666666666666297e-01_rk, 1.115355071650409702e+00_rk, &
                                        -9.788583849888441589e-18_rk, -1.156482317317871332e-18_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.995007882905303065e+00_rk, 2.357022603955157281e-01_rk, 1.577350269189624399e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,4,1) = reshape((/                                                                                 &
                                        -6.220084679281465689e-01_rk, -9.553418012614818267e-01_rk, 2.988584907226882192e-01_rk, &
                                        6.220084679281492335e-01_rk, 9.553418012614760535e-01_rk, -2.988584907226835008e-01_rk, &
                                        5.398503953790869246e-16_rk, -5.507954615462932226e-16_rk, 2.664535259100375697e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,4,2) = reshape((/                                                                                 &
                                        -6.220084679281483453e-01_rk, -9.553418012614817156e-01_rk, 2.988584907226859433e-01_rk, &
                                        -6.220084679281425721e-01_rk, -9.553418012614819377e-01_rk, 2.988584907226860543e-01_rk, &
                                        4.316050766285262499e-18_rk, 6.629015400921050230e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        -8.796528112548891443e-01_rk, -1.351057332045929593e+00_rk, 4.226497308103762673e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,5,1) = reshape((/                                                                                 &
                                        -1.666666666666665741e-01_rk, 1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.666666666666666574e-01_rk, -1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.156482317317871717e-18_rk, 1.156482317317871525e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,5,2) = reshape((/                                                                                 &
                                        -1.666666666666666297e-01_rk, 1.666666666666665741e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.666666666666666852e-01_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.156482317317871525e-18_rk, -1.156482317317871332e-18_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955157558e-01_rk, 2.357022603955157281e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,6,1) = reshape((/                                                                                 &
                                        -4.465819873852046318e-02_rk, 4.465819873852037297e-02_rk, 0.000000000000000000e+00_rk, &
                                        4.465819873852049093e-02_rk, -4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk, &
                                        -3.098785029861973110e-19_rk, 3.098785029861972628e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,6,2) = reshape((/                                                                                 &
                                        -4.465819873852047706e-02_rk, 4.465819873852047012e-02_rk, 0.000000000000000000e+00_rk, &
                                        -4.465819873852048399e-02_rk, 4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk, &
                                        3.098785029861972628e-19_rk, -3.098785029861972147e-19_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.315623032716868868e-02_rk, 6.315623032716867480e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,7,1) = reshape((/                                                                                 &
                                        3.779915320718560956e-01_rk, 4.465819873852083788e-02_rk, -1.115355071650411700e+00_rk, &
                                        -3.779915320718543192e-01_rk, -4.465819873852194810e-02_rk, 1.115355071650407481e+00_rk, &
                                        8.882229162511688279e-17_rk, -8.588956998450871180e-17_rk, -2.220446049250313081e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,7,2) = reshape((/                                                                                 &
                                        3.779915320718536531e-01_rk, 4.465819873852047012e-02_rk, -1.115355071650409480e+00_rk, &
                                        3.779915320718557625e-01_rk, 4.465819873852048399e-02_rk, -1.115355071650409702e+00_rk, &
                                        -2.622843137621953168e-18_rk, -3.098785029861972628e-19_rk, 1.387778780781445676e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.345607511182028926e-01_rk, 6.315623032716868868e-02_rk, -1.577350269189624399e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,8,1) = reshape((/                                                                                 &
                                        -1.666666666666685170e-01_rk, -2.559830641437076393e-01_rk, -2.988584907226869425e-01_rk, &
                                        1.666666666666669627e-01_rk, 2.559830641437094156e-01_rk, 2.988584907226847220e-01_rk, &
                                        -8.735593080481281579e-17_rk, 8.442320916420464480e-17_rk, 2.220446049250313081e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,8,2) = reshape((/                                                                                 &
                                        -1.666666666666667407e-01_rk, -2.559830641437077503e-01_rk, -2.988584907226846665e-01_rk, &
                                        -1.666666666666684060e-01_rk, -2.559830641437078058e-01_rk, -2.988584907226847220e-01_rk, &
                                        1.156482317317883080e-18_rk, 1.776239323290267110e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,1,8,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955181150e-01_rk, -3.620147210498533830e-01_rk, -4.226497308103744910e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,1,1) = reshape((/                                                                                 &
                                        -1.666666666666666574e-01_rk, 1.666666666666666574e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.666666666666666574e-01_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,1,2) = reshape((/                                                                                 &
                                        -1.666666666666665741e-01_rk, 1.666666666666665464e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.666666666666666297e-01_rk, 1.666666666666666019e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955157281e-01_rk, 2.357022603955157003e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,2,1) = reshape((/                                                                                 &
                                        -6.220084679281463469e-01_rk, 6.220084679281460138e-01_rk, 0.000000000000000000e+00_rk, &
                                        6.220084679281465689e-01_rk, -6.220084679281465689e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,2,2) = reshape((/                                                                                 &
                                        -6.220084679281463469e-01_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, &
                                        -6.220084679281464579e-01_rk, 6.220084679281462359e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -8.796528112548945844e-01_rk, 8.796528112548944733e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,3,1) = reshape((/                                                                                 &
                                        9.553418012614818267e-01_rk, 6.220084679281510098e-01_rk, 2.988584907226845555e-01_rk, &
                                        -9.553418012614840471e-01_rk, -6.220084679281407958e-01_rk, -2.988584907226871090e-01_rk, &
                                        -5.551115123125784674e-16_rk, 5.551115123125784674e-16_rk, -2.664535259100375697e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,3,2) = reshape((/                                                                                 &
                                        9.553418012614793842e-01_rk, 6.220084679281461248e-01_rk, 2.988584907226846110e-01_rk, &
                                        9.553418012614778299e-01_rk, 6.220084679281462359e-01_rk, 2.988584907226846665e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,3,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.351057332045924042e+00_rk, 8.796528112548944733e-01_rk, 4.226497308103743800e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,4,1) = reshape((/                                                                                 &
                                        -1.666666666666674068e-01_rk, -1.410683602522961433e+00_rk, 1.115355071650409480e+00_rk, &
                                        1.666666666666689611e-01_rk, 1.410683602522954994e+00_rk, -1.115355071650409480e+00_rk, &
                                        5.551115123125784674e-16_rk, -5.551115123125784674e-16_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,4,2) = reshape((/                                                                                 &
                                        -1.666666666666682950e-01_rk, -1.410683602522960767e+00_rk, 1.115355071650409258e+00_rk, &
                                        -1.666666666666629659e-01_rk, -1.410683602522961655e+00_rk, 1.115355071650409480e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955105378e-01_rk, -1.995007882905307728e+00_rk, 1.577350269189623955e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,5,1) = reshape((/                                                                                 &
                                        -4.465819873852046318e-02_rk, 4.465819873852037297e-02_rk, 0.000000000000000000e+00_rk, &
                                        4.465819873852047012e-02_rk, -4.465819873852047012e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,5,2) = reshape((/                                                                                 &
                                        -4.465819873852047706e-02_rk, 4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk, &
                                        -4.465819873852045624e-02_rk, 4.465819873852047012e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.315623032716867480e-02_rk, 6.315623032716867480e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,6,1) = reshape((/                                                                                 &
                                        -1.666666666666666574e-01_rk, 1.666666666666666574e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.666666666666666574e-01_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,6,2) = reshape((/                                                                                 &
                                        -1.666666666666665741e-01_rk, 1.666666666666665464e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.666666666666666297e-01_rk, 1.666666666666666019e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955157281e-01_rk, 2.357022603955157003e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,7,1) = reshape((/                                                                                 &
                                        2.559830641437099708e-01_rk, 1.666666666666672958e-01_rk, -2.988584907226869425e-01_rk, &
                                        -2.559830641437080834e-01_rk, -1.666666666666680729e-01_rk, 2.988584907226846665e-01_rk, &
                                        8.326672684688678984e-17_rk, -8.326672684688676518e-17_rk, -2.442490654175344389e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,7,2) = reshape((/                                                                                 &
                                        2.559830641437075283e-01_rk, 1.666666666666665464e-01_rk, -2.988584907226846110e-01_rk, &
                                        2.559830641437094156e-01_rk, 1.666666666666666019e-01_rk, -2.988584907226846665e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,7,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.620147210498557699e-01_rk, 2.357022603955157003e-01_rk, -4.226497308103743800e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,8,1) = reshape((/                                                                                 &
                                        -4.465819873852261424e-02_rk, -3.779915320718540417e-01_rk, -1.115355071650407925e+00_rk, &
                                        4.465819873852072686e-02_rk, 3.779915320718554295e-01_rk, 1.115355071650411034e+00_rk, &
                                        -8.326672684688678984e-17_rk, 8.326672684688676518e-17_rk, 2.331468351712828735e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,8,2) = reshape((/                                                                                 &
                                        -4.465819873852061583e-02_rk, -3.779915320718538196e-01_rk, -1.115355071650407925e+00_rk, &
                                        -4.465819873852228117e-02_rk, -3.779915320718539307e-01_rk, -1.115355071650408370e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,2,8,3) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        -6.315623032717115892e-02_rk, -5.345607511182003391e-01_rk, -1.577350269189621956e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,1,1) = reshape((/                                                                                 &
                                        -1.666666666666665741e-01_rk, 1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.666666666666666574e-01_rk, -1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, &
                                        4.625929269271486869e-18_rk, -4.625929269271486099e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,1,2) = reshape((/                                                                                 &
                                        -1.666666666666666297e-01_rk, 1.666666666666665741e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.666666666666666852e-01_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, &
                                        -4.625929269271486099e-18_rk, 4.625929269271485328e-18_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955157558e-01_rk, 2.357022603955157281e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,2,1) = reshape((/                                                                                 &
                                        -4.465819873852046318e-02_rk, 4.465819873852037297e-02_rk, 0.000000000000000000e+00_rk, &
                                        4.465819873852049093e-02_rk, -4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.239514011944789244e-18_rk, -1.239514011944789051e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,2,2) = reshape((/                                                                                 &
                                        -4.465819873852047706e-02_rk, 4.465819873852047012e-02_rk, 0.000000000000000000e+00_rk, &
                                        -4.465819873852048399e-02_rk, 4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.239514011944789051e-18_rk, 1.239514011944788859e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.315623032716868868e-02_rk, 6.315623032716867480e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,3,1) = reshape((/                                                                                 &
                                        3.779915320718558736e-01_rk, 4.465819873852083788e-02_rk, 1.115355071650411700e+00_rk, &
                                        -3.779915320718542082e-01_rk, -4.465819873852194810e-02_rk, -1.115355071650407481e+00_rk, &
                                        -5.773337714254989379e-16_rk, 5.656028848630663032e-16_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,3,2) = reshape((/                                                                                 &
                                        3.779915320718536531e-01_rk, 4.465819873852047706e-02_rk, 1.115355071650409480e+00_rk, &
                                        3.779915320718557625e-01_rk, 4.465819873852049787e-02_rk, 1.115355071650409702e+00_rk, &
                                        1.049137255048781267e-17_rk, 1.239514011944789629e-18_rk, 2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.345607511182028926e-01_rk, 6.315623032716870255e-02_rk, 1.577350269189624399e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,4,1) = reshape((/                                                                                 &
                                        -1.666666666666685170e-01_rk, -2.559830641437076393e-01_rk, 2.988584907226869425e-01_rk, &
                                        1.666666666666669627e-01_rk, 2.559830641437094156e-01_rk, -2.988584907226847220e-01_rk, &
                                        5.714683281442826205e-16_rk, -5.597374415818499859e-16_rk, 2.220446049250313081e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,4,2) = reshape((/                                                                                 &
                                        -1.666666666666667407e-01_rk, -2.559830641437077503e-01_rk, 2.988584907226846665e-01_rk, &
                                        -1.666666666666684060e-01_rk, -2.559830641437078058e-01_rk, 2.988584907226847220e-01_rk, &
                                        -4.625929269271532321e-18_rk, -7.104957293161068438e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,4,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955181150e-01_rk, -3.620147210498533830e-01_rk, 4.226497308103744910e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,5,1) = reshape((/                                                                                 &
                                        -6.220084679281462359e-01_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, &
                                        6.220084679281467910e-01_rk, -6.220084679281466800e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.726420306514117017e-17_rk, -1.726420306514116709e-17_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,5,2) = reshape((/                                                                                 &
                                        -6.220084679281463469e-01_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk, &
                                        -6.220084679281466800e-01_rk, 6.220084679281465689e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.726420306514116093e-17_rk, 1.726420306514116093e-17_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -8.796528112548946954e-01_rk, 8.796528112548945844e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,6,1) = reshape((/                                                                                 &
                                        -1.666666666666665741e-01_rk, 1.666666666666667407e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.666666666666666574e-01_rk, -1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, &
                                        4.625929269271486869e-18_rk, -4.625929269271486099e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,6,2) = reshape((/                                                                                 &
                                        -1.666666666666666297e-01_rk, 1.666666666666665741e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.666666666666666852e-01_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, &
                                        -4.625929269271486099e-18_rk, 4.625929269271485328e-18_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955157558e-01_rk, 2.357022603955157281e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,7,1) = reshape((/                                                                                 &
                                        1.410683602522960989e+00_rk, 1.666666666666714036e-01_rk, -1.115355071650409480e+00_rk, &
                                        -1.410683602522964097e+00_rk, -1.666666666666598573e-01_rk, 1.115355071650409702e+00_rk, &
                                        -4.079737488718945074e-15_rk, 4.035957224050119882e-15_rk, -8.881784197001252323e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,7,2) = reshape((/                                                                                 &
                                        1.410683602522958990e+00_rk, 1.666666666666665464e-01_rk, -1.115355071650409480e+00_rk, &
                                        1.410683602522958324e+00_rk, 1.666666666666666297e-01_rk, -1.115355071650409702e+00_rk, &
                                        3.915433539955376636e-17_rk, 4.625929269271484558e-18_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.995007882905303065e+00_rk, 2.357022603955157003e-01_rk, -1.577350269189624399e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,8,1) = reshape((/                                                                                 &
                                        -6.220084679281465689e-01_rk, -9.553418012614813826e-01_rk, -2.988584907226881082e-01_rk, &
                                        6.220084679281492335e-01_rk, 9.553418012614760535e-01_rk, 2.988584907226836118e-01_rk, &
                                        4.057847356384532084e-15_rk, -4.014067091715706891e-15_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,8,2) = reshape((/                                                                                 &
                                        -6.220084679281483453e-01_rk, -9.553418012614817156e-01_rk, -2.988584907226859433e-01_rk, &
                                        -6.220084679281427942e-01_rk, -9.553418012614820487e-01_rk, -2.988584907226860543e-01_rk, &
                                        -1.726420306514105308e-17_rk, -2.651606160368419476e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,3,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        -8.796528112548892553e-01_rk, -1.351057332045929371e+00_rk, -4.226497308103762673e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,1,1) = reshape((/                                                                                 &
                                        -4.465819873852046318e-02_rk, 4.465819873852037991e-02_rk, 0.000000000000000000e+00_rk, &
                                        4.465819873852047706e-02_rk, -4.465819873852047012e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,1,2) = reshape((/                                                                                 &
                                        -4.465819873852047706e-02_rk, 4.465819873852044930e-02_rk, 0.000000000000000000e+00_rk, &
                                        -4.465819873852045624e-02_rk, 4.465819873852047012e-02_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.315623032716867480e-02_rk, 6.315623032716867480e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,2,1) = reshape((/                                                                                 &
                                        -1.666666666666666574e-01_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.666666666666666574e-01_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,2,2) = reshape((/                                                                                 &
                                        -1.666666666666665741e-01_rk, 1.666666666666665464e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.666666666666666297e-01_rk, 1.666666666666666019e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955157281e-01_rk, 2.357022603955157003e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,3,1) = reshape((/                                                                                 &
                                        2.559830641437099708e-01_rk, 1.666666666666672958e-01_rk, 2.988584907226869425e-01_rk, &
                                        -2.559830641437080834e-01_rk, -1.666666666666680729e-01_rk, -2.988584907226846665e-01_rk, &
                                        -5.551115123125784674e-16_rk, 5.551115123125784674e-16_rk, -2.442490654175344389e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,3,2) = reshape((/                                                                                 &
                                        2.559830641437075283e-01_rk, 1.666666666666665464e-01_rk, 2.988584907226846110e-01_rk, &
                                        2.559830641437094156e-01_rk, 1.666666666666666019e-01_rk, 2.988584907226846665e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,3,3) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        3.620147210498557699e-01_rk, 2.357022603955157003e-01_rk, 4.226497308103743800e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,4,1) = reshape((/                                                                                 &
                                        -4.465819873852261424e-02_rk, -3.779915320718542082e-01_rk, 1.115355071650407925e+00_rk, &
                                        4.465819873852072686e-02_rk, 3.779915320718553184e-01_rk, -1.115355071650411034e+00_rk, &
                                        5.551115123125784674e-16_rk, -5.551115123125784674e-16_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,4,2) = reshape((/                                                                                 &
                                        -4.465819873852072686e-02_rk, -3.779915320718538196e-01_rk, 1.115355071650407925e+00_rk, &
                                        -4.465819873852205912e-02_rk, -3.779915320718539862e-01_rk, 1.115355071650408370e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,4,3) = reshape((/                                                                                 &
                                        2.220446049250313081e-16_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        -6.315623032717108953e-02_rk, -5.345607511182003391e-01_rk, 1.577350269189621956e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,5,1) = reshape((/                                                                                 &
                                        -1.666666666666666574e-01_rk, 1.666666666666666852e-01_rk, 0.000000000000000000e+00_rk, &
                                        1.666666666666666574e-01_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,5,2) = reshape((/                                                                                 &
                                        -1.666666666666665741e-01_rk, 1.666666666666665464e-01_rk, 0.000000000000000000e+00_rk, &
                                        -1.666666666666666297e-01_rk, 1.666666666666666019e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955157281e-01_rk, 2.357022603955157003e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,6,1) = reshape((/                                                                                 &
                                        -6.220084679281463469e-01_rk, 6.220084679281459028e-01_rk, 0.000000000000000000e+00_rk, &
                                        6.220084679281465689e-01_rk, -6.220084679281466800e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,6,2) = reshape((/                                                                                 &
                                        -6.220084679281463469e-01_rk, 6.220084679281461248e-01_rk, 0.000000000000000000e+00_rk, &
                                        -6.220084679281464579e-01_rk, 6.220084679281462359e-01_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -8.796528112548945844e-01_rk, 8.796528112548944733e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,7,1) = reshape((/                                                                                 &
                                        9.553418012614827148e-01_rk, 6.220084679281510098e-01_rk, -2.988584907226845555e-01_rk, &
                                        -9.553418012614844912e-01_rk, -6.220084679281407958e-01_rk, 2.988584907226871090e-01_rk, &
                                        -3.996802888650565912e-15_rk, 3.996802888650565123e-15_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,7,2) = reshape((/                                                                                 &
                                        9.553418012614793842e-01_rk, 6.220084679281461248e-01_rk, -2.988584907226846110e-01_rk, &
                                        9.553418012614778299e-01_rk, 6.220084679281462359e-01_rk, -2.988584907226846665e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,7,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.351057332045924042e+00_rk, 8.796528112548944733e-01_rk, -4.226497308103743800e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,8,1) = reshape((/                                                                                 &
                                        -1.666666666666674068e-01_rk, -1.410683602522961433e+00_rk, -1.115355071650409480e+00_rk, &
                                        1.666666666666689611e-01_rk, 1.410683602522954994e+00_rk, 1.115355071650409480e+00_rk, &
                                        3.996802888650565912e-15_rk, -3.996802888650565123e-15_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,8,2) = reshape((/                                                                                 &
                                        -1.666666666666682950e-01_rk, -1.410683602522960767e+00_rk, -1.115355071650409258e+00_rk, &
                                        -1.666666666666629659e-01_rk, -1.410683602522961655e+00_rk, -1.115355071650409480e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_etamax(:,:,4,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, 0.000000000000000000e+00_rk, &
                                        -2.357022603955105378e-01_rk, -1.995007882905307728e+00_rk, -1.577350269189623955e+00_rk  &
                                        /),(/3,3/))
        
        
        
        do inode = 1,self%elem%basis_s%nnodes_face()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx_etamax(:,:,inode,inode_diff,idir)),self%faces(ETA_MAX)%dmetric_dx(:,:,inode,inode_diff,idir),tol)
                end do
            end do
        end do

    end subroutine testElement_face_dmetrics_dx_etamax
    !*******************************************************************************************







    !>
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dmetrics_dx_zetamax(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        real(rk)    :: test_dmetric_dx_zetamax(3,3,self%faces(ZETA_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3)
        real(rk)    :: tol
        
        integer(ik)     :: inode_diff, idir, inode, irow
        
        tol = 1.e-14_rk
       
       
        test_dmetric_dx_zetamax(:,:,1,1,1) = reshape((/                                                                                 &
                                        -1.726420306514116093e-17_rk, 1.726420306514115168e-17_rk, 8.796528112548949174e-01_rk, &
                                        1.726420306514115168e-17_rk, -1.726420306514115168e-17_rk, -8.796528112548945844e-01_rk, &
                                        4.791778936180978678e-34_rk, -4.791778936180977823e-34_rk, -2.441527011828578138e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,1,2) = reshape((/                                                                                 &
                                        -1.726420306514114552e-17_rk, 1.726420306514114552e-17_rk, 8.796528112548944733e-01_rk, &
                                        -1.726420306514115477e-17_rk, 1.726420306514114860e-17_rk, 8.796528112548944733e-01_rk, &
                                        -4.791778936180977823e-34_rk, 4.791778936180977823e-34_rk, 2.441527011828577829e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.441527011828578446e-17_rk, 2.441527011828577829e-17_rk, 1.244016935856292472e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,1) = reshape((/                                                                                 &
                                        -4.625929269271489180e-18_rk, 4.625929269271488410e-18_rk, 2.357022603955160056e-01_rk, &
                                        4.625929269271483017e-18_rk, -4.625929269271482247e-18_rk, -2.357022603955157003e-01_rk, &
                                        1.283953296258156950e-34_rk, -1.283953296258156736e-34_rk, -6.542051911182393703e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,2) = reshape((/                                                                                 &
                                        -4.625929269271483017e-18_rk, 4.625929269271482247e-18_rk, 2.357022603955157003e-01_rk, &
                                        -4.625929269271483017e-18_rk, 4.625929269271482247e-18_rk, 2.357022603955157003e-01_rk, &
                                        -1.283953296258156950e-34_rk, 1.283953296258156736e-34_rk, 6.542051911182393703e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.542051911182395244e-18_rk, 6.542051911182393703e-18_rk, 3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,1) = reshape((/                                                                                 &
                                        -4.625929269271489180e-18_rk, 4.625929269271488410e-18_rk, 2.357022603955160056e-01_rk, &
                                        4.625929269271483017e-18_rk, -4.625929269271482247e-18_rk, -2.357022603955157003e-01_rk, &
                                        1.283953296258156950e-34_rk, -1.283953296258156736e-34_rk, -6.542051911182393703e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,2) = reshape((/                                                                                 &
                                        -4.625929269271483017e-18_rk, 4.625929269271482247e-18_rk, 2.357022603955157003e-01_rk, &
                                        -4.625929269271483017e-18_rk, 4.625929269271482247e-18_rk, 2.357022603955157003e-01_rk, &
                                        -1.283953296258156950e-34_rk, 1.283953296258156736e-34_rk, 6.542051911182393703e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -6.542051911182395244e-18_rk, 6.542051911182393703e-18_rk, 3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,1) = reshape((/                                                                                 &
                                        -1.239514011944786162e-18_rk, 1.239514011944785970e-18_rk, 6.315623032716856378e-02_rk, &
                                        1.239514011944788474e-18_rk, -1.239514011944788281e-18_rk, -6.315623032716867480e-02_rk, &
                                        3.440342488516514748e-35_rk, -3.440342488516514214e-35_rk, -1.752937526443806919e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,2) = reshape((/                                                                                 &
                                        -1.239514011944788281e-18_rk, 1.239514011944787896e-18_rk, 6.315623032716867480e-02_rk, &
                                        -1.239514011944788281e-18_rk, 1.239514011944788088e-18_rk, 6.315623032716867480e-02_rk, &
                                        -3.440342488516514214e-35_rk, 3.440342488516513679e-35_rk, 1.752937526443806534e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.752937526443806919e-18_rk, 1.752937526443806534e-18_rk, 8.931639747704094023e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,1) = reshape((/                                                                                 &
                                        -5.329070518200751394e-15_rk, 1.577350269189624399e+00_rk, -8.796528112548911427e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.577350269189623733e+00_rk, 8.796528112548983591e-01_rk, &
                                        -4.378026466882542656e-17_rk, 1.664003471950571777e-31_rk, 8.881784197001252323e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,2) = reshape((/                                                                                 &
                                        -5.773159728050814010e-15_rk, 1.577350269189623955e+00_rk, -8.796528112548974709e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189624177e+00_rk, -8.796528112548974709e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.378026466882523551e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        2.441527011828586458e-17_rk, 2.230710143300818959e+00_rk, -1.244016935856296691e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,1) = reshape((/                                                                                 &
                                        -9.999999999999928946e-01_rk, -5.773502691896226224e-01_rk, -2.357022603955163942e-01_rk, &
                                        9.999999999999982236e-01_rk, 5.773502691896257311e-01_rk, 2.357022603955152840e-01_rk, &
                                        -1.593798696653281296e-15_rk, 1.637578961322106094e-15_rk, -8.437694987151189707e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,2) = reshape((/                                                                                 &
                                        -9.999999999999984457e-01_rk, -5.773502691896238437e-01_rk, -2.357022603955160889e-01_rk, &
                                        -1.000000000000000000e+00_rk, -5.773502691896238437e-01_rk, -2.357022603955160889e-01_rk, &
                                        -2.775557561562892584e-17_rk, -1.602468905319631583e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.414213562373095590e+00_rk, -8.164965809277235920e-01_rk, -3.333333333333338144e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,1) = reshape((/                                                                                 &
                                        9.999999999999997780e-01_rk, -5.773502691896255090e-01_rk, -2.357022603955157003e-01_rk, &
                                        -9.999999999999982236e-01_rk, 5.773502691896226224e-01_rk, 2.357022603955160056e-01_rk, &
                                        1.625848074759674249e-15_rk, -1.637578961322106489e-15_rk, -2.220446049250313081e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,2) = reshape((/                                                                                 &
                                        1.000000000000005773e+00_rk, -5.773502691896238437e-01_rk, -2.357022603955160889e-01_rk, &
                                        1.000000000000000000e+00_rk, -5.773502691896238437e-01_rk, -2.357022603955160889e-01_rk, &
                                        2.775557561562891967e-17_rk, -1.602468905319631583e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.414213562373095590e+00_rk, -8.164965809277235920e-01_rk, -3.333333333333338144e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,1) = reshape((/                                                                                 &
                                        -1.776356839400250465e-15_rk, -4.226497308103759898e-01_rk, -6.315623032716852214e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.226497308103759898e-01_rk, 6.315623032716871643e-02_rk, &
                                        1.173088656243256070e-17_rk, 4.160008679876429443e-32_rk, 2.109423746787797427e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.226497308103744910e-01_rk, -6.315623032716860541e-02_rk, &
                                        -1.554312234475219157e-15_rk, -4.226497308103744355e-01_rk, -6.315623032716860541e-02_rk, &
                                        -4.314083075427408311e-32_rk, -1.173088656243255300e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,1,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.196376504630842130e-15_rk, -5.977169814453693331e-01_rk, -8.931639747704085697e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955159501e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.906538933386795855e-18_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -4.906538933386797396e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548946954e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548946954e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548945844e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548945844e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,2,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 1.831145258871433834e-17_rk, &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, -1.831145258871434451e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716854990e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.315623032716868868e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716867480e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716867480e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.314703144832854900e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.314703144832855286e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955159501e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.906538933386795855e-18_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -4.906538933386797396e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,1) = reshape((/                                                                                 &
                                        5.773502691896177375e-01_rk, 9.999999999999995559e-01_rk, -2.357022603955123419e-01_rk, &
                                        -5.773502691896235106e-01_rk, -1.000000000000000888e+00_rk, 2.357022603955193363e-01_rk, &
                                        1.776356839400251648e-15_rk, -1.776356839400251254e-15_rk, 8.881784197001252323e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,2) = reshape((/                                                                                 &
                                        5.773502691896248429e-01_rk, 9.999999999999992228e-01_rk, -2.357022603955185591e-01_rk, &
                                        5.773502691896250649e-01_rk, 9.999999999999993339e-01_rk, -2.357022603955185869e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, -4.906538933386855174e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.906538933386856715e-18_rk, &
                                        8.164965809277249242e-01_rk, 1.414213562373094479e+00_rk, -3.333333333333373671e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,1) = reshape((/                                                                                 &
                                        -1.577350269189619070e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548953615e-01_rk, &
                                        1.577350269189625287e+00_rk, 8.881784197001252323e-16_rk, 8.796528112548943623e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.769962616701377556e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,2) = reshape((/                                                                                 &
                                        -1.577350269189629950e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548950284e-01_rk, &
                                        -1.577350269189624177e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548950284e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,6,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, -1.831145258871434759e-17_rk, &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, 1.831145258871435375e-17_rk, &
                                        -2.230710143300819848e+00_rk, 0.000000000000000000e+00_rk, -1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,1) = reshape((/                                                                                 &
                                        4.226497308103762673e-01_rk, -1.443289932012703503e-15_rk, -6.315623032716828622e-02_rk, &
                                        -4.226497308103744910e-01_rk, -1.776356839400250465e-15_rk, 6.315623032716896623e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,2) = reshape((/                                                                                 &
                                        4.226497308103744910e-01_rk, 0.000000000000000000e+00_rk, -6.315623032716907725e-02_rk, &
                                        4.226497308103761008e-01_rk, 0.000000000000000000e+00_rk, -6.315623032716907725e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,7,3) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, -1.314703144832863182e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.314703144832863760e-18_rk, &
                                        5.977169814453717755e-01_rk, 0.000000000000000000e+00_rk, -8.931639747704149535e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,1) = reshape((/                                                                                 &
                                        5.773502691896232886e-01_rk, -9.999999999999995559e-01_rk, -2.357022603955159501e-01_rk, &
                                        -5.773502691896250649e-01_rk, 1.000000000000000888e+00_rk, 2.357022603955157558e-01_rk, &
                                        -1.665334536937735797e-15_rk, 1.665334536937735599e-15_rk, 2.220446049250313081e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,2) = reshape((/                                                                                 &
                                        5.773502691896306160e-01_rk, -9.999999999999992228e-01_rk, -2.357022603955156725e-01_rk, &
                                        5.773502691896232886e-01_rk, -9.999999999999993339e-01_rk, -2.357022603955156448e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,2,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, -4.906538933386794315e-18_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 4.906538933386795855e-18_rk, &
                                        8.164965809277230369e-01_rk, -1.414213562373094479e+00_rk, -3.333333333333332038e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,1) = reshape((/                                                                                 &
                                        -4.625929269271487639e-18_rk, 4.625929269271488410e-18_rk, 2.357022603955159223e-01_rk, &
                                        4.625929269271483788e-18_rk, -4.625929269271483788e-18_rk, -2.357022603955157558e-01_rk, &
                                        1.283953296258157378e-34_rk, -1.283953296258157378e-34_rk, -6.542051911182395244e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,2) = reshape((/                                                                                 &
                                        -4.625929269271483788e-18_rk, 4.625929269271483788e-18_rk, 2.357022603955157281e-01_rk, &
                                        -4.625929269271483017e-18_rk, 4.625929269271483017e-18_rk, 2.357022603955157281e-01_rk, &
                                        -1.283953296258157164e-34_rk, 1.283953296258157164e-34_rk, 6.542051911182394474e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,1,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, -6.542051911182394474e-18_rk, &
                                        2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, -6.542051911182394474e-18_rk, &
                                        -6.542051911182394474e-18_rk, 6.542051911182394474e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,1) = reshape((/                                                                                 &
                                        -1.239514011944785970e-18_rk, 1.239514011944785970e-18_rk, 6.315623032716854990e-02_rk, &
                                        1.239514011944788666e-18_rk, -1.239514011944788666e-18_rk, -6.315623032716868868e-02_rk, &
                                        3.440342488516515283e-35_rk, -3.440342488516515283e-35_rk, -1.752937526443806919e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,2) = reshape((/                                                                                 &
                                        -1.239514011944788281e-18_rk, 1.239514011944788088e-18_rk, 6.315623032716867480e-02_rk, &
                                        -1.239514011944788474e-18_rk, 1.239514011944788474e-18_rk, 6.315623032716867480e-02_rk, &
                                        -3.440342488516514748e-35_rk, 3.440342488516514748e-35_rk, 1.752937526443806534e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.752937526443806534e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.752937526443806534e-18_rk, &
                                        -1.752937526443806534e-18_rk, 1.752937526443806534e-18_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,1) = reshape((/                                                                                 &
                                        -1.726420306514115168e-17_rk, 1.726420306514114860e-17_rk, 8.796528112548945844e-01_rk, &
                                        1.726420306514115477e-17_rk, -1.726420306514115477e-17_rk, -8.796528112548949174e-01_rk, &
                                        4.791778936180980389e-34_rk, -4.791778936180980389e-34_rk, -2.441527011828579062e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,2) = reshape((/                                                                                 &
                                        -1.726420306514114552e-17_rk, 1.726420306514115168e-17_rk, 8.796528112548945844e-01_rk, &
                                        -1.726420306514115477e-17_rk, 1.726420306514115477e-17_rk, 8.796528112548945844e-01_rk, &
                                        -4.791778936180979534e-34_rk, 4.791778936180979534e-34_rk, 2.441527011828578446e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk, -2.441527011828578446e-17_rk, &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, -2.441527011828578446e-17_rk, &
                                        -2.441527011828578446e-17_rk, 2.441527011828578446e-17_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,1) = reshape((/                                                                                 &
                                        -4.625929269271487639e-18_rk, 4.625929269271488410e-18_rk, 2.357022603955159223e-01_rk, &
                                        4.625929269271483788e-18_rk, -4.625929269271483788e-18_rk, -2.357022603955157558e-01_rk, &
                                        1.283953296258157378e-34_rk, -1.283953296258157378e-34_rk, -6.542051911182395244e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,2) = reshape((/                                                                                 &
                                        -4.625929269271483788e-18_rk, 4.625929269271483788e-18_rk, 2.357022603955157281e-01_rk, &
                                        -4.625929269271483017e-18_rk, 4.625929269271483017e-18_rk, 2.357022603955157281e-01_rk, &
                                        -1.283953296258157164e-34_rk, 1.283953296258157164e-34_rk, 6.542051911182394474e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,4,3) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, -6.542051911182394474e-18_rk, &
                                        2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, -6.542051911182394474e-18_rk, &
                                        -6.542051911182394474e-18_rk, 6.542051911182394474e-18_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,1) = reshape((/                                                                                 &
                                        -5.773502691896215122e-01_rk, 1.000000000000001110e+00_rk, -2.357022603955152562e-01_rk, &
                                        5.773502691896230665e-01_rk, -9.999999999999991118e-01_rk, 2.357022603955165052e-01_rk, &
                                        -1.772063036909487609e-15_rk, 1.760332150347054975e-15_rk, -2.026157019940910686e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,2) = reshape((/                                                                                 &
                                        -5.773502691896308381e-01_rk, 9.999999999999992228e-01_rk, -2.357022603955157003e-01_rk, &
                                        -5.773502691896230665e-01_rk, 9.999999999999993339e-01_rk, -2.357022603955157003e-01_rk, &
                                        -1.602468905319630351e-17_rk, 2.775557561562890427e-17_rk, 2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,5,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, 6.542051911182393703e-18_rk, &
                                        -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, 6.542051911182394474e-18_rk, &
                                        -8.164965809277227038e-01_rk, 1.414213562373094479e+00_rk, -3.333333333333332593e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,1) = reshape((/                                                                                 &
                                        -4.226497308103760453e-01_rk, 1.443289932012703503e-15_rk, -6.315623032716892460e-02_rk, &
                                        4.226497308103741579e-01_rk, 1.776356839400250465e-15_rk, 6.315623032716831398e-02_rk, &
                                        2.346177312486511524e-17_rk, -1.173088656243251294e-17_rk, 2.220446049250313081e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,2) = reshape((/                                                                                 &
                                        -4.226497308103744910e-01_rk, -1.239514011944796562e-18_rk, -6.315623032716907725e-02_rk, &
                                        -4.226497308103761008e-01_rk, -1.239514011944796370e-18_rk, -6.315623032716907725e-02_rk, &
                                        -1.173088656243260230e-17_rk, -3.440342488516536130e-35_rk, -1.752937526443818090e-18_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,6,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, 1.752937526443817704e-18_rk, &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 1.752937526443817704e-18_rk, &
                                        -5.977169814453717755e-01_rk, -1.752937526443817704e-18_rk, -8.931639747704149535e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,1) = reshape((/                                                                                 &
                                        1.577350269189619958e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548887002e-01_rk, &
                                        -1.577350269189623955e+00_rk, -8.881784197001252323e-16_rk, 8.796528112549009126e-01_rk, &
                                        -8.756052933765066823e-17_rk, 4.378026466882541423e-17_rk, 9.769962616701377556e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,2) = reshape((/                                                                                 &
                                        1.577350269189629950e+00_rk, -1.726420306514116093e-17_rk, -8.796528112548950284e-01_rk, &
                                        1.577350269189624177e+00_rk, -1.726420306514116093e-17_rk, -8.796528112548950284e-01_rk, &
                                        4.378026466882525400e-17_rk, -4.791778936180981244e-34_rk, -2.441527011828579678e-17_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.441527011828579678e-17_rk, &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 2.441527011828579986e-17_rk, &
                                        2.230710143300819848e+00_rk, -2.441527011828579986e-17_rk, -1.244016935856293360e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,1) = reshape((/                                                                                 &
                                        -5.773502691896186256e-01_rk, -1.000000000000000666e+00_rk, -2.357022603955187812e-01_rk, &
                                        5.773502691896248429e-01_rk, 9.999999999999995559e-01_rk, 2.357022603955128970e-01_rk, &
                                        1.836161793122273119e-15_rk, -1.792381528453447927e-15_rk, -9.325873406851314940e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,2) = reshape((/                                                                                 &
                                        -5.773502691896248429e-01_rk, -9.999999999999992228e-01_rk, -2.357022603955185314e-01_rk, &
                                        -5.773502691896248429e-01_rk, -9.999999999999993339e-01_rk, -2.357022603955185314e-01_rk, &
                                        -1.602468905319634973e-17_rk, -2.775557561562890427e-17_rk, -2.220446049250313081e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,3,8,3) = reshape((/                                                                                 &
                                        2.775557561562891351e-17_rk, 5.551115123125782702e-17_rk, 6.542051911182472281e-18_rk, &
                                        -5.551115123125782702e-17_rk, 8.326672684688674053e-17_rk, 6.542051911182473052e-18_rk, &
                                        -8.164965809277251463e-01_rk, -1.414213562373094479e+00_rk, -3.333333333333372561e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716856378e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.315623032716870255e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716868868e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716868868e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.931639747704095411e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955159501e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955158113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157558e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157558e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955159501e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955158113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157558e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157558e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.333333333333333148e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548946954e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548950284e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548946954e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548946954e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,4,3) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        -1.110223024625156540e-16_rk, 1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.244016935856292916e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,1) = reshape((/                                                                                 &
                                        1.554312234475219157e-15_rk, 4.226497308103761563e-01_rk, -6.315623032716784213e-02_rk, &
                                        -5.551115123125782702e-17_rk, -4.226497308103759898e-01_rk, 6.315623032716942420e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.998401444325281773e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.226497308103744355e-01_rk, -6.315623032716863317e-02_rk, &
                                        1.554312234475219157e-15_rk, 4.226497308103746020e-01_rk, -6.315623032716863317e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,5,3) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.276634065091475656e-15_rk, 5.977169814453695551e-01_rk, -8.931639747704087084e-02_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,1) = reshape((/                                                                                 &
                                        -1.000000000000002220e+00_rk, 5.773502691896239547e-01_rk, -2.357022603955163109e-01_rk, &
                                        1.000000000000000666e+00_rk, -5.773502691896248429e-01_rk, 2.357022603955154505e-01_rk, &
                                        1.776356839400251648e-15_rk, -1.776356839400251648e-15_rk, 1.776356839400250465e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,2) = reshape((/                                                                                 &
                                        -1.000000000000005995e+00_rk, 5.773502691896241767e-01_rk, -2.357022603955161444e-01_rk, &
                                        -1.000000000000000222e+00_rk, 5.773502691896241767e-01_rk, -2.357022603955161444e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,6,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.414213562373095812e+00_rk, 8.164965809277239250e-01_rk, -3.333333333333338699e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,1) = reshape((/                                                                                 &
                                        9.999999999999946709e-01_rk, 5.773502691896257311e-01_rk, -2.357022603955099549e-01_rk, &
                                        -1.000000000000000888e+00_rk, -5.773502691896235106e-01_rk, 2.357022603955218065e-01_rk, &
                                        -1.776356839400251648e-15_rk, 1.776356839400251648e-15_rk, 9.769962616701377556e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,2) = reshape((/                                                                                 &
                                        9.999999999999986677e-01_rk, 5.773502691896241767e-01_rk, -2.357022603955161444e-01_rk, &
                                        9.999999999999997780e-01_rk, 5.773502691896241767e-01_rk, -2.357022603955161444e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,7,3) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        1.414213562373095812e+00_rk, 8.164965809277239250e-01_rk, -3.333333333333338699e-01_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,1) = reshape((/                                                                                 &
                                        5.329070518200751394e-15_rk, -1.577350269189624843e+00_rk, -8.796528112548976930e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.577350269189623955e+00_rk, 8.796528112548920308e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -9.325873406851314940e-15_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,2) = reshape((/                                                                                 &
                                        4.884981308350688778e-15_rk, -1.577350269189624843e+00_rk, -8.796528112548976930e-01_rk, &
                                        4.440892098500626162e-16_rk, -1.577350269189624399e+00_rk, -8.796528112548976930e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.440892098500626162e-16_rk  &
                                        /),(/3,3/))
        
        test_dmetric_dx_zetamax(:,:,4,8,3) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        1.110223024625156540e-16_rk, -1.110223024625156540e-16_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.230710143300819848e+00_rk, -1.244016935856296913e+00_rk  &
                                        /),(/3,3/))
        
       
        
        
        
        do inode = 1,self%elem%basis_s%nnodes_face()
            do inode_diff = 1,self%elem%nterms_c
                do idir = 1,3
                    @assertEqual(transpose(test_dmetric_dx_zetamax(:,:,inode,inode_diff,idir)),self%faces(ZETA_MAX)%dmetric_dx(:,:,inode,inode_diff,idir),tol)
                end do
            end do
        end do

    end subroutine testElement_face_dmetrics_dx_zetamax
    !*******************************************************************************************







    !> Test cartesian face dgrad_dx  
    !!
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testElement_face_dgrad_dx_etamin(self)
        class(test_element_linearB_dx),    intent(inout)   :: self
        
        
        real(rk), dimension(self%elem%nterms_s,self%elem%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dgrad1_dx, test_dgrad2_dx, test_dgrad3_dx
        
        real(rk)        :: tol
        integer(ik)     :: inode_diff, idir, inode, irow
        tol = 1.e-14_rk
       
       
        !
        ! dgrad1_dx
        ! 
        
        test_dgrad1_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666642982e-01_rk, 5.533352729892883116e-16_rk,1.666666666666629659e-01_rk,-7.044162180172630627e-02_rk,-9.622504486493733966e-02_rk,9.622504486493620168e-02_rk,4.066948930938241863e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281443485e-01_rk, 5.551115123125785660e-16_rk,6.220084679281421280e-01_rk,-9.811252243246832982e-01_rk,-3.591167563965407261e-01_rk,3.591167563965405041e-01_rk,5.664529123725885462e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852017174e-02_rk, 5.282633239303866758e-16_rk,4.465819873852205912e-02_rk,-1.887477567531348210e-02_rk,2.578342306320813987e-02_rk,-2.578342306320900723e-02_rk,-1.089735681703474929e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666664076e-01_rk, 5.551115123125785660e-16_rk,1.666666666666680729e-01_rk,-2.628917115316056208e-01_rk,9.622504486493754783e-02_rk,-9.622504486493815845e-02_rk,-1.517806004204930170e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666634100e-01_rk, -1.156482317317845717e-18_rk,1.666666666666687391e-01_rk,-2.628917115316045106e-01_rk,-9.622504486493888010e-02_rk,-9.622504486493554943e-02_rk,1.517806004204933501e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281430162e-01_rk, 0.000000000000000000e+00_rk,6.220084679281485673e-01_rk,-2.628917115316087294e-01_rk,-3.591167563965436127e-01_rk,-3.591167563965398379e-01_rk,1.517806004204961257e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852228117e-02_rk, 1.239514011944837392e-18_rk,4.465819873852072686e-02_rk,-7.044162180173041410e-02_rk,2.578342306320880600e-02_rk,2.578342306320964214e-02_rk,-4.066948930938291823e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666684060e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667962e-01_rk,-7.044162180172808263e-02_rk,9.622504486493771436e-02_rk,9.622504486493871356e-02_rk,-4.066948930938166229e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955104267e-01_rk,-2.220446049250313081e-16_rk,1.110223024625156540e-16_rk,-1.360827634879512582e-01_rk,-2.357022603955105378e-01_rk,1.360827634879513137e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 8.796528112548895884e-01_rk,-5.551115123125782702e-17_rk,2.775557561562891351e-17_rk,5.078677873714216862e-01_rk,-8.796528112548895884e-01_rk,-5.078677873714216862e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032717102014e-02_rk,-2.220446049250313081e-16_rk,2.220446049250313081e-16_rk,-3.646326658039420604e-02_rk,-6.315623032717102014e-02_rk,3.646326658039415053e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 2.357022603955181705e-01_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,1.360827634879557269e-01_rk,-2.357022603955181705e-01_rk,-1.360827634879556713e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 9.553418012614800503e-01_rk, -5.588078060728914607e-16_rk,-9.553418012614782739e-01_rk,4.037749551350602317e-01_rk,5.515668461264193745e-01_rk,-5.515668461264167100e-01_rk,-2.331195790392599498e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.410683602522960101e+00_rk, -5.551115123125785660e-16_rk,-1.410683602522956548e+00_rk,2.225142160180977768e+00_rk,8.144585576580216646e-01_rk,-8.144585576580218866e-01_rk,-1.284686425165675328e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.559830641437076393e-01_rk, -5.223978806491704570e-16_rk,-2.559830641437093046e-01_rk,1.081911731523543807e-01_rk,-1.477918909913545908e-01_rk,1.477918909913555068e-01_rk,6.246420294345213231e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.779915320718537641e-01_rk, -5.551115123125785660e-16_rk,-3.779915320718554295e-01_rk,5.962250448649393242e-01_rk,-2.182335127930841168e-01_rk,2.182335127930845609e-01_rk,3.442306901503685568e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -9.553418012614787180e-01_rk, 6.629015400921024037e-18_rk,-9.553418012614791621e-01_rk,1.506908647387895872e+00_rk,5.515668461264172651e-01_rk,5.515668461264167100e-01_rk,-8.700141132135762456e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.410683602522958324e+00_rk, 0.000000000000000000e+00_rk,-1.410683602522959212e+00_rk,5.962250448649376589e-01_rk,8.144585576580218866e-01_rk,8.144585576580214425e-01_rk,-3.442306901503695005e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.559830641437096377e-01_rk, -7.104957293161116201e-18_rk,-2.559830641437074727e-01_rk,4.037749551350635069e-01_rk,-1.477918909913548684e-01_rk,-1.477918909913559786e-01_rk,2.331195790392579514e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.779915320718557625e-01_rk, 0.000000000000000000e+00_rk,-3.779915320718536531e-01_rk,1.597580192787686482e-01_rk,-2.182335127930838670e-01_rk,-2.182335127930850327e-01_rk,9.223633543579873306e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, -1.351057332045924264e+00_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,7.800333143473321407e-01_rk,1.351057332045924264e+00_rk,-7.800333143473321407e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.995007882905303287e+00_rk,-2.220446049250313081e-16_rk,3.330669073875469621e-16_rk,-1.151818338230802707e+00_rk,1.995007882905303287e+00_rk,1.151818338230802707e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, -3.620147210498558255e-01_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,2.090092966487416271e-01_rk,3.620147210498558255e-01_rk,-2.090092966487416271e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.345607511182027816e-01_rk,-2.220446049250313081e-16_rk,3.330669073875469621e-16_rk,-3.086287935563030715e-01_rk,5.345607511182027816e-01_rk,3.086287935563031271e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 4.316050766285289462e-18_rk,6.220084679281460138e-01_rk,-2.628917115316038444e-01_rk,-3.591167563965420584e-01_rk,3.591167563965421694e-01_rk,1.517806004204934611e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666665464e-01_rk,-2.628917115316042885e-01_rk,-9.622504486493761722e-02_rk,9.622504486493767273e-02_rk,1.517806004204930725e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, -4.625929269271485328e-18_rk,1.666666666666665464e-01_rk,-7.044162180172888754e-02_rk,9.622504486493761722e-02_rk,-9.622504486493767273e-02_rk,-4.066948930938212026e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,-7.044162180172909571e-02_rk,2.578342306320860478e-02_rk,-2.578342306320861865e-02_rk,-4.066948930938207862e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.220084679281465689e-01_rk, -4.316050766285290232e-18_rk,6.220084679281461248e-01_rk,-9.811252243246882943e-01_rk,-3.591167563965418363e-01_rk,-3.591167563965421694e-01_rk,5.664529123725904336e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-7.044162180172897081e-02_rk,-9.622504486493763110e-02_rk,-9.622504486493767273e-02_rk,4.066948930938216189e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 4.625929269271485328e-18_rk,1.666666666666666297e-01_rk,-2.628917115316042885e-01_rk,9.622504486493763110e-02_rk,9.622504486493767273e-02_rk,-1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,4.465819873852044930e-02_rk,-1.887477567531181677e-02_rk,2.578342306320859090e-02_rk,2.578342306320861171e-02_rk,-1.089735681703511705e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548945844e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.078677873714246838e-01_rk,-8.796528112548945844e-01_rk,5.078677873714246838e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.360827634879543113e-01_rk,-2.357022603955157281e-01_rk,-1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.360827634879543113e-01_rk,-2.357022603955157281e-01_rk,1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716867480e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.646326658039285296e-02_rk,-6.315623032716867480e-02_rk,-3.646326658039285296e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 1.156482317317871332e-18_rk,1.666666666666665464e-01_rk,-7.044162180172888754e-02_rk,-9.622504486493761722e-02_rk,9.622504486493767273e-02_rk,4.066948930938212026e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281464579e-01_rk, 0.000000000000000000e+00_rk,6.220084679281460138e-01_rk,-9.811252243246880722e-01_rk,-3.591167563965420584e-01_rk,3.591167563965421694e-01_rk,5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, -1.239514011944788859e-18_rk,4.465819873852046318e-02_rk,-1.887477567531183065e-02_rk,2.578342306320860478e-02_rk,-2.578342306320861865e-02_rk,-1.089735681703513093e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666665464e-01_rk,-2.628917115316041775e-01_rk,9.622504486493761722e-02_rk,-9.622504486493767273e-02_rk,-1.517806004204930725e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, -1.156482317317871332e-18_rk,1.666666666666666297e-01_rk,-2.628917115316042885e-01_rk,-9.622504486493763110e-02_rk,-9.622504486493767273e-02_rk,1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281465689e-01_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,-2.628917115316038444e-01_rk,-3.591167563965418363e-01_rk,-3.591167563965421694e-01_rk,1.517806004204932391e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852048399e-02_rk, 1.239514011944788859e-18_rk,4.465819873852044930e-02_rk,-7.044162180172906795e-02_rk,2.578342306320859090e-02_rk,2.578342306320861171e-02_rk,-4.066948930938206475e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-7.044162180172897081e-02_rk,9.622504486493763110e-02_rk,9.622504486493767273e-02_rk,-4.066948930938216189e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.360827634879543113e-01_rk,-2.357022603955157281e-01_rk,1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548945844e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.078677873714246838e-01_rk,-8.796528112548945844e-01_rk,-5.078677873714246838e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716867480e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.646326658039285296e-02_rk,-6.315623032716867480e-02_rk,3.646326658039285296e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.360827634879543113e-01_rk,-2.357022603955157281e-01_rk,-1.360827634879543113e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.465819873852011623e-02_rk, -7.655467975133884192e-17_rk,4.465819873852217015e-02_rk,-1.887477567531370415e-02_rk,-2.578342306320858049e-02_rk,2.578342306320857355e-02_rk,1.089735681703518817e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666662966e-01_rk, -8.326672684688677751e-17_rk,1.666666666666680729e-01_rk,-2.628917115316056208e-01_rk,-9.622504486493721476e-02_rk,9.622504486493771436e-02_rk,1.517806004204926840e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666642982e-01_rk, 4.003907845943727324e-15_rk,1.666666666666629659e-01_rk,-7.044162180172630627e-02_rk,9.622504486493468900e-02_rk,-9.622504486494061482e-02_rk,-4.066948930937977491e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281443485e-01_rk, 3.996802888650565912e-15_rk,6.220084679281421280e-01_rk,-9.811252243246832982e-01_rk,3.591167563965433907e-01_rk,-3.591167563965449450e-01_rk,-5.664529123725912108e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.465819873852228117e-02_rk, -3.098785029862093480e-19_rk,4.465819873852072686e-02_rk,-7.044162180173041410e-02_rk,-2.578342306320879906e-02_rk,-2.578342306320963520e-02_rk,4.066948930938291129e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666684060e-01_rk, 0.000000000000000000e+00_rk,1.666666666666667962e-01_rk,-7.044162180172808263e-02_rk,-9.622504486493771436e-02_rk,-9.622504486493871356e-02_rk,4.066948930938166229e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666629659e-01_rk, 4.625929269271389032e-18_rk,1.666666666666687391e-01_rk,-2.628917115316045106e-01_rk,9.622504486493888010e-02_rk,9.622504486493554943e-02_rk,-1.517806004204933501e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281430162e-01_rk, 0.000000000000000000e+00_rk,6.220084679281485673e-01_rk,-2.628917115316087294e-01_rk,3.591167563965436127e-01_rk,3.591167563965398379e-01_rk,-1.517806004204961257e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032717103402e-02_rk,2.220446049250313081e-16_rk,-2.220446049250313081e-16_rk,-3.646326658039421992e-02_rk,-6.315623032717103402e-02_rk,3.646326658039416441e-02_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 2.357022603955181705e-01_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,1.360827634879557269e-01_rk,-2.357022603955181705e-01_rk,-1.360827634879556713e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955107598e-01_rk,2.220446049250313081e-16_rk,-1.110223024625156540e-16_rk,-1.360827634879514247e-01_rk,-2.357022603955108431e-01_rk,1.360827634879514803e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 8.796528112548895884e-01_rk,5.551115123125782702e-17_rk,0.000000000000000000e+00_rk,5.078677873714216862e-01_rk,-8.796528112548895884e-01_rk,-5.078677873714216862e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.559830641437076393e-01_rk, 7.508831893103477491e-17_rk,-2.559830641437093046e-01_rk,1.081911731523543807e-01_rk,1.477918909913549239e-01_rk,-1.477918909913550904e-01_rk,-6.246420294345234048e-02_rk, &
                                        0.000000000000000000e+00_rk, 3.779915320718537641e-01_rk, 8.326672684688677751e-17_rk,-3.779915320718556515e-01_rk,5.962250448649393242e-01_rk,2.182335127930836727e-01_rk,-2.182335127930841168e-01_rk,-3.442306901503682237e-01_rk, &
                                        0.000000000000000000e+00_rk, 9.553418012614796062e-01_rk, -3.982017713609314334e-15_rk,-9.553418012614782739e-01_rk,4.037749551350602317e-01_rk,-5.515668461264162659e-01_rk,5.515668461264214839e-01_rk,2.331195790392564249e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.410683602522960101e+00_rk, -3.996802888650565912e-15_rk,-1.410683602522956548e+00_rk,2.225142160180977768e+00_rk,-8.144585576580238850e-01_rk,8.144585576580263275e-01_rk,1.284686425165677104e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.559830641437096377e-01_rk, 1.776239323290279050e-18_rk,-2.559830641437074727e-01_rk,4.037749551350635069e-01_rk,1.477918909913548684e-01_rk,1.477918909913559786e-01_rk,-2.331195790392579514e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.779915320718557625e-01_rk, 0.000000000000000000e+00_rk,-3.779915320718536531e-01_rk,1.597580192787686482e-01_rk,2.182335127930838670e-01_rk,2.182335127930850327e-01_rk,-9.223633543579873306e-02_rk, &
                                        0.000000000000000000e+00_rk, -9.553418012614787180e-01_rk, -2.651606160368409615e-17_rk,-9.553418012614791621e-01_rk,1.506908647387895872e+00_rk,-5.515668461264172651e-01_rk,-5.515668461264167100e-01_rk,8.700141132135762456e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.410683602522958324e+00_rk, 0.000000000000000000e+00_rk,-1.410683602522959212e+00_rk,5.962250448649376589e-01_rk,-8.144585576580218866e-01_rk,-8.144585576580214425e-01_rk,3.442306901503695005e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, -3.620147210498558255e-01_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,2.090092966487416271e-01_rk,3.620147210498558255e-01_rk,-2.090092966487416271e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.345607511182027816e-01_rk,2.220446049250313081e-16_rk,-3.330669073875469621e-16_rk,-3.086287935563030715e-01_rk,5.345607511182027816e-01_rk,3.086287935563031271e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, -1.351057332045924264e+00_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,7.800333143473321407e-01_rk,1.351057332045924264e+00_rk,-7.800333143473321407e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.995007882905303287e+00_rk,2.220446049250313081e-16_rk,-3.330669073875469621e-16_rk,-1.151818338230802707e+00_rk,1.995007882905303287e+00_rk,1.151818338230802707e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 1.156482317317871332e-18_rk,1.666666666666665464e-01_rk,-7.044162180172888754e-02_rk,-9.622504486493761722e-02_rk,9.622504486493767273e-02_rk,4.066948930938212026e-02_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,4.465819873852046318e-02_rk,-7.044162180172909571e-02_rk,-2.578342306320860478e-02_rk,2.578342306320861865e-02_rk,4.066948930938207862e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, -1.726420306514115785e-17_rk,6.220084679281460138e-01_rk,-2.628917115316038444e-01_rk,3.591167563965420584e-01_rk,-3.591167563965421694e-01_rk,-1.517806004204934611e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666665464e-01_rk,-2.628917115316041775e-01_rk,9.622504486493761722e-02_rk,-9.622504486493767273e-02_rk,-1.517806004204930725e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, -1.156482317317871332e-18_rk,1.666666666666666297e-01_rk,-2.628917115316042885e-01_rk,-9.622504486493763110e-02_rk,-9.622504486493767273e-02_rk,1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,4.465819873852044930e-02_rk,-1.887477567531181677e-02_rk,-2.578342306320859090e-02_rk,-2.578342306320861171e-02_rk,1.089735681703511705e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281465689e-01_rk, 1.726420306514116093e-17_rk,6.220084679281461248e-01_rk,-9.811252243246882943e-01_rk,3.591167563965418363e-01_rk,3.591167563965421694e-01_rk,-5.664529123725904336e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-7.044162180172897081e-02_rk,9.622504486493763110e-02_rk,9.622504486493767273e-02_rk,-4.066948930938216189e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.360827634879543113e-01_rk,-2.357022603955157281e-01_rk,1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716867480e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.646326658039285296e-02_rk,-6.315623032716867480e-02_rk,-3.646326658039285296e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548945844e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.078677873714246838e-01_rk,-8.796528112548945844e-01_rk,5.078677873714246838e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.360827634879543113e-01_rk,-2.357022603955157281e-01_rk,-1.360827634879543113e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, 3.098785029861972147e-19_rk,4.465819873852046318e-02_rk,-1.887477567531183065e-02_rk,-2.578342306320860478e-02_rk,2.578342306320861865e-02_rk,1.089735681703513093e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666665464e-01_rk,-2.628917115316042885e-01_rk,-9.622504486493761722e-02_rk,9.622504486493767273e-02_rk,1.517806004204930725e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, -4.625929269271485328e-18_rk,1.666666666666665464e-01_rk,-7.044162180172888754e-02_rk,9.622504486493761722e-02_rk,-9.622504486493767273e-02_rk,-4.066948930938212026e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,6.220084679281460138e-01_rk,-9.811252243246880722e-01_rk,3.591167563965420584e-01_rk,-3.591167563965421694e-01_rk,-5.664529123725906556e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.465819873852048399e-02_rk, -3.098785029861972147e-19_rk,4.465819873852044930e-02_rk,-7.044162180172906795e-02_rk,-2.578342306320859090e-02_rk,-2.578342306320861171e-02_rk,4.066948930938206475e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,1.666666666666666297e-01_rk,-7.044162180172897081e-02_rk,-9.622504486493763110e-02_rk,-9.622504486493767273e-02_rk,4.066948930938216189e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 4.625929269271485328e-18_rk,1.666666666666666297e-01_rk,-2.628917115316042885e-01_rk,9.622504486493763110e-02_rk,9.622504486493767273e-02_rk,-1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281465689e-01_rk, 0.000000000000000000e+00_rk,6.220084679281461248e-01_rk,-2.628917115316038444e-01_rk,3.591167563965418363e-01_rk,3.591167563965421694e-01_rk,-1.517806004204932391e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad1_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 6.315623032716867480e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.646326658039285296e-02_rk,-6.315623032716867480e-02_rk,3.646326658039285296e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.360827634879543113e-01_rk,-2.357022603955157281e-01_rk,-1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.360827634879543113e-01_rk,-2.357022603955157281e-01_rk,1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 8.796528112548945844e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.078677873714246838e-01_rk,-8.796528112548945844e-01_rk,-5.078677873714246838e-01_rk  &
                                        /),(/8,4/))
        
        
        
        
        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad1_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dgrad1_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad2
        !

        test_dgrad2_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.410683602522960545e+00_rk, -5.423902068220820135e-16_rk,1.410683602522956770e+00_rk,-5.962250448649344392e-01_rk,-8.144585576580216646e-01_rk,8.144585576580229969e-01_rk,3.442306901503685568e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.553418012614804944e-01_rk, -5.551115123125785660e-16_rk,9.553418012614769417e-01_rk,-1.506908647387894318e+00_rk,-5.515668461264179312e-01_rk,5.515668461264182643e-01_rk,8.700141132135780220e-01_rk, &
                                        0.000000000000000000e+00_rk, -3.779915320718560956e-01_rk, -5.399942104928193104e-16_rk,3.779915320718535421e-01_rk,-1.597580192787684261e-01_rk,2.182335127930830065e-01_rk,-2.182335127930846164e-01_rk,-9.223633543579784488e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.559830641437099708e-01_rk, -5.551115123125785660e-16_rk,2.559830641437073062e-01_rk,-4.037749551350634514e-01_rk,1.477918909913532308e-01_rk,-1.477918909913555900e-01_rk,-2.331195790392564249e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.410683602522961877e+00_rk, -9.788583849888467782e-18_rk,1.410683602522961433e+00_rk,-2.225142160180984874e+00_rk,-8.144585576580231079e-01_rk,-8.144585576580234410e-01_rk,1.284686425165676438e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.553418012614820487e-01_rk, 0.000000000000000000e+00_rk,9.553418012614817156e-01_rk,-4.037749551350628963e-01_rk,-5.515668461264185973e-01_rk,-5.515668461264188194e-01_rk,2.331195790392582845e-01_rk, &
                                        0.000000000000000000e+00_rk, 3.779915320718539862e-01_rk, 1.049137255048776645e-17_rk,3.779915320718538752e-01_rk,-5.962250448649379919e-01_rk,2.182335127930839502e-01_rk,2.182335127930840890e-01_rk,-3.442306901503684458e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.559830641437078058e-01_rk, 0.000000000000000000e+00_rk,2.559830641437077503e-01_rk,-1.081911731523527709e-01_rk,1.477918909913549517e-01_rk,1.477918909913549517e-01_rk,-6.246420294345242374e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.995007882905308394e+00_rk,-2.220446049250313081e-16_rk,4.440892098500626162e-16_rk,-1.151818338230806038e+00_rk,-1.995007882905308172e+00_rk,1.151818338230805594e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 1.351057332045929371e+00_rk,0.000000000000000000e+00_rk,5.551115123125782702e-17_rk,7.800333143473352493e-01_rk,-1.351057332045929371e+00_rk,-7.800333143473352493e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.345607511182004501e-01_rk,-2.220446049250313081e-16_rk,2.220446049250313081e-16_rk,-3.086287935563016838e-01_rk,-5.345607511182004501e-01_rk,3.086287935563017948e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 3.620147210498533830e-01_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,2.090092966487402393e-01_rk,-3.620147210498533830e-01_rk,-2.090092966487402393e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.220084679281452367e-01_rk, 5.478627399056851626e-16_rk,-6.220084679281456808e-01_rk,2.628917115316040665e-01_rk,3.591167563965436127e-01_rk,-3.591167563965420584e-01_rk,-1.517806004204957926e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666651864e-01_rk, 5.551115123125785660e-16_rk,-1.666666666666669627e-01_rk,2.628917115316031783e-01_rk,9.622504486493999032e-02_rk,-9.622504486493665965e-02_rk,-1.517806004204949044e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666686281e-01_rk, 5.341287672116030917e-16_rk,-1.666666666666667407e-01_rk,7.044162180172797161e-02_rk,-9.622504486493699272e-02_rk,9.622504486493822784e-02_rk,4.066948930938085738e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852239219e-02_rk, 5.551115123125785660e-16_rk,-4.465819873852017174e-02_rk,7.044162180172963694e-02_rk,-2.578342306320702271e-02_rk,2.578342306320902111e-02_rk,4.066948930938107942e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, 4.316050766285289462e-18_rk,-6.220084679281462359e-01_rk,9.811252243246884053e-01_rk,3.591167563965420584e-01_rk,3.591167563965421694e-01_rk,-5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666665741e-01_rk,7.044162180172891530e-02_rk,9.622504486493763110e-02_rk,9.622504486493767273e-02_rk,-4.066948930938214107e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, -4.625929269271485328e-18_rk,-1.666666666666665741e-01_rk,2.628917115316041775e-01_rk,-9.622504486493763110e-02_rk,-9.622504486493767273e-02_rk,1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852047012e-02_rk,1.887477567531184452e-02_rk,-2.578342306320861171e-02_rk,-2.578342306320861865e-02_rk,1.089735681703513787e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, -8.796528112548945844e-01_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,5.078677873714246838e-01_rk,8.796528112548945844e-01_rk,-5.078677873714246838e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,-2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,-1.360827634879543391e-01_rk,2.357022603955158391e-01_rk,1.360827634879544501e-01_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, -2.357022603955157281e-01_rk,-5.551115123125782702e-17_rk,5.551115123125782702e-17_rk,1.360827634879543391e-01_rk,2.357022603955157281e-01_rk,-1.360827634879542281e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.315623032716867480e-02_rk,-2.220446049250313081e-16_rk,2.220446049250313081e-16_rk,-3.646326658039289459e-02_rk,6.315623032716867480e-02_rk,3.646326658039278357e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, -4.316050766285289462e-18_rk,-6.220084679281461248e-01_rk,2.628917115316039554e-01_rk,3.591167563965418918e-01_rk,-3.591167563965421694e-01_rk,-1.517806004204932946e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667962e-01_rk,2.628917115316044550e-01_rk,9.622504486493772824e-02_rk,-9.622504486493767273e-02_rk,-1.517806004204932391e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 4.625929269271485328e-18_rk,-1.666666666666667684e-01_rk,7.044162180172910959e-02_rk,-9.622504486493774212e-02_rk,9.622504486493767273e-02_rk,4.066948930938227291e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852036603e-02_rk,7.044162180172899856e-02_rk,-2.578342306320854926e-02_rk,2.578342306320861865e-02_rk,4.066948930938202311e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -6.220084679281465689e-01_rk, 4.316050766285290232e-18_rk,-6.220084679281463469e-01_rk,9.811252243246885163e-01_rk,3.591167563965420584e-01_rk,3.591167563965421694e-01_rk,-5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666665741e-01_rk,7.044162180172888754e-02_rk,9.622504486493761722e-02_rk,9.622504486493767273e-02_rk,-4.066948930938213413e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, -4.625929269271485328e-18_rk,-1.666666666666665741e-01_rk,2.628917115316042330e-01_rk,-9.622504486493761722e-02_rk,-9.622504486493767273e-02_rk,1.517806004204931003e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852047012e-02_rk,1.887477567531185840e-02_rk,-2.578342306320861171e-02_rk,-2.578342306320861171e-02_rk,1.089735681703513787e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548945844e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.078677873714246838e-01_rk,8.796528112548945844e-01_rk,-5.078677873714246838e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.360827634879543113e-01_rk,2.357022603955157281e-01_rk,1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.360827634879543113e-01_rk,2.357022603955157281e-01_rk,-1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.315623032716867480e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.646326658039285296e-02_rk,6.315623032716867480e-02_rk,3.646326658039285296e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, -1.156482317317871332e-18_rk,-1.666666666666667684e-01_rk,7.044162180172910959e-02_rk,9.622504486493774212e-02_rk,-9.622504486493767273e-02_rk,-4.066948930938227291e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281464579e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281462359e-01_rk,9.811252243246885163e-01_rk,3.591167563965418363e-01_rk,-3.591167563965421694e-01_rk,-5.664529123725905446e-01_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852048399e-02_rk, 1.239514011944788666e-18_rk,-4.465819873852036603e-02_rk,1.887477567531174738e-02_rk,-2.578342306320854926e-02_rk,2.578342306320861865e-02_rk,1.089735681703507542e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667684e-01_rk,2.628917115316045106e-01_rk,-9.622504486493774212e-02_rk,9.622504486493767273e-02_rk,1.517806004204932113e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 1.156482317317871332e-18_rk,-1.666666666666665741e-01_rk,2.628917115316042330e-01_rk,9.622504486493761722e-02_rk,9.622504486493767273e-02_rk,-1.517806004204931003e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281465689e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,2.628917115316041775e-01_rk,3.591167563965420584e-01_rk,3.591167563965421694e-01_rk,-1.517806004204935166e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, -1.239514011944788859e-18_rk,-4.465819873852047012e-02_rk,7.044162180172908183e-02_rk,-2.578342306320861171e-02_rk,-2.578342306320861171e-02_rk,4.066948930938208556e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666665741e-01_rk,7.044162180172888754e-02_rk,-9.622504486493761722e-02_rk,-9.622504486493767273e-02_rk,4.066948930938213413e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.360827634879543113e-01_rk,2.357022603955157281e-01_rk,-1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548945844e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.078677873714246838e-01_rk,8.796528112548945844e-01_rk,5.078677873714246838e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.315623032716867480e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.646326658039285296e-02_rk,6.315623032716867480e-02_rk,-3.646326658039285296e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.360827634879543113e-01_rk,2.357022603955157281e-01_rk,1.360827634879543113e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -3.779915320718562066e-01_rk, 7.948740139194698825e-17_rk,3.779915320718534311e-01_rk,-1.597580192787682041e-01_rk,-2.182335127930827290e-01_rk,2.182335127930851715e-01_rk,9.223633543579745631e-02_rk, &
                                        0.000000000000000000e+00_rk, -2.559830641437100818e-01_rk, 8.326672684688677751e-17_rk,2.559830641437073062e-01_rk,-4.037749551350634514e-01_rk,-1.477918909913534806e-01_rk,1.477918909913560341e-01_rk,2.331195790392566747e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.410683602522960545e+00_rk, -4.047688110612552516e-15_rk,1.410683602522956770e+00_rk,-5.962250448649344392e-01_rk,8.144585576580243291e-01_rk,-8.144585576580185560e-01_rk,-3.442306901503712213e-01_rk, &
                                        0.000000000000000000e+00_rk, -9.553418012614804944e-01_rk, -3.996802888650565912e-15_rk,9.553418012614769417e-01_rk,-1.506908647387895206e+00_rk,5.515668461264152667e-01_rk,-5.515668461264140454e-01_rk,-8.700141132135751354e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 3.779915320718539862e-01_rk, -2.622843137621941612e-18_rk,3.779915320718538752e-01_rk,-5.962250448649379919e-01_rk,-2.182335127930839502e-01_rk,-2.182335127930840890e-01_rk,3.442306901503684458e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.559830641437078058e-01_rk, 0.000000000000000000e+00_rk,2.559830641437077503e-01_rk,-1.081911731523527709e-01_rk,-1.477918909913549517e-01_rk,-1.477918909913549517e-01_rk,6.246420294345242374e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.410683602522961655e+00_rk, 3.915433539955386496e-17_rk,1.410683602522961211e+00_rk,-2.225142160180984874e+00_rk,8.144585576580229969e-01_rk,8.144585576580232189e-01_rk,-1.284686425165676216e+00_rk, &
                                        0.000000000000000000e+00_rk, 9.553418012614820487e-01_rk, 0.000000000000000000e+00_rk,9.553418012614817156e-01_rk,-4.037749551350628963e-01_rk,5.515668461264185973e-01_rk,5.515668461264188194e-01_rk,-2.331195790392582845e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 5.345607511182004501e-01_rk,2.220446049250313081e-16_rk,-2.220446049250313081e-16_rk,-3.086287935563016838e-01_rk,-5.345607511182004501e-01_rk,3.086287935563017948e-01_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 3.620147210498533830e-01_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,2.090092966487402393e-01_rk,-3.620147210498533830e-01_rk,-2.090092966487402393e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.995007882905308172e+00_rk,2.220446049250313081e-16_rk,-4.440892098500626162e-16_rk,-1.151818338230805594e+00_rk,-1.995007882905308172e+00_rk,1.151818338230805594e+00_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, 1.351057332045929371e+00_rk,0.000000000000000000e+00_rk,-5.551115123125782702e-17_rk,7.800333143473350273e-01_rk,-1.351057332045929371e+00_rk,-7.800333143473350273e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666686281e-01_rk, -7.802104057164292125e-17_rk,-1.666666666666667407e-01_rk,7.044162180172797161e-02_rk,9.622504486493665965e-02_rk,-9.622504486493865805e-02_rk,-4.066948930938052431e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852239219e-02_rk, -8.326672684688677751e-17_rk,-4.465819873852028277e-02_rk,7.044162180172997001e-02_rk,2.578342306320735577e-02_rk,-2.578342306320957622e-02_rk,-4.066948930938152351e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281452367e-01_rk, 4.025797978278139526e-15_rk,-6.220084679281461248e-01_rk,2.628917115316040665e-01_rk,-3.591167563965458331e-01_rk,3.591167563965376730e-01_rk,1.517806004204980130e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666651864e-01_rk, 3.996802888650565912e-15_rk,-1.666666666666669627e-01_rk,2.628917115316031783e-01_rk,-9.622504486493710374e-02_rk,9.622504486493221876e-02_rk,1.517806004204920178e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 1.156482317317871332e-18_rk,-1.666666666666665741e-01_rk,2.628917115316041775e-01_rk,9.622504486493763110e-02_rk,9.622504486493767273e-02_rk,-1.517806004204931281e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852047012e-02_rk,1.887477567531184452e-02_rk,2.578342306320861171e-02_rk,2.578342306320861865e-02_rk,-1.089735681703513787e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281463469e-01_rk, -1.726420306514115785e-17_rk,-6.220084679281462359e-01_rk,9.811252243246884053e-01_rk,-3.591167563965420584e-01_rk,-3.591167563965421694e-01_rk,5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666665741e-01_rk,7.044162180172891530e-02_rk,-9.622504486493763110e-02_rk,-9.622504486493767273e-02_rk,4.066948930938214107e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, -2.357022603955157281e-01_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,1.360827634879543391e-01_rk,2.357022603955157281e-01_rk,-1.360827634879542281e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.315623032716867480e-02_rk,2.220446049250313081e-16_rk,-2.220446049250313081e-16_rk,-3.646326658039289459e-02_rk,6.315623032716867480e-02_rk,3.646326658039278357e-02_rk, &
                                        0.000000000000000000e+00_rk, 5.551115123125782702e-17_rk, -8.796528112548945844e-01_rk,5.551115123125782702e-17_rk,-5.551115123125782702e-17_rk,5.078677873714246838e-01_rk,8.796528112548945844e-01_rk,-5.078677873714246838e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,2.220446049250313081e-16_rk,0.000000000000000000e+00_rk,-1.360827634879543391e-01_rk,2.357022603955158391e-01_rk,1.360827634879544501e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, -1.156482317317871332e-18_rk,-1.666666666666667684e-01_rk,7.044162180172910959e-02_rk,9.622504486493774212e-02_rk,-9.622504486493767273e-02_rk,-4.066948930938227291e-02_rk, &
                                        0.000000000000000000e+00_rk, 4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852036603e-02_rk,7.044162180172898469e-02_rk,2.578342306320854926e-02_rk,-2.578342306320861865e-02_rk,-4.066948930938202311e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 1.726420306514115785e-17_rk,-6.220084679281461248e-01_rk,2.628917115316039554e-01_rk,-3.591167563965418918e-01_rk,3.591167563965421694e-01_rk,1.517806004204932946e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667684e-01_rk,2.628917115316045106e-01_rk,-9.622504486493774212e-02_rk,9.622504486493767273e-02_rk,1.517806004204932113e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 1.156482317317871332e-18_rk,-1.666666666666665741e-01_rk,2.628917115316042330e-01_rk,9.622504486493761722e-02_rk,9.622504486493767273e-02_rk,-1.517806004204931003e-01_rk, &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, 0.000000000000000000e+00_rk,-4.465819873852047012e-02_rk,1.887477567531185840e-02_rk,2.578342306320861171e-02_rk,2.578342306320861171e-02_rk,-1.089735681703513787e-02_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281465689e-01_rk, -1.726420306514116093e-17_rk,-6.220084679281463469e-01_rk,9.811252243246885163e-01_rk,-3.591167563965420584e-01_rk,-3.591167563965421694e-01_rk,5.664529123725906556e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666665741e-01_rk,7.044162180172888754e-02_rk,-9.622504486493761722e-02_rk,-9.622504486493767273e-02_rk,4.066948930938213413e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.360827634879543113e-01_rk,2.357022603955157281e-01_rk,-1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.315623032716867480e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-3.646326658039285296e-02_rk,6.315623032716867480e-02_rk,3.646326658039285296e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548945844e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,5.078677873714246838e-01_rk,8.796528112548945844e-01_rk,-5.078677873714246838e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.360827634879543113e-01_rk,2.357022603955157281e-01_rk,1.360827634879543113e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 4.465819873852048399e-02_rk, -3.098785029861971665e-19_rk,-4.465819873852036603e-02_rk,1.887477567531174738e-02_rk,2.578342306320854926e-02_rk,-2.578342306320861865e-02_rk,-1.089735681703507542e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666667962e-01_rk,2.628917115316044550e-01_rk,9.622504486493772824e-02_rk,-9.622504486493767273e-02_rk,-1.517806004204932391e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.666666666666666297e-01_rk, 4.625929269271485328e-18_rk,-1.666666666666667684e-01_rk,7.044162180172910959e-02_rk,-9.622504486493774212e-02_rk,9.622504486493767273e-02_rk,4.066948930938227291e-02_rk, &
                                        0.000000000000000000e+00_rk, 6.220084679281463469e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281461248e-01_rk,9.811252243246886273e-01_rk,-3.591167563965418918e-01_rk,3.591167563965421694e-01_rk,5.664529123725905446e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -4.465819873852048399e-02_rk, 3.098785029861972147e-19_rk,-4.465819873852047012e-02_rk,7.044162180172908183e-02_rk,2.578342306320861171e-02_rk,2.578342306320861171e-02_rk,-4.066948930938208556e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, 0.000000000000000000e+00_rk,-1.666666666666665741e-01_rk,7.044162180172888754e-02_rk,9.622504486493761722e-02_rk,9.622504486493767273e-02_rk,-4.066948930938213413e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.666666666666666297e-01_rk, -4.625929269271485328e-18_rk,-1.666666666666665741e-01_rk,2.628917115316042330e-01_rk,-9.622504486493761722e-02_rk,-9.622504486493767273e-02_rk,1.517806004204931003e-01_rk, &
                                        0.000000000000000000e+00_rk, -6.220084679281465689e-01_rk, 0.000000000000000000e+00_rk,-6.220084679281463469e-01_rk,2.628917115316041775e-01_rk,-3.591167563965420584e-01_rk,-3.591167563965421694e-01_rk,1.517806004204935166e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad2_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -6.315623032716867480e-02_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,3.646326658039285296e-02_rk,6.315623032716867480e-02_rk,-3.646326658039285296e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.360827634879543113e-01_rk,2.357022603955157281e-01_rk,1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.357022603955157281e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.360827634879543113e-01_rk,2.357022603955157281e-01_rk,-1.360827634879543113e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -8.796528112548945844e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-5.078677873714246838e-01_rk,8.796528112548945844e-01_rk,5.078677873714246838e-01_rk  &
                                        /),(/8,4/))
        
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad2_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dgrad2_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! grad3
        !

        test_dgrad3_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.115355071650409702e+00_rk, 0.000000000000000000e+00_rk,1.115355071650409480e+00_rk,-4.714045207910307900e-01_rk,-6.439505508593762473e-01_rk,6.439505508593788008e-01_rk,2.721655269759069018e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226860543e-01_rk, -2.220446049250313081e-15_rk,2.988584907226856657e-01_rk,-4.714045207910337876e-01_rk,-1.725460300683516746e-01_rk,1.725460300683505643e-01_rk,2.721655269759135631e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650408370e+00_rk, 2.220446049250313081e-16_rk,1.115355071650410590e+00_rk,-4.714045207910326774e-01_rk,6.439505508593772465e-01_rk,-6.439505508593781347e-01_rk,-2.721655269759082896e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226847220e-01_rk, -2.220446049250313081e-15_rk,2.988584907226868870e-01_rk,-4.714045207910342317e-01_rk,1.725460300683490655e-01_rk,-1.725460300683451242e-01_rk,-2.721655269759105655e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.115355071650409702e+00_rk, 0.000000000000000000e+00_rk,1.115355071650409480e+00_rk,-1.759305622509788058e+00_rk,-6.439505508593781347e-01_rk,-6.439505508593785787e-01_rk,1.015735574742847591e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226860543e-01_rk, 0.000000000000000000e+00_rk,2.988584907226859433e-01_rk,-1.263124606543378214e-01_rk,-1.725460300683478998e-01_rk,-1.725460300683481218e-01_rk,7.292653316078601122e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650408370e+00_rk, 0.000000000000000000e+00_rk,1.115355071650408147e+00_rk,-1.759305622509786060e+00_rk,6.439505508593776906e-01_rk,6.439505508593779126e-01_rk,-1.015735574742846703e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226847220e-01_rk, 0.000000000000000000e+00_rk,2.988584907226846665e-01_rk,-1.263124606543372941e-01_rk,1.725460300683473724e-01_rk,1.725460300683473724e-01_rk,-7.292653316078587244e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189624399e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.106836025229583242e-01_rk,-1.577350269189624399e+00_rk,9.106836025229583242e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103762673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.440169358562936652e-01_rk,-4.226497308103762673e-01_rk,-2.440169358562936652e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189622400e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.106836025229572140e-01_rk,-1.577350269189622400e+00_rk,9.106836025229572140e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103744910e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.440169358562926660e-01_rk,-4.226497308103744910e-01_rk,-2.440169358562926660e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.988584907226847220e-01_rk, 2.664535259100375697e-15_rk,2.988584907226868315e-01_rk,-1.263124606543394590e-01_rk,-1.725460300683527848e-01_rk,1.725460300683447912e-01_rk,7.292653316079089620e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650409702e+00_rk, 0.000000000000000000e+00_rk,1.115355071650409480e+00_rk,-1.759305622509788058e+00_rk,-6.439505508593761363e-01_rk,6.439505508593783567e-01_rk,1.015735574742845593e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226847220e-01_rk, 2.220446049250313081e-15_rk,2.988584907226868315e-01_rk,-1.263124606543394590e-01_rk,1.725460300683490100e-01_rk,-1.725460300683495651e-01_rk,-7.292653316078745451e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650409702e+00_rk, -2.220446049250313081e-16_rk,1.115355071650409480e+00_rk,-1.759305622509788058e+00_rk,6.439505508593768024e-01_rk,-6.439505508593783567e-01_rk,-1.015735574742846259e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.988584907226847220e-01_rk, -1.110223024625156540e-16_rk,2.988584907226846665e-01_rk,-4.714045207910320112e-01_rk,-1.725460300683474557e-01_rk,-1.725460300683472337e-01_rk,2.721655269759089002e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650409702e+00_rk, 2.775557561562891351e-17_rk,1.115355071650409480e+00_rk,-4.714045207910307900e-01_rk,-6.439505508593784677e-01_rk,-6.439505508593788008e-01_rk,2.721655269759089002e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226847220e-01_rk, 2.775557561562891351e-17_rk,2.988584907226846665e-01_rk,-4.714045207910320112e-01_rk,1.725460300683473169e-01_rk,1.725460300683473447e-01_rk,-2.721655269759087892e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650409702e+00_rk, 0.000000000000000000e+00_rk,1.115355071650409480e+00_rk,-4.714045207910307900e-01_rk,6.439505508593784677e-01_rk,6.439505508593786898e-01_rk,-2.721655269759089557e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103744910e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.440169358562926660e-01_rk,-4.226497308103744910e-01_rk,2.440169358562926660e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189624399e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.106836025229583242e-01_rk,-1.577350269189624399e+00_rk,-9.106836025229583242e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 4.226497308103744910e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.440169358562926660e-01_rk,-4.226497308103744910e-01_rk,2.440169358562926660e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.577350269189624399e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.106836025229583242e-01_rk,-1.577350269189624399e+00_rk,-9.106836025229583242e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.115355071650408370e+00_rk, -2.109423746787797427e-15_rk,-1.115355071650410590e+00_rk,4.714045207910326774e-01_rk,6.439505508593786898e-01_rk,-6.439505508593758032e-01_rk,-2.721655269759096774e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226847220e-01_rk, -2.220446049250313081e-15_rk,-2.988584907226868870e-01_rk,4.714045207910342317e-01_rk,1.725460300683490655e-01_rk,-1.725460300683451242e-01_rk,-2.721655269759105655e-01_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650409702e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650409480e+00_rk,4.714045207910307900e-01_rk,-6.439505508593762473e-01_rk,6.439505508593788008e-01_rk,2.721655269759069018e-01_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226860543e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226856657e-01_rk,4.714045207910337876e-01_rk,-1.725460300683501202e-01_rk,1.725460300683483439e-01_rk,2.721655269759120088e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -1.115355071650408370e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650408147e+00_rk,1.759305622509786060e+00_rk,6.439505508593776906e-01_rk,6.439505508593779126e-01_rk,-1.015735574742846703e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226847220e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226846665e-01_rk,1.263124606543372941e-01_rk,1.725460300683473724e-01_rk,1.725460300683473724e-01_rk,-7.292653316078587244e-02_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650409702e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650409480e+00_rk,1.759305622509788058e+00_rk,-6.439505508593783567e-01_rk,-6.439505508593788008e-01_rk,1.015735574742847813e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226860543e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226859433e-01_rk,1.263124606543378214e-01_rk,-1.725460300683478998e-01_rk,-1.725460300683481218e-01_rk,7.292653316078601122e-02_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189622400e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.106836025229572140e-01_rk,1.577350269189622400e+00_rk,-9.106836025229572140e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103744910e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.440169358562926660e-01_rk,4.226497308103744910e-01_rk,2.440169358562926660e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189624399e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,9.106836025229583242e-01_rk,1.577350269189624399e+00_rk,-9.106836025229583242e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103762673e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.440169358562936652e-01_rk,4.226497308103762673e-01_rk,2.440169358562936652e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 2.988584907226847220e-01_rk, 2.220446049250313081e-15_rk,-2.988584907226868315e-01_rk,1.263124606543394590e-01_rk,1.725460300683490100e-01_rk,-1.725460300683495651e-01_rk,-7.292653316078745451e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650409702e+00_rk, 2.220446049250313081e-15_rk,-1.115355071650409480e+00_rk,1.759305622509788058e+00_rk,6.439505508593780236e-01_rk,-6.439505508593805772e-01_rk,-1.015735574742847813e+00_rk, &
                                        0.000000000000000000e+00_rk, 2.988584907226847220e-01_rk, 0.000000000000000000e+00_rk,-2.988584907226868315e-01_rk,1.263124606543394590e-01_rk,-1.725460300683514525e-01_rk,1.725460300683474557e-01_rk,7.292653316078956394e-02_rk, &
                                        0.000000000000000000e+00_rk, 1.115355071650409702e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650409480e+00_rk,1.759305622509788058e+00_rk,-6.439505508593761363e-01_rk,6.439505508593788008e-01_rk,1.015735574742845593e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.988584907226847220e-01_rk, 2.775557561562891351e-17_rk,-2.988584907226846665e-01_rk,4.714045207910320112e-01_rk,1.725460300683473169e-01_rk,1.725460300683473447e-01_rk,-2.721655269759087892e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650409702e+00_rk, 0.000000000000000000e+00_rk,-1.115355071650409480e+00_rk,4.714045207910307900e-01_rk,6.439505508593784677e-01_rk,6.439505508593786898e-01_rk,-2.721655269759089557e-01_rk, &
                                        0.000000000000000000e+00_rk, -2.988584907226847220e-01_rk, -1.110223024625156540e-16_rk,-2.988584907226846665e-01_rk,4.714045207910320112e-01_rk,-1.725460300683474557e-01_rk,-1.725460300683472337e-01_rk,2.721655269759089002e-01_rk, &
                                        0.000000000000000000e+00_rk, -1.115355071650409702e+00_rk, 2.775557561562891351e-17_rk,-1.115355071650409480e+00_rk,4.714045207910307900e-01_rk,-6.439505508593784677e-01_rk,-6.439505508593788008e-01_rk,2.721655269759089002e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103744910e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.440169358562926660e-01_rk,4.226497308103744910e-01_rk,-2.440169358562926660e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189624399e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.106836025229583242e-01_rk,1.577350269189624399e+00_rk,9.106836025229583242e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -4.226497308103744910e-01_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.440169358562926660e-01_rk,4.226497308103744910e-01_rk,-2.440169358562926660e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.577350269189624399e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-9.106836025229583242e-01_rk,1.577350269189624399e+00_rk,9.106836025229583242e-01_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-1.110223024625156540e-16_rk,-1.110223024625156540e-16_rk,1.110223024625156540e-16_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,6.938893903907228378e-18_rk,0.000000000000000000e+00_rk,-6.938893903907228378e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,-2.775557561562891351e-17_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.110223024625156540e-16_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,1.110223024625156540e-16_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        test_dgrad3_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk,0.000000000000000000e+00_rk  &
                                        /),(/8,4/))
        
        
        

        
        do inode_diff = 1,self%elem%nterms_c 
            do idir =1,3
                @assertEqual(transpose(test_dgrad3_dx(:,:,inode_diff,idir)),self%faces(ETA_MIN)%dgrad3_dx(:,:,inode_diff,idir),tol)
            end do
        end do

    end subroutine testElement_face_dgrad_dx_etamin
    !*******************************************************************************************








    !>  Test that the derivatives of the scaled normal vectors have been computed correctly. These are really
    !!  unit vectors scaled by the inverse jacobian of the face metric terms. Essentially,
    !!  an area scaling.
    !!
    !!  @author Matteo Ugolotti
    !!
    !------------------------------------------------------------------------------------------
    @Test
    subroutine testelement_face_dnormals_dx(self)
        class(test_element_linearB_dx),    intent(inout)   :: self

        real(rk), dimension(3,self%faces(XI_MAX)%basis_s%nnodes_face(),self%elem%nterms_c,3) :: test_dnorm_dx
        integer(ik) :: inode_diff, idir, irow
        real(rk)    :: tol,mat(4,3)
        
        tol = 1.e-14_rk
        
        !
        ! xi_min
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -2.220446049250313081e-16_rk, -1.971687836487032164e-01_rk, -1.394193839563010739e-01_rk, &
                                        -2.367897544708341684e-16_rk, -1.971687836487032164e-01_rk, -3.735731134033594414e-02_rk, &
                                        -1.387778780781445676e-16_rk, -5.283121635129713750e-02_rk, -1.394193839563010739e-01_rk, &
                                        -1.454999315475546950e-16_rk, -5.283121635129717913e-02_rk, -3.735731134033593026e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        1.971687836487028833e-01_rk, -3.330669073875469621e-16_rk, -1.394193839563013237e-01_rk, &
                                        1.971687836487028278e-01_rk, -3.885780586188047891e-16_rk, -3.735731134033559026e-02_rk, &
                                        5.283121635129685301e-02_rk, 9.714451465470119729e-17_rk, -1.394193839563013237e-01_rk, &
                                        5.283121635129685301e-02_rk, 9.714451465470119729e-17_rk, -3.735731134033559719e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        1.394193839563011850e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572209e-02_rk, 3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563012127e-01_rk, 1.394193839563012127e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033573597e-02_rk, 3.735731134033573597e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -4.163336342344337027e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -1.110223024625156540e-16_rk, 1.971687836487029666e-01_rk, -3.735731134033588169e-02_rk, &
                                        -1.110223024625156540e-16_rk, 1.971687836487029388e-01_rk, -1.394193839563013793e-01_rk, &
                                        1.249000902703301108e-16_rk, 5.283121635129713056e-02_rk, -3.735731134033588169e-02_rk, &
                                        8.326672684688674053e-17_rk, 5.283121635129715832e-02_rk, -1.394193839563013793e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.971687836487031054e-01_rk, 6.938893903907228378e-17_rk, -3.735731134033554168e-02_rk, &
                                        -1.971687836487030498e-01_rk, 1.006139616066548115e-16_rk, -1.394193839563016568e-01_rk, &
                                        -5.283121635129687382e-02_rk, -1.249000902703301108e-16_rk, -3.735731134033554168e-02_rk, &
                                        -5.283121635129686688e-02_rk, -1.092875789865388469e-16_rk, -1.394193839563016568e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        3.735731134033572209e-02_rk, 3.735731134033572903e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011572e-01_rk, 1.394193839563011295e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572903e-02_rk, 3.735731134033572903e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563012127e-01_rk, 1.394193839563012127e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -1.040834085586084257e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.526556658859590243e-16_rk, -5.283121635129713750e-02_rk, 1.394193839563010739e-01_rk, &
                                        -1.457167719820517959e-16_rk, -5.283121635129715832e-02_rk, 3.735731134033593720e-02_rk, &
                                        -1.665334536937734811e-16_rk, -1.971687836487032164e-01_rk, 1.394193839563010739e-01_rk, &
                                        -2.081668171172168513e-16_rk, -1.971687836487032164e-01_rk, 3.735731134033593026e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.283121635129687382e-02_rk, 1.040834085586084257e-16_rk, 1.394193839563013515e-01_rk, &
                                        5.283121635129685301e-02_rk, 9.714451465470119729e-17_rk, 3.735731134033558332e-02_rk, &
                                        1.971687836487028833e-01_rk, -3.330669073875469621e-16_rk, 1.394193839563013237e-01_rk, &
                                        1.971687836487028278e-01_rk, -3.885780586188047891e-16_rk, 3.735731134033559719e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        -1.394193839563011850e-01_rk, -1.394193839563011850e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572209e-02_rk, -3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563012127e-01_rk, -1.394193839563012127e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033573597e-02_rk, -3.735731134033573597e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        -5.551115123125782702e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -1.040834085586084257e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        4.336808689942017736e-18_rk, 4.336808689942017736e-18_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, -4.163336342344337027e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        1.249000902703301108e-16_rk, 5.283121635129713056e-02_rk, 3.735731134033586781e-02_rk, &
                                        1.110223024625156540e-16_rk, 5.283121635129715832e-02_rk, 1.394193839563014070e-01_rk, &
                                        -8.326672684688674053e-17_rk, 1.971687836487030221e-01_rk, 3.735731134033588169e-02_rk, &
                                        -5.551115123125782702e-17_rk, 1.971687836487029943e-01_rk, 1.394193839563013793e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        -5.283121635129688770e-02_rk, -1.249000902703301108e-16_rk, 3.735731134033554168e-02_rk, &
                                        -5.283121635129686688e-02_rk, -1.084202172485504434e-16_rk, 1.394193839563016568e-01_rk, &
                                        -1.971687836487031054e-01_rk, 6.938893903907228378e-17_rk, 3.735731134033554168e-02_rk, &
                                        -1.971687836487031054e-01_rk, 9.714451465470119729e-17_rk, 1.394193839563016568e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -3.735731134033572209e-02_rk, -3.735731134033572903e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011572e-01_rk, -1.394193839563011295e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572903e-02_rk, -3.735731134033572903e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563012127e-01_rk, -1.394193839563012127e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -6.938893903907228378e-18_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        -5.551115123125782702e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -2.775557561562891351e-17_rk, -4.163336342344337027e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do
        
        !
        ! xi_max
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, 8.326672684688674053e-17_rk, 0.000000000000000000e+00_rk, &
                                        2.775557561562891351e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, -1.734723475976807480e-18_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -2.775557561562891351e-17_rk, -4.163336342344337027e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, 4.336808689942017736e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -5.551115123125782702e-16_rk, 1.971687836487024947e-01_rk, 1.394193839563005466e-01_rk, &
                                        -6.661338147750939243e-16_rk, 1.971687836487023004e-01_rk, 3.735731134033580536e-02_rk, &
                                        5.551115123125782702e-17_rk, 5.283121635129708893e-02_rk, 1.394193839563005743e-01_rk, &
                                        6.938893903907228378e-17_rk, 5.283121635129704730e-02_rk, 3.735731134033579148e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        -1.971687836487031054e-01_rk, 9.714451465470119729e-17_rk, 1.394193839563016568e-01_rk, &
                                        -1.971687836487030498e-01_rk, 9.714451465470119729e-17_rk, 3.735731134033553474e-02_rk, &
                                        -5.283121635129685301e-02_rk, -1.084202172485504434e-16_rk, 1.394193839563016568e-01_rk, &
                                        -5.283121635129688770e-02_rk, -1.283695372222837250e-16_rk, 3.735731134033553474e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -1.394193839563011850e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572209e-02_rk, -3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011295e-01_rk, -1.394193839563011295e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572903e-02_rk, -3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.734723475976807480e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, 8.673617379884037398e-19_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, 4.336808689942017736e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        3.885780586188047891e-16_rk, -1.971687836487026335e-01_rk, 3.735731134033586087e-02_rk, &
                                        4.440892098500626162e-16_rk, -1.971687836487026058e-01_rk, 1.394193839563002413e-01_rk, &
                                        -7.979727989493312634e-17_rk, -5.283121635129708893e-02_rk, 3.735731134033586087e-02_rk, &
                                        -1.110223024625156540e-16_rk, -5.283121635129707505e-02_rk, 1.394193839563002413e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.971687836487028278e-01_rk, -3.885780586188047891e-16_rk, 3.735731134033559026e-02_rk, &
                                        1.971687836487028000e-01_rk, -4.163336342344337027e-16_rk, 1.394193839563013237e-01_rk, &
                                        5.283121635129683913e-02_rk, 9.714451465470119729e-17_rk, 3.735731134033559026e-02_rk, &
                                        5.283121635129685995e-02_rk, 1.110223024625156540e-16_rk, 1.394193839563013237e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -3.735731134033573597e-02_rk, -3.735731134033573597e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011850e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572209e-02_rk, -3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011295e-01_rk, -1.394193839563011295e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.734723475976807480e-18_rk, &
                                        -3.469446951953614189e-18_rk, 3.469446951953614189e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, 6.071532165918824830e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, 5.283121635129707505e-02_rk, -1.394193839563005466e-01_rk, &
                                        6.245004513516505540e-17_rk, 5.283121635129702648e-02_rk, -3.735731134033581230e-02_rk, &
                                        -5.551115123125782702e-16_rk, 1.971687836487022727e-01_rk, -1.394193839563006021e-01_rk, &
                                        -6.661338147750939243e-16_rk, 1.971687836487023004e-01_rk, -3.735731134033580536e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -5.283121635129686688e-02_rk, -1.092875789865388469e-16_rk, -1.394193839563016568e-01_rk, &
                                        -5.283121635129688076e-02_rk, -1.214306433183764966e-16_rk, -3.735731134033553474e-02_rk, &
                                        -1.971687836487030498e-01_rk, 1.006139616066548115e-16_rk, -1.394193839563016568e-01_rk, &
                                        -1.971687836487030498e-01_rk, 8.326672684688674053e-17_rk, -3.735731134033553474e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        1.394193839563011850e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572209e-02_rk, 3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011295e-01_rk, 1.394193839563011295e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572903e-02_rk, 3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 1.040834085586084257e-17_rk, 8.673617379884037398e-19_rk, &
                                        2.775557561562891351e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, -1.734723475976807480e-18_rk, &
                                        0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, -2.775557561562891351e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -8.651933336434325383e-17_rk, -5.283121635129713056e-02_rk, -3.735731134033585393e-02_rk, &
                                        -1.110223024625156540e-16_rk, -5.283121635129707505e-02_rk, -1.394193839563002690e-01_rk, &
                                        3.668940151690947005e-16_rk, -1.971687836487026058e-01_rk, -3.735731134033586087e-02_rk, &
                                        4.440892098500626162e-16_rk, -1.971687836487025502e-01_rk, -1.394193839563002413e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        5.283121635129685301e-02_rk, 9.714451465470119729e-17_rk, -3.735731134033559026e-02_rk, &
                                        5.283121635129683913e-02_rk, 9.020562075079396891e-17_rk, -1.394193839563013237e-01_rk, &
                                        1.971687836487028278e-01_rk, -3.885780586188047891e-16_rk, -3.735731134033559026e-02_rk, &
                                        1.971687836487028833e-01_rk, -3.330669073875469621e-16_rk, -1.394193839563013237e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        3.735731134033573597e-02_rk, 3.735731134033573597e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011850e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572209e-02_rk, 3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011295e-01_rk, 1.394193839563011295e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        


        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(xi_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! eta_min
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -1.665334536937734811e-16_rk, 1.971687836487031886e-01_rk, 1.394193839563011572e-01_rk, &
                                        -1.665334536937734811e-16_rk, 1.971687836487031609e-01_rk, 3.735731134033574291e-02_rk, &
                                        -1.387778780781445676e-16_rk, 5.283121635129714444e-02_rk, 1.394193839563009907e-01_rk, &
                                        -1.665334536937734811e-16_rk, 5.283121635129718607e-02_rk, 3.735731134033557638e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -1.971687836487027168e-01_rk, -3.608224830031758756e-16_rk, -1.394193839563011572e-01_rk, &
                                        -1.971687836487026613e-01_rk, -3.608224830031758756e-16_rk, -3.735731134033574291e-02_rk, &
                                        -5.283121635129710975e-02_rk, 1.040834085586084257e-16_rk, -1.394193839563009907e-01_rk, &
                                        -5.283121635129708893e-02_rk, 9.020562075079396891e-17_rk, -3.735731134033557638e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        -1.394193839563011572e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572209e-02_rk, 3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011572e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572209e-02_rk, 3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -5.551115123125782702e-17_rk, -1.971687836487028833e-01_rk, 3.735731134033557638e-02_rk, &
                                        -1.110223024625156540e-16_rk, -1.971687836487028833e-01_rk, 1.394193839563011572e-01_rk, &
                                        1.110223024625156540e-16_rk, -5.283121635129713056e-02_rk, 3.735731134033557638e-02_rk, &
                                        1.249000902703301108e-16_rk, -5.283121635129711668e-02_rk, 1.394193839563011572e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        1.971687836487029388e-01_rk, 1.110223024625156540e-16_rk, -3.735731134033557638e-02_rk, &
                                        1.971687836487029666e-01_rk, 1.006139616066548115e-16_rk, -1.394193839563011572e-01_rk, &
                                        5.283121635129713750e-02_rk, -1.249000902703301108e-16_rk, -3.735731134033557638e-02_rk, &
                                        5.283121635129711668e-02_rk, -1.092875789865388469e-16_rk, -1.394193839563011572e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        -3.735731134033572209e-02_rk, 3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011572e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572209e-02_rk, 3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011572e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, -5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        -1.040834085586084257e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, -5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.457167719820517959e-16_rk, 5.283121635129715138e-02_rk, -1.394193839563009907e-01_rk, &
                                        -1.665334536937734811e-16_rk, 5.283121635129718607e-02_rk, -3.735731134033557638e-02_rk, &
                                        -1.665334536937734811e-16_rk, 1.971687836487031886e-01_rk, -1.394193839563011572e-01_rk, &
                                        -1.665334536937734811e-16_rk, 1.971687836487031609e-01_rk, -3.735731134033574291e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        -5.283121635129710975e-02_rk, 1.040834085586084257e-16_rk, 1.394193839563009907e-01_rk, &
                                        -5.283121635129708893e-02_rk, 9.020562075079396891e-17_rk, 3.735731134033557638e-02_rk, &
                                        -1.971687836487026613e-01_rk, -3.330669073875469621e-16_rk, 1.394193839563011572e-01_rk, &
                                        -1.971687836487026613e-01_rk, -3.608224830031758756e-16_rk, 3.735731134033574291e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        1.394193839563011572e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572209e-02_rk, -3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011572e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572209e-02_rk, -3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        1.110223024625156540e-16_rk, -5.283121635129713056e-02_rk, -3.735731134033557638e-02_rk, &
                                        1.387778780781445676e-16_rk, -5.283121635129714444e-02_rk, -1.394193839563011572e-01_rk, &
                                        -5.551115123125782702e-17_rk, -1.971687836487029943e-01_rk, -3.735731134033557638e-02_rk, &
                                        -5.551115123125782702e-17_rk, -1.971687836487029388e-01_rk, -1.394193839563011572e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        5.283121635129713750e-02_rk, -1.249000902703301108e-16_rk, 3.735731134033557638e-02_rk, &
                                        5.283121635129711668e-02_rk, -1.092875789865388469e-16_rk, 1.394193839563011572e-01_rk, &
                                        1.971687836487029388e-01_rk, 1.110223024625156540e-16_rk, 3.735731134033557638e-02_rk, &
                                        1.971687836487029666e-01_rk, 1.006139616066548115e-16_rk, 1.394193839563011572e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        3.735731134033572209e-02_rk, -3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011572e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572209e-02_rk, -3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011572e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        -1.040834085586084257e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, -5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        5.204170427930421283e-18_rk, -5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.040834085586084257e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! eta_max
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        4.163336342344337027e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, -5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, -5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -6.661338147750939243e-16_rk, -1.971687836487023282e-01_rk, -1.394193839563011572e-01_rk, &
                                        -6.106226635438360972e-16_rk, -1.971687836487023282e-01_rk, -3.735731134033586781e-02_rk, &
                                        6.938893903907228378e-17_rk, -5.283121635129707505e-02_rk, -1.394193839563008797e-01_rk, &
                                        5.551115123125782702e-17_rk, -5.283121635129707505e-02_rk, -3.735731134033556944e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        1.971687836487029666e-01_rk, 1.006139616066548115e-16_rk, 1.394193839563011572e-01_rk, &
                                        1.971687836487029388e-01_rk, 1.110223024625156540e-16_rk, 3.735731134033556944e-02_rk, &
                                        5.283121635129711668e-02_rk, -1.092875789865388469e-16_rk, 1.394193839563011572e-01_rk, &
                                        5.283121635129710281e-02_rk, -1.179611963664228824e-16_rk, 3.735731134033556944e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        1.394193839563011850e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033571516e-02_rk, -3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011850e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033571516e-02_rk, -3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        4.440892098500626162e-16_rk, 1.971687836487026058e-01_rk, -3.735731134033542372e-02_rk, &
                                        3.885780586188047891e-16_rk, 1.971687836487025225e-01_rk, -1.394193839563011572e-01_rk, &
                                        -9.714451465470119729e-17_rk, 5.283121635129710281e-02_rk, -3.735731134033557638e-02_rk, &
                                        -8.326672684688674053e-17_rk, 5.283121635129706117e-02_rk, -1.394193839563013237e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -1.971687836487026613e-01_rk, -3.747002708109903324e-16_rk, 3.735731134033574291e-02_rk, &
                                        -1.971687836487026613e-01_rk, -3.608224830031758756e-16_rk, 1.394193839563011572e-01_rk, &
                                        -5.283121635129709587e-02_rk, 9.020562075079396891e-17_rk, 3.735731134033557638e-02_rk, &
                                        -5.283121635129708199e-02_rk, 9.020562075079396891e-17_rk, 1.394193839563009907e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        3.735731134033572903e-02_rk, -3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563012127e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        3.735731134033572903e-02_rk, -3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.394193839563011850e-01_rk, -1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -1.387778780781445676e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        5.204170427930421283e-18_rk, -5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        4.163336342344337027e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        1.387778780781445676e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, 1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        5.204170427930421283e-18_rk, -5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        -6.938893903907228378e-18_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        -1.387778780781445676e-17_rk, 1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -5.204170427930421283e-18_rk, 5.204170427930421283e-18_rk, 0.000000000000000000e+00_rk, &
                                        1.040834085586084257e-17_rk, -6.938893903907228378e-18_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, -1.040834085586084257e-17_rk, 0.000000000000000000e+00_rk, &
                                        1.387778780781445676e-17_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        5.551115123125782702e-17_rk, -5.283121635129704730e-02_rk, 1.394193839563008797e-01_rk, &
                                        5.551115123125782702e-17_rk, -5.283121635129707505e-02_rk, 3.735731134033556944e-02_rk, &
                                        -6.661338147750939243e-16_rk, -1.971687836487023282e-01_rk, 1.394193839563011572e-01_rk, &
                                        -6.661338147750939243e-16_rk, -1.971687836487023282e-01_rk, 3.735731134033586781e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        5.283121635129710975e-02_rk, -1.084202172485504434e-16_rk, -1.394193839563011572e-01_rk, &
                                        5.283121635129710281e-02_rk, -1.179611963664228824e-16_rk, -3.735731134033556944e-02_rk, &
                                        1.971687836487029666e-01_rk, 9.714451465470119729e-17_rk, -1.394193839563011572e-01_rk, &
                                        1.971687836487029388e-01_rk, 1.110223024625156540e-16_rk, -3.735731134033556944e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        -1.394193839563011850e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033571516e-02_rk, 3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011850e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033571516e-02_rk, 3.735731134033571516e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        -9.714451465470119729e-17_rk, 5.283121635129710281e-02_rk, 3.735731134033557638e-02_rk, &
                                        -9.020562075079396891e-17_rk, 5.283121635129707505e-02_rk, 1.394193839563013237e-01_rk, &
                                        4.440892098500626162e-16_rk, 1.971687836487026058e-01_rk, 3.735731134033543760e-02_rk, &
                                        3.885780586188047891e-16_rk, 1.971687836487025225e-01_rk, 1.394193839563011572e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -5.283121635129709587e-02_rk, 9.020562075079396891e-17_rk, -3.735731134033557638e-02_rk, &
                                        -5.283121635129709587e-02_rk, 9.714451465470119729e-17_rk, -1.394193839563009907e-01_rk, &
                                        -1.971687836487026335e-01_rk, -3.608224830031758756e-16_rk, -3.735731134033574291e-02_rk, &
                                        -1.971687836487026613e-01_rk, -3.608224830031758756e-16_rk, -1.394193839563011572e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -3.735731134033572903e-02_rk, 3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563011850e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk, &
                                        -3.735731134033572903e-02_rk, 3.735731134033572209e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.394193839563012127e-01_rk, 1.394193839563011572e-01_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(eta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do

        !
        ! zeta_min
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.220446049250313081e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.020620726159651159e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.020620726159651021e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.191891195797325054e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.788387679126023699e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.471462268067145807e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, -2.788387679126023144e-01_rk, -4.718447854656915297e-16_rk, &
                                        -1.020620726159655739e-01_rk, -1.767766952966367267e-01_rk, -4.857225732735059864e-16_rk, &
                                        1.020620726159652963e-01_rk, -1.767766952966367267e-01_rk, 2.081668171172168513e-17_rk, &
                                        -2.845792581364342598e-16_rk, -7.471462268067115275e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.767766952966366434e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.788387679126019814e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.471462268067180501e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.767766952966371430e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.020620726159654212e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.020620726159654906e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        1.767766952966368932e-01_rk, 1.020620726159654212e-01_rk, -4.163336342344337027e-17_rk, &
                                        2.788387679126023699e-01_rk, 0.000000000000000000e+00_rk, -8.326672684688674053e-17_rk, &
                                        7.471462268067144419e-02_rk, 0.000000000000000000e+00_rk, -8.153200337090993344e-17_rk, &
                                        1.767766952966368377e-01_rk, -1.020620726159654351e-01_rk, -3.469446951953614189e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.767766952966371985e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 7.471462268067180501e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.788387679126019814e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.767766952966364769e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.020620726159654212e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.020620726159654906e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        -1.767766952966368932e-01_rk, 1.020620726159654212e-01_rk, -4.857225732735059864e-17_rk, &
                                        -7.471462268067144419e-02_rk, 0.000000000000000000e+00_rk, -7.806255641895631925e-17_rk, &
                                        -2.788387679126023699e-01_rk, 0.000000000000000000e+00_rk, -8.326672684688674053e-17_rk, &
                                        -1.767766952966368654e-01_rk, -1.020620726159654351e-01_rk, -4.163336342344337027e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -3.608224830031758756e-16_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.020620726159650882e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.020620726159650604e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 3.330669073875469621e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.471462268067143031e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.788387679126023144e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        2.747661802696606357e-16_rk, 7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, &
                                        -1.020620726159653380e-01_rk, 1.767766952966367267e-01_rk, 2.775557561562891351e-17_rk, &
                                        1.020620726159656155e-01_rk, 1.767766952966367267e-01_rk, -4.857225732735059864e-16_rk, &
                                        0.000000000000000000e+00_rk, 2.788387679126022589e-01_rk, -4.718447854656915297e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.040834085586084257e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.081668171172168513e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.040834085586084257e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,4/))
        
        
        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_min)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do


        !
        ! zeta_max
        !

        test_dnorm_dx(:,:,1,1) = reshape((/                                                                                 &
                                        -2.138211768073756517e-50_rk, 2.138211768073756517e-50_rk, 1.155557966632341512e-33_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.672764710092195646e-51_rk, 5.345529420184391292e-51_rk, 3.851859888774471706e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,2) = reshape((/                                                                                 &
                                        2.138211768073756517e-50_rk, -1.069105884036878258e-50_rk, -7.703719777548943412e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.345529420184391292e-51_rk, -8.018294130276586938e-51_rk, -4.814824860968089633e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,1,3) = reshape((/                                                                                 &
                                        7.703719777548943412e-34_rk, -7.703719777548943412e-34_rk, -5.551115123125782702e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, &
                                        4.814824860968089633e-34_rk, -4.814824860968089633e-34_rk, -1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.040834085586084257e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,1) = reshape((/                                                                                 &
                                        -1.069105884036878258e-50_rk, 1.069105884036878258e-50_rk, 5.777789833161707559e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        4.677338242661342381e-51_rk, -4.677338242661342381e-51_rk, -2.407412430484044816e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,2) = reshape((/                                                                                 &
                                        8.018294130276586938e-51_rk, -8.018294130276586938e-51_rk, -4.814824860968089633e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -4.009147065138293469e-51_rk, 4.009147065138293469e-51_rk, 1.925929944387235853e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,2,3) = reshape((/                                                                                 &
                                        3.851859888774471706e-34_rk, -4.814824860968089633e-34_rk, -2.081668171172168513e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.775557561562891351e-17_rk, &
                                        -1.925929944387235853e-34_rk, 1.925929944387235853e-34_rk, 1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,1) = reshape((/                                                                                 &
                                        -1.069105884036878258e-50_rk, 1.069105884036878258e-50_rk, 5.777789833161707559e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        2.138211768073756517e-50_rk, -2.138211768073756517e-50_rk, -3.851859888774471706e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,2) = reshape((/                                                                                 &
                                        8.018294130276586938e-51_rk, -8.018294130276586938e-51_rk, -4.814824860968089633e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.069105884036878258e-50_rk, 1.069105884036878258e-50_rk, -3.851859888774471706e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,3,3) = reshape((/                                                                                 &
                                        3.851859888774471706e-34_rk, -4.814824860968089633e-34_rk, -2.081668171172168513e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.387778780781445676e-17_rk, &
                                        3.851859888774471706e-34_rk, -3.851859888774471706e-34_rk, 2.775557561562891351e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.775557561562891351e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,1) = reshape((/                                                                                 &
                                        3.340955887615244558e-51_rk, -4.009147065138293469e-51_rk, -1.925929944387235853e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -2.672764710092195646e-51_rk, 5.345529420184391292e-51_rk, 3.851859888774471706e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,2) = reshape((/                                                                                 &
                                        -4.009147065138293469e-51_rk, 4.009147065138293469e-51_rk, 1.925929944387235853e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.345529420184391292e-51_rk, -8.018294130276586938e-51_rk, -4.814824860968089633e-34_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,4,3) = reshape((/                                                                                 &
                                        -1.925929944387235853e-34_rk, 1.925929944387235853e-34_rk, 1.040834085586084257e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.387778780781445676e-17_rk, &
                                        4.814824860968089633e-34_rk, -4.814824860968089633e-34_rk, -1.387778780781445676e-17_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -5.551115123125782702e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,1) = reshape((/                                                                                 &
                                        -5.472533083603176779e-18_rk, 2.157041537713704155e-32_rk, 1.054711873393898713e-15_rk, &
                                        2.220446049250313574e-16_rk, -2.220446049250313081e-16_rk, -1.020620726159643388e-01_rk, &
                                        -2.235109657453353874e-16_rk, 2.220446049250313081e-16_rk, 1.020620726159651853e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -2.498001805406602216e-16_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,2) = reshape((/                                                                                 &
                                        5.472533083603152898e-18_rk, 0.000000000000000000e+00_rk, -2.788387679126023699e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.767766952966368654e-01_rk, &
                                        1.466360820304077406e-18_rk, -2.696301922142130194e-33_rk, -1.767766952966368654e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.471462268067145807e-02_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,5,3) = reshape((/                                                                                 &
                                        9.244463733058732095e-33_rk, 2.788387679126023144e-01_rk, -4.718447854656915297e-16_rk, &
                                        1.020620726159655739e-01_rk, 1.767766952966367267e-01_rk, -4.926614671774132148e-16_rk, &
                                        -1.020620726159652963e-01_rk, 1.767766952966367267e-01_rk, 2.775557561562891351e-17_rk, &
                                        2.845792581364342598e-16_rk, 7.471462268067115275e-02_rk, 0.000000000000000000e+00_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,1) = reshape((/                                                                                 &
                                        -2.026942840336137023e-16_rk, 2.081668171172168020e-16_rk, 1.767766952966358662e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.788387679126010932e-01_rk, &
                                        1.466360820304063539e-18_rk, 1.117039367744596795e-32_rk, 7.471462268067172174e-02_rk, &
                                        2.220446049250313081e-16_rk, -2.220446049250313081e-16_rk, 1.767766952966370320e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,2) = reshape((/                                                                                 &
                                        -5.472533083603153668e-18_rk, 3.851859888774471706e-34_rk, 1.020620726159654212e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        -1.466360820304074710e-18_rk, -4.300428110645668158e-36_rk, -2.191171908054771649e-19_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.020620726159654906e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,6,3) = reshape((/                                                                                 &
                                        -1.767766952966368932e-01_rk, -1.020620726159654212e-01_rk, -4.857225732735059864e-17_rk, &
                                        -2.788387679126023699e-01_rk, 0.000000000000000000e+00_rk, -8.326672684688674053e-17_rk, &
                                        -7.471462268067144419e-02_rk, -1.540743955509788682e-33_rk, -7.806255641895631925e-17_rk, &
                                        -1.767766952966368377e-01_rk, 1.020620726159654351e-01_rk, -4.163336342344337027e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,1) = reshape((/                                                                                 &
                                        2.067004562969128213e-16_rk, -2.081668171172168513e-16_rk, -1.767766952966371430e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -7.471462268067172174e-02_rk, &
                                        -5.472533083603175238e-18_rk, 2.157041537713704155e-32_rk, -2.788387679126010932e-01_rk, &
                                        -2.220446049250313081e-16_rk, 2.220446049250313081e-16_rk, -1.767766952966356997e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,2) = reshape((/                                                                                 &
                                        1.466360820304074132e-18_rk, 3.851859888774471706e-34_rk, 1.020620726159654212e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, &
                                        5.472533083603154438e-18_rk, -5.989723670226224417e-35_rk, -3.051908764785723057e-18_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.020620726159654906e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,7,3) = reshape((/                                                                                 &
                                        1.767766952966368932e-01_rk, -1.020620726159654212e-01_rk, -4.857225732735059864e-17_rk, &
                                        7.471462268067144419e-02_rk, 0.000000000000000000e+00_rk, -8.153200337090993344e-17_rk, &
                                        2.788387679126023699e-01_rk, -1.540743955509788682e-33_rk, -8.326672684688674053e-17_rk, &
                                        1.767766952966368654e-01_rk, 1.020620726159654351e-01_rk, -4.163336342344337027e-17_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,1) = reshape((/                                                                                 &
                                        1.466360820304069510e-18_rk, 5.392603844284260389e-33_rk, 2.636779683484746784e-16_rk, &
                                        -2.081668171172168760e-16_rk, 2.081668171172168267e-16_rk, -1.020620726159651714e-01_rk, &
                                        2.275171380086345064e-16_rk, -2.220446049250313574e-16_rk, 1.020620726159642833e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, -1.165734175856414367e-15_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,2) = reshape((/                                                                                 &
                                        -1.466360820304080102e-18_rk, 5.585196838722983974e-33_rk, 7.471462268067143031e-02_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 1.767766952966368654e-01_rk, &
                                        -5.472533083603158290e-18_rk, 2.696301922142130194e-33_rk, 1.767766952966368654e-01_rk, &
                                        0.000000000000000000e+00_rk, 0.000000000000000000e+00_rk, 2.788387679126023144e-01_rk  &
                                        /),(/3,4/))
        
        test_dnorm_dx(:,:,8,3) = reshape((/                                                                                 &
                                        -2.747661802696606357e-16_rk, -7.471462268067113888e-02_rk, 0.000000000000000000e+00_rk, &
                                        1.020620726159653380e-01_rk, -1.767766952966367267e-01_rk, 2.775557561562891351e-17_rk, &
                                        -1.020620726159656155e-01_rk, -1.767766952966367267e-01_rk, -4.787836793695987581e-16_rk, &
                                        0.000000000000000000e+00_rk, -2.788387679126022589e-01_rk, -4.440892098500626162e-16_rk  &
                                        /),(/3,4/))
        
        

        do inode_diff = 1,self%elem%nterms_c
            do idir = 1,3
                @assertequal(transpose(test_dnorm_dx(:,:,inode_diff,idir)),self%faces(zeta_max)%dnorm_dx(:,:,inode_diff,idir),tol)
            end do
        end do



    end subroutine testelement_face_dnormals_dx
    !*******************************************************************************************





!    !>  Test dmetric_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The dmetric_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_dmetric_dx_point(self)
!        class(test_element_linearB_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_dmetric_dx(:,:,:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [-1._rk/sqrt(3._rk),1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_dmetric_dx = self%elem%dmetric_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_dmetric_dx,self%elem%dmetric_dx(:,:,3,:,:),tol)
!
!
!    end subroutine testelement_dmetric_dx_point
!    !*******************************************************************************************







!    !>  Test djinv_dx_point 
!    !!  Here we test the routine taking as probing point the interpolation nodes.
!    !!  The djinv_dx at interpolation nodes has already been tested above, so they are right.
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_djinv_dx_point(self)
!        class(test_element_linearB_dx),    intent(inout)   :: self
!
!        integer(ik) :: inode_diff, idir, irow
!        real(rk)    :: tol, point_coords(3)
!        real(rk), allocatable   :: point_djinv_dx(:,:)
!        
!        tol = 1.e-14_rk
!       
!        ! Local coordinates of the point
!        point_coords = [1._rk/sqrt(3._rk),1._rk/sqrt(3._rk),-1._rk/sqrt(3._rk)]
!
!        ! Being TESTED
!        point_djinv_dx = self%elem%djinv_dx_point(point_coords, coordinate_frame='Undeformed', coordinate_scaling=.true.)
!
!
!        ! Test
!        @assertequal(point_djinv_dx,self%elem%djinv_dx(4,:,:),tol)
!
!
!    end subroutine testelement_djinv_dx_point
!    !*******************************************************************************************








!    !>  Test h_index
!    !!
!    !!  Fortran search the minimum x, y and z coordinate among all the support nodes.
!    !!  If multiple minimum are found, fortran returns the location of the first minimum starting 
!    !!  from the first minimum found (ie. first location in connectivity vector).
!    !!
!    !!  In this case, for instance for x direction, there exists 4 minima. However, the one stored
!    !!  for dX differentiation (needed for artificial viscosity) will be node 1, since it comes first
!    !!
!    !!
!    !!  @author Matteo Ugolotti
!    !!
!    !------------------------------------------------------------------------------------------
!    @Test
!    subroutine testelement_h_index(self)
!        class(test_element_linearB_dx),    intent(inout)   :: self
!
!        integer(ik) :: x_min, x_max, y_min, y_max, z_min, z_max
!        
!        x_min = 3
!        x_max = 2
!        y_min = 1
!        y_max = 4
!        z_min = 1
!        z_max = 5
!
!
!        ! Test
!        @assertequal(x_min,self%elem%h_index(1,1))
!        @assertequal(x_max,self%elem%h_index(1,2))
!        @assertequal(y_min,self%elem%h_index(2,1))
!        @assertequal(y_max,self%elem%h_index(2,2))
!        @assertequal(z_min,self%elem%h_index(3,1))
!        @assertequal(z_max,self%elem%h_index(3,2))
!
!
!    end subroutine testelement_h_index
!    !*******************************************************************************************







!####################################################
!
!   PYTHON SCRIPT FOR TESTING ELEMENT DX INITIALIZATION
!
!       This requires PyTORCH. For installation refer to
!       https://pytorch.org/get-started/locally/
!
!####################################################


!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!
!
!
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data  = [[ 1.0,   0.0,       0.0],
!                [ 2.0,   0.0,       0.0],
!                [ 1.0,   np.pi/2.0, 0.0],
!                [ 2.0,   np.pi/2.0, 0.0],
!                [ 1.0,   0.0,       1.0],
!                [ 2.0,   0.0,       1.0],
!                [ 1.0,   np.pi/2.0, 1.0],
!                [ 2.0,   np.pi/2.0, 1.0],
!                ]
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_elem  = 8 
!nnodes_face  = 4 
!nterms_s   = 8
!ndirs      = 3
!coord_sys  = 'CYLINDRICAL'
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              ] 
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              ]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                ]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_elem-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_elem):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_elem-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_elem, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_elem))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_elem*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_elem*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_elem))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            for irow in range(0,3):
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_elem*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    i += 1
!            np.savetxt(f,array)
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("xcoord interpolation, coord 1,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("ycoord interpolation, coord 2,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("zcoord interpolation, coord 3,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    array = np.zeros([nnodes_r,ndirs])
!    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_elem*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file           ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dinvmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file        ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_vol_dx
!#
!# 
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face1_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face2_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face3_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_face_dx
!#
!# 
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()












!####################################################
!
!   PYTHON SCRIPT FOR TESTING FACE DX INITIALIZATION
!
!       This requires PyTORCH. For installation refer to
!       https://pytorch.org/get-started/locally/
!
!####################################################




!from __future__ import division
!
!import torch
!import torch.autograd as autograd
!import torch.nn as nn
!import torch.nn.functional as F
!import torch.optim as optim
!import numpy as np
!import sys
!import os
!import time
!
!
!#
!# TORCH INSTALLATION: refer to https://pytorch.org/get-started/locally/
!#
!
!
!
!def update_progress(job_title, progress):
!    length = 20 # modify this to change the length
!    block = int(round(length*progress))
!    msg = "\r{0}: [{1}] {2}%".format(job_title, "#"*block + "-"*(length-block), round(progress*100, 2))
!    if progress >= 1: msg += " DONE\r\n"
!    sys.stdout.write(msg)
!    sys.stdout.flush()
!
!def cls():
!    os.system('cls' if os.name=='nt' else 'clear')
!
!
!cls()
!
!
!################################################################################################################
!
!# Initialize torch tensor for coordiantes 
!coords_data  = [[ 1.0,   0.0,       0.0],
!                [ 2.0,   0.0,       0.0],
!                [ 1.0,   np.pi/2.0, 0.0],
!                [ 2.0,   np.pi/2.0, 0.0],
!                [ 1.0,   0.0,       1.0],
!                [ 2.0,   0.0,       1.0],
!                [ 1.0,   np.pi/2.0, 1.0],
!                [ 2.0,   np.pi/2.0, 1.0],
!                ]
!coords = torch.tensor(coords_data,requires_grad=True,dtype=torch.float64)
!
!
!nnodes_r   = coords.size(0)
!nnodes_elem  = 8 
!nnodes_face  = 4 
!nterms_s   = 8
!ndirs      = 3
!coord_sys  = 'CYLINDRICAL'
!
!
!
!# Define matrix of polynomial basis terms at support nodes
!val_r_data = [[ 1.0,-1.0,-1.0,-1.0, 1.0, 1.0, 1.0,-1.0],
!              [ 1.0,-1.0,-1.0, 1.0,-1.0,-1.0, 1.0, 1.0],
!              [ 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0, 1.0],
!              [ 1.0, 1.0,-1.0, 1.0, 1.0,-1.0,-1.0,-1.0],
!              [ 1.0,-1.0, 1.0,-1.0, 1.0,-1.0,-1.0, 1.0],
!              [ 1.0,-1.0, 1.0, 1.0,-1.0, 1.0,-1.0,-1.0],
!              [ 1.0, 1.0, 1.0,-1.0,-1.0,-1.0, 1.0,-1.0],
!              [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
!              ] 
!val_r = torch.tensor(val_r_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define matrices at interpolation nodes (quadrature, level = 1)
!val_i_data = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0,-1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0,-1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0, 1.0/3.0,-1.0/3.0*np.sqrt(1.0/3.0)],
!              [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0*np.sqrt(1.0/3.0)],
!              ]
!val_i = torch.tensor(val_i_data,requires_grad=False,dtype=torch.float64)
!
!
!ddxi_i_data  = [[ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0,-1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                [ 0.0,0.0,0.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),0.0, 1.0/3.0],
!                ]
!ddxi_i = torch.tensor(ddxi_i_data,requires_grad=False,dtype=torch.float64)
!
!ddeta_i_data = [[ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),0.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddeta_i = torch.tensor(ddeta_i_data,requires_grad=False,dtype=torch.float64)
!
!ddzeta_i_data= [[ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 0.0,0.0,1.0,0.0,0.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!ddzeta_i = torch.tensor(ddzeta_i_data,requires_grad=False,dtype=torch.float64)
!
!# Define element interpolation nodes weights for linear element
!weights_e_data = [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0] 
!weights_e = torch.tensor(weights_e_data,requires_grad=False,dtype=torch.float64)
!
!
!# Define val_f for each face
!# Face 1, XI_MIN
!val_1_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, 1.0/3.0],
!               [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-1.0/3.0],
!               ]
!val_1 = torch.tensor(val_1_data,requires_grad=False,dtype=torch.float64)
!
!# Face 2, XI_MAX
!val_2_data   = [[ 1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, 1.0/3.0],
!                ] 
!val_2 = torch.tensor(val_2_data,requires_grad=False,dtype=torch.float64)
!
!# Face 3, ETA_MIN
!val_3_data   = [[ 1.0,-1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                ] 
!val_3 = torch.tensor(val_3_data,requires_grad=False,dtype=torch.float64)
!
!# Face 4, ETA_MAX
!val_4_data   = [[ 1.0,1.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,1.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,1.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_4 = torch.tensor(val_4_data,requires_grad=False,dtype=torch.float64)
!
!# Face 5, ZETA_MIN
!val_5_data   = [[ 1.0,-np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0,-np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),-1.0, np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                ]
!val_5 = torch.tensor(val_5_data,requires_grad=False,dtype=torch.float64)
!
!# Face 6, ZETA_MAX
!val_6_data   = [[ 1.0,-np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0), 1.0/3.0,-np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0), 1.0/3.0],
!                [ 1.0,-np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0),-1.0/3.0, np.sqrt(1.0/3.0),-np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0,-np.sqrt(1.0/3.0),-1.0/3.0,-np.sqrt(1.0/3.0), np.sqrt(1.0/3.0),-1.0/3.0],
!                [ 1.0, np.sqrt(1.0/3.0),1.0, np.sqrt(1.0/3.0), 1.0/3.0, np.sqrt(1.0/3.0), np.sqrt(1.0/3.0), 1.0/3.0],
!                ]
!val_6 = torch.tensor(val_6_data,requires_grad=False,dtype=torch.float64)
!
!
!
!
!
!#--------------------------------------------------------------------
!
!# Matrix modes_to_nodes
!val_r_inv = torch.inverse(val_r)
!
!
!# Computes coordiantes modes
!coords_modes = torch.mm(val_r_inv,coords)
!
!
!# Initialized coordiantes
!interp_coords = torch.mm(val_i,coords_modes)
!
!
!# Initialized jacobian
!jacobian     = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jacobian_tmp = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    jacobian_tmp[0,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,0])
!    jacobian_tmp[0,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,0])
!    jacobian_tmp[0,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,0])
!    jacobian_tmp[1,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,1])
!    jacobian_tmp[1,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,1])
!    jacobian_tmp[1,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,1])
!    jacobian_tmp[2,0,inode] = torch.dot(ddxi_i[inode,:]   , coords_modes[:,2])
!    jacobian_tmp[2,1,inode] = torch.dot(ddeta_i[inode,:]  , coords_modes[:,2])
!    jacobian_tmp[2,2,inode] = torch.dot(ddzeta_i[inode,:] , coords_modes[:,2])
!    update_progress("Computing Jacobian                 ", inode/(nnodes_elem-1))
!if coord_sys == 'CYLINDRICAL':
!    jacobian = jacobian_tmp.clone()
!    scaling_factor = torch.mv(val_i,coords_modes[:,0])
!    for inode in range(0,nnodes_elem):
!        jacobian[1,0,inode] = jacobian_tmp[1,0,inode] * scaling_factor[inode]
!        jacobian[1,1,inode] = jacobian_tmp[1,1,inode] * scaling_factor[inode]
!        jacobian[1,2,inode] = jacobian_tmp[1,2,inode] * scaling_factor[inode]
!else:
!    jacobian = jacobian_tmp.clone()
!
!
!# Matrics and Determinant
!metrics = torch.empty(3,3,nnodes_elem, dtype=torch.float64) 
!jinv    = torch.empty(nnodes_elem, dtype=torch.float64) 
!for inode in range(0,nnodes_elem):
!    ijacobian = torch.empty(3,3, dtype=torch.float64)
!    imetric   = torch.empty(3,3, dtype=torch.float64)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            ijacobian[irow,icol] = jacobian[irow,icol,inode]
!    # Compute jacobian for the ith node
!    update_progress("Computing Jinv and Metric          ", inode/(nnodes_elem-1))
!    jinv[inode] = torch.det(ijacobian) 
!    imetric     = torch.inverse(ijacobian)
!    for irow in range(0,3):
!        for icol in range(0,3):
!            metrics[irow,icol,inode] = imetric[irow,icol]
!
! 
!# Compute inverse Mass matrix
!invmass = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!mass    = torch.empty(nterms_s,nterms_s,nnodes_elem, dtype=torch.float64)
!val_tmp = torch.empty(nterms_s,nnodes_elem, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        val_tmp[inode,iterm] = val_i[inode,iterm] * weights_e[inode] * jinv[inode]
!        update_progress("Computing invmass                  ", i/(nterms_s*nnodes_elem))
!        i += 1
!mass    = torch.mm(torch.t(val_tmp),val_i)
!invmass = torch.inverse(mass)
!
!
!# Compute BR2_VOL for each face
!br2_vol_face1 = torch.mm(val_i,torch.mm(invmass,torch.t(val_1)))
!br2_vol_face2 = torch.mm(val_i,torch.mm(invmass,torch.t(val_2)))
!br2_vol_face3 = torch.mm(val_i,torch.mm(invmass,torch.t(val_3)))
!br2_vol_face4 = torch.mm(val_i,torch.mm(invmass,torch.t(val_4)))
!br2_vol_face5 = torch.mm(val_i,torch.mm(invmass,torch.t(val_5)))
!br2_vol_face6 = torch.mm(val_i,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_vol                  ", 1)
!
!
!# Compute BR2_FACE for each face
!br2_face_face1 = torch.mm(val_1,torch.mm(invmass,torch.t(val_1)))
!br2_face_face2 = torch.mm(val_2,torch.mm(invmass,torch.t(val_2)))
!br2_face_face3 = torch.mm(val_3,torch.mm(invmass,torch.t(val_3)))
!br2_face_face4 = torch.mm(val_4,torch.mm(invmass,torch.t(val_4)))
!br2_face_face5 = torch.mm(val_5,torch.mm(invmass,torch.t(val_5)))
!br2_face_face6 = torch.mm(val_6,torch.mm(invmass,torch.t(val_6)))
!update_progress("Computing br2_face                 ", 1)
!
!
!# Grad1, Grad2, and Grad3
!grad1 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad2 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!grad3 = torch.empty(nnodes_elem,nterms_s, dtype=torch.float64)
!i = 1
!for iterm in range(0,nterms_s):
!    for inode in range(0,nnodes_elem):
!        grad1[inode,iterm] = metrics[0,0,inode] * ddxi_i[inode,iterm] + metrics[1,0,inode] * ddeta_i[inode,iterm] + metrics[2,0,inode] * ddzeta_i[inode,iterm] 
!        grad2[inode,iterm] = metrics[0,1,inode] * ddxi_i[inode,iterm] + metrics[1,1,inode] * ddeta_i[inode,iterm] + metrics[2,1,inode] * ddzeta_i[inode,iterm] 
!        grad3[inode,iterm] = metrics[0,2,inode] * ddxi_i[inode,iterm] + metrics[1,2,inode] * ddeta_i[inode,iterm] + metrics[2,2,inode] * ddzeta_i[inode,iterm] 
!        update_progress("Computing grad1, grad2, grad3      ", i/(nnodes_elem*nterms_s))
!        i += 1
!
!
!
!
!
!
!
!#WRITE_____________________
!
!#
!# Metrics
!#
!f = open("metrics.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Metric interpolation node %d \n" % (inode+1))
!    array = np.zeros([3, 3])
!    for irow in range(0,3):
!        for icol in range(0,3):
!            array[irow,icol] = metrics[irow,icol,inode].item() 
!            update_progress("Writing metrics to file            ", i/(nnodes_elem*9))
!            i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# jinv
!#
!f = open("jinv.txt","w")
!array = np.zeros([1])
!i = 1
!for inode in range (0,nnodes_elem):
!    f.write("Jinv interpolation node %d \n" % (inode+1))
!    array[0] = jinv[inode].item()
!    np.savetxt(f,array)
!    update_progress("Writing jinv to file               ", i/(nnodes_elem))
!    i += 1
!f.close()
!
!#
!# Grad1
!#
!f = open("grad1.txt","w")
!f.write("Grad1 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad1[inode,iterm].item()
!        update_progress("Writing grad1 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad2
!#
!f = open("grad2.txt","w")
!f.write("Grad2 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad2[inode,iterm].item()
!        update_progress("Writing grad2 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# Grad3
!#
!f = open("grad3.txt","w")
!f.write("Grad3 \n")
!array = np.zeros([nnodes_elem,nterms_s])
!i = 1
!for inode in range (0,nnodes_elem):
!    for iterm in range(0,nterms_s):
!        array[inode,iterm] = grad3[inode,iterm].item()
!        update_progress("Writing grad3 to file              ", i/(nnodes_elem*nterms_s))
!        i += 1
!np.savetxt(f,array)
!f.close()
!
!#
!# dmetric_dx
!#
!f = open("dmetric_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            array = np.zeros([3,3])
!            f.write("dmetric_dx interpolation node %s, diff_node %s, diff_dir %s \n" % (inode+1,inode_diff+1,idir+1))
!            for irow in range(0,3):
!                for icol in range(0,3):
!                    data = metrics[irow,icol,inode]
!                    data.backward(retain_graph=True)
!                    ddata = coords.grad
!                    ddata_np = ddata.numpy()
!                    array[irow,icol] = ddata_np[inode_diff,idir]
!                    update_progress("Writing dmetric_dx to file         ", i/(nnodes_elem*nnodes_r*ndirs*3*3))
!                    # This avoid to accumulate derivatives
!                    dummy = coords.grad.data.zero_()
!                    i += 1
!            np.savetxt(f,array)
!f.close()
!
!#
!# interp_coords_dx
!#
!f = open("dinterp_xcoords_dx.txt","w")
!i = 1
!f.write("xcoord interpolation, coord 1,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,0]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_xcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_ycoords_dx.txt","w")
!i = 1
!f.write("ycoord interpolation, coord 2,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,1]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_ycoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!f = open("dinterp_zcoords_dx.txt","w")
!i = 1
!f.write("zcoord interpolation, coord 3,  row=node, col=nnodes_r*dir \n")
!array = np.zeros([nnodes_elem,nnodes_r*ndirs])
!for inode in range (0,nnodes_elem):
!    data = interp_coords[inode,2]
!    data.backward(retain_graph=True)
!    ddata = coords.grad
!    ddata_np = ddata.numpy()
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!            if idir == 0:
!                index = inode_diff
!            elif idir == 1:
!                index = nnodes_r + inode_diff
!            elif idir == 2:
!                index = 2*nnodes_r + inode_diff
!            array[inode,index] = ddata_np[inode_diff,idir]
!            update_progress("Writing interp_zcoords_dx to file  ", i/(nnodes_elem*nnodes_r*3))
!            i += 1
!    # This avoid to accumulate derivatives
!    dummy = coords.grad.data.zero_()
!np.savetxt(f,array)
!f.close()
!
!#
!# djinv_dx
!#
!f = open("djinv_dx.txt","w")
!i = 1
!for inode in range (0,nnodes_elem):
!    array = np.zeros([nnodes_r,ndirs])
!    f.write("djinv_dx interpolation node %s, row=inode_diff, col=dir \n" % (inode+1))
!    for inode_diff in range(0,nnodes_r):
!        for idir in range(0,ndirs):
!                data = jinv[inode]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[inode_diff,idir] = ddata_np[inode_diff,idir]
!                update_progress("Writing djinv_dx to file           ", i/(nnodes_elem*nnodes_r*ndirs))
!                dummy = coords.grad.data.zero_()
!                i += 1
!    np.savetxt(f,array)
!f.close()
!
!#
!# dmass_dx
!# 
!f = open("dmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = mass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dmass_dx to file           ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dinvmass_dx
!# 
!f = open("dinvmass_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dinvmass_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nterms_s,nterms_s])
!        for irow in range(0,nterms_s):
!            for icol in range(0,nterms_s):
!                data = invmass[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dinvmass_dx to file        ", i/(nterms_s*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_vol_dx
!#
!# 
!f = open("dbr2_vol_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face1_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face2_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face3_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face4_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face5_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_vol_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_vol_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nnodes_face])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nnodes_face):
!                data = br2_vol_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_vol_face6_dx to file  ", i/(nnodes_elem*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dbr2_face_dx
!#
!# 
!f = open("dbr2_face_face1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face1_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face2_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face3_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face4_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face4_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face4[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face4_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face5_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face5_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face5[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face5_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!f = open("dbr2_face_face6_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dbr2_face_face6_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_face,nnodes_face])
!        for irow in range(0,nnodes_face):
!            for icol in range(0,nnodes_face):
!                data = br2_face_face6[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dbr2_face_face6_dx to file ", i/(nnodes_face*nnodes_r*ndirs*nnodes_face))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad1_dx
!#
!f = open("dgrad1_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad1_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad1[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad1_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad2_dx
!#
!f = open("dgrad2_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad2_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad2[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad2_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()
!
!#
!# dgrad3_dx
!#
!f = open("dgrad3_dx.txt","w")
!i = 1
!for inode_diff in range(0,nnodes_r):
!    for idir in range(0,ndirs):
!        f.write("dgrad3_dx => diff_node %s, diff_dir %s \n" % (inode_diff+1,idir+1))
!        array = np.zeros([nnodes_elem,nterms_s])
!        for irow in range(0,nnodes_elem):
!            for icol in range(0,nterms_s):
!                data = grad3[irow,icol]
!                data.backward(retain_graph=True)
!                ddata = coords.grad
!                ddata_np = ddata.numpy()
!                array[irow,icol] = ddata_np[inode_diff,idir]
!                update_progress("Writing dgrad3_dx to file          ", i/(nnodes_elem*nnodes_r*ndirs*nterms_s))
!                dummy = coords.grad.data.zero_()
!                i += 1
!        np.savetxt(f,array)
!f.close()













end module test_element_linearB_dx_mod
